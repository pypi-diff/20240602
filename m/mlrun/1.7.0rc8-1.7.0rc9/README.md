# Comparing `tmp/mlrun-1.7.0rc8-py3-none-any.whl.zip` & `tmp/mlrun-1.7.0rc9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,332 +1,334 @@
-Zip file size: 1051945 bytes, number of entries: 330
--rw-r--r--  2.0 unx     7248 b- defN 24-Apr-09 19:19 mlrun/__init__.py
--rw-r--r--  2.0 unx    49326 b- defN 24-Apr-09 19:19 mlrun/__main__.py
--rw-r--r--  2.0 unx    63992 b- defN 24-Apr-09 19:19 mlrun/config.py
--rw-r--r--  2.0 unx     7080 b- defN 24-Apr-09 19:19 mlrun/errors.py
--rw-r--r--  2.0 unx    40866 b- defN 24-Apr-09 19:19 mlrun/execution.py
--rw-r--r--  2.0 unx    15569 b- defN 24-Apr-09 19:19 mlrun/features.py
--rw-r--r--  2.0 unx     7023 b- defN 24-Apr-09 19:19 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    30446 b- defN 24-Apr-09 19:19 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8286 b- defN 24-Apr-09 19:19 mlrun/lists.py
--rw-r--r--  2.0 unx    70641 b- defN 24-Apr-09 19:19 mlrun/model.py
--rw-r--r--  2.0 unx    13009 b- defN 24-Apr-09 19:19 mlrun/render.py
--rw-r--r--  2.0 unx    42968 b- defN 24-Apr-09 19:19 mlrun/run.py
--rw-r--r--  2.0 unx     7776 b- defN 24-Apr-09 19:19 mlrun/secrets.py
--rw-r--r--  2.0 unx    14211 b- defN 24-Apr-09 19:19 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx     1187 b- defN 24-Apr-09 19:19 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    34978 b- defN 24-Apr-09 19:19 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    22360 b- defN 24-Apr-09 19:19 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    14425 b- defN 24-Apr-09 19:19 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    25205 b- defN 24-Apr-09 19:19 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15860 b- defN 24-Apr-09 19:19 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx      571 b- defN 24-Apr-09 19:19 mlrun/common/__init__.py
--rw-r--r--  2.0 unx      991 b- defN 24-Apr-09 19:19 mlrun/common/constants.py
--rw-r--r--  2.0 unx     1087 b- defN 24-Apr-09 19:19 mlrun/common/helpers.py
--rw-r--r--  2.0 unx     5181 b- defN 24-Apr-09 19:19 mlrun/common/secrets.py
--rw-r--r--  2.0 unx      949 b- defN 24-Apr-09 19:19 mlrun/common/types.py
--rw-r--r--  2.0 unx      571 b- defN 24-Apr-09 19:19 mlrun/common/db/__init__.py
--rw-r--r--  2.0 unx     2659 b- defN 24-Apr-09 19:19 mlrun/common/db/sql_session.py
--rw-r--r--  2.0 unx      721 b- defN 24-Apr-09 19:19 mlrun/common/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     4405 b- defN 24-Apr-09 19:19 mlrun/common/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     5005 b- defN 24-Apr-09 19:19 mlrun/common/schemas/__init__.py
--rw-r--r--  2.0 unx     2519 b- defN 24-Apr-09 19:19 mlrun/common/schemas/api_gateway.py
--rw-r--r--  2.0 unx     2796 b- defN 24-Apr-09 19:19 mlrun/common/schemas/artifact.py
--rw-r--r--  2.0 unx     5970 b- defN 24-Apr-09 19:19 mlrun/common/schemas/auth.py
--rw-r--r--  2.0 unx     1707 b- defN 24-Apr-09 19:19 mlrun/common/schemas/background_task.py
--rw-r--r--  2.0 unx     2858 b- defN 24-Apr-09 19:19 mlrun/common/schemas/client_spec.py
--rw-r--r--  2.0 unx      888 b- defN 24-Apr-09 19:19 mlrun/common/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     1557 b- defN 24-Apr-09 19:19 mlrun/common/schemas/common.py
--rw-r--r--  2.0 unx     6476 b- defN 24-Apr-09 19:19 mlrun/common/schemas/constants.py
--rw-r--r--  2.0 unx      750 b- defN 24-Apr-09 19:19 mlrun/common/schemas/datastore_profile.py
--rw-r--r--  2.0 unx     1026 b- defN 24-Apr-09 19:19 mlrun/common/schemas/events.py
--rw-r--r--  2.0 unx     3717 b- defN 24-Apr-09 19:19 mlrun/common/schemas/feature_store.py
--rw-r--r--  2.0 unx     2418 b- defN 24-Apr-09 19:19 mlrun/common/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     4577 b- defN 24-Apr-09 19:19 mlrun/common/schemas/function.py
--rw-r--r--  2.0 unx      705 b- defN 24-Apr-09 19:19 mlrun/common/schemas/http.py
--rw-r--r--  2.0 unx     4203 b- defN 24-Apr-09 19:19 mlrun/common/schemas/hub.py
--rw-r--r--  2.0 unx     1395 b- defN 24-Apr-09 19:19 mlrun/common/schemas/k8s.py
--rw-r--r--  2.0 unx      892 b- defN 24-Apr-09 19:19 mlrun/common/schemas/memory_reports.py
--rw-r--r--  2.0 unx     1768 b- defN 24-Apr-09 19:19 mlrun/common/schemas/notification.py
--rw-r--r--  2.0 unx     1980 b- defN 24-Apr-09 19:19 mlrun/common/schemas/object.py
--rw-r--r--  2.0 unx     1177 b- defN 24-Apr-09 19:19 mlrun/common/schemas/pipeline.py
--rw-r--r--  2.0 unx     4340 b- defN 24-Apr-09 19:19 mlrun/common/schemas/project.py
--rw-r--r--  2.0 unx      776 b- defN 24-Apr-09 19:19 mlrun/common/schemas/regex.py
--rw-r--r--  2.0 unx      745 b- defN 24-Apr-09 19:19 mlrun/common/schemas/runs.py
--rw-r--r--  2.0 unx     1554 b- defN 24-Apr-09 19:19 mlrun/common/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4287 b- defN 24-Apr-09 19:19 mlrun/common/schemas/schedule.py
--rw-r--r--  2.0 unx     1484 b- defN 24-Apr-09 19:19 mlrun/common/schemas/secret.py
--rw-r--r--  2.0 unx      884 b- defN 24-Apr-09 19:19 mlrun/common/schemas/tag.py
--rw-r--r--  2.0 unx     1823 b- defN 24-Apr-09 19:19 mlrun/common/schemas/workflow.py
--rw-r--r--  2.0 unx     1501 b- defN 24-Apr-09 19:19 mlrun/common/schemas/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     8322 b- defN 24-Apr-09 19:19 mlrun/common/schemas/model_monitoring/constants.py
--rw-r--r--  2.0 unx     1431 b- defN 24-Apr-09 19:19 mlrun/common/schemas/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    12000 b- defN 24-Apr-09 19:19 mlrun/common/schemas/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx     1087 b- defN 24-Apr-09 19:19 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4751 b- defN 24-Apr-09 19:19 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     6134 b- defN 24-Apr-09 19:19 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9457 b- defN 24-Apr-09 19:19 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     9945 b- defN 24-Apr-09 19:19 mlrun/data_types/to_pandas.py
--rw-r--r--  2.0 unx     4118 b- defN 24-Apr-09 19:19 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     4827 b- defN 24-Apr-09 19:19 mlrun/datastore/alibaba_oss.py
--rw-r--r--  2.0 unx     9019 b- defN 24-Apr-09 19:19 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    24421 b- defN 24-Apr-09 19:19 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     9111 b- defN 24-Apr-09 19:19 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx    16175 b- defN 24-Apr-09 19:19 mlrun/datastore/datastore_profile.py
--rw-r--r--  2.0 unx     6634 b- defN 24-Apr-09 19:19 mlrun/datastore/dbfs_store.py
--rw-r--r--  2.0 unx     3767 b- defN 24-Apr-09 19:19 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     6110 b- defN 24-Apr-09 19:19 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx     1674 b- defN 24-Apr-09 19:19 mlrun/datastore/hdfs.py
--rw-r--r--  2.0 unx      622 b- defN 24-Apr-09 19:19 mlrun/datastore/helpers.py
--rw-r--r--  2.0 unx     2779 b- defN 24-Apr-09 19:19 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     5575 b- defN 24-Apr-09 19:19 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     8110 b- defN 24-Apr-09 19:19 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    40125 b- defN 24-Apr-09 19:19 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1498 b- defN 24-Apr-09 19:19 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     1611 b- defN 24-Apr-09 19:19 mlrun/datastore/spark_utils.py
--rw-r--r--  2.0 unx     6839 b- defN 24-Apr-09 19:19 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    70949 b- defN 24-Apr-09 19:19 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     5227 b- defN 24-Apr-09 19:19 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     9252 b- defN 24-Apr-09 19:19 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 24-Apr-09 19:19 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6151 b- defN 24-Apr-09 19:19 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     1163 b- defN 24-Apr-09 19:19 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    19171 b- defN 24-Apr-09 19:19 mlrun/db/base.py
--rw-r--r--  2.0 unx     2397 b- defN 24-Apr-09 19:19 mlrun/db/factory.py
--rw-r--r--  2.0 unx   158765 b- defN 24-Apr-09 19:19 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    14882 b- defN 24-Apr-09 19:19 mlrun/db/nopdb.py
--rw-r--r--  2.0 unx     1584 b- defN 24-Apr-09 19:19 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    49480 b- defN 24-Apr-09 19:19 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12853 b- defN 24-Apr-09 19:19 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    55295 b- defN 24-Apr-09 19:19 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    43560 b- defN 24-Apr-09 19:19 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11210 b- defN 24-Apr-09 19:19 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    28882 b- defN 24-Apr-09 19:19 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1282 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    30004 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx    11654 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/conversion.py
--rw-r--r--  2.0 unx     5491 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     8261 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4429 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx    11165 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx     6314 b- defN 24-Apr-09 19:19 mlrun/feature_store/retrieval/storey_merger.py
--rw-r--r--  2.0 unx      743 b- defN 24-Apr-09 19:19 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11487 b- defN 24-Apr-09 19:19 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8497 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    20999 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55312 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3445 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5727 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9131 b- defN 24-Apr-09 19:19 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11477 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14748 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    27936 b- defN 24-Apr-09 19:19 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3145 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16885 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2717 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4869 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10477 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5630 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6406 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     4894 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6030 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6611 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5285 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6963 b- defN 24-Apr-09 19:19 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 24-Apr-09 19:19 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    24074 b- defN 24-Apr-09 19:19 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 24-Apr-09 19:19 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6043 b- defN 24-Apr-09 19:19 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15873 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13791 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9156 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8265 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5111 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4061 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1531 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14221 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 24-Apr-09 19:19 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 24-Apr-09 19:19 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6085 b- defN 24-Apr-09 19:19 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2399 b- defN 24-Apr-09 19:19 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6125 b- defN 24-Apr-09 19:19 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7021 b- defN 24-Apr-09 19:19 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22037 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27885 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44621 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22290 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10094 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11500 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23126 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9239 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26299 b- defN 24-Apr-09 19:19 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10880 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5840 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7089 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12203 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14054 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4695 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 24-Apr-09 19:19 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10447 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16901 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28102 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9529 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21993 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8701 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28419 b- defN 24-Apr-09 19:19 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10276 b- defN 24-Apr-09 19:19 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 24-Apr-09 19:19 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11530 b- defN 24-Apr-09 19:19 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 24-Apr-09 19:19 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      571 b- defN 24-Apr-09 19:19 mlrun/launcher/__init__.py
--rw-r--r--  2.0 unx    16432 b- defN 24-Apr-09 19:19 mlrun/launcher/base.py
--rw-r--r--  2.0 unx     6048 b- defN 24-Apr-09 19:19 mlrun/launcher/client.py
--rw-r--r--  2.0 unx     2338 b- defN 24-Apr-09 19:19 mlrun/launcher/factory.py
--rw-r--r--  2.0 unx    10909 b- defN 24-Apr-09 19:19 mlrun/launcher/local.py
--rw-r--r--  2.0 unx     7469 b- defN 24-Apr-09 19:19 mlrun/launcher/remote.py
--rw-r--r--  2.0 unx      859 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    29276 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/api.py
--rw-r--r--  2.0 unx    12504 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/application.py
--rw-r--r--  2.0 unx    27745 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/controller.py
--rw-r--r--  2.0 unx     1336 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/controller_handler.py
--rw-r--r--  2.0 unx     4824 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/evidently_application.py
--rw-r--r--  2.0 unx    25308 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     9095 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     3938 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx     7578 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/prometheus.py
--rw-r--r--  2.0 unx    49317 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/stream_processing.py
--rw-r--r--  2.0 unx     5502 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/tracking_policy.py
--rw-r--r--  2.0 unx     7309 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/writer.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/applications/__init__.py
--rw-r--r--  2.0 unx    11647 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/applications/histogram_data_drift.py
--rw-r--r--  2.0 unx      662 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/__init__.py
--rw-r--r--  2.0 unx     4305 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/__init__.py
--rw-r--r--  2.0 unx      599 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/base/__init__.py
--rw-r--r--  2.0 unx     7073 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/base/store.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/__init__.py
--rw-r--r--  2.0 unx    27104 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/sql_store.py
--rw-r--r--  2.0 unx     2196 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/models/__init__.py
--rw-r--r--  2.0 unx     4413 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/models/base.py
--rw-r--r--  2.0 unx     2022 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/models/mysql.py
--rw-r--r--  2.0 unx      994 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/v3io_kv/__init__.py
--rw-r--r--  2.0 unx    27471 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/metrics/__init__.py
--rw-r--r--  2.0 unx     4724 b- defN 24-Apr-09 19:19 mlrun/model_monitoring/metrics/histogram_distance.py
--rw-r--r--  2.0 unx     7082 b- defN 24-Apr-09 19:19 mlrun/package/__init__.py
--rw-r--r--  2.0 unx    14589 b- defN 24-Apr-09 19:19 mlrun/package/context_handler.py
--rw-r--r--  2.0 unx     1204 b- defN 24-Apr-09 19:19 mlrun/package/errors.py
--rw-r--r--  2.0 unx    15064 b- defN 24-Apr-09 19:19 mlrun/package/packager.py
--rw-r--r--  2.0 unx    37160 b- defN 24-Apr-09 19:19 mlrun/package/packagers_manager.py
--rw-r--r--  2.0 unx      769 b- defN 24-Apr-09 19:19 mlrun/package/packagers/__init__.py
--rw-r--r--  2.0 unx    26625 b- defN 24-Apr-09 19:19 mlrun/package/packagers/default_packager.py
--rw-r--r--  2.0 unx    25602 b- defN 24-Apr-09 19:19 mlrun/package/packagers/numpy_packagers.py
--rw-r--r--  2.0 unx    35761 b- defN 24-Apr-09 19:19 mlrun/package/packagers/pandas_packagers.py
--rw-r--r--  2.0 unx    22322 b- defN 24-Apr-09 19:19 mlrun/package/packagers/python_standard_library_packagers.py
--rw-r--r--  2.0 unx     1722 b- defN 24-Apr-09 19:19 mlrun/package/utils/__init__.py
--rw-r--r--  2.0 unx     7951 b- defN 24-Apr-09 19:19 mlrun/package/utils/_archiver.py
--rw-r--r--  2.0 unx     6373 b- defN 24-Apr-09 19:19 mlrun/package/utils/_formatter.py
--rw-r--r--  2.0 unx    10341 b- defN 24-Apr-09 19:19 mlrun/package/utils/_pickler.py
--rw-r--r--  2.0 unx     2357 b- defN 24-Apr-09 19:19 mlrun/package/utils/_supported_format.py
--rw-r--r--  2.0 unx     3696 b- defN 24-Apr-09 19:19 mlrun/package/utils/log_hint_utils.py
--rw-r--r--  2.0 unx    14695 b- defN 24-Apr-09 19:19 mlrun/package/utils/type_hint_utils.py
--rw-r--r--  2.0 unx     2352 b- defN 24-Apr-09 19:19 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    19434 b- defN 24-Apr-09 19:19 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11828 b- defN 24-Apr-09 19:19 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 24-Apr-09 19:19 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    18538 b- defN 24-Apr-09 19:19 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    40579 b- defN 24-Apr-09 19:19 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   166182 b- defN 24-Apr-09 19:19 mlrun/projects/project.py
--rw-r--r--  2.0 unx     8289 b- defN 24-Apr-09 19:19 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx    36683 b- defN 24-Apr-09 19:19 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     9513 b- defN 24-Apr-09 19:19 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    19149 b- defN 24-Apr-09 19:19 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx    10508 b- defN 24-Apr-09 19:19 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx     4918 b- defN 24-Apr-09 19:19 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     7241 b- defN 24-Apr-09 19:19 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    12500 b- defN 24-Apr-09 19:19 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    21783 b- defN 24-Apr-09 19:19 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx    59908 b- defN 24-Apr-09 19:19 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7326 b- defN 24-Apr-09 19:19 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    16004 b- defN 24-Apr-09 19:19 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/runtimes/databricks_job/__init__.py
--rw-r--r--  2.0 unx     2245 b- defN 24-Apr-09 19:19 mlrun/runtimes/databricks_job/databricks_cancel_task.py
--rw-r--r--  2.0 unx    12749 b- defN 24-Apr-09 19:19 mlrun/runtimes/databricks_job/databricks_runtime.py
--rw-r--r--  2.0 unx     8679 b- defN 24-Apr-09 19:19 mlrun/runtimes/databricks_job/databricks_wrapper.py
--rw-r--r--  2.0 unx     1583 b- defN 24-Apr-09 19:19 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx     9161 b- defN 24-Apr-09 19:19 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx     3206 b- defN 24-Apr-09 19:19 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     1034 b- defN 24-Apr-09 19:19 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      794 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/__init__.py
--rw-r--r--  2.0 unx    15894 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/api_gateway.py
--rw-r--r--  2.0 unx    49044 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/function.py
--rw-r--r--  2.0 unx     2942 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/nuclio.py
--rw-r--r--  2.0 unx    29745 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/serving.py
--rw-r--r--  2.0 unx      614 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/application/__init__.py
--rw-r--r--  2.0 unx     9678 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/application/application.py
--rw-r--r--  2.0 unx     2920 b- defN 24-Apr-09 19:19 mlrun/runtimes/nuclio/application/reverse_proxy.go
--rw-r--r--  2.0 unx      709 b- defN 24-Apr-09 19:19 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    41189 b- defN 24-Apr-09 19:19 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 24-Apr-09 19:19 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 24-Apr-09 19:19 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18010 b- defN 24-Apr-09 19:19 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    55048 b- defN 24-Apr-09 19:19 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    21055 b- defN 24-Apr-09 19:19 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 24-Apr-09 19:19 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    56265 b- defN 24-Apr-09 19:19 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3871 b- defN 24-Apr-09 19:19 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11805 b- defN 24-Apr-09 19:19 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    23631 b- defN 24-Apr-09 19:19 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      765 b- defN 24-Apr-09 19:19 mlrun/track/__init__.py
--rw-r--r--  2.0 unx     3541 b- defN 24-Apr-09 19:19 mlrun/track/tracker.py
--rw-r--r--  2.0 unx     5726 b- defN 24-Apr-09 19:19 mlrun/track/tracker_manager.py
--rw-r--r--  2.0 unx      569 b- defN 24-Apr-09 19:19 mlrun/track/trackers/__init__.py
--rw-r--r--  2.0 unx    23258 b- defN 24-Apr-09 19:19 mlrun/track/trackers/mlflow_tracker.py
--rw-r--r--  2.0 unx      826 b- defN 24-Apr-09 19:19 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    11092 b- defN 24-Apr-09 19:19 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3450 b- defN 24-Apr-09 19:19 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     7361 b- defN 24-Apr-09 19:19 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1897 b- defN 24-Apr-09 19:19 mlrun/utils/condition_evaluator.py
--rw-r--r--  2.0 unx     1713 b- defN 24-Apr-09 19:19 mlrun/utils/db.py
--rw-r--r--  2.0 unx    52095 b- defN 24-Apr-09 19:19 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     8707 b- defN 24-Apr-09 19:19 mlrun/utils/http.py
--rw-r--r--  2.0 unx     8133 b- defN 24-Apr-09 19:19 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     4581 b- defN 24-Apr-09 19:19 mlrun/utils/regex.py
--rw-r--r--  2.0 unx     7560 b- defN 24-Apr-09 19:19 mlrun/utils/retryer.py
--rw-r--r--  2.0 unx      869 b- defN 24-Apr-09 19:19 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1284 b- defN 24-Apr-09 19:19 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx    10447 b- defN 24-Apr-09 19:19 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx    21679 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     2092 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2279 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     2532 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     5221 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     1955 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3898 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx     2390 b- defN 24-Apr-09 19:19 mlrun/utils/notifications/notification/webhook.py
--rw-r--r--  2.0 unx      614 b- defN 24-Apr-09 19:19 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 24-Apr-09 19:19 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1878 b- defN 24-Apr-09 19:19 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/LICENSE
--rw-r--r--  2.0 unx    18799 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/WHEEL
--rw-r--r--  2.0 unx       46 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    30373 b- defN 24-Apr-09 19:19 mlrun-1.7.0rc8.dist-info/RECORD
-330 files, 3845221 bytes uncompressed, 1003715 bytes compressed:  73.9%
+Zip file size: 1056850 bytes, number of entries: 332
+-rw-r--r--  2.0 unx     7248 b- defN 24-Apr-14 10:08 mlrun/__init__.py
+-rw-r--r--  2.0 unx    49326 b- defN 24-Apr-14 10:08 mlrun/__main__.py
+-rw-r--r--  2.0 unx    64038 b- defN 24-Apr-14 10:08 mlrun/config.py
+-rw-r--r--  2.0 unx     7080 b- defN 24-Apr-14 10:08 mlrun/errors.py
+-rw-r--r--  2.0 unx    40866 b- defN 24-Apr-14 10:08 mlrun/execution.py
+-rw-r--r--  2.0 unx    15569 b- defN 24-Apr-14 10:08 mlrun/features.py
+-rw-r--r--  2.0 unx     7023 b- defN 24-Apr-14 10:08 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    30446 b- defN 24-Apr-14 10:08 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8286 b- defN 24-Apr-14 10:08 mlrun/lists.py
+-rw-r--r--  2.0 unx    70641 b- defN 24-Apr-14 10:08 mlrun/model.py
+-rw-r--r--  2.0 unx    13009 b- defN 24-Apr-14 10:08 mlrun/render.py
+-rw-r--r--  2.0 unx    43112 b- defN 24-Apr-14 10:08 mlrun/run.py
+-rw-r--r--  2.0 unx     7776 b- defN 24-Apr-14 10:08 mlrun/secrets.py
+-rw-r--r--  2.0 unx    14211 b- defN 24-Apr-14 10:08 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx     1187 b- defN 24-Apr-14 10:08 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    34978 b- defN 24-Apr-14 10:08 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    22360 b- defN 24-Apr-14 10:08 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    14425 b- defN 24-Apr-14 10:08 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    25205 b- defN 24-Apr-14 10:08 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15860 b- defN 24-Apr-14 10:08 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-14 10:08 mlrun/common/__init__.py
+-rw-r--r--  2.0 unx      991 b- defN 24-Apr-14 10:08 mlrun/common/constants.py
+-rw-r--r--  2.0 unx     1087 b- defN 24-Apr-14 10:08 mlrun/common/helpers.py
+-rw-r--r--  2.0 unx     5181 b- defN 24-Apr-14 10:08 mlrun/common/secrets.py
+-rw-r--r--  2.0 unx      949 b- defN 24-Apr-14 10:08 mlrun/common/types.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-14 10:08 mlrun/common/db/__init__.py
+-rw-r--r--  2.0 unx     2659 b- defN 24-Apr-14 10:08 mlrun/common/db/sql_session.py
+-rw-r--r--  2.0 unx      721 b- defN 24-Apr-14 10:08 mlrun/common/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     4405 b- defN 24-Apr-14 10:08 mlrun/common/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     5063 b- defN 24-Apr-14 10:08 mlrun/common/schemas/__init__.py
+-rw-r--r--  2.0 unx     2519 b- defN 24-Apr-14 10:08 mlrun/common/schemas/api_gateway.py
+-rw-r--r--  2.0 unx     2796 b- defN 24-Apr-14 10:08 mlrun/common/schemas/artifact.py
+-rw-r--r--  2.0 unx     5970 b- defN 24-Apr-14 10:08 mlrun/common/schemas/auth.py
+-rw-r--r--  2.0 unx     1707 b- defN 24-Apr-14 10:08 mlrun/common/schemas/background_task.py
+-rw-r--r--  2.0 unx     2858 b- defN 24-Apr-14 10:08 mlrun/common/schemas/client_spec.py
+-rw-r--r--  2.0 unx      888 b- defN 24-Apr-14 10:08 mlrun/common/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     1557 b- defN 24-Apr-14 10:08 mlrun/common/schemas/common.py
+-rw-r--r--  2.0 unx     6476 b- defN 24-Apr-14 10:08 mlrun/common/schemas/constants.py
+-rw-r--r--  2.0 unx      750 b- defN 24-Apr-14 10:08 mlrun/common/schemas/datastore_profile.py
+-rw-r--r--  2.0 unx     1026 b- defN 24-Apr-14 10:08 mlrun/common/schemas/events.py
+-rw-r--r--  2.0 unx     3717 b- defN 24-Apr-14 10:08 mlrun/common/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2418 b- defN 24-Apr-14 10:08 mlrun/common/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     4577 b- defN 24-Apr-14 10:08 mlrun/common/schemas/function.py
+-rw-r--r--  2.0 unx      705 b- defN 24-Apr-14 10:08 mlrun/common/schemas/http.py
+-rw-r--r--  2.0 unx     4116 b- defN 24-Apr-14 10:08 mlrun/common/schemas/hub.py
+-rw-r--r--  2.0 unx     1395 b- defN 24-Apr-14 10:08 mlrun/common/schemas/k8s.py
+-rw-r--r--  2.0 unx      892 b- defN 24-Apr-14 10:08 mlrun/common/schemas/memory_reports.py
+-rw-r--r--  2.0 unx     1768 b- defN 24-Apr-14 10:08 mlrun/common/schemas/notification.py
+-rw-r--r--  2.0 unx     1980 b- defN 24-Apr-14 10:08 mlrun/common/schemas/object.py
+-rw-r--r--  2.0 unx      887 b- defN 24-Apr-14 10:08 mlrun/common/schemas/pagination.py
+-rw-r--r--  2.0 unx     1177 b- defN 24-Apr-14 10:08 mlrun/common/schemas/pipeline.py
+-rw-r--r--  2.0 unx     4361 b- defN 24-Apr-14 10:08 mlrun/common/schemas/project.py
+-rw-r--r--  2.0 unx      776 b- defN 24-Apr-14 10:08 mlrun/common/schemas/regex.py
+-rw-r--r--  2.0 unx      745 b- defN 24-Apr-14 10:08 mlrun/common/schemas/runs.py
+-rw-r--r--  2.0 unx     1554 b- defN 24-Apr-14 10:08 mlrun/common/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4287 b- defN 24-Apr-14 10:08 mlrun/common/schemas/schedule.py
+-rw-r--r--  2.0 unx     1484 b- defN 24-Apr-14 10:08 mlrun/common/schemas/secret.py
+-rw-r--r--  2.0 unx      884 b- defN 24-Apr-14 10:08 mlrun/common/schemas/tag.py
+-rw-r--r--  2.0 unx     1823 b- defN 24-Apr-14 10:08 mlrun/common/schemas/workflow.py
+-rw-r--r--  2.0 unx     1501 b- defN 24-Apr-14 10:08 mlrun/common/schemas/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     8302 b- defN 24-Apr-14 10:08 mlrun/common/schemas/model_monitoring/constants.py
+-rw-r--r--  2.0 unx     1431 b- defN 24-Apr-14 10:08 mlrun/common/schemas/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    12000 b- defN 24-Apr-14 10:08 mlrun/common/schemas/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx     1087 b- defN 24-Apr-14 10:08 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4751 b- defN 24-Apr-14 10:08 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     6134 b- defN 24-Apr-14 10:08 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9457 b- defN 24-Apr-14 10:08 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     9945 b- defN 24-Apr-14 10:08 mlrun/data_types/to_pandas.py
+-rw-r--r--  2.0 unx     4034 b- defN 24-Apr-14 10:08 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     4827 b- defN 24-Apr-14 10:08 mlrun/datastore/alibaba_oss.py
+-rw-r--r--  2.0 unx     9019 b- defN 24-Apr-14 10:08 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    24421 b- defN 24-Apr-14 10:08 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     9111 b- defN 24-Apr-14 10:08 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx    16549 b- defN 24-Apr-14 10:08 mlrun/datastore/datastore_profile.py
+-rw-r--r--  2.0 unx     6634 b- defN 24-Apr-14 10:08 mlrun/datastore/dbfs_store.py
+-rw-r--r--  2.0 unx     3767 b- defN 24-Apr-14 10:08 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     6110 b- defN 24-Apr-14 10:08 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx     1674 b- defN 24-Apr-14 10:08 mlrun/datastore/hdfs.py
+-rw-r--r--  2.0 unx      622 b- defN 24-Apr-14 10:08 mlrun/datastore/helpers.py
+-rw-r--r--  2.0 unx     2779 b- defN 24-Apr-14 10:08 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     5575 b- defN 24-Apr-14 10:08 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     8110 b- defN 24-Apr-14 10:08 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx     1439 b- defN 24-Apr-14 10:08 mlrun/datastore/snowflake_utils.py
+-rw-r--r--  2.0 unx    39528 b- defN 24-Apr-14 10:08 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1498 b- defN 24-Apr-14 10:08 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     1611 b- defN 24-Apr-14 10:08 mlrun/datastore/spark_utils.py
+-rw-r--r--  2.0 unx     6839 b- defN 24-Apr-14 10:08 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    74690 b- defN 24-Apr-14 10:08 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     5227 b- defN 24-Apr-14 10:08 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     9252 b- defN 24-Apr-14 10:08 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 24-Apr-14 10:08 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6151 b- defN 24-Apr-14 10:08 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     1163 b- defN 24-Apr-14 10:08 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    20175 b- defN 24-Apr-14 10:08 mlrun/db/base.py
+-rw-r--r--  2.0 unx     2397 b- defN 24-Apr-14 10:08 mlrun/db/factory.py
+-rw-r--r--  2.0 unx   162721 b- defN 24-Apr-14 10:08 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    17627 b- defN 24-Apr-14 10:08 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx     1584 b- defN 24-Apr-14 10:08 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    49595 b- defN 24-Apr-14 10:08 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12853 b- defN 24-Apr-14 10:08 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    55295 b- defN 24-Apr-14 10:08 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    43560 b- defN 24-Apr-14 10:08 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11210 b- defN 24-Apr-14 10:08 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    28882 b- defN 24-Apr-14 10:08 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1282 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    30004 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx    11654 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/conversion.py
+-rw-r--r--  2.0 unx     5491 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     8261 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4429 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx    11019 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx     6314 b- defN 24-Apr-14 10:08 mlrun/feature_store/retrieval/storey_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 24-Apr-14 10:08 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11487 b- defN 24-Apr-14 10:08 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8497 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    20999 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55312 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3445 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5727 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9131 b- defN 24-Apr-14 10:08 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11477 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14748 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    27936 b- defN 24-Apr-14 10:08 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3145 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16885 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2717 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4869 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10477 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5630 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6406 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     4894 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6030 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6611 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5285 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6963 b- defN 24-Apr-14 10:08 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 24-Apr-14 10:08 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    24074 b- defN 24-Apr-14 10:08 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 24-Apr-14 10:08 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6043 b- defN 24-Apr-14 10:08 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15873 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13791 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9156 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8265 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5111 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4061 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1531 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14221 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 24-Apr-14 10:08 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 24-Apr-14 10:08 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6085 b- defN 24-Apr-14 10:08 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2399 b- defN 24-Apr-14 10:08 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6125 b- defN 24-Apr-14 10:08 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7021 b- defN 24-Apr-14 10:08 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22037 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27885 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44621 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22290 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10094 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11500 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23126 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9239 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26299 b- defN 24-Apr-14 10:08 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10880 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5840 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7089 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12203 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14054 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4695 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 24-Apr-14 10:08 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10447 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16617 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28102 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9529 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21862 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8701 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28419 b- defN 24-Apr-14 10:08 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10276 b- defN 24-Apr-14 10:08 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 24-Apr-14 10:08 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11530 b- defN 24-Apr-14 10:08 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 24-Apr-14 10:08 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-14 10:08 mlrun/launcher/__init__.py
+-rw-r--r--  2.0 unx    16425 b- defN 24-Apr-14 10:08 mlrun/launcher/base.py
+-rw-r--r--  2.0 unx     6055 b- defN 24-Apr-14 10:08 mlrun/launcher/client.py
+-rw-r--r--  2.0 unx     2338 b- defN 24-Apr-14 10:08 mlrun/launcher/factory.py
+-rw-r--r--  2.0 unx    10909 b- defN 24-Apr-14 10:08 mlrun/launcher/local.py
+-rw-r--r--  2.0 unx     7469 b- defN 24-Apr-14 10:08 mlrun/launcher/remote.py
+-rw-r--r--  2.0 unx      859 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    29276 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/api.py
+-rw-r--r--  2.0 unx    12504 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/application.py
+-rw-r--r--  2.0 unx    27745 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/controller.py
+-rw-r--r--  2.0 unx     1336 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/controller_handler.py
+-rw-r--r--  2.0 unx     4824 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/evidently_application.py
+-rw-r--r--  2.0 unx    25308 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     9095 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     3938 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx     7578 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/prometheus.py
+-rw-r--r--  2.0 unx    49317 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/stream_processing.py
+-rw-r--r--  2.0 unx     5502 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/tracking_policy.py
+-rw-r--r--  2.0 unx     7309 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/writer.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/applications/__init__.py
+-rw-r--r--  2.0 unx    11647 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/applications/histogram_data_drift.py
+-rw-r--r--  2.0 unx      662 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/__init__.py
+-rw-r--r--  2.0 unx     4305 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/__init__.py
+-rw-r--r--  2.0 unx      599 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/base/__init__.py
+-rw-r--r--  2.0 unx     7073 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/base/store.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/__init__.py
+-rw-r--r--  2.0 unx    27104 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/sql_store.py
+-rw-r--r--  2.0 unx     2196 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx     4413 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/models/base.py
+-rw-r--r--  2.0 unx     2022 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/models/mysql.py
+-rw-r--r--  2.0 unx      994 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/v3io_kv/__init__.py
+-rw-r--r--  2.0 unx    27471 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/metrics/__init__.py
+-rw-r--r--  2.0 unx     4724 b- defN 24-Apr-14 10:08 mlrun/model_monitoring/metrics/histogram_distance.py
+-rw-r--r--  2.0 unx     7082 b- defN 24-Apr-14 10:08 mlrun/package/__init__.py
+-rw-r--r--  2.0 unx    14589 b- defN 24-Apr-14 10:08 mlrun/package/context_handler.py
+-rw-r--r--  2.0 unx     1204 b- defN 24-Apr-14 10:08 mlrun/package/errors.py
+-rw-r--r--  2.0 unx    15064 b- defN 24-Apr-14 10:08 mlrun/package/packager.py
+-rw-r--r--  2.0 unx    37160 b- defN 24-Apr-14 10:08 mlrun/package/packagers_manager.py
+-rw-r--r--  2.0 unx      769 b- defN 24-Apr-14 10:08 mlrun/package/packagers/__init__.py
+-rw-r--r--  2.0 unx    26625 b- defN 24-Apr-14 10:08 mlrun/package/packagers/default_packager.py
+-rw-r--r--  2.0 unx    25602 b- defN 24-Apr-14 10:08 mlrun/package/packagers/numpy_packagers.py
+-rw-r--r--  2.0 unx    35761 b- defN 24-Apr-14 10:08 mlrun/package/packagers/pandas_packagers.py
+-rw-r--r--  2.0 unx    22322 b- defN 24-Apr-14 10:08 mlrun/package/packagers/python_standard_library_packagers.py
+-rw-r--r--  2.0 unx     1722 b- defN 24-Apr-14 10:08 mlrun/package/utils/__init__.py
+-rw-r--r--  2.0 unx     7951 b- defN 24-Apr-14 10:08 mlrun/package/utils/_archiver.py
+-rw-r--r--  2.0 unx     6373 b- defN 24-Apr-14 10:08 mlrun/package/utils/_formatter.py
+-rw-r--r--  2.0 unx    10341 b- defN 24-Apr-14 10:08 mlrun/package/utils/_pickler.py
+-rw-r--r--  2.0 unx     2357 b- defN 24-Apr-14 10:08 mlrun/package/utils/_supported_format.py
+-rw-r--r--  2.0 unx     3696 b- defN 24-Apr-14 10:08 mlrun/package/utils/log_hint_utils.py
+-rw-r--r--  2.0 unx    14695 b- defN 24-Apr-14 10:08 mlrun/package/utils/type_hint_utils.py
+-rw-r--r--  2.0 unx     2352 b- defN 24-Apr-14 10:08 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    19434 b- defN 24-Apr-14 10:08 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11828 b- defN 24-Apr-14 10:08 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 24-Apr-14 10:08 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    18538 b- defN 24-Apr-14 10:08 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    40579 b- defN 24-Apr-14 10:08 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   166422 b- defN 24-Apr-14 10:08 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     8694 b- defN 24-Apr-14 10:08 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx    36788 b- defN 24-Apr-14 10:08 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     9513 b- defN 24-Apr-14 10:08 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    19149 b- defN 24-Apr-14 10:08 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx    10508 b- defN 24-Apr-14 10:08 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx     4918 b- defN 24-Apr-14 10:08 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     7241 b- defN 24-Apr-14 10:08 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx     8641 b- defN 24-Apr-14 10:08 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    21783 b- defN 24-Apr-14 10:08 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx    65171 b- defN 24-Apr-14 10:08 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7326 b- defN 24-Apr-14 10:08 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    15455 b- defN 24-Apr-14 10:08 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/runtimes/databricks_job/__init__.py
+-rw-r--r--  2.0 unx     2245 b- defN 24-Apr-14 10:08 mlrun/runtimes/databricks_job/databricks_cancel_task.py
+-rw-r--r--  2.0 unx    12749 b- defN 24-Apr-14 10:08 mlrun/runtimes/databricks_job/databricks_runtime.py
+-rw-r--r--  2.0 unx     8679 b- defN 24-Apr-14 10:08 mlrun/runtimes/databricks_job/databricks_wrapper.py
+-rw-r--r--  2.0 unx     1583 b- defN 24-Apr-14 10:08 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx     9161 b- defN 24-Apr-14 10:08 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx     3206 b- defN 24-Apr-14 10:08 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     1034 b- defN 24-Apr-14 10:08 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      794 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/__init__.py
+-rw-r--r--  2.0 unx    16722 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/api_gateway.py
+-rw-r--r--  2.0 unx    49265 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/function.py
+-rw-r--r--  2.0 unx     2942 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/nuclio.py
+-rw-r--r--  2.0 unx    29725 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/serving.py
+-rw-r--r--  2.0 unx      614 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/application/__init__.py
+-rw-r--r--  2.0 unx    13349 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/application/application.py
+-rw-r--r--  2.0 unx     3150 b- defN 24-Apr-14 10:08 mlrun/runtimes/nuclio/application/reverse_proxy.go
+-rw-r--r--  2.0 unx      709 b- defN 24-Apr-14 10:08 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    41189 b- defN 24-Apr-14 10:08 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 24-Apr-14 10:08 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 24-Apr-14 10:08 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    17980 b- defN 24-Apr-14 10:08 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    55048 b- defN 24-Apr-14 10:08 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    21045 b- defN 24-Apr-14 10:08 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 24-Apr-14 10:08 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    56164 b- defN 24-Apr-14 10:08 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3871 b- defN 24-Apr-14 10:08 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11805 b- defN 24-Apr-14 10:08 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    23631 b- defN 24-Apr-14 10:08 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      765 b- defN 24-Apr-14 10:08 mlrun/track/__init__.py
+-rw-r--r--  2.0 unx     3541 b- defN 24-Apr-14 10:08 mlrun/track/tracker.py
+-rw-r--r--  2.0 unx     5726 b- defN 24-Apr-14 10:08 mlrun/track/tracker_manager.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-14 10:08 mlrun/track/trackers/__init__.py
+-rw-r--r--  2.0 unx    23258 b- defN 24-Apr-14 10:08 mlrun/track/trackers/mlflow_tracker.py
+-rw-r--r--  2.0 unx      826 b- defN 24-Apr-14 10:08 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    11092 b- defN 24-Apr-14 10:08 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3450 b- defN 24-Apr-14 10:08 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     7361 b- defN 24-Apr-14 10:08 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1897 b- defN 24-Apr-14 10:08 mlrun/utils/condition_evaluator.py
+-rw-r--r--  2.0 unx     1713 b- defN 24-Apr-14 10:08 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    52095 b- defN 24-Apr-14 10:08 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     8707 b- defN 24-Apr-14 10:08 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     8133 b- defN 24-Apr-14 10:08 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     4581 b- defN 24-Apr-14 10:08 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx     7560 b- defN 24-Apr-14 10:08 mlrun/utils/retryer.py
+-rw-r--r--  2.0 unx      869 b- defN 24-Apr-14 10:08 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1284 b- defN 24-Apr-14 10:08 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx    10447 b- defN 24-Apr-14 10:08 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    21679 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     2092 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2279 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     2532 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     5221 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     1955 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3898 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx     2390 b- defN 24-Apr-14 10:08 mlrun/utils/notifications/notification/webhook.py
+-rw-r--r--  2.0 unx      614 b- defN 24-Apr-14 10:08 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 24-Apr-14 10:08 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1878 b- defN 24-Apr-14 10:08 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/LICENSE
+-rw-r--r--  2.0 unx    18799 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/WHEEL
+-rw-r--r--  2.0 unx       46 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    30554 b- defN 24-Apr-14 10:08 mlrun-1.7.0rc9.dist-info/RECORD
+332 files, 3864977 bytes uncompressed, 1008332 bytes compressed:  73.9%
```

## zipnote {}

```diff
@@ -141,14 +141,17 @@
 
 Filename: mlrun/common/schemas/notification.py
 Comment: 
 
 Filename: mlrun/common/schemas/object.py
 Comment: 
 
+Filename: mlrun/common/schemas/pagination.py
+Comment: 
+
 Filename: mlrun/common/schemas/pipeline.py
 Comment: 
 
 Filename: mlrun/common/schemas/project.py
 Comment: 
 
 Filename: mlrun/common/schemas/regex.py
@@ -237,14 +240,17 @@
 
 Filename: mlrun/datastore/redis.py
 Comment: 
 
 Filename: mlrun/datastore/s3.py
 Comment: 
 
+Filename: mlrun/datastore/snowflake_utils.py
+Comment: 
+
 Filename: mlrun/datastore/sources.py
 Comment: 
 
 Filename: mlrun/datastore/spark_udf.py
 Comment: 
 
 Filename: mlrun/datastore/spark_utils.py
@@ -966,26 +972,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/LICENSE
+Filename: mlrun-1.7.0rc9.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/METADATA
+Filename: mlrun-1.7.0rc9.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/WHEEL
+Filename: mlrun-1.7.0rc9.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/entry_points.txt
+Filename: mlrun-1.7.0rc9.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/top_level.txt
+Filename: mlrun-1.7.0rc9.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.7.0rc8.dist-info/RECORD
+Filename: mlrun-1.7.0rc9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/config.py

```diff
@@ -236,14 +236,15 @@
         "image_by_kind": {
             "job": "mlrun/mlrun",
             "serving": "mlrun/mlrun",
             "nuclio": "mlrun/mlrun",
             "remote": "mlrun/mlrun",
             "dask": "mlrun/ml-base",
             "mpijob": "mlrun/mlrun",
+            "application": "python:3.9-slim",
         },
         # see enrich_function_preemption_spec for more info,
         # and mlrun.common.schemas.function.PreemptionModes for available options
         "preemption_mode": "prevent",
     },
     "httpdb": {
         "clusterization": {
```

## mlrun/run.py

```diff
@@ -533,15 +533,15 @@
         runner.spec.args = args
     runner.kfp = kfp
     if mode:
         runner.spec.mode = mode
     if source:
         runner.spec.build.source = source
     if handler:
-        if kind in [RuntimeKinds.serving, RuntimeKinds.application]:
+        if kind in RuntimeKinds.handlerless_runtimes():
             raise MLRunInvalidArgumentError(
                 f"Handler is not supported for {kind} runtime"
             )
         elif kind in RuntimeKinds.nuclio_runtimes():
             runner.spec.function_handler = handler
         else:
             runner.spec.default_handler = handler
@@ -626,14 +626,16 @@
     - job: insert the code into a Kubernetes pod and execute it
     - nuclio: insert the code into a real-time serverless nuclio function
     - serving: insert code into orchestrated nuclio function(s) forming a DAG
     - dask: run the specified python code / script as Dask Distributed job
     - mpijob: run distributed Horovod jobs over the MPI job operator
     - spark: run distributed Spark job using Spark Kubernetes Operator
     - remote-spark: run distributed Spark job on remote Spark service
+    - databricks: run code on Databricks cluster (python scripts, Spark etc.)
+    - application: run a long living application (e.g. a web server, UI, etc.)
 
     Learn more about [Kinds of function (runtimes)](../concepts/functions-overview.html).
 
     :param name:         function name, typically best to use hyphen-case
     :param project:      project used to namespace the function, defaults to 'default'
     :param tag:          function tag to track multiple versions of the same function, defaults to 'latest'
     :param filename:     path to .py/.ipynb file, defaults to current jupyter notebook
```

## mlrun/common/schemas/__init__.py

```diff
@@ -148,20 +148,22 @@
     Notification,
     NotificationKind,
     NotificationSeverity,
     NotificationStatus,
     SetNotificationRequest,
 )
 from .object import ObjectKind, ObjectMetadata, ObjectSpec, ObjectStatus
+from .pagination import PaginationInfo
 from .pipeline import PipelinesFormat, PipelinesOutput, PipelinesPagination
 from .project import (
     IguazioProject,
     Project,
     ProjectDesiredState,
     ProjectMetadata,
+    ProjectOutput,
     ProjectOwner,
     ProjectsFormat,
     ProjectsOutput,
     ProjectSpec,
     ProjectState,
     ProjectStatus,
     ProjectSummariesOutput,
```

## mlrun/common/schemas/hub.py

```diff
@@ -55,36 +55,34 @@
     spec: HubSourceSpec
     status: Optional[ObjectStatus] = ObjectStatus(state="created")
 
     def get_full_uri(self, relative_path):
         return f"{self.spec.path}/{self.spec.object_type}/{self.spec.channel}/{relative_path}"
 
     def get_catalog_uri(self):
-        return self.get_full_uri(mlrun.config.config.hub.catalog_filename)
+        return self.get_full_uri(mlrun.mlconf.hub.catalog_filename)
 
     @classmethod
     def generate_default_source(cls):
-        if not mlrun.config.config.hub.default_source.create:
+        if not mlrun.mlconf.hub.default_source.create:
             return None
 
         now = datetime.now(timezone.utc)
         hub_metadata = HubObjectMetadata(
-            name=mlrun.config.config.hub.default_source.name,
-            description=mlrun.config.config.hub.default_source.description,
+            name=mlrun.mlconf.hub.default_source.name,
+            description=mlrun.mlconf.hub.default_source.description,
             created=now,
             updated=now,
         )
         return cls(
             metadata=hub_metadata,
             spec=HubSourceSpec(
-                path=mlrun.config.config.hub.default_source.url,
-                channel=mlrun.config.config.hub.default_source.channel,
-                object_type=HubSourceType(
-                    mlrun.config.config.hub.default_source.object_type
-                ),
+                path=mlrun.mlconf.hub.default_source.url,
+                channel=mlrun.mlconf.hub.default_source.channel,
+                object_type=HubSourceType(mlrun.mlconf.hub.default_source.object_type),
             ),
             status=ObjectStatus(state="created"),
         )
 
 
 last_source_index = -1
```

## mlrun/common/schemas/project.py

```diff
@@ -116,22 +116,27 @@
     pipelines_running_count: typing.Optional[int] = None
 
 
 class IguazioProject(pydantic.BaseModel):
     data: dict
 
 
+# The format query param controls the project type used:
+# full - Project
+# name_only - str
+# summary - ProjectSummary
+# leader - currently only IguazioProject supported
+# The way pydantic handles typing.Union is that it takes the object and tries to coerce it to be the types of the
+# union by the definition order. Therefore we can't currently add generic dict for all leader formats, but we need
+# to add a specific classes for them. it's frustrating but couldn't find other workaround, see:
+# https://github.com/samuelcolvin/pydantic/issues/1423, https://github.com/samuelcolvin/pydantic/issues/619
+ProjectOutput = typing.TypeVar(
+    "ProjectOutput", Project, str, ProjectSummary, IguazioProject
+)
+
+
 class ProjectsOutput(pydantic.BaseModel):
-    # The format query param controls the project type used:
-    # full - Project
-    # name_only - str
-    # summary - ProjectSummary
-    # leader - currently only IguazioProject supported
-    # The way pydantic handles typing.Union is that it takes the object and tries to coerce it to be the types of the
-    # union by the definition order. Therefore we can't currently add generic dict for all leader formats, but we need
-    # to add a specific classes for them. it's frustrating but couldn't find other workaround, see:
-    # https://github.com/samuelcolvin/pydantic/issues/1423, https://github.com/samuelcolvin/pydantic/issues/619
-    projects: list[typing.Union[Project, str, ProjectSummary, IguazioProject]]
+    projects: list[ProjectOutput]
 
 
 class ProjectSummariesOutput(pydantic.BaseModel):
     project_summaries: list[ProjectSummary]
```

## mlrun/common/schemas/model_monitoring/constants.py

```diff
@@ -147,15 +147,15 @@
     SQL = "sql"
 
 
 class ProjectSecretKeys:
     ENDPOINT_STORE_CONNECTION = "MODEL_MONITORING_ENDPOINT_STORE_CONNECTION"
     ACCESS_KEY = "MODEL_MONITORING_ACCESS_KEY"
     PIPELINES_ACCESS_KEY = "MODEL_MONITORING_PIPELINES_ACCESS_KEY"
-    KAFKA_BOOTSTRAP_SERVERS = "KAFKA_BOOTSTRAP_SERVERS"
+    KAFKA_BROKERS = "KAFKA_BROKERS"
     STREAM_PATH = "STREAM_PATH"
 
 
 class ModelMonitoringStoreKinds:
     ENDPOINTS = "endpoints"
     EVENTS = "events"
```

## mlrun/datastore/__init__.py

```diff
@@ -103,21 +103,17 @@
         create:             create a new stream if doesnt exist
         shards:             number of shards
         retention_in_hours: stream retention in hours
 
     :param stream_path:        path/url of stream
     """
 
-    if stream_path.startswith("kafka://") or "kafka_bootstrap_servers" in kwargs:
-        topic, bootstrap_servers = parse_kafka_url(
-            stream_path, kwargs.get("kafka_bootstrap_servers")
-        )
-        return KafkaOutputStream(
-            topic, bootstrap_servers, kwargs.get("kafka_producer_options")
-        )
+    if stream_path.startswith("kafka://") or "kafka_brokers" in kwargs:
+        topic, brokers = parse_kafka_url(stream_path, kwargs.get("kafka_brokers"))
+        return KafkaOutputStream(topic, brokers, kwargs.get("kafka_producer_options"))
     elif stream_path.startswith("http://") or stream_path.startswith("https://"):
         return HTTPOutputStream(stream_path=stream_path)
     elif "://" not in stream_path:
         return OutputStream(stream_path, **kwargs)
     elif stream_path.startswith("v3io"):
         endpoint, stream_path = parse_path(stream_path)
         return OutputStream(stream_path, endpoint=endpoint, **kwargs)
```

## mlrun/datastore/datastore_profile.py

```diff
@@ -12,14 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 import ast
 import base64
 import json
 import typing
+import warnings
 from urllib.parse import ParseResult, urlparse, urlunparse
 
 import pydantic
 from mergedeep import merge
 
 import mlrun
 import mlrun.errors
@@ -79,20 +80,30 @@
     private: typing.Optional[str] = None
 
 
 class DatastoreProfileKafkaTarget(DatastoreProfile):
     type: str = pydantic.Field("kafka_target")
     _private_attributes = "kwargs_private"
     bootstrap_servers: str
+    brokers: str
     topic: str
     kwargs_public: typing.Optional[dict]
     kwargs_private: typing.Optional[dict]
 
+    def __pydantic_post_init__(self):
+        if self.bootstrap_servers:
+            warnings.warn(
+                "'bootstrap_servers' parameter is deprecated in 1.7.0 and will be removed in 1.9.0, "
+                "use 'brokers' instead.",
+                # TODO: Remove this in 1.9.0
+                FutureWarning,
+            )
+
     def attributes(self):
-        attributes = {"bootstrap_servers": self.bootstrap_servers}
+        attributes = {"brokers": self.brokers or self.bootstrap_servers}
         if self.kwargs_public:
             attributes = merge(attributes, self.kwargs_public)
         if self.kwargs_private:
             attributes = merge(attributes, self.kwargs_private)
         return attributes
```

## mlrun/datastore/sources.py

```diff
@@ -24,14 +24,15 @@
 import v3io
 import v3io.dataplane
 from nuclio import KafkaTrigger
 from nuclio.config import split_path
 
 import mlrun
 from mlrun.config import config
+from mlrun.datastore.snowflake_utils import get_snowflake_spark_options
 from mlrun.secrets import SecretsStore
 
 from ..model import DataSource
 from ..platforms.iguazio import parse_path
 from ..utils import get_class, is_explicit_ack_supported
 from .datastore_profile import datastore_profile_read
 from .spark_utils import spark_session_update_hadoop_options
@@ -109,15 +110,19 @@
             start_time=start_time or self.start_time,
             end_time=end_time or self.end_time,
             time_column=time_field or self.time_field,
         )
 
     def to_spark_df(self, session, named_view=False, time_field=None, columns=None):
         if self.support_spark:
-            df = load_spark_dataframe_with_options(session, self.get_spark_options())
+            spark_options = self.get_spark_options()
+            spark_format = spark_options.pop("format", None)
+            df = load_spark_dataframe_with_options(
+                session, spark_options, format=spark_format
+            )
             if named_view:
                 df.createOrReplaceTempView(self.name)
             return self._filter_spark_df(df, time_field, columns)
         raise NotImplementedError(
             f"Conversion of a source of type '{type(self).__name__}' "
             "to a Spark dataframe is not possible, as this operation is not supported"
         )
@@ -669,40 +674,18 @@
             time_field=time_field,
             schedule=schedule,
             start_time=start_time,
             end_time=end_time,
             **kwargs,
         )
 
-    def _get_password(self):
-        key = "SNOWFLAKE_PASSWORD"
-        snowflake_password = os.getenv(key) or os.getenv(
-            SecretsStore.k8s_env_variable_name_for_secret(key)
-        )
-
-        if not snowflake_password:
-            raise mlrun.errors.MLRunInvalidArgumentError(
-                "No password provided. Set password using the SNOWFLAKE_PASSWORD "
-                "project secret or environment variable."
-            )
-
-        return snowflake_password
-
     def get_spark_options(self):
-        return {
-            "format": "net.snowflake.spark.snowflake",
-            "query": self.attributes.get("query"),
-            "sfURL": self.attributes.get("url"),
-            "sfUser": self.attributes.get("user"),
-            "sfPassword": self._get_password(),
-            "sfDatabase": self.attributes.get("database"),
-            "sfSchema": self.attributes.get("schema"),
-            "sfWarehouse": self.attributes.get("warehouse"),
-            "application": "iguazio_platform",
-        }
+        spark_options = get_snowflake_spark_options(self.attributes)
+        spark_options["query"] = self.attributes.get("query")
+        return spark_options
 
 
 class CustomSource(BaseSourceDriver):
     kind = "custom"
     support_storey = True
     support_spark = False
```

## mlrun/datastore/targets.py

```diff
@@ -13,25 +13,27 @@
 # limitations under the License.
 import ast
 import datetime
 import os
 import random
 import sys
 import time
+import warnings
 from collections import Counter
 from copy import copy
 from typing import Any, Optional, Union
 from urllib.parse import urlparse
 
 import pandas as pd
 from mergedeep import merge
 
 import mlrun
 import mlrun.utils.helpers
 from mlrun.config import config
+from mlrun.datastore.snowflake_utils import get_snowflake_spark_options
 from mlrun.model import DataSource, DataTarget, DataTargetBase, TargetPathObject
 from mlrun.utils import logger, now_date
 from mlrun.utils.helpers import to_parquet
 from mlrun.utils.v3io_clients import get_frames_client
 
 from .. import errors
 from ..data_types import ValueType
@@ -53,40 +55,45 @@
     redisnosql = "redisnosql"
     tsdb = "tsdb"
     stream = "stream"
     kafka = "kafka"
     dataframe = "dataframe"
     custom = "custom"
     sql = "sql"
+    snowflake = "snowflake"
 
     @staticmethod
     def all():
         return [
             TargetTypes.csv,
             TargetTypes.parquet,
             TargetTypes.nosql,
             TargetTypes.redisnosql,
             TargetTypes.tsdb,
             TargetTypes.stream,
             TargetTypes.kafka,
             TargetTypes.dataframe,
             TargetTypes.custom,
             TargetTypes.sql,
+            TargetTypes.snowflake,
         ]
 
 
 def generate_target_run_id():
     return f"{round(time.time() * 1000)}_{random.randint(0, 999)}"
 
 
-def write_spark_dataframe_with_options(spark_options, df, mode):
+def write_spark_dataframe_with_options(spark_options, df, mode, write_format=None):
     non_hadoop_spark_options = spark_session_update_hadoop_options(
         df.sql_ctx.sparkSession, spark_options
     )
-    df.write.mode(mode).save(**non_hadoop_spark_options)
+    if write_format:
+        df.write.format(write_format).mode(mode).save(**non_hadoop_spark_options)
+    else:
+        df.write.mode(mode).save(**non_hadoop_spark_options)
 
 
 def default_target_names():
     targets = mlrun.mlconf.feature_store.default_targets
     return [target.strip() for target in targets.split(",")]
 
 
@@ -493,15 +500,18 @@
         chunk_id=0,
         **kwargs,
     ) -> Optional[int]:
         if hasattr(df, "rdd"):
             options = self.get_spark_options(key_column, timestamp_key)
             options.update(kwargs)
             df = self.prepare_spark_df(df, key_column, timestamp_key, options)
-            write_spark_dataframe_with_options(options, df, "overwrite")
+            write_format = options.pop("format", None)
+            write_spark_dataframe_with_options(
+                options, df, "overwrite", write_format=write_format
+            )
         elif hasattr(df, "dask"):
             dask_options = self.get_dask_options()
             store, path_in_store, target_path = self._get_store_and_path()
             storage_options = store.get_storage_options()
             df = df.repartition(partition_size="100MB")
             try:
                 if dask_options["format"] == "parquet":
@@ -1109,14 +1119,105 @@
 
     def is_single_file(self):
         if self.path:
             return self.path.endswith(".csv")
         return True
 
 
+class SnowflakeTarget(BaseStoreTarget):
+    """
+    :param attributes: A dictionary of attributes for Snowflake connection; will be overridden by database parameters
+                       if they exist.
+    :param url: Snowflake hostname, in the format: <account_name>.<region>.snowflakecomputing.com
+    :param user: Snowflake user for login
+    :param db_schema: Database schema
+    :param database: Database name
+    :param warehouse: Snowflake warehouse name
+    :param table_name: Snowflake table name
+    """
+
+    support_spark = True
+    support_append = True
+    is_offline = True
+    kind = TargetTypes.snowflake
+
+    def __init__(
+        self,
+        name: str = "",
+        path=None,
+        attributes: dict[str, str] = None,
+        after_step=None,
+        columns=None,
+        partitioned: bool = False,
+        key_bucketing_number: Optional[int] = None,
+        partition_cols: Optional[list[str]] = None,
+        time_partitioning_granularity: Optional[str] = None,
+        max_events: Optional[int] = None,
+        flush_after_seconds: Optional[int] = None,
+        storage_options: dict[str, str] = None,
+        schema: dict[str, Any] = None,
+        credentials_prefix=None,
+        url: str = None,
+        user: str = None,
+        db_schema: str = None,
+        database: str = None,
+        warehouse: str = None,
+        table_name: str = None,
+    ):
+        attrs = {
+            "url": url,
+            "user": user,
+            "database": database,
+            "schema": db_schema,
+            "warehouse": warehouse,
+            "table": table_name,
+        }
+        extended_attrs = {
+            key: value for key, value in attrs.items() if value is not None
+        }
+        attributes = {} if not attributes else attributes
+        attributes.update(extended_attrs)
+        super().__init__(
+            name,
+            path,
+            attributes,
+            after_step,
+            list(schema.keys()) if schema else columns,
+            partitioned,
+            key_bucketing_number,
+            partition_cols,
+            time_partitioning_granularity,
+            max_events=max_events,
+            flush_after_seconds=flush_after_seconds,
+            storage_options=storage_options,
+            schema=schema,
+            credentials_prefix=credentials_prefix,
+        )
+
+    def get_spark_options(self, key_column=None, timestamp_key=None, overwrite=True):
+        spark_options = get_snowflake_spark_options(self.attributes)
+        spark_options["dbtable"] = self.attributes.get("table")
+        return spark_options
+
+    def purge(self):
+        pass
+
+    def as_df(
+        self,
+        columns=None,
+        df_module=None,
+        entities=None,
+        start_time=None,
+        end_time=None,
+        time_column=None,
+        **kwargs,
+    ):
+        raise NotImplementedError()
+
+
 class NoSqlBaseTarget(BaseStoreTarget):
     is_table = True
     is_online = True
     support_append = True
     support_storey = True
     writer_step_name = "base_name"
 
@@ -1180,15 +1281,18 @@
     def write_dataframe(
         self, df, key_column=None, timestamp_key=None, chunk_id=0, **kwargs
     ):
         if hasattr(df, "rdd"):
             options = self.get_spark_options(key_column, timestamp_key)
             options.update(kwargs)
             df = self.prepare_spark_df(df)
-            write_spark_dataframe_with_options(options, df, "overwrite")
+            write_format = options.pop("format", None)
+            write_spark_dataframe_with_options(
+                options, df, "overwrite", write_format=write_format
+            )
         else:
             # To prevent modification of the original dataframe and make sure
             # that the last event of a key is the one being persisted
             if len(df.index.names) and df.index.names[0] is not None:
                 df = df.groupby(df.index.names).last()
             else:
                 df = df.copy(deep=False)
@@ -1420,19 +1524,27 @@
     support_append = True
 
     def __init__(
         self,
         *args,
         bootstrap_servers=None,
         producer_options=None,
+        brokers=None,
         **kwargs,
     ):
         attrs = {}
+        if bootstrap_servers:
+            warnings.warn(
+                "'bootstrap_servers' parameter is deprecated in 1.7.0 and will be removed in 1.9.0, "
+                "use 'brokers' instead.",
+                # TODO: Remove this in 1.9.0
+                FutureWarning,
+            )
         if bootstrap_servers is not None:
-            attrs["bootstrap_servers"] = bootstrap_servers
+            attrs["brokers"] = brokers or bootstrap_servers
         if producer_options is not None:
             attrs["producer_options"] = producer_options
 
         super().__init__(*args, attributes=attrs, **kwargs)
 
     def add_writer_step(
         self,
@@ -1446,36 +1558,38 @@
         key_columns = list(key_columns.keys())
         column_list = self._get_column_list(
             features=features, timestamp_key=timestamp_key, key_columns=key_columns
         )
         if self.path and self.path.startswith("ds://"):
             datastore_profile = datastore_profile_read(self.path)
             attributes = datastore_profile.attributes()
-            bootstrap_servers = attributes.pop("bootstrap_servers", None)
+            brokers = attributes.pop(
+                "brokers", attributes.pop("bootstrap_servers", None)
+            )
             topic = datastore_profile.topic
         else:
             attributes = copy(self.attributes)
-            bootstrap_servers = attributes.pop("bootstrap_servers", None)
-            topic, bootstrap_servers = parse_kafka_url(
-                self.get_target_path(), bootstrap_servers
+            brokers = attributes.pop(
+                "brokers", attributes.pop("bootstrap_servers", None)
             )
+            topic, brokers = parse_kafka_url(self.get_target_path(), brokers)
 
         if not topic:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "KafkaTarget requires a path (topic)"
             )
 
         graph.add_step(
             name=self.name or "KafkaTarget",
             after=after,
             graph_shape="cylinder",
             class_name="storey.KafkaTarget",
             columns=column_list,
             topic=topic,
-            bootstrap_servers=bootstrap_servers,
+            brokers=brokers,
             **attributes,
         )
 
     def as_df(self, columns=None, df_module=None, **kwargs):
         raise NotImplementedError()
 
     def purge(self):
@@ -1958,14 +2072,15 @@
     TargetTypes.redisnosql: RedisNoSqlTarget,
     TargetTypes.dataframe: DFTarget,
     TargetTypes.stream: StreamTarget,
     TargetTypes.kafka: KafkaTarget,
     TargetTypes.tsdb: TSDBTarget,
     TargetTypes.custom: CustomTarget,
     TargetTypes.sql: SQLTarget,
+    TargetTypes.snowflake: SnowflakeTarget,
 }
 
 
 def _get_target_path(driver, resource, run_id_mode=False):
     """return the default target path given the resource and target kind"""
     kind = driver.kind
     suffix = driver.suffix
```

## mlrun/datastore/utils.py

```diff
@@ -19,41 +19,46 @@
 
 import pandas as pd
 import semver
 
 import mlrun.datastore
 
 
-def parse_kafka_url(url: str, bootstrap_servers: list = None) -> tuple[str, list]:
+def parse_kafka_url(
+    url: str, brokers: typing.Union[list, str] = None
+) -> tuple[str, list]:
     """Generating Kafka topic and adjusting a list of bootstrap servers.
 
     :param url:               URL path to parse using urllib.parse.urlparse.
-    :param bootstrap_servers: List of bootstrap servers for the kafka brokers.
+    :param brokers: List of kafka brokers.
 
     :return: A tuple of:
          [0] = Kafka topic value
          [1] = List of bootstrap servers
     """
-    bootstrap_servers = bootstrap_servers or []
+    brokers = brokers or []
+
+    if isinstance(brokers, str):
+        brokers = brokers.split(",")
 
     # Parse the provided URL into six components according to the general structure of a URL
     url = urlparse(url)
 
     # Add the network location to the bootstrap servers list
     if url.netloc:
-        bootstrap_servers = [url.netloc] + bootstrap_servers
+        brokers = [url.netloc] + brokers
 
     # Get the topic value from the parsed url
     query_dict = parse_qs(url.query)
     if "topic" in query_dict:
         topic = query_dict["topic"][0]
     else:
         topic = url.path
         topic = topic.lstrip("/")
-    return topic, bootstrap_servers
+    return topic, brokers
 
 
 def upload_tarball(source_dir, target, secrets=None):
     # will delete the temp file
     with tempfile.NamedTemporaryFile(suffix=".tar.gz") as temp_fh:
         with tarfile.open(mode="w:gz", fileobj=temp_fh) as tar:
             tar.add(source_dir, arcname="")
```

## mlrun/db/base.py

```diff
@@ -630,75 +630,116 @@
     def get_api_gateway(self, name, project=None) -> mlrun.common.schemas.APIGateway:
         pass
 
     @abstractmethod
     def delete_api_gateway(self, name, project=None):
         pass
 
+    @abstractmethod
+    def remote_builder(
+        self,
+        func: "mlrun.runtimes.BaseRuntime",
+        with_mlrun: bool,
+        mlrun_version_specifier: Optional[str] = None,
+        skip_deployed: bool = False,
+        builder_env: Optional[dict] = None,
+        force_build: bool = False,
+    ):
+        pass
+
+    @abstractmethod
+    def deploy_nuclio_function(
+        self,
+        func: "mlrun.runtimes.RemoteRuntime",
+        builder_env: Optional[dict] = None,
+    ):
+        pass
+
+    @abstractmethod
     def get_builder_status(
         self,
         func: "mlrun.runtimes.BaseRuntime",
         offset: int = 0,
         logs: bool = True,
         last_log_timestamp: float = 0.0,
         verbose: bool = False,
     ):
         pass
 
+    @abstractmethod
+    def get_nuclio_deploy_status(
+        self,
+        func: "mlrun.runtimes.RemoteRuntime",
+        last_log_timestamp: float = 0.0,
+        verbose: bool = False,
+    ):
+        pass
+
+    @abstractmethod
     def set_run_notifications(
         self,
         project: str,
         runs: list[mlrun.model.RunObject],
         notifications: list[mlrun.model.Notification],
     ):
         pass
 
+    @abstractmethod
     def store_run_notifications(
         self,
         notification_objects: list[mlrun.model.Notification],
         run_uid: str,
         project: str = None,
         mask_params: bool = True,
     ):
         pass
 
+    @abstractmethod
     def get_log_size(self, uid, project=""):
         pass
 
+    @abstractmethod
     def watch_log(self, uid, project="", watch=True, offset=0):
         pass
 
+    @abstractmethod
     def get_datastore_profile(
         self, name: str, project: str
     ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
         pass
 
+    @abstractmethod
     def delete_datastore_profile(
         self, name: str, project: str
     ) -> mlrun.common.schemas.DatastoreProfile:
         pass
 
+    @abstractmethod
     def list_datastore_profiles(
         self, project: str
     ) -> list[mlrun.common.schemas.DatastoreProfile]:
         pass
 
+    @abstractmethod
     def store_datastore_profile(
         self, profile: mlrun.common.schemas.DatastoreProfile, project: str
     ):
         pass
 
+    @abstractmethod
     def function_status(self, project, name, kind, selector):
         pass
 
+    @abstractmethod
     def start_function(
         self, func_url: str = None, function: "mlrun.runtimes.BaseRuntime" = None
     ):
         pass
 
+    @abstractmethod
     def submit_workflow(
         self,
         project: str,
         name: str,
         workflow_spec: Union[
             "mlrun.projects.pipelines.WorkflowSpec",
             "mlrun.common.schemas.WorkflowSpec",
@@ -709,28 +750,31 @@
         source: Optional[str] = None,
         run_name: Optional[str] = None,
         namespace: Optional[str] = None,
         notifications: list["mlrun.model.Notification"] = None,
     ) -> "mlrun.common.schemas.WorkflowResponse":
         pass
 
+    @abstractmethod
     def update_model_monitoring_controller(
         self,
         project: str,
         base_period: int = 10,
         image: str = "mlrun/mlrun",
     ):
         pass
 
+    @abstractmethod
     def enable_model_monitoring(
         self,
         project: str,
         base_period: int = 10,
         image: str = "mlrun/mlrun",
         deploy_histogram_data_drift_app: bool = True,
     ) -> None:
         raise NotImplementedError
 
+    @abstractmethod
     def deploy_histogram_data_drift_app(
         self, project: str, image: str = "mlrun/mlrun"
     ) -> None:
         raise NotImplementedError
```

## mlrun/db/httpdb.py

```diff
@@ -3260,6664 +3260,6912 @@
 0000cbb0: 7265 2074 6865 7920 6172 6520 6163 7475  re they are actu
 0000cbc0: 616c 6c79 2072 656d 6f76 6564 2c20 636f  ally removed, co
 0000cbd0: 756e 7465 6420 6672 6f6d 0a20 2020 2020  unted from.     
 0000cbe0: 2020 2020 2020 2074 6865 206d 6f6d 656e         the momen
 0000cbf0: 7420 7468 6579 206d 6f76 6564 2074 6f20  t they moved to 
 0000cc00: 7465 726d 696e 616c 2073 7461 7465 0a20  terminal state. 
 0000cc10: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
-0000cc20: 756c 7473 2074 6f20 6d6c 7275 6e2e 636f  ults to mlrun.co
-0000cc30: 6e66 6967 2e63 6f6e 6669 672e 7275 6e74  nfig.config.runt
-0000cc40: 696d 655f 7265 736f 7572 6365 735f 6465  ime_resources_de
-0000cc50: 6c65 7469 6f6e 5f67 7261 6365 5f70 6572  letion_grace_per
-0000cc60: 696f 6429 2e0a 0a20 2020 2020 2020 203a  iod)...        :
-0000cc70: 7265 7475 726e 733a 203a 7079 3a63 6c61  returns: :py:cla
-0000cc80: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
-0000cc90: 6e2e 7363 6865 6d61 732e 4772 6f75 7065  n.schemas.Groupe
-0000cca0: 6442 7950 726f 6a65 6374 5275 6e74 696d  dByProjectRuntim
-0000ccb0: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
-0000ccc0: 6020 6c69 7374 696e 6720 7468 6520 7275  ` listing the ru
-0000ccd0: 6e74 696d 6520 7265 736f 7572 6365 730a  ntime resources.
-0000cce0: 2020 2020 2020 2020 2020 2020 7468 6174              that
-0000ccf0: 2077 6572 6520 7265 6d6f 7665 642e 0a20   were removed.. 
-0000cd00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000cd10: 2020 2069 6620 6772 6163 655f 7065 7269     if grace_peri
-0000cd20: 6f64 2069 7320 4e6f 6e65 3a0a 2020 2020  od is None:.    
-0000cd30: 2020 2020 2020 2020 6772 6163 655f 7065          grace_pe
-0000cd40: 7269 6f64 203d 2063 6f6e 6669 672e 7275  riod = config.ru
-0000cd50: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
-0000cd60: 6465 6c65 7469 6f6e 5f67 7261 6365 5f70  deletion_grace_p
-0000cd70: 6572 696f 640a 2020 2020 2020 2020 2020  eriod.          
-0000cd80: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
-0000cd90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000cda0: 5573 696e 6720 6465 6661 756c 7420 6772  Using default gr
-0000cdb0: 6163 6520 7065 7269 6f64 2066 6f72 2072  ace period for r
-0000cdc0: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
-0000cdd0: 2064 656c 6574 696f 6e22 2c0a 2020 2020   deletion",.    
-0000cde0: 2020 2020 2020 2020 2020 2020 6772 6163              grac
-0000cdf0: 655f 7065 7269 6f64 3d67 7261 6365 5f70  e_period=grace_p
-0000ce00: 6572 696f 642c 0a20 2020 2020 2020 2020  eriod,.         
-0000ce10: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
-0000ce20: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0000ce30: 2020 2020 2022 6c61 6265 6c2d 7365 6c65       "label-sele
-0000ce40: 6374 6f72 223a 206c 6162 656c 5f73 656c  ctor": label_sel
-0000ce50: 6563 746f 722c 0a20 2020 2020 2020 2020  ector,.         
-0000ce60: 2020 2022 6b69 6e64 223a 206b 696e 642c     "kind": kind,
-0000ce70: 0a20 2020 2020 2020 2020 2020 2022 6f62  .            "ob
-0000ce80: 6a65 6374 2d69 6422 3a20 6f62 6a65 6374  ject-id": object
-0000ce90: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-0000cea0: 2022 666f 7263 6522 3a20 666f 7263 652c   "force": force,
-0000ceb0: 0a20 2020 2020 2020 2020 2020 2022 6772  .            "gr
-0000cec0: 6163 652d 7065 7269 6f64 223a 2067 7261  ace-period": gra
-0000ced0: 6365 5f70 6572 696f 642c 0a20 2020 2020  ce_period,.     
-0000cee0: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
-0000cef0: 6f72 203d 2022 4661 696c 6564 2064 656c  or = "Failed del
-0000cf00: 6574 696e 6720 7275 6e74 696d 6520 7265  eting runtime re
-0000cf10: 736f 7572 6365 7322 0a20 2020 2020 2020  sources".       
-0000cf20: 2070 726f 6a65 6374 5f70 6174 6820 3d20   project_path = 
-0000cf30: 7072 6f6a 6563 7420 6966 2070 726f 6a65  project if proje
-0000cf40: 6374 2065 6c73 6520 222a 220a 2020 2020  ct else "*".    
-0000cf50: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0000cf60: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0000cf70: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
-0000cf80: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
-0000cf90: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0000cfa0: 6563 745f 7061 7468 7d2f 7275 6e74 696d  ect_path}/runtim
-0000cfb0: 652d 7265 736f 7572 6365 7322 2c0a 2020  e-resources",.  
-0000cfc0: 2020 2020 2020 2020 2020 6572 726f 722c            error,
-0000cfd0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0000cfe0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
-0000cff0: 2020 2020 290a 2020 2020 2020 2020 7374      ).        st
-0000d000: 7275 6374 7572 6564 5f64 6963 7420 3d20  ructured_dict = 
-0000d010: 7b7d 0a20 2020 2020 2020 2066 6f72 2070  {}.        for p
-0000d020: 726f 6a65 6374 2c20 6b69 6e64 5f72 756e  roject, kind_run
-0000d030: 7469 6d65 5f72 6573 6f75 7263 6573 5f6d  time_resources_m
-0000d040: 6170 2069 6e20 7265 7370 6f6e 7365 2e6a  ap in response.j
-0000d050: 736f 6e28 292e 6974 656d 7328 293a 0a20  son().items():. 
-0000d060: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0000d070: 696e 642c 2072 756e 7469 6d65 5f72 6573  ind, runtime_res
-0000d080: 6f75 7263 6573 2069 6e20 6b69 6e64 5f72  ources in kind_r
-0000d090: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000d0a0: 5f6d 6170 2e69 7465 6d73 2829 3a0a 2020  _map.items():.  
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0000d0c0: 7275 6374 7572 6564 5f64 6963 742e 7365  ructured_dict.se
-0000d0d0: 7464 6566 6175 6c74 2870 726f 6a65 6374  tdefault(project
-0000d0e0: 2c20 7b7d 295b 6b69 6e64 5d20 3d20 280a  , {})[kind] = (.
-0000d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d100: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
-0000d110: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
-0000d120: 5265 736f 7572 6365 7328 2a2a 7275 6e74  Resources(**runt
-0000d130: 696d 655f 7265 736f 7572 6365 7329 0a20  ime_resources). 
-0000d140: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000d150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d160: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
-0000d170: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
-0000d180: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
-0000d190: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
-0000d1a0: 2073 7472 2c20 7363 6865 6475 6c65 3a20   str, schedule: 
-0000d1b0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0000d1c0: 656d 6173 2e53 6368 6564 756c 6549 6e70  emas.ScheduleInp
-0000d1d0: 7574 0a20 2020 2029 3a0a 2020 2020 2020  ut.    ):.      
-0000d1e0: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
-0000d1f0: 7720 7363 6865 6475 6c65 206f 6e20 7468  w schedule on th
-0000d200: 6520 6769 7665 6e20 7072 6f6a 6563 742e  e given project.
-0000d210: 2054 6865 2064 6574 6169 6c73 206f 6e20   The details on 
-0000d220: 7468 6520 6163 7475 616c 206f 626a 6563  the actual objec
-0000d230: 7420 746f 2073 6368 6564 756c 6520 6173  t to schedule as
-0000d240: 2077 656c 6c20 6173 2074 6865 0a20 2020   well as the.   
-0000d250: 2020 2020 2073 6368 6564 756c 6520 6974       schedule it
-0000d260: 7365 6c66 2061 7265 2077 6974 6869 6e20  self are within 
-0000d270: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
-0000d280: 6563 7420 7072 6f76 6964 6564 2e0a 2020  ect provided..  
-0000d290: 2020 2020 2020 5468 6520 3a70 793a 636c        The :py:cl
-0000d2a0: 6173 733a 607e 5363 6865 6475 6c65 4372  ass:`~ScheduleCr
-0000d2b0: 6f6e 5472 6967 6765 7260 2066 6f6c 6c6f  onTrigger` follo
-0000d2c0: 7773 2074 6865 2067 7569 6465 6c69 6e65  ws the guideline
-0000d2d0: 7320 696e 0a20 2020 2020 2020 2068 7474  s in.        htt
-0000d2e0: 7073 3a2f 2f61 7073 6368 6564 756c 6572  ps://apscheduler
-0000d2f0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
-0000d300: 656e 2f33 2e78 2f6d 6f64 756c 6573 2f74  en/3.x/modules/t
-0000d310: 7269 6767 6572 732f 6372 6f6e 2e68 746d  riggers/cron.htm
-0000d320: 6c2e 0a20 2020 2020 2020 2049 7420 616c  l..        It al
-0000d330: 736f 2073 7570 706f 7274 7320 6120 3a70  so supports a :p
-0000d340: 793a 6675 6e63 3a60 7e53 6368 6564 756c  y:func:`~Schedul
-0000d350: 6543 726f 6e54 7269 6767 6572 2e66 726f  eCronTrigger.fro
-0000d360: 6d5f 6372 6f6e 7461 6260 2066 756e 6374  m_crontab` funct
-0000d370: 696f 6e20 7468 6174 2061 6363 6570 7473  ion that accepts
-0000d380: 2061 0a20 2020 2020 2020 2063 726f 6e74   a.        cront
-0000d390: 6162 2d66 6f72 6d61 7474 6564 2073 7472  ab-formatted str
-0000d3a0: 696e 6720 2873 6565 2068 7474 7073 3a2f  ing (see https:/
-0000d3b0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-0000d3c0: 672f 7769 6b69 2f43 726f 6e20 666f 7220  g/wiki/Cron for 
-0000d3d0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-0000d3e0: 206f 6e20 7468 6520 666f 726d 6174 2061   on the format a
-0000d3f0: 6e64 0a20 2020 2020 2020 206e 6f74 6520  nd.        note 
-0000d400: 7468 6174 2074 6865 2030 2077 6565 6b64  that the 0 weekd
-0000d410: 6179 2069 7320 616c 7761 7973 206d 6f6e  ay is always mon
-0000d420: 6461 7929 2e0a 0a0a 2020 2020 2020 2020  day)....        
-0000d430: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0000d440: 2020 2020 2020 2066 726f 6d20 6d6c 7275         from mlru
-0000d450: 6e2e 636f 6d6d 6f6e 2069 6d70 6f72 7420  n.common import 
-0000d460: 7363 6865 6d61 730a 0a20 2020 2020 2020  schemas..       
-0000d470: 2020 2020 2023 2045 7865 6375 7465 2074       # Execute t
-0000d480: 6865 2067 6574 5f64 6174 615f 6675 6e63  he get_data_func
-0000d490: 2066 756e 6374 696f 6e20 6576 6572 7920   function every 
-0000d4a0: 5475 6573 6461 7920 6174 2031 353a 3330  Tuesday at 15:30
-0000d4b0: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
-0000d4c0: 6564 756c 6520 3d20 7363 6865 6d61 732e  edule = schemas.
-0000d4d0: 5363 6865 6475 6c65 496e 7075 7428 0a20  ScheduleInput(. 
-0000d4e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000d4f0: 616d 653d 2272 756e 5f66 756e 635f 6f6e  ame="run_func_on
-0000d500: 5f74 7565 7364 6179 7322 2c0a 2020 2020  _tuesdays",.    
-0000d510: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
-0000d520: 3d22 6a6f 6222 2c0a 2020 2020 2020 2020  ="job",.        
-0000d530: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
-0000d540: 645f 6f62 6a65 6374 3d67 6574 5f64 6174  d_object=get_dat
-0000d550: 615f 6675 6e63 2c0a 2020 2020 2020 2020  a_func,.        
-0000d560: 2020 2020 2020 2020 6372 6f6e 5f74 7269          cron_tri
-0000d570: 6767 6572 3d73 6368 656d 6173 2e53 6368  gger=schemas.Sch
-0000d580: 6564 756c 6543 726f 6e54 7269 6767 6572  eduleCronTrigger
-0000d590: 2864 6179 5f6f 665f 7765 656b 3d27 7475  (day_of_week='tu
-0000d5a0: 6527 2c20 686f 7572 3d31 352c 206d 696e  e', hour=15, min
-0000d5b0: 7574 653d 3330 292c 0a20 2020 2020 2020  ute=30),.       
-0000d5c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000d5d0: 2020 2064 622e 6372 6561 7465 5f73 6368     db.create_sch
-0000d5e0: 6564 756c 6528 7072 6f6a 6563 745f 6e61  edule(project_na
-0000d5f0: 6d65 2c20 7363 6865 6475 6c65 290a 2020  me, schedule).  
-0000d600: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000d610: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-0000d620: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-0000d630: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-0000d640: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0000d650: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0000d660: 747d 2f73 6368 6564 756c 6573 220a 0a20  t}/schedules".. 
-0000d670: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000d680: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000d690: 6372 6561 7469 6e67 2073 6368 6564 756c  creating schedul
-0000d6a0: 6520 7b70 726f 6a65 6374 7d2f 7b73 6368  e {project}/{sch
-0000d6b0: 6564 756c 652e 6e61 6d65 7d22 0a20 2020  edule.name}".   
-0000d6c0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0000d6d0: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
-0000d6e0: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
-0000d6f0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-0000d700: 6e28 7363 6865 6475 6c65 2e64 6963 7428  n(schedule.dict(
-0000d710: 2929 290a 0a20 2020 2064 6566 2075 7064  )))..    def upd
-0000d720: 6174 655f 7363 6865 6475 6c65 280a 2020  ate_schedule(.  
-0000d730: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
-0000d740: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
-0000d750: 7374 722c 2073 6368 6564 756c 653a 206d  str, schedule: m
-0000d760: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000d770: 6d61 732e 5363 6865 6475 6c65 5570 6461  mas.ScheduleUpda
-0000d780: 7465 0a20 2020 2029 3a0a 2020 2020 2020  te.    ):.      
-0000d790: 2020 2222 2255 7064 6174 6520 616e 2065    """Update an e
-0000d7a0: 7869 7374 696e 6720 7363 6865 6475 6c65  xisting schedule
-0000d7b0: 2c20 7265 706c 6163 6520 6974 2077 6974  , replace it wit
-0000d7c0: 6820 7468 6520 6465 7461 696c 7320 636f  h the details co
-0000d7d0: 6e74 6169 6e65 6420 696e 2074 6865 2073  ntained in the s
-0000d7e0: 6368 6564 756c 6520 6f62 6a65 6374 2e22  chedule object."
-0000d7f0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-0000d800: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-0000d810: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-0000d820: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0000d830: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0000d840: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
-0000d850: 6475 6c65 732f 7b6e 616d 657d 220a 0a20  dules/{name}".. 
-0000d860: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000d870: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000d880: 7570 6461 7469 6e67 2073 6368 6564 756c  updating schedul
-0000d890: 6520 7b70 726f 6a65 6374 7d2f 7b6e 616d  e {project}/{nam
-0000d8a0: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
-0000d8b0: 2e61 7069 5f63 616c 6c28 2250 5554 222c  .api_call("PUT",
-0000d8c0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-0000d8d0: 7361 6765 2c20 626f 6479 3d64 6963 745f  sage, body=dict_
-0000d8e0: 746f 5f6a 736f 6e28 7363 6865 6475 6c65  to_json(schedule
-0000d8f0: 2e64 6963 7428 2929 290a 0a20 2020 2064  .dict()))..    d
-0000d900: 6566 2067 6574 5f73 6368 6564 756c 6528  ef get_schedule(
-0000d910: 0a20 2020 2020 2020 2073 656c 662c 2070  .        self, p
-0000d920: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000d930: 653a 2073 7472 2c20 696e 636c 7564 655f  e: str, include_
-0000d940: 6c61 7374 5f72 756e 3a20 626f 6f6c 203d  last_run: bool =
-0000d950: 2046 616c 7365 0a20 2020 2029 202d 3e20   False.    ) -> 
-0000d960: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0000d970: 656d 6173 2e53 6368 6564 756c 654f 7574  emas.ScheduleOut
-0000d980: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
-0000d990: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
-0000d9a0: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
-0000d9b0: 2069 6e20 7175 6573 7469 6f6e 2e20 4265   in question. Be
-0000d9c0: 7369 6465 7320 7265 7475 726e 696e 6720  sides returning 
-0000d9d0: 7468 6520 6465 7461 696c 7320 6f66 2074  the details of t
-0000d9e0: 6865 2073 6368 6564 756c 6520 6f62 6a65  he schedule obje
-0000d9f0: 6374 2069 7473 656c 662c 0a20 2020 2020  ct itself,.     
-0000da00: 2020 2074 6869 7320 6675 6e63 7469 6f6e     this function
-0000da10: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
-0000da20: 6520 6e65 7874 2073 6368 6564 756c 6564  e next scheduled
-0000da30: 2072 756e 2066 6f72 2074 6869 7320 7370   run for this sp
-0000da40: 6563 6966 6963 2073 6368 6564 756c 652c  ecific schedule,
-0000da50: 2061 7320 7765 6c6c 2061 7320 706f 7465   as well as pote
-0000da60: 6e74 6961 6c6c 7920 7468 650a 2020 2020  ntially the.    
-0000da70: 2020 2020 7265 7375 6c74 7320 6f66 2074      results of t
-0000da80: 6865 206c 6173 7420 7275 6e20 6578 6563  he last run exec
-0000da90: 7574 6564 2074 6872 6f75 6768 2074 6869  uted through thi
-0000daa0: 7320 7363 6865 6475 6c65 2e0a 0a20 2020  s schedule...   
-0000dab0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0000dac0: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-0000dad0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000dae0: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-0000daf0: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
-0000db00: 6563 7420 746f 2071 7565 7279 2e0a 2020  ect to query..  
-0000db10: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
-0000db20: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
-0000db30: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0000db40: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
-0000db50: 2074 6865 2073 6368 6564 756c 6527 7320   the schedule's 
-0000db60: 6c61 7374 2072 756e 2069 6e20 7468 6520  last run in the 
-0000db70: 7265 7370 6f6e 7365 2e0a 2020 2020 2020  response..      
-0000db80: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-0000db90: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-0000dba0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-0000dbb0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-0000dbc0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0000dbd0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
-0000dbe0: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
-0000dbf0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000dc00: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0000dc10: 6420 6765 7474 696e 6720 7363 6865 6475  d getting schedu
-0000dc20: 6c65 2066 6f72 207b 7072 6f6a 6563 747d  le for {project}
-0000dc30: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000dc40: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-0000dc50: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0000dc60: 2020 2022 4745 5422 2c20 7061 7468 2c20     "GET", path, 
-0000dc70: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-0000dc80: 6172 616d 733d 7b22 696e 636c 7564 655f  arams={"include_
-0000dc90: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
-0000dca0: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
-0000dcb0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000dcc0: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
-0000dcd0: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
-0000dce0: 756c 654f 7574 7075 7428 2a2a 7265 7370  uleOutput(**resp
-0000dcf0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
-0000dd00: 6620 6c69 7374 5f73 6368 6564 756c 6573  f list_schedules
-0000dd10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000dd20: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-0000dd30: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
-0000dd40: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
-0000dd50: 2020 2020 2020 2020 6b69 6e64 3a20 6d6c          kind: ml
-0000dd60: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000dd70: 6173 2e53 6368 6564 756c 654b 696e 6473  as.ScheduleKinds
-0000dd80: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000dd90: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
-0000dda0: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 652c  n: bool = False,
-0000ddb0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
-0000ddc0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0000ddd0: 6368 6564 756c 6573 4f75 7470 7574 3a0a  chedulesOutput:.
-0000dde0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
-0000ddf0: 6576 6520 6c69 7374 206f 6620 7363 6865  eve list of sche
-0000de00: 6475 6c65 7320 6f66 2073 7065 6369 6669  dules of specifi
-0000de10: 6320 6e61 6d65 206f 7220 6b69 6e64 2e0a  c name or kind..
-0000de20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000de30: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-0000de40: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
-0000de50: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
-0000de60: 206f 6620 7363 6865 6475 6c65 2074 6f20   of schedule to 
-0000de70: 7265 7472 6965 7665 2e20 4361 6e20 6265  retrieve. Can be
-0000de80: 206f 6d69 7474 6564 2074 6f20 6c69 7374   omitted to list
-0000de90: 2061 6c6c 2073 6368 6564 756c 6573 2e0a   all schedules..
-0000dea0: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
-0000deb0: 696e 643a 204b 696e 6420 6f66 2073 6368  ind: Kind of sch
-0000dec0: 6564 756c 6520 6f62 6a65 6374 7320 746f  edule objects to
-0000ded0: 2072 6574 7269 6576 652c 2063 616e 2062   retrieve, can b
-0000dee0: 6520 6569 7468 6572 2060 606a 6f62 6060  e either ``job``
-0000def0: 206f 7220 6060 7069 7065 6c69 6e65 6060   or ``pipeline``
-0000df00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000df10: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
-0000df20: 6e3a 2057 6865 7468 6572 2074 6f20 7265  n: Whether to re
-0000df30: 7475 726e 2066 6f72 2065 6163 6820 7363  turn for each sc
-0000df40: 6865 6475 6c65 2072 6574 7572 6e65 6420  hedule returned 
-0000df50: 616c 736f 2074 6865 2072 6573 756c 7473  also the results
-0000df60: 206f 6620 7468 6520 6c61 7374 2072 756e   of the last run
-0000df70: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
-0000df80: 7468 6174 2073 6368 6564 756c 652e 0a20  that schedule.. 
-0000df90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000dfa0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000dfb0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000dfc0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000dfd0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-0000dfe0: 207b 226b 696e 6422 3a20 6b69 6e64 2c20   {"kind": kind, 
-0000dff0: 226e 616d 6522 3a20 6e61 6d65 2c20 2269  "name": name, "i
-0000e000: 6e63 6c75 6465 5f6c 6173 745f 7275 6e22  nclude_last_run"
-0000e010: 3a20 696e 636c 7564 655f 6c61 7374 5f72  : include_last_r
-0000e020: 756e 7d0a 2020 2020 2020 2020 7061 7468  un}.        path
-0000e030: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0000e040: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
-0000e050: 7322 0a20 2020 2020 2020 2065 7272 6f72  s".        error
-0000e060: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-0000e070: 6c65 6420 6c69 7374 696e 6720 7363 6865  led listing sche
-0000e080: 6475 6c65 7320 666f 7220 7b70 726f 6a65  dules for {proje
-0000e090: 6374 7d20 3f20 7b6b 696e 647d 207b 6e61  ct} ? {kind} {na
-0000e0a0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-0000e0b0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000e0c0: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
-0000e0d0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
-0000e0e0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0000e0f0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0000e100: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000e110: 2e53 6368 6564 756c 6573 4f75 7470 7574  .SchedulesOutput
-0000e120: 282a 2a72 6573 702e 6a73 6f6e 2829 290a  (**resp.json()).
-0000e130: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
-0000e140: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
-0000e150: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000e160: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0000e170: 2022 2222 4465 6c65 7465 2061 2073 7065   """Delete a spe
-0000e180: 6369 6669 6320 7363 6865 6475 6c65 2062  cific schedule b
-0000e190: 7920 6e61 6d65 2e22 2222 0a0a 2020 2020  y name."""..    
-0000e1a0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000e1b0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000e1c0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000e1d0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0000e1e0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0000e1f0: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
-0000e200: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
-0000e210: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0000e220: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-0000e230: 7363 6865 6475 6c65 207b 7072 6f6a 6563  schedule {projec
-0000e240: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
-0000e250: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-0000e260: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
-0000e270: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
-0000e280: 0a20 2020 2064 6566 2069 6e76 6f6b 655f  .    def invoke_
-0000e290: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
-0000e2a0: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000e2b0: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0000e2c0: 2022 2222 4578 6563 7574 6520 7468 6520   """Execute the 
-0000e2d0: 6f62 6a65 6374 2072 6566 6572 656e 6365  object reference
-0000e2e0: 6420 6279 2074 6865 2073 6368 6564 756c  d by the schedul
-0000e2f0: 6520 696d 6d65 6469 6174 656c 792e 2222  e immediately.""
-0000e300: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-0000e310: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-0000e320: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-0000e330: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-0000e340: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0000e350: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
-0000e360: 756c 6573 2f7b 6e61 6d65 7d2f 696e 766f  ules/{name}/invo
-0000e370: 6b65 220a 2020 2020 2020 2020 6572 726f  ke".        erro
-0000e380: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-0000e390: 696c 6564 2069 6e76 6f6b 696e 6720 7363  iled invoking sc
-0000e3a0: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
-0000e3b0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000e3c0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-0000e3d0: 504f 5354 222c 2070 6174 682c 2065 7272  POST", path, err
-0000e3e0: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
-0000e3f0: 2064 6566 2072 656d 6f74 655f 6275 696c   def remote_buil
-0000e400: 6465 7228 0a20 2020 2020 2020 2073 656c  der(.        sel
-0000e410: 662c 0a20 2020 2020 2020 2066 756e 633a  f,.        func:
-0000e420: 2042 6173 6552 756e 7469 6d65 2c0a 2020   BaseRuntime,.  
-0000e430: 2020 2020 2020 7769 7468 5f6d 6c72 756e        with_mlrun
-0000e440: 3a20 626f 6f6c 2c0a 2020 2020 2020 2020  : bool,.        
-0000e450: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000e460: 6563 6966 6965 723a 204f 7074 696f 6e61  ecifier: Optiona
-0000e470: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000e480: 2020 2020 2020 2073 6b69 705f 6465 706c         skip_depl
-0000e490: 6f79 6564 3a20 626f 6f6c 203d 2046 616c  oyed: bool = Fal
-0000e4a0: 7365 2c0a 2020 2020 2020 2020 6275 696c  se,.        buil
-0000e4b0: 6465 725f 656e 763a 204f 7074 696f 6e61  der_env: Optiona
-0000e4c0: 6c5b 6469 6374 5d20 3d20 4e6f 6e65 2c0a  l[dict] = None,.
-0000e4d0: 2020 2020 2020 2020 666f 7263 655f 6275          force_bu
-0000e4e0: 696c 643a 2062 6f6f 6c20 3d20 4661 6c73  ild: bool = Fals
-0000e4f0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000e500: 2020 2222 2242 7569 6c64 2074 6865 2070    """Build the p
-0000e510: 6f64 2069 6d61 6765 2066 6f72 2061 2066  od image for a f
-0000e520: 756e 6374 696f 6e2c 2066 6f72 2065 7865  unction, for exe
-0000e530: 6375 7469 6f6e 206f 6e20 6120 7265 6d6f  cution on a remo
-0000e540: 7465 2063 6c75 7374 6572 2e20 5468 6973  te cluster. This
-0000e550: 2069 7320 6578 6563 7574 6564 2062 7920   is executed by 
-0000e560: 7468 6520 4d4c 5275 6e0a 2020 2020 2020  the MLRun.      
-0000e570: 2020 4150 4920 7365 7276 6572 2c20 616e    API server, an
-0000e580: 6420 6372 6561 7465 7320 6120 446f 636b  d creates a Dock
-0000e590: 6572 2069 6d61 6765 206f 7574 206f 6620  er image out of 
-0000e5a0: 7468 6520 6675 6e63 7469 6f6e 2070 726f  the function pro
-0000e5b0: 7669 6465 6420 616e 6420 616e 7920 7370  vided and any sp
-0000e5c0: 6563 6966 6963 2062 7569 6c64 0a20 2020  ecific build.   
-0000e5d0: 2020 2020 2069 6e73 7472 7563 7469 6f6e       instruction
-0000e5e0: 7320 7072 6f76 6964 6564 2077 6974 6869  s provided withi
-0000e5f0: 6e2e 2054 6869 7320 6973 2061 2070 7265  n. This is a pre
-0000e600: 2d72 6571 7569 7369 7465 2066 6f72 2072  -requisite for r
-0000e610: 656d 6f74 656c 7920 6578 6563 7574 696e  emotely executin
-0000e620: 6720 6120 6675 6e63 7469 6f6e 2c20 756e  g a function, un
-0000e630: 6c65 7373 2075 7369 6e67 0a20 2020 2020  less using.     
-0000e640: 2020 2061 2070 7265 2d64 6570 6c6f 7965     a pre-deploye
-0000e650: 6420 696d 6167 652e 0a0a 2020 2020 2020  d image...      
-0000e660: 2020 3a70 6172 616d 2066 756e 633a 2046    :param func: F
-0000e670: 756e 6374 696f 6e20 746f 2062 7569 6c64  unction to build
-0000e680: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000e690: 2077 6974 685f 6d6c 7275 6e3a 2057 6865   with_mlrun: Whe
-0000e6a0: 7468 6572 2074 6f20 6164 6420 4d4c 5275  ther to add MLRu
-0000e6b0: 6e20 7061 636b 6167 6520 746f 2074 6865  n package to the
-0000e6c0: 2062 7569 6c74 2070 6163 6b61 6765 2e20   built package. 
-0000e6d0: 5468 6973 2069 7320 6e6f 7420 7265 7175  This is not requ
-0000e6e0: 6972 6564 2069 6620 7573 696e 6720 6120  ired if using a 
-0000e6f0: 6261 7365 0a20 2020 2020 2020 2020 2020  base.           
-0000e700: 2069 6d61 6765 2074 6861 7420 616c 7265   image that alre
-0000e710: 6164 7920 6861 7320 4d4c 5275 6e20 696e  ady has MLRun in
-0000e720: 2069 742e 0a20 2020 2020 2020 203a 7061   it..        :pa
-0000e730: 7261 6d20 6d6c 7275 6e5f 7665 7273 696f  ram mlrun_versio
-0000e740: 6e5f 7370 6563 6966 6965 723a 2056 6572  n_specifier: Ver
-0000e750: 7369 6f6e 206f 6620 4d4c 5275 6e20 746f  sion of MLRun to
-0000e760: 2069 6e63 6c75 6465 2069 6e20 7468 6520   include in the 
-0000e770: 6275 696c 7420 696d 6167 652e 0a20 2020  built image..   
-0000e780: 2020 2020 203a 7061 7261 6d20 736b 6970       :param skip
-0000e790: 5f64 6570 6c6f 7965 643a 2053 6b69 7020  _deployed: Skip 
-0000e7a0: 7468 6520 6275 696c 6420 6966 2077 6520  the build if we 
-0000e7b0: 616c 7265 6164 7920 6861 7665 2061 6e20  already have an 
-0000e7c0: 696d 6167 6520 666f 7220 7468 6520 6675  image for the fu
-0000e7d0: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
-0000e7e0: 3a70 6172 616d 2062 7569 6c64 6572 5f65  :param builder_e
-0000e7f0: 6e76 3a20 2020 4b61 6e69 6b6f 2062 7569  nv:   Kaniko bui
-0000e800: 6c64 6572 2070 6f64 2065 6e76 2076 6172  lder pod env var
-0000e810: 7320 6469 6374 2028 666f 7220 636f 6e66  s dict (for conf
-0000e820: 6967 2f63 7265 6465 6e74 6961 6c73 290a  ig/credentials).
-0000e830: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0000e840: 6f72 6365 5f62 7569 6c64 3a20 2020 466f  orce_build:   Fo
-0000e850: 7263 6520 6275 696c 6469 6e67 2074 6865  rce building the
-0000e860: 2069 6d61 6765 2c20 6576 656e 2077 6865   image, even whe
-0000e870: 6e20 6e6f 2063 6861 6e67 6573 2077 6572  n no changes wer
-0000e880: 6520 6d61 6465 0a20 2020 2020 2020 2022  e made.        "
-0000e890: 2222 0a20 2020 2020 2020 2069 735f 7333  "".        is_s3
-0000e8a0: 5f73 6f75 7263 6520 3d20 6675 6e63 2e73  _source = func.s
-0000e8b0: 7065 632e 6275 696c 642e 736f 7572 6365  pec.build.source
-0000e8c0: 2061 6e64 2066 756e 632e 7370 6563 2e62   and func.spec.b
-0000e8d0: 7569 6c64 2e73 6f75 7263 652e 7374 6172  uild.source.star
-0000e8e0: 7473 7769 7468 280a 2020 2020 2020 2020  tswith(.        
-0000e8f0: 2020 2020 2273 333a 2f2f 220a 2020 2020      "s3://".    
-0000e900: 2020 2020 290a 2020 2020 2020 2020 6973      ).        is
-0000e910: 5f65 6372 5f69 6d61 6765 203d 206d 6c72  _ecr_image = mlr
-0000e920: 756e 2e75 7469 6c73 2e69 735f 6563 725f  un.utils.is_ecr_
-0000e930: 7572 6c28 636f 6e66 6967 2e68 7474 7064  url(config.httpd
-0000e940: 622e 6275 696c 6465 722e 646f 636b 6572  b.builder.docker
-0000e950: 5f72 6567 6973 7472 7929 0a20 2020 2020  _registry).     
-0000e960: 2020 2069 6620 6e6f 7420 6675 6e63 2e73     if not func.s
-0000e970: 7065 632e 6275 696c 642e 6c6f 6164 5f73  pec.build.load_s
-0000e980: 6f75 7263 655f 6f6e 5f72 756e 2061 6e64  ource_on_run and
-0000e990: 2069 735f 7333 5f73 6f75 7263 6520 616e   is_s3_source an
-0000e9a0: 6420 6973 5f65 6372 5f69 6d61 6765 3a0a  d is_ecr_image:.
-0000e9b0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000e9c0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-0000e9d0: 2020 2020 2020 2020 2020 2020 2242 7569              "Bui
-0000e9e0: 6c64 696e 6720 6120 6675 6e63 7469 6f6e  lding a function
-0000e9f0: 2069 6d61 6765 2074 6f20 4543 5220 616e   image to ECR an
-0000ea00: 6420 6c6f 6164 696e 6720 616e 2053 3320  d loading an S3 
-0000ea10: 736f 7572 6365 2074 6f20 7468 6520 696d  source to the im
-0000ea20: 6167 6520 6d61 7920 7265 7175 6972 6520  age may require 
-0000ea30: 636f 6e66 6c69 6374 696e 6720 6163 6365  conflicting acce
-0000ea40: 7373 2022 0a20 2020 2020 2020 2020 2020  ss ".           
-0000ea50: 2020 2020 2022 6b65 7973 2e20 4f6e 6c79       "keys. Only
-0000ea60: 2074 6865 2070 6572 6d69 7373 696f 6e73   the permissions
-0000ea70: 2067 7261 6e74 6564 2074 6f20 7468 6520   granted to the 
-0000ea80: 706c 6174 666f 726d 2773 2063 6f6e 6669  platform's confi
-0000ea90: 6775 7265 6420 7365 6372 6574 2077 696c  gured secret wil
-0000eaa0: 6c20 7461 6b65 2061 6666 6563 7420 220a  l take affect ".
-0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eac0: 2228 7365 6520 6d6c 7275 6e2e 636f 6e66  "(see mlrun.conf
-0000ead0: 6967 2e63 6f6e 6669 672e 6874 7470 6462  ig.config.httpdb
-0000eae0: 2e62 7569 6c64 6572 2e64 6f63 6b65 725f  .builder.docker_
-0000eaf0: 7265 6769 7374 7279 5f73 6563 7265 7429  registry_secret)
-0000eb00: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0000eb10: 2020 2020 2249 6e20 6361 7365 2074 6865      "In case the
-0000eb20: 2070 6572 6d69 7373 696f 6e73 2061 7265   permissions are
-0000eb30: 206c 696d 6974 6564 2074 6f20 4543 5220   limited to ECR 
-0000eb40: 7363 6f70 652c 2079 6f75 206d 6179 2075  scope, you may u
-0000eb50: 7365 2070 756c 6c5f 6174 5f72 756e 7469  se pull_at_runti
-0000eb60: 6d65 3d54 7275 6520 696e 7374 6561 6422  me=True instead"
-0000eb70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000eb80: 2020 736f 7572 6365 3d66 756e 632e 7370    source=func.sp
-0000eb90: 6563 2e62 7569 6c64 2e73 6f75 7263 652c  ec.build.source,
-0000eba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ebb0: 206c 6f61 645f 736f 7572 6365 5f6f 6e5f   load_source_on_
-0000ebc0: 7275 6e3d 6675 6e63 2e73 7065 632e 6275  run=func.spec.bu
-0000ebd0: 696c 642e 6c6f 6164 5f73 6f75 7263 655f  ild.load_source_
-0000ebe0: 6f6e 5f72 756e 2c0a 2020 2020 2020 2020  on_run,.        
-0000ebf0: 2020 2020 2020 2020 6465 6661 756c 745f          default_
-0000ec00: 646f 636b 6572 5f72 6567 6973 7472 793d  docker_registry=
-0000ec10: 636f 6e66 6967 2e68 7474 7064 622e 6275  config.httpdb.bu
-0000ec20: 696c 6465 722e 646f 636b 6572 5f72 6567  ilder.docker_reg
-0000ec30: 6973 7472 792c 0a20 2020 2020 2020 2020  istry,.         
-0000ec40: 2020 2029 0a0a 2020 2020 2020 2020 7472     )..        tr
-0000ec50: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000ec60: 6571 203d 207b 0a20 2020 2020 2020 2020  eq = {.         
-0000ec70: 2020 2020 2020 2022 6675 6e63 7469 6f6e         "function
-0000ec80: 223a 2066 756e 632e 746f 5f64 6963 7428  ": func.to_dict(
-0000ec90: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000eca0: 2020 2022 7769 7468 5f6d 6c72 756e 223a     "with_mlrun":
-0000ecb0: 2062 6f6f 6c32 7374 7228 7769 7468 5f6d   bool2str(with_m
-0000ecc0: 6c72 756e 292c 0a20 2020 2020 2020 2020  lrun),.         
-0000ecd0: 2020 2020 2020 2022 736b 6970 5f64 6570         "skip_dep
-0000ece0: 6c6f 7965 6422 3a20 736b 6970 5f64 6570  loyed": skip_dep
-0000ecf0: 6c6f 7965 642c 0a20 2020 2020 2020 2020  loyed,.         
-0000ed00: 2020 2020 2020 2022 666f 7263 655f 6275         "force_bu
-0000ed10: 696c 6422 3a20 666f 7263 655f 6275 696c  ild": force_buil
-0000ed20: 642c 0a20 2020 2020 2020 2020 2020 207d  d,.            }
-0000ed30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ed40: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000ed50: 6563 6966 6965 723a 0a20 2020 2020 2020  ecifier:.       
-0000ed60: 2020 2020 2020 2020 2072 6571 5b22 6d6c           req["ml
-0000ed70: 7275 6e5f 7665 7273 696f 6e5f 7370 6563  run_version_spec
-0000ed80: 6966 6965 7222 5d20 3d20 6d6c 7275 6e5f  ifier"] = mlrun_
-0000ed90: 7665 7273 696f 6e5f 7370 6563 6966 6965  version_specifie
-0000eda0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-0000edb0: 2062 7569 6c64 6572 5f65 6e76 3a0a 2020   builder_env:.  
-0000edc0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000edd0: 715b 2262 7569 6c64 6572 5f65 6e76 225d  q["builder_env"]
-0000ede0: 203d 2062 7569 6c64 6572 5f65 6e76 0a20   = builder_env. 
-0000edf0: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000ee00: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000ee10: 2250 4f53 5422 2c20 2262 7569 6c64 2f66  "POST", "build/f
-0000ee20: 756e 6374 696f 6e22 2c20 6a73 6f6e 3d72  unction", json=r
-0000ee30: 6571 290a 2020 2020 2020 2020 6578 6365  eq).        exce
-0000ee40: 7074 204f 5345 7272 6f72 2061 7320 6572  pt OSError as er
-0000ee50: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-0000ee60: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
-0000ee70: 726f 7220 7375 626d 6974 7469 6e67 2062  ror submitting b
-0000ee80: 7569 6c64 2074 6173 6b3a 207b 6572 725f  uild task: {err_
-0000ee90: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
-0000eea0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000eeb0: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
-0000eec0: 3a20 6361 6e6e 6f74 2073 7562 6d69 7420  : cannot submit 
-0000eed0: 6275 696c 642c 207b 6572 725f 746f 5f73  build, {err_to_s
-0000eee0: 7472 2865 7272 297d 2229 0a0a 2020 2020  tr(err)}")..    
-0000eef0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
-0000ef00: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
-0000ef10: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
-0000ef20: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
-0000ef30: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
-0000ef40: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000ef50: 4572 726f 7228 2262 6164 2066 756e 6374  Error("bad funct
-0000ef60: 696f 6e20 7275 6e20 7265 7370 6f6e 7365  ion run response
-0000ef70: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
-0000ef80: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-0000ef90: 2020 2020 6465 6620 6765 745f 6275 696c      def get_buil
-0000efa0: 6465 725f 7374 6174 7573 280a 2020 2020  der_status(.    
-0000efb0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000efc0: 2020 6675 6e63 3a20 4261 7365 5275 6e74    func: BaseRunt
-0000efd0: 696d 652c 0a20 2020 2020 2020 206f 6666  ime,.        off
-0000efe0: 7365 743a 2069 6e74 203d 2030 2c0a 2020  set: int = 0,.  
-0000eff0: 2020 2020 2020 6c6f 6773 3a20 626f 6f6c        logs: bool
-0000f000: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-0000f010: 206c 6173 745f 6c6f 675f 7469 6d65 7374   last_log_timest
-0000f020: 616d 703a 2066 6c6f 6174 203d 2030 2e30  amp: float = 0.0
-0000f030: 2c0a 2020 2020 2020 2020 7665 7262 6f73  ,.        verbos
-0000f040: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-0000f050: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000f060: 2222 2252 6574 7269 6576 6520 7468 6520  """Retrieve the 
-0000f070: 7374 6174 7573 206f 6620 6120 6275 696c  status of a buil
-0000f080: 6420 6f70 6572 6174 696f 6e20 6375 7272  d operation curr
-0000f090: 656e 746c 7920 696e 2070 726f 6772 6573  ently in progres
-0000f0a0: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-0000f0b0: 616d 2066 756e 633a 2020 2020 2020 2020  am func:        
-0000f0c0: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0000f0d0: 206f 626a 6563 7420 7468 6174 2069 7320   object that is 
-0000f0e0: 6265 696e 6720 6275 696c 742e 0a20 2020  being built..   
-0000f0f0: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
-0000f100: 6574 3a20 2020 2020 2020 2020 2020 2020  et:             
-0000f110: 204f 6666 7365 7420 696e 746f 2074 6865   Offset into the
-0000f120: 2062 7569 6c64 206c 6f67 7320 746f 2072   build logs to r
-0000f130: 6574 7269 6576 6520 6c6f 6773 2066 726f  etrieve logs fro
-0000f140: 6d2e 0a20 2020 2020 2020 203a 7061 7261  m..        :para
-0000f150: 6d20 6c6f 6773 3a20 2020 2020 2020 2020  m logs:         
-0000f160: 2020 2020 2020 2053 686f 756c 6420 6275         Should bu
-0000f170: 696c 6420 6c6f 6773 2062 6520 7265 7472  ild logs be retr
-0000f180: 6965 7665 642e 0a20 2020 2020 2020 203a  ieved..        :
-0000f190: 7061 7261 6d20 6c61 7374 5f6c 6f67 5f74  param last_log_t
-0000f1a0: 696d 6573 7461 6d70 3a20 204c 6173 7420  imestamp:  Last 
-0000f1b0: 7469 6d65 7374 616d 7020 6f66 206c 6f67  timestamp of log
-0000f1c0: 7320 7468 6174 2077 6572 6520 616c 7265  s that were alre
-0000f1d0: 6164 7920 7265 7472 6965 7665 642e 2046  ady retrieved. F
-0000f1e0: 756e 6374 696f 6e20 7769 6c6c 2072 6574  unction will ret
-0000f1f0: 7572 6e20 6f6e 6c79 206c 6f67 730a 2020  urn only logs.  
-0000f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f220: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
-0000f230: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
-0000f240: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
-0000f250: 6f73 653a 2020 2020 2020 2020 2020 2020  ose:            
-0000f260: 2041 6464 2076 6572 626f 7365 206c 6f67   Add verbose log
-0000f270: 7320 696e 746f 2074 6865 206f 7574 7075  s into the outpu
-0000f280: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
-0000f290: 7572 6e73 3a20 5468 6520 666f 6c6c 6f77  urns: The follow
-0000f2a0: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
-0000f2b0: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
-0000f2c0: 6578 7420 6f66 2062 7569 6c64 6572 206c  ext of builder l
-0000f2d0: 6f67 732e 0a20 2020 2020 2020 2020 2020  ogs..           
-0000f2e0: 202d 2054 696d 6573 7461 6d70 206f 6620   - Timestamp of 
-0000f2f0: 6c61 7374 206c 6f67 2072 6574 7269 6576  last log retriev
-0000f300: 6564 2c20 746f 2062 6520 7573 6564 2069  ed, to be used i
-0000f310: 6e20 7375 6273 6571 7565 6e74 2063 616c  n subsequent cal
-0000f320: 6c73 2074 6f20 7468 6973 2066 756e 6374  ls to this funct
-0000f330: 696f 6e2e 0a0a 2020 2020 2020 2020 2020  ion...          
-0000f340: 2020 5468 6520 6675 6e63 7469 6f6e 2061    The function a
-0000f350: 6c73 6f20 7570 6461 7465 7320 696e 7465  lso updates inte
-0000f360: 726e 616c 206d 656d 6265 7273 206f 6620  rnal members of 
-0000f370: 7468 6520 6060 6675 6e63 6060 206f 626a  the ``func`` obj
-0000f380: 6563 7420 746f 2072 6566 6c65 6374 2062  ect to reflect b
-0000f390: 7569 6c64 2070 726f 6365 7373 2069 6e66  uild process inf
-0000f3a0: 6f2e 0a20 2020 2020 2020 2022 2222 0a0a  o..        """..
-0000f3b0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000f3c0: 2020 2020 2020 2020 2070 6172 616d 7320           params 
-0000f3d0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0000f3e0: 2020 2020 226e 616d 6522 3a20 6e6f 726d      "name": norm
-0000f3f0: 616c 697a 655f 6e61 6d65 2866 756e 632e  alize_name(func.
-0000f400: 6d65 7461 6461 7461 2e6e 616d 6529 2c0a  metadata.name),.
-0000f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f420: 2270 726f 6a65 6374 223a 2066 756e 632e  "project": func.
-0000f430: 6d65 7461 6461 7461 2e70 726f 6a65 6374  metadata.project
-0000f440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f450: 2020 2274 6167 223a 2066 756e 632e 6d65    "tag": func.me
-0000f460: 7461 6461 7461 2e74 6167 2c0a 2020 2020  tadata.tag,.    
-0000f470: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0000f480: 7322 3a20 626f 6f6c 3273 7472 286c 6f67  s": bool2str(log
-0000f490: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-0000f4a0: 2020 2020 226f 6666 7365 7422 3a20 7374      "offset": st
-0000f4b0: 7228 6f66 6673 6574 292c 0a20 2020 2020  r(offset),.     
-0000f4c0: 2020 2020 2020 2020 2020 2022 6c61 7374             "last
-0000f4d0: 5f6c 6f67 5f74 696d 6573 7461 6d70 223a  _log_timestamp":
-0000f4e0: 2073 7472 286c 6173 745f 6c6f 675f 7469   str(last_log_ti
-0000f4f0: 6d65 7374 616d 7029 2c0a 2020 2020 2020  mestamp),.      
-0000f500: 2020 2020 2020 2020 2020 2276 6572 626f            "verbo
-0000f510: 7365 223a 2062 6f6f 6c32 7374 7228 7665  se": bool2str(ve
-0000f520: 7262 6f73 6529 2c0a 2020 2020 2020 2020  rbose),.        
-0000f530: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-0000f540: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
-0000f550: 695f 6361 6c6c 2822 4745 5422 2c20 2262  i_call("GET", "b
-0000f560: 7569 6c64 2f73 7461 7475 7322 2c20 7061  uild/status", pa
-0000f570: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0000f580: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000f590: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000f5a0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000f5b0: 7272 6f72 2866 2265 7272 6f72 2067 6574  rror(f"error get
-0000f5c0: 7469 6e67 2062 7569 6c64 2073 7461 7475  ting build statu
-0000f5d0: 733a 207b 6572 725f 746f 5f73 7472 2865  s: {err_to_str(e
-0000f5e0: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
-0000f5f0: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
-0000f600: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
-0000f610: 2067 6574 2062 7569 6c64 2073 7461 7475   get build statu
-0000f620: 732c 207b 6572 725f 746f 5f73 7472 2865  s, {err_to_str(e
-0000f630: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
-0000f640: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
-0000f650: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000f660: 6572 2e77 6172 6e69 6e67 2866 2266 6169  er.warning(f"fai
-0000f670: 6c65 6420 7265 7370 2c20 7b72 6573 702e  led resp, {resp.
-0000f680: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
-0000f690: 2020 2020 7261 6973 6520 5275 6e44 4245      raise RunDBE
-0000f6a0: 7272 6f72 2822 6261 6420 6675 6e63 7469  rror("bad functi
-0000f6b0: 6f6e 2062 7569 6c64 2072 6573 706f 6e73  on build respons
-0000f6c0: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
-0000f6d0: 7265 7370 2e68 6561 6465 7273 3a0a 2020  resp.headers:.  
-0000f6e0: 2020 2020 2020 2020 2020 6675 6e63 2e73            func.s
-0000f6f0: 7461 7475 732e 7374 6174 6520 3d20 7265  tatus.state = re
-0000f700: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
-0000f710: 782d 6d6c 7275 6e2d 6675 6e63 7469 6f6e  x-mlrun-function
-0000f720: 2d73 7461 7475 7322 2c20 2222 290a 2020  -status", "").  
-0000f730: 2020 2020 2020 2020 2020 6c61 7374 5f6c            last_l
-0000f740: 6f67 5f74 696d 6573 7461 6d70 203d 2066  og_timestamp = f
-0000f750: 6c6f 6174 280a 2020 2020 2020 2020 2020  loat(.          
-0000f760: 2020 2020 2020 7265 7370 2e68 6561 6465        resp.heade
-0000f770: 7273 2e67 6574 2822 782d 6d6c 7275 6e2d  rs.get("x-mlrun-
-0000f780: 6c61 7374 2d74 696d 6573 7461 6d70 222c  last-timestamp",
-0000f790: 2022 302e 3022 290a 2020 2020 2020 2020   "0.0").        
-0000f7a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000f7b0: 2020 6966 2066 756e 632e 6b69 6e64 2069    if func.kind i
-0000f7c0: 6e20 6d6c 7275 6e2e 7275 6e74 696d 6573  n mlrun.runtimes
-0000f7d0: 2e52 756e 7469 6d65 4b69 6e64 732e 6e75  .RuntimeKinds.nu
-0000f7e0: 636c 696f 5f72 756e 7469 6d65 7328 293a  clio_runtimes():
-0000f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f800: 2066 756e 632e 7374 6174 7573 2e61 6464   func.status.add
-0000f810: 7265 7373 203d 2072 6573 702e 6865 6164  ress = resp.head
-0000f820: 6572 732e 6765 7428 2278 2d6d 6c72 756e  ers.get("x-mlrun
-0000f830: 2d61 6464 7265 7373 222c 2022 2229 0a20  -address", ""). 
-0000f840: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f850: 756e 632e 7374 6174 7573 2e6e 7563 6c69  unc.status.nucli
-0000f860: 6f5f 6e61 6d65 203d 2072 6573 702e 6865  o_name = resp.he
-0000f870: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
-0000f880: 756e 2d6e 616d 6522 2c20 2222 290a 2020  un-name", "").  
-0000f890: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-0000f8a0: 6e63 2e73 7461 7475 732e 696e 7465 726e  nc.status.intern
-0000f8b0: 616c 5f69 6e76 6f63 6174 696f 6e5f 7572  al_invocation_ur
-0000f8c0: 6c73 203d 2072 6573 702e 6865 6164 6572  ls = resp.header
-0000f8d0: 732e 6765 7428 0a20 2020 2020 2020 2020  s.get(.         
-0000f8e0: 2020 2020 2020 2020 2020 2022 782d 6d6c             "x-ml
-0000f8f0: 7275 6e2d 696e 7465 726e 616c 2d69 6e76  run-internal-inv
-0000f900: 6f63 6174 696f 6e2d 7572 6c73 222c 2022  ocation-urls", "
-0000f910: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000f920: 2020 292e 7370 6c69 7428 222c 2229 0a20    ).split(","). 
-0000f930: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f940: 756e 632e 7374 6174 7573 2e65 7874 6572  unc.status.exter
-0000f950: 6e61 6c5f 696e 766f 6361 7469 6f6e 5f75  nal_invocation_u
-0000f960: 726c 7320 3d20 7265 7370 2e68 6561 6465  rls = resp.heade
-0000f970: 7273 2e67 6574 280a 2020 2020 2020 2020  rs.get(.        
-0000f980: 2020 2020 2020 2020 2020 2020 2278 2d6d              "x-m
-0000f990: 6c72 756e 2d65 7874 6572 6e61 6c2d 696e  lrun-external-in
-0000f9a0: 766f 6361 7469 6f6e 2d75 726c 7322 2c20  vocation-urls", 
-0000f9b0: 2222 0a20 2020 2020 2020 2020 2020 2020  "".             
-0000f9c0: 2020 2029 2e73 706c 6974 2822 2c22 290a     ).split(",").
-0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9e0: 6675 6e63 2e73 7461 7475 732e 636f 6e74  func.status.cont
-0000f9f0: 6169 6e65 725f 696d 6167 6520 3d20 7265  ainer_image = re
-0000fa00: 7370 2e68 6561 6465 7273 2e67 6574 280a  sp.headers.get(.
-0000fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa20: 2020 2020 2278 2d6d 6c72 756e 2d63 6f6e      "x-mlrun-con
-0000fa30: 7461 696e 6572 2d69 6d61 6765 222c 2022  tainer-image", "
-0000fa40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000fa50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000fa60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000fa70: 2020 2020 2020 6675 6e63 2e73 7461 7475        func.statu
-0000fa80: 732e 6275 696c 645f 706f 6420 3d20 7265  s.build_pod = re
-0000fa90: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
-0000faa0: 6275 696c 6465 725f 706f 6422 2c20 2222  builder_pod", ""
-0000fab0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000fac0: 2020 6675 6e63 2e73 7065 632e 696d 6167    func.spec.imag
-0000fad0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
-0000fae0: 2e67 6574 2822 6675 6e63 7469 6f6e 5f69  .get("function_i
-0000faf0: 6d61 6765 222c 2022 2229 0a0a 2020 2020  mage", "")..    
-0000fb00: 2020 2020 7465 7874 203d 2022 220a 2020      text = "".  
-0000fb10: 2020 2020 2020 6966 2072 6573 702e 636f        if resp.co
-0000fb20: 6e74 656e 743a 0a20 2020 2020 2020 2020  ntent:.         
-0000fb30: 2020 2074 6578 7420 3d20 7265 7370 2e63     text = resp.c
-0000fb40: 6f6e 7465 6e74 2e64 6563 6f64 6528 290a  ontent.decode().
-0000fb50: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0000fb60: 6578 742c 206c 6173 745f 6c6f 675f 7469  ext, last_log_ti
-0000fb70: 6d65 7374 616d 700a 0a20 2020 2064 6566  mestamp..    def
-0000fb80: 2073 7461 7274 5f66 756e 6374 696f 6e28   start_function(
-0000fb90: 0a20 2020 2020 2020 2073 656c 662c 2066  .        self, f
-0000fba0: 756e 635f 7572 6c3a 2073 7472 203d 204e  unc_url: str = N
-0000fbb0: 6f6e 652c 2066 756e 6374 696f 6e3a 2022  one, function: "
-0000fbc0: 6d6c 7275 6e2e 7275 6e74 696d 6573 2e42  mlrun.runtimes.B
-0000fbd0: 6173 6552 756e 7469 6d65 2220 3d20 4e6f  aseRuntime" = No
-0000fbe0: 6e65 0a20 2020 2029 202d 3e20 6d6c 7275  ne.    ) -> mlru
-0000fbf0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000fc00: 2e42 6163 6b67 726f 756e 6454 6173 6b3a  .BackgroundTask:
-0000fc10: 0a20 2020 2020 2020 2022 2222 4578 6563  .        """Exec
-0000fc20: 7574 6520 6120 6675 6e63 7469 6f6e 2072  ute a function r
-0000fc30: 656d 6f74 656c 792c 2055 7365 6420 666f  emotely, Used fo
-0000fc40: 7220 6060 6461 736b 6060 2066 756e 6374  r ``dask`` funct
-0000fc50: 696f 6e73 2e0a 0a20 2020 2020 2020 203a  ions...        :
-0000fc60: 7061 7261 6d20 6675 6e63 5f75 726c 3a20  param func_url: 
-0000fc70: 5552 4c20 746f 2074 6865 2066 756e 6374  URL to the funct
-0000fc80: 696f 6e20 746f 2062 6520 6578 6563 7574  ion to be execut
-0000fc90: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-0000fca0: 616d 2066 756e 6374 696f 6e3a 2054 6865  am function: The
-0000fcb0: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
-0000fcc0: 2074 6f20 7374 6172 742c 206e 6f74 206e   to start, not n
-0000fcd0: 6565 6465 6420 6865 7265 2e0a 2020 2020  eeded here..    
-0000fce0: 2020 2020 3a72 6574 7572 6e73 3a20 4120      :returns: A 
-0000fcf0: 4261 636b 6772 6f75 6e64 5461 736b 206f  BackgroundTask o
-0000fd00: 626a 6563 742c 2077 6974 6820 6465 7461  bject, with deta
-0000fd10: 696c 7320 6f6e 2065 7865 6375 7469 6f6e  ils on execution
-0000fd20: 2070 726f 6365 7373 2061 6e64 2069 7473   process and its
-0000fd30: 2073 7461 7475 732e 0a20 2020 2020 2020   status..       
-0000fd40: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-0000fd50: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000fd60: 6571 203d 207b 2266 756e 6374 696f 6e55  eq = {"functionU
-0000fd70: 726c 223a 2066 756e 635f 7572 6c7d 0a20  rl": func_url}. 
-0000fd80: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000fd90: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000fda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fdb0: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-0000fdc0: 2020 2020 2020 2020 2022 7374 6172 742f           "start/
-0000fdd0: 6675 6e63 7469 6f6e 222c 0a20 2020 2020  function",.     
-0000fde0: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
-0000fdf0: 7265 712c 0a20 2020 2020 2020 2020 2020  req,.           
-0000fe00: 2020 2020 2074 696d 656f 7574 3d69 6e74       timeout=int
-0000fe10: 2863 6f6e 6669 672e 7375 626d 6974 5f74  (config.submit_t
-0000fe20: 696d 656f 7574 2920 6f72 2036 302c 0a20  imeout) or 60,. 
-0000fe30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000fe40: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000fe50: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000fe60: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000fe70: 7272 6f72 2866 2265 7272 6f72 2073 7461  rror(f"error sta
-0000fe80: 7274 696e 6720 6675 6e63 7469 6f6e 3a20  rting function: 
-0000fe90: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
-0000fea0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0000feb0: 7261 6973 6520 4f53 4572 726f 7228 6622  raise OSError(f"
-0000fec0: 6572 726f 723a 2063 616e 6e6f 7420 7374  error: cannot st
-0000fed0: 6172 7420 6675 6e63 7469 6f6e 2c20 7b65  art function, {e
-0000fee0: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
-0000fef0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0000ff00: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
-0000ff10: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000ff20: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
-0000ff30: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
-0000ff40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000ff50: 6520 5661 6c75 6545 7272 6f72 2822 6261  e ValueError("ba
-0000ff60: 6420 6675 6e63 7469 6f6e 2073 7461 7274  d function start
-0000ff70: 2072 6573 706f 6e73 6522 290a 0a20 2020   response")..   
-0000ff80: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0000ff90: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000ffa0: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
-0000ffb0: 2a2a 7265 7370 2e6a 736f 6e28 2929 0a0a  **resp.json())..
-0000ffc0: 2020 2020 6465 6620 6765 745f 7072 6f6a      def get_proj
-0000ffd0: 6563 745f 6261 636b 6772 6f75 6e64 5f74  ect_background_t
-0000ffe0: 6173 6b28 0a20 2020 2020 2020 2073 656c  ask(.        sel
-0000fff0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-00010000: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-00010010: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-00010020: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-00010030: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-00010040: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
-00010050: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
-00010060: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
-00010070: 6e20 6f6e 2061 2070 726f 6a65 6374 2062  n on a project b
-00010080: 6163 6b67 726f 756e 6420 7461 736b 2062  ackground task b
-00010090: 6569 6e67 2065 7865 6375 7465 642e 2222  eing executed.""
-000100a0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-000100b0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-000100c0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-000100d0: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-000100e0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-000100f0: 2f7b 7072 6f6a 6563 747d 2f62 6163 6b67  /{project}/backg
-00010100: 726f 756e 642d 7461 736b 732f 7b6e 616d  round-tasks/{nam
-00010110: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
-00010120: 725f 6d65 7373 6167 6520 3d20 280a 2020  r_message = (.  
-00010130: 2020 2020 2020 2020 2020 6622 4661 696c            f"Fail
-00010140: 6564 2067 6574 7469 6e67 2070 726f 6a65  ed getting proje
-00010150: 6374 2062 6163 6b67 726f 756e 6420 7461  ct background ta
-00010160: 736b 2e20 7072 6f6a 6563 743d 7b70 726f  sk. project={pro
-00010170: 6a65 6374 7d2c 206e 616d 653d 7b6e 616d  ject}, name={nam
-00010180: 657d 220a 2020 2020 2020 2020 290a 2020  e}".        ).  
-00010190: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-000101a0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-000101b0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-000101c0: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
-000101d0: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-000101e0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-000101f0: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
-00010200: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-00010210: 0a0a 2020 2020 6465 6620 6c69 7374 5f70  ..    def list_p
-00010220: 726f 6a65 6374 5f62 6163 6b67 726f 756e  roject_backgroun
-00010230: 645f 7461 736b 7328 0a20 2020 2020 2020  d_tasks(.       
-00010240: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00010250: 726f 6a65 6374 3a20 4f70 7469 6f6e 616c  roject: Optional
-00010260: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00010270: 2020 2020 2020 7374 6174 653a 204f 7074        state: Opt
-00010280: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00010290: 652c 0a20 2020 2020 2020 2063 7265 6174  e,.        creat
-000102a0: 6564 5f66 726f 6d3a 204f 7074 696f 6e61  ed_from: Optiona
-000102b0: 6c5b 6461 7465 7469 6d65 5d20 3d20 4e6f  l[datetime] = No
-000102c0: 6e65 2c0a 2020 2020 2020 2020 6372 6561  ne,.        crea
-000102d0: 7465 645f 746f 3a20 4f70 7469 6f6e 616c  ted_to: Optional
-000102e0: 5b64 6174 6574 696d 655d 203d 204e 6f6e  [datetime] = Non
-000102f0: 652c 0a20 2020 2020 2020 206c 6173 745f  e,.        last_
-00010300: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-00010310: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
-00010320: 696d 655d 203d 204e 6f6e 652c 0a20 2020  ime] = None,.   
-00010330: 2020 2020 206c 6173 745f 7570 6461 7465       last_update
-00010340: 5f74 696d 655f 746f 3a20 4f70 7469 6f6e  _time_to: Option
-00010350: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
-00010360: 6f6e 652c 0a20 2020 2029 202d 3e20 6c69  one,.    ) -> li
-00010370: 7374 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  st[mlrun.common.
-00010380: 7363 6865 6d61 732e 4261 636b 6772 6f75  schemas.Backgrou
-00010390: 6e64 5461 736b 5d3a 0a20 2020 2020 2020  ndTask]:.       
-000103a0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-000103b0: 7269 6576 6520 7570 6461 7465 6420 696e  rieve updated in
-000103c0: 666f 726d 6174 696f 6e20 6f6e 2070 726f  formation on pro
-000103d0: 6a65 6374 2062 6163 6b67 726f 756e 6420  ject background 
-000103e0: 7461 736b 7320 6265 696e 6720 6578 6563  tasks being exec
-000103f0: 7574 6564 2e0a 2020 2020 2020 2020 4966  uted..        If
-00010400: 206e 6f20 6669 6c74 6572 2069 7320 7072   no filter is pr
-00010410: 6f76 6964 6564 2c20 7769 6c6c 2072 6574  ovided, will ret
-00010420: 7572 6e20 6261 636b 6772 6f75 6e64 2074  urn background t
-00010430: 6173 6b73 2066 726f 6d20 7468 6520 6c61  asks from the la
-00010440: 7374 2077 6565 6b2e 0a0a 2020 2020 2020  st week...      
-00010450: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00010460: 3a20 5072 6f6a 6563 7420 6e61 6d65 2028  : Project name (
-00010470: 6465 6661 756c 7473 2074 6f20 6d6c 7275  defaults to mlru
-00010480: 6e2e 636f 6e66 6967 2e63 6f6e 6669 672e  n.config.config.
-00010490: 6465 6661 756c 745f 7072 6f6a 6563 7429  default_project)
-000104a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000104b0: 2073 7461 7465 3a20 2020 4c69 7374 206f   state:   List o
-000104c0: 6e6c 7920 6261 636b 6772 6f75 6e64 2074  nly background t
-000104d0: 6173 6b73 2077 686f 7365 2073 7461 7465  asks whose state
-000104e0: 2069 7320 7370 6563 6966 6965 642e 0a20   is specified.. 
-000104f0: 2020 2020 2020 203a 7061 7261 6d20 6372         :param cr
-00010500: 6561 7465 645f 6672 6f6d 3a20 4669 6c74  eated_from: Filt
-00010510: 6572 2062 7920 6261 636b 6772 6f75 6e64  er by background
-00010520: 2074 6173 6b20 6372 6561 7465 6420 7469   task created ti
-00010530: 6d65 2069 6e20 6060 5b63 7265 6174 6564  me in ``[created
-00010540: 5f66 726f 6d2c 2063 7265 6174 6564 5f74  _from, created_t
-00010550: 6f5d 6060 2e0a 2020 2020 2020 2020 3a70  o]``..        :p
-00010560: 6172 616d 2063 7265 6174 6564 5f74 6f3a  aram created_to:
-00010570: 2020 4669 6c74 6572 2062 7920 6261 636b    Filter by back
-00010580: 6772 6f75 6e64 2074 6173 6b20 6372 6561  ground task crea
-00010590: 7465 6420 7469 6d65 2069 6e20 6060 5b63  ted time in ``[c
-000105a0: 7265 6174 6564 5f66 726f 6d2c 2063 7265  reated_from, cre
-000105b0: 6174 6564 5f74 6f5d 6060 2e0a 2020 2020  ated_to]``..    
-000105c0: 2020 2020 3a70 6172 616d 206c 6173 745f      :param last_
-000105d0: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-000105e0: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
-000105f0: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
-00010600: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
-00010610: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
-00010620: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00010630: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
-00010640: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
-00010650: 2020 2020 2020 3a70 6172 616d 206c 6173        :param las
-00010660: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
-00010670: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
-00010680: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
-00010690: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
-000106a0: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
-000106b0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-000106c0: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
-000106d0: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
-000106e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000106f0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00010700: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00010710: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00010720: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-00010730: 2020 2020 2020 206e 6f74 2073 7461 7465         not state
-00010740: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00010750: 206e 6f74 2063 7265 6174 6564 5f66 726f   not created_fro
-00010760: 6d0a 2020 2020 2020 2020 2020 2020 616e  m.            an
-00010770: 6420 6e6f 7420 6372 6561 7465 645f 746f  d not created_to
-00010780: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00010790: 206e 6f74 206c 6173 745f 7570 6461 7465   not last_update
-000107a0: 5f74 696d 655f 6672 6f6d 0a20 2020 2020  _time_from.     
-000107b0: 2020 2020 2020 2061 6e64 206e 6f74 206c         and not l
-000107c0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-000107d0: 746f 0a20 2020 2020 2020 2029 3a0a 2020  to.        ):.  
-000107e0: 2020 2020 2020 2020 2020 2320 6465 6661            # defa
-000107f0: 756c 7420 746f 206c 6173 7420 7765 656b  ult to last week
-00010800: 206f 6e20 6e6f 2066 696c 7465 720a 2020   on no filter.  
-00010810: 2020 2020 2020 2020 2020 6372 6561 7465            create
-00010820: 645f 6672 6f6d 203d 2064 6174 6574 696d  d_from = datetim
-00010830: 652e 6e6f 7728 2920 2d20 7469 6d65 6465  e.now() - timede
-00010840: 6c74 6128 6461 7973 3d37 290a 0a20 2020  lta(days=7)..   
-00010850: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-00010860: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-00010870: 7465 223a 2073 7461 7465 2c0a 2020 2020  te": state,.    
-00010880: 2020 2020 2020 2020 2263 7265 6174 6564          "created
-00010890: 5f66 726f 6d22 3a20 6461 7465 7469 6d65  _from": datetime
-000108a0: 5f74 6f5f 6973 6f28 6372 6561 7465 645f  _to_iso(created_
-000108b0: 6672 6f6d 292c 0a20 2020 2020 2020 2020  from),.         
-000108c0: 2020 2022 6372 6561 7465 645f 746f 223a     "created_to":
-000108d0: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
-000108e0: 2863 7265 6174 6564 5f74 6f29 2c0a 2020  (created_to),.  
-000108f0: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
-00010900: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-00010910: 223a 2064 6174 6574 696d 655f 746f 5f69  ": datetime_to_i
-00010920: 736f 286c 6173 745f 7570 6461 7465 5f74  so(last_update_t
-00010930: 696d 655f 6672 6f6d 292c 0a20 2020 2020  ime_from),.     
-00010940: 2020 2020 2020 2022 6c61 7374 5f75 7064         "last_upd
-00010950: 6174 655f 7469 6d65 5f74 6f22 3a20 6461  ate_time_to": da
-00010960: 7465 7469 6d65 5f74 6f5f 6973 6f28 6c61  tetime_to_iso(la
-00010970: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
-00010980: 6f29 2c0a 2020 2020 2020 2020 7d0a 0a20  o),.        }.. 
-00010990: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-000109a0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000109b0: 747d 2f62 6163 6b67 726f 756e 642d 7461  t}/background-ta
-000109c0: 736b 7322 0a20 2020 2020 2020 2065 7272  sks".        err
-000109d0: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-000109e0: 6169 6c65 6420 6c69 7374 696e 6720 7072  ailed listing pr
-000109f0: 6f6a 6563 7420 6261 636b 6772 6f75 6e64  oject background
-00010a00: 2074 6173 6b2e 2070 726f 6a65 6374 3d7b   task. project={
-00010a10: 7072 6f6a 6563 747d 220a 2020 2020 2020  project}".      
-00010a20: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00010a30: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-00010a40: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-00010a50: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
-00010a60: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00010a70: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-00010a80: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-00010a90: 6f75 6e64 5461 736b 4c69 7374 280a 2020  oundTaskList(.  
-00010aa0: 2020 2020 2020 2020 2020 2a2a 7265 7370            **resp
-00010ab0: 6f6e 7365 2e6a 736f 6e28 290a 2020 2020  onse.json().    
-00010ac0: 2020 2020 292e 6261 636b 6772 6f75 6e64      ).background
-00010ad0: 5f74 6173 6b73 0a0a 2020 2020 6465 6620  _tasks..    def 
-00010ae0: 6765 745f 6261 636b 6772 6f75 6e64 5f74  get_background_t
-00010af0: 6173 6b28 7365 6c66 2c20 6e61 6d65 3a20  ask(self, name: 
-00010b00: 7374 7229 202d 3e20 6d6c 7275 6e2e 636f  str) -> mlrun.co
-00010b10: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-00010b20: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
-00010b30: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00010b40: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
-00010b50: 7469 6f6e 206f 6e20 6120 6261 636b 6772  tion on a backgr
-00010b60: 6f75 6e64 2074 6173 6b20 6265 696e 6720  ound task being 
-00010b70: 6578 6563 7574 6564 2e22 2222 0a0a 2020  executed."""..  
-00010b80: 2020 2020 2020 7061 7468 203d 2066 2262        path = f"b
-00010b90: 6163 6b67 726f 756e 642d 7461 736b 732f  ackground-tasks/
-00010ba0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-00010bb0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00010bc0: 6622 4661 696c 6564 2067 6574 7469 6e67  f"Failed getting
-00010bd0: 2062 6163 6b67 726f 756e 6420 7461 736b   background task
-00010be0: 2e20 6e61 6d65 3d7b 6e61 6d65 7d22 0a20  . name={name}". 
-00010bf0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00010c00: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00010c10: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00010c20: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00010c30: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00010c40: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00010c50: 4261 636b 6772 6f75 6e64 5461 736b 282a  BackgroundTask(*
-00010c60: 2a72 6573 706f 6e73 652e 6a73 6f6e 2829  *response.json()
-00010c70: 290a 0a20 2020 2064 6566 2066 756e 6374  )..    def funct
-00010c80: 696f 6e5f 7374 6174 7573 2873 656c 662c  ion_status(self,
-00010c90: 2070 726f 6a65 6374 2c20 6e61 6d65 2c20   project, name, 
-00010ca0: 6b69 6e64 2c20 7365 6c65 6374 6f72 293a  kind, selector):
-00010cb0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-00010cc0: 6965 7665 2073 7461 7475 7320 6f66 2061  ieve status of a
-00010cd0: 2066 756e 6374 696f 6e20 6265 696e 6720   function being 
-00010ce0: 6578 6563 7574 6564 2072 656d 6f74 656c  executed remotel
-00010cf0: 7920 2872 656c 6576 616e 7420 746f 2060  y (relevant to `
-00010d00: 6064 6173 6b60 6020 6675 6e63 7469 6f6e  `dask`` function
-00010d10: 7329 2e0a 0a20 2020 2020 2020 203a 7061  s)...        :pa
-00010d20: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
-00010d30: 2054 6865 2070 726f 6a65 6374 206f 6620   The project of 
-00010d40: 7468 6520 6675 6e63 7469 6f6e 0a20 2020  the function.   
-00010d50: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-00010d60: 3a20 2020 2020 2020 2054 6865 206e 616d  :        The nam
-00010d70: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
-00010d80: 6e0a 2020 2020 2020 2020 3a70 6172 616d  n.        :param
-00010d90: 206b 696e 643a 2020 2020 2020 2020 5468   kind:        Th
-00010da0: 6520 6b69 6e64 206f 6620 7468 6520 6675  e kind of the fu
-00010db0: 6e63 7469 6f6e 2c20 6375 7272 656e 746c  nction, currentl
-00010dc0: 7920 6060 6461 736b 6060 2069 7320 7375  y ``dask`` is su
-00010dd0: 7070 6f72 7465 642e 0a20 2020 2020 2020  pported..       
-00010de0: 203a 7061 7261 6d20 7365 6c65 6374 6f72   :param selector
-00010df0: 3a20 2020 2053 656c 6563 746f 7220 636c  :    Selector cl
-00010e00: 6175 7365 2074 6f20 6265 2061 7070 6c69  ause to be appli
-00010e10: 6564 2074 6f20 7468 6520 4b75 6265 726e  ed to the Kubern
-00010e20: 6574 6573 2073 7461 7475 7320 7175 6572  etes status quer
-00010e30: 7920 746f 2066 696c 7465 7220 7468 6520  y to filter the 
-00010e40: 7265 7375 6c74 732e 0a20 2020 2020 2020  results..       
-00010e50: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-00010e60: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-00010e70: 6571 203d 207b 226b 696e 6422 3a20 6b69  eq = {"kind": ki
-00010e80: 6e64 2c20 2273 656c 6563 746f 7222 3a20  nd, "selector": 
-00010e90: 7365 6c65 6374 6f72 2c20 2270 726f 6a65  selector, "proje
-00010ea0: 6374 223a 2070 726f 6a65 6374 2c20 226e  ct": project, "n
-00010eb0: 616d 6522 3a20 6e61 6d65 7d0a 2020 2020  ame": name}.    
-00010ec0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00010ed0: 656c 662e 6170 695f 6361 6c6c 2822 504f  elf.api_call("PO
-00010ee0: 5354 222c 2022 7374 6174 7573 2f66 756e  ST", "status/fun
-00010ef0: 6374 696f 6e22 2c20 6a73 6f6e 3d72 6571  ction", json=req
-00010f00: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-00010f10: 204f 5345 7272 6f72 2061 7320 6572 723a   OSError as err:
-00010f20: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-00010f30: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
-00010f40: 7220 7374 6172 7469 6e67 2066 756e 6374  r starting funct
-00010f50: 696f 6e3a 207b 6572 725f 746f 5f73 7472  ion: {err_to_str
-00010f60: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
-00010f70: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
-00010f80: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
-00010f90: 6f74 2073 7461 7274 2066 756e 6374 696f  ot start functio
-00010fa0: 6e2c 207b 6572 725f 746f 5f73 7472 2865  n, {err_to_str(e
-00010fb0: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
-00010fc0: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
-00010fd0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-00010fe0: 6572 2e65 7272 6f72 2866 2262 6164 2072  er.error(f"bad r
-00010ff0: 6573 7021 215c 6e7b 7265 7370 2e74 6578  esp!!\n{resp.tex
-00011000: 747d 2229 0a20 2020 2020 2020 2020 2020  t}").           
-00011010: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00011020: 7228 2262 6164 2066 756e 6374 696f 6e20  r("bad function 
-00011030: 7374 6174 7573 2072 6573 706f 6e73 6522  status response"
-00011040: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00011050: 6e20 7265 7370 2e6a 736f 6e28 295b 2264  n resp.json()["d
-00011060: 6174 6122 5d0a 0a20 2020 2064 6566 2073  ata"]..    def s
-00011070: 7562 6d69 745f 6a6f 6228 0a20 2020 2020  ubmit_job(.     
-00011080: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011090: 2072 756e 7370 6563 2c0a 2020 2020 2020   runspec,.      
-000110a0: 2020 7363 6865 6475 6c65 3a20 556e 696f    schedule: Unio
-000110b0: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
-000110c0: 6d6f 6e2e 7363 6865 6d61 732e 5363 6865  mon.schemas.Sche
-000110d0: 6475 6c65 4372 6f6e 5472 6967 6765 725d  duleCronTrigger]
-000110e0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-000110f0: 2020 2020 2020 2020 2222 2253 7562 6d69          """Submi
-00011100: 7420 6120 6a6f 6220 666f 7220 7265 6d6f  t a job for remo
-00011110: 7465 2065 7865 6375 7469 6f6e 2e0a 0a20  te execution... 
-00011120: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
-00011130: 6e73 7065 633a 2054 6865 2072 756e 7469  nspec: The runti
-00011140: 6d65 206f 626a 6563 7420 7370 6563 2028  me object spec (
-00011150: 5461 736b 2920 746f 2065 7865 6375 7465  Task) to execute
-00011160: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00011170: 2073 6368 6564 756c 653a 2057 6865 7468   schedule: Wheth
-00011180: 6572 2074 6f20 7363 6865 6475 6c65 2074  er to schedule t
-00011190: 6869 7320 6a6f 6220 7573 696e 6720 6120  his job using a 
-000111a0: 4372 6f6e 2074 7269 6767 6572 2e20 4966  Cron trigger. If
-000111b0: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
-000111c0: 7468 6520 6a6f 6220 7769 6c6c 2062 6520  the job will be 
-000111d0: 7375 626d 6974 7465 640a 2020 2020 2020  submitted.      
-000111e0: 2020 2020 2020 696d 6d65 6469 6174 656c        immediatel
-000111f0: 792e 0a20 2020 2020 2020 2022 2222 0a0a  y..        """..
-00011200: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00011210: 2020 2020 2020 2020 2072 6571 203d 207b           req = {
-00011220: 2274 6173 6b22 3a20 7275 6e73 7065 632e  "task": runspec.
-00011230: 746f 5f64 6963 7428 297d 0a20 2020 2020  to_dict()}.     
-00011240: 2020 2020 2020 2069 6620 7363 6865 6475         if schedu
-00011250: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00011260: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00011270: 6528 7363 6865 6475 6c65 2c20 6d6c 7275  e(schedule, mlru
-00011280: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00011290: 2e53 6368 6564 756c 6543 726f 6e54 7269  .ScheduleCronTri
-000112a0: 6767 6572 293a 0a20 2020 2020 2020 2020  gger):.         
-000112b0: 2020 2020 2020 2020 2020 2073 6368 6564             sched
-000112c0: 756c 6520 3d20 7363 6865 6475 6c65 2e64  ule = schedule.d
-000112d0: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
-000112e0: 2020 2020 2020 7265 715b 2273 6368 6564        req["sched
-000112f0: 756c 6522 5d20 3d20 7363 6865 6475 6c65  ule"] = schedule
-00011300: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-00011310: 656f 7574 203d 2028 696e 7428 636f 6e66  eout = (int(conf
-00011320: 6967 2e73 7562 6d69 745f 7469 6d65 6f75  ig.submit_timeou
-00011330: 7429 206f 7220 3132 3029 202b 2032 300a  t) or 120) + 20.
-00011340: 2020 2020 2020 2020 2020 2020 7265 7370              resp
-00011350: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011360: 2822 504f 5354 222c 2022 7375 626d 6974  ("POST", "submit
-00011370: 5f6a 6f62 222c 206a 736f 6e3d 7265 712c  _job", json=req,
-00011380: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
-00011390: 290a 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-000113a0: 7420 7265 7175 6573 7473 2e48 5454 5045  t requests.HTTPE
-000113b0: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
-000113c0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-000113d0: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
-000113e0: 626d 6974 7469 6e67 2074 6173 6b3a 207b  bmitting task: {
-000113f0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
-00011400: 2229 0a20 2020 2020 2020 2020 2020 2023  ").            #
-00011410: 206e 6f74 2063 7265 6174 696e 6720 6120   not creating a 
-00011420: 6e65 7720 6578 6365 7074 696f 6e20 6865  new exception he
-00011430: 7265 2c20 696e 206f 7264 6572 2074 6f20  re, in order to 
-00011440: 6b65 6570 2074 6865 2072 6573 706f 6e73  keep the respons
-00011450: 6520 616e 6420 7374 6174 7573 2063 6f64  e and status cod
-00011460: 6520 696e 2074 6865 2065 7863 6570 7469  e in the excepti
-00011470: 6f6e 0a20 2020 2020 2020 2020 2020 2072  on.            r
-00011480: 6169 7365 0a0a 2020 2020 2020 2020 6578  aise..        ex
-00011490: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
-000114a0: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
-000114b0: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
-000114c0: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
-000114d0: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
-000114e0: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
-000114f0: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
-00011500: 7272 6f72 2822 6572 726f 723a 2063 616e  rror("error: can
-00011510: 6e6f 7420 7375 626d 6974 2074 6173 6b22  not submit task"
-00011520: 2920 6672 6f6d 2065 7272 0a0a 2020 2020  ) from err..    
-00011530: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
-00011540: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
-00011550: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
-00011560: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
-00011570: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
-00011580: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00011590: 4572 726f 7228 6622 6261 6420 6675 6e63  Error(f"bad func
-000115a0: 7469 6f6e 2072 756e 2072 6573 706f 6e73  tion run respons
-000115b0: 652c 207b 7265 7370 2e74 6578 747d 2229  e, {resp.text}")
-000115c0: 0a0a 2020 2020 2020 2020 7265 7370 203d  ..        resp =
-000115d0: 2072 6573 702e 6a73 6f6e 2829 0a20 2020   resp.json().   
-000115e0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-000115f0: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
-00011600: 6620 7375 626d 6974 5f70 6970 656c 696e  f submit_pipelin
-00011610: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00011620: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00011630: 2c0a 2020 2020 2020 2020 7069 7065 6c69  ,.        pipeli
-00011640: 6e65 2c0a 2020 2020 2020 2020 6172 6775  ne,.        argu
-00011650: 6d65 6e74 733d 4e6f 6e65 2c0a 2020 2020  ments=None,.    
-00011660: 2020 2020 6578 7065 7269 6d65 6e74 3d4e      experiment=N
-00011670: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
-00011680: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00011690: 616d 6573 7061 6365 3d4e 6f6e 652c 0a20  amespace=None,. 
-000116a0: 2020 2020 2020 2061 7274 6966 6163 745f         artifact_
-000116b0: 7061 7468 3d4e 6f6e 652c 0a20 2020 2020  path=None,.     
-000116c0: 2020 206f 7073 3d4e 6f6e 652c 0a20 2020     ops=None,.   
-000116d0: 2020 2020 2063 6c65 616e 7570 5f74 746c       cleanup_ttl
-000116e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
-000116f0: 696d 656f 7574 3d36 302c 0a20 2020 2029  imeout=60,.    )
-00011700: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
-00011710: 6d69 7420 6120 4b46 5020 7069 7065 6c69  mit a KFP pipeli
-00011720: 6e65 2066 6f72 2065 7865 6375 7469 6f6e  ne for execution
-00011730: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00011740: 6d20 7072 6f6a 6563 743a 2020 2020 2020  m project:      
-00011750: 2020 2054 6865 2070 726f 6a65 6374 206f     The project o
-00011760: 6620 7468 6520 7069 7065 6c69 6e65 0a20  f the pipeline. 
-00011770: 2020 2020 2020 203a 7061 7261 6d20 7069         :param pi
-00011780: 7065 6c69 6e65 3a20 2020 2020 2020 2050  peline:        P
-00011790: 6970 656c 696e 6520 6675 6e63 7469 6f6e  ipeline function
-000117a0: 206f 7220 7061 7468 2074 6f20 2e79 616d   or path to .yam
-000117b0: 6c2f 2e7a 6970 2070 6970 656c 696e 6520  l/.zip pipeline 
-000117c0: 6669 6c65 2e0a 2020 2020 2020 2020 3a70  file..        :p
-000117d0: 6172 616d 2061 7267 756d 656e 7473 3a20  aram arguments: 
-000117e0: 2020 2020 2020 4120 6469 6374 696f 6e61        A dictiona
-000117f0: 7279 206f 6620 6172 6775 6d65 6e74 7320  ry of arguments 
-00011800: 746f 2070 6173 7320 746f 2074 6865 2070  to pass to the p
-00011810: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
-00011820: 203a 7061 7261 6d20 6578 7065 7269 6d65   :param experime
-00011830: 6e74 3a20 2020 2020 2041 206e 616d 6520  nt:      A name 
-00011840: 746f 2061 7373 6967 6e20 666f 7220 7468  to assign for th
-00011850: 6520 7370 6563 6966 6963 2065 7870 6572  e specific exper
-00011860: 696d 656e 742e 0a20 2020 2020 2020 203a  iment..        :
-00011870: 7061 7261 6d20 7275 6e3a 2020 2020 2020  param run:      
-00011880: 2020 2020 2020 2041 206e 616d 6520 666f         A name fo
-00011890: 7220 7468 6973 2073 7065 6369 6669 6320  r this specific 
-000118a0: 7275 6e2e 0a20 2020 2020 2020 203a 7061  run..        :pa
-000118b0: 7261 6d20 6e61 6d65 7370 6163 653a 2020  ram namespace:  
-000118c0: 2020 2020 204b 7562 6572 6e65 7465 7320       Kubernetes 
-000118d0: 6e61 6d65 7370 6163 6520 746f 2065 7865  namespace to exe
-000118e0: 6375 7465 2074 6865 2070 6970 656c 696e  cute the pipelin
-000118f0: 6520 696e 2e0a 2020 2020 2020 2020 3a70  e in..        :p
-00011900: 6172 616d 2061 7274 6966 6163 745f 7061  aram artifact_pa
-00011910: 7468 3a20 2020 4120 7061 7468 2074 6f20  th:   A path to 
-00011920: 6172 7469 6661 6374 7320 7573 6564 2062  artifacts used b
-00011930: 7920 7468 6973 2070 6970 656c 696e 652e  y this pipeline.
-00011940: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00011950: 6f70 733a 2020 2020 2020 2020 2020 2020  ops:            
-00011960: 2054 7261 6e73 666f 726d 6572 7320 746f   Transformers to
-00011970: 2061 7070 6c79 206f 6e20 616c 6c20 6f70   apply on all op
-00011980: 7320 696e 2074 6865 2070 6970 656c 696e  s in the pipelin
-00011990: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-000119a0: 6d20 636c 6561 6e75 705f 7474 6c3a 2020  m cleanup_ttl:  
-000119b0: 2020 2050 6970 656c 696e 6520 636c 6561     Pipeline clea
-000119c0: 6e75 7020 7474 6c20 696e 2073 6563 7320  nup ttl in secs 
-000119d0: 2874 696d 6520 746f 2077 6169 7420 6166  (time to wait af
-000119e0: 7465 7220 776f 726b 666c 6f77 2063 6f6d  ter workflow com
-000119f0: 706c 6574 696f 6e2c 2061 7420 7768 6963  pletion, at whic
-00011a00: 6820 706f 696e 7420 7468 650a 2020 2020  h point the.    
-00011a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a20: 2020 2020 2020 2020 2020 2020 776f 726b              work
-00011a30: 666c 6f77 2061 6e64 2061 6c6c 2069 7473  flow and all its
-00011a40: 2072 6573 6f75 7263 6573 2061 7265 2064   resources are d
-00011a50: 656c 6574 6564 290a 2020 2020 2020 2020  eleted).        
-00011a60: 3a70 6172 616d 2074 696d 656f 7574 3a20  :param timeout: 
-00011a70: 2020 2020 2020 2020 5469 6d65 6f75 7420          Timeout 
-00011a80: 666f 7220 7468 6520 4150 4920 6361 6c6c  for the API call
-00011a90: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00011aa0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00011ab0: 616e 6365 2870 6970 656c 696e 652c 2073  ance(pipeline, s
-00011ac0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00011ad0: 2070 6970 655f 6669 6c65 203d 2070 6970   pipe_file = pip
-00011ae0: 656c 696e 650a 2020 2020 2020 2020 656c  eline.        el
-00011af0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00011b00: 7069 7065 5f66 696c 6520 3d20 7465 6d70  pipe_file = temp
-00011b10: 6669 6c65 2e4e 616d 6564 5465 6d70 6f72  file.NamedTempor
-00011b20: 6172 7946 696c 6528 7375 6666 6978 3d22  aryFile(suffix="
-00011b30: 2e79 616d 6c22 2c20 6465 6c65 7465 3d46  .yaml", delete=F
-00011b40: 616c 7365 292e 6e61 6d65 0a20 2020 2020  alse).name.     
-00011b50: 2020 2020 2020 2063 6f6e 6620 3d20 6e65         conf = ne
-00011b60: 775f 7069 7065 5f6d 6574 6164 6174 6128  w_pipe_metadata(
-00011b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011b80: 2061 7274 6966 6163 745f 7061 7468 3d61   artifact_path=a
-00011b90: 7274 6966 6163 745f 7061 7468 2c0a 2020  rtifact_path,.  
-00011ba0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00011bb0: 6561 6e75 705f 7474 6c3d 636c 6561 6e75  eanup_ttl=cleanu
-00011bc0: 705f 7474 6c2c 0a20 2020 2020 2020 2020  p_ttl,.         
-00011bd0: 2020 2020 2020 206f 705f 7472 616e 7366         op_transf
-00011be0: 6f72 6d65 7273 3d6f 7073 2c0a 2020 2020  ormers=ops,.    
-00011bf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00011c00: 2020 2020 2020 6b66 702e 636f 6d70 696c        kfp.compil
-00011c10: 6572 2e43 6f6d 7069 6c65 7228 292e 636f  er.Compiler().co
-00011c20: 6d70 696c 6528 0a20 2020 2020 2020 2020  mpile(.         
-00011c30: 2020 2020 2020 2070 6970 656c 696e 652c         pipeline,
-00011c40: 2070 6970 655f 6669 6c65 2c20 7479 7065   pipe_file, type
-00011c50: 5f63 6865 636b 3d46 616c 7365 2c20 7069  _check=False, pi
-00011c60: 7065 6c69 6e65 5f63 6f6e 663d 636f 6e66  peline_conf=conf
-00011c70: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00011c80: 2020 2020 2020 2020 6966 2070 6970 655f          if pipe_
-00011c90: 6669 6c65 2e65 6e64 7377 6974 6828 222e  file.endswith(".
-00011ca0: 7961 6d6c 2229 3a0a 2020 2020 2020 2020  yaml"):.        
-00011cb0: 2020 2020 6865 6164 6572 7320 3d20 7b22      headers = {"
-00011cc0: 636f 6e74 656e 742d 7479 7065 223a 2022  content-type": "
-00011cd0: 6170 706c 6963 6174 696f 6e2f 7961 6d6c  application/yaml
-00011ce0: 227d 0a20 2020 2020 2020 2065 6c69 6620  "}.        elif 
-00011cf0: 7069 7065 5f66 696c 652e 656e 6473 7769  pipe_file.endswi
-00011d00: 7468 2822 2e7a 6970 2229 3a0a 2020 2020  th(".zip"):.    
-00011d10: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
-00011d20: 3d20 7b22 636f 6e74 656e 742d 7479 7065  = {"content-type
-00011d30: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
-00011d40: 7a69 7022 7d0a 2020 2020 2020 2020 656c  zip"}.        el
-00011d50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00011d60: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00011d70: 2822 7069 7065 6c69 6e65 2066 696c 6520  ("pipeline file 
-00011d80: 6d75 7374 2062 6520 2e79 616d 6c20 6f72  must be .yaml or
-00011d90: 202e 7a69 7022 290a 2020 2020 2020 2020   .zip").        
-00011da0: 6966 2061 7267 756d 656e 7473 3a0a 2020  if arguments:.  
-00011db0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00011dc0: 2069 7369 6e73 7461 6e63 6528 6172 6775   isinstance(argu
-00011dd0: 6d65 6e74 732c 2064 6963 7429 3a0a 2020  ments, dict):.  
-00011de0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00011df0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00011e00: 6172 6775 6d65 6e74 7320 6d75 7374 2062  arguments must b
-00011e10: 6520 6469 6374 2074 7970 6522 290a 2020  e dict type").  
-00011e20: 2020 2020 2020 2020 2020 6865 6164 6572            header
-00011e30: 735b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  s[mlrun.common.s
-00011e40: 6368 656d 6173 2e48 6561 6465 724e 616d  chemas.HeaderNam
-00011e50: 6573 2e70 6970 656c 696e 655f 6172 6775  es.pipeline_argu
-00011e60: 6d65 6e74 735d 203d 2073 7472 280a 2020  ments] = str(.  
-00011e70: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00011e80: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-00011e90: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00011ea0: 6620 6e6f 7420 7061 7468 2e69 7366 696c  f not path.isfil
-00011eb0: 6528 7069 7065 5f66 696c 6529 3a0a 2020  e(pipe_file):.  
-00011ec0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011ed0: 4f53 4572 726f 7228 6622 6669 6c65 207b  OSError(f"file {
-00011ee0: 7069 7065 5f66 696c 657d 2064 6f65 736e  pipe_file} doesn
-00011ef0: 7420 6578 6973 7422 290a 2020 2020 2020  t exist").      
-00011f00: 2020 7769 7468 206f 7065 6e28 7069 7065    with open(pipe
-00011f10: 5f66 696c 652c 2022 7262 2229 2061 7320  _file, "rb") as 
-00011f20: 6670 3a0a 2020 2020 2020 2020 2020 2020  fp:.            
-00011f30: 6461 7461 203d 2066 702e 7265 6164 2829  data = fp.read()
-00011f40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00011f50: 6973 696e 7374 616e 6365 2870 6970 656c  isinstance(pipel
-00011f60: 696e 652c 2073 7472 293a 0a20 2020 2020  ine, str):.     
-00011f70: 2020 2020 2020 2072 656d 6f76 6528 7069         remove(pi
-00011f80: 7065 5f66 696c 6529 0a0a 2020 2020 2020  pe_file)..      
-00011f90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00011fa0: 2020 2070 6172 616d 7320 3d20 7b22 6e61     params = {"na
-00011fb0: 6d65 7370 6163 6522 3a20 6e61 6d65 7370  mespace": namesp
-00011fc0: 6163 652c 2022 6578 7065 7269 6d65 6e74  ace, "experiment
-00011fd0: 223a 2065 7870 6572 696d 656e 742c 2022  ": experiment, "
-00011fe0: 7275 6e22 3a20 7275 6e7d 0a20 2020 2020  run": run}.     
-00011ff0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-00012000: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00012010: 2020 2020 2020 2020 2020 2020 2022 504f               "PO
-00012020: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-00012030: 2020 2020 2066 2270 726f 6a65 6374 732f       f"projects/
-00012040: 7b70 726f 6a65 6374 7d2f 7069 7065 6c69  {project}/pipeli
-00012050: 6e65 7322 2c0a 2020 2020 2020 2020 2020  nes",.          
-00012060: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
-00012070: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-00012080: 2020 2020 2074 696d 656f 7574 3d74 696d       timeout=tim
-00012090: 656f 7574 2c0a 2020 2020 2020 2020 2020  eout,.          
-000120a0: 2020 2020 2020 626f 6479 3d64 6174 612c        body=data,
-000120b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000120c0: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
-000120d0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000120e0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-000120f0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-00012100: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-00012110: 722e 6572 726f 7228 2245 7272 6f72 3a20  r.error("Error: 
-00012120: 4361 6e6e 6f74 2073 7562 6d69 7420 7069  Cannot submit pi
-00012130: 7065 6c69 6e65 222c 2065 7272 3d65 7272  peline", err=err
-00012140: 5f74 6f5f 7374 7228 6572 7229 290a 2020  _to_str(err)).  
-00012150: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00012160: 4f53 4572 726f 7228 6622 4572 726f 723a  OSError(f"Error:
-00012170: 2043 616e 6e6f 7420 7375 626d 6974 2070   Cannot submit p
-00012180: 6970 656c 696e 652c 207b 6572 725f 746f  ipeline, {err_to
-00012190: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
-000121a0: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
-000121b0: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
-000121c0: 2020 6c6f 6767 6572 2e65 7272 6f72 2822    logger.error("
-000121d0: 4661 696c 6564 2074 6f20 7375 626d 6974  Failed to submit
-000121e0: 2070 6970 656c 696e 6522 2c20 7265 7370   pipeline", resp
-000121f0: 6f6e 6573 5f74 6578 743d 7265 7370 2e74  ones_text=resp.t
-00012200: 6578 7429 0a20 2020 2020 2020 2020 2020  ext).           
-00012210: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00012220: 7228 6622 4661 696c 6564 2074 6f20 7375  r(f"Failed to su
-00012230: 626d 6974 2070 6970 656c 696e 652c 207b  bmit pipeline, {
-00012240: 7265 7370 2e74 6578 747d 2229 0a0a 2020  resp.text}")..  
-00012250: 2020 2020 2020 7265 7370 203d 2072 6573        resp = res
-00012260: 702e 6a73 6f6e 2829 0a20 2020 2020 2020  p.json().       
-00012270: 206c 6f67 6765 722e 696e 666f 280a 2020   logger.info(.  
-00012280: 2020 2020 2020 2020 2020 2250 6970 656c            "Pipel
-00012290: 696e 6520 7375 626d 6974 7465 6420 7375  ine submitted su
-000122a0: 6363 6573 7366 756c 6c79 222c 2070 6970  ccessfully", pip
-000122b0: 656c 696e 655f 6e61 6d65 3d72 6573 705b  eline_name=resp[
-000122c0: 226e 616d 6522 5d2c 2069 643d 7265 7370  "name"], id=resp
-000122d0: 5b22 6964 225d 0a20 2020 2020 2020 2029  ["id"].        )
-000122e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000122f0: 7265 7370 5b22 6964 225d 0a0a 2020 2020  resp["id"]..    
-00012300: 6465 6620 6c69 7374 5f70 6970 656c 696e  def list_pipelin
-00012310: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
-00012320: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-00012330: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-00012340: 6e61 6d65 7370 6163 653a 2073 7472 203d  namespace: str =
-00012350: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00012360: 6f72 745f 6279 3a20 7374 7220 3d20 2222  ort_by: str = ""
-00012370: 2c0a 2020 2020 2020 2020 7061 6765 5f74  ,.        page_t
-00012380: 6f6b 656e 3a20 7374 7220 3d20 2222 2c0a  oken: str = "",.
-00012390: 2020 2020 2020 2020 6669 6c74 6572 5f3a          filter_:
-000123a0: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
-000123b0: 2020 2066 6f72 6d61 745f 3a20 556e 696f     format_: Unio
-000123c0: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-000123d0: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-000123e0: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
-000123f0: 6573 466f 726d 6174 0a20 2020 2020 2020  esFormat.       
-00012400: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
-00012410: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
-00012420: 6e65 7346 6f72 6d61 742e 6d65 7461 6461  nesFormat.metada
-00012430: 7461 5f6f 6e6c 792c 0a20 2020 2020 2020  ta_only,.       
-00012440: 2070 6167 655f 7369 7a65 3a20 696e 7420   page_size: int 
-00012450: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
-00012460: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00012470: 6865 6d61 732e 5069 7065 6c69 6e65 734f  hemas.PipelinesO
-00012480: 7574 7075 743a 0a20 2020 2020 2020 2022  utput:.        "
-00012490: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
-000124a0: 7420 6f66 204b 4650 2070 6970 656c 696e  t of KFP pipelin
-000124b0: 6573 2e20 5468 6973 2066 756e 6374 696f  es. This functio
-000124c0: 6e20 6361 6e20 6265 2069 6e76 6f6b 6564  n can be invoked
-000124d0: 2074 6f20 6765 7420 616c 6c20 7069 7065   to get all pipe
-000124e0: 6c69 6e65 7320 6672 6f6d 2061 6c6c 2070  lines from all p
-000124f0: 726f 6a65 6374 732c 0a20 2020 2020 2020  rojects,.       
-00012500: 2062 7920 7370 6563 6966 7969 6e67 2060   by specifying `
-00012510: 6070 726f 6a65 6374 3d2a 6060 2c20 696e  `project=*``, in
-00012520: 2077 6869 6368 2063 6173 6520 7061 6769   which case pagi
-00012530: 6e61 7469 6f6e 2063 616e 2062 6520 7573  nation can be us
-00012540: 6564 2061 6e64 2074 6865 2076 6172 696f  ed and the vario
-00012550: 7573 2073 6f72 7469 6e67 2061 6e64 2070  us sorting and p
-00012560: 6167 696e 6174 696f 6e0a 2020 2020 2020  agination.      
-00012570: 2020 7072 6f70 6572 7469 6573 2063 616e    properties can
-00012580: 2062 6520 6170 706c 6965 642e 2049 6620   be applied. If 
-00012590: 6120 7370 6563 6966 6963 2070 726f 6a65  a specific proje
-000125a0: 6374 2069 7320 7265 7175 6573 7465 642c  ct is requested,
-000125b0: 2074 6865 6e20 7468 6520 7061 6769 6e61   then the pagina
-000125c0: 7469 6f6e 206f 7074 696f 6e73 2063 616e  tion options can
-000125d0: 6e6f 7420 6265 0a20 2020 2020 2020 2075  not be.        u
-000125e0: 7365 6420 616e 6420 7061 6769 6e61 7469  sed and paginati
-000125f0: 6f6e 2069 7320 6e6f 7420 6170 706c 6965  on is not applie
-00012600: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
-00012610: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-00012620: 6563 7420 6e61 6d65 2e20 4361 6e20 6265  ect name. Can be
-00012630: 2060 602a 6060 2066 6f72 2071 7565 7279   ``*`` for query
-00012640: 2061 6372 6f73 7320 616c 6c20 7072 6f6a   across all proj
-00012650: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-00012660: 6172 616d 206e 616d 6573 7061 6365 3a20  aram namespace: 
-00012670: 4b75 6265 726e 6574 6573 206e 616d 6573  Kubernetes names
-00012680: 7061 6365 2069 6e20 7768 6963 6820 7468  pace in which th
-00012690: 6520 7069 7065 6c69 6e65 7320 6172 6520  e pipelines are 
-000126a0: 6578 6563 7574 696e 672e 0a20 2020 2020  executing..     
-000126b0: 2020 203a 7061 7261 6d20 736f 7274 5f62     :param sort_b
-000126c0: 793a 2046 6965 6c64 2074 6f20 736f 7274  y: Field to sort
-000126d0: 2074 6865 2072 6573 756c 7473 2062 792e   the results by.
-000126e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000126f0: 7061 6765 5f74 6f6b 656e 3a20 5573 6520  page_token: Use 
-00012700: 666f 7220 7061 6769 6e61 7469 6f6e 2c20  for pagination, 
-00012710: 746f 2072 6574 7269 6576 6520 6e65 7874  to retrieve next
-00012720: 2070 6167 652e 0a20 2020 2020 2020 203a   page..        :
-00012730: 7061 7261 6d20 6669 6c74 6572 5f3a 204b  param filter_: K
-00012740: 7562 6572 6e65 7465 7320 6669 6c74 6572  ubernetes filter
-00012750: 2074 6f20 6170 706c 7920 746f 2074 6865   to apply to the
-00012760: 2071 7565 7279 2c20 6361 6e20 6265 2075   query, can be u
-00012770: 7365 6420 746f 2066 696c 7465 7220 6f6e  sed to filter on
-00012780: 2073 7065 6369 6669 6320 6f62 6a65 6374   specific object
-00012790: 2066 6965 6c64 732e 0a20 2020 2020 2020   fields..       
-000127a0: 203a 7061 7261 6d20 666f 726d 6174 5f3a   :param format_:
-000127b0: 2052 6573 756c 7420 666f 726d 6174 2e20   Result format. 
-000127c0: 4361 6e20 6265 206f 6e65 206f 663a 0a0a  Can be one of:..
-000127d0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-000127e0: 6675 6c6c 6060 202d 2072 6574 7572 6e20  full`` - return 
-000127f0: 7468 6520 6675 6c6c 206f 626a 6563 7473  the full objects
-00012800: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00012810: 6060 6d65 7461 6461 7461 5f6f 6e6c 7960  ``metadata_only`
-00012820: 6020 2864 6566 6175 6c74 2920 2d20 7265  ` (default) - re
-00012830: 7475 726e 206a 7573 7420 6d65 7461 6461  turn just metada
-00012840: 7461 206f 6620 7468 6520 7069 7065 6c69  ta of the pipeli
-00012850: 6e65 7320 6f62 6a65 6374 732e 0a20 2020  nes objects..   
-00012860: 2020 2020 2020 2020 202d 2060 606e 616d           - ``nam
-00012870: 655f 6f6e 6c79 6060 202d 2072 6574 7572  e_only`` - retur
-00012880: 6e20 6a75 7374 2074 6865 206e 616d 6573  n just the names
-00012890: 206f 6620 7468 6520 7069 7065 6c69 6e65   of the pipeline
-000128a0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-000128b0: 2020 3a70 6172 616d 2070 6167 655f 7369    :param page_si
-000128c0: 7a65 3a20 5369 7a65 206f 6620 6120 7369  ze: Size of a si
-000128d0: 6e67 6c65 2070 6167 6520 7768 656e 2061  ngle page when a
-000128e0: 7070 6c79 696e 6720 7061 6769 6e61 7469  pplying paginati
-000128f0: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-00012900: 0a20 2020 2020 2020 2069 6620 7072 6f6a  .        if proj
-00012910: 6563 7420 213d 2022 2a22 2061 6e64 2028  ect != "*" and (
-00012920: 7061 6765 5f74 6f6b 656e 206f 7220 7061  page_token or pa
-00012930: 6765 5f73 697a 6529 3a0a 2020 2020 2020  ge_size):.      
-00012940: 2020 2020 2020 7261 6973 6520 6d6c 7275        raise mlru
-00012950: 6e2e 6572 726f 7273 2e4d 4c52 756e 496e  n.errors.MLRunIn
-00012960: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
-00012970: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00012980: 2020 2020 2246 696c 7465 7269 6e67 2062      "Filtering b
-00012990: 7920 7072 6f6a 6563 7420 6361 6e20 6e6f  y project can no
-000129a0: 7420 6265 2075 7365 6420 746f 6765 7468  t be used togeth
-000129b0: 6572 2077 6974 6820 7061 6769 6e61 7469  er with paginati
-000129c0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-000129d0: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
-000129e0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000129f0: 2022 6e61 6d65 7370 6163 6522 3a20 6e61   "namespace": na
-00012a00: 6d65 7370 6163 652c 0a20 2020 2020 2020  mespace,.       
-00012a10: 2020 2020 2022 736f 7274 5f62 7922 3a20       "sort_by": 
-00012a20: 736f 7274 5f62 792c 0a20 2020 2020 2020  sort_by,.       
-00012a30: 2020 2020 2022 7061 6765 5f74 6f6b 656e       "page_token
-00012a40: 223a 2070 6167 655f 746f 6b65 6e2c 0a20  ": page_token,. 
-00012a50: 2020 2020 2020 2020 2020 2022 6669 6c74             "filt
-00012a60: 6572 223a 2066 696c 7465 725f 2c0a 2020  er": filter_,.  
-00012a70: 2020 2020 2020 2020 2020 2266 6f72 6d61            "forma
-00012a80: 7422 3a20 666f 726d 6174 5f2c 0a20 2020  t": format_,.   
-00012a90: 2020 2020 2020 2020 2022 7061 6765 5f73           "page_s
-00012aa0: 697a 6522 3a20 7061 6765 5f73 697a 652c  ize": page_size,
-00012ab0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00012ac0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00012ad0: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-00012ae0: 7469 6e67 2070 6970 656c 696e 6573 2c20  ting pipelines, 
-00012af0: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
-00012b00: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-00012b10: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-00012b20: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-00012b30: 4745 5422 2c20 6622 7072 6f6a 6563 7473  GET", f"projects
-00012b40: 2f7b 7072 6f6a 6563 747d 2f70 6970 656c  /{project}/pipel
-00012b50: 696e 6573 222c 2065 7272 6f72 5f6d 6573  ines", error_mes
-00012b60: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-00012b70: 616d 730a 2020 2020 2020 2020 290a 2020  ams.        ).  
-00012b80: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
-00012b90: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00012ba0: 732e 5069 7065 6c69 6e65 734f 7574 7075  s.PipelinesOutpu
-00012bb0: 7428 2a2a 7265 7370 6f6e 7365 2e6a 736f  t(**response.jso
-00012bc0: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
-00012bd0: 745f 7069 7065 6c69 6e65 280a 2020 2020  t_pipeline(.    
-00012be0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00012bf0: 2020 7275 6e5f 6964 3a20 7374 722c 0a20    run_id: str,. 
-00012c00: 2020 2020 2020 206e 616d 6573 7061 6365         namespace
-00012c10: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00012c20: 2020 2020 2020 7469 6d65 6f75 743a 2069        timeout: i
-00012c30: 6e74 203d 2033 302c 0a20 2020 2020 2020  nt = 30,.       
-00012c40: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
-00012c50: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00012c60: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-00012c70: 6368 656d 6173 2e50 6970 656c 696e 6573  chemas.Pipelines
-00012c80: 466f 726d 6174 0a20 2020 2020 2020 205d  Format.        ]
-00012c90: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
-00012ca0: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
-00012cb0: 7346 6f72 6d61 742e 7375 6d6d 6172 792c  sFormat.summary,
-00012cc0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00012cd0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00012ce0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00012cf0: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
-00012d00: 206f 6620 6120 7370 6563 6966 6963 2070   of a specific p
-00012d10: 6970 656c 696e 6520 7573 696e 6720 6974  ipeline using it
-00012d20: 7320 7275 6e20 4944 2028 6173 2070 726f  s run ID (as pro
-00012d30: 7669 6465 6420 7768 656e 2074 6865 2070  vided when the p
-00012d40: 6970 656c 696e 6520 7761 7320 6578 6563  ipeline was exec
-00012d50: 7574 6564 292e 2222 220a 0a20 2020 2020  uted)."""..     
-00012d60: 2020 2070 6172 616d 7320 3d20 7b7d 0a20     params = {}. 
-00012d70: 2020 2020 2020 2069 6620 6e61 6d65 7370         if namesp
-00012d80: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
-00012d90: 2070 6172 616d 735b 226e 616d 6573 7061   params["namespa
-00012da0: 6365 225d 203d 206e 616d 6573 7061 6365  ce"] = namespace
-00012db0: 0a20 2020 2020 2020 2070 6172 616d 735b  .        params[
-00012dc0: 2266 6f72 6d61 7422 5d20 3d20 666f 726d  "format"] = form
-00012dd0: 6174 5f0a 2020 2020 2020 2020 7072 6f6a  at_.        proj
-00012de0: 6563 745f 7061 7468 203d 2070 726f 6a65  ect_path = proje
-00012df0: 6374 2069 6620 7072 6f6a 6563 7420 656c  ct if project el
-00012e00: 7365 2022 2a22 0a20 2020 2020 2020 2072  se "*".        r
-00012e10: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-00012e20: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00012e30: 2022 4745 5422 2c0a 2020 2020 2020 2020   "GET",.        
-00012e40: 2020 2020 6622 7072 6f6a 6563 7473 2f7b      f"projects/{
-00012e50: 7072 6f6a 6563 745f 7061 7468 7d2f 7069  project_path}/pi
-00012e60: 7065 6c69 6e65 732f 7b72 756e 5f69 647d  pelines/{run_id}
-00012e70: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00012e80: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
-00012e90: 2020 2020 2020 2020 2020 7469 6d65 6f75            timeou
-00012ea0: 743d 7469 6d65 6f75 742c 0a20 2020 2020  t=timeout,.     
-00012eb0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-00012ec0: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
-00012ed0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-00012ee0: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
-00012ef0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
-00012f00: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-00012f10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00012f20: 6622 6261 6420 6765 7420 7069 7065 6c69  f"bad get pipeli
-00012f30: 6e65 2072 6573 706f 6e73 652c 207b 7265  ne response, {re
-00012f40: 7370 2e74 6578 747d 2229 0a0a 2020 2020  sp.text}")..    
-00012f50: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-00012f60: 6a73 6f6e 2829 0a0a 2020 2020 4073 7461  json()..    @sta
-00012f70: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-00012f80: 6620 5f72 6573 6f6c 7665 5f72 6566 6572  f _resolve_refer
-00012f90: 656e 6365 2874 6167 2c20 7569 6429 3a0a  ence(tag, uid):.
-00012fa0: 2020 2020 2020 2020 6966 2075 6964 2061          if uid a
-00012fb0: 6e64 2074 6167 3a0a 2020 2020 2020 2020  nd tag:.        
-00012fc0: 2020 2020 7261 6973 6520 4d4c 5275 6e49      raise MLRunI
-00012fd0: 6e76 616c 6964 4172 6775 6d65 6e74 4572  nvalidArgumentEr
-00012fe0: 726f 7228 2262 6f74 6820 7569 6420 616e  ror("both uid an
-00012ff0: 6420 7461 6720 7765 7265 2070 726f 7669  d tag were provi
-00013000: 6465 6422 290a 2020 2020 2020 2020 7265  ded").        re
-00013010: 7475 726e 2075 6964 206f 7220 7461 6720  turn uid or tag 
-00013020: 6f72 2022 6c61 7465 7374 220a 0a20 2020  or "latest"..   
-00013030: 2064 6566 2063 7265 6174 655f 6665 6174   def create_feat
-00013040: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
-00013050: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-00013060: 6561 7475 7265 5f73 6574 3a20 556e 696f  eature_set: Unio
-00013070: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
-00013080: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
-00013090: 7475 7265 5365 742c 2046 6561 7475 7265  tureSet, Feature
-000130a0: 5365 745d 2c0a 2020 2020 2020 2020 7072  Set],.        pr
-000130b0: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
-000130c0: 2020 7665 7273 696f 6e65 643d 5472 7565    versioned=True
-000130d0: 2c0a 2020 2020 2920 2d3e 2064 6963 743a  ,.    ) -> dict:
-000130e0: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-000130f0: 7465 2061 206e 6577 203a 7079 3a63 6c61  te a new :py:cla
-00013100: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00013110: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00013120: 5365 7460 2061 6e64 2073 6176 6520 696e  Set` and save in
-00013130: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
-00013140: 7275 6e60 2044 422e 2054 6865 0a20 2020  run` DB. The.   
-00013150: 2020 2020 2066 6561 7475 7265 2d73 6574       feature-set
-00013160: 206d 7573 7420 6e6f 7420 7072 6576 696f   must not previo
-00013170: 7573 6c79 2065 7869 7374 2069 6e20 7468  usly exist in th
-00013180: 6520 4442 2e0a 0a20 2020 2020 2020 203a  e DB...        :
-00013190: 7061 7261 6d20 6665 6174 7572 655f 7365  param feature_se
-000131a0: 743a 2054 6865 206e 6577 203a 7079 3a63  t: The new :py:c
-000131b0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
-000131c0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
-000131d0: 7265 5365 7460 2074 6f20 6372 6561 7465  reSet` to create
-000131e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000131f0: 2070 726f 6a65 6374 3a20 4e61 6d65 206f   project: Name o
-00013200: 6620 7072 6f6a 6563 7420 7468 6973 2066  f project this f
-00013210: 6561 7475 7265 2d73 6574 2062 656c 6f6e  eature-set belon
-00013220: 6773 2074 6f2e 0a20 2020 2020 2020 203a  gs to..        :
-00013230: 7061 7261 6d20 7665 7273 696f 6e65 643a  param versioned:
-00013240: 2057 6865 7468 6572 2074 6f20 6d61 696e   Whether to main
-00013250: 7461 696e 2076 6572 7369 6f6e 7320 666f  tain versions fo
-00013260: 7220 7468 6973 2066 6561 7475 7265 2d73  r this feature-s
-00013270: 6574 2e20 416c 6c20 7665 7273 696f 6e73  et. All versions
-00013280: 206f 6620 6120 7665 7273 696f 6e65 6420   of a versioned 
-00013290: 6f62 6a65 6374 0a20 2020 2020 2020 2020  object.         
-000132a0: 2020 2077 696c 6c20 6265 206b 6570 7420     will be kept 
-000132b0: 696e 2074 6865 2044 4220 616e 6420 6361  in the DB and ca
-000132c0: 6e20 6265 2072 6574 7269 6576 6564 2075  n be retrieved u
-000132d0: 6e74 696c 2065 7870 6c69 6369 746c 7920  ntil explicitly 
-000132e0: 6465 6c65 7465 642e 0a20 2020 2020 2020  deleted..       
-000132f0: 203a 7265 7475 726e 733a 2054 6865 203a   :returns: The :
-00013300: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-00013310: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
-00013320: 6561 7475 7265 5365 7460 206f 626a 6563  eatureSet` objec
-00013330: 7420 2861 7320 6469 6374 292e 0a20 2020  t (as dict)..   
-00013340: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00013350: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-00013360: 6561 7475 7265 5f73 6574 2c20 6d6c 7275  eature_set, mlru
-00013370: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00013380: 2e46 6561 7475 7265 5365 7429 3a0a 2020  .FeatureSet):.  
-00013390: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-000133a0: 655f 7365 7420 3d20 6665 6174 7572 655f  e_set = feature_
-000133b0: 7365 742e 6469 6374 2829 0a20 2020 2020  set.dict().     
-000133c0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-000133d0: 6365 2866 6561 7475 7265 5f73 6574 2c20  ce(feature_set, 
-000133e0: 4665 6174 7572 6553 6574 293a 0a20 2020  FeatureSet):.   
-000133f0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00013400: 5f73 6574 203d 2066 6561 7475 7265 5f73  _set = feature_s
-00013410: 6574 2e74 6f5f 6469 6374 2829 0a0a 2020  et.to_dict()..  
-00013420: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00013430: 280a 2020 2020 2020 2020 2020 2020 7072  (.            pr
-00013440: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
-00013450: 2020 6f72 2066 6561 7475 7265 5f73 6574    or feature_set
-00013460: 5b22 6d65 7461 6461 7461 225d 2e67 6574  ["metadata"].get
-00013470: 2822 7072 6f6a 6563 7422 2c20 4e6f 6e65  ("project", None
-00013480: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
-00013490: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-000134a0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-000134b0: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
-000134c0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000134d0: 6a65 6374 7d2f 6665 6174 7572 652d 7365  ject}/feature-se
-000134e0: 7473 220a 2020 2020 2020 2020 7061 7261  ts".        para
-000134f0: 6d73 203d 207b 2276 6572 7369 6f6e 6564  ms = {"versioned
-00013500: 223a 2076 6572 7369 6f6e 6564 7d0a 0a20  ": versioned}.. 
-00013510: 2020 2020 2020 206e 616d 6520 3d20 6665         name = fe
-00013520: 6174 7572 655f 7365 745b 226d 6574 6164  ature_set["metad
-00013530: 6174 6122 5d5b 226e 616d 6522 5d0a 2020  ata"]["name"].  
-00013540: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00013550: 6167 6520 3d20 6622 4661 696c 6564 2063  age = f"Failed c
-00013560: 7265 6174 696e 6720 6665 6174 7572 652d  reating feature-
-00013570: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
-00013580: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
-00013590: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-000135a0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-000135b0: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
-000135c0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-000135d0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000135e0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-000135f0: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
-00013600: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00013610: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
-00013620: 6174 7572 655f 7365 7429 2c0a 2020 2020  ature_set),.    
-00013630: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00013640: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-00013650: 0a0a 2020 2020 6465 6620 6765 745f 6665  ..    def get_fe
-00013660: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
-00013670: 2020 2073 656c 662c 206e 616d 653a 2073     self, name: s
-00013680: 7472 2c20 7072 6f6a 6563 743a 2073 7472  tr, project: str
-00013690: 203d 2022 222c 2074 6167 3a20 7374 7220   = "", tag: str 
-000136a0: 3d20 4e6f 6e65 2c20 7569 643a 2073 7472  = None, uid: str
-000136b0: 203d 204e 6f6e 650a 2020 2020 2920 2d3e   = None.    ) ->
-000136c0: 2046 6561 7475 7265 5365 743a 0a20 2020   FeatureSet:.   
-000136d0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-000136e0: 2061 207e 6d6c 7275 6e2e 6665 6174 7572   a ~mlrun.featur
-000136f0: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
-00013700: 6574 6020 6f62 6a65 6374 2e20 4966 2062  et` object. If b
-00013710: 6f74 6820 6060 7461 6760 6020 616e 6420  oth ``tag`` and 
-00013720: 6060 7569 6460 6020 6172 6520 6e6f 7420  ``uid`` are not 
-00013730: 7370 6563 6966 6965 642c 2074 6865 6e0a  specified, then.
-00013740: 2020 2020 2020 2020 7468 6520 6f62 6a65          the obje
-00013750: 6374 2074 6167 6765 6420 6060 6c61 7465  ct tagged ``late
-00013760: 7374 6060 2077 696c 6c20 6265 2072 6574  st`` will be ret
-00013770: 7269 6576 6564 2e0a 0a20 2020 2020 2020  rieved...       
-00013780: 203a 7061 7261 6d20 6e61 6d65 3a20 4e61   :param name: Na
-00013790: 6d65 206f 6620 6f62 6a65 6374 2074 6f20  me of object to 
-000137a0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
-000137b0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-000137c0: 3a20 5072 6f6a 6563 7420 7468 6520 4665  : Project the Fe
-000137d0: 6174 7572 6553 6574 2062 656c 6f6e 6773  atureSet belongs
-000137e0: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
-000137f0: 7261 6d20 7461 673a 2054 6167 206f 6620  ram tag: Tag of 
-00013800: 7468 6520 7370 6563 6966 6963 206f 626a  the specific obj
-00013810: 6563 7420 7665 7273 696f 6e20 746f 2072  ect version to r
-00013820: 6574 7269 6576 652e 0a20 2020 2020 2020  etrieve..       
-00013830: 203a 7061 7261 6d20 7569 643a 2075 6964   :param uid: uid
-00013840: 206f 6620 7468 6520 6f62 6a65 6374 2074   of the object t
-00013850: 6f20 7265 7472 6965 7665 2028 6361 6e20  o retrieve (can 
-00013860: 6f6e 6c79 2062 6520 7573 6564 2066 6f72  only be used for
-00013870: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
-00013880: 7473 292e 0a20 2020 2020 2020 2022 2222  ts)..        """
-00013890: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
-000138a0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
-000138b0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-000138c0: 6f6a 6563 740a 2020 2020 2020 2020 7265  oject.        re
-000138d0: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
-000138e0: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
-000138f0: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
-00013900: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00013910: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00013920: 6665 6174 7572 652d 7365 7473 2f7b 6e61  feature-sets/{na
-00013930: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
-00013940: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
-00013950: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00013960: 6520 3d20 6622 4661 696c 6564 2072 6574  e = f"Failed ret
-00013970: 7269 6576 696e 6720 6665 6174 7572 652d  rieving feature-
-00013980: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
-00013990: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
-000139a0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-000139b0: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
-000139c0: 6572 726f 725f 6d65 7373 6167 6529 0a20  error_message). 
-000139d0: 2020 2020 2020 2072 6574 7572 6e20 4665         return Fe
-000139e0: 6174 7572 6553 6574 2e66 726f 6d5f 6469  atureSet.from_di
-000139f0: 6374 2872 6573 702e 6a73 6f6e 2829 290a  ct(resp.json()).
-00013a00: 0a20 2020 2064 6566 206c 6973 745f 6665  .    def list_fe
-00013a10: 6174 7572 6573 280a 2020 2020 2020 2020  atures(.        
-00013a20: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00013a30: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00013a40: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-00013a50: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
-00013a60: 673a 2073 7472 203d 204e 6f6e 652c 0a20  g: str = None,. 
-00013a70: 2020 2020 2020 2065 6e74 6974 6965 733a         entities:
-00013a80: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
-00013a90: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
-00013aa0: 733a 206c 6973 745b 7374 725d 203d 204e  s: list[str] = N
-00013ab0: 6f6e 652c 0a20 2020 2029 202d 3e20 6c69  one,.    ) -> li
-00013ac0: 7374 5b64 6963 745d 3a0a 2020 2020 2020  st[dict]:.      
-00013ad0: 2020 2222 224c 6973 7420 6665 6174 7572    """List featur
-00013ae0: 652d 7365 7473 2077 6869 6368 2063 6f6e  e-sets which con
-00013af0: 7461 696e 2073 7065 6369 6669 6320 6665  tain specific fe
-00013b00: 6174 7572 6573 2e20 5468 6973 2066 756e  atures. This fun
-00013b10: 6374 696f 6e20 6d61 7920 7265 7475 726e  ction may return
-00013b20: 206d 756c 7469 706c 6520 7665 7273 696f   multiple versio
-00013b30: 6e73 206f 6620 7468 6520 7361 6d65 0a20  ns of the same. 
-00013b40: 2020 2020 2020 2066 6561 7475 7265 2d73         feature-s
-00013b50: 6574 2069 6620 6120 7370 6563 6966 6963  et if a specific
-00013b60: 2074 6167 2069 7320 6e6f 7420 7265 7175   tag is not requ
-00013b70: 6573 7465 642e 204e 6f74 6520 7468 6174  ested. Note that
-00013b80: 2074 6865 2076 6172 696f 7573 2066 696c   the various fil
-00013b90: 7465 7273 206f 6620 7468 6973 2066 756e  ters of this fun
-00013ba0: 6374 696f 6e20 6163 7475 616c 6c79 0a20  ction actually. 
-00013bb0: 2020 2020 2020 2072 6566 6572 2074 6f20         refer to 
-00013bc0: 7468 6520 6665 6174 7572 652d 7365 7420  the feature-set 
-00013bd0: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
-00013be0: 6720 7468 6520 6665 6174 7572 6573 2c20  g the features, 
-00013bf0: 6e6f 7420 746f 2074 6865 2066 6561 7475  not to the featu
-00013c00: 7265 7320 7468 656d 7365 6c76 6573 2e0a  res themselves..
-00013c10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00013c20: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-00013c30: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
-00013c40: 7468 6573 6520 6665 6174 7572 6573 2e0a  these features..
-00013c50: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00013c60: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-00013c70: 2066 6561 7475 7265 2074 6f20 6c6f 6f6b   feature to look
-00013c80: 2066 6f72 2e20 5468 6520 6e61 6d65 2069   for. The name i
-00013c90: 7320 7573 6564 2069 6e20 6120 6c69 6b65  s used in a like
-00013ca0: 2071 7565 7279 2c20 616e 6420 6973 206e   query, and is n
-00013cb0: 6f74 2063 6173 652d 7365 6e73 6974 6976  ot case-sensitiv
-00013cc0: 652e 2046 6f72 0a20 2020 2020 2020 2020  e. For.         
-00013cd0: 2020 2065 7861 6d70 6c65 2c20 6c6f 6f6b     example, look
-00013ce0: 696e 6720 666f 7220 6060 6665 6174 6060  ing for ``feat``
-00013cf0: 2077 696c 6c20 7265 7475 726e 2066 6561   will return fea
-00013d00: 7475 7265 7320 7768 6963 6820 6172 6520  tures which are 
-00013d10: 6e61 6d65 6420 6060 4d79 4665 6174 7572  named ``MyFeatur
-00013d20: 6560 6020 6173 2077 656c 6c20 6173 2060  e`` as well as `
-00013d30: 6064 6566 6561 7460 602e 0a20 2020 2020  `defeat``..     
-00013d40: 2020 203a 7061 7261 6d20 7461 673a 2052     :param tag: R
-00013d50: 6574 7572 6e20 6665 6174 7572 652d 7365  eturn feature-se
-00013d60: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
-00013d70: 2074 6865 2066 6561 7475 7265 7320 6c6f   the features lo
-00013d80: 6f6b 6564 2066 6f72 2c20 616e 6420 6172  oked for, and ar
-00013d90: 6520 7461 6767 6564 2077 6974 6820 7468  e tagged with th
-00013da0: 6520 7370 6563 6966 6963 2074 6167 2e0a  e specific tag..
-00013db0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
-00013dc0: 6e74 6974 6965 733a 2052 6574 7572 6e20  ntities: Return 
-00013dd0: 6f6e 6c79 2066 6561 7475 7265 2d73 6574  only feature-set
-00013de0: 7320 7768 6963 6820 636f 6e74 6169 6e20  s which contain 
-00013df0: 616e 2065 6e74 6974 7920 7768 6f73 6520  an entity whose 
-00013e00: 6e61 6d65 2069 7320 636f 6e74 6169 6e65  name is containe
-00013e10: 6420 696e 2074 6869 7320 6c69 7374 2e0a  d in this list..
-00013e20: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-00013e30: 6162 656c 733a 2052 6574 7572 6e20 6f6e  abels: Return on
-00013e40: 6c79 2066 6561 7475 7265 2d73 6574 7320  ly feature-sets 
-00013e50: 7768 6963 6820 6172 6520 6c61 6265 6c65  which are labele
-00013e60: 6420 6173 2072 6571 7565 7374 6564 2e0a  d as requested..
-00013e70: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00013e80: 3a20 4120 6c69 7374 206f 6620 6d61 7070  : A list of mapp
-00013e90: 696e 6720 6672 6f6d 2066 6561 7475 7265  ing from feature
-00013ea0: 2074 6f20 6120 6469 6765 7374 206f 6620   to a digest of 
-00013eb0: 7468 6520 6665 6174 7572 652d 7365 742c  the feature-set,
-00013ec0: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
-00013ed0: 7468 6520 6665 6174 7572 652d 7365 740a  the feature-set.
-00013ee0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00013ef0: 2d64 6174 612e 204d 756c 7469 706c 6520  -data. Multiple 
-00013f00: 656e 7472 6965 7320 6d61 7920 6265 2072  entries may be r
-00013f10: 6574 7572 6e65 6420 666f 7220 616e 7920  eturned for any 
-00013f20: 7370 6563 6966 6963 2066 6561 7475 7265  specific feature
-00013f30: 2064 7565 2074 6f20 6d75 6c74 6970 6c65   due to multiple
-00013f40: 2074 6167 7320 6f72 2076 6572 7369 6f6e   tags or version
-00013f50: 730a 2020 2020 2020 2020 2020 2020 6f66  s.            of
-00013f60: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
-00013f70: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00013f80: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00013f90: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-00013fa0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-00013fb0: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
-00013fc0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00013fd0: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
-00013fe0: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
-00013ff0: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
-00014000: 2020 2020 2265 6e74 6974 7922 3a20 656e      "entity": en
-00014010: 7469 7469 6573 206f 7220 5b5d 2c0a 2020  tities or [],.  
-00014020: 2020 2020 2020 2020 2020 226c 6162 656c            "label
-00014030: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
-00014040: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00014050: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00014060: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00014070: 6665 6174 7572 6573 220a 0a20 2020 2020  features"..     
-00014080: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00014090: 203d 2066 2246 6169 6c65 6420 6c69 7374   = f"Failed list
-000140a0: 696e 6720 6665 6174 7572 6573 2c20 7072  ing features, pr
-000140b0: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
-000140c0: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
-000140d0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-000140e0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-000140f0: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00014100: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
-00014110: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
-00014120: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
-00014130: 736f 6e28 295b 2266 6561 7475 7265 7322  son()["features"
-00014140: 5d0a 0a20 2020 2064 6566 206c 6973 745f  ]..    def list_
-00014150: 656e 7469 7469 6573 280a 2020 2020 2020  entities(.      
-00014160: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00014170: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-00014180: 2020 2020 2020 6e61 6d65 3a20 7374 7220        name: str 
-00014190: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000141a0: 7461 673a 2073 7472 203d 204e 6f6e 652c  tag: str = None,
-000141b0: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
-000141c0: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
-000141d0: 652c 0a20 2020 2029 202d 3e20 6c69 7374  e,.    ) -> list
-000141e0: 5b64 6963 745d 3a0a 2020 2020 2020 2020  [dict]:.        
-000141f0: 2222 2252 6574 7269 6576 6520 6120 6c69  """Retrieve a li
-00014200: 7374 206f 6620 656e 7469 7469 6573 2061  st of entities a
-00014210: 6e64 2074 6865 6972 206d 6170 7069 6e67  nd their mapping
-00014220: 2074 6f20 7468 6520 636f 6e74 6169 6e69   to the containi
-00014230: 6e67 2066 6561 7475 7265 2d73 6574 732e  ng feature-sets.
-00014240: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
-00014250: 7320 7369 6d69 6c61 720a 2020 2020 2020  s similar.      
-00014260: 2020 746f 2074 6865 203a 7079 3a66 756e    to the :py:fun
-00014270: 633a 607e 6c69 7374 5f66 6561 7475 7265  c:`~list_feature
-00014280: 7360 2066 756e 6374 696f 6e2c 2061 6e64  s` function, and
-00014290: 2075 7365 7320 7468 6520 7361 6d65 206c   uses the same l
-000142a0: 6f67 6963 2e20 486f 7765 7665 722c 2074  ogic. However, t
-000142b0: 6865 2065 6e74 6974 6965 7320 6172 6520  he entities are 
-000142c0: 6d61 7463 6865 640a 2020 2020 2020 2020  matched.        
-000142d0: 6167 6169 6e73 7420 7468 6520 6e61 6d65  against the name
-000142e0: 2072 6174 6865 7220 7468 616e 2074 6865   rather than the
-000142f0: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
-00014300: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00014310: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-00014320: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-00014330: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-00014340: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00014350: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-00014360: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
-00014370: 2020 2020 2022 7461 6722 3a20 7461 672c       "tag": tag,
-00014380: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-00014390: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-000143a0: 5b5d 2c0a 2020 2020 2020 2020 7d0a 0a20  [],.        }.. 
-000143b0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-000143c0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000143d0: 747d 2f65 6e74 6974 6965 7322 0a0a 2020  t}/entities"..  
-000143e0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000143f0: 6167 6520 3d20 6622 4661 696c 6564 206c  age = f"Failed l
-00014400: 6973 7469 6e67 2065 6e74 6974 6965 732c  isting entities,
-00014410: 2070 726f 6a65 6374 3a20 7b70 726f 6a65   project: {proje
-00014420: 6374 7d2c 2071 7565 7279 3a20 7b70 6172  ct}, query: {par
-00014430: 616d 737d 220a 2020 2020 2020 2020 7265  ams}".        re
-00014440: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
-00014450: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
-00014460: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-00014470: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
-00014480: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00014490: 702e 6a73 6f6e 2829 5b22 656e 7469 7469  p.json()["entiti
-000144a0: 6573 225d 0a0a 2020 2020 4073 7461 7469  es"]..    @stati
-000144b0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-000144c0: 5f67 656e 6572 6174 655f 7061 7274 6974  _generate_partit
-000144d0: 696f 6e5f 6279 5f70 6172 616d 7328 0a20  ion_by_params(. 
-000144e0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-000144f0: 5f62 795f 636c 732c 0a20 2020 2020 2020  _by_cls,.       
-00014500: 2070 6172 7469 7469 6f6e 5f62 792c 0a20   partition_by,. 
-00014510: 2020 2020 2020 2072 6f77 735f 7065 725f         rows_per_
-00014520: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
-00014530: 2020 2073 6f72 745f 6279 2c0a 2020 2020     sort_by,.    
-00014540: 2020 2020 6f72 6465 722c 0a20 2020 2020      order,.     
-00014550: 2020 206d 6178 5f70 6172 7469 7469 6f6e     max_partition
-00014560: 733d 4e6f 6e65 2c0a 2020 2020 293a 0a20  s=None,.    ):. 
-00014570: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00014580: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
-00014590: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
-000145a0: 6f6e 2d62 7922 3a20 7061 7274 6974 696f  on-by": partitio
-000145b0: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
-000145c0: 2020 2272 6f77 732d 7065 722d 7061 7274    "rows-per-part
-000145d0: 6974 696f 6e22 3a20 726f 7773 5f70 6572  ition": rows_per
-000145e0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-000145f0: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
-00014600: 6f6e 2d73 6f72 742d 6279 223a 2073 6f72  on-sort-by": sor
-00014610: 745f 6279 2c0a 2020 2020 2020 2020 2020  t_by,.          
-00014620: 2020 2270 6172 7469 7469 6f6e 2d6f 7264    "partition-ord
-00014630: 6572 223a 206f 7264 6572 2c0a 2020 2020  er": order,.    
-00014640: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
-00014650: 206d 6178 5f70 6172 7469 7469 6f6e 7320   max_partitions 
-00014660: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00014670: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-00014680: 6f6e 5f70 6172 616d 735b 226d 6178 2d70  on_params["max-p
-00014690: 6172 7469 7469 6f6e 7322 5d20 3d20 6d61  artitions"] = ma
-000146a0: 785f 7061 7274 6974 696f 6e73 0a20 2020  x_partitions.   
-000146b0: 2020 2020 2072 6574 7572 6e20 7061 7274       return part
-000146c0: 6974 696f 6e5f 7061 7261 6d73 0a0a 2020  ition_params..  
-000146d0: 2020 6465 6620 6c69 7374 5f66 6561 7475    def list_featu
-000146e0: 7265 5f73 6574 7328 0a20 2020 2020 2020  re_sets(.       
-000146f0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00014700: 726f 6a65 6374 3a20 7374 7220 3d20 2222  roject: str = ""
-00014710: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-00014720: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-00014730: 2020 2020 7461 673a 2073 7472 203d 204e      tag: str = N
-00014740: 6f6e 652c 0a20 2020 2020 2020 2073 7461  one,.        sta
-00014750: 7465 3a20 7374 7220 3d20 4e6f 6e65 2c0a  te: str = None,.
-00014760: 2020 2020 2020 2020 656e 7469 7469 6573          entities
-00014770: 3a20 6c69 7374 5b73 7472 5d20 3d20 4e6f  : list[str] = No
-00014780: 6e65 2c0a 2020 2020 2020 2020 6665 6174  ne,.        feat
-00014790: 7572 6573 3a20 6c69 7374 5b73 7472 5d20  ures: list[str] 
-000147a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000147b0: 6c61 6265 6c73 3a20 6c69 7374 5b73 7472  labels: list[str
-000147c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-000147d0: 2020 7061 7274 6974 696f 6e5f 6279 3a20    partition_by: 
-000147e0: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
-000147f0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
-00014800: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-00014810: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
-00014820: 6965 6c64 2c20 7374 720a 2020 2020 2020  ield, str.      
-00014830: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
-00014840: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
-00014850: 7469 7469 6f6e 3a20 696e 7420 3d20 312c  tition: int = 1,
-00014860: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
-00014870: 6f6e 5f73 6f72 745f 6279 3a20 556e 696f  on_sort_by: Unio
-00014880: 6e5b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n[mlrun.common.s
-00014890: 6368 656d 6173 2e53 6f72 7446 6965 6c64  chemas.SortField
-000148a0: 2c20 7374 725d 203d 204e 6f6e 652c 0a20  , str] = None,. 
-000148b0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-000148c0: 5f6f 7264 6572 3a20 556e 696f 6e5b 0a20  _order: Union[. 
-000148d0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-000148e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000148f0: 4f72 6465 7254 7970 652c 2073 7472 0a20  OrderType, str. 
-00014900: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-00014910: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00014920: 4f72 6465 7254 7970 652e 6465 7363 2c0a  OrderType.desc,.
-00014930: 2020 2020 2920 2d3e 206c 6973 745b 4665      ) -> list[Fe
-00014940: 6174 7572 6553 6574 5d3a 0a20 2020 2020  atureSet]:.     
-00014950: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
-00014960: 206c 6973 7420 6f66 2066 6561 7475 7265   list of feature
-00014970: 2d73 6574 7320 6d61 7463 6869 6e67 2074  -sets matching t
-00014980: 6865 2063 7269 7465 7269 6120 7072 6f76  he criteria prov
-00014990: 6964 6564 2e0a 0a20 2020 2020 2020 203a  ided...        :
-000149a0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-000149b0: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
-000149c0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-000149d0: 3a20 4e61 6d65 206f 6620 6665 6174 7572  : Name of featur
-000149e0: 652d 7365 7420 746f 206d 6174 6368 2e20  e-set to match. 
-000149f0: 5468 6973 2069 7320 6120 6c69 6b65 2071  This is a like q
-00014a00: 7565 7279 2c20 616e 6420 6973 2063 6173  uery, and is cas
-00014a10: 652d 696e 7365 6e73 6974 6976 652e 0a20  e-insensitive.. 
-00014a20: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
-00014a30: 673a 204d 6174 6368 2066 6561 7475 7265  g: Match feature
-00014a40: 2d73 6574 7320 7769 7468 2073 7065 6369  -sets with speci
-00014a50: 6669 6320 7461 672e 0a20 2020 2020 2020  fic tag..       
-00014a60: 203a 7061 7261 6d20 7374 6174 653a 204d   :param state: M
-00014a70: 6174 6368 2066 6561 7475 7265 2d73 6574  atch feature-set
-00014a80: 7320 7769 7468 2061 2073 7065 6369 6669  s with a specifi
-00014a90: 6320 7374 6174 652e 0a20 2020 2020 2020  c state..       
-00014aa0: 203a 7061 7261 6d20 656e 7469 7469 6573   :param entities
-00014ab0: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
-00014ac0: 7365 7473 2077 6869 6368 2063 6f6e 7461  sets which conta
-00014ad0: 696e 2065 6e74 6974 6965 7320 7768 6f73  in entities whos
-00014ae0: 6520 6e61 6d65 2069 7320 696e 2074 6869  e name is in thi
-00014af0: 7320 6c69 7374 2e0a 2020 2020 2020 2020  s list..        
-00014b00: 3a70 6172 616d 2066 6561 7475 7265 733a  :param features:
-00014b10: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
-00014b20: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
-00014b30: 6e20 6665 6174 7572 6573 2077 686f 7365  n features whose
-00014b40: 206e 616d 6520 6973 2069 6e20 7468 6973   name is in this
-00014b50: 206c 6973 742e 0a20 2020 2020 2020 203a   list..        :
-00014b60: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
-00014b70: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
-00014b80: 2077 6869 6368 2068 6176 6520 7468 6573   which have thes
-00014b90: 6520 6c61 6265 6c73 2e0a 2020 2020 2020  e labels..      
-00014ba0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
-00014bb0: 6f6e 5f62 793a 2046 6965 6c64 2074 6f20  on_by: Field to 
-00014bc0: 6772 6f75 7020 7265 7375 6c74 7320 6279  group results by
-00014bd0: 2e20 4f6e 6c79 2061 6c6c 6f77 6564 2076  . Only allowed v
-00014be0: 616c 7565 2069 7320 606e 616d 6560 2e20  alue is `name`. 
-00014bf0: 5768 656e 2060 7061 7274 6974 696f 6e5f  When `partition_
-00014c00: 6279 6020 6973 2073 7065 6369 6669 6564  by` is specified
-00014c10: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
-00014c20: 6520 6070 6172 7469 7469 6f6e 5f73 6f72  e `partition_sor
-00014c30: 745f 6279 6020 7061 7261 6d65 7465 7220  t_by` parameter 
-00014c40: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-00014c50: 2061 7320 7765 6c6c 2e0a 2020 2020 2020   as well..      
-00014c60: 2020 3a70 6172 616d 2072 6f77 735f 7065    :param rows_pe
-00014c70: 725f 7061 7274 6974 696f 6e3a 2048 6f77  r_partition: How
-00014c80: 206d 616e 7920 746f 7020 726f 7773 2028   many top rows (
-00014c90: 7065 7220 736f 7274 696e 6720 6465 6669  per sorting defi
-00014ca0: 6e65 6420 6279 2060 7061 7274 6974 696f  ned by `partitio
-00014cb0: 6e5f 736f 7274 5f62 7960 2061 6e64 2060  n_sort_by` and `
-00014cc0: 7061 7274 6974 696f 6e5f 6f72 6465 7260  partition_order`
-00014cd0: 290a 2020 2020 2020 2020 2020 2020 746f  ).            to
-00014ce0: 2072 6574 7572 6e20 7065 7220 6772 6f75   return per grou
-00014cf0: 702e 2044 6566 6175 6c74 2076 616c 7565  p. Default value
-00014d00: 2069 7320 312e 0a20 2020 2020 2020 203a   is 1..        :
-00014d10: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
-00014d20: 736f 7274 5f62 793a 2057 6861 7420 6669  sort_by: What fi
-00014d30: 656c 6420 746f 2073 6f72 7420 7468 6520  eld to sort the 
-00014d40: 7265 7375 6c74 7320 6279 2c20 7769 7468  results by, with
-00014d50: 696e 2065 6163 6820 7061 7274 6974 696f  in each partitio
-00014d60: 6e20 6465 6669 6e65 6420 6279 2060 7061  n defined by `pa
-00014d70: 7274 6974 696f 6e5f 6279 602e 0a20 2020  rtition_by`..   
-00014d80: 2020 2020 2020 2020 2043 7572 7265 6e74           Current
-00014d90: 6c79 2074 6865 206f 6e6c 7920 616c 6c6f  ly the only allo
-00014da0: 7765 6420 7661 6c75 6520 6172 6520 6063  wed value are `c
-00014db0: 7265 6174 6564 6020 616e 6420 6075 7064  reated` and `upd
-00014dc0: 6174 6564 602e 0a20 2020 2020 2020 203a  ated`..        :
-00014dd0: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
-00014de0: 6f72 6465 723a 204f 7264 6572 206f 6620  order: Order of 
-00014df0: 736f 7274 696e 6720 7769 7468 696e 2070  sorting within p
-00014e00: 6172 7469 7469 6f6e 7320 2d20 6061 7363  artitions - `asc
-00014e10: 6020 6f72 2060 6465 7363 602e 2044 6566  ` or `desc`. Def
-00014e20: 6175 6c74 2069 7320 6064 6573 6360 2e0a  ault is `desc`..
-00014e30: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00014e40: 3a20 4c69 7374 206f 6620 6d61 7463 6869  : List of matchi
-00014e50: 6e67 203a 7079 3a63 6c61 7373 3a60 7e6d  ng :py:class:`~m
-00014e60: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-00014e70: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
-00014e80: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00014e90: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-00014ea0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-00014eb0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00014ec0: 5f70 726f 6a65 6374 0a0a 2020 2020 2020  _project..      
-00014ed0: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-00014ee0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00014ef0: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
-00014f00: 2020 2022 7374 6174 6522 3a20 7374 6174     "state": stat
-00014f10: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-00014f20: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
-00014f30: 2020 2020 2020 2022 656e 7469 7479 223a         "entity":
-00014f40: 2065 6e74 6974 6965 7320 6f72 205b 5d2c   entities or [],
-00014f50: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
-00014f60: 6174 7572 6522 3a20 6665 6174 7572 6573  ature": features
-00014f70: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
-00014f80: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
-00014f90: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
-00014fa0: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
-00014fb0: 7061 7274 6974 696f 6e5f 6279 3a0a 2020  partition_by:.  
-00014fc0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00014fd0: 2e75 7064 6174 6528 0a20 2020 2020 2020  .update(.       
-00014fe0: 2020 2020 2020 2020 2073 656c 662e 5f67           self._g
-00014ff0: 656e 6572 6174 655f 7061 7274 6974 696f  enerate_partitio
-00015000: 6e5f 6279 5f70 6172 616d 7328 0a20 2020  n_by_params(.   
-00015010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015020: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00015030: 6865 6d61 732e 4665 6174 7572 6553 746f  hemas.FeatureSto
-00015040: 7265 5061 7274 6974 696f 6e42 7946 6965  rePartitionByFie
-00015050: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
-00015060: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00015070: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
-00015080: 2020 2020 2020 2020 2020 726f 7773 5f70            rows_p
-00015090: 6572 5f70 6172 7469 7469 6f6e 2c0a 2020  er_partition,.  
-000150a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150b0: 2020 7061 7274 6974 696f 6e5f 736f 7274    partition_sort
-000150c0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-000150d0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-000150e0: 6f6e 5f6f 7264 6572 2c0a 2020 2020 2020  on_order,.      
-000150f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00015100: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00015110: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-00015120: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
-00015130: 6561 7475 7265 2d73 6574 7322 0a0a 2020  eature-sets"..  
-00015140: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00015150: 6167 6520 3d20 280a 2020 2020 2020 2020  age = (.        
-00015160: 2020 2020 6622 4661 696c 6564 206c 6973      f"Failed lis
-00015170: 7469 6e67 2066 6561 7475 7265 2d73 6574  ting feature-set
-00015180: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
-00015190: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
-000151a0: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
-000151b0: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
-000151c0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-000151d0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-000151e0: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
-000151f0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-00015200: 2020 6665 6174 7572 655f 7365 7473 203d    feature_sets =
-00015210: 2072 6573 702e 6a73 6f6e 2829 5b22 6665   resp.json()["fe
-00015220: 6174 7572 655f 7365 7473 225d 0a20 2020  ature_sets"].   
-00015230: 2020 2020 2069 6620 6665 6174 7572 655f       if feature_
-00015240: 7365 7473 3a0a 2020 2020 2020 2020 2020  sets:.          
-00015250: 2020 7265 7475 726e 205b 4665 6174 7572    return [Featur
-00015260: 6553 6574 2e66 726f 6d5f 6469 6374 286f  eSet.from_dict(o
-00015270: 626a 2920 666f 7220 6f62 6a20 696e 2066  bj) for obj in f
-00015280: 6561 7475 7265 5f73 6574 735d 0a0a 2020  eature_sets]..  
-00015290: 2020 6465 6620 7374 6f72 655f 6665 6174    def store_feat
-000152a0: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
-000152b0: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-000152c0: 6561 7475 7265 5f73 6574 3a20 556e 696f  eature_set: Unio
-000152d0: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
-000152e0: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
-000152f0: 7475 7265 5365 742c 2046 6561 7475 7265  tureSet, Feature
-00015300: 5365 745d 2c0a 2020 2020 2020 2020 6e61  Set],.        na
-00015310: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-00015320: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
-00015330: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
-00015340: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
-00015350: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-00015360: 6564 3d54 7275 652c 0a20 2020 2029 202d  ed=True,.    ) -
-00015370: 3e20 6469 6374 3a0a 2020 2020 2020 2020  > dict:.        
-00015380: 2222 2253 6176 6520 6120 3a70 793a 636c  """Save a :py:cl
-00015390: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-000153a0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-000153b0: 6553 6574 6020 6f62 6a65 6374 2069 6e20  eSet` object in 
-000153c0: 7468 6520 3a70 793a 6d6f 643a 606d 6c72  the :py:mod:`mlr
-000153d0: 756e 6020 4442 2e20 5468 650a 2020 2020  un` DB. The.    
-000153e0: 2020 2020 6665 6174 7572 652d 7365 7420      feature-set 
-000153f0: 6361 6e20 6265 2065 6974 6865 7220 6120  can be either a 
-00015400: 6e65 7720 6f62 6a65 6374 206f 7220 6120  new object or a 
-00015410: 6d6f 6469 6669 6361 7469 6f6e 2074 6f20  modification to 
-00015420: 6578 6973 7469 6e67 206f 626a 6563 7420  existing object 
-00015430: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
-00015440: 6520 7061 7261 6d73 206f 660a 2020 2020  e params of.    
-00015450: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
-00015460: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00015470: 6d20 6665 6174 7572 655f 7365 743a 2054  m feature_set: T
-00015480: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
-00015490: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-000154a0: 7265 2e46 6561 7475 7265 5365 7460 2074  re.FeatureSet` t
-000154b0: 6f20 7374 6f72 652e 0a20 2020 2020 2020  o store..       
-000154c0: 203a 7061 7261 6d20 6e61 6d65 3a20 2020   :param name:   
-000154d0: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
-000154e0: 2073 6574 2e0a 2020 2020 2020 2020 3a70   set..        :p
-000154f0: 6172 616d 2070 726f 6a65 6374 3a20 4e61  aram project: Na
-00015500: 6d65 206f 6620 7072 6f6a 6563 7420 7468  me of project th
-00015510: 6973 2066 6561 7475 7265 2d73 6574 2062  is feature-set b
-00015520: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
-00015530: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
-00015540: 6865 2060 6074 6167 6060 206f 6620 7468  he ``tag`` of th
-00015550: 6520 6f62 6a65 6374 2074 6f20 7265 706c  e object to repl
-00015560: 6163 6520 696e 2074 6865 2044 422c 2066  ace in the DB, f
-00015570: 6f72 2065 7861 6d70 6c65 2060 606c 6174  or example ``lat
-00015580: 6573 7460 602e 0a20 2020 2020 2020 203a  est``..        :
-00015590: 7061 7261 6d20 7569 643a 2054 6865 2060  param uid: The `
-000155a0: 6075 6964 6060 206f 6620 7468 6520 6f62  `uid`` of the ob
-000155b0: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
-000155c0: 696e 2074 6865 2044 422e 2049 6620 7573  in the DB. If us
-000155d0: 696e 6720 7468 6973 2070 6172 616d 6574  ing this paramet
-000155e0: 6572 2c20 7468 6520 6d6f 6469 6669 6564  er, the modified
-000155f0: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
-00015600: 2020 2020 6d75 7374 2068 6176 6520 7468      must have th
-00015610: 6520 7361 6d65 2060 6075 6964 6060 206f  e same ``uid`` o
-00015620: 6620 7468 6520 7072 6576 696f 7573 6c79  f the previously
-00015630: 2d65 7869 7374 696e 6720 6f62 6a65 6374  -existing object
-00015640: 2e20 5468 6973 2063 616e 6e6f 7420 6265  . This cannot be
-00015650: 2075 7365 6420 666f 7220 6e6f 6e2d 7665   used for non-ve
-00015660: 7273 696f 6e65 6420 6f62 6a65 6374 732e  rsioned objects.
-00015670: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015680: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
-00015690: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
-000156a0: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
-000156b0: 2066 6561 7475 7265 2d73 6574 2e20 416c   feature-set. Al
-000156c0: 6c20 7665 7273 696f 6e73 206f 6620 6120  l versions of a 
-000156d0: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
-000156e0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-000156f0: 6c20 6265 206b 6570 7420 696e 2074 6865  l be kept in the
-00015700: 2044 4220 616e 6420 6361 6e20 6265 2072   DB and can be r
-00015710: 6574 7269 6576 6564 2075 6e74 696c 2065  etrieved until e
-00015720: 7870 6c69 6369 746c 7920 6465 6c65 7465  xplicitly delete
-00015730: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
-00015740: 726e 733a 2054 6865 203a 7079 3a63 6c61  rns: The :py:cla
-00015750: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00015760: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00015770: 5365 7460 206f 626a 6563 7420 2861 7320  Set` object (as 
-00015780: 6469 6374 292e 0a20 2020 2020 2020 2022  dict)..        "
-00015790: 2222 0a0a 2020 2020 2020 2020 7265 6665  ""..        refe
-000157a0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
-000157b0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-000157c0: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
-000157d0: 2020 7061 7261 6d73 203d 207b 2276 6572    params = {"ver
-000157e0: 7369 6f6e 6564 223a 2076 6572 7369 6f6e  sioned": version
-000157f0: 6564 7d0a 0a20 2020 2020 2020 2069 6620  ed}..        if 
-00015800: 6973 696e 7374 616e 6365 2866 6561 7475  isinstance(featu
-00015810: 7265 5f73 6574 2c20 6d6c 7275 6e2e 636f  re_set, mlrun.co
-00015820: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
-00015830: 7475 7265 5365 7429 3a0a 2020 2020 2020  tureSet):.      
-00015840: 2020 2020 2020 6665 6174 7572 655f 7365        feature_se
-00015850: 7420 3d20 6665 6174 7572 655f 7365 742e  t = feature_set.
-00015860: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00015870: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
-00015880: 6561 7475 7265 5f73 6574 2c20 4665 6174  eature_set, Feat
-00015890: 7572 6553 6574 293a 0a20 2020 2020 2020  ureSet):.       
-000158a0: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
-000158b0: 203d 2066 6561 7475 7265 5f73 6574 2e74   = feature_set.t
-000158c0: 6f5f 6469 6374 2829 0a0a 2020 2020 2020  o_dict()..      
-000158d0: 2020 6e61 6d65 203d 206e 616d 6520 6f72    name = name or
-000158e0: 2066 6561 7475 7265 5f73 6574 5b22 6d65   feature_set["me
-000158f0: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
-00015900: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00015910: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00015920: 2070 726f 6a65 6374 206f 7220 6665 6174   project or feat
-00015930: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
-00015940: 6122 5d2e 6765 7428 2270 726f 6a65 6374  a"].get("project
-00015950: 2229 206f 7220 636f 6e66 6967 2e64 6566  ") or config.def
-00015960: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00015970: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
-00015980: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00015990: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
-000159a0: 7265 2d73 6574 732f 7b6e 616d 657d 2f72  re-sets/{name}/r
-000159b0: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
-000159c0: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
-000159d0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-000159e0: 2246 6169 6c65 6420 7374 6f72 696e 6720  "Failed storing 
-000159f0: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
-00015a00: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
-00015a10: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
-00015a20: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00015a30: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
-00015a40: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00015a50: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
-00015a60: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
-00015a70: 6a73 6f6e 2866 6561 7475 7265 5f73 6574  json(feature_set
-00015a80: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00015a90: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-00015aa0: 6a73 6f6e 2829 0a0a 2020 2020 6465 6620  json()..    def 
-00015ab0: 7061 7463 685f 6665 6174 7572 655f 7365  patch_feature_se
-00015ac0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00015ad0: 0a20 2020 2020 2020 206e 616d 652c 0a20  .        name,. 
-00015ae0: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-00015af0: 6574 5f75 7064 6174 653a 2064 6963 742c  et_update: dict,
-00015b00: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00015b10: 3d22 222c 0a20 2020 2020 2020 2074 6167  ="",.        tag
-00015b20: 3d4e 6f6e 652c 0a20 2020 2020 2020 2075  =None,.        u
-00015b30: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
-00015b40: 2070 6174 6368 5f6d 6f64 653a 2055 6e69   patch_mode: Uni
-00015b50: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-00015b60: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
-00015b70: 6e2e 7363 6865 6d61 732e 5061 7463 684d  n.schemas.PatchM
-00015b80: 6f64 650a 2020 2020 2020 2020 5d20 3d20  ode.        ] = 
-00015b90: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00015ba0: 656d 6173 2e50 6174 6368 4d6f 6465 2e72  emas.PatchMode.r
-00015bb0: 6570 6c61 6365 2c0a 2020 2020 293a 0a20  eplace,.    ):. 
-00015bc0: 2020 2020 2020 2022 2222 4d6f 6469 6679         """Modify
-00015bd0: 2028 7061 7463 6829 2061 6e20 6578 6973   (patch) an exis
-00015be0: 7469 6e67 203a 7079 3a63 6c61 7373 3a60  ting :py:class:`
-00015bf0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00015c00: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
-00015c10: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00015c20: 2054 6865 206f 626a 6563 7420 6973 2069   The object is i
-00015c30: 6465 6e74 6966 6965 6420 6279 2069 7473  dentified by its
-00015c40: 206e 616d 6520 2861 6e64 2070 726f 6a65   name (and proje
-00015c50: 6374 2069 7420 6265 6c6f 6e67 7320 746f  ct it belongs to
-00015c60: 292c 2061 7320 7765 6c6c 2061 7320 6f70  ), as well as op
-00015c70: 7469 6f6e 616c 6c79 2061 2060 6074 6167  tionally a ``tag
-00015c80: 6060 206f 7220 6974 730a 2020 2020 2020  `` or its.      
-00015c90: 2020 6060 7569 6460 6020 2866 6f72 2076    ``uid`` (for v
-00015ca0: 6572 7369 6f6e 6564 206f 626a 6563 7429  ersioned object)
-00015cb0: 2e20 4966 2062 6f74 6820 6060 7461 6760  . If both ``tag`
-00015cc0: 6020 616e 6420 6060 7569 6460 6020 6172  ` and ``uid`` ar
-00015cd0: 6520 6f6d 6974 7465 6420 7468 656e 2074  e omitted then t
-00015ce0: 6865 206f 626a 6563 7420 7769 7468 2074  he object with t
-00015cf0: 6167 2060 606c 6174 6573 7460 600a 2020  ag ``latest``.  
-00015d00: 2020 2020 2020 6973 206d 6f64 6966 6965        is modifie
-00015d10: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
-00015d20: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
-00015d30: 2074 6865 206f 626a 6563 7420 746f 2070   the object to p
-00015d40: 6174 6368 2e0a 2020 2020 2020 2020 3a70  atch..        :p
-00015d50: 6172 616d 2066 6561 7475 7265 5f73 6574  aram feature_set
-00015d60: 5f75 7064 6174 653a 2054 6865 206d 6f64  _update: The mod
-00015d70: 6966 6963 6174 696f 6e73 206e 6565 6465  ifications neede
-00015d80: 6420 696e 2074 6865 206f 626a 6563 742e  d in the object.
-00015d90: 2054 6869 7320 7061 7261 6d65 7465 7220   This parameter 
-00015da0: 6f6e 6c79 2068 6173 2074 6865 2063 6861  only has the cha
-00015db0: 6e67 6573 2069 6e20 6974 2c0a 2020 2020  nges in it,.    
-00015dc0: 2020 2020 2020 2020 6e6f 7420 6120 6675          not a fu
-00015dd0: 6c6c 206f 626a 6563 742e 0a20 2020 2020  ll object..     
-00015de0: 2020 2020 2020 2045 7861 6d70 6c65 3a3a         Example::
-00015df0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015e00: 2020 6665 6174 7572 655f 7365 745f 7570    feature_set_up
-00015e10: 6461 7465 203d 207b 2273 7461 7475 7322  date = {"status"
-00015e20: 3a20 7b22 7072 6f63 6573 7365 6422 203a  : {"processed" :
-00015e30: 2054 7275 657d 7d0a 0a20 2020 2020 2020   True}}..       
-00015e40: 2020 2020 2057 696c 6c20 6170 706c 7920       Will apply 
-00015e50: 7468 6520 6669 656c 6420 6060 7374 6174  the field ``stat
-00015e60: 7573 2e70 726f 6365 7373 6564 6060 2074  us.processed`` t
-00015e70: 6f20 7468 6520 6578 6973 7469 6e67 206f  o the existing o
-00015e80: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
-00015e90: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-00015ea0: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
-00015eb0: 7461 696e 7320 7468 6520 6d6f 6469 6669  tains the modifi
-00015ec0: 6564 206f 626a 6563 742e 0a20 2020 2020  ed object..     
-00015ed0: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
-00015ee0: 6865 2074 6167 206f 6620 7468 6520 6f62  he tag of the ob
-00015ef0: 6a65 6374 2074 6f20 6d6f 6469 6679 2e0a  ject to modify..
-00015f00: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-00015f10: 6964 3a20 7569 6420 6f66 2074 6865 206f  id: uid of the o
-00015f20: 626a 6563 7420 746f 206d 6f64 6966 792e  bject to modify.
-00015f30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015f40: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
-00015f50: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
-00015f60: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
-00015f70: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
-00015f80: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
-00015f90: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
-00015fa0: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
-00015fb0: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
-00015fc0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00015fd0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00015fe0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00015ff0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00016000: 740a 2020 2020 2020 2020 7265 6665 7265  t.        refere
-00016010: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
-00016020: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
-00016030: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
-00016040: 6865 6164 6572 7320 3d20 7b6d 6c72 756e  headers = {mlrun
-00016050: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00016060: 4865 6164 6572 4e61 6d65 732e 7061 7463  HeaderNames.patc
-00016070: 685f 6d6f 6465 3a20 7061 7463 685f 6d6f  h_mode: patch_mo
-00016080: 6465 7d0a 2020 2020 2020 2020 7061 7468  de}.        path
-00016090: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-000160a0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
-000160b0: 7365 7473 2f7b 6e61 6d65 7d2f 7265 6665  sets/{name}/refe
-000160c0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
-000160d0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
-000160e0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-000160f0: 696c 6564 2075 7064 6174 696e 6720 6665  iled updating fe
-00016100: 6174 7572 652d 7365 7420 7b70 726f 6a65  ature-set {proje
-00016110: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-00016120: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-00016130: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-00016140: 5041 5443 4822 2c0a 2020 2020 2020 2020  PATCH",.        
-00016150: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-00016160: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00016170: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-00016180: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-00016190: 6f6e 2866 6561 7475 7265 5f73 6574 5f75  on(feature_set_u
-000161a0: 7064 6174 6529 2c0a 2020 2020 2020 2020  pdate),.        
-000161b0: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
-000161c0: 6572 732c 0a20 2020 2020 2020 2029 0a0a  ers,.        )..
-000161d0: 2020 2020 6465 6620 6465 6c65 7465 5f66      def delete_f
-000161e0: 6561 7475 7265 5f73 6574 2873 656c 662c  eature_set(self,
-000161f0: 206e 616d 652c 2070 726f 6a65 6374 3d22   name, project="
-00016200: 222c 2074 6167 3d4e 6f6e 652c 2075 6964  ", tag=None, uid
-00016210: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00016220: 2222 2244 656c 6574 6520 6120 3a70 793a  """Delete a :py:
-00016230: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
-00016240: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
-00016250: 7572 6553 6574 6020 6f62 6a65 6374 2066  ureSet` object f
-00016260: 726f 6d20 7468 6520 4442 2e0a 2020 2020  rom the DB..    
-00016270: 2020 2020 4966 2060 6074 6167 6060 206f      If ``tag`` o
-00016280: 7220 6060 7569 6460 6020 6172 6520 7370  r ``uid`` are sp
-00016290: 6563 6966 6965 642c 2074 6865 6e20 6a75  ecified, then ju
-000162a0: 7374 2074 6865 2076 6572 7369 6f6e 2072  st the version r
-000162b0: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
-000162c0: 6d20 7769 6c6c 2062 6520 6465 6c65 7465  m will be delete
-000162d0: 642e 2055 7369 6e67 2062 6f74 680a 2020  d. Using both.  
-000162e0: 2020 2020 2020 6973 206e 6f74 2061 6c6c        is not all
-000162f0: 6f77 6564 2e0a 2020 2020 2020 2020 4966  owed..        If
-00016300: 206e 6f6e 6520 6172 6520 7370 6563 6966   none are specif
-00016310: 6965 642c 2074 6865 6e20 616c 6c20 696e  ied, then all in
-00016320: 7374 616e 6365 7320 6f66 2074 6865 206f  stances of the o
-00016330: 626a 6563 7420 7768 6f73 6520 6e61 6d65  bject whose name
-00016340: 2069 7320 6060 6e61 6d65 6060 2077 696c   is ``name`` wil
-00016350: 6c20 6265 2064 656c 6574 6564 2e0a 2020  l be deleted..  
-00016360: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016370: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00016380: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00016390: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-000163a0: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-000163b0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-000163c0: 7d2f 6665 6174 7572 652d 7365 7473 2f7b  }/feature-sets/{
-000163d0: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
-000163e0: 6966 2074 6167 206f 7220 7569 643a 0a20  if tag or uid:. 
-000163f0: 2020 2020 2020 2020 2020 2072 6566 6572             refer
-00016400: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
-00016410: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
-00016420: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
-00016430: 2020 2020 2070 6174 6820 3d20 7061 7468       path = path
-00016440: 202b 2066 222f 7265 6665 7265 6e63 6573   + f"/references
-00016450: 2f7b 7265 6665 7265 6e63 657d 220a 0a20  /{reference}".. 
-00016460: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00016470: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00016480: 6465 6c65 7469 6e67 2066 6561 7475 7265  deleting feature
-00016490: 2d73 6574 207b 6e61 6d65 7d22 0a20 2020  -set {name}".   
-000164a0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-000164b0: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
-000164c0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
-000164d0: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
-000164e0: 655f 6665 6174 7572 655f 7665 6374 6f72  e_feature_vector
-000164f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00016500: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00016510: 7665 6374 6f72 3a20 556e 696f 6e5b 6469  vector: Union[di
-00016520: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
-00016530: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
-00016540: 5665 6374 6f72 2c20 4665 6174 7572 6556  Vector, FeatureV
-00016550: 6563 746f 725d 2c0a 2020 2020 2020 2020  ector],.        
-00016560: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
-00016570: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
-00016580: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
-00016590: 743a 0a20 2020 2020 2020 2022 2222 4372  t:.        """Cr
-000165a0: 6561 7465 2061 206e 6577 203a 7079 3a63  eate a new :py:c
-000165b0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
-000165c0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
-000165d0: 7265 5665 6374 6f72 6020 616e 6420 7361  reVector` and sa
-000165e0: 7665 2069 6e20 7468 6520 3a70 793a 6d6f  ve in the :py:mo
-000165f0: 643a 606d 6c72 756e 6020 4442 2e0a 0a20  d:`mlrun` DB... 
-00016600: 2020 2020 2020 203a 7061 7261 6d20 6665         :param fe
-00016610: 6174 7572 655f 7665 6374 6f72 3a20 5468  ature_vector: Th
-00016620: 6520 6e65 7720 3a70 793a 636c 6173 733a  e new :py:class:
-00016630: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-00016640: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-00016650: 746f 7260 2074 6f20 6372 6561 7465 2e0a  tor` to create..
-00016660: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00016670: 726f 6a65 6374 3a20 4e61 6d65 206f 6620  roject: Name of 
-00016680: 7072 6f6a 6563 7420 7468 6973 2066 6561  project this fea
-00016690: 7475 7265 2d76 6563 746f 7220 6265 6c6f  ture-vector belo
-000166a0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
-000166b0: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
-000166c0: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
-000166d0: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
-000166e0: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
-000166f0: 7665 6374 6f72 2e20 416c 6c20 7665 7273  vector. All vers
-00016700: 696f 6e73 206f 6620 6120 7665 7273 696f  ions of a versio
-00016710: 6e65 6420 6f62 6a65 6374 0a20 2020 2020  ned object.     
-00016720: 2020 2020 2020 2077 696c 6c20 6265 206b         will be k
-00016730: 6570 7420 696e 2074 6865 2044 4220 616e  ept in the DB an
-00016740: 6420 6361 6e20 6265 2072 6574 7269 6576  d can be retriev
-00016750: 6564 2075 6e74 696c 2065 7870 6c69 6369  ed until explici
-00016760: 746c 7920 6465 6c65 7465 642e 0a20 2020  tly deleted..   
-00016770: 2020 2020 203a 7265 7475 726e 733a 2054       :returns: T
-00016780: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
-00016790: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-000167a0: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
-000167b0: 6020 6f62 6a65 6374 2028 6173 2064 6963  ` object (as dic
-000167c0: 7429 2e0a 2020 2020 2020 2020 2222 220a  t)..        """.
-000167d0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000167e0: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
-000167f0: 6374 6f72 2c20 6d6c 7275 6e2e 636f 6d6d  ctor, mlrun.comm
-00016800: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-00016810: 7265 5665 6374 6f72 293a 0a20 2020 2020  reVector):.     
-00016820: 2020 2020 2020 2066 6561 7475 7265 5f76         feature_v
-00016830: 6563 746f 7220 3d20 6665 6174 7572 655f  ector = feature_
-00016840: 7665 6374 6f72 2e64 6963 7428 290a 2020  vector.dict().  
-00016850: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00016860: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
-00016870: 6374 6f72 2c20 4665 6174 7572 6556 6563  ctor, FeatureVec
-00016880: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
-00016890: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
-000168a0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
-000168b0: 722e 746f 5f64 6963 7428 290a 0a20 2020  r.to_dict()..   
-000168c0: 2020 2020 2070 726f 6a65 6374 203d 2028       project = (
-000168d0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-000168e0: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
-000168f0: 206f 7220 6665 6174 7572 655f 7665 6374   or feature_vect
-00016900: 6f72 5b22 6d65 7461 6461 7461 225d 2e67  or["metadata"].g
-00016910: 6574 2822 7072 6f6a 6563 7422 2c20 4e6f  et("project", No
-00016920: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-00016930: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00016940: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-00016950: 2020 290a 2020 2020 2020 2020 7061 7468    ).        path
-00016960: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-00016970: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
-00016980: 7665 6374 6f72 7322 0a20 2020 2020 2020  vectors".       
-00016990: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
-000169a0: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
-000169b0: 647d 0a0a 2020 2020 2020 2020 6e61 6d65  d}..        name
-000169c0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
-000169d0: 725b 226d 6574 6164 6174 6122 5d5b 226e  r["metadata"]["n
-000169e0: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
-000169f0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00016a00: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
-00016a10: 6665 6174 7572 652d 7665 6374 6f72 207b  feature-vector {
-00016a20: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-00016a30: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-00016a40: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-00016a50: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
-00016a60: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00016a70: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00016a80: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00016a90: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00016aa0: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-00016ab0: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-00016ac0: 5f74 6f5f 6a73 6f6e 2866 6561 7475 7265  _to_json(feature
-00016ad0: 5f76 6563 746f 7229 2c0a 2020 2020 2020  _vector),.      
-00016ae0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00016af0: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-00016b00: 2020 2020 6465 6620 6765 745f 6665 6174      def get_feat
-00016b10: 7572 655f 7665 6374 6f72 280a 2020 2020  ure_vector(.    
-00016b20: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
-00016b30: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
-00016b40: 7220 3d20 2222 2c20 7461 673a 2073 7472  r = "", tag: str
-00016b50: 203d 204e 6f6e 652c 2075 6964 3a20 7374   = None, uid: st
-00016b60: 7220 3d20 4e6f 6e65 0a20 2020 2029 202d  r = None.    ) -
-00016b70: 3e20 4665 6174 7572 6556 6563 746f 723a  > FeatureVector:
-00016b80: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00016b90: 726e 2061 2073 7065 6369 6669 6320 6665  rn a specific fe
-00016ba0: 6174 7572 652d 7665 6374 6f72 2072 6566  ature-vector ref
-00016bb0: 6572 656e 6365 6420 6279 2069 7473 2074  erenced by its t
-00016bc0: 6167 206f 7220 7569 642e 2049 6620 6e6f  ag or uid. If no
-00016bd0: 6e65 2061 7265 2070 726f 7669 6465 642c  ne are provided,
-00016be0: 2060 606c 6174 6573 7460 6020 7461 6720   ``latest`` tag 
-00016bf0: 7769 6c6c 0a20 2020 2020 2020 2062 6520  will.        be 
-00016c00: 7573 6564 2e22 2222 0a0a 2020 2020 2020  used."""..      
-00016c10: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00016c20: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00016c30: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00016c40: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
-00016c50: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
-00016c60: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
-00016c70: 6964 290a 2020 2020 2020 2020 7061 7468  id).        path
-00016c80: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-00016c90: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
-00016ca0: 7665 6374 6f72 732f 7b6e 616d 657d 2f72  vectors/{name}/r
-00016cb0: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
-00016cc0: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
-00016cd0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-00016ce0: 2246 6169 6c65 6420 7265 7472 6965 7669  "Failed retrievi
-00016cf0: 6e67 2066 6561 7475 7265 2d76 6563 746f  ng feature-vecto
-00016d00: 7220 7b70 726f 6a65 6374 7d2f 7b6e 616d  r {project}/{nam
-00016d10: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-00016d20: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00016d30: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00016d40: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
-00016d50: 2020 2020 2072 6574 7572 6e20 4665 6174       return Feat
-00016d60: 7572 6556 6563 746f 722e 6672 6f6d 5f64  ureVector.from_d
-00016d70: 6963 7428 7265 7370 2e6a 736f 6e28 2929  ict(resp.json())
-00016d80: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
-00016d90: 6561 7475 7265 5f76 6563 746f 7273 280a  eature_vectors(.
-00016da0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00016db0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-00016dc0: 7472 203d 2022 222c 0a20 2020 2020 2020  tr = "",.       
-00016dd0: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
-00016de0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
-00016df0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-00016e00: 2020 2020 7374 6174 653a 2073 7472 203d      state: str =
-00016e10: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-00016e20: 6162 656c 733a 206c 6973 745b 7374 725d  abels: list[str]
-00016e30: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00016e40: 2070 6172 7469 7469 6f6e 5f62 793a 2055   partition_by: U
-00016e50: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-00016e60: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
-00016e70: 6368 656d 6173 2e46 6561 7475 7265 5374  chemas.FeatureSt
-00016e80: 6f72 6550 6172 7469 7469 6f6e 4279 4669  orePartitionByFi
-00016e90: 656c 642c 2073 7472 0a20 2020 2020 2020  eld, str.       
-00016ea0: 205d 203d 204e 6f6e 652c 0a20 2020 2020   ] = None,.     
-00016eb0: 2020 2072 6f77 735f 7065 725f 7061 7274     rows_per_part
-00016ec0: 6974 696f 6e3a 2069 6e74 203d 2031 2c0a  ition: int = 1,.
-00016ed0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00016ee0: 6e5f 736f 7274 5f62 793a 2055 6e69 6f6e  n_sort_by: Union
-00016ef0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
-00016f00: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
-00016f10: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
-00016f20: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00016f30: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
-00016f40: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-00016f50: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00016f60: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
-00016f70: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-00016f80: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00016f90: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
-00016fa0: 2020 2029 202d 3e20 6c69 7374 5b46 6561     ) -> list[Fea
-00016fb0: 7475 7265 5665 6374 6f72 5d3a 0a20 2020  tureVector]:.   
-00016fc0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00016fd0: 2061 206c 6973 7420 6f66 2066 6561 7475   a list of featu
-00016fe0: 7265 2d76 6563 746f 7273 206d 6174 6368  re-vectors match
-00016ff0: 696e 6720 7468 6520 6372 6974 6572 6961  ing the criteria
-00017000: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
-00017010: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00017020: 6374 3a20 5072 6f6a 6563 7420 6e61 6d65  ct: Project name
-00017030: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00017040: 206e 616d 653a 204e 616d 6520 6f66 2066   name: Name of f
-00017050: 6561 7475 7265 2d76 6563 746f 7220 746f  eature-vector to
-00017060: 206d 6174 6368 2e20 5468 6973 2069 7320   match. This is 
-00017070: 6120 6c69 6b65 2071 7565 7279 2c20 616e  a like query, an
-00017080: 6420 6973 2063 6173 652d 696e 7365 6e73  d is case-insens
-00017090: 6974 6976 652e 0a20 2020 2020 2020 203a  itive..        :
-000170a0: 7061 7261 6d20 7461 673a 204d 6174 6368  param tag: Match
-000170b0: 2066 6561 7475 7265 2d76 6563 746f 7273   feature-vectors
-000170c0: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
-000170d0: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
-000170e0: 616d 2073 7461 7465 3a20 4d61 7463 6820  am state: Match 
-000170f0: 6665 6174 7572 652d 7665 6374 6f72 7320  feature-vectors 
-00017100: 7769 7468 2061 2073 7065 6369 6669 6320  with a specific 
-00017110: 7374 6174 652e 0a20 2020 2020 2020 203a  state..        :
-00017120: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
-00017130: 7463 6820 6665 6174 7572 652d 7665 6374  tch feature-vect
-00017140: 6f72 7320 7768 6963 6820 6861 7665 2074  ors which have t
-00017150: 6865 7365 206c 6162 656c 732e 0a20 2020  hese labels..   
-00017160: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
-00017170: 6974 696f 6e5f 6279 3a20 4669 656c 6420  ition_by: Field 
-00017180: 746f 2067 726f 7570 2072 6573 756c 7473  to group results
-00017190: 2062 792e 204f 6e6c 7920 616c 6c6f 7765   by. Only allowe
-000171a0: 6420 7661 6c75 6520 6973 2060 6e61 6d65  d value is `name
-000171b0: 602e 2057 6865 6e20 6070 6172 7469 7469  `. When `partiti
-000171c0: 6f6e 5f62 7960 2069 7320 7370 6563 6966  on_by` is specif
-000171d0: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
-000171e0: 2074 6865 2060 7061 7274 6974 696f 6e5f   the `partition_
-000171f0: 736f 7274 5f62 7960 2070 6172 616d 6574  sort_by` paramet
-00017200: 6572 206d 7573 7420 6265 2070 726f 7669  er must be provi
-00017210: 6465 6420 6173 2077 656c 6c2e 0a20 2020  ded as well..   
-00017220: 2020 2020 203a 7061 7261 6d20 726f 7773       :param rows
-00017230: 5f70 6572 5f70 6172 7469 7469 6f6e 3a20  _per_partition: 
-00017240: 486f 7720 6d61 6e79 2074 6f70 2072 6f77  How many top row
-00017250: 7320 2870 6572 2073 6f72 7469 6e67 2064  s (per sorting d
-00017260: 6566 696e 6564 2062 7920 6070 6172 7469  efined by `parti
-00017270: 7469 6f6e 5f73 6f72 745f 6279 6020 616e  tion_sort_by` an
-00017280: 6420 6070 6172 7469 7469 6f6e 5f6f 7264  d `partition_ord
-00017290: 6572 6029 0a20 2020 2020 2020 2020 2020  er`).           
-000172a0: 2074 6f20 7265 7475 726e 2070 6572 2067   to return per g
-000172b0: 726f 7570 2e20 4465 6661 756c 7420 7661  roup. Default va
-000172c0: 6c75 6520 6973 2031 2e0a 2020 2020 2020  lue is 1..      
-000172d0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
-000172e0: 6f6e 5f73 6f72 745f 6279 3a20 5768 6174  on_sort_by: What
-000172f0: 2066 6965 6c64 2074 6f20 736f 7274 2074   field to sort t
-00017300: 6865 2072 6573 756c 7473 2062 792c 2077  he results by, w
-00017310: 6974 6869 6e20 6561 6368 2070 6172 7469  ithin each parti
-00017320: 7469 6f6e 2064 6566 696e 6564 2062 7920  tion defined by 
-00017330: 6070 6172 7469 7469 6f6e 5f62 7960 2e0a  `partition_by`..
-00017340: 2020 2020 2020 2020 2020 2020 4375 7272              Curr
-00017350: 656e 746c 7920 7468 6520 6f6e 6c79 2061  ently the only a
-00017360: 6c6c 6f77 6564 2076 616c 7565 7320 6172  llowed values ar
-00017370: 6520 6063 7265 6174 6564 6020 616e 6420  e `created` and 
-00017380: 6075 7064 6174 6564 602e 0a20 2020 2020  `updated`..     
-00017390: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
-000173a0: 696f 6e5f 6f72 6465 723a 204f 7264 6572  ion_order: Order
-000173b0: 206f 6620 736f 7274 696e 6720 7769 7468   of sorting with
-000173c0: 696e 2070 6172 7469 7469 6f6e 7320 2d20  in partitions - 
-000173d0: 6061 7363 6020 6f72 2060 6465 7363 602e  `asc` or `desc`.
-000173e0: 2044 6566 6175 6c74 2069 7320 6064 6573   Default is `des
-000173f0: 6360 2e0a 2020 2020 2020 2020 3a72 6574  c`..        :ret
-00017400: 7572 6e73 3a20 4c69 7374 206f 6620 6d61  urns: List of ma
-00017410: 7463 6869 6e67 203a 7079 3a63 6c61 7373  tching :py:class
-00017420: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00017430: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
-00017440: 6374 6f72 6020 6f62 6a65 6374 732e 0a20  ctor` objects.. 
-00017450: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00017460: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00017470: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00017480: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00017490: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-000174a0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-000174b0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
-000174c0: 2020 2020 2020 2020 2020 2273 7461 7465            "state
-000174d0: 223a 2073 7461 7465 2c0a 2020 2020 2020  ": state,.      
-000174e0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
-000174f0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-00017500: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
-00017510: 205b 5d2c 0a20 2020 2020 2020 207d 0a20   [],.        }. 
-00017520: 2020 2020 2020 2069 6620 7061 7274 6974         if partit
-00017530: 696f 6e5f 6279 3a0a 2020 2020 2020 2020  ion_by:.        
-00017540: 2020 2020 7061 7261 6d73 2e75 7064 6174      params.updat
-00017550: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00017560: 2020 2073 656c 662e 5f67 656e 6572 6174     self._generat
-00017570: 655f 7061 7274 6974 696f 6e5f 6279 5f70  e_partition_by_p
-00017580: 6172 616d 7328 0a20 2020 2020 2020 2020  arams(.         
-00017590: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-000175a0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000175b0: 4665 6174 7572 6553 746f 7265 5061 7274  FeatureStorePart
-000175c0: 6974 696f 6e42 7946 6965 6c64 2c0a 2020  itionByField,.  
-000175d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175e0: 2020 7061 7274 6974 696f 6e5f 6279 2c0a    partition_by,.
-000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017600: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
-00017610: 7469 7469 6f6e 2c0a 2020 2020 2020 2020  tition,.        
-00017620: 2020 2020 2020 2020 2020 2020 7061 7274              part
-00017630: 6974 696f 6e5f 736f 7274 5f62 792c 0a20  ition_sort_by,. 
-00017640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017650: 2020 2070 6172 7469 7469 6f6e 5f6f 7264     partition_ord
-00017660: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00017670: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00017680: 2020 290a 0a20 2020 2020 2020 2070 6174    )..        pat
-00017690: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-000176a0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
-000176b0: 2d76 6563 746f 7273 220a 0a20 2020 2020  -vectors"..     
-000176c0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-000176d0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000176e0: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
-000176f0: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
-00017700: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
-00017710: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
-00017720: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
-00017730: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
-00017740: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-00017750: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-00017760: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
-00017770: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-00017780: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
-00017790: 7320 3d20 7265 7370 2e6a 736f 6e28 295b  s = resp.json()[
-000177a0: 2266 6561 7475 7265 5f76 6563 746f 7273  "feature_vectors
-000177b0: 225d 0a20 2020 2020 2020 2069 6620 6665  "].        if fe
-000177c0: 6174 7572 655f 7665 6374 6f72 733a 0a20  ature_vectors:. 
-000177d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000177e0: 6e20 5b46 6561 7475 7265 5665 6374 6f72  n [FeatureVector
-000177f0: 2e66 726f 6d5f 6469 6374 286f 626a 2920  .from_dict(obj) 
-00017800: 666f 7220 6f62 6a20 696e 2066 6561 7475  for obj in featu
-00017810: 7265 5f76 6563 746f 7273 5d0a 0a20 2020  re_vectors]..   
-00017820: 2064 6566 2073 746f 7265 5f66 6561 7475   def store_featu
-00017830: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
-00017840: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00017850: 2066 6561 7475 7265 5f76 6563 746f 723a   feature_vector:
-00017860: 2055 6e69 6f6e 5b64 6963 742c 206d 6c72   Union[dict, mlr
-00017870: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00017880: 732e 4665 6174 7572 6556 6563 746f 722c  s.FeatureVector,
-00017890: 2046 6561 7475 7265 5665 6374 6f72 5d2c   FeatureVector],
-000178a0: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
-000178b0: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
-000178c0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
-000178d0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
-000178e0: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
-000178f0: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
-00017900: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
-00017910: 743a 0a20 2020 2020 2020 2022 2222 5374  t:.        """St
-00017920: 6f72 6520 6120 3a70 793a 636c 6173 733a  ore a :py:class:
-00017930: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-00017940: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-00017950: 746f 7260 206f 626a 6563 7420 696e 2074  tor` object in t
-00017960: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
-00017970: 6e60 2044 422e 2054 6865 0a20 2020 2020  n` DB. The.     
-00017980: 2020 2066 6561 7475 7265 2d76 6563 746f     feature-vecto
-00017990: 7220 6361 6e20 6265 2065 6974 6865 7220  r can be either 
-000179a0: 6120 6e65 7720 6f62 6a65 6374 206f 7220  a new object or 
-000179b0: 6120 6d6f 6469 6669 6361 7469 6f6e 2074  a modification t
-000179c0: 6f20 6578 6973 7469 6e67 206f 626a 6563  o existing objec
-000179d0: 7420 7265 6665 7265 6e63 6564 2062 7920  t referenced by 
-000179e0: 7468 6520 7061 7261 6d73 0a20 2020 2020  the params.     
-000179f0: 2020 206f 6620 7468 6520 6675 6e63 7469     of the functi
-00017a00: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-00017a10: 7261 6d20 6665 6174 7572 655f 7665 6374  ram feature_vect
-00017a20: 6f72 3a20 5468 6520 3a70 793a 636c 6173  or: The :py:clas
-00017a30: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00017a40: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
-00017a50: 6563 746f 7260 2074 6f20 7374 6f72 652e  ector` to store.
-00017a60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00017a70: 6e61 6d65 3a20 2020 204e 616d 6520 6f66  name:    Name of
-00017a80: 2066 6561 7475 7265 2076 6563 746f 722e   feature vector.
-00017a90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00017aa0: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
-00017ab0: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
-00017ac0: 6174 7572 652d 7665 6374 6f72 2062 656c  ature-vector bel
-00017ad0: 6f6e 6773 2074 6f2e 0a20 2020 2020 2020  ongs to..       
-00017ae0: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
-00017af0: 2060 6074 6167 6060 206f 6620 7468 6520   ``tag`` of the 
-00017b00: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
-00017b10: 6520 696e 2074 6865 2044 422c 2066 6f72  e in the DB, for
-00017b20: 2065 7861 6d70 6c65 2060 606c 6174 6573   example ``lates
-00017b30: 7460 602e 0a20 2020 2020 2020 203a 7061  t``..        :pa
-00017b40: 7261 6d20 7569 643a 2054 6865 2060 6075  ram uid: The ``u
-00017b50: 6964 6060 206f 6620 7468 6520 6f62 6a65  id`` of the obje
-00017b60: 6374 2074 6f20 7265 706c 6163 6520 696e  ct to replace in
-00017b70: 2074 6865 2044 422e 2049 6620 7573 696e   the DB. If usin
-00017b80: 6720 7468 6973 2070 6172 616d 6574 6572  g this parameter
-00017b90: 2c20 7468 6520 6d6f 6469 6669 6564 206f  , the modified o
-00017ba0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-00017bb0: 2020 6d75 7374 2068 6176 6520 7468 6520    must have the 
-00017bc0: 7361 6d65 2060 6075 6964 6060 206f 6620  same ``uid`` of 
-00017bd0: 7468 6520 7072 6576 696f 7573 6c79 2d65  the previously-e
-00017be0: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
-00017bf0: 5468 6973 2063 616e 6e6f 7420 6265 2075  This cannot be u
-00017c00: 7365 6420 666f 7220 6e6f 6e2d 7665 7273  sed for non-vers
-00017c10: 696f 6e65 6420 6f62 6a65 6374 732e 0a20  ioned objects.. 
-00017c20: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
-00017c30: 7273 696f 6e65 643a 2057 6865 7468 6572  rsioned: Whether
-00017c40: 2074 6f20 6d61 696e 7461 696e 2076 6572   to maintain ver
-00017c50: 7369 6f6e 7320 666f 7220 7468 6973 2066  sions for this f
-00017c60: 6561 7475 7265 2d76 6563 746f 722e 2041  eature-vector. A
-00017c70: 6c6c 2076 6572 7369 6f6e 7320 6f66 2061  ll versions of a
-00017c80: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
-00017c90: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
-00017ca0: 6c6c 2062 6520 6b65 7074 2069 6e20 7468  ll be kept in th
-00017cb0: 6520 4442 2061 6e64 2063 616e 2062 6520  e DB and can be 
-00017cc0: 7265 7472 6965 7665 6420 756e 7469 6c20  retrieved until 
-00017cd0: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
-00017ce0: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
-00017cf0: 7572 6e73 3a20 5468 6520 3a70 793a 636c  urns: The :py:cl
-00017d00: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00017d10: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-00017d20: 6556 6563 746f 7260 206f 626a 6563 7420  eVector` object 
-00017d30: 2861 7320 6469 6374 292e 0a20 2020 2020  (as dict)..     
-00017d40: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00017d50: 7265 6665 7265 6e63 6520 3d20 7365 6c66  reference = self
-00017d60: 2e5f 7265 736f 6c76 655f 7265 6665 7265  ._resolve_refere
-00017d70: 6e63 6528 7461 672c 2075 6964 290a 2020  nce(tag, uid).  
-00017d80: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00017d90: 2276 6572 7369 6f6e 6564 223a 2076 6572  "versioned": ver
-00017da0: 7369 6f6e 6564 7d0a 0a20 2020 2020 2020  sioned}..       
-00017db0: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-00017dc0: 6561 7475 7265 5f76 6563 746f 722c 206d  eature_vector, m
-00017dd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00017de0: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
-00017df0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00017e00: 6665 6174 7572 655f 7665 6374 6f72 203d  feature_vector =
-00017e10: 2066 6561 7475 7265 5f76 6563 746f 722e   feature_vector.
-00017e20: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00017e30: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
-00017e40: 6561 7475 7265 5f76 6563 746f 722c 2046  eature_vector, F
-00017e50: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
-00017e60: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00017e70: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
-00017e80: 7572 655f 7665 6374 6f72 2e74 6f5f 6469  ure_vector.to_di
-00017e90: 6374 2829 0a0a 2020 2020 2020 2020 6e61  ct()..        na
-00017ea0: 6d65 203d 206e 616d 6520 6f72 2066 6561  me = name or fea
-00017eb0: 7475 7265 5f76 6563 746f 725b 226d 6574  ture_vector["met
-00017ec0: 6164 6174 6122 5d5b 226e 616d 6522 5d0a  adata"]["name"].
-00017ed0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00017ee0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00017ef0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-00017f00: 2020 2020 6f72 2066 6561 7475 7265 5f76      or feature_v
-00017f10: 6563 746f 725b 226d 6574 6164 6174 6122  ector["metadata"
-00017f20: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
-00017f30: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00017f40: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00017f50: 726f 6a65 6374 0a20 2020 2020 2020 2029  roject.        )
-00017f60: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00017f70: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-00017f80: 6563 747d 2f66 6561 7475 7265 2d76 6563  ect}/feature-vec
-00017f90: 746f 7273 2f7b 6e61 6d65 7d2f 7265 6665  tors/{name}/refe
-00017fa0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
-00017fb0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
-00017fc0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-00017fd0: 696c 6564 2073 746f 7269 6e67 2066 6561  iled storing fea
-00017fe0: 7475 7265 2d76 6563 746f 7220 7b70 726f  ture-vector {pro
-00017ff0: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
-00018000: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
-00018010: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00018020: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
-00018030: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00018040: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
-00018050: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
-00018060: 6a73 6f6e 2866 6561 7475 7265 5f76 6563  json(feature_vec
-00018070: 746f 7229 0a20 2020 2020 2020 2029 0a20  tor).        ). 
-00018080: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00018090: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
-000180a0: 6566 2070 6174 6368 5f66 6561 7475 7265  ef patch_feature
-000180b0: 5f76 6563 746f 7228 0a20 2020 2020 2020  _vector(.       
-000180c0: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-000180d0: 616d 652c 0a20 2020 2020 2020 2066 6561  ame,.        fea
-000180e0: 7475 7265 5f76 6563 746f 725f 7570 6461  ture_vector_upda
-000180f0: 7465 3a20 6469 6374 2c0a 2020 2020 2020  te: dict,.      
-00018100: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
-00018110: 2020 2020 2020 7461 673d 4e6f 6e65 2c0a        tag=None,.
-00018120: 2020 2020 2020 2020 7569 643d 4e6f 6e65          uid=None
-00018130: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
-00018140: 6d6f 6465 3a20 556e 696f 6e5b 0a20 2020  mode: Union[.   
-00018150: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
-00018160: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00018170: 6173 2e50 6174 6368 4d6f 6465 0a20 2020  as.PatchMode.   
-00018180: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-00018190: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
-000181a0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
-000181b0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000181c0: 2222 224d 6f64 6966 7920 2870 6174 6368  """Modify (patch
-000181d0: 2920 616e 2065 7869 7374 696e 6720 3a70  ) an existing :p
-000181e0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-000181f0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-00018200: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
-00018210: 6563 742e 0a20 2020 2020 2020 2054 6865  ect..        The
-00018220: 206f 626a 6563 7420 6973 2069 6465 6e74   object is ident
-00018230: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
-00018240: 6520 2861 6e64 2070 726f 6a65 6374 2069  e (and project i
-00018250: 7420 6265 6c6f 6e67 7320 746f 292c 2061  t belongs to), a
-00018260: 7320 7765 6c6c 2061 7320 6f70 7469 6f6e  s well as option
-00018270: 616c 6c79 2061 2060 6074 6167 6060 206f  ally a ``tag`` o
-00018280: 7220 6974 730a 2020 2020 2020 2020 6060  r its.        ``
-00018290: 7569 6460 6020 2866 6f72 2076 6572 7369  uid`` (for versi
-000182a0: 6f6e 6564 206f 626a 6563 7429 2e20 4966  oned object). If
-000182b0: 2062 6f74 6820 6060 7461 6760 6020 616e   both ``tag`` an
-000182c0: 6420 6060 7569 6460 6020 6172 6520 6f6d  d ``uid`` are om
-000182d0: 6974 7465 6420 7468 656e 2074 6865 206f  itted then the o
-000182e0: 626a 6563 7420 7769 7468 2074 6167 2060  bject with tag `
-000182f0: 606c 6174 6573 7460 600a 2020 2020 2020  `latest``.      
-00018300: 2020 6973 206d 6f64 6966 6965 642e 0a0a    is modified...
-00018310: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00018320: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-00018330: 206f 626a 6563 7420 746f 2070 6174 6368   object to patch
-00018340: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00018350: 2066 6561 7475 7265 5f76 6563 746f 725f   feature_vector_
-00018360: 7570 6461 7465 3a20 5468 6520 6d6f 6469  update: The modi
-00018370: 6669 6361 7469 6f6e 7320 6e65 6564 6564  fications needed
-00018380: 2069 6e20 7468 6520 6f62 6a65 6374 2e20   in the object. 
-00018390: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
-000183a0: 6e6c 7920 6861 7320 7468 6520 6368 616e  nly has the chan
-000183b0: 6765 7320 696e 2069 742c 0a20 2020 2020  ges in it,.     
-000183c0: 2020 2020 2020 206e 6f74 2061 2066 756c         not a ful
-000183d0: 6c20 6f62 6a65 6374 2e0a 2020 2020 2020  l object..      
-000183e0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-000183f0: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
-00018400: 636f 6e74 6169 6e73 2074 6865 206d 6f64  contains the mod
-00018410: 6966 6965 6420 6f62 6a65 6374 2e0a 2020  ified object..  
-00018420: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00018430: 3a20 5468 6520 7461 6720 6f66 2074 6865  : The tag of the
-00018440: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
-00018450: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
-00018460: 6d20 7569 643a 2075 6964 206f 6620 7468  m uid: uid of th
-00018470: 6520 6f62 6a65 6374 2074 6f20 6d6f 6469  e object to modi
-00018480: 6679 2e0a 2020 2020 2020 2020 3a70 6172  fy..        :par
-00018490: 616d 2070 6174 6368 5f6d 6f64 653a 2054  am patch_mode: T
-000184a0: 6865 2073 7472 6174 6567 7920 666f 7220  he strategy for 
-000184b0: 6d65 7267 696e 6720 7468 6520 6368 616e  merging the chan
-000184c0: 6765 7320 7769 7468 2074 6865 2065 7869  ges with the exi
-000184d0: 7374 696e 6720 6f62 6a65 6374 2e20 4361  sting object. Ca
-000184e0: 6e20 6265 2065 6974 6865 7220 6060 7265  n be either ``re
-000184f0: 706c 6163 6560 600a 2020 2020 2020 2020  place``.        
-00018500: 2020 2020 6f72 2060 6061 6464 6974 6976      or ``additiv
-00018510: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
-00018520: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
-00018530: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
-00018540: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
-00018550: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
-00018560: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00018570: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00018580: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-00018590: 2020 2068 6561 6465 7273 203d 207b 6d6c     headers = {ml
-000185a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-000185b0: 6173 2e48 6561 6465 724e 616d 6573 2e70  as.HeaderNames.p
-000185c0: 6174 6368 5f6d 6f64 653a 2070 6174 6368  atch_mode: patch
-000185d0: 5f6d 6f64 657d 0a20 2020 2020 2020 2070  _mode}.        p
-000185e0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-000185f0: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
-00018600: 7265 2d76 6563 746f 7273 2f7b 6e61 6d65  re-vectors/{name
-00018610: 7d2f 7265 6665 7265 6e63 6573 2f7b 7265  }/references/{re
-00018620: 6665 7265 6e63 657d 220a 2020 2020 2020  ference}".      
-00018630: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00018640: 3d20 6622 4661 696c 6564 2075 7064 6174  = f"Failed updat
-00018650: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
-00018660: 6f72 207b 7072 6f6a 6563 747d 2f7b 6e61  or {project}/{na
-00018670: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
-00018680: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00018690: 2020 2020 2020 2020 2250 4154 4348 222c          "PATCH",
-000186a0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-000186b0: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-000186c0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-000186d0: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-000186e0: 6963 745f 746f 5f6a 736f 6e28 6665 6174  ict_to_json(feat
-000186f0: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
-00018700: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00018710: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
-00018720: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00018730: 6465 6620 6465 6c65 7465 5f66 6561 7475  def delete_featu
-00018740: 7265 5f76 6563 746f 7228 7365 6c66 2c20  re_vector(self, 
-00018750: 6e61 6d65 2c20 7072 6f6a 6563 743d 2222  name, project=""
-00018760: 2c20 7461 673d 4e6f 6e65 2c20 7569 643d  , tag=None, uid=
-00018770: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00018780: 2222 4465 6c65 7465 2061 203a 7079 3a63  ""Delete a :py:c
-00018790: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
-000187a0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
-000187b0: 7265 5665 6374 6f72 6020 6f62 6a65 6374  reVector` object
-000187c0: 2066 726f 6d20 7468 6520 4442 2e0a 2020   from the DB..  
-000187d0: 2020 2020 2020 4966 2060 6074 6167 6060        If ``tag``
-000187e0: 206f 7220 6060 7569 6460 6020 6172 6520   or ``uid`` are 
-000187f0: 7370 6563 6966 6965 642c 2074 6865 6e20  specified, then 
-00018800: 6a75 7374 2074 6865 2076 6572 7369 6f6e  just the version
-00018810: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
-00018820: 6865 6d20 7769 6c6c 2062 6520 6465 6c65  hem will be dele
-00018830: 7465 642e 2055 7369 6e67 2062 6f74 680a  ted. Using both.
-00018840: 2020 2020 2020 2020 6973 206e 6f74 2061          is not a
-00018850: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
-00018860: 4966 206e 6f6e 6520 6172 6520 7370 6563  If none are spec
-00018870: 6966 6965 642c 2074 6865 6e20 616c 6c20  ified, then all 
-00018880: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-00018890: 206f 626a 6563 7420 7768 6f73 6520 6e61   object whose na
-000188a0: 6d65 2069 7320 6060 6e61 6d65 6060 2077  me is ``name`` w
-000188b0: 696c 6c20 6265 2064 656c 6574 6564 2e0a  ill be deleted..
-000188c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000188d0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-000188e0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-000188f0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00018900: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00018910: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00018920: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
-00018930: 6f72 732f 7b6e 616d 657d 220a 2020 2020  ors/{name}".    
-00018940: 2020 2020 6966 2074 6167 206f 7220 7569      if tag or ui
-00018950: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
-00018960: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
-00018970: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
-00018980: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
-00018990: 2020 2020 2020 2020 2070 6174 6820 3d20           path = 
-000189a0: 7061 7468 202b 2066 222f 7265 6665 7265  path + f"/refere
-000189b0: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
-000189c0: 220a 0a20 2020 2020 2020 2065 7272 6f72  "..        error
-000189d0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-000189e0: 6c65 6420 6465 6c65 7469 6e67 2066 6561  led deleting fea
-000189f0: 7475 7265 2d76 6563 746f 7220 7b6e 616d  ture-vector {nam
-00018a00: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
-00018a10: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
-00018a20: 4522 2c20 7061 7468 2c20 6572 726f 725f  E", path, error_
-00018a30: 6d65 7373 6167 6529 0a0a 2020 2020 6465  message)..    de
-00018a40: 6620 7461 675f 6f62 6a65 6374 7328 0a20  f tag_objects(. 
-00018a50: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00018a60: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00018a70: 722c 0a20 2020 2020 2020 2074 6167 5f6e  r,.        tag_n
-00018a80: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-00018a90: 2020 6f62 6a65 6374 733a 2055 6e69 6f6e    objects: Union
-00018aa0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
-00018ab0: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
-00018ac0: 2c20 6469 6374 5d2c 0a20 2020 2020 2020  , dict],.       
-00018ad0: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
-00018ae0: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
-00018af0: 2020 2020 2020 2022 2222 5461 6720 6120         """Tag a 
-00018b00: 6c69 7374 206f 6620 6f62 6a65 6374 732e  list of objects.
-00018b10: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00018b20: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-00018b30: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
-00018b40: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
-00018b50: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00018b60: 5f6e 616d 653a 2054 6865 2074 6167 2074  _name: The tag t
-00018b70: 6f20 7365 7420 6f6e 2074 6865 206f 626a  o set on the obj
-00018b80: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-00018b90: 6172 616d 206f 626a 6563 7473 3a20 5468  aram objects: Th
-00018ba0: 6520 6f62 6a65 6374 7320 746f 2074 6167  e objects to tag
-00018bb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00018bc0: 2072 6570 6c61 6365 3a20 5768 6574 6865   replace: Whethe
-00018bd0: 7220 746f 2072 6570 6c61 6365 2074 6865  r to replace the
-00018be0: 2065 7869 7374 696e 6720 7461 6773 206f   existing tags o
-00018bf0: 6620 7468 6520 6f62 6a65 6374 7320 6f72  f the objects or
-00018c00: 2074 6f20 6164 6420 7468 6520 6e65 7720   to add the new 
-00018c10: 7461 6720 746f 2074 6865 6d2e 0a20 2020  tag to them..   
-00018c20: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00018c30: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00018c40: 6374 732f 7b70 726f 6a65 6374 7d2f 7461  cts/{project}/ta
-00018c50: 6773 2f7b 7461 675f 6e61 6d65 7d22 0a20  gs/{tag_name}". 
-00018c60: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00018c70: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00018c80: 746f 2074 6167 207b 7461 675f 6e61 6d65  to tag {tag_name
-00018c90: 7d20 6f6e 206f 626a 6563 7473 207b 6f62  } on objects {ob
-00018ca0: 6a65 6374 737d 220a 2020 2020 2020 2020  jects}".        
-00018cb0: 6d65 7468 6f64 203d 2022 504f 5354 2220  method = "POST" 
-00018cc0: 6966 2072 6570 6c61 6365 2065 6c73 6520  if replace else 
-00018cd0: 2250 5554 220a 2020 2020 2020 2020 7365  "PUT".        se
-00018ce0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00018cf0: 2020 2020 2020 2020 206d 6574 686f 642c           method,
-00018d00: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-00018d10: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-00018d20: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-00018d30: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-00018d40: 6963 745f 746f 5f6a 736f 6e28 0a20 2020  ict_to_json(.   
-00018d50: 2020 2020 2020 2020 2020 2020 206f 626a               obj
-00018d60: 6563 7473 2e64 6963 7428 290a 2020 2020  ects.dict().    
-00018d70: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00018d80: 7369 6e73 7461 6e63 6528 6f62 6a65 6374  sinstance(object
-00018d90: 732c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  s, mlrun.common.
-00018da0: 7363 6865 6d61 732e 5461 674f 626a 6563  schemas.TagObjec
-00018db0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
-00018dc0: 2020 2020 656c 7365 206f 626a 6563 7473      else objects
-00018dd0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-00018de0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00018df0: 6566 2064 656c 6574 655f 6f62 6a65 6374  ef delete_object
-00018e00: 735f 7461 6728 0a20 2020 2020 2020 2073  s_tag(.        s
-00018e10: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-00018e20: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-00018e30: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
-00018e40: 2c0a 2020 2020 2020 2020 7461 675f 6f62  ,.        tag_ob
-00018e50: 6a65 6374 733a 2055 6e69 6f6e 5b6d 6c72  jects: Union[mlr
-00018e60: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00018e70: 732e 5461 674f 626a 6563 7473 2c20 6469  s.TagObjects, di
-00018e80: 6374 5d2c 0a20 2020 2029 3a0a 2020 2020  ct],.    ):.    
-00018e90: 2020 2020 2222 2244 656c 6574 6520 6120      """Delete a 
-00018ea0: 7461 6720 6672 6f6d 2061 206c 6973 7420  tag from a list 
-00018eb0: 6f66 206f 626a 6563 7473 2e0a 0a20 2020  of objects...   
-00018ec0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00018ed0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
-00018ee0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
-00018ef0: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
-00018f00: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
-00018f10: 3a20 5468 6520 7461 6720 746f 2064 656c  : The tag to del
-00018f20: 6574 6520 6672 6f6d 2074 6865 206f 626a  ete from the obj
-00018f30: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-00018f40: 6172 616d 2074 6167 5f6f 626a 6563 7473  aram tag_objects
-00018f50: 3a20 5468 6520 6f62 6a65 6374 7320 746f  : The objects to
-00018f60: 2064 656c 6574 6520 7468 6520 7461 6720   delete the tag 
-00018f70: 6672 6f6d 2e0a 0a20 2020 2020 2020 2022  from...        "
-00018f80: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
-00018f90: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00018fa0: 6f6a 6563 747d 2f74 6167 732f 7b74 6167  oject}/tags/{tag
-00018fb0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
-00018fc0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00018fd0: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
-00018fe0: 6720 7461 6720 6672 6f6d 207b 7461 675f  g tag from {tag_
-00018ff0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-00019000: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00019010: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
-00019020: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
-00019030: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-00019040: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
-00019050: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
-00019060: 793d 6469 6374 5f74 6f5f 6a73 6f6e 280a  y=dict_to_json(.
-00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019080: 7461 675f 6f62 6a65 6374 732e 6469 6374  tag_objects.dict
-00019090: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-000190a0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000190b0: 2874 6167 5f6f 626a 6563 7473 2c20 6d6c  (tag_objects, ml
-000190c0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-000190d0: 6173 2e54 6167 4f62 6a65 6374 7329 0a20  as.TagObjects). 
-000190e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000190f0: 6c73 6520 7461 675f 6f62 6a65 6374 730a  lse tag_objects.
-00019100: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00019110: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00019120: 6620 7461 675f 6172 7469 6661 6374 7328  f tag_artifacts(
-00019130: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00019140: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
-00019150: 3a20 556e 696f 6e5b 6c69 7374 5b41 7274  : Union[list[Art
-00019160: 6966 6163 745d 2c20 6c69 7374 5b64 6963  ifact], list[dic
-00019170: 745d 2c20 4172 7469 6661 6374 2c20 6469  t], Artifact, di
-00019180: 6374 5d2c 0a20 2020 2020 2020 2070 726f  ct],.        pro
-00019190: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-000191a0: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
-000191b0: 2c0a 2020 2020 2020 2020 7265 706c 6163  ,.        replac
-000191c0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-000191d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000191e0: 2222 2254 6167 2061 206c 6973 7420 6f66  """Tag a list of
-000191f0: 2061 7274 6966 6163 7473 2e0a 0a20 2020   artifacts...   
-00019200: 2020 2020 203a 7061 7261 6d20 6172 7469       :param arti
-00019210: 6661 6374 733a 2054 6865 2061 7274 6966  facts: The artif
-00019220: 6163 7473 2074 6f20 7461 672e 2043 616e  acts to tag. Can
-00019230: 2062 6520 6120 6c69 7374 206f 6620 3a70   be a list of :p
-00019240: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-00019250: 6172 7469 6661 6374 732e 4172 7469 6661  artifacts.Artifa
-00019260: 6374 6020 6f62 6a65 6374 7320 6f72 0a20  ct` objects or. 
-00019270: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
-00019280: 6f6e 6172 6965 732c 206f 7220 6120 7369  onaries, or a si
-00019290: 6e67 6c65 206f 626a 6563 742e 0a20 2020  ngle object..   
-000192a0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-000192b0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
-000192c0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
-000192d0: 6172 7469 6661 6374 732e 0a20 2020 2020  artifacts..     
-000192e0: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
-000192f0: 6d65 3a20 5468 6520 7461 6720 746f 2073  me: The tag to s
-00019300: 6574 206f 6e20 7468 6520 6172 7469 6661  et on the artifa
-00019310: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
-00019320: 7261 6d20 7265 706c 6163 653a 2049 6620  ram replace: If 
-00019330: 5472 7565 2c20 7265 706c 6163 6520 6578  True, replace ex
-00019340: 6973 7469 6e67 2074 6167 732c 206f 7468  isting tags, oth
-00019350: 6572 7769 7365 2061 7070 656e 6420 746f  erwise append to
-00019360: 2065 7869 7374 696e 6720 7461 6773 2e0a   existing tags..
-00019370: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00019380: 2020 2020 7461 675f 6f62 6a65 6374 7320      tag_objects 
-00019390: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
-000193a0: 6172 7469 6661 6374 735f 746f 5f74 6167  artifacts_to_tag
-000193b0: 5f6f 626a 6563 7473 2861 7274 6966 6163  _objects(artifac
-000193c0: 7473 290a 2020 2020 2020 2020 7365 6c66  ts).        self
-000193d0: 2e74 6167 5f6f 626a 6563 7473 2870 726f  .tag_objects(pro
-000193e0: 6a65 6374 2c20 7461 675f 6e61 6d65 2c20  ject, tag_name, 
-000193f0: 6f62 6a65 6374 733d 7461 675f 6f62 6a65  objects=tag_obje
-00019400: 6374 732c 2072 6570 6c61 6365 3d72 6570  cts, replace=rep
-00019410: 6c61 6365 290a 0a20 2020 2064 6566 2064  lace)..    def d
-00019420: 656c 6574 655f 6172 7469 6661 6374 735f  elete_artifacts_
-00019430: 7461 6773 280a 2020 2020 2020 2020 7365  tags(.        se
-00019440: 6c66 2c0a 2020 2020 2020 2020 6172 7469  lf,.        arti
-00019450: 6661 6374 732c 0a20 2020 2020 2020 2070  facts,.        p
-00019460: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-00019470: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
-00019480: 7472 2c0a 2020 2020 293a 0a20 2020 2020  tr,.    ):.     
-00019490: 2020 2022 2222 4465 6c65 7465 2074 6167     """Delete tag
-000194a0: 2066 726f 6d20 6120 6c69 7374 206f 6620   from a list of 
-000194b0: 6172 7469 6661 6374 732e 0a0a 2020 2020  artifacts...    
-000194c0: 2020 2020 3a70 6172 616d 2061 7274 6966      :param artif
-000194d0: 6163 7473 3a20 5468 6520 6172 7469 6661  acts: The artifa
-000194e0: 6374 7320 746f 2064 656c 6574 6520 7468  cts to delete th
-000194f0: 6520 7461 6720 6672 6f6d 2e20 4361 6e20  e tag from. Can 
-00019500: 6265 2061 206c 6973 7420 6f66 203a 7079  be a list of :py
-00019510: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e61  :class:`~mlrun.a
-00019520: 7274 6966 6163 7473 2e41 7274 6966 6163  rtifacts.Artifac
-00019530: 7460 0a20 2020 2020 2020 2020 2020 206f  t`.            o
-00019540: 626a 6563 7473 206f 7220 6469 6374 696f  bjects or dictio
-00019550: 6e61 7269 6573 2c20 6f72 2061 2073 696e  naries, or a sin
-00019560: 676c 6520 6f62 6a65 6374 2e0a 2020 2020  gle object..    
-00019570: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00019580: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-00019590: 6820 636f 6e74 6169 6e73 2074 6865 2061  h contains the a
-000195a0: 7274 6966 6163 7473 2e0a 2020 2020 2020  rtifacts..      
-000195b0: 2020 3a70 6172 616d 2074 6167 5f6e 616d    :param tag_nam
-000195c0: 653a 2054 6865 2074 6167 2074 6f20 7365  e: The tag to se
-000195d0: 7420 6f6e 2074 6865 2061 7274 6966 6163  t on the artifac
-000195e0: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
-000195f0: 2020 2020 2020 2020 7461 675f 6f62 6a65          tag_obje
-00019600: 6374 7320 3d20 7365 6c66 2e5f 7265 736f  cts = self._reso
-00019610: 6c76 655f 6172 7469 6661 6374 735f 746f  lve_artifacts_to
-00019620: 5f74 6167 5f6f 626a 6563 7473 2861 7274  _tag_objects(art
-00019630: 6966 6163 7473 290a 2020 2020 2020 2020  ifacts).        
-00019640: 7365 6c66 2e64 656c 6574 655f 6f62 6a65  self.delete_obje
-00019650: 6374 735f 7461 6728 7072 6f6a 6563 742c  cts_tag(project,
-00019660: 2074 6167 5f6e 616d 652c 2074 6167 5f6f   tag_name, tag_o
-00019670: 626a 6563 7473 290a 0a20 2020 2064 6566  bjects)..    def
-00019680: 206c 6973 745f 7072 6f6a 6563 7473 280a   list_projects(.
-00019690: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000196a0: 2020 2020 2020 6f77 6e65 723a 2073 7472        owner: str
-000196b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000196c0: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
-000196d0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-000196e0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-000196f0: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
-00019700: 6f72 6d61 740a 2020 2020 2020 2020 5d20  ormat.        ] 
-00019710: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00019720: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
-00019730: 6f72 6d61 742e 6e61 6d65 5f6f 6e6c 792c  ormat.name_only,
-00019740: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
-00019750: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
-00019760: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
-00019770: 3a20 556e 696f 6e5b 7374 722c 206d 6c72  : Union[str, mlr
-00019780: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00019790: 732e 5072 6f6a 6563 7453 7461 7465 5d20  s.ProjectState] 
-000197a0: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
-000197b0: 206c 6973 745b 556e 696f 6e5b 6d6c 7275   list[Union[mlru
-000197c0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-000197d0: 5072 6f6a 6563 742c 2073 7472 5d5d 3a0a  Project, str]]:.
-000197e0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000197f0: 6e20 6120 6c69 7374 206f 6620 7468 6520  n a list of the 
-00019800: 6578 6973 7469 6e67 2070 726f 6a65 6374  existing project
-00019810: 732c 2070 6f74 656e 7469 616c 6c79 2066  s, potentially f
-00019820: 696c 7465 7265 6420 6279 2073 7065 6369  iltered by speci
-00019830: 6669 6320 6372 6974 6572 6961 2e0a 0a20  fic criteria... 
-00019840: 2020 2020 2020 203a 7061 7261 6d20 6f77         :param ow
-00019850: 6e65 723a 204c 6973 7420 6f6e 6c79 2070  ner: List only p
-00019860: 726f 6a65 6374 7320 6265 6c6f 6e67 696e  rojects belongin
-00019870: 6720 746f 2074 6869 7320 7370 6563 6966  g to this specif
-00019880: 6963 206f 776e 6572 2e0a 2020 2020 2020  ic owner..      
-00019890: 2020 3a70 6172 616d 2066 6f72 6d61 745f    :param format_
-000198a0: 3a20 466f 726d 6174 206f 6620 7468 6520  : Format of the 
-000198b0: 7265 7375 6c74 732e 2050 6f73 7369 626c  results. Possibl
-000198c0: 6520 7661 6c75 6573 2061 7265 3a0a 0a20  e values are:.. 
-000198d0: 2020 2020 2020 2020 2020 202d 2060 606e             - ``n
-000198e0: 616d 655f 6f6e 6c79 6060 2028 6465 6661  ame_only`` (defa
-000198f0: 756c 7420 7661 6c75 6529 202d 2052 6574  ult value) - Ret
-00019900: 7572 6e20 6a75 7374 2074 6865 206e 616d  urn just the nam
-00019910: 6573 206f 6620 7468 6520 7072 6f6a 6563  es of the projec
-00019920: 7473 2e0a 2020 2020 2020 2020 2020 2020  ts..            
-00019930: 2d20 6060 6d69 6e69 6d61 6c60 6020 2d20  - ``minimal`` - 
-00019940: 5265 7475 726e 206d 696e 696d 616c 2070  Return minimal p
-00019950: 726f 6a65 6374 206f 626a 6563 7473 2028  roject objects (
-00019960: 6d69 6e69 6d69 7a61 7469 6f6e 2068 6170  minimization hap
-00019970: 7065 6e73 2069 6e20 7468 6520 4245 292e  pens in the BE).
-00019980: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
-00019990: 6066 756c 6c60 6020 202d 2052 6574 7572  `full``  - Retur
-000199a0: 6e20 6675 6c6c 2070 726f 6a65 6374 206f  n full project o
-000199b0: 626a 6563 7473 2e0a 0a20 2020 2020 2020  bjects...       
-000199c0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
-000199d0: 4669 6c74 6572 2062 7920 6c61 6265 6c73  Filter by labels
-000199e0: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
-000199f0: 2070 726f 6a65 6374 2e0a 2020 2020 2020   project..      
-00019a00: 2020 3a70 6172 616d 2073 7461 7465 3a20    :param state: 
-00019a10: 4669 6c74 6572 2062 7920 7072 6f6a 6563  Filter by projec
-00019a20: 7427 7320 7374 6174 652e 2043 616e 2062  t's state. Can b
-00019a30: 6520 6569 7468 6572 2060 606f 6e6c 696e  e either ``onlin
-00019a40: 6560 6020 6f72 2060 6061 7263 6869 7665  e`` or ``archive
-00019a50: 6460 602e 0a20 2020 2020 2020 2022 2222  d``..        """
-00019a60: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-00019a70: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00019a80: 2022 6f77 6e65 7222 3a20 6f77 6e65 722c   "owner": owner,
-00019a90: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
-00019aa0: 6174 6522 3a20 7374 6174 652c 0a20 2020  ate": state,.   
-00019ab0: 2020 2020 2020 2020 2022 666f 726d 6174           "format
-00019ac0: 223a 2066 6f72 6d61 745f 2c0a 2020 2020  ": format_,.    
-00019ad0: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
-00019ae0: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
-00019af0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-00019b00: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00019b10: 3d20 6622 4661 696c 6564 206c 6973 7469  = f"Failed listi
-00019b20: 6e67 2070 726f 6a65 6374 732c 2071 7565  ng projects, que
-00019b30: 7279 3a20 7b70 6172 616d 737d 220a 2020  ry: {params}".  
-00019b40: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00019b50: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-00019b60: 4745 5422 2c20 2270 726f 6a65 6374 7322  GET", "projects"
-00019b70: 2c20 6572 726f 725f 6d65 7373 6167 652c  , error_message,
-00019b80: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
-00019b90: 2020 2020 2020 2020 6966 2066 6f72 6d61          if forma
-00019ba0: 745f 203d 3d20 6d6c 7275 6e2e 636f 6d6d  t_ == mlrun.comm
-00019bb0: 6f6e 2e73 6368 656d 6173 2e50 726f 6a65  on.schemas.Proje
-00019bc0: 6374 7346 6f72 6d61 742e 6e61 6d65 5f6f  ctsFormat.name_o
-00019bd0: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
-00019be0: 2023 2070 726f 6a65 6374 7320 6973 206a   # projects is j
-00019bf0: 7573 7420 6120 6c69 7374 206f 6620 7374  ust a list of st
-00019c00: 7269 6e67 730a 2020 2020 2020 2020 2020  rings.          
-00019c10: 2020 7265 7475 726e 2072 6573 706f 6e73    return respons
-00019c20: 652e 6a73 6f6e 2829 5b22 7072 6f6a 6563  e.json()["projec
-00019c30: 7473 225d 0a0a 2020 2020 2020 2020 2320  ts"]..        # 
-00019c40: 666f 7277 6172 6473 2063 6f6d 7061 7469  forwards compati
-00019c50: 6269 6c69 7479 202d 2077 6520 7761 6e74  bility - we want
-00019c60: 2074 6f20 6265 2061 626c 6520 746f 2068   to be able to h
-00019c70: 616e 646c 6520 6e65 7720 666f 726d 6174  andle new format
-00019c80: 7320 7468 6174 206d 6967 6874 2062 6520  s that might be 
-00019c90: 6164 6465 6420 696e 2074 6865 2066 7574  added in the fut
-00019ca0: 7572 650a 2020 2020 2020 2020 2320 6966  ure.        # if
-00019cb0: 2066 6f72 6d61 7420 6973 206e 6f74 206b   format is not k
-00019cc0: 6e6f 776e 2074 6f20 7468 6520 6170 692c  nown to the api,
-00019cd0: 2069 7420 6973 2075 7020 746f 2074 6865   it is up to the
-00019ce0: 2073 6572 7665 7220 746f 2072 6574 7572   server to retur
-00019cf0: 6e20 6569 7468 6572 2061 6e20 6572 726f  n either an erro
-00019d00: 7220 6f72 2061 2064 6566 6175 6c74 2066  r or a default f
-00019d10: 6f72 6d61 740a 2020 2020 2020 2020 7265  ormat.        re
-00019d20: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
-00019d30: 2020 206d 6c72 756e 2e70 726f 6a65 6374     mlrun.project
-00019d40: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
-00019d50: 726f 6d5f 6469 6374 2870 726f 6a65 6374  rom_dict(project
-00019d60: 5f64 6963 7429 0a20 2020 2020 2020 2020  _dict).         
-00019d70: 2020 2066 6f72 2070 726f 6a65 6374 5f64     for project_d
-00019d80: 6963 7420 696e 2072 6573 706f 6e73 652e  ict in response.
-00019d90: 6a73 6f6e 2829 5b22 7072 6f6a 6563 7473  json()["projects
-00019da0: 225d 0a20 2020 2020 2020 205d 0a0a 2020  "].        ]..  
-00019db0: 2020 6465 6620 6765 745f 7072 6f6a 6563    def get_projec
-00019dc0: 7428 7365 6c66 2c20 6e61 6d65 3a20 7374  t(self, name: st
-00019dd0: 7229 202d 3e20 6d6c 7275 6e2e 7072 6f6a  r) -> mlrun.proj
-00019de0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-00019df0: 743a 0a20 2020 2020 2020 2022 2222 4765  t:.        """Ge
-00019e00: 7420 6465 7461 696c 7320 666f 7220 6120  t details for a 
-00019e10: 7370 6563 6966 6963 2070 726f 6a65 6374  specific project
-00019e20: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
-00019e30: 206e 6f74 206e 616d 653a 0a20 2020 2020   not name:.     
-00019e40: 2020 2020 2020 2072 6169 7365 204d 4c52         raise MLR
-00019e50: 756e 496e 7661 6c69 6441 7267 756d 656e  unInvalidArgumen
-00019e60: 7445 7272 6f72 2822 4e61 6d65 206d 7573  tError("Name mus
-00019e70: 7420 6265 2070 726f 7669 6465 6422 290a  t be provided").
-00019e80: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00019e90: 6622 7072 6f6a 6563 7473 2f7b 6e61 6d65  f"projects/{name
-00019ea0: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-00019eb0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-00019ec0: 6c65 6420 7265 7472 6965 7669 6e67 2070  led retrieving p
-00019ed0: 726f 6a65 6374 207b 6e61 6d65 7d22 0a20  roject {name}". 
-00019ee0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00019ef0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00019f00: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00019f10: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00019f20: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00019f30: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
-00019f40: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
-00019f50: 2872 6573 706f 6e73 652e 6a73 6f6e 2829  (response.json()
-00019f60: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
-00019f70: 655f 7072 6f6a 6563 7428 0a20 2020 2020  e_project(.     
-00019f80: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00019f90: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-00019fa0: 2020 2020 6465 6c65 7469 6f6e 5f73 7472      deletion_str
-00019fb0: 6174 6567 793a 2055 6e69 6f6e 5b0a 2020  ategy: Union[.  
-00019fc0: 2020 2020 2020 2020 2020 7374 722c 206d            str, m
-00019fd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00019fe0: 6d61 732e 4465 6c65 7469 6f6e 5374 7261  mas.DeletionStra
-00019ff0: 7465 6779 0a20 2020 2020 2020 205d 203d  tegy.        ] =
-0001a000: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001a010: 6865 6d61 732e 4465 6c65 7469 6f6e 5374  hemas.DeletionSt
-0001a020: 7261 7465 6779 2e64 6566 6175 6c74 2829  rategy.default()
-0001a030: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001a040: 2022 2222 4465 6c65 7465 2061 2070 726f   """Delete a pro
-0001a050: 6a65 6374 2e0a 0a20 2020 2020 2020 203a  ject...        :
-0001a060: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
-0001a070: 206f 6620 7468 6520 7072 6f6a 6563 7420   of the project 
-0001a080: 746f 2064 656c 6574 652e 0a20 2020 2020  to delete..     
-0001a090: 2020 203a 7061 7261 6d20 6465 6c65 7469     :param deleti
-0001a0a0: 6f6e 5f73 7472 6174 6567 793a 2048 6f77  on_strategy: How
-0001a0b0: 2074 6f20 7472 6561 7420 7265 736f 7572   to treat resour
-0001a0c0: 6365 7320 7265 6c61 7465 6420 746f 2074  ces related to t
-0001a0d0: 6865 2070 726f 6a65 6374 2e20 506f 7373  he project. Poss
-0001a0e0: 6962 6c65 2076 616c 7565 7320 6172 653a  ible values are:
-0001a0f0: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001a100: 6060 7265 7374 7269 6374 6060 2028 6465  ``restrict`` (de
-0001a110: 6661 756c 7429 202d 2050 726f 6a65 6374  fault) - Project
-0001a120: 206d 7573 7420 6e6f 7420 6861 7665 2061   must not have a
-0001a130: 6e79 2072 656c 6174 6564 2072 6573 6f75  ny related resou
-0001a140: 7263 6573 2077 6865 6e20 6465 6c65 7465  rces when delete
-0001a150: 642e 2049 6620 7573 696e 670a 2020 2020  d. If using.    
-0001a160: 2020 2020 2020 2020 2020 7468 6973 206d            this m
-0001a170: 6f64 6520 7768 696c 6520 7265 6c61 7465  ode while relate
-0001a180: 6420 7265 736f 7572 6365 7320 6578 6973  d resources exis
-0001a190: 742c 2074 6865 206f 7065 7261 7469 6f6e  t, the operation
-0001a1a0: 2077 696c 6c20 6661 696c 2e0a 2020 2020   will fail..    
-0001a1b0: 2020 2020 2020 2020 2d20 6060 6361 7363          - ``casc
-0001a1c0: 6164 6560 6020 2d20 4175 746f 6d61 7469  ade`` - Automati
-0001a1d0: 6361 6c6c 7920 6465 6c65 7465 2061 6c6c  cally delete all
-0001a1e0: 2072 656c 6174 6564 2072 6573 6f75 7263   related resourc
-0001a1f0: 6573 2077 6865 6e20 6465 6c65 7469 6e67  es when deleting
-0001a200: 2074 6865 2070 726f 6a65 6374 2e0a 2020   the project..  
-0001a210: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0001a220: 2020 2068 6561 6465 7273 203d 207b 0a20     headers = {. 
-0001a230: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-0001a240: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001a250: 4865 6164 6572 4e61 6d65 732e 6465 6c65  HeaderNames.dele
-0001a260: 7469 6f6e 5f73 7472 6174 6567 793a 2064  tion_strategy: d
-0001a270: 656c 6574 696f 6e5f 7374 7261 7465 6779  eletion_strategy
-0001a280: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001a290: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001a2a0: 203d 2066 2246 6169 6c65 6420 6465 6c65   = f"Failed dele
-0001a2b0: 7469 6e67 2070 726f 6a65 6374 207b 6e61  ting project {na
-0001a2c0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-0001a2d0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
-0001a2e0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0001a2f0: 2020 2022 4445 4c45 5445 222c 2066 2270     "DELETE", f"p
-0001a300: 726f 6a65 6374 732f 7b6e 616d 657d 222c  rojects/{name}",
-0001a310: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
-0001a320: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
-0001a330: 2076 6572 7369 6f6e 3d22 7632 220a 2020   version="v2".  
-0001a340: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001a350: 6966 2072 6573 706f 6e73 652e 7374 6174  if response.stat
-0001a360: 7573 5f63 6f64 6520 3d3d 2068 7474 702e  us_code == http.
-0001a370: 4854 5450 5374 6174 7573 2e41 4343 4550  HTTPStatus.ACCEP
-0001a380: 5445 443a 0a20 2020 2020 2020 2020 2020  TED:.           
-0001a390: 206c 6f67 6765 722e 696e 666f 2822 5072   logger.info("Pr
-0001a3a0: 6f6a 6563 7420 6973 2062 6569 6e67 2064  oject is being d
-0001a3b0: 656c 6574 6564 222c 2070 726f 6a65 6374  eleted", project
-0001a3c0: 5f6e 616d 653d 6e61 6d65 290a 2020 2020  _name=name).    
-0001a3d0: 2020 2020 2020 2020 6261 636b 6772 6f75          backgrou
-0001a3e0: 6e64 5f74 6173 6b20 3d20 6d6c 7275 6e2e  nd_task = mlrun.
-0001a3f0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-0001a400: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
-0001a410: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-0001a420: 0a20 2020 2020 2020 2020 2020 2062 6163  .            bac
-0001a430: 6b67 726f 756e 645f 7461 736b 203d 2073  kground_task = s
-0001a440: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
-0001a450: 636b 6772 6f75 6e64 5f74 6173 6b5f 746f  ckground_task_to
-0001a460: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-0001a470: 7374 6174 6528 0a20 2020 2020 2020 2020  state(.         
-0001a480: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
-0001a490: 645f 7461 736b 2e6d 6574 6164 6174 612e  d_task.metadata.
-0001a4a0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-0001a4b0: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-0001a4c0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0001a4d0: 2020 2020 6261 636b 6772 6f75 6e64 5f74      background_t
-0001a4e0: 6173 6b2e 7374 6174 7573 2e73 7461 7465  ask.status.state
-0001a4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a500: 203d 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e   == mlrun.common
-0001a510: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-0001a520: 756e 6454 6173 6b53 7461 7465 2e73 7563  undTaskState.suc
-0001a530: 6365 6564 6564 0a20 2020 2020 2020 2020  ceeded.         
-0001a540: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0001a550: 2020 2020 2020 6c6f 6767 6572 2e69 6e66        logger.inf
-0001a560: 6f28 2250 726f 6a65 6374 2064 656c 6574  o("Project delet
-0001a570: 6564 222c 2070 726f 6a65 6374 5f6e 616d  ed", project_nam
-0001a580: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
-0001a590: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
-0001a5a0: 2020 2020 2020 2065 6c69 6620 7265 7370         elif resp
-0001a5b0: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
-0001a5c0: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
-0001a5d0: 7475 732e 4e4f 5f43 4f4e 5445 4e54 3a0a  tus.NO_CONTENT:.
-0001a5e0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0001a5f0: 6572 2e69 6e66 6f28 2250 726f 6a65 6374  er.info("Project
-0001a600: 2064 656c 6574 6564 222c 2070 726f 6a65   deleted", proje
-0001a610: 6374 5f6e 616d 653d 6e61 6d65 290a 2020  ct_name=name).  
-0001a620: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a630: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
-0001a640: 7072 6f6a 6563 7428 0a20 2020 2020 2020  project(.       
-0001a650: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-0001a660: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-0001a670: 2020 7072 6f6a 6563 743a 2055 6e69 6f6e    project: Union
-0001a680: 5b64 6963 742c 206d 6c72 756e 2e70 726f  [dict, mlrun.pro
-0001a690: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-0001a6a0: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
-0001a6b0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
-0001a6c0: 5d2c 0a20 2020 2029 202d 3e20 6d6c 7275  ],.    ) -> mlru
-0001a6d0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-0001a6e0: 5072 6f6a 6563 743a 0a20 2020 2020 2020  Project:.       
-0001a6f0: 2022 2222 5374 6f72 6520 6120 7072 6f6a   """Store a proj
-0001a700: 6563 7420 696e 2074 6865 2044 422e 2054  ect in the DB. T
-0001a710: 6869 7320 6f70 6572 6174 696f 6e20 7769  his operation wi
-0001a720: 6c6c 206f 7665 7277 7269 7465 2065 7869  ll overwrite exi
-0001a730: 7374 696e 6720 7072 6f6a 6563 7420 6f66  sting project of
-0001a740: 2074 6865 2073 616d 6520 6e61 6d65 2069   the same name i
-0001a750: 6620 6578 6973 7473 2e22 2222 0a0a 2020  f exists."""..  
-0001a760: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-0001a770: 726f 6a65 6374 732f 7b6e 616d 657d 220a  rojects/{name}".
-0001a780: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0001a790: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-0001a7a0: 2073 746f 7269 6e67 2070 726f 6a65 6374   storing project
-0001a7b0: 207b 6e61 6d65 7d22 0a20 2020 2020 2020   {name}".       
-0001a7c0: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-0001a7d0: 726f 6a65 6374 2c20 6d6c 7275 6e2e 636f  roject, mlrun.co
-0001a7e0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
-0001a7f0: 6a65 6374 293a 0a20 2020 2020 2020 2020  ject):.         
-0001a800: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-0001a810: 6a65 6374 2e64 6963 7428 290a 2020 2020  ject.dict().    
-0001a820: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0001a830: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
-0001a840: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-0001a850: 6e50 726f 6a65 6374 293a 0a20 2020 2020  nProject):.     
-0001a860: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-0001a870: 2070 726f 6a65 6374 2e74 6f5f 6469 6374   project.to_dict
-0001a880: 2829 0a20 2020 2020 2020 2072 6573 706f  ().        respo
-0001a890: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-0001a8a0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0001a8b0: 2022 5055 5422 2c0a 2020 2020 2020 2020   "PUT",.        
-0001a8c0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-0001a8d0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0001a8e0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-0001a8f0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-0001a900: 6f6e 2870 726f 6a65 6374 292c 0a20 2020  on(project),.   
-0001a910: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-0001a920: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
-0001a930: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
-0001a940: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
-0001a950: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
-0001a960: 7265 7475 726e 2073 656c 662e 5f77 6169  return self._wai
-0001a970: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
-0001a980: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-0001a990: 7374 6174 6528 6e61 6d65 290a 2020 2020  state(name).    
-0001a9a0: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-0001a9b0: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
-0001a9c0: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
-0001a9d0: 2872 6573 706f 6e73 652e 6a73 6f6e 2829  (response.json()
-0001a9e0: 290a 0a20 2020 2064 6566 2070 6174 6368  )..    def patch
-0001a9f0: 5f70 726f 6a65 6374 280a 2020 2020 2020  _project(.      
-0001aa00: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001aa10: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-0001aa20: 2020 2070 726f 6a65 6374 3a20 6469 6374     project: dict
-0001aa30: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
-0001aa40: 6d6f 6465 3a20 556e 696f 6e5b 0a20 2020  mode: Union[.   
-0001aa50: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
-0001aa60: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001aa70: 6173 2e50 6174 6368 4d6f 6465 0a20 2020  as.PatchMode.   
-0001aa80: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-0001aa90: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
-0001aaa0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
-0001aab0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
-0001aac0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-0001aad0: 6f6a 6563 743a 0a20 2020 2020 2020 2022  oject:.        "
-0001aae0: 2222 5061 7463 6820 616e 2065 7869 7374  ""Patch an exist
-0001aaf0: 696e 6720 7072 6f6a 6563 7420 6f62 6a65  ing project obje
-0001ab00: 6374 2e0a 0a20 2020 2020 2020 203a 7061  ct...        :pa
-0001ab10: 7261 6d20 6e61 6d65 3a20 4e61 6d65 206f  ram name: Name o
-0001ab20: 6620 7072 6f6a 6563 7420 746f 2070 6174  f project to pat
-0001ab30: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
-0001ab40: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
-0001ab50: 6163 7475 616c 2063 6861 6e67 6573 2074  actual changes t
-0001ab60: 6f20 7468 6520 7072 6f6a 6563 7420 6f62  o the project ob
-0001ab70: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
-0001ab80: 6172 616d 2070 6174 6368 5f6d 6f64 653a  aram patch_mode:
-0001ab90: 2054 6865 2073 7472 6174 6567 7920 666f   The strategy fo
-0001aba0: 7220 6d65 7267 696e 6720 7468 6520 6368  r merging the ch
-0001abb0: 616e 6765 7320 7769 7468 2074 6865 2065  anges with the e
-0001abc0: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
-0001abd0: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
-0001abe0: 7265 706c 6163 6560 600a 2020 2020 2020  replace``.      
-0001abf0: 2020 2020 2020 6f72 2060 6061 6464 6974        or ``addit
-0001ac00: 6976 6560 602e 0a20 2020 2020 2020 2022  ive``..        "
-0001ac10: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-0001ac20: 203d 2066 2270 726f 6a65 6374 732f 7b6e   = f"projects/{n
-0001ac30: 616d 657d 220a 2020 2020 2020 2020 6865  ame}".        he
-0001ac40: 6164 6572 7320 3d20 7b6d 6c72 756e 2e63  aders = {mlrun.c
-0001ac50: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
-0001ac60: 6164 6572 4e61 6d65 732e 7061 7463 685f  aderNames.patch_
-0001ac70: 6d6f 6465 3a20 7061 7463 685f 6d6f 6465  mode: patch_mode
-0001ac80: 7d0a 2020 2020 2020 2020 6572 726f 725f  }.        error_
-0001ac90: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0001aca0: 6564 2070 6174 6368 696e 6720 7072 6f6a  ed patching proj
-0001acb0: 6563 7420 7b6e 616d 657d 220a 2020 2020  ect {name}".    
-0001acc0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0001acd0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0001ace0: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
-0001acf0: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0001ad00: 6573 7361 6765 2c20 626f 6479 3d64 6963  essage, body=dic
-0001ad10: 745f 746f 5f6a 736f 6e28 7072 6f6a 6563  t_to_json(projec
-0001ad20: 7429 2c20 6865 6164 6572 733d 6865 6164  t), headers=head
-0001ad30: 6572 730a 2020 2020 2020 2020 290a 2020  ers.        ).  
-0001ad40: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
-0001ad50: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-0001ad60: 6e50 726f 6a65 6374 2e66 726f 6d5f 6469  nProject.from_di
-0001ad70: 6374 2872 6573 706f 6e73 652e 6a73 6f6e  ct(response.json
-0001ad80: 2829 290a 0a20 2020 2064 6566 2063 7265  ())..    def cre
-0001ad90: 6174 655f 7072 6f6a 6563 7428 0a20 2020  ate_project(.   
-0001ada0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001adb0: 2020 2070 726f 6a65 6374 3a20 556e 696f     project: Unio
-0001adc0: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 7072  n[dict, mlrun.pr
-0001add0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-0001ade0: 6563 742c 206d 6c72 756e 2e63 6f6d 6d6f  ect, mlrun.commo
-0001adf0: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
-0001ae00: 745d 2c0a 2020 2020 2920 2d3e 206d 6c72  t],.    ) -> mlr
-0001ae10: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-0001ae20: 6e50 726f 6a65 6374 3a0a 2020 2020 2020  nProject:.      
-0001ae30: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
-0001ae40: 7720 7072 6f6a 6563 742e 2041 2070 726f  w project. A pro
-0001ae50: 6a65 6374 2077 6974 6820 7468 6520 7361  ject with the sa
-0001ae60: 6d65 206e 616d 6520 6d75 7374 206e 6f74  me name must not
-0001ae70: 2065 7869 7374 2070 7269 6f72 2074 6f20   exist prior to 
-0001ae80: 6372 6561 7469 6f6e 2e22 2222 0a0a 2020  creation."""..  
-0001ae90: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001aea0: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
-0001aeb0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001aec0: 732e 5072 6f6a 6563 7429 3a0a 2020 2020  s.Project):.    
-0001aed0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-0001aee0: 3d20 7072 6f6a 6563 742e 6469 6374 2829  = project.dict()
-0001aef0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-0001af00: 696e 7374 616e 6365 2870 726f 6a65 6374  instance(project
-0001af10: 2c20 6d6c 7275 6e2e 7072 6f6a 6563 7473  , mlrun.projects
-0001af20: 2e4d 6c72 756e 5072 6f6a 6563 7429 3a0a  .MlrunProject):.
-0001af30: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
-0001af40: 6563 7420 3d20 7072 6f6a 6563 742e 746f  ect = project.to
-0001af50: 5f64 6963 7428 290a 2020 2020 2020 2020  _dict().        
-0001af60: 7072 6f6a 6563 745f 6e61 6d65 203d 2070  project_name = p
-0001af70: 726f 6a65 6374 5b22 6d65 7461 6461 7461  roject["metadata
-0001af80: 225d 5b22 6e61 6d65 225d 0a20 2020 2020  "]["name"].     
-0001af90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001afa0: 203d 2066 2246 6169 6c65 6420 6372 6561   = f"Failed crea
-0001afb0: 7469 6e67 2070 726f 6a65 6374 207b 7072  ting project {pr
-0001afc0: 6f6a 6563 745f 6e61 6d65 7d22 0a20 2020  oject_name}".   
-0001afd0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-0001afe0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-0001aff0: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
-0001b000: 222c 0a20 2020 2020 2020 2020 2020 2023  ",.            #
-0001b010: 2064 6f20 6e6f 7420 7761 6974 2066 6f72   do not wait for
-0001b020: 2070 726f 6a65 6374 2074 6f20 7265 6163   project to reac
-0001b030: 6820 7465 726d 696e 616c 2073 7461 7465  h terminal state
-0001b040: 2073 796e 6368 726f 6e6f 7573 6c79 2e0a   synchronously..
-0001b050: 2020 2020 2020 2020 2020 2020 2320 6c65              # le
-0001b060: 7420 6974 2073 7461 7274 2061 6e64 2077  t it start and w
-0001b070: 6169 7420 666f 7220 6974 2074 6f20 7265  ait for it to re
-0001b080: 6163 6820 7465 726d 696e 616c 2073 7461  ach terminal sta
-0001b090: 7465 2061 7379 6e63 6872 6f6e 6f75 736c  te asynchronousl
-0001b0a0: 790a 2020 2020 2020 2020 2020 2020 2270  y.            "p
-0001b0b0: 726f 6a65 6374 733f 7761 6974 2d66 6f72  rojects?wait-for
-0001b0c0: 2d63 6f6d 706c 6574 696f 6e3d 6661 6c73  -completion=fals
-0001b0d0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001b0e0: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-0001b0f0: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
-0001b100: 6469 6374 5f74 6f5f 6a73 6f6e 2870 726f  dict_to_json(pro
-0001b110: 6a65 6374 292c 0a20 2020 2020 2020 2029  ject),.        )
-0001b120: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
-0001b130: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
-0001b140: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
-0001b150: 7475 732e 4143 4345 5054 4544 3a0a 2020  tus.ACCEPTED:.  
-0001b160: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001b170: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
-0001b180: 7072 6f6a 6563 745f 746f 5f72 6561 6368  project_to_reach
-0001b190: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
-0001b1a0: 7072 6f6a 6563 745f 6e61 6d65 290a 2020  project_name).  
-0001b1b0: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
-0001b1c0: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-0001b1d0: 6e50 726f 6a65 6374 2e66 726f 6d5f 6469  nProject.from_di
-0001b1e0: 6374 2872 6573 706f 6e73 652e 6a73 6f6e  ct(response.json
-0001b1f0: 2829 290a 0a20 2020 2064 6566 205f 7761  ())..    def _wa
-0001b200: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
-0001b210: 6f5f 7265 6163 685f 7465 726d 696e 616c  o_reach_terminal
-0001b220: 5f73 7461 7465 280a 2020 2020 2020 2020  _state(.        
-0001b230: 7365 6c66 2c20 7072 6f6a 6563 745f 6e61  self, project_na
-0001b240: 6d65 3a20 7374 720a 2020 2020 2920 2d3e  me: str.    ) ->
-0001b250: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
-0001b260: 4d6c 7275 6e50 726f 6a65 6374 3a0a 2020  MlrunProject:.  
-0001b270: 2020 2020 2020 6465 6620 5f76 6572 6966        def _verif
-0001b280: 795f 7072 6f6a 6563 745f 696e 5f74 6572  y_project_in_ter
-0001b290: 6d69 6e61 6c5f 7374 6174 6528 293a 0a20  minal_state():. 
-0001b2a0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-0001b2b0: 6374 203d 2073 656c 662e 6765 745f 7072  ct = self.get_pr
-0001b2c0: 6f6a 6563 7428 7072 6f6a 6563 745f 6e61  oject(project_na
-0001b2d0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-0001b2e0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-0001b2f0: 2020 2020 2070 726f 6a65 6374 2e73 7461       project.sta
-0001b300: 7475 732e 7374 6174 650a 2020 2020 2020  tus.state.      
-0001b310: 2020 2020 2020 2020 2020 6e6f 7420 696e            not in
-0001b320: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001b330: 6865 6d61 732e 5072 6f6a 6563 7453 7461  hemas.ProjectSta
-0001b340: 7465 2e74 6572 6d69 6e61 6c5f 7374 6174  te.terminal_stat
-0001b350: 6573 2829 0a20 2020 2020 2020 2020 2020  es().           
-0001b360: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0001b370: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-0001b380: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0001b390: 2020 2020 2020 2020 2066 2250 726f 6a65           f"Proje
-0001b3a0: 6374 206e 6f74 2069 6e20 7465 726d 696e  ct not in termin
-0001b3b0: 616c 2073 7461 7465 2e20 5374 6174 653a  al state. State:
-0001b3c0: 207b 7072 6f6a 6563 742e 7374 6174 7573   {project.status
-0001b3d0: 2e73 7461 7465 7d22 0a20 2020 2020 2020  .state}".       
-0001b3e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001b3f0: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
-0001b400: 6f6a 6563 740a 0a20 2020 2020 2020 2072  oject..        r
-0001b410: 6574 7572 6e20 6d6c 7275 6e2e 7574 696c  eturn mlrun.util
-0001b420: 732e 6865 6c70 6572 732e 7265 7472 795f  s.helpers.retry_
-0001b430: 756e 7469 6c5f 7375 6363 6573 7366 756c  until_successful
-0001b440: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0001b450: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
-0001b460: 6a65 6374 5f74 6572 6d69 6e61 6c5f 7374  ject_terminal_st
-0001b470: 6174 655f 7265 7472 795f 696e 7465 7276  ate_retry_interv
-0001b480: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
-0001b490: 3138 302c 0a20 2020 2020 2020 2020 2020  180,.           
-0001b4a0: 206c 6f67 6765 722c 0a20 2020 2020 2020   logger,.       
-0001b4b0: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
-0001b4c0: 2020 2020 2020 2020 5f76 6572 6966 795f          _verify_
-0001b4d0: 7072 6f6a 6563 745f 696e 5f74 6572 6d69  project_in_termi
-0001b4e0: 6e61 6c5f 7374 6174 652c 0a20 2020 2020  nal_state,.     
-0001b4f0: 2020 2029 0a0a 2020 2020 6465 6620 5f77     )..    def _w
-0001b500: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
-0001b510: 6e64 5f74 6173 6b5f 746f 5f72 6561 6368  nd_task_to_reach
-0001b520: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
-0001b530: 0a20 2020 2020 2020 2073 656c 662c 206e  .        self, n
-0001b540: 616d 653a 2073 7472 2c20 7072 6f6a 6563  ame: str, projec
-0001b550: 743a 2073 7472 203d 2022 220a 2020 2020  t: str = "".    
-0001b560: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-0001b570: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0001b580: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
-0001b590: 2020 6465 6620 5f76 6572 6966 795f 6261    def _verify_ba
-0001b5a0: 636b 6772 6f75 6e64 5f74 6173 6b5f 696e  ckground_task_in
-0001b5b0: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
-0001b5c0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0001b5d0: 6620 7072 6f6a 6563 743a 0a20 2020 2020  f project:.     
-0001b5e0: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
-0001b5f0: 726f 756e 645f 7461 736b 203d 2073 656c  round_task = sel
-0001b600: 662e 6765 745f 7072 6f6a 6563 745f 6261  f.get_project_ba
-0001b610: 636b 6772 6f75 6e64 5f74 6173 6b28 7072  ckground_task(pr
-0001b620: 6f6a 6563 742c 206e 616d 6529 0a20 2020  oject, name).   
-0001b630: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001b640: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001b650: 6163 6b67 726f 756e 645f 7461 736b 203d  ackground_task =
-0001b660: 2073 656c 662e 6765 745f 6261 636b 6772   self.get_backgr
-0001b670: 6f75 6e64 5f74 6173 6b28 6e61 6d65 290a  ound_task(name).
-0001b680: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0001b690: 6520 3d20 6261 636b 6772 6f75 6e64 5f74  e = background_t
-0001b6a0: 6173 6b2e 7374 6174 7573 2e73 7461 7465  ask.status.state
-0001b6b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001b6c0: 7374 6174 6520 6e6f 7420 696e 206d 6c72  state not in mlr
-0001b6d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001b6e0: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
-0001b6f0: 5374 6174 652e 7465 726d 696e 616c 5f73  State.terminal_s
-0001b700: 7461 7465 7328 293a 0a20 2020 2020 2020  tates():.       
-0001b710: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
-0001b720: 7863 6570 7469 6f6e 280a 2020 2020 2020  xception(.      
-0001b730: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0001b740: 4261 636b 6772 6f75 6e64 2074 6173 6b20  Background task 
-0001b750: 6e6f 7420 696e 2074 6572 6d69 6e61 6c20  not in terminal 
-0001b760: 7374 6174 652e 206e 616d 653d 7b6e 616d  state. name={nam
-0001b770: 657d 2c20 7374 6174 653d 7b73 7461 7465  e}, state={state
-0001b780: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-0001b790: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001b7a0: 2072 6574 7572 6e20 6261 636b 6772 6f75   return backgrou
-0001b7b0: 6e64 5f74 6173 6b0a 0a20 2020 2020 2020  nd_task..       
-0001b7c0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7574   return mlrun.ut
-0001b7d0: 696c 732e 6865 6c70 6572 732e 7265 7472  ils.helpers.retr
-0001b7e0: 795f 756e 7469 6c5f 7375 6363 6573 7366  y_until_successf
-0001b7f0: 756c 280a 2020 2020 2020 2020 2020 2020  ul(.            
-0001b800: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f62  self._wait_for_b
-0001b810: 6163 6b67 726f 756e 645f 7461 736b 5f74  ackground_task_t
-0001b820: 6572 6d69 6e61 6c5f 7374 6174 655f 7265  erminal_state_re
-0001b830: 7472 795f 696e 7465 7276 616c 2c0a 2020  try_interval,.  
-0001b840: 2020 2020 2020 2020 2020 3630 202a 2036            60 * 6
-0001b850: 302c 0a20 2020 2020 2020 2020 2020 206c  0,.            l
-0001b860: 6f67 6765 722c 0a20 2020 2020 2020 2020  ogger,.         
-0001b870: 2020 2046 616c 7365 2c0a 2020 2020 2020     False,.      
-0001b880: 2020 2020 2020 5f76 6572 6966 795f 6261        _verify_ba
-0001b890: 636b 6772 6f75 6e64 5f74 6173 6b5f 696e  ckground_task_in
-0001b8a0: 5f74 6572 6d69 6e61 6c5f 7374 6174 652c  _terminal_state,
-0001b8b0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001b8c0: 6465 6620 6372 6561 7465 5f70 726f 6a65  def create_proje
-0001b8d0: 6374 5f73 6563 7265 7473 280a 2020 2020  ct_secrets(.    
-0001b8e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0001b8f0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-0001b900: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
-0001b910: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
-0001b920: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
-0001b930: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0001b940: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
-0001b950: 650a 2020 2020 2020 2020 5d20 3d20 6d6c  e.        ] = ml
-0001b960: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001b970: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-0001b980: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
-0001b990: 2c0a 2020 2020 2020 2020 7365 6372 6574  ,.        secret
-0001b9a0: 733a 2064 6963 7420 3d20 4e6f 6e65 2c0a  s: dict = None,.
-0001b9b0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0001b9c0: 2222 4372 6561 7465 2070 726f 6a65 6374  ""Create project
-0001b9d0: 2d63 6f6e 7465 7874 2073 6563 7265 7473  -context secrets
-0001b9e0: 2075 7369 6e67 2065 6974 6865 7220 6060   using either ``
-0001b9f0: 7661 756c 7460 6020 6f72 2060 606b 7562  vault`` or ``kub
-0001ba00: 6572 6e65 7465 7360 6020 7072 6f76 6964  ernetes`` provid
-0001ba10: 6572 2e0a 2020 2020 2020 2020 5768 656e  er..        When
-0001ba20: 2075 7369 6e67 2077 6974 6820 5661 756c   using with Vaul
-0001ba30: 742c 2074 6869 7320 7769 6c6c 2063 7265  t, this will cre
-0001ba40: 6174 6520 6e65 6564 6564 2056 6175 6c74  ate needed Vault
-0001ba50: 2073 7472 7563 7475 7265 7320 666f 7220   structures for 
-0001ba60: 7374 6f72 696e 6720 7365 6372 6574 7320  storing secrets 
-0001ba70: 696e 2070 726f 6a65 6374 2d63 6f6e 7465  in project-conte
-0001ba80: 7874 2c20 616e 640a 2020 2020 2020 2020  xt, and.        
-0001ba90: 7374 6f72 6520 6120 7365 7420 6f66 2073  store a set of s
-0001baa0: 6563 7265 7420 7661 6c75 6573 2e20 5468  ecret values. Th
-0001bab0: 6520 6d65 7468 6f64 2067 656e 6572 6174  e method generat
-0001bac0: 6573 204b 7562 6572 6e65 7465 7320 7365  es Kubernetes se
-0001bad0: 7276 6963 652d 6163 636f 756e 7420 616e  rvice-account an
-0001bae0: 6420 7468 6520 5661 756c 7420 6175 7468  d the Vault auth
-0001baf0: 656e 7469 6361 7469 6f6e 0a20 2020 2020  entication.     
-0001bb00: 2020 2073 7472 7563 7475 7265 7320 7468     structures th
-0001bb10: 6174 2061 7265 2072 6571 7569 7265 6420  at are required 
-0001bb20: 666f 7220 6675 6e63 7469 6f6e 2050 6f64  for function Pod
-0001bb30: 7320 746f 2061 7574 6865 6e74 6963 6174  s to authenticat
-0001bb40: 6520 7769 7468 2056 6175 6c74 2061 6e64  e with Vault and
-0001bb50: 2062 6520 6162 6c65 2074 6f20 6578 7472   be able to extr
-0001bb60: 6163 7420 7365 6372 6574 2076 616c 7565  act secret value
-0001bb70: 730a 2020 2020 2020 2020 7061 7373 6564  s.        passed
-0001bb80: 2061 7320 7061 7274 206f 6620 7468 6569   as part of thei
-0001bb90: 7220 636f 6e74 6578 742e 0a0a 2020 2020  r context...    
-0001bba0: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
-0001bbb0: 2020 2020 2020 2020 2020 5468 6973 206d            This m
-0001bbc0: 6574 686f 6420 7573 6564 2077 6974 6820  ethod used with 
-0001bbd0: 5661 756c 7420 6973 2063 7572 7265 6e74  Vault is current
-0001bbe0: 6c79 2069 6e20 7465 6368 6e69 6361 6c20  ly in technical 
-0001bbf0: 7072 6576 6965 772c 2061 6e64 2072 6571  preview, and req
-0001bc00: 7569 7265 7320 6120 4861 7368 6943 6f72  uires a HashiCor
-0001bc10: 7020 5661 756c 740a 2020 2020 2020 2020  p Vault.        
-0001bc20: 2020 2020 2020 2020 696e 6672 6173 7472          infrastr
-0001bc30: 7563 7475 7265 2070 726f 7065 726c 7920  ucture properly 
-0001bc40: 7365 7420 7570 2061 6e64 2063 6f6e 6e65  set up and conne
-0001bc50: 6374 6564 2074 6f20 7468 6520 4d4c 5275  cted to the MLRu
-0001bc60: 6e20 4150 4920 7365 7276 6572 2e0a 0a20  n API server... 
-0001bc70: 2020 2020 2020 2057 6865 6e20 7573 6564         When used
-0001bc80: 2077 6974 6820 4b75 6265 726e 6574 6573   with Kubernetes
-0001bc90: 2c20 7468 6973 2077 696c 6c20 6d61 6b65  , this will make
-0001bca0: 2073 7572 6520 7468 6174 2074 6865 2070   sure that the p
-0001bcb0: 726f 6a65 6374 2d73 7065 6369 6669 6320  roject-specific 
-0001bcc0: 6b38 7320 7365 6372 6574 2069 7320 6372  k8s secret is cr
-0001bcd0: 6561 7465 642c 2061 6e64 2077 696c 6c0a  eated, and will.
-0001bce0: 2020 2020 2020 2020 706f 7075 6c61 7465          populate
-0001bcf0: 2069 7420 7769 7468 2074 6865 2073 6563   it with the sec
-0001bd00: 7265 7473 2070 726f 7669 6465 642c 2072  rets provided, r
-0001bd10: 6570 6c61 6369 6e67 2074 6865 6972 2076  eplacing their v
-0001bd20: 616c 7565 7320 6966 2074 6865 7920 6578  alues if they ex
-0001bd30: 6973 742e 0a0a 2020 2020 2020 2020 3a70  ist...        :p
-0001bd40: 6172 616d 2070 726f 6a65 6374 3a20 5468  aram project: Th
-0001bd50: 6520 7072 6f6a 6563 7420 636f 6e74 6578  e project contex
-0001bd60: 7420 666f 7220 7768 6963 6820 746f 2067  t for which to g
-0001bd70: 656e 6572 6174 6520 7468 6520 696e 6672  enerate the infr
-0001bd80: 6120 616e 6420 7374 6f72 6520 7365 6372  a and store secr
-0001bd90: 6574 732e 0a20 2020 2020 2020 203a 7061  ets..        :pa
-0001bda0: 7261 6d20 7072 6f76 6964 6572 3a20 5468  ram provider: Th
-0001bdb0: 6520 6e61 6d65 206f 6620 7468 6520 7365  e name of the se
-0001bdc0: 6372 6574 732d 7072 6f76 6964 6572 2074  crets-provider t
-0001bdd0: 6f20 776f 726b 2077 6974 682e 2041 6363  o work with. Acc
-0001bde0: 6570 7473 2061 0a20 2020 2020 2020 2020  epts a.         
-0001bdf0: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
-0001be00: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001be10: 6d61 732e 7365 6372 6574 2e53 6563 7265  mas.secret.Secre
-0001be20: 7450 726f 7669 6465 724e 616d 6560 2065  tProviderName` e
-0001be30: 6e75 6d2e 0a20 2020 2020 2020 203a 7061  num..        :pa
-0001be40: 7261 6d20 7365 6372 6574 733a 2041 2073  ram secrets: A s
-0001be50: 6574 206f 6620 7365 6372 6574 2076 616c  et of secret val
-0001be60: 7565 7320 746f 2073 746f 7265 2e0a 2020  ues to store..  
-0001be70: 2020 2020 2020 2020 2020 4578 616d 706c            Exampl
-0001be80: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-0001be90: 2020 2020 2073 6563 7265 7473 203d 207b       secrets = {
-0001bea0: 2770 6173 7377 6f72 6427 3a20 276d 7950  'password': 'myP
-0001beb0: 6173 7377 3072 6427 2c20 2761 7773 5f6b  assw0rd', 'aws_k
-0001bec0: 6579 273a 2027 3131 3132 3232 3333 3327  ey': '111222333'
-0001bed0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0001bee0: 2020 6462 2e63 7265 6174 655f 7072 6f6a    db.create_proj
-0001bef0: 6563 745f 7365 6372 6574 7328 0a20 2020  ect_secrets(.   
+0000cc20: 756c 7473 2074 6f20 6d6c 7275 6e2e 6d6c  ults to mlrun.ml
+0000cc30: 636f 6e66 2e72 756e 7469 6d65 5f72 6573  conf.runtime_res
+0000cc40: 6f75 7263 6573 5f64 656c 6574 696f 6e5f  ources_deletion_
+0000cc50: 6772 6163 655f 7065 7269 6f64 292e 0a0a  grace_period)...
+0000cc60: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+0000cc70: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
+0000cc80: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000cc90: 6173 2e47 726f 7570 6564 4279 5072 6f6a  as.GroupedByProj
+0000cca0: 6563 7452 756e 7469 6d65 5265 736f 7572  ectRuntimeResour
+0000ccb0: 6365 734f 7574 7075 7460 206c 6973 7469  cesOutput` listi
+0000ccc0: 6e67 2074 6865 2072 756e 7469 6d65 2072  ng the runtime r
+0000ccd0: 6573 6f75 7263 6573 0a20 2020 2020 2020  esources.       
+0000cce0: 2020 2020 2074 6861 7420 7765 7265 2072       that were r
+0000ccf0: 656d 6f76 6564 2e0a 2020 2020 2020 2020  emoved..        
+0000cd00: 2222 220a 2020 2020 2020 2020 6966 2067  """.        if g
+0000cd10: 7261 6365 5f70 6572 696f 6420 6973 204e  race_period is N
+0000cd20: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000cd30: 2067 7261 6365 5f70 6572 696f 6420 3d20   grace_period = 
+0000cd40: 636f 6e66 6967 2e72 756e 7469 6d65 5f72  config.runtime_r
+0000cd50: 6573 6f75 7263 6573 5f64 656c 6574 696f  esources_deletio
+0000cd60: 6e5f 6772 6163 655f 7065 7269 6f64 0a20  n_grace_period. 
+0000cd70: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000cd80: 722e 696e 666f 280a 2020 2020 2020 2020  r.info(.        
+0000cd90: 2020 2020 2020 2020 2255 7369 6e67 2064          "Using d
+0000cda0: 6566 6175 6c74 2067 7261 6365 2070 6572  efault grace per
+0000cdb0: 696f 6420 666f 7220 7275 6e74 696d 6520  iod for runtime 
+0000cdc0: 7265 736f 7572 6365 7320 6465 6c65 7469  resources deleti
+0000cdd0: 6f6e 222c 0a20 2020 2020 2020 2020 2020  on",.           
+0000cde0: 2020 2020 2067 7261 6365 5f70 6572 696f       grace_perio
+0000cdf0: 643d 6772 6163 655f 7065 7269 6f64 2c0a  d=grace_period,.
+0000ce00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000ce10: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000ce20: 7b0a 2020 2020 2020 2020 2020 2020 226c  {.            "l
+0000ce30: 6162 656c 2d73 656c 6563 746f 7222 3a20  abel-selector": 
+0000ce40: 6c61 6265 6c5f 7365 6c65 6374 6f72 2c0a  label_selector,.
+0000ce50: 2020 2020 2020 2020 2020 2020 226b 696e              "kin
+0000ce60: 6422 3a20 6b69 6e64 2c0a 2020 2020 2020  d": kind,.      
+0000ce70: 2020 2020 2020 226f 626a 6563 742d 6964        "object-id
+0000ce80: 223a 206f 626a 6563 745f 6964 2c0a 2020  ": object_id,.  
+0000ce90: 2020 2020 2020 2020 2020 2266 6f72 6365            "force
+0000cea0: 223a 2066 6f72 6365 2c0a 2020 2020 2020  ": force,.      
+0000ceb0: 2020 2020 2020 2267 7261 6365 2d70 6572        "grace-per
+0000cec0: 696f 6422 3a20 6772 6163 655f 7065 7269  iod": grace_peri
+0000ced0: 6f64 2c0a 2020 2020 2020 2020 7d0a 2020  od,.        }.  
+0000cee0: 2020 2020 2020 6572 726f 7220 3d20 2246        error = "F
+0000cef0: 6169 6c65 6420 6465 6c65 7469 6e67 2072  ailed deleting r
+0000cf00: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+0000cf10: 220a 2020 2020 2020 2020 7072 6f6a 6563  ".        projec
+0000cf20: 745f 7061 7468 203d 2070 726f 6a65 6374  t_path = project
+0000cf30: 2069 6620 7072 6f6a 6563 7420 656c 7365   if project else
+0000cf40: 2022 2a22 0a20 2020 2020 2020 2072 6573   "*".        res
+0000cf50: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0000cf60: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0000cf70: 2020 2022 4445 4c45 5445 222c 0a20 2020     "DELETE",.   
+0000cf80: 2020 2020 2020 2020 2066 2270 726f 6a65           f"proje
+0000cf90: 6374 732f 7b70 726f 6a65 6374 5f70 6174  cts/{project_pat
+0000cfa0: 687d 2f72 756e 7469 6d65 2d72 6573 6f75  h}/runtime-resou
+0000cfb0: 7263 6573 222c 0a20 2020 2020 2020 2020  rces",.         
+0000cfc0: 2020 2065 7272 6f72 2c0a 2020 2020 2020     error,.      
+0000cfd0: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
+0000cfe0: 616d 732c 0a20 2020 2020 2020 2029 0a20  ams,.        ). 
+0000cff0: 2020 2020 2020 2073 7472 7563 7475 7265         structure
+0000d000: 645f 6469 6374 203d 207b 7d0a 2020 2020  d_dict = {}.    
+0000d010: 2020 2020 666f 7220 7072 6f6a 6563 742c      for project,
+0000d020: 206b 696e 645f 7275 6e74 696d 655f 7265   kind_runtime_re
+0000d030: 736f 7572 6365 735f 6d61 7020 696e 2072  sources_map in r
+0000d040: 6573 706f 6e73 652e 6a73 6f6e 2829 2e69  esponse.json().i
+0000d050: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0000d060: 2020 2020 666f 7220 6b69 6e64 2c20 7275      for kind, ru
+0000d070: 6e74 696d 655f 7265 736f 7572 6365 7320  ntime_resources 
+0000d080: 696e 206b 696e 645f 7275 6e74 696d 655f  in kind_runtime_
+0000d090: 7265 736f 7572 6365 735f 6d61 702e 6974  resources_map.it
+0000d0a0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+0000d0b0: 2020 2020 2020 2073 7472 7563 7475 7265         structure
+0000d0c0: 645f 6469 6374 2e73 6574 6465 6661 756c  d_dict.setdefaul
+0000d0d0: 7428 7072 6f6a 6563 742c 207b 7d29 5b6b  t(project, {})[k
+0000d0e0: 696e 645d 203d 2028 0a20 2020 2020 2020  ind] = (.       
+0000d0f0: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
+0000d100: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000d110: 732e 5275 6e74 696d 6552 6573 6f75 7263  s.RuntimeResourc
+0000d120: 6573 282a 2a72 756e 7469 6d65 5f72 6573  es(**runtime_res
+0000d130: 6f75 7263 6573 290a 2020 2020 2020 2020  ources).        
+0000d140: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d150: 2020 7265 7475 726e 2073 7472 7563 7475    return structu
+0000d160: 7265 645f 6469 6374 0a0a 2020 2020 6465  red_dict..    de
+0000d170: 6620 6372 6561 7465 5f73 6368 6564 756c  f create_schedul
+0000d180: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0000d190: 2070 726f 6a65 6374 3a20 7374 722c 2073   project: str, s
+0000d1a0: 6368 6564 756c 653a 206d 6c72 756e 2e63  chedule: mlrun.c
+0000d1b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5363  ommon.schemas.Sc
+0000d1c0: 6865 6475 6c65 496e 7075 740a 2020 2020  heduleInput.    
+0000d1d0: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
+0000d1e0: 6561 7465 2061 206e 6577 2073 6368 6564  eate a new sched
+0000d1f0: 756c 6520 6f6e 2074 6865 2067 6976 656e  ule on the given
+0000d200: 2070 726f 6a65 6374 2e20 5468 6520 6465   project. The de
+0000d210: 7461 696c 7320 6f6e 2074 6865 2061 6374  tails on the act
+0000d220: 7561 6c20 6f62 6a65 6374 2074 6f20 7363  ual object to sc
+0000d230: 6865 6475 6c65 2061 7320 7765 6c6c 2061  hedule as well a
+0000d240: 7320 7468 650a 2020 2020 2020 2020 7363  s the.        sc
+0000d250: 6865 6475 6c65 2069 7473 656c 6620 6172  hedule itself ar
+0000d260: 6520 7769 7468 696e 2074 6865 2073 6368  e within the sch
+0000d270: 6564 756c 6520 6f62 6a65 6374 2070 726f  edule object pro
+0000d280: 7669 6465 642e 0a20 2020 2020 2020 2054  vided..        T
+0000d290: 6865 203a 7079 3a63 6c61 7373 3a60 7e53  he :py:class:`~S
+0000d2a0: 6368 6564 756c 6543 726f 6e54 7269 6767  cheduleCronTrigg
+0000d2b0: 6572 6020 666f 6c6c 6f77 7320 7468 6520  er` follows the 
+0000d2c0: 6775 6964 656c 696e 6573 2069 6e0a 2020  guidelines in.  
+0000d2d0: 2020 2020 2020 6874 7470 733a 2f2f 6170        https://ap
+0000d2e0: 7363 6865 6475 6c65 722e 7265 6164 7468  scheduler.readth
+0000d2f0: 6564 6f63 732e 696f 2f65 6e2f 332e 782f  edocs.io/en/3.x/
+0000d300: 6d6f 6475 6c65 732f 7472 6967 6765 7273  modules/triggers
+0000d310: 2f63 726f 6e2e 6874 6d6c 2e0a 2020 2020  /cron.html..    
+0000d320: 2020 2020 4974 2061 6c73 6f20 7375 7070      It also supp
+0000d330: 6f72 7473 2061 203a 7079 3a66 756e 633a  orts a :py:func:
+0000d340: 607e 5363 6865 6475 6c65 4372 6f6e 5472  `~ScheduleCronTr
+0000d350: 6967 6765 722e 6672 6f6d 5f63 726f 6e74  igger.from_cront
+0000d360: 6162 6020 6675 6e63 7469 6f6e 2074 6861  ab` function tha
+0000d370: 7420 6163 6365 7074 7320 610a 2020 2020  t accepts a.    
+0000d380: 2020 2020 6372 6f6e 7461 622d 666f 726d      crontab-form
+0000d390: 6174 7465 6420 7374 7269 6e67 2028 7365  atted string (se
+0000d3a0: 6520 6874 7470 733a 2f2f 656e 2e77 696b  e https://en.wik
+0000d3b0: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
+0000d3c0: 4372 6f6e 2066 6f72 206d 6f72 6520 696e  Cron for more in
+0000d3d0: 666f 726d 6174 696f 6e20 6f6e 2074 6865  formation on the
+0000d3e0: 2066 6f72 6d61 7420 616e 640a 2020 2020   format and.    
+0000d3f0: 2020 2020 6e6f 7465 2074 6861 7420 7468      note that th
+0000d400: 6520 3020 7765 656b 6461 7920 6973 2061  e 0 weekday is a
+0000d410: 6c77 6179 7320 6d6f 6e64 6179 292e 0a0a  lways monday)...
+0000d420: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0000d430: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+0000d440: 6672 6f6d 206d 6c72 756e 2e63 6f6d 6d6f  from mlrun.commo
+0000d450: 6e20 696d 706f 7274 2073 6368 656d 6173  n import schemas
+0000d460: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000d470: 4578 6563 7574 6520 7468 6520 6765 745f  Execute the get_
+0000d480: 6461 7461 5f66 756e 6320 6675 6e63 7469  data_func functi
+0000d490: 6f6e 2065 7665 7279 2054 7565 7364 6179  on every Tuesday
+0000d4a0: 2061 7420 3135 3a33 300a 2020 2020 2020   at 15:30.      
+0000d4b0: 2020 2020 2020 7363 6865 6475 6c65 203d        schedule =
+0000d4c0: 2073 6368 656d 6173 2e53 6368 6564 756c   schemas.Schedul
+0000d4d0: 6549 6e70 7574 280a 2020 2020 2020 2020  eInput(.        
+0000d4e0: 2020 2020 2020 2020 6e61 6d65 3d22 7275          name="ru
+0000d4f0: 6e5f 6675 6e63 5f6f 6e5f 7475 6573 6461  n_func_on_tuesda
+0000d500: 7973 222c 0a20 2020 2020 2020 2020 2020  ys",.           
+0000d510: 2020 2020 206b 696e 643d 226a 6f62 222c       kind="job",
+0000d520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d530: 2073 6368 6564 756c 6564 5f6f 626a 6563   scheduled_objec
+0000d540: 743d 6765 745f 6461 7461 5f66 756e 632c  t=get_data_func,
+0000d550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d560: 2063 726f 6e5f 7472 6967 6765 723d 7363   cron_trigger=sc
+0000d570: 6865 6d61 732e 5363 6865 6475 6c65 4372  hemas.ScheduleCr
+0000d580: 6f6e 5472 6967 6765 7228 6461 795f 6f66  onTrigger(day_of
+0000d590: 5f77 6565 6b3d 2774 7565 272c 2068 6f75  _week='tue', hou
+0000d5a0: 723d 3135 2c20 6d69 6e75 7465 3d33 3029  r=15, minute=30)
+0000d5b0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000d5c0: 2020 2020 2020 2020 2020 2020 6462 2e63              db.c
+0000d5d0: 7265 6174 655f 7363 6865 6475 6c65 2870  reate_schedule(p
+0000d5e0: 726f 6a65 6374 5f6e 616d 652c 2073 6368  roject_name, sch
+0000d5f0: 6564 756c 6529 0a20 2020 2020 2020 2022  edule).        "
+0000d600: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
+0000d610: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+0000d620: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+0000d630: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+0000d640: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0000d650: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
+0000d660: 6475 6c65 7322 0a0a 2020 2020 2020 2020  dules"..        
+0000d670: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0000d680: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+0000d690: 6720 7363 6865 6475 6c65 207b 7072 6f6a  g schedule {proj
+0000d6a0: 6563 747d 2f7b 7363 6865 6475 6c65 2e6e  ect}/{schedule.n
+0000d6b0: 616d 657d 220a 2020 2020 2020 2020 7365  ame}".        se
+0000d6c0: 6c66 2e61 7069 5f63 616c 6c28 2250 4f53  lf.api_call("POS
+0000d6d0: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
+0000d6e0: 6d65 7373 6167 652c 2062 6f64 793d 6469  message, body=di
+0000d6f0: 6374 5f74 6f5f 6a73 6f6e 2873 6368 6564  ct_to_json(sched
+0000d700: 756c 652e 6469 6374 2829 2929 0a0a 2020  ule.dict()))..  
+0000d710: 2020 6465 6620 7570 6461 7465 5f73 6368    def update_sch
+0000d720: 6564 756c 6528 0a20 2020 2020 2020 2073  edule(.        s
+0000d730: 656c 662c 2070 726f 6a65 6374 3a20 7374  elf, project: st
+0000d740: 722c 206e 616d 653a 2073 7472 2c20 7363  r, name: str, sc
+0000d750: 6865 6475 6c65 3a20 6d6c 7275 6e2e 636f  hedule: mlrun.co
+0000d760: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6368  mmon.schemas.Sch
+0000d770: 6564 756c 6555 7064 6174 650a 2020 2020  eduleUpdate.    
+0000d780: 293a 0a20 2020 2020 2020 2022 2222 5570  ):.        """Up
+0000d790: 6461 7465 2061 6e20 6578 6973 7469 6e67  date an existing
+0000d7a0: 2073 6368 6564 756c 652c 2072 6570 6c61   schedule, repla
+0000d7b0: 6365 2069 7420 7769 7468 2074 6865 2064  ce it with the d
+0000d7c0: 6574 6169 6c73 2063 6f6e 7461 696e 6564  etails contained
+0000d7d0: 2069 6e20 7468 6520 7363 6865 6475 6c65   in the schedule
+0000d7e0: 206f 626a 6563 742e 2222 220a 0a20 2020   object."""..   
+0000d7f0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+0000d800: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+0000d810: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+0000d820: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0000d830: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000d840: 6563 747d 2f73 6368 6564 756c 6573 2f7b  ect}/schedules/{
+0000d850: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
+0000d860: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0000d870: 6622 4661 696c 6564 2075 7064 6174 696e  f"Failed updatin
+0000d880: 6720 7363 6865 6475 6c65 207b 7072 6f6a  g schedule {proj
+0000d890: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
+0000d8a0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000d8b0: 6c6c 2822 5055 5422 2c20 7061 7468 2c20  ll("PUT", path, 
+0000d8c0: 6572 726f 725f 6d65 7373 6167 652c 2062  error_message, b
+0000d8d0: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+0000d8e0: 2873 6368 6564 756c 652e 6469 6374 2829  (schedule.dict()
+0000d8f0: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
+0000d900: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
+0000d910: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
+0000d920: 2073 7472 2c20 6e61 6d65 3a20 7374 722c   str, name: str,
+0000d930: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000d940: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 650a  n: bool = False.
+0000d950: 2020 2020 2920 2d3e 206d 6c72 756e 2e63      ) -> mlrun.c
+0000d960: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5363  ommon.schemas.Sc
+0000d970: 6865 6475 6c65 4f75 7470 7574 3a0a 2020  heduleOutput:.  
+0000d980: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+0000d990: 6520 6465 7461 696c 7320 6f66 2074 6865  e details of the
+0000d9a0: 2073 6368 6564 756c 6520 696e 2071 7565   schedule in que
+0000d9b0: 7374 696f 6e2e 2042 6573 6964 6573 2072  stion. Besides r
+0000d9c0: 6574 7572 6e69 6e67 2074 6865 2064 6574  eturning the det
+0000d9d0: 6169 6c73 206f 6620 7468 6520 7363 6865  ails of the sche
+0000d9e0: 6475 6c65 206f 626a 6563 7420 6974 7365  dule object itse
+0000d9f0: 6c66 2c0a 2020 2020 2020 2020 7468 6973  lf,.        this
+0000da00: 2066 756e 6374 696f 6e20 616c 736f 2072   function also r
+0000da10: 6574 7572 6e73 2074 6865 206e 6578 7420  eturns the next 
+0000da20: 7363 6865 6475 6c65 6420 7275 6e20 666f  scheduled run fo
+0000da30: 7220 7468 6973 2073 7065 6369 6669 6320  r this specific 
+0000da40: 7363 6865 6475 6c65 2c20 6173 2077 656c  schedule, as wel
+0000da50: 6c20 6173 2070 6f74 656e 7469 616c 6c79  l as potentially
+0000da60: 2074 6865 0a20 2020 2020 2020 2072 6573   the.        res
+0000da70: 756c 7473 206f 6620 7468 6520 6c61 7374  ults of the last
+0000da80: 2072 756e 2065 7865 6375 7465 6420 7468   run executed th
+0000da90: 726f 7567 6820 7468 6973 2073 6368 6564  rough this sched
+0000daa0: 756c 652e 0a0a 2020 2020 2020 2020 3a70  ule...        :p
+0000dab0: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
+0000dac0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
+0000dad0: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+0000dae0: 204e 616d 6520 6f66 2074 6865 2073 6368   Name of the sch
+0000daf0: 6564 756c 6520 6f62 6a65 6374 2074 6f20  edule object to 
+0000db00: 7175 6572 792e 0a20 2020 2020 2020 203a  query..        :
+0000db10: 7061 7261 6d20 696e 636c 7564 655f 6c61  param include_la
+0000db20: 7374 5f72 756e 3a20 5768 6574 6865 7220  st_run: Whether 
+0000db30: 746f 2069 6e63 6c75 6465 2074 6865 2072  to include the r
+0000db40: 6573 756c 7473 206f 6620 7468 6520 7363  esults of the sc
+0000db50: 6865 6475 6c65 2773 206c 6173 7420 7275  hedule's last ru
+0000db60: 6e20 696e 2074 6865 2072 6573 706f 6e73  n in the respons
+0000db70: 652e 0a20 2020 2020 2020 2022 2222 0a0a  e..        """..
+0000db80: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+0000db90: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+0000dba0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+0000dbb0: 6563 740a 2020 2020 2020 2020 7061 7468  ect.        path
+0000dbc0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0000dbd0: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
+0000dbe0: 732f 7b6e 616d 657d 220a 2020 2020 2020  s/{name}".      
+0000dbf0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+0000dc00: 3d20 6622 4661 696c 6564 2067 6574 7469  = f"Failed getti
+0000dc10: 6e67 2073 6368 6564 756c 6520 666f 7220  ng schedule for 
+0000dc20: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
+0000dc30: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
+0000dc40: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+0000dc50: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
+0000dc60: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
+0000dc70: 6573 7361 6765 2c20 7061 7261 6d73 3d7b  essage, params={
+0000dc80: 2269 6e63 6c75 6465 5f6c 6173 745f 7275  "include_last_ru
+0000dc90: 6e22 3a20 696e 636c 7564 655f 6c61 7374  n": include_last
+0000dca0: 5f72 756e 7d0a 2020 2020 2020 2020 290a  _run}.        ).
+0000dcb0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0000dcc0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000dcd0: 6d61 732e 5363 6865 6475 6c65 4f75 7470  mas.ScheduleOutp
+0000dce0: 7574 282a 2a72 6573 702e 6a73 6f6e 2829  ut(**resp.json()
+0000dcf0: 290a 0a20 2020 2064 6566 206c 6973 745f  )..    def list_
+0000dd00: 7363 6865 6475 6c65 7328 0a20 2020 2020  schedules(.     
+0000dd10: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000dd20: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0000dd30: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+0000dd40: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000dd50: 206b 696e 643a 206d 6c72 756e 2e63 6f6d   kind: mlrun.com
+0000dd60: 6d6f 6e2e 7363 6865 6d61 732e 5363 6865  mon.schemas.Sche
+0000dd70: 6475 6c65 4b69 6e64 7320 3d20 4e6f 6e65  duleKinds = None
+0000dd80: 2c0a 2020 2020 2020 2020 696e 636c 7564  ,.        includ
+0000dd90: 655f 6c61 7374 5f72 756e 3a20 626f 6f6c  e_last_run: bool
+0000dda0: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+0000ddb0: 2d3e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  -> mlrun.common.
+0000ddc0: 7363 6865 6d61 732e 5363 6865 6475 6c65  schemas.Schedule
+0000ddd0: 734f 7574 7075 743a 0a20 2020 2020 2020  sOutput:.       
+0000dde0: 2022 2222 5265 7472 6965 7665 206c 6973   """Retrieve lis
+0000ddf0: 7420 6f66 2073 6368 6564 756c 6573 206f  t of schedules o
+0000de00: 6620 7370 6563 6966 6963 206e 616d 6520  f specific name 
+0000de10: 6f72 206b 696e 642e 0a0a 2020 2020 2020  or kind...      
+0000de20: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+0000de30: 3a20 5072 6f6a 6563 7420 6e61 6d65 2e0a  : Project name..
+0000de40: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0000de50: 616d 653a 204e 616d 6520 6f66 2073 6368  ame: Name of sch
+0000de60: 6564 756c 6520 746f 2072 6574 7269 6576  edule to retriev
+0000de70: 652e 2043 616e 2062 6520 6f6d 6974 7465  e. Can be omitte
+0000de80: 6420 746f 206c 6973 7420 616c 6c20 7363  d to list all sc
+0000de90: 6865 6475 6c65 732e 0a20 2020 2020 2020  hedules..       
+0000dea0: 203a 7061 7261 6d20 6b69 6e64 3a20 4b69   :param kind: Ki
+0000deb0: 6e64 206f 6620 7363 6865 6475 6c65 206f  nd of schedule o
+0000dec0: 626a 6563 7473 2074 6f20 7265 7472 6965  bjects to retrie
+0000ded0: 7665 2c20 6361 6e20 6265 2065 6974 6865  ve, can be eithe
+0000dee0: 7220 6060 6a6f 6260 6020 6f72 2060 6070  r ``job`` or ``p
+0000def0: 6970 656c 696e 6560 602e 0a20 2020 2020  ipeline``..     
+0000df00: 2020 203a 7061 7261 6d20 696e 636c 7564     :param includ
+0000df10: 655f 6c61 7374 5f72 756e 3a20 5768 6574  e_last_run: Whet
+0000df20: 6865 7220 746f 2072 6574 7572 6e20 666f  her to return fo
+0000df30: 7220 6561 6368 2073 6368 6564 756c 6520  r each schedule 
+0000df40: 7265 7475 726e 6564 2061 6c73 6f20 7468  returned also th
+0000df50: 6520 7265 7375 6c74 7320 6f66 2074 6865  e results of the
+0000df60: 206c 6173 7420 7275 6e20 6f66 0a20 2020   last run of.   
+0000df70: 2020 2020 2020 2020 2074 6861 7420 7363           that sc
+0000df80: 6865 6475 6c65 2e0a 2020 2020 2020 2020  hedule..        
+0000df90: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+0000dfa0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+0000dfb0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+0000dfc0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+0000dfd0: 2070 6172 616d 7320 3d20 7b22 6b69 6e64   params = {"kind
+0000dfe0: 223a 206b 696e 642c 2022 6e61 6d65 223a  ": kind, "name":
+0000dff0: 206e 616d 652c 2022 696e 636c 7564 655f   name, "include_
+0000e000: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
+0000e010: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
+0000e020: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+0000e030: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0000e040: 2f73 6368 6564 756c 6573 220a 2020 2020  /schedules".    
+0000e050: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0000e060: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
+0000e070: 7469 6e67 2073 6368 6564 756c 6573 2066  ting schedules f
+0000e080: 6f72 207b 7072 6f6a 6563 747d 203f 207b  or {project} ? {
+0000e090: 6b69 6e64 7d20 7b6e 616d 657d 220a 2020  kind} {name}".  
+0000e0a0: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+0000e0b0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+0000e0c0: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+0000e0d0: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
+0000e0e0: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+0000e0f0: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+0000e100: 6e2e 7363 6865 6d61 732e 5363 6865 6475  n.schemas.Schedu
+0000e110: 6c65 734f 7574 7075 7428 2a2a 7265 7370  lesOutput(**resp
+0000e120: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0000e130: 6620 6465 6c65 7465 5f73 6368 6564 756c  f delete_schedul
+0000e140: 6528 7365 6c66 2c20 7072 6f6a 6563 743a  e(self, project:
+0000e150: 2073 7472 2c20 6e61 6d65 3a20 7374 7229   str, name: str)
+0000e160: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+0000e170: 6574 6520 6120 7370 6563 6966 6963 2073  ete a specific s
+0000e180: 6368 6564 756c 6520 6279 206e 616d 652e  chedule by name.
+0000e190: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+0000e1a0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+0000e1b0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+0000e1c0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+0000e1d0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0000e1e0: 7473 2f7b 7072 6f6a 6563 747d 2f73 6368  ts/{project}/sch
+0000e1f0: 6564 756c 6573 2f7b 6e61 6d65 7d22 0a20  edules/{name}". 
+0000e200: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000e210: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000e220: 6465 6c65 7469 6e67 2073 6368 6564 756c  deleting schedul
+0000e230: 6520 7b70 726f 6a65 6374 7d2f 7b6e 616d  e {project}/{nam
+0000e240: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+0000e250: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
+0000e260: 4522 2c20 7061 7468 2c20 6572 726f 725f  E", path, error_
+0000e270: 6d65 7373 6167 6529 0a0a 2020 2020 6465  message)..    de
+0000e280: 6620 696e 766f 6b65 5f73 6368 6564 756c  f invoke_schedul
+0000e290: 6528 7365 6c66 2c20 7072 6f6a 6563 743a  e(self, project:
+0000e2a0: 2073 7472 2c20 6e61 6d65 3a20 7374 7229   str, name: str)
+0000e2b0: 3a0a 2020 2020 2020 2020 2222 2245 7865  :.        """Exe
+0000e2c0: 6375 7465 2074 6865 206f 626a 6563 7420  cute the object 
+0000e2d0: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
+0000e2e0: 6520 7363 6865 6475 6c65 2069 6d6d 6564  e schedule immed
+0000e2f0: 6961 7465 6c79 2e22 2222 0a0a 2020 2020  iately."""..    
+0000e300: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000e310: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000e320: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000e330: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0000e340: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0000e350: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
+0000e360: 616d 657d 2f69 6e76 6f6b 6522 0a20 2020  ame}/invoke".   
+0000e370: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+0000e380: 6765 203d 2066 2246 6169 6c65 6420 696e  ge = f"Failed in
+0000e390: 766f 6b69 6e67 2073 6368 6564 756c 6520  voking schedule 
+0000e3a0: 7b70 726f 6a65 6374 7d2f 7b6e 616d 657d  {project}/{name}
+0000e3b0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+0000e3c0: 7069 5f63 616c 6c28 2250 4f53 5422 2c20  pi_call("POST", 
+0000e3d0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+0000e3e0: 6167 6529 0a0a 2020 2020 6465 6620 7265  age)..    def re
+0000e3f0: 6d6f 7465 5f62 7569 6c64 6572 280a 2020  mote_builder(.  
+0000e400: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000e410: 2020 2020 6675 6e63 3a20 4261 7365 5275      func: BaseRu
+0000e420: 6e74 696d 652c 0a20 2020 2020 2020 2077  ntime,.        w
+0000e430: 6974 685f 6d6c 7275 6e3a 2062 6f6f 6c2c  ith_mlrun: bool,
+0000e440: 0a20 2020 2020 2020 206d 6c72 756e 5f76  .        mlrun_v
+0000e450: 6572 7369 6f6e 5f73 7065 6369 6669 6572  ersion_specifier
+0000e460: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000e470: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000e480: 736b 6970 5f64 6570 6c6f 7965 643a 2062  skip_deployed: b
+0000e490: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+0000e4a0: 2020 2020 2062 7569 6c64 6572 5f65 6e76       builder_env
+0000e4b0: 3a20 4f70 7469 6f6e 616c 5b64 6963 745d  : Optional[dict]
+0000e4c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000e4d0: 2066 6f72 6365 5f62 7569 6c64 3a20 626f   force_build: bo
+0000e4e0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0000e4f0: 293a 0a20 2020 2020 2020 2022 2222 4275  ):.        """Bu
+0000e500: 696c 6420 7468 6520 706f 6420 696d 6167  ild the pod imag
+0000e510: 6520 666f 7220 6120 6675 6e63 7469 6f6e  e for a function
+0000e520: 2c20 666f 7220 6578 6563 7574 696f 6e20  , for execution 
+0000e530: 6f6e 2061 2072 656d 6f74 6520 636c 7573  on a remote clus
+0000e540: 7465 722e 2054 6869 7320 6973 2065 7865  ter. This is exe
+0000e550: 6375 7465 6420 6279 2074 6865 204d 4c52  cuted by the MLR
+0000e560: 756e 0a20 2020 2020 2020 2041 5049 2073  un.        API s
+0000e570: 6572 7665 722c 2061 6e64 2063 7265 6174  erver, and creat
+0000e580: 6573 2061 2044 6f63 6b65 7220 696d 6167  es a Docker imag
+0000e590: 6520 6f75 7420 6f66 2074 6865 2066 756e  e out of the fun
+0000e5a0: 6374 696f 6e20 7072 6f76 6964 6564 2061  ction provided a
+0000e5b0: 6e64 2061 6e79 2073 7065 6369 6669 6320  nd any specific 
+0000e5c0: 6275 696c 640a 2020 2020 2020 2020 696e  build.        in
+0000e5d0: 7374 7275 6374 696f 6e73 2070 726f 7669  structions provi
+0000e5e0: 6465 6420 7769 7468 696e 2e20 5468 6973  ded within. This
+0000e5f0: 2069 7320 6120 7072 652d 7265 7175 6973   is a pre-requis
+0000e600: 6974 6520 666f 7220 7265 6d6f 7465 6c79  ite for remotely
+0000e610: 2065 7865 6375 7469 6e67 2061 2066 756e   executing a fun
+0000e620: 6374 696f 6e2c 2075 6e6c 6573 7320 7573  ction, unless us
+0000e630: 696e 670a 2020 2020 2020 2020 6120 7072  ing.        a pr
+0000e640: 652d 6465 706c 6f79 6564 2069 6d61 6765  e-deployed image
+0000e650: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000e660: 6d20 6675 6e63 3a20 4675 6e63 7469 6f6e  m func: Function
+0000e670: 2074 6f20 6275 696c 642e 0a20 2020 2020   to build..     
+0000e680: 2020 203a 7061 7261 6d20 7769 7468 5f6d     :param with_m
+0000e690: 6c72 756e 3a20 5768 6574 6865 7220 746f  lrun: Whether to
+0000e6a0: 2061 6464 204d 4c52 756e 2070 6163 6b61   add MLRun packa
+0000e6b0: 6765 2074 6f20 7468 6520 6275 696c 7420  ge to the built 
+0000e6c0: 7061 636b 6167 652e 2054 6869 7320 6973  package. This is
+0000e6d0: 206e 6f74 2072 6571 7569 7265 6420 6966   not required if
+0000e6e0: 2075 7369 6e67 2061 2062 6173 650a 2020   using a base.  
+0000e6f0: 2020 2020 2020 2020 2020 696d 6167 6520            image 
+0000e700: 7468 6174 2061 6c72 6561 6479 2068 6173  that already has
+0000e710: 204d 4c52 756e 2069 6e20 6974 2e0a 2020   MLRun in it..  
+0000e720: 2020 2020 2020 3a70 6172 616d 206d 6c72        :param mlr
+0000e730: 756e 5f76 6572 7369 6f6e 5f73 7065 6369  un_version_speci
+0000e740: 6669 6572 3a20 5665 7273 696f 6e20 6f66  fier: Version of
+0000e750: 204d 4c52 756e 2074 6f20 696e 636c 7564   MLRun to includ
+0000e760: 6520 696e 2074 6865 2062 7569 6c74 2069  e in the built i
+0000e770: 6d61 6765 2e0a 2020 2020 2020 2020 3a70  mage..        :p
+0000e780: 6172 616d 2073 6b69 705f 6465 706c 6f79  aram skip_deploy
+0000e790: 6564 3a20 536b 6970 2074 6865 2062 7569  ed: Skip the bui
+0000e7a0: 6c64 2069 6620 7765 2061 6c72 6561 6479  ld if we already
+0000e7b0: 2068 6176 6520 616e 2069 6d61 6765 2066   have an image f
+0000e7c0: 6f72 2074 6865 2066 756e 6374 696f 6e2e  or the function.
+0000e7d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000e7e0: 6275 696c 6465 725f 656e 763a 2020 204b  builder_env:   K
+0000e7f0: 616e 696b 6f20 6275 696c 6465 7220 706f  aniko builder po
+0000e800: 6420 656e 7620 7661 7273 2064 6963 7420  d env vars dict 
+0000e810: 2866 6f72 2063 6f6e 6669 672f 6372 6564  (for config/cred
+0000e820: 656e 7469 616c 7329 0a20 2020 2020 2020  entials).       
+0000e830: 203a 7061 7261 6d20 666f 7263 655f 6275   :param force_bu
+0000e840: 696c 643a 2020 2046 6f72 6365 2062 7569  ild:   Force bui
+0000e850: 6c64 696e 6720 7468 6520 696d 6167 652c  lding the image,
+0000e860: 2065 7665 6e20 7768 656e 206e 6f20 6368   even when no ch
+0000e870: 616e 6765 7320 7765 7265 206d 6164 650a  anges were made.
+0000e880: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000e890: 2020 2020 7365 6c66 2e77 6172 6e5f 6f6e      self.warn_on
+0000e8a0: 5f73 335f 616e 645f 6563 725f 7065 726d  _s3_and_ecr_perm
+0000e8b0: 6973 7369 6f6e 735f 636f 6e66 6c69 6374  issions_conflict
+0000e8c0: 2866 756e 6329 0a20 2020 2020 2020 2074  (func).        t
+0000e8d0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0000e8e0: 7265 7120 3d20 7b0a 2020 2020 2020 2020  req = {.        
+0000e8f0: 2020 2020 2020 2020 2266 756e 6374 696f          "functio
+0000e900: 6e22 3a20 6675 6e63 2e74 6f5f 6469 6374  n": func.to_dict
+0000e910: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0000e920: 2020 2020 2277 6974 685f 6d6c 7275 6e22      "with_mlrun"
+0000e930: 3a20 626f 6f6c 3273 7472 2877 6974 685f  : bool2str(with_
+0000e940: 6d6c 7275 6e29 2c0a 2020 2020 2020 2020  mlrun),.        
+0000e950: 2020 2020 2020 2020 2273 6b69 705f 6465          "skip_de
+0000e960: 706c 6f79 6564 223a 2073 6b69 705f 6465  ployed": skip_de
+0000e970: 706c 6f79 6564 2c0a 2020 2020 2020 2020  ployed,.        
+0000e980: 2020 2020 2020 2020 2266 6f72 6365 5f62          "force_b
+0000e990: 7569 6c64 223a 2066 6f72 6365 5f62 7569  uild": force_bui
+0000e9a0: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
+0000e9b0: 7d0a 2020 2020 2020 2020 2020 2020 6966  }.            if
+0000e9c0: 206d 6c72 756e 5f76 6572 7369 6f6e 5f73   mlrun_version_s
+0000e9d0: 7065 6369 6669 6572 3a0a 2020 2020 2020  pecifier:.      
+0000e9e0: 2020 2020 2020 2020 2020 7265 715b 226d            req["m
+0000e9f0: 6c72 756e 5f76 6572 7369 6f6e 5f73 7065  lrun_version_spe
+0000ea00: 6369 6669 6572 225d 203d 206d 6c72 756e  cifier"] = mlrun
+0000ea10: 5f76 6572 7369 6f6e 5f73 7065 6369 6669  _version_specifi
+0000ea20: 6572 0a20 2020 2020 2020 2020 2020 2069  er.            i
+0000ea30: 6620 6275 696c 6465 725f 656e 763a 0a20  f builder_env:. 
+0000ea40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000ea50: 6571 5b22 6275 696c 6465 725f 656e 7622  eq["builder_env"
+0000ea60: 5d20 3d20 6275 696c 6465 725f 656e 760a  ] = builder_env.
+0000ea70: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+0000ea80: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+0000ea90: 2822 504f 5354 222c 2022 6275 696c 642f  ("POST", "build/
+0000eaa0: 6675 6e63 7469 6f6e 222c 206a 736f 6e3d  function", json=
+0000eab0: 7265 7129 0a20 2020 2020 2020 2065 7863  req).        exc
+0000eac0: 6570 7420 4f53 4572 726f 7220 6173 2065  ept OSError as e
+0000ead0: 7272 3a0a 2020 2020 2020 2020 2020 2020  rr:.            
+0000eae0: 6c6f 6767 6572 2e65 7272 6f72 2866 2265  logger.error(f"e
+0000eaf0: 7272 6f72 2073 7562 6d69 7474 696e 6720  rror submitting 
+0000eb00: 6275 696c 6420 7461 736b 3a20 7b65 7272  build task: {err
+0000eb10: 5f74 6f5f 7374 7228 6572 7229 7d22 290a  _to_str(err)}").
+0000eb20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000eb30: 6520 4f53 4572 726f 7228 6622 6572 726f  e OSError(f"erro
+0000eb40: 723a 2063 616e 6e6f 7420 7375 626d 6974  r: cannot submit
+0000eb50: 2062 7569 6c64 2c20 7b65 7272 5f74 6f5f   build, {err_to_
+0000eb60: 7374 7228 6572 7229 7d22 290a 0a20 2020  str(err)}")..   
+0000eb70: 2020 2020 2069 6620 6e6f 7420 7265 7370       if not resp
+0000eb80: 2e6f 6b3a 0a20 2020 2020 2020 2020 2020  .ok:.           
+0000eb90: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+0000eba0: 6261 6420 7265 7370 2121 5c6e 7b72 6573  bad resp!!\n{res
+0000ebb0: 702e 7465 7874 7d22 290a 2020 2020 2020  p.text}").      
+0000ebc0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000ebd0: 6545 7272 6f72 2822 6261 6420 7375 626d  eError("bad subm
+0000ebe0: 6974 2062 7569 6c64 2072 6573 706f 6e73  it build respons
+0000ebf0: 6522 290a 0a20 2020 2020 2020 2072 6574  e")..        ret
+0000ec00: 7572 6e20 7265 7370 2e6a 736f 6e28 290a  urn resp.json().
+0000ec10: 0a20 2020 2064 6566 2064 6570 6c6f 795f  .    def deploy_
+0000ec20: 6e75 636c 696f 5f66 756e 6374 696f 6e28  nuclio_function(
+0000ec30: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000ec40: 2020 2020 2020 2066 756e 633a 206d 6c72         func: mlr
+0000ec50: 756e 2e72 756e 7469 6d65 732e 5265 6d6f  un.runtimes.Remo
+0000ec60: 7465 5275 6e74 696d 652c 0a20 2020 2020  teRuntime,.     
+0000ec70: 2020 2062 7569 6c64 6572 5f65 6e76 3a20     builder_env: 
+0000ec80: 4f70 7469 6f6e 616c 5b64 6963 745d 203d  Optional[dict] =
+0000ec90: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
+0000eca0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000ecb0: 2020 4465 706c 6f79 2061 204e 7563 6c69    Deploy a Nucli
+0000ecc0: 6f20 6675 6e63 7469 6f6e 2e0a 2020 2020  o function..    
+0000ecd0: 2020 2020 3a70 6172 616d 2066 756e 633a      :param func:
+0000ece0: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
+0000ecf0: 7469 6f6e 2074 6f20 6275 696c 642e 0a20  tion to build.. 
+0000ed00: 2020 2020 2020 203a 7061 7261 6d20 6275         :param bu
+0000ed10: 696c 6465 725f 656e 763a 2020 2020 204b  ilder_env:     K
+0000ed20: 616e 696b 6f20 6275 696c 6465 7220 706f  aniko builder po
+0000ed30: 6420 656e 7620 7661 7273 2064 6963 7420  d env vars dict 
+0000ed40: 2866 6f72 2063 6f6e 6669 672f 6372 6564  (for config/cred
+0000ed50: 656e 7469 616c 7329 0a20 2020 2020 2020  entials).       
+0000ed60: 2022 2222 0a20 2020 2020 2020 2066 756e   """.        fun
+0000ed70: 632e 6d65 7461 6461 7461 2e70 726f 6a65  c.metadata.proje
+0000ed80: 6374 203d 2066 756e 632e 6d65 7461 6461  ct = func.metada
+0000ed90: 7461 2e70 726f 6a65 6374 206f 7220 636f  ta.project or co
+0000eda0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+0000edb0: 6a65 6374 0a20 2020 2020 2020 2073 656c  ject.        sel
+0000edc0: 662e 7761 726e 5f6f 6e5f 7333 5f61 6e64  f.warn_on_s3_and
+0000edd0: 5f65 6372 5f70 6572 6d69 7373 696f 6e73  _ecr_permissions
+0000ede0: 5f63 6f6e 666c 6963 7428 6675 6e63 290a  _conflict(func).
+0000edf0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0000ee00: 2020 2020 2020 2020 2072 6571 203d 207b           req = {
+0000ee10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ee20: 2022 6675 6e63 7469 6f6e 223a 2066 756e   "function": fun
+0000ee30: 632e 746f 5f64 6963 7428 292c 0a20 2020  c.to_dict(),.   
+0000ee40: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0000ee50: 2020 2020 2020 2069 6620 6275 696c 6465         if builde
+0000ee60: 725f 656e 763a 0a20 2020 2020 2020 2020  r_env:.         
+0000ee70: 2020 2020 2020 2072 6571 5b22 6275 696c         req["buil
+0000ee80: 6465 725f 656e 7622 5d20 3d20 6275 696c  der_env"] = buil
+0000ee90: 6465 725f 656e 760a 2020 2020 2020 2020  der_env.        
+0000eea0: 2020 2020 5f70 6174 6820 3d20 280a 2020      _path = (.  
+0000eeb0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000eec0: 7072 6f6a 6563 7473 2f7b 6675 6e63 2e6d  projects/{func.m
+0000eed0: 6574 6164 6174 612e 7072 6f6a 6563 747d  etadata.project}
+0000eee0: 2f6e 7563 6c69 6f2f 7b66 756e 632e 6d65  /nuclio/{func.me
+0000eef0: 7461 6461 7461 2e6e 616d 657d 2f64 6570  tadata.name}/dep
+0000ef00: 6c6f 7922 0a20 2020 2020 2020 2020 2020  loy".           
+0000ef10: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0000ef20: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+0000ef30: 616c 6c28 2250 4f53 5422 2c20 5f70 6174  all("POST", _pat
+0000ef40: 682c 206a 736f 6e3d 7265 7129 0a20 2020  h, json=req).   
+0000ef50: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
+0000ef60: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
+0000ef70: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000ef80: 7272 6f72 2866 2265 7272 6f72 2073 7562  rror(f"error sub
+0000ef90: 6d69 7474 696e 6720 6e75 636c 696f 2064  mitting nuclio d
+0000efa0: 6570 6c6f 7920 7461 736b 3a20 7b65 7272  eploy task: {err
+0000efb0: 5f74 6f5f 7374 7228 6572 7229 7d22 290a  _to_str(err)}").
+0000efc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000efd0: 6520 4f53 4572 726f 7228 6622 6572 726f  e OSError(f"erro
+0000efe0: 723a 2063 616e 6e6f 7420 7375 626d 6974  r: cannot submit
+0000eff0: 2064 6570 6c6f 792c 207b 6572 725f 746f   deploy, {err_to
+0000f000: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
+0000f010: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+0000f020: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
+0000f030: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
+0000f040: 2264 6570 6c6f 7920 6e75 636c 696f 202d  "deploy nuclio -
+0000f050: 2062 6164 2072 6573 706f 6e73 653a 5c6e   bad response:\n
+0000f060: 7b72 6573 702e 7465 7874 7d22 290a 2020  {resp.text}").  
+0000f070: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000f080: 5661 6c75 6545 7272 6f72 2822 6261 6420  ValueError("bad 
+0000f090: 6e75 636c 696f 2064 6570 6c6f 7920 7265  nuclio deploy re
+0000f0a0: 7370 6f6e 7365 2229 0a0a 2020 2020 2020  sponse")..      
+0000f0b0: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+0000f0c0: 6f6e 2829 0a0a 2020 2020 6465 6620 6765  on()..    def ge
+0000f0d0: 745f 6e75 636c 696f 5f64 6570 6c6f 795f  t_nuclio_deploy_
+0000f0e0: 7374 6174 7573 280a 2020 2020 2020 2020  status(.        
+0000f0f0: 7365 6c66 2c0a 2020 2020 2020 2020 6675  self,.        fu
+0000f100: 6e63 3a20 6d6c 7275 6e2e 7275 6e74 696d  nc: mlrun.runtim
+0000f110: 6573 2e52 656d 6f74 6552 756e 7469 6d65  es.RemoteRuntime
+0000f120: 2c0a 2020 2020 2020 2020 6c61 7374 5f6c  ,.        last_l
+0000f130: 6f67 5f74 696d 6573 7461 6d70 3a20 666c  og_timestamp: fl
+0000f140: 6f61 7420 3d20 302e 302c 0a20 2020 2020  oat = 0.0,.     
+0000f150: 2020 2076 6572 626f 7365 3a20 626f 6f6c     verbose: bool
+0000f160: 203d 2046 616c 7365 2c0a 2020 2020 293a   = False,.    ):
+0000f170: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+0000f180: 6965 7665 2074 6865 2073 7461 7475 7320  ieve the status 
+0000f190: 6f66 2061 2064 6570 6c6f 7920 6f70 6572  of a deploy oper
+0000f1a0: 6174 696f 6e20 6375 7272 656e 746c 7920  ation currently 
+0000f1b0: 696e 2070 726f 6772 6573 732e 0a0a 2020  in progress...  
+0000f1c0: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0000f1d0: 633a 2020 2020 2020 2020 2020 2020 2020  c:              
+0000f1e0: 2020 4675 6e63 7469 6f6e 206f 626a 6563    Function objec
+0000f1f0: 7420 7468 6174 2069 7320 6265 696e 6720  t that is being 
+0000f200: 6275 696c 742e 0a20 2020 2020 2020 203a  built..        :
+0000f210: 7061 7261 6d20 6c61 7374 5f6c 6f67 5f74  param last_log_t
+0000f220: 696d 6573 7461 6d70 3a20 204c 6173 7420  imestamp:  Last 
+0000f230: 7469 6d65 7374 616d 7020 6f66 206c 6f67  timestamp of log
+0000f240: 7320 7468 6174 2077 6572 6520 616c 7265  s that were alre
+0000f250: 6164 7920 7265 7472 6965 7665 642e 2046  ady retrieved. F
+0000f260: 756e 6374 696f 6e20 7769 6c6c 2072 6574  unction will ret
+0000f270: 7572 6e20 6f6e 6c79 206c 6f67 730a 2020  urn only logs.  
+0000f280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2a0: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
+0000f2b0: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
+0000f2c0: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
+0000f2d0: 6f73 653a 2020 2020 2020 2020 2020 2020  ose:            
+0000f2e0: 2041 6464 2076 6572 626f 7365 206c 6f67   Add verbose log
+0000f2f0: 7320 696e 746f 2074 6865 206f 7574 7075  s into the outpu
+0000f300: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
+0000f310: 7572 6e73 3a20 5468 6520 666f 6c6c 6f77  urns: The follow
+0000f320: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
+0000f330: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+0000f340: 6578 7420 6f66 2062 7569 6c64 6572 206c  ext of builder l
+0000f350: 6f67 732e 0a20 2020 2020 2020 2020 2020  ogs..           
+0000f360: 202d 2054 696d 6573 7461 6d70 206f 6620   - Timestamp of 
+0000f370: 6c61 7374 206c 6f67 2072 6574 7269 6576  last log retriev
+0000f380: 6564 2c20 746f 2062 6520 7573 6564 2069  ed, to be used i
+0000f390: 6e20 7375 6273 6571 7565 6e74 2063 616c  n subsequent cal
+0000f3a0: 6c73 2074 6f20 7468 6973 2066 756e 6374  ls to this funct
+0000f3b0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
+0000f3c0: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+0000f3d0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0000f3e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0000f3f0: 2020 2020 2020 226e 616d 6522 3a20 6e6f        "name": no
+0000f400: 726d 616c 697a 655f 6e61 6d65 2866 756e  rmalize_name(fun
+0000f410: 632e 6d65 7461 6461 7461 2e6e 616d 6529  c.metadata.name)
+0000f420: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f430: 2020 2270 726f 6a65 6374 223a 2066 756e    "project": fun
+0000f440: 632e 6d65 7461 6461 7461 2e70 726f 6a65  c.metadata.proje
+0000f450: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+0000f460: 2020 2020 2274 6167 223a 2066 756e 632e      "tag": func.
+0000f470: 6d65 7461 6461 7461 2e74 6167 2c0a 2020  metadata.tag,.  
+0000f480: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0000f490: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
+0000f4a0: 7022 3a20 7374 7228 6c61 7374 5f6c 6f67  p": str(last_log
+0000f4b0: 5f74 696d 6573 7461 6d70 292c 0a20 2020  _timestamp),.   
+0000f4c0: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
+0000f4d0: 7262 6f73 6522 3a20 626f 6f6c 3273 7472  rbose": bool2str
+0000f4e0: 2876 6572 626f 7365 292c 0a20 2020 2020  (verbose),.     
+0000f4f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0000f500: 2020 2020 205f 7061 7468 203d 2028 0a20       _path = (. 
+0000f510: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f520: 2270 726f 6a65 6374 732f 7b66 756e 632e  "projects/{func.
+0000f530: 6d65 7461 6461 7461 2e70 726f 6a65 6374  metadata.project
+0000f540: 7d2f 6e75 636c 696f 2f7b 6675 6e63 2e6d  }/nuclio/{func.m
+0000f550: 6574 6164 6174 612e 6e61 6d65 7d2f 6465  etadata.name}/de
+0000f560: 706c 6f79 220a 2020 2020 2020 2020 2020  ploy".          
+0000f570: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000f580: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+0000f590: 6361 6c6c 2822 4745 5422 2c20 5f70 6174  call("GET", _pat
+0000f5a0: 682c 2070 6172 616d 733d 7061 7261 6d73  h, params=params
+0000f5b0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0000f5c0: 204f 5345 7272 6f72 2061 7320 6572 723a   OSError as err:
+0000f5d0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+0000f5e0: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
+0000f5f0: 7220 6765 7474 696e 6720 6465 706c 6f79  r getting deploy
+0000f600: 2073 7461 7475 733a 207b 6572 725f 746f   status: {err_to
+0000f610: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
+0000f620: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
+0000f630: 5345 7272 6f72 2866 2265 7272 6f72 3a20  SError(f"error: 
+0000f640: 6361 6e6e 6f74 2067 6574 2064 6570 6c6f  cannot get deplo
+0000f650: 7920 7374 6174 7573 2c20 7b65 7272 5f74  y status, {err_t
+0000f660: 6f5f 7374 7228 6572 7229 7d22 290a 0a20  o_str(err)}").. 
+0000f670: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
+0000f680: 7370 2e6f 6b3a 0a20 2020 2020 2020 2020  sp.ok:.         
+0000f690: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
+0000f6a0: 6728 6622 6661 696c 6564 2072 6573 702c  g(f"failed resp,
+0000f6b0: 207b 7265 7370 2e74 6578 747d 2229 0a20   {resp.text}"). 
+0000f6c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000f6d0: 2052 756e 4442 4572 726f 7228 2262 6164   RunDBError("bad
+0000f6e0: 2066 756e 6374 696f 6e20 6275 696c 6420   function build 
+0000f6f0: 7265 7370 6f6e 7365 2229 0a0a 2020 2020  response")..    
+0000f700: 2020 2020 6966 2072 6573 702e 6865 6164      if resp.head
+0000f710: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
+0000f720: 2066 756e 632e 7374 6174 7573 2e73 7461   func.status.sta
+0000f730: 7465 203d 2072 6573 702e 6865 6164 6572  te = resp.header
+0000f740: 732e 6765 7428 2278 2d6d 6c72 756e 2d66  s.get("x-mlrun-f
+0000f750: 756e 6374 696f 6e2d 7374 6174 7573 222c  unction-status",
+0000f760: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
+0000f770: 206c 6173 745f 6c6f 675f 7469 6d65 7374   last_log_timest
+0000f780: 616d 7020 3d20 666c 6f61 7428 0a20 2020  amp = float(.   
+0000f790: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000f7a0: 702e 6865 6164 6572 732e 6765 7428 2278  p.headers.get("x
+0000f7b0: 2d6d 6c72 756e 2d6c 6173 742d 7469 6d65  -mlrun-last-time
+0000f7c0: 7374 616d 7022 2c20 2230 2e30 2229 0a20  stamp", "0.0"). 
+0000f7d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000f7e0: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
+0000f7f0: 6174 7573 2e61 6464 7265 7373 203d 2072  atus.address = r
+0000f800: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
+0000f810: 2278 2d6d 6c72 756e 2d61 6464 7265 7373  "x-mlrun-address
+0000f820: 222c 2022 2229 0a20 2020 2020 2020 2020  ", "").         
+0000f830: 2020 2066 756e 632e 7374 6174 7573 2e6e     func.status.n
+0000f840: 7563 6c69 6f5f 6e61 6d65 203d 2072 6573  uclio_name = res
+0000f850: 702e 6865 6164 6572 732e 6765 7428 2278  p.headers.get("x
+0000f860: 2d6d 6c72 756e 2d6e 616d 6522 2c20 2222  -mlrun-name", ""
+0000f870: 290a 2020 2020 2020 2020 2020 2020 6675  ).            fu
+0000f880: 6e63 2e73 7461 7475 732e 696e 7465 726e  nc.status.intern
+0000f890: 616c 5f69 6e76 6f63 6174 696f 6e5f 7572  al_invocation_ur
+0000f8a0: 6c73 203d 2072 6573 702e 6865 6164 6572  ls = resp.header
+0000f8b0: 732e 6765 7428 0a20 2020 2020 2020 2020  s.get(.         
+0000f8c0: 2020 2020 2020 2022 782d 6d6c 7275 6e2d         "x-mlrun-
+0000f8d0: 696e 7465 726e 616c 2d69 6e76 6f63 6174  internal-invocat
+0000f8e0: 696f 6e2d 7572 6c73 222c 2022 220a 2020  ion-urls", "".  
+0000f8f0: 2020 2020 2020 2020 2020 292e 7370 6c69            ).spli
+0000f900: 7428 222c 2229 0a20 2020 2020 2020 2020  t(",").         
+0000f910: 2020 2066 756e 632e 7374 6174 7573 2e65     func.status.e
+0000f920: 7874 6572 6e61 6c5f 696e 766f 6361 7469  xternal_invocati
+0000f930: 6f6e 5f75 726c 7320 3d20 7265 7370 2e68  on_urls = resp.h
+0000f940: 6561 6465 7273 2e67 6574 280a 2020 2020  eaders.get(.    
+0000f950: 2020 2020 2020 2020 2020 2020 2278 2d6d              "x-m
+0000f960: 6c72 756e 2d65 7874 6572 6e61 6c2d 696e  lrun-external-in
+0000f970: 766f 6361 7469 6f6e 2d75 726c 7322 2c20  vocation-urls", 
+0000f980: 2222 0a20 2020 2020 2020 2020 2020 2029  "".            )
+0000f990: 2e73 706c 6974 2822 2c22 290a 2020 2020  .split(",").    
+0000f9a0: 2020 2020 2020 2020 6675 6e63 2e73 7461          func.sta
+0000f9b0: 7475 732e 636f 6e74 6169 6e65 725f 696d  tus.container_im
+0000f9c0: 6167 6520 3d20 7265 7370 2e68 6561 6465  age = resp.heade
+0000f9d0: 7273 2e67 6574 280a 2020 2020 2020 2020  rs.get(.        
+0000f9e0: 2020 2020 2020 2020 2278 2d6d 6c72 756e          "x-mlrun
+0000f9f0: 2d63 6f6e 7461 696e 6572 2d69 6d61 6765  -container-image
+0000fa00: 222c 2022 220a 2020 2020 2020 2020 2020  ", "".          
+0000fa10: 2020 290a 0a20 2020 2020 2020 2074 6578    )..        tex
+0000fa20: 7420 3d20 2222 0a20 2020 2020 2020 2069  t = "".        i
+0000fa30: 6620 7265 7370 2e63 6f6e 7465 6e74 3a0a  f resp.content:.
+0000fa40: 2020 2020 2020 2020 2020 2020 7465 7874              text
+0000fa50: 203d 2072 6573 702e 636f 6e74 656e 742e   = resp.content.
+0000fa60: 6465 636f 6465 2829 0a20 2020 2020 2020  decode().       
+0000fa70: 2072 6574 7572 6e20 7465 7874 2c20 6c61   return text, la
+0000fa80: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
+0000fa90: 0a0a 2020 2020 6465 6620 6765 745f 6275  ..    def get_bu
+0000faa0: 696c 6465 725f 7374 6174 7573 280a 2020  ilder_status(.  
+0000fab0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000fac0: 2020 2020 6675 6e63 3a20 4261 7365 5275      func: BaseRu
+0000fad0: 6e74 696d 652c 0a20 2020 2020 2020 206f  ntime,.        o
+0000fae0: 6666 7365 743a 2069 6e74 203d 2030 2c0a  ffset: int = 0,.
+0000faf0: 2020 2020 2020 2020 6c6f 6773 3a20 626f          logs: bo
+0000fb00: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
+0000fb10: 2020 206c 6173 745f 6c6f 675f 7469 6d65     last_log_time
+0000fb20: 7374 616d 703a 2066 6c6f 6174 203d 2030  stamp: float = 0
+0000fb30: 2e30 2c0a 2020 2020 2020 2020 7665 7262  .0,.        verb
+0000fb40: 6f73 653a 2062 6f6f 6c20 3d20 4661 6c73  ose: bool = Fals
+0000fb50: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0000fb60: 2020 2222 2252 6574 7269 6576 6520 7468    """Retrieve th
+0000fb70: 6520 7374 6174 7573 206f 6620 6120 6275  e status of a bu
+0000fb80: 696c 6420 6f70 6572 6174 696f 6e20 6375  ild operation cu
+0000fb90: 7272 656e 746c 7920 696e 2070 726f 6772  rrently in progr
+0000fba0: 6573 732e 0a0a 2020 2020 2020 2020 3a70  ess...        :p
+0000fbb0: 6172 616d 2066 756e 633a 2020 2020 2020  aram func:      
+0000fbc0: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
+0000fbd0: 6f6e 206f 626a 6563 7420 7468 6174 2069  on object that i
+0000fbe0: 7320 6265 696e 6720 6275 696c 742e 0a20  s being built.. 
+0000fbf0: 2020 2020 2020 203a 7061 7261 6d20 6f66         :param of
+0000fc00: 6673 6574 3a20 2020 2020 2020 2020 2020  fset:           
+0000fc10: 2020 204f 6666 7365 7420 696e 746f 2074     Offset into t
+0000fc20: 6865 2062 7569 6c64 206c 6f67 7320 746f  he build logs to
+0000fc30: 2072 6574 7269 6576 6520 6c6f 6773 2066   retrieve logs f
+0000fc40: 726f 6d2e 0a20 2020 2020 2020 203a 7061  rom..        :pa
+0000fc50: 7261 6d20 6c6f 6773 3a20 2020 2020 2020  ram logs:       
+0000fc60: 2020 2020 2020 2020 2053 686f 756c 6420           Should 
+0000fc70: 6275 696c 6420 6c6f 6773 2062 6520 7265  build logs be re
+0000fc80: 7472 6965 7665 642e 0a20 2020 2020 2020  trieved..       
+0000fc90: 203a 7061 7261 6d20 6c61 7374 5f6c 6f67   :param last_log
+0000fca0: 5f74 696d 6573 7461 6d70 3a20 204c 6173  _timestamp:  Las
+0000fcb0: 7420 7469 6d65 7374 616d 7020 6f66 206c  t timestamp of l
+0000fcc0: 6f67 7320 7468 6174 2077 6572 6520 616c  ogs that were al
+0000fcd0: 7265 6164 7920 7265 7472 6965 7665 642e  ready retrieved.
+0000fce0: 2046 756e 6374 696f 6e20 7769 6c6c 2072   Function will r
+0000fcf0: 6574 7572 6e20 6f6e 6c79 206c 6f67 730a  eturn only logs.
+0000fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd20: 2020 2020 6c61 7465 7220 7468 616e 2074      later than t
+0000fd30: 6869 7320 7061 7261 6d65 7465 722e 0a20  his parameter.. 
+0000fd40: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+0000fd50: 7262 6f73 653a 2020 2020 2020 2020 2020  rbose:          
+0000fd60: 2020 2041 6464 2076 6572 626f 7365 206c     Add verbose l
+0000fd70: 6f67 7320 696e 746f 2074 6865 206f 7574  ogs into the out
+0000fd80: 7075 742e 0a0a 2020 2020 2020 2020 3a72  put...        :r
+0000fd90: 6574 7572 6e73 3a20 5468 6520 666f 6c6c  eturns: The foll
+0000fda0: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
+0000fdb0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+0000fdc0: 2054 6578 7420 6f66 2062 7569 6c64 6572   Text of builder
+0000fdd0: 206c 6f67 732e 0a20 2020 2020 2020 2020   logs..         
+0000fde0: 2020 202d 2054 696d 6573 7461 6d70 206f     - Timestamp o
+0000fdf0: 6620 6c61 7374 206c 6f67 2072 6574 7269  f last log retri
+0000fe00: 6576 6564 2c20 746f 2062 6520 7573 6564  eved, to be used
+0000fe10: 2069 6e20 7375 6273 6571 7565 6e74 2063   in subsequent c
+0000fe20: 616c 6c73 2074 6f20 7468 6973 2066 756e  alls to this fun
+0000fe30: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+0000fe40: 2020 2020 5468 6520 6675 6e63 7469 6f6e      The function
+0000fe50: 2061 6c73 6f20 7570 6461 7465 7320 696e   also updates in
+0000fe60: 7465 726e 616c 206d 656d 6265 7273 206f  ternal members o
+0000fe70: 6620 7468 6520 6060 6675 6e63 6060 206f  f the ``func`` o
+0000fe80: 626a 6563 7420 746f 2072 6566 6c65 6374  bject to reflect
+0000fe90: 2062 7569 6c64 2070 726f 6365 7373 2069   build process i
+0000fea0: 6e66 6f2e 0a20 2020 2020 2020 2022 2222  nfo..        """
+0000feb0: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+0000fec0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0000fed0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+0000fee0: 2020 2020 2020 226e 616d 6522 3a20 6e6f        "name": no
+0000fef0: 726d 616c 697a 655f 6e61 6d65 2866 756e  rmalize_name(fun
+0000ff00: 632e 6d65 7461 6461 7461 2e6e 616d 6529  c.metadata.name)
+0000ff10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ff20: 2020 2270 726f 6a65 6374 223a 2066 756e    "project": fun
+0000ff30: 632e 6d65 7461 6461 7461 2e70 726f 6a65  c.metadata.proje
+0000ff40: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+0000ff50: 2020 2020 2274 6167 223a 2066 756e 632e      "tag": func.
+0000ff60: 6d65 7461 6461 7461 2e74 6167 2c0a 2020  metadata.tag,.  
+0000ff70: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0000ff80: 6f67 7322 3a20 626f 6f6c 3273 7472 286c  ogs": bool2str(l
+0000ff90: 6f67 7329 2c0a 2020 2020 2020 2020 2020  ogs),.          
+0000ffa0: 2020 2020 2020 226f 6666 7365 7422 3a20        "offset": 
+0000ffb0: 7374 7228 6f66 6673 6574 292c 0a20 2020  str(offset),.   
+0000ffc0: 2020 2020 2020 2020 2020 2020 2022 6c61               "la
+0000ffd0: 7374 5f6c 6f67 5f74 696d 6573 7461 6d70  st_log_timestamp
+0000ffe0: 223a 2073 7472 286c 6173 745f 6c6f 675f  ": str(last_log_
+0000fff0: 7469 6d65 7374 616d 7029 2c0a 2020 2020  timestamp),.    
+00010000: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+00010010: 626f 7365 223a 2062 6f6f 6c32 7374 7228  bose": bool2str(
+00010020: 7665 7262 6f73 6529 2c0a 2020 2020 2020  verbose),.      
+00010030: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00010040: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+00010050: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
+00010060: 2262 7569 6c64 2f73 7461 7475 7322 2c20  "build/status", 
+00010070: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
+00010080: 2020 2020 2020 2065 7863 6570 7420 4f53         except OS
+00010090: 4572 726f 7220 6173 2065 7272 3a0a 2020  Error as err:.  
+000100a0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+000100b0: 2e65 7272 6f72 2866 2265 7272 6f72 2067  .error(f"error g
+000100c0: 6574 7469 6e67 2062 7569 6c64 2073 7461  etting build sta
+000100d0: 7475 733a 207b 6572 725f 746f 5f73 7472  tus: {err_to_str
+000100e0: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
+000100f0: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
+00010100: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
+00010110: 6f74 2067 6574 2062 7569 6c64 2073 7461  ot get build sta
+00010120: 7475 732c 207b 6572 725f 746f 5f73 7472  tus, {err_to_str
+00010130: 2865 7272 297d 2229 0a0a 2020 2020 2020  (err)}")..      
+00010140: 2020 6966 206e 6f74 2072 6573 702e 6f6b    if not resp.ok
+00010150: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+00010160: 6767 6572 2e77 6172 6e69 6e67 2866 2266  gger.warning(f"f
+00010170: 6169 6c65 6420 7265 7370 2c20 7b72 6573  ailed resp, {res
+00010180: 702e 7465 7874 7d22 290a 2020 2020 2020  p.text}").      
+00010190: 2020 2020 2020 7261 6973 6520 5275 6e44        raise RunD
+000101a0: 4245 7272 6f72 2822 6261 6420 6675 6e63  BError("bad func
+000101b0: 7469 6f6e 2062 7569 6c64 2072 6573 706f  tion build respo
+000101c0: 6e73 6522 290a 0a20 2020 2020 2020 2069  nse")..        i
+000101d0: 6620 7265 7370 2e68 6561 6465 7273 3a0a  f resp.headers:.
+000101e0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+000101f0: 2e73 7461 7475 732e 7374 6174 6520 3d20  .status.state = 
+00010200: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
+00010210: 2822 782d 6d6c 7275 6e2d 6675 6e63 7469  ("x-mlrun-functi
+00010220: 6f6e 2d73 7461 7475 7322 2c20 2222 290a  on-status", "").
+00010230: 2020 2020 2020 2020 2020 2020 6c61 7374              last
+00010240: 5f6c 6f67 5f74 696d 6573 7461 6d70 203d  _log_timestamp =
+00010250: 2066 6c6f 6174 280a 2020 2020 2020 2020   float(.        
+00010260: 2020 2020 2020 2020 7265 7370 2e68 6561          resp.hea
+00010270: 6465 7273 2e67 6574 2822 782d 6d6c 7275  ders.get("x-mlru
+00010280: 6e2d 6c61 7374 2d74 696d 6573 7461 6d70  n-last-timestamp
+00010290: 222c 2022 302e 3022 290a 2020 2020 2020  ", "0.0").      
+000102a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000102b0: 2020 2020 6966 2066 756e 632e 6b69 6e64      if func.kind
+000102c0: 2069 6e20 6d6c 7275 6e2e 7275 6e74 696d   in mlrun.runtim
+000102d0: 6573 2e52 756e 7469 6d65 4b69 6e64 732e  es.RuntimeKinds.
+000102e0: 6e75 636c 696f 5f72 756e 7469 6d65 7328  nuclio_runtimes(
+000102f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00010300: 2020 2066 756e 632e 7374 6174 7573 2e61     func.status.a
+00010310: 6464 7265 7373 203d 2072 6573 702e 6865  ddress = resp.he
+00010320: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
+00010330: 756e 2d61 6464 7265 7373 222c 2022 2229  un-address", "")
+00010340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010350: 2066 756e 632e 7374 6174 7573 2e6e 7563   func.status.nuc
+00010360: 6c69 6f5f 6e61 6d65 203d 2072 6573 702e  lio_name = resp.
+00010370: 6865 6164 6572 732e 6765 7428 2278 2d6d  headers.get("x-m
+00010380: 6c72 756e 2d6e 616d 6522 2c20 2222 290a  lrun-name", "").
+00010390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103a0: 6675 6e63 2e73 7461 7475 732e 696e 7465  func.status.inte
+000103b0: 726e 616c 5f69 6e76 6f63 6174 696f 6e5f  rnal_invocation_
+000103c0: 7572 6c73 203d 2072 6573 702e 6865 6164  urls = resp.head
+000103d0: 6572 732e 6765 7428 0a20 2020 2020 2020  ers.get(.       
+000103e0: 2020 2020 2020 2020 2020 2020 2022 782d               "x-
+000103f0: 6d6c 7275 6e2d 696e 7465 726e 616c 2d69  mlrun-internal-i
+00010400: 6e76 6f63 6174 696f 6e2d 7572 6c73 222c  nvocation-urls",
+00010410: 2022 220a 2020 2020 2020 2020 2020 2020   "".            
+00010420: 2020 2020 292e 7370 6c69 7428 222c 2229      ).split(",")
+00010430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010440: 2066 756e 632e 7374 6174 7573 2e65 7874   func.status.ext
+00010450: 6572 6e61 6c5f 696e 766f 6361 7469 6f6e  ernal_invocation
+00010460: 5f75 726c 7320 3d20 7265 7370 2e68 6561  _urls = resp.hea
+00010470: 6465 7273 2e67 6574 280a 2020 2020 2020  ders.get(.      
+00010480: 2020 2020 2020 2020 2020 2020 2020 2278                "x
+00010490: 2d6d 6c72 756e 2d65 7874 6572 6e61 6c2d  -mlrun-external-
+000104a0: 696e 766f 6361 7469 6f6e 2d75 726c 7322  invocation-urls"
+000104b0: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
+000104c0: 2020 2020 2029 2e73 706c 6974 2822 2c22       ).split(","
+000104d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000104e0: 2020 6675 6e63 2e73 7461 7475 732e 636f    func.status.co
+000104f0: 6e74 6169 6e65 725f 696d 6167 6520 3d20  ntainer_image = 
+00010500: 7265 7370 2e68 6561 6465 7273 2e67 6574  resp.headers.get
+00010510: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00010520: 2020 2020 2020 2278 2d6d 6c72 756e 2d63        "x-mlrun-c
+00010530: 6f6e 7461 696e 6572 2d69 6d61 6765 222c  ontainer-image",
+00010540: 2022 220a 2020 2020 2020 2020 2020 2020   "".            
+00010550: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00010560: 2020 2062 7569 6c64 6572 5f70 6f64 203d     builder_pod =
+00010570: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
+00010580: 7428 2262 7569 6c64 6572 5f70 6f64 222c  t("builder_pod",
+00010590: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
+000105a0: 2069 6620 6275 696c 6465 725f 706f 643a   if builder_pod:
+000105b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000105c0: 2066 756e 632e 7374 6174 7573 2e62 7569   func.status.bui
+000105d0: 6c64 5f70 6f64 203d 2062 7569 6c64 6572  ld_pod = builder
+000105e0: 5f70 6f64 0a0a 2020 2020 2020 2020 2020  _pod..          
+000105f0: 2020 6675 6e63 7469 6f6e 5f69 6d61 6765    function_image
+00010600: 203d 2072 6573 702e 6865 6164 6572 732e   = resp.headers.
+00010610: 6765 7428 2266 756e 6374 696f 6e5f 696d  get("function_im
+00010620: 6167 6522 2c20 2222 290a 2020 2020 2020  age", "").      
+00010630: 2020 2020 2020 6966 2066 756e 6374 696f        if functio
+00010640: 6e5f 696d 6167 653a 0a20 2020 2020 2020  n_image:.       
+00010650: 2020 2020 2020 2020 2066 756e 632e 7370           func.sp
+00010660: 6563 2e69 6d61 6765 203d 2066 756e 6374  ec.image = funct
+00010670: 696f 6e5f 696d 6167 650a 0a20 2020 2020  ion_image..     
+00010680: 2020 2074 6578 7420 3d20 2222 0a20 2020     text = "".   
+00010690: 2020 2020 2069 6620 7265 7370 2e63 6f6e       if resp.con
+000106a0: 7465 6e74 3a0a 2020 2020 2020 2020 2020  tent:.          
+000106b0: 2020 7465 7874 203d 2072 6573 702e 636f    text = resp.co
+000106c0: 6e74 656e 742e 6465 636f 6465 2829 0a20  ntent.decode(). 
+000106d0: 2020 2020 2020 2072 6574 7572 6e20 7465         return te
+000106e0: 7874 2c20 6c61 7374 5f6c 6f67 5f74 696d  xt, last_log_tim
+000106f0: 6573 7461 6d70 0a0a 2020 2020 6465 6620  estamp..    def 
+00010700: 7374 6172 745f 6675 6e63 7469 6f6e 280a  start_function(.
+00010710: 2020 2020 2020 2020 7365 6c66 2c20 6675          self, fu
+00010720: 6e63 5f75 726c 3a20 7374 7220 3d20 4e6f  nc_url: str = No
+00010730: 6e65 2c20 6675 6e63 7469 6f6e 3a20 226d  ne, function: "m
+00010740: 6c72 756e 2e72 756e 7469 6d65 732e 4261  lrun.runtimes.Ba
+00010750: 7365 5275 6e74 696d 6522 203d 204e 6f6e  seRuntime" = Non
+00010760: 650a 2020 2020 2920 2d3e 206d 6c72 756e  e.    ) -> mlrun
+00010770: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00010780: 4261 636b 6772 6f75 6e64 5461 736b 3a0a  BackgroundTask:.
+00010790: 2020 2020 2020 2020 2222 2245 7865 6375          """Execu
+000107a0: 7465 2061 2066 756e 6374 696f 6e20 7265  te a function re
+000107b0: 6d6f 7465 6c79 2c20 5573 6564 2066 6f72  motely, Used for
+000107c0: 2060 6064 6173 6b60 6020 6675 6e63 7469   ``dask`` functi
+000107d0: 6f6e 732e 0a0a 2020 2020 2020 2020 3a70  ons...        :p
+000107e0: 6172 616d 2066 756e 635f 7572 6c3a 2055  aram func_url: U
+000107f0: 524c 2074 6f20 7468 6520 6675 6e63 7469  RL to the functi
+00010800: 6f6e 2074 6f20 6265 2065 7865 6375 7465  on to be execute
+00010810: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+00010820: 6d20 6675 6e63 7469 6f6e 3a20 5468 6520  m function: The 
+00010830: 6675 6e63 7469 6f6e 206f 626a 6563 7420  function object 
+00010840: 746f 2073 7461 7274 2c20 6e6f 7420 6e65  to start, not ne
+00010850: 6564 6564 2068 6572 652e 0a20 2020 2020  eded here..     
+00010860: 2020 203a 7265 7475 726e 733a 2041 2042     :returns: A B
+00010870: 6163 6b67 726f 756e 6454 6173 6b20 6f62  ackgroundTask ob
+00010880: 6a65 6374 2c20 7769 7468 2064 6574 6169  ject, with detai
+00010890: 6c73 206f 6e20 6578 6563 7574 696f 6e20  ls on execution 
+000108a0: 7072 6f63 6573 7320 616e 6420 6974 7320  process and its 
+000108b0: 7374 6174 7573 2e0a 2020 2020 2020 2020  status..        
+000108c0: 2222 220a 0a20 2020 2020 2020 2074 7279  """..        try
+000108d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000108e0: 7120 3d20 7b22 6675 6e63 7469 6f6e 5572  q = {"functionUr
+000108f0: 6c22 3a20 6675 6e63 5f75 726c 7d0a 2020  l": func_url}.  
+00010900: 2020 2020 2020 2020 2020 7265 7370 203d            resp =
+00010910: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00010920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010930: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
+00010940: 2020 2020 2020 2020 2273 7461 7274 2f66          "start/f
+00010950: 756e 6374 696f 6e22 2c0a 2020 2020 2020  unction",.      
+00010960: 2020 2020 2020 2020 2020 6a73 6f6e 3d72            json=r
+00010970: 6571 2c0a 2020 2020 2020 2020 2020 2020  eq,.            
+00010980: 2020 2020 7469 6d65 6f75 743d 696e 7428      timeout=int(
+00010990: 636f 6e66 6967 2e73 7562 6d69 745f 7469  config.submit_ti
+000109a0: 6d65 6f75 7429 206f 7220 3630 2c0a 2020  meout) or 60,.  
+000109b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000109c0: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
+000109d0: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
+000109e0: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+000109f0: 726f 7228 6622 6572 726f 7220 7374 6172  ror(f"error star
+00010a00: 7469 6e67 2066 756e 6374 696f 6e3a 207b  ting function: {
+00010a10: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+00010a20: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00010a30: 6169 7365 204f 5345 7272 6f72 2866 2265  aise OSError(f"e
+00010a40: 7272 6f72 3a20 6361 6e6e 6f74 2073 7461  rror: cannot sta
+00010a50: 7274 2066 756e 6374 696f 6e2c 207b 6572  rt function, {er
+00010a60: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+00010a70: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00010a80: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
+00010a90: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
+00010aa0: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
+00010ab0: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
+00010ac0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00010ad0: 2056 616c 7565 4572 726f 7228 2262 6164   ValueError("bad
+00010ae0: 2066 756e 6374 696f 6e20 7374 6172 7420   function start 
+00010af0: 7265 7370 6f6e 7365 2229 0a0a 2020 2020  response")..    
+00010b00: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+00010b10: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00010b20: 4261 636b 6772 6f75 6e64 5461 736b 282a  BackgroundTask(*
+00010b30: 2a72 6573 702e 6a73 6f6e 2829 290a 0a20  *resp.json()).. 
+00010b40: 2020 2064 6566 2067 6574 5f70 726f 6a65     def get_proje
+00010b50: 6374 5f62 6163 6b67 726f 756e 645f 7461  ct_background_ta
+00010b60: 736b 280a 2020 2020 2020 2020 7365 6c66  sk(.        self
+00010b70: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00010b80: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00010b90: 6e61 6d65 3a20 7374 722c 0a20 2020 2029  name: str,.    )
+00010ba0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
+00010bb0: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
+00010bc0: 756e 6454 6173 6b3a 0a20 2020 2020 2020  undTask:.       
+00010bd0: 2022 2222 5265 7472 6965 7665 2075 7064   """Retrieve upd
+00010be0: 6174 6564 2069 6e66 6f72 6d61 7469 6f6e  ated information
+00010bf0: 206f 6e20 6120 7072 6f6a 6563 7420 6261   on a project ba
+00010c00: 636b 6772 6f75 6e64 2074 6173 6b20 6265  ckground task be
+00010c10: 696e 6720 6578 6563 7574 6564 2e22 2222  ing executed."""
+00010c20: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+00010c30: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00010c40: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00010c50: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
+00010c60: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00010c70: 7b70 726f 6a65 6374 7d2f 6261 636b 6772  {project}/backgr
+00010c80: 6f75 6e64 2d74 6173 6b73 2f7b 6e61 6d65  ound-tasks/{name
+00010c90: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+00010ca0: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
+00010cb0: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
+00010cc0: 6420 6765 7474 696e 6720 7072 6f6a 6563  d getting projec
+00010cd0: 7420 6261 636b 6772 6f75 6e64 2074 6173  t background tas
+00010ce0: 6b2e 2070 726f 6a65 6374 3d7b 7072 6f6a  k. project={proj
+00010cf0: 6563 747d 2c20 6e61 6d65 3d7b 6e61 6d65  ect}, name={name
+00010d00: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
+00010d10: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00010d20: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
+00010d30: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
+00010d40: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
+00010d50: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
+00010d60: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4261  ommon.schemas.Ba
+00010d70: 636b 6772 6f75 6e64 5461 736b 282a 2a72  ckgroundTask(**r
+00010d80: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+00010d90: 0a20 2020 2064 6566 206c 6973 745f 7072  .    def list_pr
+00010da0: 6f6a 6563 745f 6261 636b 6772 6f75 6e64  oject_background
+00010db0: 5f74 6173 6b73 280a 2020 2020 2020 2020  _tasks(.        
+00010dc0: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+00010dd0: 6f6a 6563 743a 204f 7074 696f 6e61 6c5b  oject: Optional[
+00010de0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00010df0: 2020 2020 2073 7461 7465 3a20 4f70 7469       state: Opti
+00010e00: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+00010e10: 2c0a 2020 2020 2020 2020 6372 6561 7465  ,.        create
+00010e20: 645f 6672 6f6d 3a20 4f70 7469 6f6e 616c  d_from: Optional
+00010e30: 5b64 6174 6574 696d 655d 203d 204e 6f6e  [datetime] = Non
+00010e40: 652c 0a20 2020 2020 2020 2063 7265 6174  e,.        creat
+00010e50: 6564 5f74 6f3a 204f 7074 696f 6e61 6c5b  ed_to: Optional[
+00010e60: 6461 7465 7469 6d65 5d20 3d20 4e6f 6e65  datetime] = None
+00010e70: 2c0a 2020 2020 2020 2020 6c61 7374 5f75  ,.        last_u
+00010e80: 7064 6174 655f 7469 6d65 5f66 726f 6d3a  pdate_time_from:
+00010e90: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
+00010ea0: 6d65 5d20 3d20 4e6f 6e65 2c0a 2020 2020  me] = None,.    
+00010eb0: 2020 2020 6c61 7374 5f75 7064 6174 655f      last_update_
+00010ec0: 7469 6d65 5f74 6f3a 204f 7074 696f 6e61  time_to: Optiona
+00010ed0: 6c5b 6461 7465 7469 6d65 5d20 3d20 4e6f  l[datetime] = No
+00010ee0: 6e65 2c0a 2020 2020 2920 2d3e 206c 6973  ne,.    ) -> lis
+00010ef0: 745b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  t[mlrun.common.s
+00010f00: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
+00010f10: 6454 6173 6b5d 3a0a 2020 2020 2020 2020  dTask]:.        
+00010f20: 2222 220a 2020 2020 2020 2020 5265 7472  """.        Retr
+00010f30: 6965 7665 2075 7064 6174 6564 2069 6e66  ieve updated inf
+00010f40: 6f72 6d61 7469 6f6e 206f 6e20 7072 6f6a  ormation on proj
+00010f50: 6563 7420 6261 636b 6772 6f75 6e64 2074  ect background t
+00010f60: 6173 6b73 2062 6569 6e67 2065 7865 6375  asks being execu
+00010f70: 7465 642e 0a20 2020 2020 2020 2049 6620  ted..        If 
+00010f80: 6e6f 2066 696c 7465 7220 6973 2070 726f  no filter is pro
+00010f90: 7669 6465 642c 2077 696c 6c20 7265 7475  vided, will retu
+00010fa0: 726e 2062 6163 6b67 726f 756e 6420 7461  rn background ta
+00010fb0: 736b 7320 6672 6f6d 2074 6865 206c 6173  sks from the las
+00010fc0: 7420 7765 656b 2e0a 0a20 2020 2020 2020  t week...       
+00010fd0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00010fe0: 2050 726f 6a65 6374 206e 616d 6520 2864   Project name (d
+00010ff0: 6566 6175 6c74 7320 746f 206d 6c72 756e  efaults to mlrun
+00011000: 2e6d 6c63 6f6e 662e 6465 6661 756c 745f  .mlconf.default_
+00011010: 7072 6f6a 6563 7429 2e0a 2020 2020 2020  project)..      
+00011020: 2020 3a70 6172 616d 2073 7461 7465 3a20    :param state: 
+00011030: 2020 4c69 7374 206f 6e6c 7920 6261 636b    List only back
+00011040: 6772 6f75 6e64 2074 6173 6b73 2077 686f  ground tasks who
+00011050: 7365 2073 7461 7465 2069 7320 7370 6563  se state is spec
+00011060: 6966 6965 642e 0a20 2020 2020 2020 203a  ified..        :
+00011070: 7061 7261 6d20 6372 6561 7465 645f 6672  param created_fr
+00011080: 6f6d 3a20 4669 6c74 6572 2062 7920 6261  om: Filter by ba
+00011090: 636b 6772 6f75 6e64 2074 6173 6b20 6372  ckground task cr
+000110a0: 6561 7465 6420 7469 6d65 2069 6e20 6060  eated time in ``
+000110b0: 5b63 7265 6174 6564 5f66 726f 6d2c 2063  [created_from, c
+000110c0: 7265 6174 6564 5f74 6f5d 6060 2e0a 2020  reated_to]``..  
+000110d0: 2020 2020 2020 3a70 6172 616d 2063 7265        :param cre
+000110e0: 6174 6564 5f74 6f3a 2020 4669 6c74 6572  ated_to:  Filter
+000110f0: 2062 7920 6261 636b 6772 6f75 6e64 2074   by background t
+00011100: 6173 6b20 6372 6561 7465 6420 7469 6d65  ask created time
+00011110: 2069 6e20 6060 5b63 7265 6174 6564 5f66   in ``[created_f
+00011120: 726f 6d2c 2063 7265 6174 6564 5f74 6f5d  rom, created_to]
+00011130: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
+00011140: 616d 206c 6173 745f 7570 6461 7465 5f74  am last_update_t
+00011150: 696d 655f 6672 6f6d 3a20 4669 6c74 6572  ime_from: Filter
+00011160: 2062 7920 6261 636b 6772 6f75 6e64 2074   by background t
+00011170: 6173 6b20 6c61 7374 2075 7064 6174 6520  ask last update 
+00011180: 7469 6d65 2069 6e0a 2020 2020 2020 2020  time in.        
+00011190: 2020 2020 6060 286c 6173 745f 7570 6461      ``(last_upda
+000111a0: 7465 5f74 696d 655f 6672 6f6d 2c20 6c61  te_time_from, la
+000111b0: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
+000111c0: 6f29 6060 2e0a 2020 2020 2020 2020 3a70  o)``..        :p
+000111d0: 6172 616d 206c 6173 745f 7570 6461 7465  aram last_update
+000111e0: 5f74 696d 655f 746f 3a20 4669 6c74 6572  _time_to: Filter
+000111f0: 2062 7920 6261 636b 6772 6f75 6e64 2074   by background t
+00011200: 6173 6b20 6c61 7374 2075 7064 6174 6520  ask last update 
+00011210: 7469 6d65 2069 6e0a 2020 2020 2020 2020  time in.        
+00011220: 2020 2020 6060 286c 6173 745f 7570 6461      ``(last_upda
+00011230: 7465 5f74 696d 655f 6672 6f6d 2c20 6c61  te_time_from, la
+00011240: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
+00011250: 6f29 6060 2e0a 2020 2020 2020 2020 2222  o)``..        ""
+00011260: 220a 2020 2020 2020 2020 7072 6f6a 6563  ".        projec
+00011270: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00011280: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00011290: 6f6a 6563 740a 2020 2020 2020 2020 6966  oject.        if
+000112a0: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
+000112b0: 6f74 2073 7461 7465 0a20 2020 2020 2020  ot state.       
+000112c0: 2020 2020 2061 6e64 206e 6f74 2063 7265       and not cre
+000112d0: 6174 6564 5f66 726f 6d0a 2020 2020 2020  ated_from.      
+000112e0: 2020 2020 2020 616e 6420 6e6f 7420 6372        and not cr
+000112f0: 6561 7465 645f 746f 0a20 2020 2020 2020  eated_to.       
+00011300: 2020 2020 2061 6e64 206e 6f74 206c 6173       and not las
+00011310: 745f 7570 6461 7465 5f74 696d 655f 6672  t_update_time_fr
+00011320: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
+00011330: 6e64 206e 6f74 206c 6173 745f 7570 6461  nd not last_upda
+00011340: 7465 5f74 696d 655f 746f 0a20 2020 2020  te_time_to.     
+00011350: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00011360: 2020 2320 6465 6661 756c 7420 746f 206c    # default to l
+00011370: 6173 7420 7765 656b 206f 6e20 6e6f 2066  ast week on no f
+00011380: 696c 7465 720a 2020 2020 2020 2020 2020  ilter.          
+00011390: 2020 6372 6561 7465 645f 6672 6f6d 203d    created_from =
+000113a0: 2064 6174 6574 696d 652e 6e6f 7728 2920   datetime.now() 
+000113b0: 2d20 7469 6d65 6465 6c74 6128 6461 7973  - timedelta(days
+000113c0: 3d37 290a 0a20 2020 2020 2020 2070 6172  =7)..        par
+000113d0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+000113e0: 2020 2020 2273 7461 7465 223a 2073 7461      "state": sta
+000113f0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00011400: 2263 7265 6174 6564 5f66 726f 6d22 3a20  "created_from": 
+00011410: 6461 7465 7469 6d65 5f74 6f5f 6973 6f28  datetime_to_iso(
+00011420: 6372 6561 7465 645f 6672 6f6d 292c 0a20  created_from),. 
+00011430: 2020 2020 2020 2020 2020 2022 6372 6561             "crea
+00011440: 7465 645f 746f 223a 2064 6174 6574 696d  ted_to": datetim
+00011450: 655f 746f 5f69 736f 2863 7265 6174 6564  e_to_iso(created
+00011460: 5f74 6f29 2c0a 2020 2020 2020 2020 2020  _to),.          
+00011470: 2020 226c 6173 745f 7570 6461 7465 5f74    "last_update_t
+00011480: 696d 655f 6672 6f6d 223a 2064 6174 6574  ime_from": datet
+00011490: 696d 655f 746f 5f69 736f 286c 6173 745f  ime_to_iso(last_
+000114a0: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
+000114b0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+000114c0: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
+000114d0: 5f74 6f22 3a20 6461 7465 7469 6d65 5f74  _to": datetime_t
+000114e0: 6f5f 6973 6f28 6c61 7374 5f75 7064 6174  o_iso(last_updat
+000114f0: 655f 7469 6d65 5f74 6f29 2c0a 2020 2020  e_time_to),.    
+00011500: 2020 2020 7d0a 0a20 2020 2020 2020 2070      }..        p
+00011510: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00011520: 2f7b 7072 6f6a 6563 747d 2f62 6163 6b67  /{project}/backg
+00011530: 726f 756e 642d 7461 736b 7322 0a20 2020  round-tasks".   
+00011540: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00011550: 6765 203d 2066 2246 6169 6c65 6420 6c69  ge = f"Failed li
+00011560: 7374 696e 6720 7072 6f6a 6563 7420 6261  sting project ba
+00011570: 636b 6772 6f75 6e64 2074 6173 6b2e 2070  ckground task. p
+00011580: 726f 6a65 6374 3d7b 7072 6f6a 6563 747d  roject={project}
+00011590: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
+000115a0: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+000115b0: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
+000115c0: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+000115d0: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
+000115e0: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+000115f0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00011600: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+00011610: 4c69 7374 280a 2020 2020 2020 2020 2020  List(.          
+00011620: 2020 2a2a 7265 7370 6f6e 7365 2e6a 736f    **response.jso
+00011630: 6e28 290a 2020 2020 2020 2020 292e 6261  n().        ).ba
+00011640: 636b 6772 6f75 6e64 5f74 6173 6b73 0a0a  ckground_tasks..
+00011650: 2020 2020 6465 6620 6765 745f 6261 636b      def get_back
+00011660: 6772 6f75 6e64 5f74 6173 6b28 7365 6c66  ground_task(self
+00011670: 2c20 6e61 6d65 3a20 7374 7229 202d 3e20  , name: str) -> 
+00011680: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00011690: 656d 6173 2e42 6163 6b67 726f 756e 6454  emas.BackgroundT
+000116a0: 6173 6b3a 0a20 2020 2020 2020 2022 2222  ask:.        """
+000116b0: 5265 7472 6965 7665 2075 7064 6174 6564  Retrieve updated
+000116c0: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
+000116d0: 6120 6261 636b 6772 6f75 6e64 2074 6173  a background tas
+000116e0: 6b20 6265 696e 6720 6578 6563 7574 6564  k being executed
+000116f0: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
+00011700: 7468 203d 2066 2262 6163 6b67 726f 756e  th = f"backgroun
+00011710: 642d 7461 736b 732f 7b6e 616d 657d 220a  d-tasks/{name}".
+00011720: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00011730: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+00011740: 2067 6574 7469 6e67 2062 6163 6b67 726f   getting backgro
+00011750: 756e 6420 7461 736b 2e20 6e61 6d65 3d7b  und task. name={
+00011760: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
+00011770: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+00011780: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
+00011790: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+000117a0: 6765 290a 2020 2020 2020 2020 7265 7475  ge).        retu
+000117b0: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
+000117c0: 7363 6865 6d61 732e 4261 636b 6772 6f75  schemas.Backgrou
+000117d0: 6e64 5461 736b 282a 2a72 6573 706f 6e73  ndTask(**respons
+000117e0: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+000117f0: 6566 2066 756e 6374 696f 6e5f 7374 6174  ef function_stat
+00011800: 7573 2873 656c 662c 2070 726f 6a65 6374  us(self, project
+00011810: 2c20 6e61 6d65 2c20 6b69 6e64 2c20 7365  , name, kind, se
+00011820: 6c65 6374 6f72 293a 0a20 2020 2020 2020  lector):.       
+00011830: 2022 2222 5265 7472 6965 7665 2073 7461   """Retrieve sta
+00011840: 7475 7320 6f66 2061 2066 756e 6374 696f  tus of a functio
+00011850: 6e20 6265 696e 6720 6578 6563 7574 6564  n being executed
+00011860: 2072 656d 6f74 656c 7920 2872 656c 6576   remotely (relev
+00011870: 616e 7420 746f 2060 6064 6173 6b60 6020  ant to ``dask`` 
+00011880: 6675 6e63 7469 6f6e 7329 2e0a 0a20 2020  functions)...   
+00011890: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+000118a0: 6563 743a 2020 2020 2054 6865 2070 726f  ect:     The pro
+000118b0: 6a65 6374 206f 6620 7468 6520 6675 6e63  ject of the func
+000118c0: 7469 6f6e 0a20 2020 2020 2020 203a 7061  tion.        :pa
+000118d0: 7261 6d20 6e61 6d65 3a20 2020 2020 2020  ram name:       
+000118e0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+000118f0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
+00011900: 2020 3a70 6172 616d 206b 696e 643a 2020    :param kind:  
+00011910: 2020 2020 2020 5468 6520 6b69 6e64 206f        The kind o
+00011920: 6620 7468 6520 6675 6e63 7469 6f6e 2c20  f the function, 
+00011930: 6375 7272 656e 746c 7920 6060 6461 736b  currently ``dask
+00011940: 6060 2069 7320 7375 7070 6f72 7465 642e  `` is supported.
+00011950: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00011960: 7365 6c65 6374 6f72 3a20 2020 2053 656c  selector:    Sel
+00011970: 6563 746f 7220 636c 6175 7365 2074 6f20  ector clause to 
+00011980: 6265 2061 7070 6c69 6564 2074 6f20 7468  be applied to th
+00011990: 6520 4b75 6265 726e 6574 6573 2073 7461  e Kubernetes sta
+000119a0: 7475 7320 7175 6572 7920 746f 2066 696c  tus query to fil
+000119b0: 7465 7220 7468 6520 7265 7375 6c74 732e  ter the results.
+000119c0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000119d0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+000119e0: 2020 2020 2020 2072 6571 203d 207b 226b         req = {"k
+000119f0: 696e 6422 3a20 6b69 6e64 2c20 2273 656c  ind": kind, "sel
+00011a00: 6563 746f 7222 3a20 7365 6c65 6374 6f72  ector": selector
+00011a10: 2c20 2270 726f 6a65 6374 223a 2070 726f  , "project": pro
+00011a20: 6a65 6374 2c20 226e 616d 6522 3a20 6e61  ject, "name": na
+00011a30: 6d65 7d0a 2020 2020 2020 2020 2020 2020  me}.            
+00011a40: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+00011a50: 6361 6c6c 2822 504f 5354 222c 2022 7374  call("POST", "st
+00011a60: 6174 7573 2f66 756e 6374 696f 6e22 2c20  atus/function", 
+00011a70: 6a73 6f6e 3d72 6571 290a 2020 2020 2020  json=req).      
+00011a80: 2020 6578 6365 7074 204f 5345 7272 6f72    except OSError
+00011a90: 2061 7320 6572 723a 0a20 2020 2020 2020   as err:.       
+00011aa0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
+00011ab0: 7228 6622 6572 726f 7220 7374 6172 7469  r(f"error starti
+00011ac0: 6e67 2066 756e 6374 696f 6e3a 207b 6572  ng function: {er
+00011ad0: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+00011ae0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00011af0: 7365 204f 5345 7272 6f72 2866 2265 7272  se OSError(f"err
+00011b00: 6f72 3a20 6361 6e6e 6f74 2073 7461 7274  or: cannot start
+00011b10: 2066 756e 6374 696f 6e2c 207b 6572 725f   function, {err_
+00011b20: 746f 5f73 7472 2865 7272 297d 2229 0a0a  to_str(err)}")..
+00011b30: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+00011b40: 6573 702e 6f6b 3a0a 2020 2020 2020 2020  esp.ok:.        
+00011b50: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
+00011b60: 2866 2262 6164 2072 6573 7021 215c 6e7b  (f"bad resp!!\n{
+00011b70: 7265 7370 2e74 6578 747d 2229 0a20 2020  resp.text}").   
+00011b80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00011b90: 616c 7565 4572 726f 7228 2262 6164 2066  alueError("bad f
+00011ba0: 756e 6374 696f 6e20 7374 6174 7573 2072  unction status r
+00011bb0: 6573 706f 6e73 6522 290a 0a20 2020 2020  esponse")..     
+00011bc0: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
+00011bd0: 736f 6e28 295b 2264 6174 6122 5d0a 0a20  son()["data"].. 
+00011be0: 2020 2064 6566 2073 7562 6d69 745f 6a6f     def submit_jo
+00011bf0: 6228 0a20 2020 2020 2020 2073 656c 662c  b(.        self,
+00011c00: 0a20 2020 2020 2020 2072 756e 7370 6563  .        runspec
+00011c10: 2c0a 2020 2020 2020 2020 7363 6865 6475  ,.        schedu
+00011c20: 6c65 3a20 556e 696f 6e5b 7374 722c 206d  le: Union[str, m
+00011c30: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00011c40: 6d61 732e 5363 6865 6475 6c65 4372 6f6e  mas.ScheduleCron
+00011c50: 5472 6967 6765 725d 203d 204e 6f6e 652c  Trigger] = None,
+00011c60: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00011c70: 2222 2253 7562 6d69 7420 6120 6a6f 6220  """Submit a job 
+00011c80: 666f 7220 7265 6d6f 7465 2065 7865 6375  for remote execu
+00011c90: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
+00011ca0: 7061 7261 6d20 7275 6e73 7065 633a 2054  param runspec: T
+00011cb0: 6865 2072 756e 7469 6d65 206f 626a 6563  he runtime objec
+00011cc0: 7420 7370 6563 2028 5461 736b 2920 746f  t spec (Task) to
+00011cd0: 2065 7865 6375 7465 2e0a 2020 2020 2020   execute..      
+00011ce0: 2020 3a70 6172 616d 2073 6368 6564 756c    :param schedul
+00011cf0: 653a 2057 6865 7468 6572 2074 6f20 7363  e: Whether to sc
+00011d00: 6865 6475 6c65 2074 6869 7320 6a6f 6220  hedule this job 
+00011d10: 7573 696e 6720 6120 4372 6f6e 2074 7269  using a Cron tri
+00011d20: 6767 6572 2e20 4966 206e 6f74 2073 7065  gger. If not spe
+00011d30: 6369 6669 6564 2c20 7468 6520 6a6f 6220  cified, the job 
+00011d40: 7769 6c6c 2062 6520 7375 626d 6974 7465  will be submitte
+00011d50: 640a 2020 2020 2020 2020 2020 2020 696d  d.            im
+00011d60: 6d65 6469 6174 656c 792e 0a20 2020 2020  mediately..     
+00011d70: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00011d80: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00011d90: 2072 6571 203d 207b 2274 6173 6b22 3a20   req = {"task": 
+00011da0: 7275 6e73 7065 632e 746f 5f64 6963 7428  runspec.to_dict(
+00011db0: 297d 0a20 2020 2020 2020 2020 2020 2069  )}.            i
+00011dc0: 6620 7363 6865 6475 6c65 3a0a 2020 2020  f schedule:.    
+00011dd0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00011de0: 7369 6e73 7461 6e63 6528 7363 6865 6475  sinstance(schedu
+00011df0: 6c65 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  le, mlrun.common
+00011e00: 2e73 6368 656d 6173 2e53 6368 6564 756c  .schemas.Schedul
+00011e10: 6543 726f 6e54 7269 6767 6572 293a 0a20  eCronTrigger):. 
+00011e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e30: 2020 2073 6368 6564 756c 6520 3d20 7363     schedule = sc
+00011e40: 6865 6475 6c65 2e64 6963 7428 290a 2020  hedule.dict().  
+00011e50: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00011e60: 715b 2273 6368 6564 756c 6522 5d20 3d20  q["schedule"] = 
+00011e70: 7363 6865 6475 6c65 0a20 2020 2020 2020  schedule.       
+00011e80: 2020 2020 2074 696d 656f 7574 203d 2028       timeout = (
+00011e90: 696e 7428 636f 6e66 6967 2e73 7562 6d69  int(config.submi
+00011ea0: 745f 7469 6d65 6f75 7429 206f 7220 3132  t_timeout) or 12
+00011eb0: 3029 202b 2032 300a 2020 2020 2020 2020  0) + 20.        
+00011ec0: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+00011ed0: 6170 695f 6361 6c6c 2822 504f 5354 222c  api_call("POST",
+00011ee0: 2022 7375 626d 6974 5f6a 6f62 222c 206a   "submit_job", j
+00011ef0: 736f 6e3d 7265 712c 2074 696d 656f 7574  son=req, timeout
+00011f00: 3d74 696d 656f 7574 290a 0a20 2020 2020  =timeout)..     
+00011f10: 2020 2065 7863 6570 7420 7265 7175 6573     except reques
+00011f20: 7473 2e48 5454 5045 7272 6f72 2061 7320  ts.HTTPError as 
+00011f30: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+00011f40: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+00011f50: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
+00011f60: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
+00011f70: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
+00011f80: 2020 2020 2020 2023 206e 6f74 2063 7265         # not cre
+00011f90: 6174 696e 6720 6120 6e65 7720 6578 6365  ating a new exce
+00011fa0: 7074 696f 6e20 6865 7265 2c20 696e 206f  ption here, in o
+00011fb0: 7264 6572 2074 6f20 6b65 6570 2074 6865  rder to keep the
+00011fc0: 2072 6573 706f 6e73 6520 616e 6420 7374   response and st
+00011fd0: 6174 7573 2063 6f64 6520 696e 2074 6865  atus code in the
+00011fe0: 2065 7863 6570 7469 6f6e 0a20 2020 2020   exception.     
+00011ff0: 2020 2020 2020 2072 6169 7365 0a0a 2020         raise..  
+00012000: 2020 2020 2020 6578 6365 7074 204f 5345        except OSE
+00012010: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+00012020: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+00012030: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
+00012040: 626d 6974 7469 6e67 2074 6173 6b3a 207b  bmitting task: {
+00012050: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+00012060: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00012070: 6169 7365 204f 5345 7272 6f72 2822 6572  aise OSError("er
+00012080: 726f 723a 2063 616e 6e6f 7420 7375 626d  ror: cannot subm
+00012090: 6974 2074 6173 6b22 2920 6672 6f6d 2065  it task") from e
+000120a0: 7272 0a0a 2020 2020 2020 2020 6966 206e  rr..        if n
+000120b0: 6f74 2072 6573 702e 6f6b 3a0a 2020 2020  ot resp.ok:.    
+000120c0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+000120d0: 7272 6f72 2866 2262 6164 2072 6573 7021  rror(f"bad resp!
+000120e0: 215c 6e7b 7265 7370 2e74 6578 747d 2229  !\n{resp.text}")
+000120f0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00012100: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00012110: 6261 6420 6675 6e63 7469 6f6e 2072 756e  bad function run
+00012120: 2072 6573 706f 6e73 652c 207b 7265 7370   response, {resp
+00012130: 2e74 6578 747d 2229 0a0a 2020 2020 2020  .text}")..      
+00012140: 2020 7265 7370 203d 2072 6573 702e 6a73    resp = resp.js
+00012150: 6f6e 2829 0a20 2020 2020 2020 2072 6574  on().        ret
+00012160: 7572 6e20 7265 7370 5b22 6461 7461 225d  urn resp["data"]
+00012170: 0a0a 2020 2020 6465 6620 7375 626d 6974  ..    def submit
+00012180: 5f70 6970 656c 696e 6528 0a20 2020 2020  _pipeline(.     
+00012190: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000121a0: 2070 726f 6a65 6374 2c0a 2020 2020 2020   project,.      
+000121b0: 2020 7069 7065 6c69 6e65 2c0a 2020 2020    pipeline,.    
+000121c0: 2020 2020 6172 6775 6d65 6e74 733d 4e6f      arguments=No
+000121d0: 6e65 2c0a 2020 2020 2020 2020 6578 7065  ne,.        expe
+000121e0: 7269 6d65 6e74 3d4e 6f6e 652c 0a20 2020  riment=None,.   
+000121f0: 2020 2020 2072 756e 3d4e 6f6e 652c 0a20       run=None,. 
+00012200: 2020 2020 2020 206e 616d 6573 7061 6365         namespace
+00012210: 3d4e 6f6e 652c 0a20 2020 2020 2020 2061  =None,.        a
+00012220: 7274 6966 6163 745f 7061 7468 3d4e 6f6e  rtifact_path=Non
+00012230: 652c 0a20 2020 2020 2020 206f 7073 3d4e  e,.        ops=N
+00012240: 6f6e 652c 0a20 2020 2020 2020 2063 6c65  one,.        cle
+00012250: 616e 7570 5f74 746c 3d4e 6f6e 652c 0a20  anup_ttl=None,. 
+00012260: 2020 2020 2020 2074 696d 656f 7574 3d36         timeout=6
+00012270: 302c 0a20 2020 2029 3a0a 2020 2020 2020  0,.    ):.      
+00012280: 2020 2222 2253 7562 6d69 7420 6120 4b46    """Submit a KF
+00012290: 5020 7069 7065 6c69 6e65 2066 6f72 2065  P pipeline for e
+000122a0: 7865 6375 7469 6f6e 2e0a 0a20 2020 2020  xecution...     
+000122b0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+000122c0: 743a 2020 2020 2020 2020 2054 6865 2070  t:         The p
+000122d0: 726f 6a65 6374 206f 6620 7468 6520 7069  roject of the pi
+000122e0: 7065 6c69 6e65 0a20 2020 2020 2020 203a  peline.        :
+000122f0: 7061 7261 6d20 7069 7065 6c69 6e65 3a20  param pipeline: 
+00012300: 2020 2020 2020 2050 6970 656c 696e 6520         Pipeline 
+00012310: 6675 6e63 7469 6f6e 206f 7220 7061 7468  function or path
+00012320: 2074 6f20 2e79 616d 6c2f 2e7a 6970 2070   to .yaml/.zip p
+00012330: 6970 656c 696e 6520 6669 6c65 2e0a 2020  ipeline file..  
+00012340: 2020 2020 2020 3a70 6172 616d 2061 7267        :param arg
+00012350: 756d 656e 7473 3a20 2020 2020 2020 4120  uments:       A 
+00012360: 6469 6374 696f 6e61 7279 206f 6620 6172  dictionary of ar
+00012370: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00012380: 746f 2074 6865 2070 6970 656c 696e 652e  to the pipeline.
+00012390: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000123a0: 6578 7065 7269 6d65 6e74 3a20 2020 2020  experiment:     
+000123b0: 2041 206e 616d 6520 746f 2061 7373 6967   A name to assig
+000123c0: 6e20 666f 7220 7468 6520 7370 6563 6966  n for the specif
+000123d0: 6963 2065 7870 6572 696d 656e 742e 0a20  ic experiment.. 
+000123e0: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
+000123f0: 6e3a 2020 2020 2020 2020 2020 2020 2041  n:             A
+00012400: 206e 616d 6520 666f 7220 7468 6973 2073   name for this s
+00012410: 7065 6369 6669 6320 7275 6e2e 0a20 2020  pecific run..   
+00012420: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00012430: 7370 6163 653a 2020 2020 2020 204b 7562  space:       Kub
+00012440: 6572 6e65 7465 7320 6e61 6d65 7370 6163  ernetes namespac
+00012450: 6520 746f 2065 7865 6375 7465 2074 6865  e to execute the
+00012460: 2070 6970 656c 696e 6520 696e 2e0a 2020   pipeline in..  
+00012470: 2020 2020 2020 3a70 6172 616d 2061 7274        :param art
+00012480: 6966 6163 745f 7061 7468 3a20 2020 4120  ifact_path:   A 
+00012490: 7061 7468 2074 6f20 6172 7469 6661 6374  path to artifact
+000124a0: 7320 7573 6564 2062 7920 7468 6973 2070  s used by this p
+000124b0: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
+000124c0: 203a 7061 7261 6d20 6f70 733a 2020 2020   :param ops:    
+000124d0: 2020 2020 2020 2020 2054 7261 6e73 666f           Transfo
+000124e0: 726d 6572 7320 746f 2061 7070 6c79 206f  rmers to apply o
+000124f0: 6e20 616c 6c20 6f70 7320 696e 2074 6865  n all ops in the
+00012500: 2070 6970 656c 696e 652e 0a20 2020 2020   pipeline..     
+00012510: 2020 203a 7061 7261 6d20 636c 6561 6e75     :param cleanu
+00012520: 705f 7474 6c3a 2020 2020 2050 6970 656c  p_ttl:     Pipel
+00012530: 696e 6520 636c 6561 6e75 7020 7474 6c20  ine cleanup ttl 
+00012540: 696e 2073 6563 7320 2874 696d 6520 746f  in secs (time to
+00012550: 2077 6169 7420 6166 7465 7220 776f 726b   wait after work
+00012560: 666c 6f77 2063 6f6d 706c 6574 696f 6e2c  flow completion,
+00012570: 2061 7420 7768 6963 6820 706f 696e 7420   at which point 
+00012580: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00012590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125a0: 2020 2020 776f 726b 666c 6f77 2061 6e64      workflow and
+000125b0: 2061 6c6c 2069 7473 2072 6573 6f75 7263   all its resourc
+000125c0: 6573 2061 7265 2064 656c 6574 6564 290a  es are deleted).
+000125d0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+000125e0: 696d 656f 7574 3a20 2020 2020 2020 2020  imeout:         
+000125f0: 5469 6d65 6f75 7420 666f 7220 7468 6520  Timeout for the 
+00012600: 4150 4920 6361 6c6c 2e0a 2020 2020 2020  API call..      
+00012610: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
+00012620: 6620 6973 696e 7374 616e 6365 2870 6970  f isinstance(pip
+00012630: 656c 696e 652c 2073 7472 293a 0a20 2020  eline, str):.   
+00012640: 2020 2020 2020 2020 2070 6970 655f 6669           pipe_fi
+00012650: 6c65 203d 2070 6970 656c 696e 650a 2020  le = pipeline.  
+00012660: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00012670: 2020 2020 2020 2020 7069 7065 5f66 696c          pipe_fil
+00012680: 6520 3d20 7465 6d70 6669 6c65 2e4e 616d  e = tempfile.Nam
+00012690: 6564 5465 6d70 6f72 6172 7946 696c 6528  edTemporaryFile(
+000126a0: 7375 6666 6978 3d22 2e79 616d 6c22 2c20  suffix=".yaml", 
+000126b0: 6465 6c65 7465 3d46 616c 7365 292e 6e61  delete=False).na
+000126c0: 6d65 0a20 2020 2020 2020 2020 2020 2063  me.            c
+000126d0: 6f6e 6620 3d20 6e65 775f 7069 7065 5f6d  onf = new_pipe_m
+000126e0: 6574 6164 6174 6128 0a20 2020 2020 2020  etadata(.       
+000126f0: 2020 2020 2020 2020 2061 7274 6966 6163           artifac
+00012700: 745f 7061 7468 3d61 7274 6966 6163 745f  t_path=artifact_
+00012710: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+00012720: 2020 2020 2020 636c 6561 6e75 705f 7474        cleanup_tt
+00012730: 6c3d 636c 6561 6e75 705f 7474 6c2c 0a20  l=cleanup_ttl,. 
+00012740: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00012750: 705f 7472 616e 7366 6f72 6d65 7273 3d6f  p_transformers=o
+00012760: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
+00012770: 290a 2020 2020 2020 2020 2020 2020 6b66  ).            kf
+00012780: 702e 636f 6d70 696c 6572 2e43 6f6d 7069  p.compiler.Compi
+00012790: 6c65 7228 292e 636f 6d70 696c 6528 0a20  ler().compile(. 
+000127a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000127b0: 6970 656c 696e 652c 2070 6970 655f 6669  ipeline, pipe_fi
+000127c0: 6c65 2c20 7479 7065 5f63 6865 636b 3d46  le, type_check=F
+000127d0: 616c 7365 2c20 7069 7065 6c69 6e65 5f63  alse, pipeline_c
+000127e0: 6f6e 663d 636f 6e66 0a20 2020 2020 2020  onf=conf.       
+000127f0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00012800: 6966 2070 6970 655f 6669 6c65 2e65 6e64  if pipe_file.end
+00012810: 7377 6974 6828 222e 7961 6d6c 2229 3a0a  swith(".yaml"):.
+00012820: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00012830: 6572 7320 3d20 7b22 636f 6e74 656e 742d  ers = {"content-
+00012840: 7479 7065 223a 2022 6170 706c 6963 6174  type": "applicat
+00012850: 696f 6e2f 7961 6d6c 227d 0a20 2020 2020  ion/yaml"}.     
+00012860: 2020 2065 6c69 6620 7069 7065 5f66 696c     elif pipe_fil
+00012870: 652e 656e 6473 7769 7468 2822 2e7a 6970  e.endswith(".zip
+00012880: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00012890: 6865 6164 6572 7320 3d20 7b22 636f 6e74  headers = {"cont
+000128a0: 656e 742d 7479 7065 223a 2022 6170 706c  ent-type": "appl
+000128b0: 6963 6174 696f 6e2f 7a69 7022 7d0a 2020  ication/zip"}.  
+000128c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000128d0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000128e0: 6c75 6545 7272 6f72 2822 7069 7065 6c69  lueError("pipeli
+000128f0: 6e65 2066 696c 6520 6d75 7374 2062 6520  ne file must be 
+00012900: 2e79 616d 6c20 6f72 202e 7a69 7022 290a  .yaml or .zip").
+00012910: 2020 2020 2020 2020 6966 2061 7267 756d          if argum
+00012920: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
+00012930: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00012940: 6e63 6528 6172 6775 6d65 6e74 732c 2064  nce(arguments, d
+00012950: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+00012960: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00012970: 6545 7272 6f72 2822 6172 6775 6d65 6e74  eError("argument
+00012980: 7320 6d75 7374 2062 6520 6469 6374 2074  s must be dict t
+00012990: 7970 6522 290a 2020 2020 2020 2020 2020  ype").          
+000129a0: 2020 6865 6164 6572 735b 6d6c 7275 6e2e    headers[mlrun.
+000129b0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
+000129c0: 6561 6465 724e 616d 6573 2e70 6970 656c  eaderNames.pipel
+000129d0: 696e 655f 6172 6775 6d65 6e74 735d 203d  ine_arguments] =
+000129e0: 2073 7472 280a 2020 2020 2020 2020 2020   str(.          
+000129f0: 2020 2020 2020 6172 6775 6d65 6e74 730a        arguments.
+00012a00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00012a10: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
+00012a20: 7468 2e69 7366 696c 6528 7069 7065 5f66  th.isfile(pipe_f
+00012a30: 696c 6529 3a0a 2020 2020 2020 2020 2020  ile):.          
+00012a40: 2020 7261 6973 6520 4f53 4572 726f 7228    raise OSError(
+00012a50: 6622 6669 6c65 207b 7069 7065 5f66 696c  f"file {pipe_fil
+00012a60: 657d 2064 6f65 736e 7420 6578 6973 7422  e} doesnt exist"
+00012a70: 290a 2020 2020 2020 2020 7769 7468 206f  ).        with o
+00012a80: 7065 6e28 7069 7065 5f66 696c 652c 2022  pen(pipe_file, "
+00012a90: 7262 2229 2061 7320 6670 3a0a 2020 2020  rb") as fp:.    
+00012aa0: 2020 2020 2020 2020 6461 7461 203d 2066          data = f
+00012ab0: 702e 7265 6164 2829 0a20 2020 2020 2020  p.read().       
+00012ac0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00012ad0: 6365 2870 6970 656c 696e 652c 2073 7472  ce(pipeline, str
+00012ae0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00012af0: 656d 6f76 6528 7069 7065 5f66 696c 6529  emove(pipe_file)
+00012b00: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+00012b10: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00012b20: 7320 3d20 7b22 6e61 6d65 7370 6163 6522  s = {"namespace"
+00012b30: 3a20 6e61 6d65 7370 6163 652c 2022 6578  : namespace, "ex
+00012b40: 7065 7269 6d65 6e74 223a 2065 7870 6572  periment": exper
+00012b50: 696d 656e 742c 2022 7275 6e22 3a20 7275  iment, "run": ru
+00012b60: 6e7d 0a20 2020 2020 2020 2020 2020 2072  n}.            r
+00012b70: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00012b80: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00012b90: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
+00012ba0: 2020 2020 2020 2020 2020 2020 2066 2270               f"p
+00012bb0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00012bc0: 7d2f 7069 7065 6c69 6e65 7322 2c0a 2020  }/pipelines",.  
+00012bd0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00012be0: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
+00012bf0: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+00012c00: 656f 7574 3d74 696d 656f 7574 2c0a 2020  eout=timeout,.  
+00012c10: 2020 2020 2020 2020 2020 2020 2020 626f                bo
+00012c20: 6479 3d64 6174 612c 0a20 2020 2020 2020  dy=data,.       
+00012c30: 2020 2020 2020 2020 2068 6561 6465 7273           headers
+00012c40: 3d68 6561 6465 7273 2c0a 2020 2020 2020  =headers,.      
+00012c50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00012c60: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
+00012c70: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
+00012c80: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
+00012c90: 2245 7272 6f72 3a20 4361 6e6e 6f74 2073  "Error: Cannot s
+00012ca0: 7562 6d69 7420 7069 7065 6c69 6e65 222c  ubmit pipeline",
+00012cb0: 2065 7272 3d65 7272 5f74 6f5f 7374 7228   err=err_to_str(
+00012cc0: 6572 7229 290a 2020 2020 2020 2020 2020  err)).          
+00012cd0: 2020 7261 6973 6520 4f53 4572 726f 7228    raise OSError(
+00012ce0: 6622 4572 726f 723a 2043 616e 6e6f 7420  f"Error: Cannot 
+00012cf0: 7375 626d 6974 2070 6970 656c 696e 652c  submit pipeline,
+00012d00: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
+00012d10: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
+00012d20: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
+00012d30: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+00012d40: 2e65 7272 6f72 2822 4661 696c 6564 2074  .error("Failed t
+00012d50: 6f20 7375 626d 6974 2070 6970 656c 696e  o submit pipelin
+00012d60: 6522 2c20 7265 7370 6f6e 6573 5f74 6578  e", respones_tex
+00012d70: 743d 7265 7370 2e74 6578 7429 0a20 2020  t=resp.text).   
+00012d80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00012d90: 616c 7565 4572 726f 7228 6622 4661 696c  alueError(f"Fail
+00012da0: 6564 2074 6f20 7375 626d 6974 2070 6970  ed to submit pip
+00012db0: 656c 696e 652c 207b 7265 7370 2e74 6578  eline, {resp.tex
+00012dc0: 747d 2229 0a0a 2020 2020 2020 2020 7265  t}")..        re
+00012dd0: 7370 203d 2072 6573 702e 6a73 6f6e 2829  sp = resp.json()
+00012de0: 0a20 2020 2020 2020 206c 6f67 6765 722e  .        logger.
+00012df0: 696e 666f 280a 2020 2020 2020 2020 2020  info(.          
+00012e00: 2020 2250 6970 656c 696e 6520 7375 626d    "Pipeline subm
+00012e10: 6974 7465 6420 7375 6363 6573 7366 756c  itted successful
+00012e20: 6c79 222c 2070 6970 656c 696e 655f 6e61  ly", pipeline_na
+00012e30: 6d65 3d72 6573 705b 226e 616d 6522 5d2c  me=resp["name"],
+00012e40: 2069 643d 7265 7370 5b22 6964 225d 0a20   id=resp["id"]. 
+00012e50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00012e60: 2072 6574 7572 6e20 7265 7370 5b22 6964   return resp["id
+00012e70: 225d 0a0a 2020 2020 6465 6620 6c69 7374  "]..    def list
+00012e80: 5f70 6970 656c 696e 6573 280a 2020 2020  _pipelines(.    
+00012e90: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00012ea0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+00012eb0: 2020 2020 2020 2020 6e61 6d65 7370 6163          namespac
+00012ec0: 653a 2073 7472 203d 204e 6f6e 652c 0a20  e: str = None,. 
+00012ed0: 2020 2020 2020 2073 6f72 745f 6279 3a20         sort_by: 
+00012ee0: 7374 7220 3d20 2222 2c0a 2020 2020 2020  str = "",.      
+00012ef0: 2020 7061 6765 5f74 6f6b 656e 3a20 7374    page_token: st
+00012f00: 7220 3d20 2222 2c0a 2020 2020 2020 2020  r = "",.        
+00012f10: 6669 6c74 6572 5f3a 2073 7472 203d 2022  filter_: str = "
+00012f20: 222c 0a20 2020 2020 2020 2066 6f72 6d61  ",.        forma
+00012f30: 745f 3a20 556e 696f 6e5b 0a20 2020 2020  t_: Union[.     
+00012f40: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
+00012f50: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00012f60: 2e50 6970 656c 696e 6573 466f 726d 6174  .PipelinesFormat
+00012f70: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+00012f80: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00012f90: 732e 5069 7065 6c69 6e65 7346 6f72 6d61  s.PipelinesForma
+00012fa0: 742e 6d65 7461 6461 7461 5f6f 6e6c 792c  t.metadata_only,
+00012fb0: 0a20 2020 2020 2020 2070 6167 655f 7369  .        page_si
+00012fc0: 7a65 3a20 696e 7420 3d20 4e6f 6e65 2c0a  ze: int = None,.
+00012fd0: 2020 2020 2920 2d3e 206d 6c72 756e 2e63      ) -> mlrun.c
+00012fe0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5069  ommon.schemas.Pi
+00012ff0: 7065 6c69 6e65 734f 7574 7075 743a 0a20  pelinesOutput:. 
+00013000: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
+00013010: 7665 2061 206c 6973 7420 6f66 204b 4650  ve a list of KFP
+00013020: 2070 6970 656c 696e 6573 2e20 5468 6973   pipelines. This
+00013030: 2066 756e 6374 696f 6e20 6361 6e20 6265   function can be
+00013040: 2069 6e76 6f6b 6564 2074 6f20 6765 7420   invoked to get 
+00013050: 616c 6c20 7069 7065 6c69 6e65 7320 6672  all pipelines fr
+00013060: 6f6d 2061 6c6c 2070 726f 6a65 6374 732c  om all projects,
+00013070: 0a20 2020 2020 2020 2062 7920 7370 6563  .        by spec
+00013080: 6966 7969 6e67 2060 6070 726f 6a65 6374  ifying ``project
+00013090: 3d2a 6060 2c20 696e 2077 6869 6368 2063  =*``, in which c
+000130a0: 6173 6520 7061 6769 6e61 7469 6f6e 2063  ase pagination c
+000130b0: 616e 2062 6520 7573 6564 2061 6e64 2074  an be used and t
+000130c0: 6865 2076 6172 696f 7573 2073 6f72 7469  he various sorti
+000130d0: 6e67 2061 6e64 2070 6167 696e 6174 696f  ng and paginatio
+000130e0: 6e0a 2020 2020 2020 2020 7072 6f70 6572  n.        proper
+000130f0: 7469 6573 2063 616e 2062 6520 6170 706c  ties can be appl
+00013100: 6965 642e 2049 6620 6120 7370 6563 6966  ied. If a specif
+00013110: 6963 2070 726f 6a65 6374 2069 7320 7265  ic project is re
+00013120: 7175 6573 7465 642c 2074 6865 6e20 7468  quested, then th
+00013130: 6520 7061 6769 6e61 7469 6f6e 206f 7074  e pagination opt
+00013140: 696f 6e73 2063 616e 6e6f 7420 6265 0a20  ions cannot be. 
+00013150: 2020 2020 2020 2075 7365 6420 616e 6420         used and 
+00013160: 7061 6769 6e61 7469 6f6e 2069 7320 6e6f  pagination is no
+00013170: 7420 6170 706c 6965 642e 0a0a 2020 2020  t applied...    
+00013180: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00013190: 6374 3a20 5072 6f6a 6563 7420 6e61 6d65  ct: Project name
+000131a0: 2e20 4361 6e20 6265 2060 602a 6060 2066  . Can be ``*`` f
+000131b0: 6f72 2071 7565 7279 2061 6372 6f73 7320  or query across 
+000131c0: 616c 6c20 7072 6f6a 6563 7473 2e0a 2020  all projects..  
+000131d0: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+000131e0: 6573 7061 6365 3a20 4b75 6265 726e 6574  espace: Kubernet
+000131f0: 6573 206e 616d 6573 7061 6365 2069 6e20  es namespace in 
+00013200: 7768 6963 6820 7468 6520 7069 7065 6c69  which the pipeli
+00013210: 6e65 7320 6172 6520 6578 6563 7574 696e  nes are executin
+00013220: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
+00013230: 6d20 736f 7274 5f62 793a 2046 6965 6c64  m sort_by: Field
+00013240: 2074 6f20 736f 7274 2074 6865 2072 6573   to sort the res
+00013250: 756c 7473 2062 792e 0a20 2020 2020 2020  ults by..       
+00013260: 203a 7061 7261 6d20 7061 6765 5f74 6f6b   :param page_tok
+00013270: 656e 3a20 5573 6520 666f 7220 7061 6769  en: Use for pagi
+00013280: 6e61 7469 6f6e 2c20 746f 2072 6574 7269  nation, to retri
+00013290: 6576 6520 6e65 7874 2070 6167 652e 0a20  eve next page.. 
+000132a0: 2020 2020 2020 203a 7061 7261 6d20 6669         :param fi
+000132b0: 6c74 6572 5f3a 204b 7562 6572 6e65 7465  lter_: Kubernete
+000132c0: 7320 6669 6c74 6572 2074 6f20 6170 706c  s filter to appl
+000132d0: 7920 746f 2074 6865 2071 7565 7279 2c20  y to the query, 
+000132e0: 6361 6e20 6265 2075 7365 6420 746f 2066  can be used to f
+000132f0: 696c 7465 7220 6f6e 2073 7065 6369 6669  ilter on specifi
+00013300: 6320 6f62 6a65 6374 2066 6965 6c64 732e  c object fields.
+00013310: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013320: 666f 726d 6174 5f3a 2052 6573 756c 7420  format_: Result 
+00013330: 666f 726d 6174 2e20 4361 6e20 6265 206f  format. Can be o
+00013340: 6e65 206f 663a 0a0a 2020 2020 2020 2020  ne of:..        
+00013350: 2020 2020 2d20 6060 6675 6c6c 6060 202d      - ``full`` -
+00013360: 2072 6574 7572 6e20 7468 6520 6675 6c6c   return the full
+00013370: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
+00013380: 2020 2020 2020 2d20 6060 6d65 7461 6461        - ``metada
+00013390: 7461 5f6f 6e6c 7960 6020 2864 6566 6175  ta_only`` (defau
+000133a0: 6c74 2920 2d20 7265 7475 726e 206a 7573  lt) - return jus
+000133b0: 7420 6d65 7461 6461 7461 206f 6620 7468  t metadata of th
+000133c0: 6520 7069 7065 6c69 6e65 7320 6f62 6a65  e pipelines obje
+000133d0: 6374 732e 0a20 2020 2020 2020 2020 2020  cts..           
+000133e0: 202d 2060 606e 616d 655f 6f6e 6c79 6060   - ``name_only``
+000133f0: 202d 2072 6574 7572 6e20 6a75 7374 2074   - return just t
+00013400: 6865 206e 616d 6573 206f 6620 7468 6520  he names of the 
+00013410: 7069 7065 6c69 6e65 206f 626a 6563 7473  pipeline objects
+00013420: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00013430: 2070 6167 655f 7369 7a65 3a20 5369 7a65   page_size: Size
+00013440: 206f 6620 6120 7369 6e67 6c65 2070 6167   of a single pag
+00013450: 6520 7768 656e 2061 7070 6c79 696e 6720  e when applying 
+00013460: 7061 6769 6e61 7469 6f6e 2e0a 2020 2020  pagination..    
+00013470: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00013480: 2069 6620 7072 6f6a 6563 7420 213d 2022   if project != "
+00013490: 2a22 2061 6e64 2028 7061 6765 5f74 6f6b  *" and (page_tok
+000134a0: 656e 206f 7220 7061 6765 5f73 697a 6529  en or page_size)
+000134b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000134c0: 6973 6520 6d6c 7275 6e2e 6572 726f 7273  ise mlrun.errors
+000134d0: 2e4d 4c52 756e 496e 7661 6c69 6441 7267  .MLRunInvalidArg
+000134e0: 756d 656e 7445 7272 6f72 280a 2020 2020  umentError(.    
+000134f0: 2020 2020 2020 2020 2020 2020 2246 696c              "Fil
+00013500: 7465 7269 6e67 2062 7920 7072 6f6a 6563  tering by projec
+00013510: 7420 6361 6e20 6e6f 7420 6265 2075 7365  t can not be use
+00013520: 6420 746f 6765 7468 6572 2077 6974 6820  d together with 
+00013530: 7061 6769 6e61 7469 6f6e 220a 2020 2020  pagination".    
+00013540: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013550: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00013560: 2020 2020 2020 2020 2022 6e61 6d65 7370           "namesp
+00013570: 6163 6522 3a20 6e61 6d65 7370 6163 652c  ace": namespace,
+00013580: 0a20 2020 2020 2020 2020 2020 2022 736f  .            "so
+00013590: 7274 5f62 7922 3a20 736f 7274 5f62 792c  rt_by": sort_by,
+000135a0: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
+000135b0: 6765 5f74 6f6b 656e 223a 2070 6167 655f  ge_token": page_
+000135c0: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+000135d0: 2020 2022 6669 6c74 6572 223a 2066 696c     "filter": fil
+000135e0: 7465 725f 2c0a 2020 2020 2020 2020 2020  ter_,.          
+000135f0: 2020 2266 6f72 6d61 7422 3a20 666f 726d    "format": form
+00013600: 6174 5f2c 0a20 2020 2020 2020 2020 2020  at_,.           
+00013610: 2022 7061 6765 5f73 697a 6522 3a20 7061   "page_size": pa
+00013620: 6765 5f73 697a 652c 0a20 2020 2020 2020  ge_size,.       
+00013630: 207d 0a0a 2020 2020 2020 2020 6572 726f   }..        erro
+00013640: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00013650: 696c 6564 206c 6973 7469 6e67 2070 6970  iled listing pip
+00013660: 656c 696e 6573 2c20 7175 6572 793a 207b  elines, query: {
+00013670: 7061 7261 6d73 7d22 0a20 2020 2020 2020  params}".       
+00013680: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+00013690: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+000136a0: 2020 2020 2020 2022 4745 5422 2c20 6622         "GET", f"
+000136b0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000136c0: 747d 2f70 6970 656c 696e 6573 222c 2065  t}/pipelines", e
+000136d0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
+000136e0: 7261 6d73 3d70 6172 616d 730a 2020 2020  rams=params.    
+000136f0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00013700: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+00013710: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
+00013720: 6e65 734f 7574 7075 7428 2a2a 7265 7370  nesOutput(**resp
+00013730: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+00013740: 2020 6465 6620 6765 745f 7069 7065 6c69    def get_pipeli
+00013750: 6e65 280a 2020 2020 2020 2020 7365 6c66  ne(.        self
+00013760: 2c0a 2020 2020 2020 2020 7275 6e5f 6964  ,.        run_id
+00013770: 3a20 7374 722c 0a20 2020 2020 2020 206e  : str,.        n
+00013780: 616d 6573 7061 6365 3a20 7374 7220 3d20  amespace: str = 
+00013790: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+000137a0: 6d65 6f75 743a 2069 6e74 203d 2033 302c  meout: int = 30,
+000137b0: 0a20 2020 2020 2020 2066 6f72 6d61 745f  .        format_
+000137c0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+000137d0: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
+000137e0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
+000137f0: 6970 656c 696e 6573 466f 726d 6174 0a20  ipelinesFormat. 
+00013800: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00013810: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00013820: 5069 7065 6c69 6e65 7346 6f72 6d61 742e  PipelinesFormat.
+00013830: 7375 6d6d 6172 792c 0a20 2020 2020 2020  summary,.       
+00013840: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
+00013850: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
+00013860: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00013870: 2064 6574 6169 6c73 206f 6620 6120 7370   details of a sp
+00013880: 6563 6966 6963 2070 6970 656c 696e 6520  ecific pipeline 
+00013890: 7573 696e 6720 6974 7320 7275 6e20 4944  using its run ID
+000138a0: 2028 6173 2070 726f 7669 6465 6420 7768   (as provided wh
+000138b0: 656e 2074 6865 2070 6970 656c 696e 6520  en the pipeline 
+000138c0: 7761 7320 6578 6563 7574 6564 292e 2222  was executed).""
+000138d0: 220a 0a20 2020 2020 2020 2070 6172 616d  "..        param
+000138e0: 7320 3d20 7b7d 0a20 2020 2020 2020 2069  s = {}.        i
+000138f0: 6620 6e61 6d65 7370 6163 653a 0a20 2020  f namespace:.   
+00013900: 2020 2020 2020 2020 2070 6172 616d 735b           params[
+00013910: 226e 616d 6573 7061 6365 225d 203d 206e  "namespace"] = n
+00013920: 616d 6573 7061 6365 0a20 2020 2020 2020  amespace.       
+00013930: 2070 6172 616d 735b 2266 6f72 6d61 7422   params["format"
+00013940: 5d20 3d20 666f 726d 6174 5f0a 2020 2020  ] = format_.    
+00013950: 2020 2020 7072 6f6a 6563 745f 7061 7468      project_path
+00013960: 203d 2070 726f 6a65 6374 2069 6620 7072   = project if pr
+00013970: 6f6a 6563 7420 656c 7365 2022 2a22 0a20  oject else "*". 
+00013980: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+00013990: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+000139a0: 2020 2020 2020 2020 2022 4745 5422 2c0a           "GET",.
+000139b0: 2020 2020 2020 2020 2020 2020 6622 7072              f"pr
+000139c0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 745f  ojects/{project_
+000139d0: 7061 7468 7d2f 7069 7065 6c69 6e65 732f  path}/pipelines/
+000139e0: 7b72 756e 5f69 647d 222c 0a20 2020 2020  {run_id}",.     
+000139f0: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
+00013a00: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
+00013a10: 2020 7469 6d65 6f75 743d 7469 6d65 6f75    timeout=timeou
+00013a20: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
+00013a30: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+00013a40: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
+00013a50: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
+00013a60: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
+00013a70: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
+00013a80: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00013a90: 7565 4572 726f 7228 6622 6261 6420 6765  ueError(f"bad ge
+00013aa0: 7420 7069 7065 6c69 6e65 2072 6573 706f  t pipeline respo
+00013ab0: 6e73 652c 207b 7265 7370 2e74 6578 747d  nse, {resp.text}
+00013ac0: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+00013ad0: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
+00013ae0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00013af0: 640a 2020 2020 6465 6620 5f72 6573 6f6c  d.    def _resol
+00013b00: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
+00013b10: 2c20 7569 6429 3a0a 2020 2020 2020 2020  , uid):.        
+00013b20: 6966 2075 6964 2061 6e64 2074 6167 3a0a  if uid and tag:.
+00013b30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00013b40: 6520 4d4c 5275 6e49 6e76 616c 6964 4172  e MLRunInvalidAr
+00013b50: 6775 6d65 6e74 4572 726f 7228 2262 6f74  gumentError("bot
+00013b60: 6820 7569 6420 616e 6420 7461 6720 7765  h uid and tag we
+00013b70: 7265 2070 726f 7669 6465 6422 290a 2020  re provided").  
+00013b80: 2020 2020 2020 7265 7475 726e 2075 6964        return uid
+00013b90: 206f 7220 7461 6720 6f72 2022 6c61 7465   or tag or "late
+00013ba0: 7374 220a 0a20 2020 2064 6566 2063 7265  st"..    def cre
+00013bb0: 6174 655f 6665 6174 7572 655f 7365 7428  ate_feature_set(
+00013bc0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00013bd0: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00013be0: 6574 3a20 556e 696f 6e5b 6469 6374 2c20  et: Union[dict, 
+00013bf0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00013c00: 656d 6173 2e46 6561 7475 7265 5365 742c  emas.FeatureSet,
+00013c10: 2046 6561 7475 7265 5365 745d 2c0a 2020   FeatureSet],.  
+00013c20: 2020 2020 2020 7072 6f6a 6563 743d 2222        project=""
+00013c30: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
+00013c40: 6e65 643d 5472 7565 2c0a 2020 2020 2920  ned=True,.    ) 
+00013c50: 2d3e 2064 6963 743a 0a20 2020 2020 2020  -> dict:.       
+00013c60: 2022 2222 4372 6561 7465 2061 206e 6577   """Create a new
+00013c70: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+00013c80: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
+00013c90: 2e46 6561 7475 7265 5365 7460 2061 6e64  .FeatureSet` and
+00013ca0: 2073 6176 6520 696e 2074 6865 203a 7079   save in the :py
+00013cb0: 3a6d 6f64 3a60 6d6c 7275 6e60 2044 422e  :mod:`mlrun` DB.
+00013cc0: 2054 6865 0a20 2020 2020 2020 2066 6561   The.        fea
+00013cd0: 7475 7265 2d73 6574 206d 7573 7420 6e6f  ture-set must no
+00013ce0: 7420 7072 6576 696f 7573 6c79 2065 7869  t previously exi
+00013cf0: 7374 2069 6e20 7468 6520 4442 2e0a 0a20  st in the DB... 
+00013d00: 2020 2020 2020 203a 7061 7261 6d20 6665         :param fe
+00013d10: 6174 7572 655f 7365 743a 2054 6865 206e  ature_set: The n
+00013d20: 6577 203a 7079 3a63 6c61 7373 3a60 7e6d  ew :py:class:`~m
+00013d30: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00013d40: 7265 2e46 6561 7475 7265 5365 7460 2074  re.FeatureSet` t
+00013d50: 6f20 6372 6561 7465 2e0a 2020 2020 2020  o create..      
+00013d60: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00013d70: 3a20 4e61 6d65 206f 6620 7072 6f6a 6563  : Name of projec
+00013d80: 7420 7468 6973 2066 6561 7475 7265 2d73  t this feature-s
+00013d90: 6574 2062 656c 6f6e 6773 2074 6f2e 0a20  et belongs to.. 
+00013da0: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+00013db0: 7273 696f 6e65 643a 2057 6865 7468 6572  rsioned: Whether
+00013dc0: 2074 6f20 6d61 696e 7461 696e 2076 6572   to maintain ver
+00013dd0: 7369 6f6e 7320 666f 7220 7468 6973 2066  sions for this f
+00013de0: 6561 7475 7265 2d73 6574 2e20 416c 6c20  eature-set. All 
+00013df0: 7665 7273 696f 6e73 206f 6620 6120 7665  versions of a ve
+00013e00: 7273 696f 6e65 6420 6f62 6a65 6374 0a20  rsioned object. 
+00013e10: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00013e20: 6265 206b 6570 7420 696e 2074 6865 2044  be kept in the D
+00013e30: 4220 616e 6420 6361 6e20 6265 2072 6574  B and can be ret
+00013e40: 7269 6576 6564 2075 6e74 696c 2065 7870  rieved until exp
+00013e50: 6c69 6369 746c 7920 6465 6c65 7465 642e  licitly deleted.
+00013e60: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00013e70: 733a 2054 6865 203a 7079 3a63 6c61 7373  s: The :py:class
+00013e80: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+00013e90: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
+00013ea0: 7460 206f 626a 6563 7420 2861 7320 6469  t` object (as di
+00013eb0: 6374 292e 0a20 2020 2020 2020 2022 2222  ct)..        """
+00013ec0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00013ed0: 7374 616e 6365 2866 6561 7475 7265 5f73  stance(feature_s
+00013ee0: 6574 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  et, mlrun.common
+00013ef0: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
+00013f00: 5365 7429 3a0a 2020 2020 2020 2020 2020  Set):.          
+00013f10: 2020 6665 6174 7572 655f 7365 7420 3d20    feature_set = 
+00013f20: 6665 6174 7572 655f 7365 742e 6469 6374  feature_set.dict
+00013f30: 2829 0a20 2020 2020 2020 2065 6c69 6620  ().        elif 
+00013f40: 6973 696e 7374 616e 6365 2866 6561 7475  isinstance(featu
+00013f50: 7265 5f73 6574 2c20 4665 6174 7572 6553  re_set, FeatureS
+00013f60: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
+00013f70: 2066 6561 7475 7265 5f73 6574 203d 2066   feature_set = f
+00013f80: 6561 7475 7265 5f73 6574 2e74 6f5f 6469  eature_set.to_di
+00013f90: 6374 2829 0a0a 2020 2020 2020 2020 7072  ct()..        pr
+00013fa0: 6f6a 6563 7420 3d20 280a 2020 2020 2020  oject = (.      
+00013fb0: 2020 2020 2020 7072 6f6a 6563 740a 2020        project.  
+00013fc0: 2020 2020 2020 2020 2020 6f72 2066 6561            or fea
+00013fd0: 7475 7265 5f73 6574 5b22 6d65 7461 6461  ture_set["metada
+00013fe0: 7461 225d 2e67 6574 2822 7072 6f6a 6563  ta"].get("projec
+00013ff0: 7422 2c20 4e6f 6e65 290a 2020 2020 2020  t", None).      
+00014000: 2020 2020 2020 6f72 2063 6f6e 6669 672e        or config.
+00014010: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00014020: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014030: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00014040: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
+00014050: 6174 7572 652d 7365 7473 220a 2020 2020  ature-sets".    
+00014060: 2020 2020 7061 7261 6d73 203d 207b 2276      params = {"v
+00014070: 6572 7369 6f6e 6564 223a 2076 6572 7369  ersioned": versi
+00014080: 6f6e 6564 7d0a 0a20 2020 2020 2020 206e  oned}..        n
+00014090: 616d 6520 3d20 6665 6174 7572 655f 7365  ame = feature_se
+000140a0: 745b 226d 6574 6164 6174 6122 5d5b 226e  t["metadata"]["n
+000140b0: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
+000140c0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+000140d0: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
+000140e0: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
+000140f0: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00014100: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00014110: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00014120: 2020 2020 2020 2020 2250 4f53 5422 2c0a          "POST",.
+00014130: 2020 2020 2020 2020 2020 2020 7061 7468              path
+00014140: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+00014150: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+00014160: 2020 2020 2020 2020 2070 6172 616d 733d           params=
+00014170: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+00014180: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
+00014190: 5f6a 736f 6e28 6665 6174 7572 655f 7365  _json(feature_se
+000141a0: 7429 2c0a 2020 2020 2020 2020 290a 2020  t),.        ).  
+000141b0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+000141c0: 702e 6a73 6f6e 2829 0a0a 2020 2020 6465  p.json()..    de
+000141d0: 6620 6765 745f 6665 6174 7572 655f 7365  f get_feature_se
+000141e0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+000141f0: 206e 616d 653a 2073 7472 2c20 7072 6f6a   name: str, proj
+00014200: 6563 743a 2073 7472 203d 2022 222c 2074  ect: str = "", t
+00014210: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c20  ag: str = None, 
+00014220: 7569 643a 2073 7472 203d 204e 6f6e 650a  uid: str = None.
+00014230: 2020 2020 2920 2d3e 2046 6561 7475 7265      ) -> Feature
+00014240: 5365 743a 0a20 2020 2020 2020 2022 2222  Set:.        """
+00014250: 5265 7472 6965 7665 2061 207e 6d6c 7275  Retrieve a ~mlru
+00014260: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+00014270: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
+00014280: 6374 2e20 4966 2062 6f74 6820 6060 7461  ct. If both ``ta
+00014290: 6760 6020 616e 6420 6060 7569 6460 6020  g`` and ``uid`` 
+000142a0: 6172 6520 6e6f 7420 7370 6563 6966 6965  are not specifie
+000142b0: 642c 2074 6865 6e0a 2020 2020 2020 2020  d, then.        
+000142c0: 7468 6520 6f62 6a65 6374 2074 6167 6765  the object tagge
+000142d0: 6420 6060 6c61 7465 7374 6060 2077 696c  d ``latest`` wil
+000142e0: 6c20 6265 2072 6574 7269 6576 6564 2e0a  l be retrieved..
+000142f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014300: 6e61 6d65 3a20 4e61 6d65 206f 6620 6f62  name: Name of ob
+00014310: 6a65 6374 2074 6f20 7265 7472 6965 7665  ject to retrieve
+00014320: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00014330: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00014340: 7420 7468 6520 4665 6174 7572 6553 6574  t the FeatureSet
+00014350: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
+00014360: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
+00014370: 2054 6167 206f 6620 7468 6520 7370 6563   Tag of the spec
+00014380: 6966 6963 206f 626a 6563 7420 7665 7273  ific object vers
+00014390: 696f 6e20 746f 2072 6574 7269 6576 652e  ion to retrieve.
+000143a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000143b0: 7569 643a 2075 6964 206f 6620 7468 6520  uid: uid of the 
+000143c0: 6f62 6a65 6374 2074 6f20 7265 7472 6965  object to retrie
+000143d0: 7665 2028 6361 6e20 6f6e 6c79 2062 6520  ve (can only be 
+000143e0: 7573 6564 2066 6f72 2076 6572 7369 6f6e  used for version
+000143f0: 6564 206f 626a 6563 7473 292e 0a20 2020  ed objects)..   
+00014400: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00014410: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00014420: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00014430: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00014440: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+00014450: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+00014460: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
+00014470: 6964 290a 2020 2020 2020 2020 7061 7468  id).        path
+00014480: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00014490: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+000144a0: 7365 7473 2f7b 6e61 6d65 7d2f 7265 6665  sets/{name}/refe
+000144b0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+000144c0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+000144d0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+000144e0: 696c 6564 2072 6574 7269 6576 696e 6720  iled retrieving 
+000144f0: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
+00014500: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00014510: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00014520: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+00014530: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+00014540: 7373 6167 6529 0a20 2020 2020 2020 2072  ssage).        r
+00014550: 6574 7572 6e20 4665 6174 7572 6553 6574  eturn FeatureSet
+00014560: 2e66 726f 6d5f 6469 6374 2872 6573 702e  .from_dict(resp.
+00014570: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00014580: 206c 6973 745f 6665 6174 7572 6573 280a   list_features(.
+00014590: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000145a0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+000145b0: 7472 2c0a 2020 2020 2020 2020 6e61 6d65  tr,.        name
+000145c0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+000145d0: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+000145e0: 204e 6f6e 652c 0a20 2020 2020 2020 2065   None,.        e
+000145f0: 6e74 6974 6965 733a 206c 6973 745b 7374  ntities: list[st
+00014600: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+00014610: 2020 206c 6162 656c 733a 206c 6973 745b     labels: list[
+00014620: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00014630: 2029 202d 3e20 6c69 7374 5b64 6963 745d   ) -> list[dict]
+00014640: 3a0a 2020 2020 2020 2020 2222 224c 6973  :.        """Lis
+00014650: 7420 6665 6174 7572 652d 7365 7473 2077  t feature-sets w
+00014660: 6869 6368 2063 6f6e 7461 696e 2073 7065  hich contain spe
+00014670: 6369 6669 6320 6665 6174 7572 6573 2e20  cific features. 
+00014680: 5468 6973 2066 756e 6374 696f 6e20 6d61  This function ma
+00014690: 7920 7265 7475 726e 206d 756c 7469 706c  y return multipl
+000146a0: 6520 7665 7273 696f 6e73 206f 6620 7468  e versions of th
+000146b0: 6520 7361 6d65 0a20 2020 2020 2020 2066  e same.        f
+000146c0: 6561 7475 7265 2d73 6574 2069 6620 6120  eature-set if a 
+000146d0: 7370 6563 6966 6963 2074 6167 2069 7320  specific tag is 
+000146e0: 6e6f 7420 7265 7175 6573 7465 642e 204e  not requested. N
+000146f0: 6f74 6520 7468 6174 2074 6865 2076 6172  ote that the var
+00014700: 696f 7573 2066 696c 7465 7273 206f 6620  ious filters of 
+00014710: 7468 6973 2066 756e 6374 696f 6e20 6163  this function ac
+00014720: 7475 616c 6c79 0a20 2020 2020 2020 2072  tually.        r
+00014730: 6566 6572 2074 6f20 7468 6520 6665 6174  efer to the feat
+00014740: 7572 652d 7365 7420 6f62 6a65 6374 2063  ure-set object c
+00014750: 6f6e 7461 696e 696e 6720 7468 6520 6665  ontaining the fe
+00014760: 6174 7572 6573 2c20 6e6f 7420 746f 2074  atures, not to t
+00014770: 6865 2066 6561 7475 7265 7320 7468 656d  he features them
+00014780: 7365 6c76 6573 2e0a 0a20 2020 2020 2020  selves...       
+00014790: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+000147a0: 2050 726f 6a65 6374 2077 6869 6368 2063   Project which c
+000147b0: 6f6e 7461 696e 7320 7468 6573 6520 6665  ontains these fe
+000147c0: 6174 7572 6573 2e0a 2020 2020 2020 2020  atures..        
+000147d0: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+000147e0: 6520 6f66 2074 6865 2066 6561 7475 7265  e of the feature
+000147f0: 2074 6f20 6c6f 6f6b 2066 6f72 2e20 5468   to look for. Th
+00014800: 6520 6e61 6d65 2069 7320 7573 6564 2069  e name is used i
+00014810: 6e20 6120 6c69 6b65 2071 7565 7279 2c20  n a like query, 
+00014820: 616e 6420 6973 206e 6f74 2063 6173 652d  and is not case-
+00014830: 7365 6e73 6974 6976 652e 2046 6f72 0a20  sensitive. For. 
+00014840: 2020 2020 2020 2020 2020 2065 7861 6d70             examp
+00014850: 6c65 2c20 6c6f 6f6b 696e 6720 666f 7220  le, looking for 
+00014860: 6060 6665 6174 6060 2077 696c 6c20 7265  ``feat`` will re
+00014870: 7475 726e 2066 6561 7475 7265 7320 7768  turn features wh
+00014880: 6963 6820 6172 6520 6e61 6d65 6420 6060  ich are named ``
+00014890: 4d79 4665 6174 7572 6560 6020 6173 2077  MyFeature`` as w
+000148a0: 656c 6c20 6173 2060 6064 6566 6561 7460  ell as ``defeat`
+000148b0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+000148c0: 6d20 7461 673a 2052 6574 7572 6e20 6665  m tag: Return fe
+000148d0: 6174 7572 652d 7365 7473 2077 6869 6368  ature-sets which
+000148e0: 2063 6f6e 7461 696e 2074 6865 2066 6561   contain the fea
+000148f0: 7475 7265 7320 6c6f 6f6b 6564 2066 6f72  tures looked for
+00014900: 2c20 616e 6420 6172 6520 7461 6767 6564  , and are tagged
+00014910: 2077 6974 6820 7468 6520 7370 6563 6966   with the specif
+00014920: 6963 2074 6167 2e0a 2020 2020 2020 2020  ic tag..        
+00014930: 3a70 6172 616d 2065 6e74 6974 6965 733a  :param entities:
+00014940: 2052 6574 7572 6e20 6f6e 6c79 2066 6561   Return only fea
+00014950: 7475 7265 2d73 6574 7320 7768 6963 6820  ture-sets which 
+00014960: 636f 6e74 6169 6e20 616e 2065 6e74 6974  contain an entit
+00014970: 7920 7768 6f73 6520 6e61 6d65 2069 7320  y whose name is 
+00014980: 636f 6e74 6169 6e65 6420 696e 2074 6869  contained in thi
+00014990: 7320 6c69 7374 2e0a 2020 2020 2020 2020  s list..        
+000149a0: 3a70 6172 616d 206c 6162 656c 733a 2052  :param labels: R
+000149b0: 6574 7572 6e20 6f6e 6c79 2066 6561 7475  eturn only featu
+000149c0: 7265 2d73 6574 7320 7768 6963 6820 6172  re-sets which ar
+000149d0: 6520 6c61 6265 6c65 6420 6173 2072 6571  e labeled as req
+000149e0: 7565 7374 6564 2e0a 2020 2020 2020 2020  uested..        
+000149f0: 3a72 6574 7572 6e73 3a20 4120 6c69 7374  :returns: A list
+00014a00: 206f 6620 6d61 7070 696e 6720 6672 6f6d   of mapping from
+00014a10: 2066 6561 7475 7265 2074 6f20 6120 6469   feature to a di
+00014a20: 6765 7374 206f 6620 7468 6520 6665 6174  gest of the feat
+00014a30: 7572 652d 7365 742c 2077 6869 6368 2063  ure-set, which c
+00014a40: 6f6e 7461 696e 7320 7468 6520 6665 6174  ontains the feat
+00014a50: 7572 652d 7365 740a 2020 2020 2020 2020  ure-set.        
+00014a60: 2020 2020 6d65 7461 2d64 6174 612e 204d      meta-data. M
+00014a70: 756c 7469 706c 6520 656e 7472 6965 7320  ultiple entries 
+00014a80: 6d61 7920 6265 2072 6574 7572 6e65 6420  may be returned 
+00014a90: 666f 7220 616e 7920 7370 6563 6966 6963  for any specific
+00014aa0: 2066 6561 7475 7265 2064 7565 2074 6f20   feature due to 
+00014ab0: 6d75 6c74 6970 6c65 2074 6167 7320 6f72  multiple tags or
+00014ac0: 2076 6572 7369 6f6e 730a 2020 2020 2020   versions.      
+00014ad0: 2020 2020 2020 6f66 2074 6865 2066 6561        of the fea
+00014ae0: 7475 7265 2d73 6574 2e0a 2020 2020 2020  ture-set..      
+00014af0: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00014b00: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00014b10: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00014b20: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00014b30: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00014b40: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00014b50: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
+00014b60: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
+00014b70: 2020 2020 2020 2020 2020 2020 2265 6e74              "ent
+00014b80: 6974 7922 3a20 656e 7469 7469 6573 206f  ity": entities o
+00014b90: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
+00014ba0: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
+00014bb0: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+00014bc0: 207d 0a0a 2020 2020 2020 2020 7061 7468   }..        path
+00014bd0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00014be0: 726f 6a65 6374 7d2f 6665 6174 7572 6573  roject}/features
+00014bf0: 220a 0a20 2020 2020 2020 2065 7272 6f72  "..        error
+00014c00: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00014c10: 6c65 6420 6c69 7374 696e 6720 6665 6174  led listing feat
+00014c20: 7572 6573 2c20 7072 6f6a 6563 743a 207b  ures, project: {
+00014c30: 7072 6f6a 6563 747d 2c20 7175 6572 793a  project}, query:
+00014c40: 207b 7061 7261 6d73 7d22 0a20 2020 2020   {params}".     
+00014c50: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+00014c60: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
+00014c70: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00014c80: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+00014c90: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00014ca0: 6e20 7265 7370 2e6a 736f 6e28 295b 2266  n resp.json()["f
+00014cb0: 6561 7475 7265 7322 5d0a 0a20 2020 2064  eatures"]..    d
+00014cc0: 6566 206c 6973 745f 656e 7469 7469 6573  ef list_entities
+00014cd0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00014ce0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00014cf0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
+00014d00: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
+00014d10: 2020 2020 2020 2020 7461 673a 2073 7472          tag: str
+00014d20: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00014d30: 206c 6162 656c 733a 206c 6973 745b 7374   labels: list[st
+00014d40: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
+00014d50: 202d 3e20 6c69 7374 5b64 6963 745d 3a0a   -> list[dict]:.
+00014d60: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+00014d70: 6576 6520 6120 6c69 7374 206f 6620 656e  eve a list of en
+00014d80: 7469 7469 6573 2061 6e64 2074 6865 6972  tities and their
+00014d90: 206d 6170 7069 6e67 2074 6f20 7468 6520   mapping to the 
+00014da0: 636f 6e74 6169 6e69 6e67 2066 6561 7475  containing featu
+00014db0: 7265 2d73 6574 732e 2054 6869 7320 6675  re-sets. This fu
+00014dc0: 6e63 7469 6f6e 2069 7320 7369 6d69 6c61  nction is simila
+00014dd0: 720a 2020 2020 2020 2020 746f 2074 6865  r.        to the
+00014de0: 203a 7079 3a66 756e 633a 607e 6c69 7374   :py:func:`~list
+00014df0: 5f66 6561 7475 7265 7360 2066 756e 6374  _features` funct
+00014e00: 696f 6e2c 2061 6e64 2075 7365 7320 7468  ion, and uses th
+00014e10: 6520 7361 6d65 206c 6f67 6963 2e20 486f  e same logic. Ho
+00014e20: 7765 7665 722c 2074 6865 2065 6e74 6974  wever, the entit
+00014e30: 6965 7320 6172 6520 6d61 7463 6865 640a  ies are matched.
+00014e40: 2020 2020 2020 2020 6167 6169 6e73 7420          against 
+00014e50: 7468 6520 6e61 6d65 2072 6174 6865 7220  the name rather 
+00014e60: 7468 616e 2074 6865 2066 6561 7475 7265  than the feature
+00014e70: 732e 0a20 2020 2020 2020 2022 2222 0a0a  s..        """..
+00014e80: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00014e90: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00014ea0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00014eb0: 6563 740a 2020 2020 2020 2020 7061 7261  ect.        para
+00014ec0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00014ed0: 2020 2022 6e61 6d65 223a 206e 616d 652c     "name": name,
+00014ee0: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
+00014ef0: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
+00014f00: 2020 2020 2022 6c61 6265 6c22 3a20 6c61       "label": la
+00014f10: 6265 6c73 206f 7220 5b5d 2c0a 2020 2020  bels or [],.    
+00014f20: 2020 2020 7d0a 0a20 2020 2020 2020 2070      }..        p
+00014f30: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00014f40: 2f7b 7072 6f6a 6563 747d 2f65 6e74 6974  /{project}/entit
+00014f50: 6965 7322 0a0a 2020 2020 2020 2020 6572  ies"..        er
+00014f60: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00014f70: 4661 696c 6564 206c 6973 7469 6e67 2065  Failed listing e
+00014f80: 6e74 6974 6965 732c 2070 726f 6a65 6374  ntities, project
+00014f90: 3a20 7b70 726f 6a65 6374 7d2c 2071 7565  : {project}, que
+00014fa0: 7279 3a20 7b70 6172 616d 737d 220a 2020  ry: {params}".  
+00014fb0: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00014fc0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+00014fd0: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+00014fe0: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
+00014ff0: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+00015000: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
+00015010: 5b22 656e 7469 7469 6573 225d 0a0a 2020  ["entities"]..  
+00015020: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+00015030: 2020 2020 6465 6620 5f67 656e 6572 6174      def _generat
+00015040: 655f 7061 7274 6974 696f 6e5f 6279 5f70  e_partition_by_p
+00015050: 6172 616d 7328 0a20 2020 2020 2020 2070  arams(.        p
+00015060: 6172 7469 7469 6f6e 5f62 795f 636c 732c  artition_by_cls,
+00015070: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+00015080: 6f6e 5f62 792c 0a20 2020 2020 2020 2072  on_by,.        r
+00015090: 6f77 735f 7065 725f 7061 7274 6974 696f  ows_per_partitio
+000150a0: 6e2c 0a20 2020 2020 2020 2073 6f72 745f  n,.        sort_
+000150b0: 6279 2c0a 2020 2020 2020 2020 6f72 6465  by,.        orde
+000150c0: 722c 0a20 2020 2020 2020 206d 6178 5f70  r,.        max_p
+000150d0: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
+000150e0: 2020 2020 293a 0a20 2020 2020 2020 2070      ):.        p
+000150f0: 6172 7469 7469 6f6e 5f70 6172 616d 7320  artition_params 
+00015100: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00015110: 2270 6172 7469 7469 6f6e 2d62 7922 3a20  "partition-by": 
+00015120: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
+00015130: 2020 2020 2020 2020 2020 2272 6f77 732d            "rows-
+00015140: 7065 722d 7061 7274 6974 696f 6e22 3a20  per-partition": 
+00015150: 726f 7773 5f70 6572 5f70 6172 7469 7469  rows_per_partiti
+00015160: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00015170: 2270 6172 7469 7469 6f6e 2d73 6f72 742d  "partition-sort-
+00015180: 6279 223a 2073 6f72 745f 6279 2c0a 2020  by": sort_by,.  
+00015190: 2020 2020 2020 2020 2020 2270 6172 7469            "parti
+000151a0: 7469 6f6e 2d6f 7264 6572 223a 206f 7264  tion-order": ord
+000151b0: 6572 2c0a 2020 2020 2020 2020 7d0a 2020  er,.        }.  
+000151c0: 2020 2020 2020 6966 206d 6178 5f70 6172        if max_par
+000151d0: 7469 7469 6f6e 7320 6973 206e 6f74 204e  titions is not N
+000151e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000151f0: 2070 6172 7469 7469 6f6e 5f70 6172 616d   partition_param
+00015200: 735b 226d 6178 2d70 6172 7469 7469 6f6e  s["max-partition
+00015210: 7322 5d20 3d20 6d61 785f 7061 7274 6974  s"] = max_partit
+00015220: 696f 6e73 0a20 2020 2020 2020 2072 6574  ions.        ret
+00015230: 7572 6e20 7061 7274 6974 696f 6e5f 7061  urn partition_pa
+00015240: 7261 6d73 0a0a 2020 2020 6465 6620 6c69  rams..    def li
+00015250: 7374 5f66 6561 7475 7265 5f73 6574 7328  st_feature_sets(
+00015260: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00015270: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+00015280: 7374 7220 3d20 2222 2c0a 2020 2020 2020  str = "",.      
+00015290: 2020 6e61 6d65 3a20 7374 7220 3d20 4e6f    name: str = No
+000152a0: 6e65 2c0a 2020 2020 2020 2020 7461 673a  ne,.        tag:
+000152b0: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+000152c0: 2020 2020 2073 7461 7465 3a20 7374 7220       state: str 
+000152d0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+000152e0: 656e 7469 7469 6573 3a20 6c69 7374 5b73  entities: list[s
+000152f0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00015300: 2020 2020 6665 6174 7572 6573 3a20 6c69      features: li
+00015310: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
+00015320: 2020 2020 2020 2020 6c61 6265 6c73 3a20          labels: 
+00015330: 6c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  list[str] = None
+00015340: 2c0a 2020 2020 2020 2020 7061 7274 6974  ,.        partit
+00015350: 696f 6e5f 6279 3a20 556e 696f 6e5b 0a20  ion_by: Union[. 
+00015360: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+00015370: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00015380: 4665 6174 7572 6553 746f 7265 5061 7274  FeatureStorePart
+00015390: 6974 696f 6e42 7946 6965 6c64 2c20 7374  itionByField, st
+000153a0: 720a 2020 2020 2020 2020 5d20 3d20 4e6f  r.        ] = No
+000153b0: 6e65 2c0a 2020 2020 2020 2020 726f 7773  ne,.        rows
+000153c0: 5f70 6572 5f70 6172 7469 7469 6f6e 3a20  _per_partition: 
+000153d0: 696e 7420 3d20 312c 0a20 2020 2020 2020  int = 1,.       
+000153e0: 2070 6172 7469 7469 6f6e 5f73 6f72 745f   partition_sort_
+000153f0: 6279 3a20 556e 696f 6e5b 6d6c 7275 6e2e  by: Union[mlrun.
+00015400: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+00015410: 6f72 7446 6965 6c64 2c20 7374 725d 203d  ortField, str] =
+00015420: 204e 6f6e 652c 0a20 2020 2020 2020 2070   None,.        p
+00015430: 6172 7469 7469 6f6e 5f6f 7264 6572 3a20  artition_order: 
+00015440: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+00015450: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00015460: 7363 6865 6d61 732e 4f72 6465 7254 7970  schemas.OrderTyp
+00015470: 652c 2073 7472 0a20 2020 2020 2020 205d  e, str.        ]
+00015480: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+00015490: 7363 6865 6d61 732e 4f72 6465 7254 7970  schemas.OrderTyp
+000154a0: 652e 6465 7363 2c0a 2020 2020 2920 2d3e  e.desc,.    ) ->
+000154b0: 206c 6973 745b 4665 6174 7572 6553 6574   list[FeatureSet
+000154c0: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+000154d0: 7472 6965 7665 2061 206c 6973 7420 6f66  trieve a list of
+000154e0: 2066 6561 7475 7265 2d73 6574 7320 6d61   feature-sets ma
+000154f0: 7463 6869 6e67 2074 6865 2063 7269 7465  tching the crite
+00015500: 7269 6120 7072 6f76 6964 6564 2e0a 0a20  ria provided... 
+00015510: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00015520: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
+00015530: 616d 652e 0a20 2020 2020 2020 203a 7061  ame..        :pa
+00015540: 7261 6d20 6e61 6d65 3a20 4e61 6d65 206f  ram name: Name o
+00015550: 6620 6665 6174 7572 652d 7365 7420 746f  f feature-set to
+00015560: 206d 6174 6368 2e20 5468 6973 2069 7320   match. This is 
+00015570: 6120 6c69 6b65 2071 7565 7279 2c20 616e  a like query, an
+00015580: 6420 6973 2063 6173 652d 696e 7365 6e73  d is case-insens
+00015590: 6974 6976 652e 0a20 2020 2020 2020 203a  itive..        :
+000155a0: 7061 7261 6d20 7461 673a 204d 6174 6368  param tag: Match
+000155b0: 2066 6561 7475 7265 2d73 6574 7320 7769   feature-sets wi
+000155c0: 7468 2073 7065 6369 6669 6320 7461 672e  th specific tag.
+000155d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000155e0: 7374 6174 653a 204d 6174 6368 2066 6561  state: Match fea
+000155f0: 7475 7265 2d73 6574 7320 7769 7468 2061  ture-sets with a
+00015600: 2073 7065 6369 6669 6320 7374 6174 652e   specific state.
+00015610: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00015620: 656e 7469 7469 6573 3a20 4d61 7463 6820  entities: Match 
+00015630: 6665 6174 7572 652d 7365 7473 2077 6869  feature-sets whi
+00015640: 6368 2063 6f6e 7461 696e 2065 6e74 6974  ch contain entit
+00015650: 6965 7320 7768 6f73 6520 6e61 6d65 2069  ies whose name i
+00015660: 7320 696e 2074 6869 7320 6c69 7374 2e0a  s in this list..
+00015670: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+00015680: 6561 7475 7265 733a 204d 6174 6368 2066  eatures: Match f
+00015690: 6561 7475 7265 2d73 6574 7320 7768 6963  eature-sets whic
+000156a0: 6820 636f 6e74 6169 6e20 6665 6174 7572  h contain featur
+000156b0: 6573 2077 686f 7365 206e 616d 6520 6973  es whose name is
+000156c0: 2069 6e20 7468 6973 206c 6973 742e 0a20   in this list.. 
+000156d0: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+000156e0: 6265 6c73 3a20 4d61 7463 6820 6665 6174  bels: Match feat
+000156f0: 7572 652d 7365 7473 2077 6869 6368 2068  ure-sets which h
+00015700: 6176 6520 7468 6573 6520 6c61 6265 6c73  ave these labels
+00015710: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00015720: 2070 6172 7469 7469 6f6e 5f62 793a 2046   partition_by: F
+00015730: 6965 6c64 2074 6f20 6772 6f75 7020 7265  ield to group re
+00015740: 7375 6c74 7320 6279 2e20 4f6e 6c79 2061  sults by. Only a
+00015750: 6c6c 6f77 6564 2076 616c 7565 2069 7320  llowed value is 
+00015760: 606e 616d 6560 2e20 5768 656e 2060 7061  `name`. When `pa
+00015770: 7274 6974 696f 6e5f 6279 6020 6973 2073  rtition_by` is s
+00015780: 7065 6369 6669 6564 2c0a 2020 2020 2020  pecified,.      
+00015790: 2020 2020 2020 7468 6520 6070 6172 7469        the `parti
+000157a0: 7469 6f6e 5f73 6f72 745f 6279 6020 7061  tion_sort_by` pa
+000157b0: 7261 6d65 7465 7220 6d75 7374 2062 6520  rameter must be 
+000157c0: 7072 6f76 6964 6564 2061 7320 7765 6c6c  provided as well
+000157d0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000157e0: 2072 6f77 735f 7065 725f 7061 7274 6974   rows_per_partit
+000157f0: 696f 6e3a 2048 6f77 206d 616e 7920 746f  ion: How many to
+00015800: 7020 726f 7773 2028 7065 7220 736f 7274  p rows (per sort
+00015810: 696e 6720 6465 6669 6e65 6420 6279 2060  ing defined by `
+00015820: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
+00015830: 7960 2061 6e64 2060 7061 7274 6974 696f  y` and `partitio
+00015840: 6e5f 6f72 6465 7260 290a 2020 2020 2020  n_order`).      
+00015850: 2020 2020 2020 746f 2072 6574 7572 6e20        to return 
+00015860: 7065 7220 6772 6f75 702e 2044 6566 6175  per group. Defau
+00015870: 6c74 2076 616c 7565 2069 7320 312e 0a20  lt value is 1.. 
+00015880: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00015890: 7274 6974 696f 6e5f 736f 7274 5f62 793a  rtition_sort_by:
+000158a0: 2057 6861 7420 6669 656c 6420 746f 2073   What field to s
+000158b0: 6f72 7420 7468 6520 7265 7375 6c74 7320  ort the results 
+000158c0: 6279 2c20 7769 7468 696e 2065 6163 6820  by, within each 
+000158d0: 7061 7274 6974 696f 6e20 6465 6669 6e65  partition define
+000158e0: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
+000158f0: 6279 602e 0a20 2020 2020 2020 2020 2020  by`..           
+00015900: 2043 7572 7265 6e74 6c79 2074 6865 206f   Currently the o
+00015910: 6e6c 7920 616c 6c6f 7765 6420 7661 6c75  nly allowed valu
+00015920: 6520 6172 6520 6063 7265 6174 6564 6020  e are `created` 
+00015930: 616e 6420 6075 7064 6174 6564 602e 0a20  and `updated`.. 
+00015940: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00015950: 7274 6974 696f 6e5f 6f72 6465 723a 204f  rtition_order: O
+00015960: 7264 6572 206f 6620 736f 7274 696e 6720  rder of sorting 
+00015970: 7769 7468 696e 2070 6172 7469 7469 6f6e  within partition
+00015980: 7320 2d20 6061 7363 6020 6f72 2060 6465  s - `asc` or `de
+00015990: 7363 602e 2044 6566 6175 6c74 2069 7320  sc`. Default is 
+000159a0: 6064 6573 6360 2e0a 2020 2020 2020 2020  `desc`..        
+000159b0: 3a72 6574 7572 6e73 3a20 4c69 7374 206f  :returns: List o
+000159c0: 6620 6d61 7463 6869 6e67 203a 7079 3a63  f matching :py:c
+000159d0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000159e0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+000159f0: 7265 5365 7460 206f 626a 6563 7473 2e0a  reSet` objects..
+00015a00: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00015a10: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00015a20: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00015a30: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00015a40: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+00015a50: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00015a60: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
+00015a70: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
+00015a80: 6522 3a20 7374 6174 652c 0a20 2020 2020  e": state,.     
+00015a90: 2020 2020 2020 2022 7461 6722 3a20 7461         "tag": ta
+00015aa0: 672c 0a20 2020 2020 2020 2020 2020 2022  g,.            "
+00015ab0: 656e 7469 7479 223a 2065 6e74 6974 6965  entity": entitie
+00015ac0: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+00015ad0: 2020 2020 2022 6665 6174 7572 6522 3a20       "feature": 
+00015ae0: 6665 6174 7572 6573 206f 7220 5b5d 2c0a  features or [],.
+00015af0: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
+00015b00: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
+00015b10: 5d2c 0a20 2020 2020 2020 207d 0a20 2020  ],.        }.   
+00015b20: 2020 2020 2069 6620 7061 7274 6974 696f       if partitio
+00015b30: 6e5f 6279 3a0a 2020 2020 2020 2020 2020  n_by:.          
+00015b40: 2020 7061 7261 6d73 2e75 7064 6174 6528    params.update(
+00015b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015b60: 2073 656c 662e 5f67 656e 6572 6174 655f   self._generate_
+00015b70: 7061 7274 6974 696f 6e5f 6279 5f70 6172  partition_by_par
+00015b80: 616d 7328 0a20 2020 2020 2020 2020 2020  ams(.           
+00015b90: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
+00015ba0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4665  ommon.schemas.Fe
+00015bb0: 6174 7572 6553 746f 7265 5061 7274 6974  atureStorePartit
+00015bc0: 696f 6e42 7946 6965 6c64 2c0a 2020 2020  ionByField,.    
+00015bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015be0: 7061 7274 6974 696f 6e5f 6279 2c0a 2020  partition_by,.  
+00015bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c00: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
+00015c10: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00015c20: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00015c30: 696f 6e5f 736f 7274 5f62 792c 0a20 2020  ion_sort_by,.   
+00015c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c50: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
+00015c60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015c70: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00015c80: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+00015c90: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00015ca0: 6f6a 6563 747d 2f66 6561 7475 7265 2d73  oject}/feature-s
+00015cb0: 6574 7322 0a0a 2020 2020 2020 2020 6572  ets"..        er
+00015cc0: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
+00015cd0: 2020 2020 2020 2020 2020 2020 6622 4661              f"Fa
+00015ce0: 696c 6564 206c 6973 7469 6e67 2066 6561  iled listing fea
+00015cf0: 7475 7265 2d73 6574 732c 2070 726f 6a65  ture-sets, proje
+00015d00: 6374 3a20 7b70 726f 6a65 6374 7d2c 2071  ct: {project}, q
+00015d10: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
+00015d20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015d30: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00015d40: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+00015d50: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+00015d60: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
+00015d70: 290a 2020 2020 2020 2020 6665 6174 7572  ).        featur
+00015d80: 655f 7365 7473 203d 2072 6573 702e 6a73  e_sets = resp.js
+00015d90: 6f6e 2829 5b22 6665 6174 7572 655f 7365  on()["feature_se
+00015da0: 7473 225d 0a20 2020 2020 2020 2069 6620  ts"].        if 
+00015db0: 6665 6174 7572 655f 7365 7473 3a0a 2020  feature_sets:.  
+00015dc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00015dd0: 205b 4665 6174 7572 6553 6574 2e66 726f   [FeatureSet.fro
+00015de0: 6d5f 6469 6374 286f 626a 2920 666f 7220  m_dict(obj) for 
+00015df0: 6f62 6a20 696e 2066 6561 7475 7265 5f73  obj in feature_s
+00015e00: 6574 735d 0a0a 2020 2020 6465 6620 7374  ets]..    def st
+00015e10: 6f72 655f 6665 6174 7572 655f 7365 7428  ore_feature_set(
+00015e20: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00015e30: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00015e40: 6574 3a20 556e 696f 6e5b 6469 6374 2c20  et: Union[dict, 
+00015e50: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00015e60: 656d 6173 2e46 6561 7475 7265 5365 742c  emas.FeatureSet,
+00015e70: 2046 6561 7475 7265 5365 745d 2c0a 2020   FeatureSet],.  
+00015e80: 2020 2020 2020 6e61 6d65 3d4e 6f6e 652c        name=None,
+00015e90: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00015ea0: 3d22 222c 0a20 2020 2020 2020 2074 6167  ="",.        tag
+00015eb0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2075  =None,.        u
+00015ec0: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
+00015ed0: 2076 6572 7369 6f6e 6564 3d54 7275 652c   versioned=True,
+00015ee0: 0a20 2020 2029 202d 3e20 6469 6374 3a0a  .    ) -> dict:.
+00015ef0: 2020 2020 2020 2020 2222 2253 6176 6520          """Save 
+00015f00: 6120 3a70 793a 636c 6173 733a 607e 6d6c  a :py:class:`~ml
+00015f10: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
+00015f20: 652e 4665 6174 7572 6553 6574 6020 6f62  e.FeatureSet` ob
+00015f30: 6a65 6374 2069 6e20 7468 6520 3a70 793a  ject in the :py:
+00015f40: 6d6f 643a 606d 6c72 756e 6020 4442 2e20  mod:`mlrun` DB. 
+00015f50: 5468 650a 2020 2020 2020 2020 6665 6174  The.        feat
+00015f60: 7572 652d 7365 7420 6361 6e20 6265 2065  ure-set can be e
+00015f70: 6974 6865 7220 6120 6e65 7720 6f62 6a65  ither a new obje
+00015f80: 6374 206f 7220 6120 6d6f 6469 6669 6361  ct or a modifica
+00015f90: 7469 6f6e 2074 6f20 6578 6973 7469 6e67  tion to existing
+00015fa0: 206f 626a 6563 7420 7265 6665 7265 6e63   object referenc
+00015fb0: 6564 2062 7920 7468 6520 7061 7261 6d73  ed by the params
+00015fc0: 206f 660a 2020 2020 2020 2020 7468 6520   of.        the 
+00015fd0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
+00015fe0: 2020 203a 7061 7261 6d20 6665 6174 7572     :param featur
+00015ff0: 655f 7365 743a 2054 6865 203a 7079 3a63  e_set: The :py:c
+00016000: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+00016010: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+00016020: 7265 5365 7460 2074 6f20 7374 6f72 652e  reSet` to store.
+00016030: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00016040: 6e61 6d65 3a20 2020 204e 616d 6520 6f66  name:    Name of
+00016050: 2066 6561 7475 7265 2073 6574 2e0a 2020   feature set..  
+00016060: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00016070: 6a65 6374 3a20 4e61 6d65 206f 6620 7072  ject: Name of pr
+00016080: 6f6a 6563 7420 7468 6973 2066 6561 7475  oject this featu
+00016090: 7265 2d73 6574 2062 656c 6f6e 6773 2074  re-set belongs t
+000160a0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+000160b0: 6d20 7461 673a 2054 6865 2060 6074 6167  m tag: The ``tag
+000160c0: 6060 206f 6620 7468 6520 6f62 6a65 6374  `` of the object
+000160d0: 2074 6f20 7265 706c 6163 6520 696e 2074   to replace in t
+000160e0: 6865 2044 422c 2066 6f72 2065 7861 6d70  he DB, for examp
+000160f0: 6c65 2060 606c 6174 6573 7460 602e 0a20  le ``latest``.. 
+00016100: 2020 2020 2020 203a 7061 7261 6d20 7569         :param ui
+00016110: 643a 2054 6865 2060 6075 6964 6060 206f  d: The ``uid`` o
+00016120: 6620 7468 6520 6f62 6a65 6374 2074 6f20  f the object to 
+00016130: 7265 706c 6163 6520 696e 2074 6865 2044  replace in the D
+00016140: 422e 2049 6620 7573 696e 6720 7468 6973  B. If using this
+00016150: 2070 6172 616d 6574 6572 2c20 7468 6520   parameter, the 
+00016160: 6d6f 6469 6669 6564 206f 626a 6563 740a  modified object.
+00016170: 2020 2020 2020 2020 2020 2020 6d75 7374              must
+00016180: 2068 6176 6520 7468 6520 7361 6d65 2060   have the same `
+00016190: 6075 6964 6060 206f 6620 7468 6520 7072  `uid`` of the pr
+000161a0: 6576 696f 7573 6c79 2d65 7869 7374 696e  eviously-existin
+000161b0: 6720 6f62 6a65 6374 2e20 5468 6973 2063  g object. This c
+000161c0: 616e 6e6f 7420 6265 2075 7365 6420 666f  annot be used fo
+000161d0: 7220 6e6f 6e2d 7665 7273 696f 6e65 6420  r non-versioned 
+000161e0: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+000161f0: 203a 7061 7261 6d20 7665 7273 696f 6e65   :param versione
+00016200: 643a 2057 6865 7468 6572 2074 6f20 6d61  d: Whether to ma
+00016210: 696e 7461 696e 2076 6572 7369 6f6e 7320  intain versions 
+00016220: 666f 7220 7468 6973 2066 6561 7475 7265  for this feature
+00016230: 2d73 6574 2e20 416c 6c20 7665 7273 696f  -set. All versio
+00016240: 6e73 206f 6620 6120 7665 7273 696f 6e65  ns of a versione
+00016250: 6420 6f62 6a65 6374 0a20 2020 2020 2020  d object.       
+00016260: 2020 2020 2077 696c 6c20 6265 206b 6570       will be kep
+00016270: 7420 696e 2074 6865 2044 4220 616e 6420  t in the DB and 
+00016280: 6361 6e20 6265 2072 6574 7269 6576 6564  can be retrieved
+00016290: 2075 6e74 696c 2065 7870 6c69 6369 746c   until explicitl
+000162a0: 7920 6465 6c65 7465 642e 0a20 2020 2020  y deleted..     
+000162b0: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
+000162c0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+000162d0: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
+000162e0: 2e46 6561 7475 7265 5365 7460 206f 626a  .FeatureSet` obj
+000162f0: 6563 7420 2861 7320 6469 6374 292e 0a20  ect (as dict).. 
+00016300: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00016310: 2020 2020 7265 6665 7265 6e63 6520 3d20      reference = 
+00016320: 7365 6c66 2e5f 7265 736f 6c76 655f 7265  self._resolve_re
+00016330: 6665 7265 6e63 6528 7461 672c 2075 6964  ference(tag, uid
+00016340: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
+00016350: 203d 207b 2276 6572 7369 6f6e 6564 223a   = {"versioned":
+00016360: 2076 6572 7369 6f6e 6564 7d0a 0a20 2020   versioned}..   
+00016370: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00016380: 6365 2866 6561 7475 7265 5f73 6574 2c20  ce(feature_set, 
+00016390: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000163a0: 656d 6173 2e46 6561 7475 7265 5365 7429  emas.FeatureSet)
+000163b0: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
+000163c0: 6174 7572 655f 7365 7420 3d20 6665 6174  ature_set = feat
+000163d0: 7572 655f 7365 742e 6469 6374 2829 0a20  ure_set.dict(). 
+000163e0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000163f0: 7374 616e 6365 2866 6561 7475 7265 5f73  stance(feature_s
+00016400: 6574 2c20 4665 6174 7572 6553 6574 293a  et, FeatureSet):
+00016410: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00016420: 7475 7265 5f73 6574 203d 2066 6561 7475  ture_set = featu
+00016430: 7265 5f73 6574 2e74 6f5f 6469 6374 2829  re_set.to_dict()
+00016440: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+00016450: 206e 616d 6520 6f72 2066 6561 7475 7265   name or feature
+00016460: 5f73 6574 5b22 6d65 7461 6461 7461 225d  _set["metadata"]
+00016470: 5b22 6e61 6d65 225d 0a20 2020 2020 2020  ["name"].       
+00016480: 2070 726f 6a65 6374 203d 2028 0a20 2020   project = (.   
+00016490: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+000164a0: 206f 7220 6665 6174 7572 655f 7365 745b   or feature_set[
+000164b0: 226d 6574 6164 6174 6122 5d2e 6765 7428  "metadata"].get(
+000164c0: 2270 726f 6a65 6374 2229 206f 7220 636f  "project") or co
+000164d0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+000164e0: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
+000164f0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00016500: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00016510: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
+00016520: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
+00016530: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
+00016540: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00016550: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00016560: 7374 6f72 696e 6720 6665 6174 7572 652d  storing feature-
+00016570: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
+00016580: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00016590: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+000165a0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+000165b0: 2250 5554 222c 2070 6174 682c 2065 7272  "PUT", path, err
+000165c0: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
+000165d0: 6d73 3d70 6172 616d 732c 2062 6f64 793d  ms=params, body=
+000165e0: 6469 6374 5f74 6f5f 6a73 6f6e 2866 6561  dict_to_json(fea
+000165f0: 7475 7265 5f73 6574 290a 2020 2020 2020  ture_set).      
+00016600: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00016610: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
+00016620: 2020 2020 6465 6620 7061 7463 685f 6665      def patch_fe
+00016630: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
+00016640: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00016650: 206e 616d 652c 0a20 2020 2020 2020 2066   name,.        f
+00016660: 6561 7475 7265 5f73 6574 5f75 7064 6174  eature_set_updat
+00016670: 653a 2064 6963 742c 0a20 2020 2020 2020  e: dict,.       
+00016680: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
+00016690: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
+000166a0: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
+000166b0: 0a20 2020 2020 2020 2070 6174 6368 5f6d  .        patch_m
+000166c0: 6f64 653a 2055 6e69 6f6e 5b0a 2020 2020  ode: Union[.    
+000166d0: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
+000166e0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000166f0: 732e 5061 7463 684d 6f64 650a 2020 2020  s.PatchMode.    
+00016700: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
+00016710: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6174  mmon.schemas.Pat
+00016720: 6368 4d6f 6465 2e72 6570 6c61 6365 2c0a  chMode.replace,.
+00016730: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00016740: 2222 4d6f 6469 6679 2028 7061 7463 6829  ""Modify (patch)
+00016750: 2061 6e20 6578 6973 7469 6e67 203a 7079   an existing :py
+00016760: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
+00016770: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
+00016780: 7475 7265 5365 7460 206f 626a 6563 742e  tureSet` object.
+00016790: 0a20 2020 2020 2020 2054 6865 206f 626a  .        The obj
+000167a0: 6563 7420 6973 2069 6465 6e74 6966 6965  ect is identifie
+000167b0: 6420 6279 2069 7473 206e 616d 6520 2861  d by its name (a
+000167c0: 6e64 2070 726f 6a65 6374 2069 7420 6265  nd project it be
+000167d0: 6c6f 6e67 7320 746f 292c 2061 7320 7765  longs to), as we
+000167e0: 6c6c 2061 7320 6f70 7469 6f6e 616c 6c79  ll as optionally
+000167f0: 2061 2060 6074 6167 6060 206f 7220 6974   a ``tag`` or it
+00016800: 730a 2020 2020 2020 2020 6060 7569 6460  s.        ``uid`
+00016810: 6020 2866 6f72 2076 6572 7369 6f6e 6564  ` (for versioned
+00016820: 206f 626a 6563 7429 2e20 4966 2062 6f74   object). If bot
+00016830: 6820 6060 7461 6760 6020 616e 6420 6060  h ``tag`` and ``
+00016840: 7569 6460 6020 6172 6520 6f6d 6974 7465  uid`` are omitte
+00016850: 6420 7468 656e 2074 6865 206f 626a 6563  d then the objec
+00016860: 7420 7769 7468 2074 6167 2060 606c 6174  t with tag ``lat
+00016870: 6573 7460 600a 2020 2020 2020 2020 6973  est``.        is
+00016880: 206d 6f64 6966 6965 642e 0a0a 2020 2020   modified...    
+00016890: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
+000168a0: 204e 616d 6520 6f66 2074 6865 206f 626a   Name of the obj
+000168b0: 6563 7420 746f 2070 6174 6368 2e0a 2020  ect to patch..  
+000168c0: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
+000168d0: 7475 7265 5f73 6574 5f75 7064 6174 653a  ture_set_update:
+000168e0: 2054 6865 206d 6f64 6966 6963 6174 696f   The modificatio
+000168f0: 6e73 206e 6565 6465 6420 696e 2074 6865  ns needed in the
+00016900: 206f 626a 6563 742e 2054 6869 7320 7061   object. This pa
+00016910: 7261 6d65 7465 7220 6f6e 6c79 2068 6173  rameter only has
+00016920: 2074 6865 2063 6861 6e67 6573 2069 6e20   the changes in 
+00016930: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
+00016940: 6e6f 7420 6120 6675 6c6c 206f 626a 6563  not a full objec
+00016950: 742e 0a20 2020 2020 2020 2020 2020 2045  t..            E
+00016960: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
+00016970: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00016980: 655f 7365 745f 7570 6461 7465 203d 207b  e_set_update = {
+00016990: 2273 7461 7475 7322 3a20 7b22 7072 6f63  "status": {"proc
+000169a0: 6573 7365 6422 203a 2054 7275 657d 7d0a  essed" : True}}.
+000169b0: 0a20 2020 2020 2020 2020 2020 2057 696c  .            Wil
+000169c0: 6c20 6170 706c 7920 7468 6520 6669 656c  l apply the fiel
+000169d0: 6420 6060 7374 6174 7573 2e70 726f 6365  d ``status.proce
+000169e0: 7373 6564 6060 2074 6f20 7468 6520 6578  ssed`` to the ex
+000169f0: 6973 7469 6e67 206f 626a 6563 742e 0a20  isting object.. 
+00016a00: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00016a10: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
+00016a20: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
+00016a30: 6520 6d6f 6469 6669 6564 206f 626a 6563  e modified objec
+00016a40: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+00016a50: 6d20 7461 673a 2054 6865 2074 6167 206f  m tag: The tag o
+00016a60: 6620 7468 6520 6f62 6a65 6374 2074 6f20  f the object to 
+00016a70: 6d6f 6469 6679 2e0a 2020 2020 2020 2020  modify..        
+00016a80: 3a70 6172 616d 2075 6964 3a20 7569 6420  :param uid: uid 
+00016a90: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
+00016aa0: 206d 6f64 6966 792e 0a20 2020 2020 2020   modify..       
+00016ab0: 203a 7061 7261 6d20 7061 7463 685f 6d6f   :param patch_mo
+00016ac0: 6465 3a20 5468 6520 7374 7261 7465 6779  de: The strategy
+00016ad0: 2066 6f72 206d 6572 6769 6e67 2074 6865   for merging the
+00016ae0: 2063 6861 6e67 6573 2077 6974 6820 7468   changes with th
+00016af0: 6520 6578 6973 7469 6e67 206f 626a 6563  e existing objec
+00016b00: 742e 2043 616e 2062 6520 6569 7468 6572  t. Can be either
+00016b10: 2060 6072 6570 6c61 6365 6060 0a20 2020   ``replace``.   
+00016b20: 2020 2020 2020 2020 206f 7220 6060 6164           or ``ad
+00016b30: 6469 7469 7665 6060 2e0a 2020 2020 2020  ditive``..      
+00016b40: 2020 2222 220a 2020 2020 2020 2020 7072    """.        pr
+00016b50: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+00016b60: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+00016b70: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+00016b80: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
+00016b90: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
+00016ba0: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
+00016bb0: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
+00016bc0: 3d20 7b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  = {mlrun.common.
+00016bd0: 7363 6865 6d61 732e 4865 6164 6572 4e61  schemas.HeaderNa
+00016be0: 6d65 732e 7061 7463 685f 6d6f 6465 3a20  mes.patch_mode: 
+00016bf0: 7061 7463 685f 6d6f 6465 7d0a 2020 2020  patch_mode}.    
+00016c00: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00016c10: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00016c20: 6665 6174 7572 652d 7365 7473 2f7b 6e61  feature-sets/{na
+00016c30: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
+00016c40: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
+00016c50: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00016c60: 6520 3d20 6622 4661 696c 6564 2075 7064  e = f"Failed upd
+00016c70: 6174 696e 6720 6665 6174 7572 652d 7365  ating feature-se
+00016c80: 7420 7b70 726f 6a65 6374 7d2f 7b6e 616d  t {project}/{nam
+00016c90: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+00016ca0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+00016cb0: 2020 2020 2020 2022 5041 5443 4822 2c0a         "PATCH",.
+00016cc0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+00016cd0: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+00016ce0: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+00016cf0: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+00016d00: 6374 5f74 6f5f 6a73 6f6e 2866 6561 7475  ct_to_json(featu
+00016d10: 7265 5f73 6574 5f75 7064 6174 6529 2c0a  re_set_update),.
+00016d20: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00016d30: 6572 733d 6865 6164 6572 732c 0a20 2020  ers=headers,.   
+00016d40: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00016d50: 6465 6c65 7465 5f66 6561 7475 7265 5f73  delete_feature_s
+00016d60: 6574 2873 656c 662c 206e 616d 652c 2070  et(self, name, p
+00016d70: 726f 6a65 6374 3d22 222c 2074 6167 3d4e  roject="", tag=N
+00016d80: 6f6e 652c 2075 6964 3d4e 6f6e 6529 3a0a  one, uid=None):.
+00016d90: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
+00016da0: 6520 6120 3a70 793a 636c 6173 733a 607e  e a :py:class:`~
+00016db0: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
+00016dc0: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
+00016dd0: 6f62 6a65 6374 2066 726f 6d20 7468 6520  object from the 
+00016de0: 4442 2e0a 2020 2020 2020 2020 4966 2060  DB..        If `
+00016df0: 6074 6167 6060 206f 7220 6060 7569 6460  `tag`` or ``uid`
+00016e00: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
+00016e10: 2074 6865 6e20 6a75 7374 2074 6865 2076   then just the v
+00016e20: 6572 7369 6f6e 2072 6566 6572 656e 6365  ersion reference
+00016e30: 6420 6279 2074 6865 6d20 7769 6c6c 2062  d by them will b
+00016e40: 6520 6465 6c65 7465 642e 2055 7369 6e67  e deleted. Using
+00016e50: 2062 6f74 680a 2020 2020 2020 2020 6973   both.        is
+00016e60: 206e 6f74 2061 6c6c 6f77 6564 2e0a 2020   not allowed..  
+00016e70: 2020 2020 2020 4966 206e 6f6e 6520 6172        If none ar
+00016e80: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
+00016e90: 6e20 616c 6c20 696e 7374 616e 6365 7320  n all instances 
+00016ea0: 6f66 2074 6865 206f 626a 6563 7420 7768  of the object wh
+00016eb0: 6f73 6520 6e61 6d65 2069 7320 6060 6e61  ose name is ``na
+00016ec0: 6d65 6060 2077 696c 6c20 6265 2064 656c  me`` will be del
+00016ed0: 6574 6564 2e0a 2020 2020 2020 2020 2222  eted..        ""
+00016ee0: 220a 2020 2020 2020 2020 7072 6f6a 6563  ".        projec
+00016ef0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+00016f00: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+00016f10: 6f6a 6563 740a 2020 2020 2020 2020 7061  oject.        pa
+00016f20: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00016f30: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00016f40: 652d 7365 7473 2f7b 6e61 6d65 7d22 0a0a  e-sets/{name}"..
+00016f50: 2020 2020 2020 2020 6966 2074 6167 206f          if tag o
+00016f60: 7220 7569 643a 0a20 2020 2020 2020 2020  r uid:.         
+00016f70: 2020 2072 6566 6572 656e 6365 203d 2073     reference = s
+00016f80: 656c 662e 5f72 6573 6f6c 7665 5f72 6566  elf._resolve_ref
+00016f90: 6572 656e 6365 2874 6167 2c20 7569 6429  erence(tag, uid)
+00016fa0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00016fb0: 6820 3d20 7061 7468 202b 2066 222f 7265  h = path + f"/re
+00016fc0: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
+00016fd0: 6e63 657d 220a 0a20 2020 2020 2020 2065  nce}"..        e
+00016fe0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00016ff0: 2246 6169 6c65 6420 6465 6c65 7469 6e67  "Failed deleting
+00017000: 2066 6561 7475 7265 2d73 6574 207b 6e61   feature-set {na
+00017010: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
+00017020: 662e 6170 695f 6361 6c6c 2822 4445 4c45  f.api_call("DELE
+00017030: 5445 222c 2070 6174 682c 2065 7272 6f72  TE", path, error
+00017040: 5f6d 6573 7361 6765 290a 0a20 2020 2064  _message)..    d
+00017050: 6566 2063 7265 6174 655f 6665 6174 7572  ef create_featur
+00017060: 655f 7665 6374 6f72 280a 2020 2020 2020  e_vector(.      
+00017070: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00017080: 6665 6174 7572 655f 7665 6374 6f72 3a20  feature_vector: 
+00017090: 556e 696f 6e5b 6469 6374 2c20 6d6c 7275  Union[dict, mlru
+000170a0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000170b0: 2e46 6561 7475 7265 5665 6374 6f72 2c20  .FeatureVector, 
+000170c0: 4665 6174 7572 6556 6563 746f 725d 2c0a  FeatureVector],.
+000170d0: 2020 2020 2020 2020 7072 6f6a 6563 743d          project=
+000170e0: 2222 2c0a 2020 2020 2020 2020 7665 7273  "",.        vers
+000170f0: 696f 6e65 643d 5472 7565 2c0a 2020 2020  ioned=True,.    
+00017100: 2920 2d3e 2064 6963 743a 0a20 2020 2020  ) -> dict:.     
+00017110: 2020 2022 2222 4372 6561 7465 2061 206e     """Create a n
+00017120: 6577 203a 7079 3a63 6c61 7373 3a60 7e6d  ew :py:class:`~m
+00017130: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00017140: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+00017150: 6020 616e 6420 7361 7665 2069 6e20 7468  ` and save in th
+00017160: 6520 3a70 793a 6d6f 643a 606d 6c72 756e  e :py:mod:`mlrun
+00017170: 6020 4442 2e0a 0a20 2020 2020 2020 203a  ` DB...        :
+00017180: 7061 7261 6d20 6665 6174 7572 655f 7665  param feature_ve
+00017190: 6374 6f72 3a20 5468 6520 6e65 7720 3a70  ctor: The new :p
+000171a0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000171b0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+000171c0: 6174 7572 6556 6563 746f 7260 2074 6f20  atureVector` to 
+000171d0: 6372 6561 7465 2e0a 2020 2020 2020 2020  create..        
+000171e0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+000171f0: 4e61 6d65 206f 6620 7072 6f6a 6563 7420  Name of project 
+00017200: 7468 6973 2066 6561 7475 7265 2d76 6563  this feature-vec
+00017210: 746f 7220 6265 6c6f 6e67 7320 746f 2e0a  tor belongs to..
+00017220: 2020 2020 2020 2020 3a70 6172 616d 2076          :param v
+00017230: 6572 7369 6f6e 6564 3a20 5768 6574 6865  ersioned: Whethe
+00017240: 7220 746f 206d 6169 6e74 6169 6e20 7665  r to maintain ve
+00017250: 7273 696f 6e73 2066 6f72 2074 6869 7320  rsions for this 
+00017260: 6665 6174 7572 652d 7665 6374 6f72 2e20  feature-vector. 
+00017270: 416c 6c20 7665 7273 696f 6e73 206f 6620  All versions of 
+00017280: 6120 7665 7273 696f 6e65 6420 6f62 6a65  a versioned obje
+00017290: 6374 0a20 2020 2020 2020 2020 2020 2077  ct.            w
+000172a0: 696c 6c20 6265 206b 6570 7420 696e 2074  ill be kept in t
+000172b0: 6865 2044 4220 616e 6420 6361 6e20 6265  he DB and can be
+000172c0: 2072 6574 7269 6576 6564 2075 6e74 696c   retrieved until
+000172d0: 2065 7870 6c69 6369 746c 7920 6465 6c65   explicitly dele
+000172e0: 7465 642e 0a20 2020 2020 2020 203a 7265  ted..        :re
+000172f0: 7475 726e 733a 2054 6865 203a 7079 3a63  turns: The :py:c
+00017300: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+00017310: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+00017320: 7265 5665 6374 6f72 6020 6f62 6a65 6374  reVector` object
+00017330: 2028 6173 2064 6963 7429 2e0a 2020 2020   (as dict)..    
+00017340: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00017350: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
+00017360: 6174 7572 655f 7665 6374 6f72 2c20 6d6c  ature_vector, ml
+00017370: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00017380: 6173 2e46 6561 7475 7265 5665 6374 6f72  as.FeatureVector
+00017390: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+000173a0: 6561 7475 7265 5f76 6563 746f 7220 3d20  eature_vector = 
+000173b0: 6665 6174 7572 655f 7665 6374 6f72 2e64  feature_vector.d
+000173c0: 6963 7428 290a 2020 2020 2020 2020 656c  ict().        el
+000173d0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
+000173e0: 6174 7572 655f 7665 6374 6f72 2c20 4665  ature_vector, Fe
+000173f0: 6174 7572 6556 6563 746f 7229 3a0a 2020  atureVector):.  
+00017400: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00017410: 655f 7665 6374 6f72 203d 2066 6561 7475  e_vector = featu
+00017420: 7265 5f76 6563 746f 722e 746f 5f64 6963  re_vector.to_dic
+00017430: 7428 290a 0a20 2020 2020 2020 2070 726f  t()..        pro
+00017440: 6a65 6374 203d 2028 0a20 2020 2020 2020  ject = (.       
+00017450: 2020 2020 2070 726f 6a65 6374 0a20 2020       project.   
+00017460: 2020 2020 2020 2020 206f 7220 6665 6174           or feat
+00017470: 7572 655f 7665 6374 6f72 5b22 6d65 7461  ure_vector["meta
+00017480: 6461 7461 225d 2e67 6574 2822 7072 6f6a  data"].get("proj
+00017490: 6563 7422 2c20 4e6f 6e65 290a 2020 2020  ect", None).    
+000174a0: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
+000174b0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+000174c0: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
+000174d0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+000174e0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+000174f0: 6665 6174 7572 652d 7665 6374 6f72 7322  feature-vectors"
+00017500: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00017510: 3d20 7b22 7665 7273 696f 6e65 6422 3a20  = {"versioned": 
+00017520: 7665 7273 696f 6e65 647d 0a0a 2020 2020  versioned}..    
+00017530: 2020 2020 6e61 6d65 203d 2066 6561 7475      name = featu
+00017540: 7265 5f76 6563 746f 725b 226d 6574 6164  re_vector["metad
+00017550: 6174 6122 5d5b 226e 616d 6522 5d0a 2020  ata"]["name"].  
+00017560: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00017570: 6167 6520 3d20 6622 4661 696c 6564 2063  age = f"Failed c
+00017580: 7265 6174 696e 6720 6665 6174 7572 652d  reating feature-
+00017590: 7665 6374 6f72 207b 7072 6f6a 6563 747d  vector {project}
+000175a0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+000175b0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+000175c0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+000175d0: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
+000175e0: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
+000175f0: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+00017600: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
+00017610: 2020 2020 7061 7261 6d73 3d70 6172 616d      params=param
+00017620: 732c 0a20 2020 2020 2020 2020 2020 2062  s,.            b
+00017630: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+00017640: 2866 6561 7475 7265 5f76 6563 746f 7229  (feature_vector)
+00017650: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00017660: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
+00017670: 6a73 6f6e 2829 0a0a 2020 2020 6465 6620  json()..    def 
+00017680: 6765 745f 6665 6174 7572 655f 7665 6374  get_feature_vect
+00017690: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
+000176a0: 2c20 6e61 6d65 3a20 7374 722c 2070 726f  , name: str, pro
+000176b0: 6a65 6374 3a20 7374 7220 3d20 2222 2c20  ject: str = "", 
+000176c0: 7461 673a 2073 7472 203d 204e 6f6e 652c  tag: str = None,
+000176d0: 2075 6964 3a20 7374 7220 3d20 4e6f 6e65   uid: str = None
+000176e0: 0a20 2020 2029 202d 3e20 4665 6174 7572  .    ) -> Featur
+000176f0: 6556 6563 746f 723a 0a20 2020 2020 2020  eVector:.       
+00017700: 2022 2222 5265 7475 726e 2061 2073 7065   """Return a spe
+00017710: 6369 6669 6320 6665 6174 7572 652d 7665  cific feature-ve
+00017720: 6374 6f72 2072 6566 6572 656e 6365 6420  ctor referenced 
+00017730: 6279 2069 7473 2074 6167 206f 7220 7569  by its tag or ui
+00017740: 642e 2049 6620 6e6f 6e65 2061 7265 2070  d. If none are p
+00017750: 726f 7669 6465 642c 2060 606c 6174 6573  rovided, ``lates
+00017760: 7460 6020 7461 6720 7769 6c6c 0a20 2020  t`` tag will.   
+00017770: 2020 2020 2062 6520 7573 6564 2e22 2222       be used."""
+00017780: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+00017790: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+000177a0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+000177b0: 6f6a 6563 740a 2020 2020 2020 2020 7265  oject.        re
+000177c0: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
+000177d0: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
+000177e0: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
+000177f0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00017800: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00017810: 6665 6174 7572 652d 7665 6374 6f72 732f  feature-vectors/
+00017820: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
+00017830: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
+00017840: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00017850: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00017860: 7265 7472 6965 7669 6e67 2066 6561 7475  retrieving featu
+00017870: 7265 2d76 6563 746f 7220 7b70 726f 6a65  re-vector {proje
+00017880: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00017890: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
+000178a0: 6170 695f 6361 6c6c 2822 4745 5422 2c20  api_call("GET", 
+000178b0: 7061 7468 2c20 6572 726f 725f 6d65 7373  path, error_mess
+000178c0: 6167 6529 0a20 2020 2020 2020 2072 6574  age).        ret
+000178d0: 7572 6e20 4665 6174 7572 6556 6563 746f  urn FeatureVecto
+000178e0: 722e 6672 6f6d 5f64 6963 7428 7265 7370  r.from_dict(resp
+000178f0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+00017900: 6620 6c69 7374 5f66 6561 7475 7265 5f76  f list_feature_v
+00017910: 6563 746f 7273 280a 2020 2020 2020 2020  ectors(.        
+00017920: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+00017930: 6f6a 6563 743a 2073 7472 203d 2022 222c  oject: str = "",
+00017940: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
+00017950: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
+00017960: 2020 2074 6167 3a20 7374 7220 3d20 4e6f     tag: str = No
+00017970: 6e65 2c0a 2020 2020 2020 2020 7374 6174  ne,.        stat
+00017980: 653a 2073 7472 203d 204e 6f6e 652c 0a20  e: str = None,. 
+00017990: 2020 2020 2020 206c 6162 656c 733a 206c         labels: l
+000179a0: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
+000179b0: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+000179c0: 6f6e 5f62 793a 2055 6e69 6f6e 5b0a 2020  on_by: Union[.  
+000179d0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+000179e0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
+000179f0: 6561 7475 7265 5374 6f72 6550 6172 7469  eatureStoreParti
+00017a00: 7469 6f6e 4279 4669 656c 642c 2073 7472  tionByField, str
+00017a10: 0a20 2020 2020 2020 205d 203d 204e 6f6e  .        ] = Non
+00017a20: 652c 0a20 2020 2020 2020 2072 6f77 735f  e,.        rows_
+00017a30: 7065 725f 7061 7274 6974 696f 6e3a 2069  per_partition: i
+00017a40: 6e74 203d 2031 2c0a 2020 2020 2020 2020  nt = 1,.        
+00017a50: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
+00017a60: 793a 2055 6e69 6f6e 5b6d 6c72 756e 2e63  y: Union[mlrun.c
+00017a70: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 536f  ommon.schemas.So
+00017a80: 7274 4669 656c 642c 2073 7472 5d20 3d20  rtField, str] = 
+00017a90: 4e6f 6e65 2c0a 2020 2020 2020 2020 7061  None,.        pa
+00017aa0: 7274 6974 696f 6e5f 6f72 6465 723a 2055  rtition_order: U
+00017ab0: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00017ac0: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+00017ad0: 6368 656d 6173 2e4f 7264 6572 5479 7065  chemas.OrderType
+00017ae0: 2c20 7374 720a 2020 2020 2020 2020 5d20  , str.        ] 
+00017af0: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00017b00: 6368 656d 6173 2e4f 7264 6572 5479 7065  chemas.OrderType
+00017b10: 2e64 6573 632c 0a20 2020 2029 202d 3e20  .desc,.    ) -> 
+00017b20: 6c69 7374 5b46 6561 7475 7265 5665 6374  list[FeatureVect
+00017b30: 6f72 5d3a 0a20 2020 2020 2020 2022 2222  or]:.        """
+00017b40: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
+00017b50: 6f66 2066 6561 7475 7265 2d76 6563 746f  of feature-vecto
+00017b60: 7273 206d 6174 6368 696e 6720 7468 6520  rs matching the 
+00017b70: 6372 6974 6572 6961 2070 726f 7669 6465  criteria provide
+00017b80: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
+00017b90: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00017ba0: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
+00017bb0: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
+00017bc0: 616d 6520 6f66 2066 6561 7475 7265 2d76  ame of feature-v
+00017bd0: 6563 746f 7220 746f 206d 6174 6368 2e20  ector to match. 
+00017be0: 5468 6973 2069 7320 6120 6c69 6b65 2071  This is a like q
+00017bf0: 7565 7279 2c20 616e 6420 6973 2063 6173  uery, and is cas
+00017c00: 652d 696e 7365 6e73 6974 6976 652e 0a20  e-insensitive.. 
+00017c10: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+00017c20: 673a 204d 6174 6368 2066 6561 7475 7265  g: Match feature
+00017c30: 2d76 6563 746f 7273 2077 6974 6820 7370  -vectors with sp
+00017c40: 6563 6966 6963 2074 6167 2e0a 2020 2020  ecific tag..    
+00017c50: 2020 2020 3a70 6172 616d 2073 7461 7465      :param state
+00017c60: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
+00017c70: 7665 6374 6f72 7320 7769 7468 2061 2073  vectors with a s
+00017c80: 7065 6369 6669 6320 7374 6174 652e 0a20  pecific state.. 
+00017c90: 2020 2020 2020 203a 7061 7261 6d20 6c61         :param la
+00017ca0: 6265 6c73 3a20 4d61 7463 6820 6665 6174  bels: Match feat
+00017cb0: 7572 652d 7665 6374 6f72 7320 7768 6963  ure-vectors whic
+00017cc0: 6820 6861 7665 2074 6865 7365 206c 6162  h have these lab
+00017cd0: 656c 732e 0a20 2020 2020 2020 203a 7061  els..        :pa
+00017ce0: 7261 6d20 7061 7274 6974 696f 6e5f 6279  ram partition_by
+00017cf0: 3a20 4669 656c 6420 746f 2067 726f 7570  : Field to group
+00017d00: 2072 6573 756c 7473 2062 792e 204f 6e6c   results by. Onl
+00017d10: 7920 616c 6c6f 7765 6420 7661 6c75 6520  y allowed value 
+00017d20: 6973 2060 6e61 6d65 602e 2057 6865 6e20  is `name`. When 
+00017d30: 6070 6172 7469 7469 6f6e 5f62 7960 2069  `partition_by` i
+00017d40: 7320 7370 6563 6966 6965 642c 0a20 2020  s specified,.   
+00017d50: 2020 2020 2020 2020 2074 6865 2060 7061           the `pa
+00017d60: 7274 6974 696f 6e5f 736f 7274 5f62 7960  rtition_sort_by`
+00017d70: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
+00017d80: 6265 2070 726f 7669 6465 6420 6173 2077  be provided as w
+00017d90: 656c 6c2e 0a20 2020 2020 2020 203a 7061  ell..        :pa
+00017da0: 7261 6d20 726f 7773 5f70 6572 5f70 6172  ram rows_per_par
+00017db0: 7469 7469 6f6e 3a20 486f 7720 6d61 6e79  tition: How many
+00017dc0: 2074 6f70 2072 6f77 7320 2870 6572 2073   top rows (per s
+00017dd0: 6f72 7469 6e67 2064 6566 696e 6564 2062  orting defined b
+00017de0: 7920 6070 6172 7469 7469 6f6e 5f73 6f72  y `partition_sor
+00017df0: 745f 6279 6020 616e 6420 6070 6172 7469  t_by` and `parti
+00017e00: 7469 6f6e 5f6f 7264 6572 6029 0a20 2020  tion_order`).   
+00017e10: 2020 2020 2020 2020 2074 6f20 7265 7475           to retu
+00017e20: 726e 2070 6572 2067 726f 7570 2e20 4465  rn per group. De
+00017e30: 6661 756c 7420 7661 6c75 6520 6973 2031  fault value is 1
+00017e40: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00017e50: 2070 6172 7469 7469 6f6e 5f73 6f72 745f   partition_sort_
+00017e60: 6279 3a20 5768 6174 2066 6965 6c64 2074  by: What field t
+00017e70: 6f20 736f 7274 2074 6865 2072 6573 756c  o sort the resul
+00017e80: 7473 2062 792c 2077 6974 6869 6e20 6561  ts by, within ea
+00017e90: 6368 2070 6172 7469 7469 6f6e 2064 6566  ch partition def
+00017ea0: 696e 6564 2062 7920 6070 6172 7469 7469  ined by `partiti
+00017eb0: 6f6e 5f62 7960 2e0a 2020 2020 2020 2020  on_by`..        
+00017ec0: 2020 2020 4375 7272 656e 746c 7920 7468      Currently th
+00017ed0: 6520 6f6e 6c79 2061 6c6c 6f77 6564 2076  e only allowed v
+00017ee0: 616c 7565 7320 6172 6520 6063 7265 6174  alues are `creat
+00017ef0: 6564 6020 616e 6420 6075 7064 6174 6564  ed` and `updated
+00017f00: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+00017f10: 6d20 7061 7274 6974 696f 6e5f 6f72 6465  m partition_orde
+00017f20: 723a 204f 7264 6572 206f 6620 736f 7274  r: Order of sort
+00017f30: 696e 6720 7769 7468 696e 2070 6172 7469  ing within parti
+00017f40: 7469 6f6e 7320 2d20 6061 7363 6020 6f72  tions - `asc` or
+00017f50: 2060 6465 7363 602e 2044 6566 6175 6c74   `desc`. Default
+00017f60: 2069 7320 6064 6573 6360 2e0a 2020 2020   is `desc`..    
+00017f70: 2020 2020 3a72 6574 7572 6e73 3a20 4c69      :returns: Li
+00017f80: 7374 206f 6620 6d61 7463 6869 6e67 203a  st of matching :
+00017f90: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+00017fa0: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
+00017fb0: 6561 7475 7265 5665 6374 6f72 6020 6f62  eatureVector` ob
+00017fc0: 6a65 6374 732e 0a20 2020 2020 2020 2022  jects..        "
+00017fd0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
+00017fe0: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+00017ff0: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00018000: 7072 6f6a 6563 740a 0a20 2020 2020 2020  project..       
+00018010: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
+00018020: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
+00018030: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00018040: 2020 2273 7461 7465 223a 2073 7461 7465    "state": state
+00018050: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00018060: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
+00018070: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
+00018080: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
+00018090: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
+000180a0: 6620 7061 7274 6974 696f 6e5f 6279 3a0a  f partition_by:.
+000180b0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+000180c0: 6d73 2e75 7064 6174 6528 0a20 2020 2020  ms.update(.     
+000180d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000180e0: 5f67 656e 6572 6174 655f 7061 7274 6974  _generate_partit
+000180f0: 696f 6e5f 6279 5f70 6172 616d 7328 0a20  ion_by_params(. 
+00018100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018110: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00018120: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+00018130: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
+00018140: 6965 6c64 2c0a 2020 2020 2020 2020 2020  ield,.          
+00018150: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+00018160: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
+00018170: 2020 2020 2020 2020 2020 2020 726f 7773              rows
+00018180: 5f70 6572 5f70 6172 7469 7469 6f6e 2c0a  _per_partition,.
+00018190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181a0: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
+000181b0: 7274 5f62 792c 0a20 2020 2020 2020 2020  rt_by,.         
+000181c0: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+000181d0: 7469 6f6e 5f6f 7264 6572 2c0a 2020 2020  tion_order,.    
+000181e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000181f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00018200: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+00018210: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+00018220: 2f66 6561 7475 7265 2d76 6563 746f 7273  /feature-vectors
+00018230: 220a 0a20 2020 2020 2020 2065 7272 6f72  "..        error
+00018240: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
+00018250: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
+00018260: 6420 6c69 7374 696e 6720 6665 6174 7572  d listing featur
+00018270: 652d 7665 6374 6f72 732c 2070 726f 6a65  e-vectors, proje
+00018280: 6374 3a20 7b70 726f 6a65 6374 7d2c 2071  ct: {project}, q
+00018290: 7565 7279 3a20 7b70 6172 616d 737d 220a  uery: {params}".
+000182a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000182b0: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+000182c0: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+000182d0: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+000182e0: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
+000182f0: 290a 2020 2020 2020 2020 6665 6174 7572  ).        featur
+00018300: 655f 7665 6374 6f72 7320 3d20 7265 7370  e_vectors = resp
+00018310: 2e6a 736f 6e28 295b 2266 6561 7475 7265  .json()["feature
+00018320: 5f76 6563 746f 7273 225d 0a20 2020 2020  _vectors"].     
+00018330: 2020 2069 6620 6665 6174 7572 655f 7665     if feature_ve
+00018340: 6374 6f72 733a 0a20 2020 2020 2020 2020  ctors:.         
+00018350: 2020 2072 6574 7572 6e20 5b46 6561 7475     return [Featu
+00018360: 7265 5665 6374 6f72 2e66 726f 6d5f 6469  reVector.from_di
+00018370: 6374 286f 626a 2920 666f 7220 6f62 6a20  ct(obj) for obj 
+00018380: 696e 2066 6561 7475 7265 5f76 6563 746f  in feature_vecto
+00018390: 7273 5d0a 0a20 2020 2064 6566 2073 746f  rs]..    def sto
+000183a0: 7265 5f66 6561 7475 7265 5f76 6563 746f  re_feature_vecto
+000183b0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+000183c0: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+000183d0: 5f76 6563 746f 723a 2055 6e69 6f6e 5b64  _vector: Union[d
+000183e0: 6963 742c 206d 6c72 756e 2e63 6f6d 6d6f  ict, mlrun.commo
+000183f0: 6e2e 7363 6865 6d61 732e 4665 6174 7572  n.schemas.Featur
+00018400: 6556 6563 746f 722c 2046 6561 7475 7265  eVector, Feature
+00018410: 5665 6374 6f72 5d2c 0a20 2020 2020 2020  Vector],.       
+00018420: 206e 616d 653d 4e6f 6e65 2c0a 2020 2020   name=None,.    
+00018430: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
+00018440: 2020 2020 2020 2020 7461 673d 4e6f 6e65          tag=None
+00018450: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
+00018460: 6e65 2c0a 2020 2020 2020 2020 7665 7273  ne,.        vers
+00018470: 696f 6e65 643d 5472 7565 2c0a 2020 2020  ioned=True,.    
+00018480: 2920 2d3e 2064 6963 743a 0a20 2020 2020  ) -> dict:.     
+00018490: 2020 2022 2222 5374 6f72 6520 6120 3a70     """Store a :p
+000184a0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000184b0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+000184c0: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+000184d0: 6563 7420 696e 2074 6865 203a 7079 3a6d  ect in the :py:m
+000184e0: 6f64 3a60 6d6c 7275 6e60 2044 422e 2054  od:`mlrun` DB. T
+000184f0: 6865 0a20 2020 2020 2020 2066 6561 7475  he.        featu
+00018500: 7265 2d76 6563 746f 7220 6361 6e20 6265  re-vector can be
+00018510: 2065 6974 6865 7220 6120 6e65 7720 6f62   either a new ob
+00018520: 6a65 6374 206f 7220 6120 6d6f 6469 6669  ject or a modifi
+00018530: 6361 7469 6f6e 2074 6f20 6578 6973 7469  cation to existi
+00018540: 6e67 206f 626a 6563 7420 7265 6665 7265  ng object refere
+00018550: 6e63 6564 2062 7920 7468 6520 7061 7261  nced by the para
+00018560: 6d73 0a20 2020 2020 2020 206f 6620 7468  ms.        of th
+00018570: 6520 6675 6e63 7469 6f6e 2e0a 0a20 2020  e function...   
+00018580: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
+00018590: 7572 655f 7665 6374 6f72 3a20 5468 6520  ure_vector: The 
+000185a0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+000185b0: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+000185c0: 4665 6174 7572 6556 6563 746f 7260 2074  FeatureVector` t
+000185d0: 6f20 7374 6f72 652e 0a20 2020 2020 2020  o store..       
+000185e0: 203a 7061 7261 6d20 6e61 6d65 3a20 2020   :param name:   
+000185f0: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
+00018600: 2076 6563 746f 722e 0a20 2020 2020 2020   vector..       
+00018610: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00018620: 204e 616d 6520 6f66 2070 726f 6a65 6374   Name of project
+00018630: 2074 6869 7320 6665 6174 7572 652d 7665   this feature-ve
+00018640: 6374 6f72 2062 656c 6f6e 6773 2074 6f2e  ctor belongs to.
+00018650: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00018660: 7461 673a 2054 6865 2060 6074 6167 6060  tag: The ``tag``
+00018670: 206f 6620 7468 6520 6f62 6a65 6374 2074   of the object t
+00018680: 6f20 7265 706c 6163 6520 696e 2074 6865  o replace in the
+00018690: 2044 422c 2066 6f72 2065 7861 6d70 6c65   DB, for example
+000186a0: 2060 606c 6174 6573 7460 602e 0a20 2020   ``latest``..   
+000186b0: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
+000186c0: 2054 6865 2060 6075 6964 6060 206f 6620   The ``uid`` of 
+000186d0: 7468 6520 6f62 6a65 6374 2074 6f20 7265  the object to re
+000186e0: 706c 6163 6520 696e 2074 6865 2044 422e  place in the DB.
+000186f0: 2049 6620 7573 696e 6720 7468 6973 2070   If using this p
+00018700: 6172 616d 6574 6572 2c20 7468 6520 6d6f  arameter, the mo
+00018710: 6469 6669 6564 206f 626a 6563 740a 2020  dified object.  
+00018720: 2020 2020 2020 2020 2020 6d75 7374 2068            must h
+00018730: 6176 6520 7468 6520 7361 6d65 2060 6075  ave the same ``u
+00018740: 6964 6060 206f 6620 7468 6520 7072 6576  id`` of the prev
+00018750: 696f 7573 6c79 2d65 7869 7374 696e 6720  iously-existing 
+00018760: 6f62 6a65 6374 2e20 5468 6973 2063 616e  object. This can
+00018770: 6e6f 7420 6265 2075 7365 6420 666f 7220  not be used for 
+00018780: 6e6f 6e2d 7665 7273 696f 6e65 6420 6f62  non-versioned ob
+00018790: 6a65 6374 732e 0a20 2020 2020 2020 203a  jects..        :
+000187a0: 7061 7261 6d20 7665 7273 696f 6e65 643a  param versioned:
+000187b0: 2057 6865 7468 6572 2074 6f20 6d61 696e   Whether to main
+000187c0: 7461 696e 2076 6572 7369 6f6e 7320 666f  tain versions fo
+000187d0: 7220 7468 6973 2066 6561 7475 7265 2d76  r this feature-v
+000187e0: 6563 746f 722e 2041 6c6c 2076 6572 7369  ector. All versi
+000187f0: 6f6e 7320 6f66 2061 2076 6572 7369 6f6e  ons of a version
+00018800: 6564 206f 626a 6563 740a 2020 2020 2020  ed object.      
+00018810: 2020 2020 2020 7769 6c6c 2062 6520 6b65        will be ke
+00018820: 7074 2069 6e20 7468 6520 4442 2061 6e64  pt in the DB and
+00018830: 2063 616e 2062 6520 7265 7472 6965 7665   can be retrieve
+00018840: 6420 756e 7469 6c20 6578 706c 6963 6974  d until explicit
+00018850: 6c79 2064 656c 6574 6564 2e0a 2020 2020  ly deleted..    
+00018860: 2020 2020 3a72 6574 7572 6e73 3a20 5468      :returns: Th
+00018870: 6520 3a70 793a 636c 6173 733a 607e 6d6c  e :py:class:`~ml
+00018880: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
+00018890: 652e 4665 6174 7572 6556 6563 746f 7260  e.FeatureVector`
+000188a0: 206f 626a 6563 7420 2861 7320 6469 6374   object (as dict
+000188b0: 292e 0a20 2020 2020 2020 2022 2222 0a0a  )..        """..
+000188c0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+000188d0: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
+000188e0: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
+000188f0: 2075 6964 290a 2020 2020 2020 2020 7061   uid).        pa
+00018900: 7261 6d73 203d 207b 2276 6572 7369 6f6e  rams = {"version
+00018910: 6564 223a 2076 6572 7369 6f6e 6564 7d0a  ed": versioned}.
+00018920: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00018930: 7374 616e 6365 2866 6561 7475 7265 5f76  stance(feature_v
+00018940: 6563 746f 722c 206d 6c72 756e 2e63 6f6d  ector, mlrun.com
+00018950: 6d6f 6e2e 7363 6865 6d61 732e 4665 6174  mon.schemas.Feat
+00018960: 7572 6556 6563 746f 7229 3a0a 2020 2020  ureVector):.    
+00018970: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00018980: 7665 6374 6f72 203d 2066 6561 7475 7265  vector = feature
+00018990: 5f76 6563 746f 722e 6469 6374 2829 0a20  _vector.dict(). 
+000189a0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000189b0: 7374 616e 6365 2866 6561 7475 7265 5f76  stance(feature_v
+000189c0: 6563 746f 722c 2046 6561 7475 7265 5665  ector, FeatureVe
+000189d0: 6374 6f72 293a 0a20 2020 2020 2020 2020  ctor):.         
+000189e0: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
+000189f0: 7220 3d20 6665 6174 7572 655f 7665 6374  r = feature_vect
+00018a00: 6f72 2e74 6f5f 6469 6374 2829 0a0a 2020  or.to_dict()..  
+00018a10: 2020 2020 2020 6e61 6d65 203d 206e 616d        name = nam
+00018a20: 6520 6f72 2066 6561 7475 7265 5f76 6563  e or feature_vec
+00018a30: 746f 725b 226d 6574 6164 6174 6122 5d5b  tor["metadata"][
+00018a40: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
+00018a50: 7072 6f6a 6563 7420 3d20 280a 2020 2020  project = (.    
+00018a60: 2020 2020 2020 2020 7072 6f6a 6563 740a          project.
+00018a70: 2020 2020 2020 2020 2020 2020 6f72 2066              or f
+00018a80: 6561 7475 7265 5f76 6563 746f 725b 226d  eature_vector["m
+00018a90: 6574 6164 6174 6122 5d2e 6765 7428 2270  etadata"].get("p
+00018aa0: 726f 6a65 6374 2229 0a20 2020 2020 2020  roject").       
+00018ab0: 2020 2020 206f 7220 636f 6e66 6967 2e64       or config.d
+00018ac0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+00018ad0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00018ae0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+00018af0: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
+00018b00: 7475 7265 2d76 6563 746f 7273 2f7b 6e61  ture-vectors/{na
+00018b10: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
+00018b20: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
+00018b30: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00018b40: 6520 3d20 6622 4661 696c 6564 2073 746f  e = f"Failed sto
+00018b50: 7269 6e67 2066 6561 7475 7265 2d76 6563  ring feature-vec
+00018b60: 746f 7220 7b70 726f 6a65 6374 7d2f 7b6e  tor {project}/{n
+00018b70: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00018b80: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+00018b90: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00018ba0: 2250 5554 222c 2070 6174 682c 2065 7272  "PUT", path, err
+00018bb0: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
+00018bc0: 6d73 3d70 6172 616d 732c 2062 6f64 793d  ms=params, body=
+00018bd0: 6469 6374 5f74 6f5f 6a73 6f6e 2866 6561  dict_to_json(fea
+00018be0: 7475 7265 5f76 6563 746f 7229 0a20 2020  ture_vector).   
+00018bf0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00018c00: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+00018c10: 290a 0a20 2020 2064 6566 2070 6174 6368  )..    def patch
+00018c20: 5f66 6561 7475 7265 5f76 6563 746f 7228  _feature_vector(
+00018c30: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00018c40: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+00018c50: 2020 2020 2066 6561 7475 7265 5f76 6563       feature_vec
+00018c60: 746f 725f 7570 6461 7465 3a20 6469 6374  tor_update: dict
+00018c70: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00018c80: 743d 2222 2c0a 2020 2020 2020 2020 7461  t="",.        ta
+00018c90: 673d 4e6f 6e65 2c0a 2020 2020 2020 2020  g=None,.        
+00018ca0: 7569 643d 4e6f 6e65 2c0a 2020 2020 2020  uid=None,.      
+00018cb0: 2020 7061 7463 685f 6d6f 6465 3a20 556e    patch_mode: Un
+00018cc0: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+00018cd0: 2073 7472 2c20 6d6c 7275 6e2e 636f 6d6d   str, mlrun.comm
+00018ce0: 6f6e 2e73 6368 656d 6173 2e50 6174 6368  on.schemas.Patch
+00018cf0: 4d6f 6465 0a20 2020 2020 2020 205d 203d  Mode.        ] =
+00018d00: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00018d10: 6865 6d61 732e 5061 7463 684d 6f64 652e  hemas.PatchMode.
+00018d20: 7265 706c 6163 652c 0a20 2020 2029 3a0a  replace,.    ):.
+00018d30: 2020 2020 2020 2020 2222 224d 6f64 6966          """Modif
+00018d40: 7920 2870 6174 6368 2920 616e 2065 7869  y (patch) an exi
+00018d50: 7374 696e 6720 3a70 793a 636c 6173 733a  sting :py:class:
+00018d60: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00018d70: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+00018d80: 746f 7260 206f 626a 6563 742e 0a20 2020  tor` object..   
+00018d90: 2020 2020 2054 6865 206f 626a 6563 7420       The object 
+00018da0: 6973 2069 6465 6e74 6966 6965 6420 6279  is identified by
+00018db0: 2069 7473 206e 616d 6520 2861 6e64 2070   its name (and p
+00018dc0: 726f 6a65 6374 2069 7420 6265 6c6f 6e67  roject it belong
+00018dd0: 7320 746f 292c 2061 7320 7765 6c6c 2061  s to), as well a
+00018de0: 7320 6f70 7469 6f6e 616c 6c79 2061 2060  s optionally a `
+00018df0: 6074 6167 6060 206f 7220 6974 730a 2020  `tag`` or its.  
+00018e00: 2020 2020 2020 6060 7569 6460 6020 2866        ``uid`` (f
+00018e10: 6f72 2076 6572 7369 6f6e 6564 206f 626a  or versioned obj
+00018e20: 6563 7429 2e20 4966 2062 6f74 6820 6060  ect). If both ``
+00018e30: 7461 6760 6020 616e 6420 6060 7569 6460  tag`` and ``uid`
+00018e40: 6020 6172 6520 6f6d 6974 7465 6420 7468  ` are omitted th
+00018e50: 656e 2074 6865 206f 626a 6563 7420 7769  en the object wi
+00018e60: 7468 2074 6167 2060 606c 6174 6573 7460  th tag ``latest`
+00018e70: 600a 2020 2020 2020 2020 6973 206d 6f64  `.        is mod
+00018e80: 6966 6965 642e 0a0a 2020 2020 2020 2020  ified...        
+00018e90: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
+00018ea0: 6520 6f66 2074 6865 206f 626a 6563 7420  e of the object 
+00018eb0: 746f 2070 6174 6368 2e0a 2020 2020 2020  to patch..      
+00018ec0: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
+00018ed0: 5f76 6563 746f 725f 7570 6461 7465 3a20  _vector_update: 
+00018ee0: 5468 6520 6d6f 6469 6669 6361 7469 6f6e  The modification
+00018ef0: 7320 6e65 6564 6564 2069 6e20 7468 6520  s needed in the 
+00018f00: 6f62 6a65 6374 2e20 5468 6973 2070 6172  object. This par
+00018f10: 616d 6574 6572 206f 6e6c 7920 6861 7320  ameter only has 
+00018f20: 7468 6520 6368 616e 6765 7320 696e 2069  the changes in i
+00018f30: 742c 0a20 2020 2020 2020 2020 2020 206e  t,.            n
+00018f40: 6f74 2061 2066 756c 6c20 6f62 6a65 6374  ot a full object
+00018f50: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018f60: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00018f70: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00018f80: 2074 6865 206d 6f64 6966 6965 6420 6f62   the modified ob
+00018f90: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
+00018fa0: 6172 616d 2074 6167 3a20 5468 6520 7461  aram tag: The ta
+00018fb0: 6720 6f66 2074 6865 206f 626a 6563 7420  g of the object 
+00018fc0: 746f 206d 6f64 6966 792e 0a20 2020 2020  to modify..     
+00018fd0: 2020 203a 7061 7261 6d20 7569 643a 2075     :param uid: u
+00018fe0: 6964 206f 6620 7468 6520 6f62 6a65 6374  id of the object
+00018ff0: 2074 6f20 6d6f 6469 6679 2e0a 2020 2020   to modify..    
+00019000: 2020 2020 3a70 6172 616d 2070 6174 6368      :param patch
+00019010: 5f6d 6f64 653a 2054 6865 2073 7472 6174  _mode: The strat
+00019020: 6567 7920 666f 7220 6d65 7267 696e 6720  egy for merging 
+00019030: 7468 6520 6368 616e 6765 7320 7769 7468  the changes with
+00019040: 2074 6865 2065 7869 7374 696e 6720 6f62   the existing ob
+00019050: 6a65 6374 2e20 4361 6e20 6265 2065 6974  ject. Can be eit
+00019060: 6865 7220 6060 7265 706c 6163 6560 600a  her ``replace``.
+00019070: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
+00019080: 6061 6464 6974 6976 6560 602e 0a20 2020  `additive``..   
+00019090: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000190a0: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
+000190b0: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
+000190c0: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
+000190d0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+000190e0: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+000190f0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00019100: 6374 0a20 2020 2020 2020 2068 6561 6465  ct.        heade
+00019110: 7273 203d 207b 6d6c 7275 6e2e 636f 6d6d  rs = {mlrun.comm
+00019120: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+00019130: 724e 616d 6573 2e70 6174 6368 5f6d 6f64  rNames.patch_mod
+00019140: 653a 2070 6174 6368 5f6d 6f64 657d 0a20  e: patch_mode}. 
+00019150: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00019160: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00019170: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
+00019180: 7273 2f7b 6e61 6d65 7d2f 7265 6665 7265  rs/{name}/refere
+00019190: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
+000191a0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+000191b0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+000191c0: 6564 2075 7064 6174 696e 6720 6665 6174  ed updating feat
+000191d0: 7572 652d 7665 6374 6f72 207b 7072 6f6a  ure-vector {proj
+000191e0: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
+000191f0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+00019200: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00019210: 2250 4154 4348 222c 0a20 2020 2020 2020  "PATCH",.       
+00019220: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00019230: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00019240: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00019250: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
+00019260: 736f 6e28 6665 6174 7572 655f 7665 6374  son(feature_vect
+00019270: 6f72 5f75 7064 6174 6529 2c0a 2020 2020  or_update),.    
+00019280: 2020 2020 2020 2020 6865 6164 6572 733d          headers=
+00019290: 6865 6164 6572 732c 0a20 2020 2020 2020  headers,.       
+000192a0: 2029 0a0a 2020 2020 6465 6620 6465 6c65   )..    def dele
+000192b0: 7465 5f66 6561 7475 7265 5f76 6563 746f  te_feature_vecto
+000192c0: 7228 7365 6c66 2c20 6e61 6d65 2c20 7072  r(self, name, pr
+000192d0: 6f6a 6563 743d 2222 2c20 7461 673d 4e6f  oject="", tag=No
+000192e0: 6e65 2c20 7569 643d 4e6f 6e65 293a 0a20  ne, uid=None):. 
+000192f0: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
+00019300: 2061 203a 7079 3a63 6c61 7373 3a60 7e6d   a :py:class:`~m
+00019310: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00019320: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+00019330: 6020 6f62 6a65 6374 2066 726f 6d20 7468  ` object from th
+00019340: 6520 4442 2e0a 2020 2020 2020 2020 4966  e DB..        If
+00019350: 2060 6074 6167 6060 206f 7220 6060 7569   ``tag`` or ``ui
+00019360: 6460 6020 6172 6520 7370 6563 6966 6965  d`` are specifie
+00019370: 642c 2074 6865 6e20 6a75 7374 2074 6865  d, then just the
+00019380: 2076 6572 7369 6f6e 2072 6566 6572 656e   version referen
+00019390: 6365 6420 6279 2074 6865 6d20 7769 6c6c  ced by them will
+000193a0: 2062 6520 6465 6c65 7465 642e 2055 7369   be deleted. Usi
+000193b0: 6e67 2062 6f74 680a 2020 2020 2020 2020  ng both.        
+000193c0: 6973 206e 6f74 2061 6c6c 6f77 6564 2e0a  is not allowed..
+000193d0: 2020 2020 2020 2020 4966 206e 6f6e 6520          If none 
+000193e0: 6172 6520 7370 6563 6966 6965 642c 2074  are specified, t
+000193f0: 6865 6e20 616c 6c20 696e 7374 616e 6365  hen all instance
+00019400: 7320 6f66 2074 6865 206f 626a 6563 7420  s of the object 
+00019410: 7768 6f73 6520 6e61 6d65 2069 7320 6060  whose name is ``
+00019420: 6e61 6d65 6060 2077 696c 6c20 6265 2064  name`` will be d
+00019430: 656c 6574 6564 2e0a 2020 2020 2020 2020  eleted..        
+00019440: 2222 220a 2020 2020 2020 2020 7072 6f6a  """.        proj
+00019450: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+00019460: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00019470: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00019480: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+00019490: 732f 7b70 726f 6a65 6374 7d2f 6665 6174  s/{project}/feat
+000194a0: 7572 652d 7665 6374 6f72 732f 7b6e 616d  ure-vectors/{nam
+000194b0: 657d 220a 2020 2020 2020 2020 6966 2074  e}".        if t
+000194c0: 6167 206f 7220 7569 643a 0a20 2020 2020  ag or uid:.     
+000194d0: 2020 2020 2020 2072 6566 6572 656e 6365         reference
+000194e0: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
+000194f0: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
+00019500: 7569 6429 0a20 2020 2020 2020 2020 2020  uid).           
+00019510: 2070 6174 6820 3d20 7061 7468 202b 2066   path = path + f
+00019520: 222f 7265 6665 7265 6e63 6573 2f7b 7265  "/references/{re
+00019530: 6665 7265 6e63 657d 220a 0a20 2020 2020  ference}"..     
+00019540: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00019550: 203d 2066 2246 6169 6c65 6420 6465 6c65   = f"Failed dele
+00019560: 7469 6e67 2066 6561 7475 7265 2d76 6563  ting feature-vec
+00019570: 746f 7220 7b6e 616d 657d 220a 2020 2020  tor {name}".    
+00019580: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00019590: 6c28 2244 454c 4554 4522 2c20 7061 7468  l("DELETE", path
+000195a0: 2c20 6572 726f 725f 6d65 7373 6167 6529  , error_message)
+000195b0: 0a0a 2020 2020 6465 6620 7461 675f 6f62  ..    def tag_ob
+000195c0: 6a65 6374 7328 0a20 2020 2020 2020 2073  jects(.        s
+000195d0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+000195e0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+000195f0: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
+00019600: 2c0a 2020 2020 2020 2020 6f62 6a65 6374  ,.        object
+00019610: 733a 2055 6e69 6f6e 5b6d 6c72 756e 2e63  s: Union[mlrun.c
+00019620: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5461  ommon.schemas.Ta
+00019630: 674f 626a 6563 7473 2c20 6469 6374 5d2c  gObjects, dict],
+00019640: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00019650: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00019660: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00019670: 2222 5461 6720 6120 6c69 7374 206f 6620  ""Tag a list of 
+00019680: 6f62 6a65 6374 732e 0a0a 2020 2020 2020  objects...      
+00019690: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+000196a0: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
+000196b0: 636f 6e74 6169 6e73 2074 6865 206f 626a  contains the obj
+000196c0: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+000196d0: 6172 616d 2074 6167 5f6e 616d 653a 2054  aram tag_name: T
+000196e0: 6865 2074 6167 2074 6f20 7365 7420 6f6e  he tag to set on
+000196f0: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
+00019700: 2020 2020 2020 3a70 6172 616d 206f 626a        :param obj
+00019710: 6563 7473 3a20 5468 6520 6f62 6a65 6374  ects: The object
+00019720: 7320 746f 2074 6167 2e0a 2020 2020 2020  s to tag..      
+00019730: 2020 3a70 6172 616d 2072 6570 6c61 6365    :param replace
+00019740: 3a20 5768 6574 6865 7220 746f 2072 6570  : Whether to rep
+00019750: 6c61 6365 2074 6865 2065 7869 7374 696e  lace the existin
+00019760: 6720 7461 6773 206f 6620 7468 6520 6f62  g tags of the ob
+00019770: 6a65 6374 7320 6f72 2074 6f20 6164 6420  jects or to add 
+00019780: 7468 6520 6e65 7720 7461 6720 746f 2074  the new tag to t
+00019790: 6865 6d2e 0a20 2020 2020 2020 2022 2222  hem..        """
+000197a0: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
+000197b0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+000197c0: 6a65 6374 7d2f 7461 6773 2f7b 7461 675f  ject}/tags/{tag_
+000197d0: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+000197e0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+000197f0: 2246 6169 6c65 6420 746f 2074 6167 207b  "Failed to tag {
+00019800: 7461 675f 6e61 6d65 7d20 6f6e 206f 626a  tag_name} on obj
+00019810: 6563 7473 207b 6f62 6a65 6374 737d 220a  ects {objects}".
+00019820: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
+00019830: 2022 504f 5354 2220 6966 2072 6570 6c61   "POST" if repla
+00019840: 6365 2065 6c73 6520 2250 5554 220a 2020  ce else "PUT".  
+00019850: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
+00019860: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00019870: 206d 6574 686f 642c 0a20 2020 2020 2020   method,.       
+00019880: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00019890: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+000198a0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+000198b0: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
+000198c0: 736f 6e28 0a20 2020 2020 2020 2020 2020  son(.           
+000198d0: 2020 2020 206f 626a 6563 7473 2e64 6963       objects.dic
+000198e0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+000198f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00019900: 6528 6f62 6a65 6374 732c 206d 6c72 756e  e(objects, mlrun
+00019910: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00019920: 5461 674f 626a 6563 7473 290a 2020 2020  TagObjects).    
+00019930: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00019940: 206f 626a 6563 7473 0a20 2020 2020 2020   objects.       
+00019950: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00019960: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+00019970: 655f 6f62 6a65 6374 735f 7461 6728 0a20  e_objects_tag(. 
+00019980: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00019990: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+000199a0: 722c 0a20 2020 2020 2020 2074 6167 5f6e  r,.        tag_n
+000199b0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+000199c0: 2020 7461 675f 6f62 6a65 6374 733a 2055    tag_objects: U
+000199d0: 6e69 6f6e 5b6d 6c72 756e 2e63 6f6d 6d6f  nion[mlrun.commo
+000199e0: 6e2e 7363 6865 6d61 732e 5461 674f 626a  n.schemas.TagObj
+000199f0: 6563 7473 2c20 6469 6374 5d2c 0a20 2020  ects, dict],.   
+00019a00: 2029 3a0a 2020 2020 2020 2020 2222 2244   ):.        """D
+00019a10: 656c 6574 6520 6120 7461 6720 6672 6f6d  elete a tag from
+00019a20: 2061 206c 6973 7420 6f66 206f 626a 6563   a list of objec
+00019a30: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
+00019a40: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00019a50: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
+00019a60: 696e 7320 7468 6520 6f62 6a65 6374 732e  ins the objects.
+00019a70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00019a80: 7461 675f 6e61 6d65 3a20 5468 6520 7461  tag_name: The ta
+00019a90: 6720 746f 2064 656c 6574 6520 6672 6f6d  g to delete from
+00019aa0: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
+00019ab0: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00019ac0: 5f6f 626a 6563 7473 3a20 5468 6520 6f62  _objects: The ob
+00019ad0: 6a65 6374 7320 746f 2064 656c 6574 6520  jects to delete 
+00019ae0: 7468 6520 7461 6720 6672 6f6d 2e0a 0a20  the tag from... 
+00019af0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00019b00: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00019b10: 6563 7473 2f7b 7072 6f6a 6563 747d 2f74  ects/{project}/t
+00019b20: 6167 732f 7b74 6167 5f6e 616d 657d 220a  ags/{tag_name}".
+00019b30: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00019b40: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+00019b50: 2064 656c 6574 696e 6720 7461 6720 6672   deleting tag fr
+00019b60: 6f6d 207b 7461 675f 6e61 6d65 7d22 0a20  om {tag_name}". 
+00019b70: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+00019b80: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00019b90: 2020 2244 454c 4554 4522 2c0a 2020 2020    "DELETE",.    
+00019ba0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+00019bb0: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00019bc0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+00019bd0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+00019be0: 6f5f 6a73 6f6e 280a 2020 2020 2020 2020  o_json(.        
+00019bf0: 2020 2020 2020 2020 7461 675f 6f62 6a65          tag_obje
+00019c00: 6374 732e 6469 6374 2829 0a20 2020 2020  cts.dict().     
+00019c10: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00019c20: 696e 7374 616e 6365 2874 6167 5f6f 626a  instance(tag_obj
+00019c30: 6563 7473 2c20 6d6c 7275 6e2e 636f 6d6d  ects, mlrun.comm
+00019c40: 6f6e 2e73 6368 656d 6173 2e54 6167 4f62  on.schemas.TagOb
+00019c50: 6a65 6374 7329 0a20 2020 2020 2020 2020  jects).         
+00019c60: 2020 2020 2020 2065 6c73 6520 7461 675f         else tag_
+00019c70: 6f62 6a65 6374 730a 2020 2020 2020 2020  objects.        
+00019c80: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
+00019c90: 0a0a 2020 2020 6465 6620 7461 675f 6172  ..    def tag_ar
+00019ca0: 7469 6661 6374 7328 0a20 2020 2020 2020  tifacts(.       
+00019cb0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00019cc0: 7274 6966 6163 7473 3a20 556e 696f 6e5b  rtifacts: Union[
+00019cd0: 6c69 7374 5b41 7274 6966 6163 745d 2c20  list[Artifact], 
+00019ce0: 6c69 7374 5b64 6963 745d 2c20 4172 7469  list[dict], Arti
+00019cf0: 6661 6374 2c20 6469 6374 5d2c 0a20 2020  fact, dict],.   
+00019d00: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+00019d10: 722c 0a20 2020 2020 2020 2074 6167 5f6e  r,.        tag_n
+00019d20: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+00019d30: 2020 7265 706c 6163 653a 2062 6f6f 6c20    replace: bool 
+00019d40: 3d20 4661 6c73 652c 0a20 2020 2029 3a0a  = False,.    ):.
+00019d50: 2020 2020 2020 2020 2222 2254 6167 2061          """Tag a
+00019d60: 206c 6973 7420 6f66 2061 7274 6966 6163   list of artifac
+00019d70: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
+00019d80: 7261 6d20 6172 7469 6661 6374 733a 2054  ram artifacts: T
+00019d90: 6865 2061 7274 6966 6163 7473 2074 6f20  he artifacts to 
+00019da0: 7461 672e 2043 616e 2062 6520 6120 6c69  tag. Can be a li
+00019db0: 7374 206f 6620 3a70 793a 636c 6173 733a  st of :py:class:
+00019dc0: 607e 6d6c 7275 6e2e 6172 7469 6661 6374  `~mlrun.artifact
+00019dd0: 732e 4172 7469 6661 6374 6020 6f62 6a65  s.Artifact` obje
+00019de0: 6374 7320 6f72 0a20 2020 2020 2020 2020  cts or.         
+00019df0: 2020 2064 6963 7469 6f6e 6172 6965 732c     dictionaries,
+00019e00: 206f 7220 6120 7369 6e67 6c65 206f 626a   or a single obj
+00019e10: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+00019e20: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00019e30: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
+00019e40: 696e 7320 7468 6520 6172 7469 6661 6374  ins the artifact
+00019e50: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00019e60: 6d20 7461 675f 6e61 6d65 3a20 5468 6520  m tag_name: The 
+00019e70: 7461 6720 746f 2073 6574 206f 6e20 7468  tag to set on th
+00019e80: 6520 6172 7469 6661 6374 732e 0a20 2020  e artifacts..   
+00019e90: 2020 2020 203a 7061 7261 6d20 7265 706c       :param repl
+00019ea0: 6163 653a 2049 6620 5472 7565 2c20 7265  ace: If True, re
+00019eb0: 706c 6163 6520 6578 6973 7469 6e67 2074  place existing t
+00019ec0: 6167 732c 206f 7468 6572 7769 7365 2061  ags, otherwise a
+00019ed0: 7070 656e 6420 746f 2065 7869 7374 696e  ppend to existin
+00019ee0: 6720 7461 6773 2e0a 2020 2020 2020 2020  g tags..        
+00019ef0: 2222 220a 2020 2020 2020 2020 7461 675f  """.        tag_
+00019f00: 6f62 6a65 6374 7320 3d20 7365 6c66 2e5f  objects = self._
+00019f10: 7265 736f 6c76 655f 6172 7469 6661 6374  resolve_artifact
+00019f20: 735f 746f 5f74 6167 5f6f 626a 6563 7473  s_to_tag_objects
+00019f30: 2861 7274 6966 6163 7473 290a 2020 2020  (artifacts).    
+00019f40: 2020 2020 7365 6c66 2e74 6167 5f6f 626a      self.tag_obj
+00019f50: 6563 7473 2870 726f 6a65 6374 2c20 7461  ects(project, ta
+00019f60: 675f 6e61 6d65 2c20 6f62 6a65 6374 733d  g_name, objects=
+00019f70: 7461 675f 6f62 6a65 6374 732c 2072 6570  tag_objects, rep
+00019f80: 6c61 6365 3d72 6570 6c61 6365 290a 0a20  lace=replace).. 
+00019f90: 2020 2064 6566 2064 656c 6574 655f 6172     def delete_ar
+00019fa0: 7469 6661 6374 735f 7461 6773 280a 2020  tifacts_tags(.  
+00019fb0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00019fc0: 2020 2020 6172 7469 6661 6374 732c 0a20      artifacts,. 
+00019fd0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+00019fe0: 7374 722c 0a20 2020 2020 2020 2074 6167  str,.        tag
+00019ff0: 5f6e 616d 653a 2073 7472 2c0a 2020 2020  _name: str,.    
+0001a000: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
+0001a010: 6c65 7465 2074 6167 2066 726f 6d20 6120  lete tag from a 
+0001a020: 6c69 7374 206f 6620 6172 7469 6661 6374  list of artifact
+0001a030: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+0001a040: 616d 2061 7274 6966 6163 7473 3a20 5468  am artifacts: Th
+0001a050: 6520 6172 7469 6661 6374 7320 746f 2064  e artifacts to d
+0001a060: 656c 6574 6520 7468 6520 7461 6720 6672  elete the tag fr
+0001a070: 6f6d 2e20 4361 6e20 6265 2061 206c 6973  om. Can be a lis
+0001a080: 7420 6f66 203a 7079 3a63 6c61 7373 3a60  t of :py:class:`
+0001a090: 7e6d 6c72 756e 2e61 7274 6966 6163 7473  ~mlrun.artifacts
+0001a0a0: 2e41 7274 6966 6163 7460 0a20 2020 2020  .Artifact`.     
+0001a0b0: 2020 2020 2020 206f 626a 6563 7473 206f         objects o
+0001a0c0: 7220 6469 6374 696f 6e61 7269 6573 2c20  r dictionaries, 
+0001a0d0: 6f72 2061 2073 696e 676c 6520 6f62 6a65  or a single obje
+0001a0e0: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
+0001a0f0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+0001a100: 6563 7420 7768 6963 6820 636f 6e74 6169  ect which contai
+0001a110: 6e73 2074 6865 2061 7274 6966 6163 7473  ns the artifacts
+0001a120: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001a130: 2074 6167 5f6e 616d 653a 2054 6865 2074   tag_name: The t
+0001a140: 6167 2074 6f20 7365 7420 6f6e 2074 6865  ag to set on the
+0001a150: 2061 7274 6966 6163 7473 2e0a 2020 2020   artifacts..    
+0001a160: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001a170: 7461 675f 6f62 6a65 6374 7320 3d20 7365  tag_objects = se
+0001a180: 6c66 2e5f 7265 736f 6c76 655f 6172 7469  lf._resolve_arti
+0001a190: 6661 6374 735f 746f 5f74 6167 5f6f 626a  facts_to_tag_obj
+0001a1a0: 6563 7473 2861 7274 6966 6163 7473 290a  ects(artifacts).
+0001a1b0: 2020 2020 2020 2020 7365 6c66 2e64 656c          self.del
+0001a1c0: 6574 655f 6f62 6a65 6374 735f 7461 6728  ete_objects_tag(
+0001a1d0: 7072 6f6a 6563 742c 2074 6167 5f6e 616d  project, tag_nam
+0001a1e0: 652c 2074 6167 5f6f 626a 6563 7473 290a  e, tag_objects).
+0001a1f0: 0a20 2020 2064 6566 206c 6973 745f 7072  .    def list_pr
+0001a200: 6f6a 6563 7473 280a 2020 2020 2020 2020  ojects(.        
+0001a210: 7365 6c66 2c0a 2020 2020 2020 2020 6f77  self,.        ow
+0001a220: 6e65 723a 2073 7472 203d 204e 6f6e 652c  ner: str = None,
+0001a230: 0a20 2020 2020 2020 2066 6f72 6d61 745f  .        format_
+0001a240: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+0001a250: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
+0001a260: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
+0001a270: 726f 6a65 6374 7346 6f72 6d61 740a 2020  rojectsFormat.  
+0001a280: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+0001a290: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
+0001a2a0: 726f 6a65 6374 7346 6f72 6d61 742e 6e61  rojectsFormat.na
+0001a2b0: 6d65 5f6f 6e6c 792c 0a20 2020 2020 2020  me_only,.       
+0001a2c0: 206c 6162 656c 733a 206c 6973 745b 7374   labels: list[st
+0001a2d0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0001a2e0: 2020 2073 7461 7465 3a20 556e 696f 6e5b     state: Union[
+0001a2f0: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
+0001a300: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+0001a310: 7453 7461 7465 5d20 3d20 4e6f 6e65 2c0a  tState] = None,.
+0001a320: 2020 2020 2920 2d3e 206c 6973 745b 556e      ) -> list[Un
+0001a330: 696f 6e5b 6d6c 7275 6e2e 7072 6f6a 6563  ion[mlrun.projec
+0001a340: 7473 2e4d 6c72 756e 5072 6f6a 6563 742c  ts.MlrunProject,
+0001a350: 2073 7472 5d5d 3a0a 2020 2020 2020 2020   str]]:.        
+0001a360: 2222 2252 6574 7572 6e20 6120 6c69 7374  """Return a list
+0001a370: 206f 6620 7468 6520 6578 6973 7469 6e67   of the existing
+0001a380: 2070 726f 6a65 6374 732c 2070 6f74 656e   projects, poten
+0001a390: 7469 616c 6c79 2066 696c 7465 7265 6420  tially filtered 
+0001a3a0: 6279 2073 7065 6369 6669 6320 6372 6974  by specific crit
+0001a3b0: 6572 6961 2e0a 0a20 2020 2020 2020 203a  eria...        :
+0001a3c0: 7061 7261 6d20 6f77 6e65 723a 204c 6973  param owner: Lis
+0001a3d0: 7420 6f6e 6c79 2070 726f 6a65 6374 7320  t only projects 
+0001a3e0: 6265 6c6f 6e67 696e 6720 746f 2074 6869  belonging to thi
+0001a3f0: 7320 7370 6563 6966 6963 206f 776e 6572  s specific owner
+0001a400: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001a410: 2066 6f72 6d61 745f 3a20 466f 726d 6174   format_: Format
+0001a420: 206f 6620 7468 6520 7265 7375 6c74 732e   of the results.
+0001a430: 2050 6f73 7369 626c 6520 7661 6c75 6573   Possible values
+0001a440: 2061 7265 3a0a 0a20 2020 2020 2020 2020   are:..         
+0001a450: 2020 202d 2060 606e 616d 655f 6f6e 6c79     - ``name_only
+0001a460: 6060 2028 6465 6661 756c 7420 7661 6c75  `` (default valu
+0001a470: 6529 202d 2052 6574 7572 6e20 6a75 7374  e) - Return just
+0001a480: 2074 6865 206e 616d 6573 206f 6620 7468   the names of th
+0001a490: 6520 7072 6f6a 6563 7473 2e0a 2020 2020  e projects..    
+0001a4a0: 2020 2020 2020 2020 2d20 6060 6d69 6e69          - ``mini
+0001a4b0: 6d61 6c60 6020 2d20 5265 7475 726e 206d  mal`` - Return m
+0001a4c0: 696e 696d 616c 2070 726f 6a65 6374 206f  inimal project o
+0001a4d0: 626a 6563 7473 2028 6d69 6e69 6d69 7a61  bjects (minimiza
+0001a4e0: 7469 6f6e 2068 6170 7065 6e73 2069 6e20  tion happens in 
+0001a4f0: 7468 6520 4245 292e 0a20 2020 2020 2020  the BE)..       
+0001a500: 2020 2020 202d 2060 6066 756c 6c60 6020       - ``full`` 
+0001a510: 202d 2052 6574 7572 6e20 6675 6c6c 2070   - Return full p
+0001a520: 726f 6a65 6374 206f 626a 6563 7473 2e0a  roject objects..
+0001a530: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001a540: 6c61 6265 6c73 3a20 4669 6c74 6572 2062  labels: Filter b
+0001a550: 7920 6c61 6265 6c73 2061 7474 6163 6865  y labels attache
+0001a560: 6420 746f 2074 6865 2070 726f 6a65 6374  d to the project
+0001a570: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001a580: 2073 7461 7465 3a20 4669 6c74 6572 2062   state: Filter b
+0001a590: 7920 7072 6f6a 6563 7427 7320 7374 6174  y project's stat
+0001a5a0: 652e 2043 616e 2062 6520 6569 7468 6572  e. Can be either
+0001a5b0: 2060 606f 6e6c 696e 6560 6020 6f72 2060   ``online`` or `
+0001a5c0: 6061 7263 6869 7665 6460 602e 0a20 2020  `archived``..   
+0001a5d0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0001a5e0: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+0001a5f0: 2020 2020 2020 2020 2022 6f77 6e65 7222           "owner"
+0001a600: 3a20 6f77 6e65 722c 0a20 2020 2020 2020  : owner,.       
+0001a610: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
+0001a620: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001a630: 2022 666f 726d 6174 223a 2066 6f72 6d61   "format": forma
+0001a640: 745f 2c0a 2020 2020 2020 2020 2020 2020  t_,.            
+0001a650: 226c 6162 656c 223a 206c 6162 656c 7320  "label": labels 
+0001a660: 6f72 205b 5d2c 0a20 2020 2020 2020 207d  or [],.        }
+0001a670: 0a0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
+0001a680: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+0001a690: 6564 206c 6973 7469 6e67 2070 726f 6a65  ed listing proje
+0001a6a0: 6374 732c 2071 7565 7279 3a20 7b70 6172  cts, query: {par
+0001a6b0: 616d 737d 220a 2020 2020 2020 2020 7265  ams}".        re
+0001a6c0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+0001a6d0: 695f 6361 6c6c 2822 4745 5422 2c20 2270  i_call("GET", "p
+0001a6e0: 726f 6a65 6374 7322 2c20 6572 726f 725f  rojects", error_
+0001a6f0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
+0001a700: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+0001a710: 6966 2066 6f72 6d61 745f 203d 3d20 6d6c  if format_ == ml
+0001a720: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001a730: 6173 2e50 726f 6a65 6374 7346 6f72 6d61  as.ProjectsForma
+0001a740: 742e 6e61 6d65 5f6f 6e6c 793a 0a20 2020  t.name_only:.   
+0001a750: 2020 2020 2020 2020 2023 2070 726f 6a65           # proje
+0001a760: 6374 7320 6973 206a 7573 7420 6120 6c69  cts is just a li
+0001a770: 7374 206f 6620 7374 7269 6e67 730a 2020  st of strings.  
+0001a780: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a790: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
+0001a7a0: 5b22 7072 6f6a 6563 7473 225d 0a0a 2020  ["projects"]..  
+0001a7b0: 2020 2020 2020 2320 666f 7277 6172 6473        # forwards
+0001a7c0: 2063 6f6d 7061 7469 6269 6c69 7479 202d   compatibility -
+0001a7d0: 2077 6520 7761 6e74 2074 6f20 6265 2061   we want to be a
+0001a7e0: 626c 6520 746f 2068 616e 646c 6520 6e65  ble to handle ne
+0001a7f0: 7720 666f 726d 6174 7320 7468 6174 206d  w formats that m
+0001a800: 6967 6874 2062 6520 6164 6465 6420 696e  ight be added in
+0001a810: 2074 6865 2066 7574 7572 650a 2020 2020   the future.    
+0001a820: 2020 2020 2320 6966 2066 6f72 6d61 7420      # if format 
+0001a830: 6973 206e 6f74 206b 6e6f 776e 2074 6f20  is not known to 
+0001a840: 7468 6520 6170 692c 2069 7420 6973 2075  the api, it is u
+0001a850: 7020 746f 2074 6865 2073 6572 7665 7220  p to the server 
+0001a860: 746f 2072 6574 7572 6e20 6569 7468 6572  to return either
+0001a870: 2061 6e20 6572 726f 7220 6f72 2061 2064   an error or a d
+0001a880: 6566 6175 6c74 2066 6f72 6d61 740a 2020  efault format.  
+0001a890: 2020 2020 2020 7265 7475 726e 205b 0a20        return [. 
+0001a8a0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+0001a8b0: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
+0001a8c0: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
+0001a8d0: 2870 726f 6a65 6374 5f64 6963 7429 0a20  (project_dict). 
+0001a8e0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+0001a8f0: 726f 6a65 6374 5f64 6963 7420 696e 2072  roject_dict in r
+0001a900: 6573 706f 6e73 652e 6a73 6f6e 2829 5b22  esponse.json()["
+0001a910: 7072 6f6a 6563 7473 225d 0a20 2020 2020  projects"].     
+0001a920: 2020 205d 0a0a 2020 2020 6465 6620 6765     ]..    def ge
+0001a930: 745f 7072 6f6a 6563 7428 7365 6c66 2c20  t_project(self, 
+0001a940: 6e61 6d65 3a20 7374 7229 202d 3e20 6d6c  name: str) -> ml
+0001a950: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
+0001a960: 756e 5072 6f6a 6563 743a 0a20 2020 2020  unProject:.     
+0001a970: 2020 2022 2222 4765 7420 6465 7461 696c     """Get detail
+0001a980: 7320 666f 7220 6120 7370 6563 6966 6963  s for a specific
+0001a990: 2070 726f 6a65 6374 2e22 2222 0a0a 2020   project."""..  
+0001a9a0: 2020 2020 2020 6966 206e 6f74 206e 616d        if not nam
+0001a9b0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0001a9c0: 6169 7365 204d 4c52 756e 496e 7661 6c69  aise MLRunInvali
+0001a9d0: 6441 7267 756d 656e 7445 7272 6f72 2822  dArgumentError("
+0001a9e0: 4e61 6d65 206d 7573 7420 6265 2070 726f  Name must be pro
+0001a9f0: 7669 6465 6422 290a 0a20 2020 2020 2020  vided")..       
+0001aa00: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0001aa10: 7473 2f7b 6e61 6d65 7d22 0a20 2020 2020  ts/{name}".     
+0001aa20: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001aa30: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
+0001aa40: 6965 7669 6e67 2070 726f 6a65 6374 207b  ieving project {
+0001aa50: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
+0001aa60: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+0001aa70: 7069 5f63 616c 6c28 2247 4554 222c 2070  pi_call("GET", p
+0001aa80: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+0001aa90: 6765 290a 2020 2020 2020 2020 7265 7475  ge).        retu
+0001aaa0: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
+0001aab0: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
+0001aac0: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
+0001aad0: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+0001aae0: 6566 2064 656c 6574 655f 7072 6f6a 6563  ef delete_projec
+0001aaf0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+0001ab00: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
+0001ab10: 7472 2c0a 2020 2020 2020 2020 6465 6c65  tr,.        dele
+0001ab20: 7469 6f6e 5f73 7472 6174 6567 793a 2055  tion_strategy: U
+0001ab30: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+0001ab40: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
+0001ab50: 6d6f 6e2e 7363 6865 6d61 732e 4465 6c65  mon.schemas.Dele
+0001ab60: 7469 6f6e 5374 7261 7465 6779 0a20 2020  tionStrategy.   
+0001ab70: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
+0001ab80: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4465  ommon.schemas.De
+0001ab90: 6c65 7469 6f6e 5374 7261 7465 6779 2e64  letionStrategy.d
+0001aba0: 6566 6175 6c74 2829 2c0a 2020 2020 293a  efault(),.    ):
+0001abb0: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
+0001abc0: 7465 2061 2070 726f 6a65 6374 2e0a 0a20  te a project... 
+0001abd0: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+0001abe0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
+0001abf0: 7072 6f6a 6563 7420 746f 2064 656c 6574  project to delet
+0001ac00: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0001ac10: 6d20 6465 6c65 7469 6f6e 5f73 7472 6174  m deletion_strat
+0001ac20: 6567 793a 2048 6f77 2074 6f20 7472 6561  egy: How to trea
+0001ac30: 7420 7265 736f 7572 6365 7320 7265 6c61  t resources rela
+0001ac40: 7465 6420 746f 2074 6865 2070 726f 6a65  ted to the proje
+0001ac50: 6374 2e20 506f 7373 6962 6c65 2076 616c  ct. Possible val
+0001ac60: 7565 7320 6172 653a 0a0a 2020 2020 2020  ues are:..      
+0001ac70: 2020 2020 2020 2d20 6060 7265 7374 7269        - ``restri
+0001ac80: 6374 6060 2028 6465 6661 756c 7429 202d  ct`` (default) -
+0001ac90: 2050 726f 6a65 6374 206d 7573 7420 6e6f   Project must no
+0001aca0: 7420 6861 7665 2061 6e79 2072 656c 6174  t have any relat
+0001acb0: 6564 2072 6573 6f75 7263 6573 2077 6865  ed resources whe
+0001acc0: 6e20 6465 6c65 7465 642e 2049 6620 7573  n deleted. If us
+0001acd0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0001ace0: 2020 7468 6973 206d 6f64 6520 7768 696c    this mode whil
+0001acf0: 6520 7265 6c61 7465 6420 7265 736f 7572  e related resour
+0001ad00: 6365 7320 6578 6973 742c 2074 6865 206f  ces exist, the o
+0001ad10: 7065 7261 7469 6f6e 2077 696c 6c20 6661  peration will fa
+0001ad20: 696c 2e0a 2020 2020 2020 2020 2020 2020  il..            
+0001ad30: 2d20 6060 6361 7363 6164 6560 6020 2d20  - ``cascade`` - 
+0001ad40: 4175 746f 6d61 7469 6361 6c6c 7920 6465  Automatically de
+0001ad50: 6c65 7465 2061 6c6c 2072 656c 6174 6564  lete all related
+0001ad60: 2072 6573 6f75 7263 6573 2077 6865 6e20   resources when 
+0001ad70: 6465 6c65 7469 6e67 2074 6865 2070 726f  deleting the pro
+0001ad80: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+0001ad90: 220a 0a20 2020 2020 2020 2068 6561 6465  "..        heade
+0001ada0: 7273 203d 207b 0a20 2020 2020 2020 2020  rs = {.         
+0001adb0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+0001adc0: 7363 6865 6d61 732e 4865 6164 6572 4e61  schemas.HeaderNa
+0001add0: 6d65 732e 6465 6c65 7469 6f6e 5f73 7472  mes.deletion_str
+0001ade0: 6174 6567 793a 2064 656c 6574 696f 6e5f  ategy: deletion_
+0001adf0: 7374 7261 7465 6779 0a20 2020 2020 2020  strategy.       
+0001ae00: 207d 0a20 2020 2020 2020 2065 7272 6f72   }.        error
+0001ae10: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+0001ae20: 6c65 6420 6465 6c65 7469 6e67 2070 726f  led deleting pro
+0001ae30: 6a65 6374 207b 6e61 6d65 7d22 0a20 2020  ject {name}".   
+0001ae40: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0001ae50: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001ae60: 2020 2020 2020 2020 2020 2022 4445 4c45             "DELE
+0001ae70: 5445 222c 2066 2270 726f 6a65 6374 732f  TE", f"projects/
+0001ae80: 7b6e 616d 657d 222c 2065 7272 6f72 5f6d  {name}", error_m
+0001ae90: 6573 7361 6765 2c20 6865 6164 6572 733d  essage, headers=
+0001aea0: 6865 6164 6572 732c 2076 6572 7369 6f6e  headers, version
+0001aeb0: 3d22 7632 220a 2020 2020 2020 2020 290a  ="v2".        ).
+0001aec0: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
+0001aed0: 6e73 652e 7374 6174 7573 5f63 6f64 6520  nse.status_code 
+0001aee0: 3d3d 2068 7474 702e 4854 5450 5374 6174  == http.HTTPStat
+0001aef0: 7573 2e41 4343 4550 5445 443a 0a20 2020  us.ACCEPTED:.   
+0001af00: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+0001af10: 696e 666f 2822 5072 6f6a 6563 7420 6973  info("Project is
+0001af20: 2062 6569 6e67 2064 656c 6574 6564 222c   being deleted",
+0001af30: 2070 726f 6a65 6374 5f6e 616d 653d 6e61   project_name=na
+0001af40: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+0001af50: 6261 636b 6772 6f75 6e64 5f74 6173 6b20  background_task 
+0001af60: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+0001af70: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
+0001af80: 6454 6173 6b28 2a2a 7265 7370 6f6e 7365  dTask(**response
+0001af90: 2e6a 736f 6e28 2929 0a20 2020 2020 2020  .json()).       
+0001afa0: 2020 2020 2062 6163 6b67 726f 756e 645f       background_
+0001afb0: 7461 736b 203d 2073 656c 662e 5f77 6169  task = self._wai
+0001afc0: 745f 666f 725f 6261 636b 6772 6f75 6e64  t_for_background
+0001afd0: 5f74 6173 6b5f 746f 5f72 6561 6368 5f74  _task_to_reach_t
+0001afe0: 6572 6d69 6e61 6c5f 7374 6174 6528 0a20  erminal_state(. 
+0001aff0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001b000: 6163 6b67 726f 756e 645f 7461 736b 2e6d  ackground_task.m
+0001b010: 6574 6164 6174 612e 6e61 6d65 0a20 2020  etadata.name.   
+0001b020: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001b030: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+0001b040: 2020 2020 2020 2020 2020 2020 6261 636b              back
+0001b050: 6772 6f75 6e64 5f74 6173 6b2e 7374 6174  ground_task.stat
+0001b060: 7573 2e73 7461 7465 0a20 2020 2020 2020  us.state.       
+0001b070: 2020 2020 2020 2020 203d 3d20 6d6c 7275           == mlru
+0001b080: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001b090: 2e42 6163 6b67 726f 756e 6454 6173 6b53  .BackgroundTaskS
+0001b0a0: 7461 7465 2e73 7563 6365 6564 6564 0a20  tate.succeeded. 
+0001b0b0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+0001b0c0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0001b0d0: 6767 6572 2e69 6e66 6f28 2250 726f 6a65  gger.info("Proje
+0001b0e0: 6374 2064 656c 6574 6564 222c 2070 726f  ct deleted", pro
+0001b0f0: 6a65 6374 5f6e 616d 653d 6e61 6d65 290a  ject_name=name).
+0001b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b110: 7265 7475 726e 0a20 2020 2020 2020 2065  return.        e
+0001b120: 6c69 6620 7265 7370 6f6e 7365 2e73 7461  lif response.sta
+0001b130: 7475 735f 636f 6465 203d 3d20 6874 7470  tus_code == http
+0001b140: 2e48 5454 5053 7461 7475 732e 4e4f 5f43  .HTTPStatus.NO_C
+0001b150: 4f4e 5445 4e54 3a0a 2020 2020 2020 2020  ONTENT:.        
+0001b160: 2020 2020 6c6f 6767 6572 2e69 6e66 6f28      logger.info(
+0001b170: 2250 726f 6a65 6374 2064 656c 6574 6564  "Project deleted
+0001b180: 222c 2070 726f 6a65 6374 5f6e 616d 653d  ", project_name=
+0001b190: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+0001b1a0: 2020 7265 7475 726e 0a0a 2020 2020 6465    return..    de
+0001b1b0: 6620 7374 6f72 655f 7072 6f6a 6563 7428  f store_project(
+0001b1c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001b1d0: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+0001b1e0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+0001b1f0: 743a 2055 6e69 6f6e 5b64 6963 742c 206d  t: Union[dict, m
+0001b200: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
+0001b210: 7275 6e50 726f 6a65 6374 2c20 6d6c 7275  runProject, mlru
+0001b220: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001b230: 2e50 726f 6a65 6374 5d2c 0a20 2020 2029  .Project],.    )
+0001b240: 202d 3e20 6d6c 7275 6e2e 7072 6f6a 6563   -> mlrun.projec
+0001b250: 7473 2e4d 6c72 756e 5072 6f6a 6563 743a  ts.MlrunProject:
+0001b260: 0a20 2020 2020 2020 2022 2222 5374 6f72  .        """Stor
+0001b270: 6520 6120 7072 6f6a 6563 7420 696e 2074  e a project in t
+0001b280: 6865 2044 422e 2054 6869 7320 6f70 6572  he DB. This oper
+0001b290: 6174 696f 6e20 7769 6c6c 206f 7665 7277  ation will overw
+0001b2a0: 7269 7465 2065 7869 7374 696e 6720 7072  rite existing pr
+0001b2b0: 6f6a 6563 7420 6f66 2074 6865 2073 616d  oject of the sam
+0001b2c0: 6520 6e61 6d65 2069 6620 6578 6973 7473  e name if exists
+0001b2d0: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
+0001b2e0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+0001b2f0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+0001b300: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0001b310: 6622 4661 696c 6564 2073 746f 7269 6e67  f"Failed storing
+0001b320: 2070 726f 6a65 6374 207b 6e61 6d65 7d22   project {name}"
+0001b330: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001b340: 7374 616e 6365 2870 726f 6a65 6374 2c20  stance(project, 
+0001b350: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001b360: 656d 6173 2e50 726f 6a65 6374 293a 0a20  emas.Project):. 
+0001b370: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+0001b380: 6374 203d 2070 726f 6a65 6374 2e64 6963  ct = project.dic
+0001b390: 7428 290a 2020 2020 2020 2020 656c 6966  t().        elif
+0001b3a0: 2069 7369 6e73 7461 6e63 6528 7072 6f6a   isinstance(proj
+0001b3b0: 6563 742c 206d 6c72 756e 2e70 726f 6a65  ect, mlrun.proje
+0001b3c0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+0001b3d0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
+0001b3e0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+0001b3f0: 2e74 6f5f 6469 6374 2829 0a20 2020 2020  .to_dict().     
+0001b400: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+0001b410: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0001b420: 2020 2020 2020 2020 2022 5055 5422 2c0a           "PUT",.
+0001b430: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001b440: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+0001b450: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+0001b460: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+0001b470: 6374 5f74 6f5f 6a73 6f6e 2870 726f 6a65  ct_to_json(proje
+0001b480: 6374 292c 0a20 2020 2020 2020 2029 0a20  ct),.        ). 
+0001b490: 2020 2020 2020 2069 6620 7265 7370 6f6e         if respon
+0001b4a0: 7365 2e73 7461 7475 735f 636f 6465 203d  se.status_code =
+0001b4b0: 3d20 6874 7470 2e48 5454 5053 7461 7475  = http.HTTPStatu
+0001b4c0: 732e 4143 4345 5054 4544 3a0a 2020 2020  s.ACCEPTED:.    
+0001b4d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001b4e0: 656c 662e 5f77 6169 745f 666f 725f 7072  elf._wait_for_pr
+0001b4f0: 6f6a 6563 745f 746f 5f72 6561 6368 5f74  oject_to_reach_t
+0001b500: 6572 6d69 6e61 6c5f 7374 6174 6528 6e61  erminal_state(na
+0001b510: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
+0001b520: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
+0001b530: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
+0001b540: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
+0001b550: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+0001b560: 6566 2070 6174 6368 5f70 726f 6a65 6374  ef patch_project
+0001b570: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001b580: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+0001b590: 722c 0a20 2020 2020 2020 2070 726f 6a65  r,.        proje
+0001b5a0: 6374 3a20 6469 6374 2c0a 2020 2020 2020  ct: dict,.      
+0001b5b0: 2020 7061 7463 685f 6d6f 6465 3a20 556e    patch_mode: Un
+0001b5c0: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+0001b5d0: 2073 7472 2c20 6d6c 7275 6e2e 636f 6d6d   str, mlrun.comm
+0001b5e0: 6f6e 2e73 6368 656d 6173 2e50 6174 6368  on.schemas.Patch
+0001b5f0: 4d6f 6465 0a20 2020 2020 2020 205d 203d  Mode.        ] =
+0001b600: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001b610: 6865 6d61 732e 5061 7463 684d 6f64 652e  hemas.PatchMode.
+0001b620: 7265 706c 6163 652c 0a20 2020 2029 202d  replace,.    ) -
+0001b630: 3e20 6d6c 7275 6e2e 7072 6f6a 6563 7473  > mlrun.projects
+0001b640: 2e4d 6c72 756e 5072 6f6a 6563 743a 0a20  .MlrunProject:. 
+0001b650: 2020 2020 2020 2022 2222 5061 7463 6820         """Patch 
+0001b660: 616e 2065 7869 7374 696e 6720 7072 6f6a  an existing proj
+0001b670: 6563 7420 6f62 6a65 6374 2e0a 0a20 2020  ect object...   
+0001b680: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+0001b690: 3a20 4e61 6d65 206f 6620 7072 6f6a 6563  : Name of projec
+0001b6a0: 7420 746f 2070 6174 6368 2e0a 2020 2020  t to patch..    
+0001b6b0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+0001b6c0: 6374 3a20 5468 6520 6163 7475 616c 2063  ct: The actual c
+0001b6d0: 6861 6e67 6573 2074 6f20 7468 6520 7072  hanges to the pr
+0001b6e0: 6f6a 6563 7420 6f62 6a65 6374 2e0a 2020  oject object..  
+0001b6f0: 2020 2020 2020 3a70 6172 616d 2070 6174        :param pat
+0001b700: 6368 5f6d 6f64 653a 2054 6865 2073 7472  ch_mode: The str
+0001b710: 6174 6567 7920 666f 7220 6d65 7267 696e  ategy for mergin
+0001b720: 6720 7468 6520 6368 616e 6765 7320 7769  g the changes wi
+0001b730: 7468 2074 6865 2065 7869 7374 696e 6720  th the existing 
+0001b740: 6f62 6a65 6374 2e20 4361 6e20 6265 2065  object. Can be e
+0001b750: 6974 6865 7220 6060 7265 706c 6163 6560  ither ``replace`
+0001b760: 600a 2020 2020 2020 2020 2020 2020 6f72  `.            or
+0001b770: 2060 6061 6464 6974 6976 6560 602e 0a20   ``additive``.. 
+0001b780: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001b790: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001b7a0: 6a65 6374 732f 7b6e 616d 657d 220a 2020  jects/{name}".  
+0001b7b0: 2020 2020 2020 6865 6164 6572 7320 3d20        headers = 
+0001b7c0: 7b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  {mlrun.common.sc
+0001b7d0: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
+0001b7e0: 732e 7061 7463 685f 6d6f 6465 3a20 7061  s.patch_mode: pa
+0001b7f0: 7463 685f 6d6f 6465 7d0a 2020 2020 2020  tch_mode}.      
+0001b800: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+0001b810: 3d20 6622 4661 696c 6564 2070 6174 6368  = f"Failed patch
+0001b820: 696e 6720 7072 6f6a 6563 7420 7b6e 616d  ing project {nam
+0001b830: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+0001b840: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0001b850: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0001b860: 2020 2250 4154 4348 222c 2070 6174 682c    "PATCH", path,
+0001b870: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+0001b880: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+0001b890: 6e28 7072 6f6a 6563 7429 2c20 6865 6164  n(project), head
+0001b8a0: 6572 733d 6865 6164 6572 730a 2020 2020  ers=headers.    
+0001b8b0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0001b8c0: 7475 726e 206d 6c72 756e 2e70 726f 6a65  turn mlrun.proje
+0001b8d0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+0001b8e0: 2e66 726f 6d5f 6469 6374 2872 6573 706f  .from_dict(respo
+0001b8f0: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
+0001b900: 2064 6566 2063 7265 6174 655f 7072 6f6a   def create_proj
+0001b910: 6563 7428 0a20 2020 2020 2020 2073 656c  ect(.        sel
+0001b920: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+0001b930: 6374 3a20 556e 696f 6e5b 6469 6374 2c20  ct: Union[dict, 
+0001b940: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+0001b950: 6c72 756e 5072 6f6a 6563 742c 206d 6c72  lrunProject, mlr
+0001b960: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001b970: 732e 5072 6f6a 6563 745d 2c0a 2020 2020  s.Project],.    
+0001b980: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
+0001b990: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+0001b9a0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+0001b9b0: 6174 6520 6120 6e65 7720 7072 6f6a 6563  ate a new projec
+0001b9c0: 742e 2041 2070 726f 6a65 6374 2077 6974  t. A project wit
+0001b9d0: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
+0001b9e0: 6d75 7374 206e 6f74 2065 7869 7374 2070  must not exist p
+0001b9f0: 7269 6f72 2074 6f20 6372 6561 7469 6f6e  rior to creation
+0001ba00: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
+0001ba10: 2069 7369 6e73 7461 6e63 6528 7072 6f6a   isinstance(proj
+0001ba20: 6563 742c 206d 6c72 756e 2e63 6f6d 6d6f  ect, mlrun.commo
+0001ba30: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+0001ba40: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0001ba50: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+0001ba60: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
+0001ba70: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0001ba80: 2870 726f 6a65 6374 2c20 6d6c 7275 6e2e  (project, mlrun.
+0001ba90: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+0001baa0: 6f6a 6563 7429 3a0a 2020 2020 2020 2020  oject):.        
+0001bab0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0001bac0: 6f6a 6563 742e 746f 5f64 6963 7428 290a  oject.to_dict().
+0001bad0: 2020 2020 2020 2020 7072 6f6a 6563 745f          project_
+0001bae0: 6e61 6d65 203d 2070 726f 6a65 6374 5b22  name = project["
+0001baf0: 6d65 7461 6461 7461 225d 5b22 6e61 6d65  metadata"]["name
+0001bb00: 225d 0a20 2020 2020 2020 2065 7272 6f72  "].        error
+0001bb10: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+0001bb20: 6c65 6420 6372 6561 7469 6e67 2070 726f  led creating pro
+0001bb30: 6a65 6374 207b 7072 6f6a 6563 745f 6e61  ject {project_na
+0001bb40: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+0001bb50: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0001bb60: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001bb70: 2020 2022 504f 5354 222c 0a20 2020 2020     "POST",.     
+0001bb80: 2020 2020 2020 2023 2064 6f20 6e6f 7420         # do not 
+0001bb90: 7761 6974 2066 6f72 2070 726f 6a65 6374  wait for project
+0001bba0: 2074 6f20 7265 6163 6820 7465 726d 696e   to reach termin
+0001bbb0: 616c 2073 7461 7465 2073 796e 6368 726f  al state synchro
+0001bbc0: 6e6f 7573 6c79 2e0a 2020 2020 2020 2020  nously..        
+0001bbd0: 2020 2020 2320 6c65 7420 6974 2073 7461      # let it sta
+0001bbe0: 7274 2061 6e64 2077 6169 7420 666f 7220  rt and wait for 
+0001bbf0: 6974 2074 6f20 7265 6163 6820 7465 726d  it to reach term
+0001bc00: 696e 616c 2073 7461 7465 2061 7379 6e63  inal state async
+0001bc10: 6872 6f6e 6f75 736c 790a 2020 2020 2020  hronously.      
+0001bc20: 2020 2020 2020 2270 726f 6a65 6374 733f        "projects?
+0001bc30: 7761 6974 2d66 6f72 2d63 6f6d 706c 6574  wait-for-complet
+0001bc40: 696f 6e3d 6661 6c73 6522 2c0a 2020 2020  ion=false",.    
+0001bc50: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001bc60: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+0001bc70: 2020 2062 6f64 793d 6469 6374 5f74 6f5f     body=dict_to_
+0001bc80: 6a73 6f6e 2870 726f 6a65 6374 292c 0a20  json(project),. 
+0001bc90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001bca0: 2069 6620 7265 7370 6f6e 7365 2e73 7461   if response.sta
+0001bcb0: 7475 735f 636f 6465 203d 3d20 6874 7470  tus_code == http
+0001bcc0: 2e48 5454 5053 7461 7475 732e 4143 4345  .HTTPStatus.ACCE
+0001bcd0: 5054 4544 3a0a 2020 2020 2020 2020 2020  PTED:.          
+0001bce0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+0001bcf0: 6169 745f 666f 725f 7072 6f6a 6563 745f  ait_for_project_
+0001bd00: 746f 5f72 6561 6368 5f74 6572 6d69 6e61  to_reach_termina
+0001bd10: 6c5f 7374 6174 6528 7072 6f6a 6563 745f  l_state(project_
+0001bd20: 6e61 6d65 290a 2020 2020 2020 2020 7265  name).        re
+0001bd30: 7475 726e 206d 6c72 756e 2e70 726f 6a65  turn mlrun.proje
+0001bd40: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+0001bd50: 2e66 726f 6d5f 6469 6374 2872 6573 706f  .from_dict(respo
+0001bd60: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
+0001bd70: 2064 6566 205f 7761 6974 5f66 6f72 5f70   def _wait_for_p
+0001bd80: 726f 6a65 6374 5f74 6f5f 7265 6163 685f  roject_to_reach_
+0001bd90: 7465 726d 696e 616c 5f73 7461 7465 280a  terminal_state(.
+0001bda0: 2020 2020 2020 2020 7365 6c66 2c20 7072          self, pr
+0001bdb0: 6f6a 6563 745f 6e61 6d65 3a20 7374 720a  oject_name: str.
+0001bdc0: 2020 2020 2920 2d3e 206d 6c72 756e 2e70      ) -> mlrun.p
+0001bdd0: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+0001bde0: 6a65 6374 3a0a 2020 2020 2020 2020 6465  ject:.        de
+0001bdf0: 6620 5f76 6572 6966 795f 7072 6f6a 6563  f _verify_projec
+0001be00: 745f 696e 5f74 6572 6d69 6e61 6c5f 7374  t_in_terminal_st
+0001be10: 6174 6528 293a 0a20 2020 2020 2020 2020  ate():.         
+0001be20: 2020 2070 726f 6a65 6374 203d 2073 656c     project = sel
+0001be30: 662e 6765 745f 7072 6f6a 6563 7428 7072  f.get_project(pr
+0001be40: 6f6a 6563 745f 6e61 6d65 290a 2020 2020  oject_name).    
+0001be50: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+0001be60: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+0001be70: 6a65 6374 2e73 7461 7475 732e 7374 6174  ject.status.stat
+0001be80: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001be90: 2020 6e6f 7420 696e 206d 6c72 756e 2e63    not in mlrun.c
+0001bea0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5072  ommon.schemas.Pr
+0001beb0: 6f6a 6563 7453 7461 7465 2e74 6572 6d69  ojectState.termi
+0001bec0: 6e61 6c5f 7374 6174 6573 2829 0a20 2020  nal_states().   
+0001bed0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+0001bee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001bef0: 6520 4578 6365 7074 696f 6e28 0a20 2020  e Exception(.   
 0001bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf10: 2022 7072 6f6a 6563 7431 222c 0a20 2020   "project1",.   
-0001bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf30: 2070 726f 7669 6465 723d 6d6c 7275 6e2e   provider=mlrun.
-0001bf40: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0001bf50: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
-0001bf60: 652e 6b75 6265 726e 6574 6573 2c0a 2020  e.kubernetes,.  
-0001bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf80: 2020 7365 6372 6574 733d 7365 6372 6574    secrets=secret
-0001bf90: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0001bfa0: 2020 290a 2020 2020 2020 2020 2222 220a    ).        """.
-0001bfb0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0001bfc0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0001bfd0: 6374 7d2f 7365 6372 6574 7322 0a20 2020  ct}/secrets".   
-0001bfe0: 2020 2020 2073 6563 7265 7473 5f69 6e70       secrets_inp
-0001bff0: 7574 203d 206d 6c72 756e 2e63 6f6d 6d6f  ut = mlrun.commo
-0001c000: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-0001c010: 7344 6174 6128 0a20 2020 2020 2020 2020  sData(.         
-0001c020: 2020 2073 6563 7265 7473 3d73 6563 7265     secrets=secre
-0001c030: 7473 2c20 7072 6f76 6964 6572 3d70 726f  ts, provider=pro
-0001c040: 7669 6465 720a 2020 2020 2020 2020 290a  vider.        ).
-0001c050: 2020 2020 2020 2020 626f 6479 203d 2073          body = s
-0001c060: 6563 7265 7473 5f69 6e70 7574 2e64 6963  ecrets_input.dic
-0001c070: 7428 290a 2020 2020 2020 2020 6572 726f  t().        erro
-0001c080: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-0001c090: 696c 6564 2063 7265 6174 696e 6720 7365  iled creating se
-0001c0a0: 6372 6574 2070 726f 7669 6465 7220 7b70  cret provider {p
-0001c0b0: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
-0001c0c0: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
-0001c0d0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0001c0e0: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
-0001c0f0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-0001c100: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-0001c110: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
-0001c120: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-0001c130: 745f 746f 5f6a 736f 6e28 626f 6479 292c  t_to_json(body),
-0001c140: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001c150: 6465 6620 6c69 7374 5f70 726f 6a65 6374  def list_project
-0001c160: 5f73 6563 7265 7473 280a 2020 2020 2020  _secrets(.      
-0001c170: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001c180: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-0001c190: 2020 2020 2020 746f 6b65 6e3a 2073 7472        token: str
-0001c1a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001c1b0: 2070 726f 7669 6465 723a 2055 6e69 6f6e   provider: Union
-0001c1c0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
-0001c1d0: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
-0001c1e0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
-0001c1f0: 6f76 6964 6572 4e61 6d65 0a20 2020 2020  oviderName.     
-0001c200: 2020 205d 203d 206d 6c72 756e 2e63 6f6d     ] = mlrun.com
-0001c210: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001c220: 6574 5072 6f76 6964 6572 4e61 6d65 2e6b  etProviderName.k
-0001c230: 7562 6572 6e65 7465 732c 0a20 2020 2020  ubernetes,.     
-0001c240: 2020 2073 6563 7265 7473 3a20 6c69 7374     secrets: list
-0001c250: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0001c260: 2020 2920 2d3e 206d 6c72 756e 2e63 6f6d    ) -> mlrun.com
-0001c270: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001c280: 6574 7344 6174 613a 0a20 2020 2020 2020  etsData:.       
-0001c290: 2022 2222 5265 7472 6965 7665 2070 726f   """Retrieve pro
-0001c2a0: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
-0001c2b0: 7265 7473 2066 726f 6d20 5661 756c 742e  rets from Vault.
-0001c2c0: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
-0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2e0: 5468 6973 206d 6574 686f 6420 666f 7220  This method for 
-0001c2f0: 5661 756c 7420 6675 6e63 7469 6f6e 616c  Vault functional
-0001c300: 6974 7920 6973 2063 7572 7265 6e74 6c79  ity is currently
-0001c310: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
-0001c320: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
-0001c330: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
-0001c340: 5661 756c 740a 2020 2020 2020 2020 2020  Vault.          
-0001c350: 2020 2020 2020 696e 6672 6173 7472 7563        infrastruc
-0001c360: 7475 7265 2070 726f 7065 726c 7920 7365  ture properly se
-0001c370: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
-0001c380: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
-0001c390: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
-0001c3a0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0001c3b0: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
-0001c3c0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
-0001c3d0: 7061 7261 6d20 746f 6b65 6e3a 2056 6175  param token: Vau
-0001c3e0: 6c74 2074 6f6b 656e 2074 6f20 7573 6520  lt token to use 
-0001c3f0: 666f 7220 7265 7472 6965 7669 6e67 2073  for retrieving s
-0001c400: 6563 7265 7473 2e0a 2020 2020 2020 2020  ecrets..        
-0001c410: 2020 2020 4d75 7374 2062 6520 6120 7661      Must be a va
-0001c420: 6c69 6420 5661 756c 7420 746f 6b65 6e2c  lid Vault token,
-0001c430: 2077 6974 6820 7065 726d 6973 7369 6f6e   with permission
-0001c440: 7320 746f 2072 6574 7269 6576 6520 7365  s to retrieve se
-0001c450: 6372 6574 7320 6f66 2074 6865 2070 726f  crets of the pro
-0001c460: 6a65 6374 2069 6e20 7175 6573 7469 6f6e  ject in question
-0001c470: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001c480: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
-0001c490: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
-0001c4a0: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
-0001c4b0: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
-0001c4c0: 746c 7920 6f6e 6c79 2060 6076 6175 6c74  tly only ``vault
-0001c4d0: 6060 2069 7320 6163 6365 7074 6564 2e0a  `` is accepted..
-0001c4e0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001c4f0: 6563 7265 7473 3a20 4120 6c69 7374 206f  ecrets: A list o
-0001c500: 6620 7365 6372 6574 206e 616d 6573 2074  f secret names t
-0001c510: 6f20 7265 7472 6965 7665 2e20 416e 2065  o retrieve. An e
-0001c520: 6d70 7479 206c 6973 7420 6060 5b5d 6060  mpty list ``[]``
-0001c530: 2077 696c 6c20 7265 7472 6965 7665 2061   will retrieve a
-0001c540: 6c6c 2073 6563 7265 7473 2061 7373 6967  ll secrets assig
-0001c550: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
-0001c560: 746f 2074 6869 7320 7370 6563 6966 6963  to this specific
-0001c570: 2070 726f 6a65 6374 2e20 6060 6b75 6265   project. ``kube
-0001c580: 726e 6574 6573 6060 2070 726f 7669 6465  rnetes`` provide
-0001c590: 7220 6f6e 6c79 2073 7570 706f 7274 7320  r only supports 
-0001c5a0: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
-0001c5b0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0001c5c0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-0001c5d0: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
-0001c5e0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001c5f0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
-0001c600: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
-0001c610: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-0001c620: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
-0001c630: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0001c640: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
-0001c650: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
-0001c660: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0001c670: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
-0001c680: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
-0001c690: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
-0001c6a0: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
-0001c6b0: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
-0001c6c0: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
-0001c6d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001c6e0: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
-0001c6f0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-0001c700: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
-0001c710: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
-0001c720: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
-0001c730: 2020 2020 6865 6164 6572 7320 3d20 7b6d      headers = {m
-0001c740: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001c750: 6d61 732e 4865 6164 6572 4e61 6d65 732e  mas.HeaderNames.
-0001c760: 7365 6372 6574 5f73 746f 7265 5f74 6f6b  secret_store_tok
-0001c770: 656e 3a20 746f 6b65 6e7d 0a20 2020 2020  en: token}.     
-0001c780: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001c790: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
-0001c7a0: 6965 7669 6e67 2073 6563 7265 7473 207b  ieving secrets {
-0001c7b0: 7072 6f6a 6563 747d 2f7b 7072 6f76 6964  project}/{provid
-0001c7c0: 6572 7d22 0a20 2020 2020 2020 2072 6573  er}".        res
-0001c7d0: 756c 7420 3d20 7365 6c66 2e61 7069 5f63  ult = self.api_c
-0001c7e0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0001c7f0: 2022 4745 5422 2c0a 2020 2020 2020 2020   "GET",.        
-0001c800: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-0001c810: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0001c820: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-0001c830: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
-0001c840: 2020 2020 2020 2020 2020 2020 6865 6164              head
-0001c850: 6572 733d 6865 6164 6572 732c 0a20 2020  ers=headers,.   
-0001c860: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0001c870: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
-0001c880: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
-0001c890: 7473 4461 7461 282a 2a72 6573 756c 742e  tsData(**result.
-0001c8a0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0001c8b0: 206c 6973 745f 7072 6f6a 6563 745f 7365   list_project_se
-0001c8c0: 6372 6574 5f6b 6579 7328 0a20 2020 2020  cret_keys(.     
-0001c8d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001c8e0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-0001c8f0: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
-0001c900: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-0001c910: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-0001c920: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-0001c930: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-0001c940: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-0001c950: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001c960: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
-0001c970: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
-0001c980: 0a20 2020 2020 2020 2074 6f6b 656e 3a20  .        token: 
-0001c990: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-0001c9a0: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-0001c9b0: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-0001c9c0: 4b65 7973 4461 7461 3a0a 2020 2020 2020  KeysData:.      
-0001c9d0: 2020 2222 2252 6574 7269 6576 6520 7072    """Retrieve pr
-0001c9e0: 6f6a 6563 742d 636f 6e74 6578 7420 7365  oject-context se
-0001c9f0: 6372 6574 206b 6579 7320 6672 6f6d 2056  cret keys from V
-0001ca00: 6175 6c74 206f 7220 4b75 6265 726e 6574  ault or Kubernet
-0001ca10: 6573 2e0a 0a20 2020 2020 2020 204e 6f74  es...        Not
-0001ca20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001ca30: 2020 2054 6869 7320 6d65 7468 6f64 2066     This method f
-0001ca40: 6f72 2056 6175 6c74 2066 756e 6374 696f  or Vault functio
-0001ca50: 6e61 6c69 7479 2069 7320 6375 7272 656e  nality is curren
-0001ca60: 746c 7920 696e 2074 6563 686e 6963 616c  tly in technical
-0001ca70: 2070 7265 7669 6577 2c20 616e 6420 7265   preview, and re
-0001ca80: 7175 6972 6573 2061 2048 6173 6869 436f  quires a HashiCo
-0001ca90: 7270 2056 6175 6c74 0a20 2020 2020 2020  rp Vault.       
-0001caa0: 2020 2020 2020 2020 2069 6e66 7261 7374           infrast
-0001cab0: 7275 6374 7572 6520 7072 6f70 6572 6c79  ructure properly
-0001cac0: 2073 6574 2075 7020 616e 6420 636f 6e6e   set up and conn
-0001cad0: 6563 7465 6420 746f 2074 6865 204d 4c52  ected to the MLR
-0001cae0: 756e 2041 5049 2073 6572 7665 722e 0a0a  un API server...
-0001caf0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001cb00: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
-0001cb10: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
-0001cb20: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
-0001cb30: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
-0001cb40: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
-0001cb50: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
-0001cb60: 2e20 4163 6365 7074 7320 610a 2020 2020  . Accepts a.    
-0001cb70: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
-0001cb80: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-0001cb90: 2e73 6368 656d 6173 2e73 6563 7265 742e  .schemas.secret.
-0001cba0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-0001cbb0: 6d65 6020 656e 756d 2e0a 2020 2020 2020  me` enum..      
-0001cbc0: 2020 3a70 6172 616d 2074 6f6b 656e 3a20    :param token: 
-0001cbd0: 5661 756c 7420 746f 6b65 6e20 746f 2075  Vault token to u
-0001cbe0: 7365 2066 6f72 2072 6574 7269 6576 696e  se for retrievin
-0001cbf0: 6720 7365 6372 6574 732e 204f 6e6c 7920  g secrets. Only 
-0001cc00: 696e 2075 7365 2069 6620 6060 7072 6f76  in use if ``prov
-0001cc10: 6964 6572 6060 2069 7320 6060 7661 756c  ider`` is ``vaul
-0001cc20: 7460 602e 0a20 2020 2020 2020 2020 2020  t``..           
-0001cc30: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
-0001cc40: 2056 6175 6c74 2074 6f6b 656e 2c20 7769   Vault token, wi
-0001cc50: 7468 2070 6572 6d69 7373 696f 6e73 2074  th permissions t
-0001cc60: 6f20 7265 7472 6965 7665 2073 6563 7265  o retrieve secre
-0001cc70: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
-0001cc80: 7420 696e 2071 7565 7374 696f 6e2e 0a20  t in question.. 
-0001cc90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0001cca0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-0001ccb0: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
-0001ccc0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001ccd0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
-0001cce0: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
-0001ccf0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-0001cd00: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
-0001cd10: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0001cd20: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
-0001cd30: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
-0001cd40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0001cd50: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
-0001cd60: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
-0001cd70: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
-0001cd80: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
-0001cd90: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
-0001cda0: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
-0001cdb0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001cdc0: 726f 6a65 6374 7d2f 7365 6372 6574 2d6b  roject}/secret-k
-0001cdd0: 6579 7322 0a20 2020 2020 2020 2070 6172  eys".        par
-0001cde0: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
-0001cdf0: 223a 2070 726f 7669 6465 727d 0a20 2020  ": provider}.   
-0001ce00: 2020 2020 2068 6561 6465 7273 203d 2028       headers = (
-0001ce10: 0a20 2020 2020 2020 2020 2020 207b 6d6c  .            {ml
-0001ce20: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001ce30: 6173 2e48 6561 6465 724e 616d 6573 2e73  as.HeaderNames.s
-0001ce40: 6563 7265 745f 7374 6f72 655f 746f 6b65  ecret_store_toke
-0001ce50: 6e3a 2074 6f6b 656e 7d0a 2020 2020 2020  n: token}.      
-0001ce60: 2020 2020 2020 6966 2070 726f 7669 6465        if provide
-0001ce70: 7220 3d3d 206d 6c72 756e 2e63 6f6d 6d6f  r == mlrun.commo
-0001ce80: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-0001ce90: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
-0001cea0: 6c74 2e76 616c 7565 0a20 2020 2020 2020  lt.value.       
-0001ceb0: 2020 2020 2065 6c73 6520 4e6f 6e65 0a20       else None. 
-0001cec0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ced0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0001cee0: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
-0001cef0: 7669 6e67 2073 6563 7265 7420 6b65 7973  ving secret keys
-0001cf00: 207b 7072 6f6a 6563 747d 2f7b 7072 6f76   {project}/{prov
-0001cf10: 6964 6572 7d22 0a20 2020 2020 2020 2072  ider}".        r
-0001cf20: 6573 756c 7420 3d20 7365 6c66 2e61 7069  esult = self.api
-0001cf30: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0001cf40: 2020 2022 4745 5422 2c0a 2020 2020 2020     "GET",.      
-0001cf50: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
-0001cf60: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0001cf70: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
-0001cf80: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
-0001cf90: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
-0001cfa0: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
-0001cfb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001cfc0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-0001cfd0: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
-0001cfe0: 7265 744b 6579 7344 6174 6128 2a2a 7265  retKeysData(**re
-0001cff0: 7375 6c74 2e6a 736f 6e28 2929 0a0a 2020  sult.json())..  
-0001d000: 2020 6465 6620 6465 6c65 7465 5f70 726f    def delete_pro
-0001d010: 6a65 6374 5f73 6563 7265 7473 280a 2020  ject_secrets(.  
-0001d020: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001d030: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-0001d040: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
-0001d050: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
-0001d060: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
-0001d070: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001d080: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-0001d090: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
-0001d0a0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001d0b0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-0001d0c0: 6465 724e 616d 652e 6b75 6265 726e 6574  derName.kubernet
-0001d0d0: 6573 2c0a 2020 2020 2020 2020 7365 6372  es,.        secr
-0001d0e0: 6574 733a 206c 6973 745b 7374 725d 203d  ets: list[str] =
-0001d0f0: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
-0001d100: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
-0001d110: 7072 6f6a 6563 742d 636f 6e74 6578 7420  project-context 
-0001d120: 7365 6372 6574 7320 6672 6f6d 204b 7562  secrets from Kub
-0001d130: 6572 6e65 7465 732e 0a0a 2020 2020 2020  ernetes...      
-0001d140: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-0001d150: 3a20 5468 6520 7072 6f6a 6563 7420 6e61  : The project na
-0001d160: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
-0001d170: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
-0001d180: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
-0001d190: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
-0001d1a0: 2077 6f72 6b20 7769 7468 2e20 4375 7272   work with. Curr
-0001d1b0: 656e 746c 7920 6f6e 6c79 2060 606b 7562  ently only ``kub
-0001d1c0: 6572 6e65 7465 7360 6020 6973 2073 7570  ernetes`` is sup
-0001d1d0: 706f 7274 6564 2e0a 2020 2020 2020 2020  ported..        
-0001d1e0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
-0001d1f0: 4120 6c69 7374 206f 6620 7365 6372 6574  A list of secret
-0001d200: 206e 616d 6573 2074 6f20 6465 6c65 7465   names to delete
-0001d210: 2e20 416e 2065 6d70 7479 206c 6973 7420  . An empty list 
-0001d220: 7769 6c6c 2064 656c 6574 6520 616c 6c20  will delete all 
-0001d230: 7365 6372 6574 7320 6173 7369 676e 6564  secrets assigned
-0001d240: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-0001d250: 7468 6973 2073 7065 6369 6669 6320 7072  this specific pr
-0001d260: 6f6a 6563 742e 0a20 2020 2020 2020 2022  oject..        "
-0001d270: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-0001d280: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001d290: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
-0001d2a0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-0001d2b0: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
-0001d2c0: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
-0001d2d0: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
-0001d2e0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-0001d2f0: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
-0001d300: 6574 696e 6720 7365 6372 6574 7320 7b70  eting secrets {p
-0001d310: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
-0001d320: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
-0001d330: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0001d340: 2020 2020 2020 2022 4445 4c45 5445 222c         "DELETE",
-0001d350: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-0001d360: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-0001d370: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-0001d380: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0001d390: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-0001d3a0: 2029 0a0a 2020 2020 6465 6620 6372 6561   )..    def crea
-0001d3b0: 7465 5f75 7365 725f 7365 6372 6574 7328  te_user_secrets(
-0001d3c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001d3d0: 2020 2020 2020 2075 7365 723a 2073 7472         user: str
-0001d3e0: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
-0001d3f0: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
-0001d400: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
-0001d410: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001d420: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-0001d430: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
-0001d440: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001d450: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-0001d460: 6465 724e 616d 652e 7661 756c 742c 0a20  derName.vault,. 
-0001d470: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
-0001d480: 6469 6374 203d 204e 6f6e 652c 0a20 2020  dict = None,.   
-0001d490: 2029 3a0a 2020 2020 2020 2020 2222 2243   ):.        """C
-0001d4a0: 7265 6174 6520 7573 6572 2d63 6f6e 7465  reate user-conte
-0001d4b0: 7874 2073 6563 7265 7420 696e 2056 6175  xt secret in Vau
-0001d4c0: 6c74 2e20 506c 6561 7365 2072 6566 6572  lt. Please refer
-0001d4d0: 2074 6f20 3a70 793a 6675 6e63 3a60 6372   to :py:func:`cr
-0001d4e0: 6561 7465 5f70 726f 6a65 6374 5f73 6563  eate_project_sec
-0001d4f0: 7265 7473 6020 666f 7220 6d6f 7265 2064  rets` for more d
-0001d500: 6574 6169 6c73 0a20 2020 2020 2020 2061  etails.        a
-0001d510: 6e64 2073 7461 7475 7320 6f66 2074 6869  nd status of thi
-0001d520: 7320 6675 6e63 7469 6f6e 616c 6974 792e  s functionality.
-0001d530: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 5468 6973 206d 6574 686f 6420 6973 2063  This method is c
-0001d560: 7572 7265 6e74 6c79 2069 6e20 7465 6368  urrently in tech
-0001d570: 6e69 6361 6c20 7072 6576 6965 772c 2061  nical preview, a
-0001d580: 6e64 2072 6571 7569 7265 7320 6120 4861  nd requires a Ha
-0001d590: 7368 6943 6f72 7020 5661 756c 7420 696e  shiCorp Vault in
-0001d5a0: 6672 6173 7472 7563 7475 7265 0a20 2020  frastructure.   
-0001d5b0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0001d5c0: 7065 726c 7920 7365 7420 7570 2061 6e64  perly set up and
-0001d5d0: 2063 6f6e 6e65 6374 6564 2074 6f20 7468   connected to th
-0001d5e0: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
-0001d5f0: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
-0001d600: 7261 6d20 7573 6572 3a20 5468 6520 7573  ram user: The us
-0001d610: 6572 2063 6f6e 7465 7874 2066 6f72 2077  er context for w
-0001d620: 6869 6368 2074 6f20 6765 6e65 7261 7465  hich to generate
-0001d630: 2074 6865 2069 6e66 7261 2061 6e64 2073   the infra and s
-0001d640: 746f 7265 2073 6563 7265 7473 2e0a 2020  tore secrets..  
-0001d650: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0001d660: 7669 6465 723a 2054 6865 206e 616d 6520  vider: The name 
-0001d670: 6f66 2074 6865 2073 6563 7265 7473 2d70  of the secrets-p
-0001d680: 726f 7669 6465 7220 746f 2077 6f72 6b20  rovider to work 
-0001d690: 7769 7468 2e20 4375 7272 656e 746c 7920  with. Currently 
-0001d6a0: 6f6e 6c79 2060 6076 6175 6c74 6060 2069  only ``vault`` i
-0001d6b0: 7320 7375 7070 6f72 7465 642e 0a20 2020  s supported..   
-0001d6c0: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
-0001d6d0: 6574 733a 2041 2073 6574 206f 6620 7365  ets: A set of se
-0001d6e0: 6372 6574 2076 616c 7565 7320 746f 2073  cret values to s
-0001d6f0: 746f 7265 2077 6974 6869 6e20 7468 6520  tore within the 
-0001d700: 5661 756c 742e 0a20 2020 2020 2020 2022  Vault..        "
-0001d710: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
-0001d720: 3d20 2275 7365 722d 7365 6372 6574 7322  = "user-secrets"
-0001d730: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-0001d740: 5f63 7265 6174 696f 6e5f 7265 7175 6573  _creation_reques
-0001d750: 7420 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  t = mlrun.common
-0001d760: 2e73 6368 656d 6173 2e55 7365 7253 6563  .schemas.UserSec
-0001d770: 7265 7443 7265 6174 696f 6e52 6571 7565  retCreationReque
-0001d780: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
-0001d790: 7573 6572 3d75 7365 722c 0a20 2020 2020  user=user,.     
-0001d7a0: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
-0001d7b0: 7072 6f76 6964 6572 2c0a 2020 2020 2020  provider,.      
-0001d7c0: 2020 2020 2020 7365 6372 6574 733d 7365        secrets=se
-0001d7d0: 6372 6574 732c 0a20 2020 2020 2020 2029  crets,.        )
-0001d7e0: 0a20 2020 2020 2020 2062 6f64 7920 3d20  .        body = 
-0001d7f0: 7365 6372 6574 735f 6372 6561 7469 6f6e  secrets_creation
-0001d800: 5f72 6571 7565 7374 2e64 6963 7428 290a  _request.dict().
-0001d810: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0001d820: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
-0001d830: 2063 7265 6174 696e 6720 7573 6572 2073   creating user s
-0001d840: 6563 7265 7473 202d 207b 7573 6572 7d22  ecrets - {user}"
-0001d850: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-0001d860: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0001d870: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-0001d880: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-0001d890: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-0001d8a0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-0001d8b0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-0001d8c0: 6f5f 6a73 6f6e 2862 6f64 7929 2c0a 2020  o_json(body),.  
-0001d8d0: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
-0001d8e0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
-0001d8f0: 6566 205f 7661 6c69 6461 7465 5f76 6572  ef _validate_ver
-0001d900: 7369 6f6e 5f63 6f6d 7061 7469 6269 6c69  sion_compatibili
-0001d910: 7479 2873 6572 7665 725f 7665 7273 696f  ty(server_versio
-0001d920: 6e2c 2063 6c69 656e 745f 7665 7273 696f  n, client_versio
-0001d930: 6e29 202d 3e20 626f 6f6c 3a0a 2020 2020  n) -> bool:.    
-0001d940: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0001d950: 2020 2020 2070 6172 7365 645f 7365 7276       parsed_serv
-0001d960: 6572 5f76 6572 7369 6f6e 203d 2073 656d  er_version = sem
-0001d970: 7665 722e 5665 7273 696f 6e49 6e66 6f2e  ver.VersionInfo.
-0001d980: 7061 7273 6528 7365 7276 6572 5f76 6572  parse(server_ver
-0001d990: 7369 6f6e 290a 2020 2020 2020 2020 2020  sion).          
-0001d9a0: 2020 7061 7273 6564 5f63 6c69 656e 745f    parsed_client_
-0001d9b0: 7665 7273 696f 6e20 3d20 7365 6d76 6572  version = semver
-0001d9c0: 2e56 6572 7369 6f6e 496e 666f 2e70 6172  .VersionInfo.par
-0001d9d0: 7365 2863 6c69 656e 745f 7665 7273 696f  se(client_versio
-0001d9e0: 6e29 0a20 2020 2020 2020 2065 7863 6570  n).        excep
-0001d9f0: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
-0001da00: 2020 2020 2020 2020 2020 2320 5468 6973            # This
-0001da10: 2077 696c 6c20 6d6f 7374 6c79 2068 6170   will mostly hap
-0001da20: 7065 6e20 696e 2064 6576 2073 6365 6e61  pen in dev scena
-0001da30: 7269 6f73 2077 6865 6e20 7468 6520 7665  rios when the ve
-0001da40: 7273 696f 6e20 6973 2075 6e73 7461 626c  rsion is unstabl
-0001da50: 6520 616e 6420 7375 6368 202d 2074 6865  e and such - the
-0001da60: 7265 666f 7265 2077 6527 7265 2069 676e  refore we're ign
-0001da70: 6f72 696e 670a 2020 2020 2020 2020 2020  oring.          
-0001da80: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
-0001da90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001daa0: 2020 2255 6e61 626c 6520 746f 2070 6172    "Unable to par
-0001dab0: 7365 2073 6572 7665 7220 6f72 2063 6c69  se server or cli
-0001dac0: 656e 7420 7665 7273 696f 6e2e 2041 7373  ent version. Ass
-0001dad0: 756d 696e 6720 636f 6d70 6174 6962 6c65  uming compatible
-0001dae0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001daf0: 2020 2073 6572 7665 725f 7665 7273 696f     server_versio
-0001db00: 6e3d 7365 7276 6572 5f76 6572 7369 6f6e  n=server_version
-0001db10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001db20: 2020 636c 6965 6e74 5f76 6572 7369 6f6e    client_version
-0001db30: 3d63 6c69 656e 745f 7665 7273 696f 6e2c  =client_version,
-0001db40: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001db50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001db60: 6e20 5472 7565 0a20 2020 2020 2020 2069  n True.        i
-0001db70: 6620 2870 6172 7365 645f 7365 7276 6572  f (parsed_server
-0001db80: 5f76 6572 7369 6f6e 2e6d 616a 6f72 203d  _version.major =
-0001db90: 3d20 3020 616e 6420 7061 7273 6564 5f73  = 0 and parsed_s
-0001dba0: 6572 7665 725f 7665 7273 696f 6e2e 6d69  erver_version.mi
-0001dbb0: 6e6f 7220 3d3d 2030 2920 6f72 2028 0a20  nor == 0) or (. 
-0001dbc0: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001dbd0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001dbe0: 2e6d 616a 6f72 203d 3d20 3020 616e 6420  .major == 0 and 
-0001dbf0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001dc00: 7273 696f 6e2e 6d69 6e6f 7220 3d3d 2030  rsion.minor == 0
-0001dc10: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0001dc20: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
-0001dc30: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
-0001dc40: 2020 2020 2020 2020 2253 6572 7665 7220          "Server 
-0001dc50: 6f72 2063 6c69 656e 7420 7665 7273 696f  or client versio
-0001dc60: 6e20 6973 2075 6e73 7461 626c 652e 2041  n is unstable. A
-0001dc70: 7373 756d 696e 6720 636f 6d70 6174 6962  ssuming compatib
-0001dc80: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-0001dc90: 2020 2020 2073 6572 7665 725f 7665 7273       server_vers
-0001dca0: 696f 6e3d 7365 7276 6572 5f76 6572 7369  ion=server_versi
-0001dcb0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001dcc0: 2020 2020 636c 6965 6e74 5f76 6572 7369      client_versi
-0001dcd0: 6f6e 3d63 6c69 656e 745f 7665 7273 696f  on=client_versio
-0001dce0: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-0001dcf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001dd00: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
-0001dd10: 2069 6620 7061 7273 6564 5f73 6572 7665   if parsed_serve
-0001dd20: 725f 7665 7273 696f 6e2e 6d61 6a6f 7220  r_version.major 
-0001dd30: 213d 2070 6172 7365 645f 636c 6965 6e74  != parsed_client
-0001dd40: 5f76 6572 7369 6f6e 2e6d 616a 6f72 3a0a  _version.major:.
-0001dd50: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0001dd60: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-0001dd70: 2020 2020 2020 2020 2020 2020 2253 6572              "Ser
-0001dd80: 7665 7220 616e 6420 636c 6965 6e74 2076  ver and client v
-0001dd90: 6572 7369 6f6e 7320 6172 6520 696e 636f  ersions are inco
-0001dda0: 6d70 6174 6962 6c65 222c 0a20 2020 2020  mpatible",.     
-0001ddb0: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001ddc0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001ddd0: 3d70 6172 7365 645f 7365 7276 6572 5f76  =parsed_server_v
-0001dde0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001ddf0: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
-0001de00: 6c69 656e 745f 7665 7273 696f 6e3d 7061  lient_version=pa
-0001de10: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001de20: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001de30: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0001de40: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
-0001de50: 2020 2020 6966 2070 6172 7365 645f 7365      if parsed_se
-0001de60: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
-0001de70: 6f72 203e 2070 6172 7365 645f 636c 6965  or > parsed_clie
-0001de80: 6e74 5f76 6572 7369 6f6e 2e6d 696e 6f72  nt_version.minor
-0001de90: 202b 2032 3a0a 2020 2020 2020 2020 2020   + 2:.          
-0001dea0: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
-0001deb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001dec0: 4261 636b 7761 7264 7320 636f 6d70 6174  Backwards compat
-0001ded0: 6962 696c 6974 7920 6d69 6768 7420 6e6f  ibility might no
-0001dee0: 7420 6170 706c 7920 6265 7477 6565 6e20  t apply between 
-0001def0: 7468 6520 7365 7276 6572 2061 6e64 2063  the server and c
-0001df00: 6c69 656e 7420 7665 7273 696f 6e22 2c0a  lient version",.
-0001df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df20: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001df30: 7273 696f 6e3d 7061 7273 6564 5f73 6572  rsion=parsed_ser
-0001df40: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
-0001df50: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0001df60: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001df70: 6f6e 3d70 6172 7365 645f 636c 6965 6e74  on=parsed_client
-0001df80: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
-0001df90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001dfa0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-0001dfb0: 0a20 2020 2020 2020 2069 6620 7061 7273  .        if pars
-0001dfc0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
-0001dfd0: 6e2e 6d69 6e6f 7220 3e20 7061 7273 6564  n.minor > parsed
-0001dfe0: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
-0001dff0: 6d69 6e6f 723a 0a20 2020 2020 2020 2020  minor:.         
-0001e000: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
-0001e010: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0001e020: 2020 2022 436c 6965 6e74 2076 6572 7369     "Client versi
-0001e030: 6f6e 2077 6974 6820 6869 6768 6572 2076  on with higher v
-0001e040: 6572 7369 6f6e 2074 6861 6e20 7365 7276  ersion than serv
-0001e050: 6572 2076 6572 7369 6f6e 2069 736e 2774  er version isn't
-0001e060: 2073 7570 706f 7274 6564 2c22 0a20 2020   supported,".   
-0001e070: 2020 2020 2020 2020 2020 2020 2022 2061               " a
-0001e080: 6c69 676e 2079 6f75 7220 636c 6965 6e74  lign your client
-0001e090: 2074 6f20 7468 6520 7365 7276 6572 2076   to the server v
-0001e0a0: 6572 7369 6f6e 222c 0a20 2020 2020 2020  ersion",.       
-0001e0b0: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
-0001e0c0: 7365 7276 6572 5f76 6572 7369 6f6e 3d70  server_version=p
-0001e0d0: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
-0001e0e0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0001e0f0: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
-0001e100: 656e 745f 7665 7273 696f 6e3d 7061 7273  ent_version=pars
-0001e110: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
-0001e120: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
-0001e130: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e140: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
-0001e150: 2020 6966 2070 6172 7365 645f 7365 7276    if parsed_serv
-0001e160: 6572 5f76 6572 7369 6f6e 2e6d 696e 6f72  er_version.minor
-0001e170: 2021 3d20 7061 7273 6564 5f63 6c69 656e   != parsed_clien
-0001e180: 745f 7665 7273 696f 6e2e 6d69 6e6f 723a  t_version.minor:
-0001e190: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-0001e1a0: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
-0001e1b0: 2020 2020 2020 2020 2020 2253 6572 7665            "Serve
-0001e1c0: 7220 616e 6420 636c 6965 6e74 2076 6572  r and client ver
-0001e1d0: 7369 6f6e 7320 6172 6520 6e6f 7420 7468  sions are not th
-0001e1e0: 6520 7361 6d65 2062 7574 2063 6f6d 7061  e same but compa
-0001e1f0: 7469 626c 6522 2c0a 2020 2020 2020 2020  tible",.        
-0001e200: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
-0001e210: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
-0001e220: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
-0001e230: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001e240: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
-0001e250: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
-0001e260: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001e270: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001e280: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0001e290: 7275 650a 0a20 2020 2064 6566 2063 7265  rue..    def cre
-0001e2a0: 6174 655f 6d6f 6465 6c5f 656e 6470 6f69  ate_model_endpoi
-0001e2b0: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
-0001e2c0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0001e2d0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0001e2e0: 656e 6470 6f69 6e74 5f69 643a 2073 7472  endpoint_id: str
-0001e2f0: 2c0a 2020 2020 2020 2020 6d6f 6465 6c5f  ,.        model_
-0001e300: 656e 6470 6f69 6e74 3a20 556e 696f 6e5b  endpoint: Union[
-0001e310: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
-0001e320: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
-0001e330: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
-0001e340: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
-0001e350: 2c20 6469 6374 0a20 2020 2020 2020 205d  , dict.        ]
-0001e360: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001e370: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
-0001e380: 6174 6573 2061 2044 4220 7265 636f 7264  ates a DB record
-0001e390: 2077 6974 6820 7468 6520 6769 7665 6e20   with the given 
-0001e3a0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2072  model_endpoint r
-0001e3b0: 6563 6f72 642e 0a0a 2020 2020 2020 2020  ecord...        
-0001e3c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-0001e3d0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-0001e3e0: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
-0001e3f0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
-0001e400: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
-0001e410: 6865 2065 6e64 706f 696e 742e 0a20 2020  he endpoint..   
-0001e420: 2020 2020 203a 7061 7261 6d20 6d6f 6465       :param mode
-0001e430: 6c5f 656e 6470 6f69 6e74 3a20 416e 206f  l_endpoint: An o
-0001e440: 626a 6563 7420 7265 7072 6573 656e 7469  bject representi
-0001e450: 6e67 2074 6865 206d 6f64 656c 2065 6e64  ng the model end
-0001e460: 706f 696e 742e 0a20 2020 2020 2020 2022  point..        "
-0001e470: 2222 0a0a 2020 2020 2020 2020 6966 2069  ""..        if i
-0001e480: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
-0001e490: 2020 2020 2020 206d 6f64 656c 5f65 6e64         model_end
-0001e4a0: 706f 696e 742c 206d 6c72 756e 2e6d 6f64  point, mlrun.mod
-0001e4b0: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
-0001e4c0: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
-0001e4d0: 656c 456e 6470 6f69 6e74 0a20 2020 2020  elEndpoint.     
-0001e4e0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0001e4f0: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
-0001e500: 203d 206d 6f64 656c 5f65 6e64 706f 696e   = model_endpoin
-0001e510: 742e 746f 5f64 6963 7428 290a 0a20 2020  t.to_dict()..   
-0001e520: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-0001e530: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-0001e540: 2f6d 6f64 656c 2d65 6e64 706f 696e 7473  /model-endpoints
-0001e550: 2f7b 656e 6470 6f69 6e74 5f69 647d 220a  /{endpoint_id}".
-0001e560: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-0001e570: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0001e580: 2020 206d 6574 686f 643d 2250 4f53 5422     method="POST"
-0001e590: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001e5a0: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
-0001e5b0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-0001e5c0: 6f5f 6a73 6f6e 286d 6f64 656c 5f65 6e64  o_json(model_end
-0001e5d0: 706f 696e 7429 2c0a 2020 2020 2020 2020  point),.        
-0001e5e0: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
-0001e5f0: 655f 6d6f 6465 6c5f 656e 6470 6f69 6e74  e_model_endpoint
-0001e600: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001e610: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-0001e620: 2073 7472 2c0a 2020 2020 2020 2020 656e   str,.        en
-0001e630: 6470 6f69 6e74 5f69 643a 2073 7472 2c0a  dpoint_id: str,.
-0001e640: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0001e650: 2222 0a20 2020 2020 2020 2044 656c 6574  "".        Delet
-0001e660: 6573 2074 6865 2044 4220 7265 636f 7264  es the DB record
-0001e670: 206f 6620 6120 6769 7665 6e20 6d6f 6465   of a given mode
-0001e680: 6c20 656e 6470 6f69 6e74 2c20 7072 6f6a  l endpoint, proj
-0001e690: 6563 7420 616e 6420 656e 6470 6f69 6e74  ect and endpoint
-0001e6a0: 5f69 6420 6172 6520 7573 6564 2066 6f72  _id are used for
-0001e6b0: 206c 6f6f 6b75 700a 0a20 2020 2020 2020   lookup..       
-0001e6c0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0001e6d0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-0001e6e0: 2070 726f 6a65 6374 0a20 2020 2020 2020   project.       
-0001e6f0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
-0001e700: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
-0001e710: 6865 2065 6e64 706f 696e 740a 2020 2020  he endpoint.    
-0001e720: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0001e730: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-0001e740: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
-0001e750: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
-0001e760: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
-0001e770: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-0001e780: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
-0001e790: 6574 686f 643d 2244 454c 4554 4522 2c0a  ethod="DELETE",.
-0001e7a0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-0001e7b0: 3d70 6174 682c 0a20 2020 2020 2020 2029  =path,.        )
-0001e7c0: 0a0a 2020 2020 6465 6620 6c69 7374 5f6d  ..    def list_m
-0001e7d0: 6f64 656c 5f65 6e64 706f 696e 7473 280a  odel_endpoints(.
-0001e7e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001e7f0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-0001e800: 7472 2c0a 2020 2020 2020 2020 6d6f 6465  tr,.        mode
-0001e810: 6c3a 204f 7074 696f 6e61 6c5b 7374 725d  l: Optional[str]
-0001e820: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001e830: 2066 756e 6374 696f 6e3a 204f 7074 696f   function: Optio
-0001e840: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0001e850: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
-0001e860: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
-0001e870: 652c 0a20 2020 2020 2020 2073 7461 7274  e,.        start
-0001e880: 3a20 7374 7220 3d20 226e 6f77 2d31 6822  : str = "now-1h"
-0001e890: 2c0a 2020 2020 2020 2020 656e 643a 2073  ,.        end: s
-0001e8a0: 7472 203d 2022 6e6f 7722 2c0a 2020 2020  tr = "now",.    
-0001e8b0: 2020 2020 6d65 7472 6963 733a 204f 7074      metrics: Opt
-0001e8c0: 696f 6e61 6c5b 6c69 7374 5b73 7472 5d5d  ional[list[str]]
-0001e8d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001e8e0: 2074 6f70 5f6c 6576 656c 3a20 626f 6f6c   top_level: bool
-0001e8f0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-0001e900: 2020 7569 6473 3a20 4f70 7469 6f6e 616c    uids: Optional
-0001e910: 5b6c 6973 745b 7374 725d 5d20 3d20 4e6f  [list[str]] = No
-0001e920: 6e65 2c0a 2020 2020 2920 2d3e 206c 6973  ne,.    ) -> lis
-0001e930: 745b 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f  t[mlrun.model_mo
-0001e940: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
-0001e950: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
-0001e960: 706f 696e 745d 3a0a 2020 2020 2020 2020  point]:.        
-0001e970: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-0001e980: 726e 7320 6120 6c69 7374 206f 6620 604d  rns a list of `M
-0001e990: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
-0001e9a0: 6a65 6374 732e 2045 6163 6820 604d 6f64  jects. Each `Mod
-0001e9b0: 656c 456e 6470 6f69 6e74 6020 6f62 6a65  elEndpoint` obje
-0001e9c0: 6374 2072 6570 7265 7365 6e74 7320 7468  ct represents th
-0001e9d0: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
-0001e9e0: 6f66 2061 0a20 2020 2020 2020 206d 6f64  of a.        mod
-0001e9f0: 656c 2065 6e64 706f 696e 742e 2054 6869  el endpoint. Thi
-0001ea00: 7320 6675 6e63 7469 6f6e 7320 7375 7070  s functions supp
-0001ea10: 6f72 7473 2066 696c 7465 7269 6e67 2062  orts filtering b
-0001ea20: 7920 7468 6520 666f 6c6c 6f77 696e 6720  y the following 
-0001ea30: 7061 7261 6d65 7465 7273 3a0a 2020 2020  parameters:.    
-0001ea40: 2020 2020 3129 206d 6f64 656c 0a20 2020      1) model.   
-0001ea50: 2020 2020 2032 2920 6675 6e63 7469 6f6e       2) function
-0001ea60: 0a20 2020 2020 2020 2033 2920 6c61 6265  .        3) labe
-0001ea70: 6c73 0a20 2020 2020 2020 2034 2920 746f  ls.        4) to
-0001ea80: 7020 6c65 7665 6c0a 2020 2020 2020 2020  p level.        
-0001ea90: 3529 2075 6964 730a 2020 2020 2020 2020  5) uids.        
-0001eaa0: 4279 2064 6566 6175 6c74 2c20 7768 656e  By default, when
-0001eab0: 206e 6f20 6669 6c74 6572 7320 6172 6520   no filters are 
-0001eac0: 6170 706c 6965 642c 2061 6c6c 2061 7661  applied, all ava
-0001ead0: 696c 6162 6c65 2065 6e64 706f 696e 7473  ilable endpoints
-0001eae0: 2066 6f72 2074 6865 2067 6976 656e 2070   for the given p
-0001eaf0: 726f 6a65 6374 2077 696c 6c20 6265 206c  roject will be l
-0001eb00: 6973 7465 642e 0a0a 2020 2020 2020 2020  isted...        
-0001eb10: 496e 2061 6464 6974 696f 6e2c 2074 6869  In addition, thi
-0001eb20: 7320 6675 6e63 7469 6f6e 7320 7072 6f76  s functions prov
-0001eb30: 6964 6573 2061 2066 6163 6164 6520 666f  ides a facade fo
-0001eb40: 7220 6c69 7374 696e 6720 656e 6470 6f69  r listing endpoi
-0001eb50: 6e74 2072 656c 6174 6564 206d 6574 7269  nt related metri
-0001eb60: 6373 2e20 5468 6973 2066 6163 6164 6520  cs. This facade 
-0001eb70: 6973 2074 696d 652d 6261 7365 640a 2020  is time-based.  
-0001eb80: 2020 2020 2020 616e 6420 6465 7065 6e64        and depend
-0001eb90: 7320 6f6e 2074 6865 2027 7374 6172 7427  s on the 'start'
-0001eba0: 2061 6e64 2027 656e 6427 2070 6172 616d   and 'end' param
-0001ebb0: 6574 6572 732e 2042 7920 6465 6661 756c  eters. By defaul
-0001ebc0: 742c 2077 6865 6e20 7468 6520 6d65 7472  t, when the metr
-0001ebd0: 6963 7320 7061 7261 6d65 7465 7220 6973  ics parameter is
-0001ebe0: 204e 6f6e 652c 206e 6f20 6d65 7472 6963   None, no metric
-0001ebf0: 7320 6172 650a 2020 2020 2020 2020 6164  s are.        ad
-0001ec00: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
-0001ec10: 7420 6f66 2074 6869 7320 6675 6e63 7469  t of this functi
-0001ec20: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
-0001ec30: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
-0001ec40: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
-0001ec50: 6a65 6374 0a20 2020 2020 2020 203a 7061  ject.        :pa
-0001ec60: 7261 6d20 6d6f 6465 6c3a 2054 6865 206e  ram model: The n
-0001ec70: 616d 6520 6f66 2074 6865 206d 6f64 656c  ame of the model
-0001ec80: 2074 6f20 6669 6c74 6572 2062 790a 2020   to filter by.  
-0001ec90: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
-0001eca0: 6374 696f 6e3a 2054 6865 206e 616d 6520  ction: The name 
-0001ecb0: 6f66 2074 6865 2066 756e 6374 696f 6e20  of the function 
-0001ecc0: 746f 2066 696c 7465 7220 6279 0a20 2020  to filter by.   
-0001ecd0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
-0001ece0: 6c73 3a20 4120 6c69 7374 206f 6620 6c61  ls: A list of la
-0001ecf0: 6265 6c73 2074 6f20 6669 6c74 6572 2062  bels to filter b
-0001ed00: 792e 204c 6162 656c 2066 696c 7465 7273  y. Label filters
-0001ed10: 2077 6f72 6b20 6279 2065 6974 6865 7220   work by either 
-0001ed20: 6669 6c74 6572 696e 6720 6120 7370 6563  filtering a spec
-0001ed30: 6966 6963 2076 616c 7565 206f 6620 610a  ific value of a.
-0001ed40: 2020 2020 2020 2020 206c 6162 656c 2028           label (
-0001ed50: 692e 652e 206c 6973 7428 226b 6579 3d76  i.e. list("key=v
-0001ed60: 616c 7565 2229 2920 6f72 2062 7920 6c6f  alue")) or by lo
-0001ed70: 6f6b 696e 6720 666f 7220 7468 6520 6578  oking for the ex
-0001ed80: 6973 7465 6e63 6520 6f66 2061 2067 6976  istence of a giv
-0001ed90: 656e 206b 6579 2028 692e 652e 2022 6b65  en key (i.e. "ke
-0001eda0: 7922 290a 2020 2020 2020 2020 3a70 6172  y").        :par
-0001edb0: 616d 206d 6574 7269 6373 3a20 4120 6c69  am metrics: A li
-0001edc0: 7374 206f 6620 6d65 7472 6963 7320 746f  st of metrics to
-0001edd0: 2072 6574 7572 6e20 666f 7220 6561 6368   return for each
-0001ede0: 2065 6e64 706f 696e 742c 2072 6561 6420   endpoint, read 
-0001edf0: 6d6f 7265 2069 6e20 2754 696d 654d 6574  more in 'TimeMet
-0001ee00: 7269 6327 0a20 2020 2020 2020 203a 7061  ric'.        :pa
-0001ee10: 7261 6d20 7374 6172 743a 2054 6865 2073  ram start: The s
-0001ee20: 7461 7274 2074 696d 6520 6f66 2074 6865  tart time of the
-0001ee30: 206d 6574 7269 6373 2e20 4361 6e20 6265   metrics. Can be
-0001ee40: 2072 6570 7265 7365 6e74 6564 2062 7920   represented by 
-0001ee50: 6120 7374 7269 6e67 2063 6f6e 7461 696e  a string contain
-0001ee60: 696e 6720 616e 2052 4643 2033 3333 390a  ing an RFC 3339.
-0001ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee90: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
-0001eea0: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
-0001eeb0: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
-0001eec0: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
-0001eed0: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
-0001eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eef0: 2020 2020 2020 6027 6e6f 772d 5b30 2d39        `'now-[0-9
-0001ef00: 5d2b 5b6d 6864 5d27 602c 2077 6865 7265  ]+[mhd]'`, where
-0001ef10: 2060 6d60 203d 206d 696e 7574 6573 2c20   `m` = minutes, 
-0001ef20: 6068 6020 3d20 686f 7572 732c 2061 6e64  `h` = hours, and
-0001ef30: 2060 2764 2760 203d 0a20 2020 2020 2020   `'d'` =.       
-0001ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef50: 2020 2020 2020 2020 2020 6461 7973 292c            days),
-0001ef60: 206f 7220 3020 666f 7220 7468 6520 6561   or 0 for the ea
-0001ef70: 726c 6965 7374 2074 696d 652e 0a20 2020  rliest time..   
-0001ef80: 2020 2020 203a 7061 7261 6d20 656e 643a       :param end:
-0001ef90: 2054 6865 2065 6e64 2074 696d 6520 6f66   The end time of
-0001efa0: 2074 6865 206d 6574 7269 6373 2e20 4361   the metrics. Ca
-0001efb0: 6e20 6265 2072 6570 7265 7365 6e74 6564  n be represented
-0001efc0: 2062 7920 6120 7374 7269 6e67 2063 6f6e   by a string con
-0001efd0: 7461 696e 696e 6720 616e 2052 4643 2033  taining an RFC 3
-0001efe0: 3333 390a 2020 2020 2020 2020 2020 2020  339.            
-0001eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f000: 2020 2020 2074 696d 652c 2061 2055 6e69       time, a Uni
-0001f010: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
-0001f020: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
-0001f030: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
-0001f040: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
-0001f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f060: 2020 2020 2020 2020 2020 6027 6e6f 772d            `'now-
-0001f070: 5b30 2d39 5d2b 5b6d 6864 5d27 602c 2077  [0-9]+[mhd]'`, w
-0001f080: 6865 7265 2060 6d60 203d 206d 696e 7574  here `m` = minut
-0001f090: 6573 2c20 6068 6020 3d20 686f 7572 732c  es, `h` = hours,
-0001f0a0: 2061 6e64 2060 2764 2760 203d 0a20 2020   and `'d'` =.   
-0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f0c0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001f0d0: 7973 292c 206f 7220 3020 666f 7220 7468  ys), or 0 for th
-0001f0e0: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
-0001f0f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f100: 746f 705f 6c65 7665 6c3a 2069 6620 7472  top_level: if tr
-0001f110: 7565 2077 696c 6c20 7265 7475 726e 206f  ue will return o
-0001f120: 6e6c 7920 726f 7574 6572 7320 616e 6420  nly routers and 
-0001f130: 656e 6470 6f69 6e74 2074 6861 7420 6172  endpoint that ar
-0001f140: 6520 4e4f 5420 6368 696c 6472 656e 206f  e NOT children o
-0001f150: 6620 616e 7920 726f 7574 6572 0a20 2020  f any router.   
-0001f160: 2020 2020 203a 7061 7261 6d20 7569 6473       :param uids
-0001f170: 3a20 6966 2070 6173 7365 6420 7769 6c6c  : if passed will
-0001f180: 2072 6574 7572 6e20 6120 6c69 7374 2060   return a list `
-0001f190: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
-0001f1a0: 626a 6563 7420 7769 7468 2075 6964 2069  bject with uid i
-0001f1b0: 6e20 7569 6473 0a20 2020 2020 2020 2022  n uids.        "
-0001f1c0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-0001f1d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001f1e0: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
-0001f1f0: 6470 6f69 6e74 7322 0a0a 2020 2020 2020  dpoints"..      
-0001f200: 2020 6966 206c 6162 656c 7320 616e 6420    if labels and 
-0001f210: 6973 696e 7374 616e 6365 286c 6162 656c  isinstance(label
-0001f220: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
-0001f230: 2020 2020 2020 6c61 6265 6c73 203d 205b        labels = [
-0001f240: 6622 7b6b 6579 7d3d 7b76 616c 7565 7d22  f"{key}={value}"
-0001f250: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
-0001f260: 696e 206c 6162 656c 732e 6974 656d 7328  in labels.items(
-0001f270: 295d 0a0a 2020 2020 2020 2020 7265 7370  )]..        resp
-0001f280: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0001f290: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0001f2a0: 2020 6d65 7468 6f64 3d22 4745 5422 2c0a    method="GET",.
-0001f2b0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-0001f2c0: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
-0001f2d0: 2020 2070 6172 616d 733d 7b0a 2020 2020     params={.    
-0001f2e0: 2020 2020 2020 2020 2020 2020 226d 6f64              "mod
-0001f2f0: 656c 223a 206d 6f64 656c 2c0a 2020 2020  el": model,.    
-0001f300: 2020 2020 2020 2020 2020 2020 2266 756e              "fun
-0001f310: 6374 696f 6e22 3a20 6675 6e63 7469 6f6e  ction": function
-0001f320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001f330: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
-0001f340: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
-0001f350: 2020 2020 2020 2020 2022 7374 6172 7422           "start"
-0001f360: 3a20 7374 6172 742c 0a20 2020 2020 2020  : start,.       
-0001f370: 2020 2020 2020 2020 2022 656e 6422 3a20           "end": 
-0001f380: 656e 642c 0a20 2020 2020 2020 2020 2020  end,.           
-0001f390: 2020 2020 2022 6d65 7472 6963 223a 206d       "metric": m
-0001f3a0: 6574 7269 6373 206f 7220 5b5d 2c0a 2020  etrics or [],.  
-0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0001f3c0: 6f70 2d6c 6576 656c 223a 2074 6f70 5f6c  op-level": top_l
-0001f3d0: 6576 656c 2c0a 2020 2020 2020 2020 2020  evel,.          
-0001f3e0: 2020 2020 2020 2275 6964 223a 2075 6964        "uid": uid
-0001f3f0: 732c 0a20 2020 2020 2020 2020 2020 207d  s,.            }
-0001f400: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001f410: 2020 2020 2023 2047 656e 6572 6174 6520       # Generate 
-0001f420: 6120 6c69 7374 206f 6620 6120 6d6f 6465  a list of a mode
-0001f430: 6c20 656e 6470 6f69 6e74 2064 6963 7469  l endpoint dicti
-0001f440: 6f6e 6172 6965 730a 2020 2020 2020 2020  onaries.        
-0001f450: 6d6f 6465 6c5f 656e 6470 6f69 6e74 7320  model_endpoints 
-0001f460: 3d20 7265 7370 6f6e 7365 2e6a 736f 6e28  = response.json(
-0001f470: 295b 2265 6e64 706f 696e 7473 225d 0a20  )["endpoints"]. 
-0001f480: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
-0001f490: 656e 6470 6f69 6e74 733a 0a20 2020 2020  endpoints:.     
-0001f4a0: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
-0001f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4c0: 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69  mlrun.model_moni
-0001f4d0: 746f 7269 6e67 2e6d 6f64 656c 5f65 6e64  toring.model_end
-0001f4e0: 706f 696e 742e 4d6f 6465 6c45 6e64 706f  point.ModelEndpo
-0001f4f0: 696e 742e 6672 6f6d 5f64 6963 7428 6f62  int.from_dict(ob
-0001f500: 6a29 0a20 2020 2020 2020 2020 2020 2020  j).             
-0001f510: 2020 2066 6f72 206f 626a 2069 6e20 6d6f     for obj in mo
-0001f520: 6465 6c5f 656e 6470 6f69 6e74 730a 2020  del_endpoints.  
-0001f530: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-0001f540: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
-0001f550: 2020 2064 6566 2067 6574 5f6d 6f64 656c     def get_model
-0001f560: 5f65 6e64 706f 696e 7428 0a20 2020 2020  _endpoint(.     
-0001f570: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001f580: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-0001f590: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
-0001f5a0: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
-0001f5b0: 2073 7461 7274 3a20 4f70 7469 6f6e 616c   start: Optional
-0001f5c0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0001f5d0: 2020 2020 2020 656e 643a 204f 7074 696f        end: Optio
-0001f5e0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0001f5f0: 0a20 2020 2020 2020 206d 6574 7269 6373  .        metrics
-0001f600: 3a20 4f70 7469 6f6e 616c 5b6c 6973 745b  : Optional[list[
-0001f610: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
-0001f620: 2020 2020 2020 6665 6174 7572 655f 616e        feature_an
-0001f630: 616c 7973 6973 3a20 626f 6f6c 203d 2046  alysis: bool = F
-0001f640: 616c 7365 2c0a 2020 2020 2920 2d3e 206d  alse,.    ) -> m
-0001f650: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
-0001f660: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
-0001f670: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
-0001f680: 6e74 3a0a 2020 2020 2020 2020 2222 220a  nt:.        """.
-0001f690: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
-0001f6a0: 6120 7369 6e67 6c65 2060 4d6f 6465 6c45  a single `ModelE
-0001f6b0: 6e64 706f 696e 7460 206f 626a 6563 7420  ndpoint` object 
-0001f6c0: 7769 7468 2061 6464 6974 696f 6e61 6c20  with additional 
-0001f6d0: 6d65 7472 6963 7320 616e 6420 6665 6174  metrics and feat
-0001f6e0: 7572 6520 7265 6c61 7465 6420 6461 7461  ure related data
-0001f6f0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001f700: 6d20 7072 6f6a 6563 743a 2020 2020 2020  m project:      
-0001f710: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001f720: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
-0001f730: 6f6a 6563 740a 2020 2020 2020 2020 3a70  oject.        :p
-0001f740: 6172 616d 2065 6e64 706f 696e 745f 6964  aram endpoint_id
-0001f750: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
-0001f760: 2054 6865 2075 6e69 7175 6520 6964 206f   The unique id o
-0001f770: 6620 7468 6520 6d6f 6465 6c20 656e 6470  f the model endp
-0001f780: 6f69 6e74 2e0a 2020 2020 2020 2020 3a70  oint..        :p
-0001f790: 6172 616d 2073 7461 7274 3a20 2020 2020  aram start:     
-0001f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7b0: 2054 6865 2073 7461 7274 2074 696d 6520   The start time 
-0001f7c0: 6f66 2074 6865 206d 6574 7269 6373 2e20  of the metrics. 
-0001f7d0: 4361 6e20 6265 2072 6570 7265 7365 6e74  Can be represent
-0001f7e0: 6564 2062 7920 6120 7374 7269 6e67 2063  ed by a string c
-0001f7f0: 6f6e 7461 696e 696e 6720 616e 0a20 2020  ontaining an.   
-0001f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f820: 2020 2020 2020 2020 5246 4320 3333 3339          RFC 3339
-0001f830: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
-0001f840: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
-0001f850: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
-0001f860: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
-0001f870: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
-0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8a0: 6027 6e6f 772d 5b30 2d39 5d2b 5b6d 6864  `'now-[0-9]+[mhd
-0001f8b0: 5d27 602c 2077 6865 7265 2060 6d60 203d  ]'`, where `m` =
-0001f8c0: 206d 696e 7574 6573 2c20 6068 6020 3d20   minutes, `h` = 
-0001f8d0: 686f 7572 732c 2061 6e64 2060 2764 2760  hours, and `'d'`
-0001f8e0: 203d 2064 6179 7329 2c20 6f72 0a20 2020   = days), or.   
-0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f910: 2020 2020 2020 2020 3020 666f 7220 7468          0 for th
-0001f920: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
-0001f930: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f940: 656e 643a 2020 2020 2020 2020 2020 2020  end:            
-0001f950: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0001f960: 656e 6420 7469 6d65 206f 6620 7468 6520  end time of the 
-0001f970: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
-0001f980: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
-0001f990: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-0001f9a0: 6e67 2061 6e0a 2020 2020 2020 2020 2020  ng an.          
-0001f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9d0: 2052 4643 2033 3333 3920 7469 6d65 2c20   RFC 3339 time, 
-0001f9e0: 6120 556e 6978 2074 696d 6573 7461 6d70  a Unix timestamp
-0001f9f0: 2069 6e20 6d69 6c6c 6973 6563 6f6e 6473   in milliseconds
-0001fa00: 2c20 6120 7265 6c61 7469 7665 2074 696d  , a relative tim
-0001fa10: 6520 2860 276e 6f77 2760 206f 720a 2020  e (`'now'` or.  
-0001fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa40: 2020 2020 2020 2020 2060 276e 6f77 2d5b           `'now-[
-0001fa50: 302d 395d 2b5b 6d68 645d 2760 2c20 7768  0-9]+[mhd]'`, wh
-0001fa60: 6572 6520 606d 6020 3d20 6d69 6e75 7465  ere `m` = minute
-0001fa70: 732c 2060 6860 203d 2068 6f75 7273 2c20  s, `h` = hours, 
-0001fa80: 616e 6420 6027 6427 6020 3d20 6461 7973  and `'d'` = days
-0001fa90: 292c 206f 720a 2020 2020 2020 2020 2020  ), or.          
-0001faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fac0: 2030 2066 6f72 2074 6865 2065 6172 6c69   0 for the earli
-0001fad0: 6573 7420 7469 6d65 2e0a 2020 2020 2020  est time..      
-0001fae0: 2020 3a70 6172 616d 206d 6574 7269 6373    :param metrics
-0001faf0: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
-0001fb00: 2020 2020 2041 206c 6973 7420 6f66 206d       A list of m
-0001fb10: 6574 7269 6373 2074 6f20 7265 7475 726e  etrics to return
-0001fb20: 2066 6f72 2074 6865 206d 6f64 656c 2065   for the model e
-0001fb30: 6e64 706f 696e 742e 2054 6865 7265 2061  ndpoint. There a
-0001fb40: 7265 2070 7265 2d64 6566 696e 6564 0a20  re pre-defined. 
-0001fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf10: 2066 2250 726f 6a65 6374 206e 6f74 2069   f"Project not i
+0001bf20: 6e20 7465 726d 696e 616c 2073 7461 7465  n terminal state
+0001bf30: 2e20 5374 6174 653a 207b 7072 6f6a 6563  . State: {projec
+0001bf40: 742e 7374 6174 7573 2e73 7461 7465 7d22  t.status.state}"
+0001bf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bf60: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0001bf70: 6574 7572 6e20 7072 6f6a 6563 740a 0a20  eturn project.. 
+0001bf80: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
+0001bf90: 7275 6e2e 7574 696c 732e 6865 6c70 6572  run.utils.helper
+0001bfa0: 732e 7265 7472 795f 756e 7469 6c5f 7375  s.retry_until_su
+0001bfb0: 6363 6573 7366 756c 280a 2020 2020 2020  ccessful(.      
+0001bfc0: 2020 2020 2020 7365 6c66 2e5f 7761 6974        self._wait
+0001bfd0: 5f66 6f72 5f70 726f 6a65 6374 5f74 6572  _for_project_ter
+0001bfe0: 6d69 6e61 6c5f 7374 6174 655f 7265 7472  minal_state_retr
+0001bff0: 795f 696e 7465 7276 616c 2c0a 2020 2020  y_interval,.    
+0001c000: 2020 2020 2020 2020 3138 302c 0a20 2020          180,.   
+0001c010: 2020 2020 2020 2020 206c 6f67 6765 722c           logger,
+0001c020: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
+0001c030: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+0001c040: 5f76 6572 6966 795f 7072 6f6a 6563 745f  _verify_project_
+0001c050: 696e 5f74 6572 6d69 6e61 6c5f 7374 6174  in_terminal_stat
+0001c060: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+0001c070: 2020 6465 6620 5f77 6169 745f 666f 725f    def _wait_for_
+0001c080: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
+0001c090: 746f 5f72 6561 6368 5f74 6572 6d69 6e61  to_reach_termina
+0001c0a0: 6c5f 7374 6174 6528 0a20 2020 2020 2020  l_state(.       
+0001c0b0: 2073 656c 662c 206e 616d 653a 2073 7472   self, name: str
+0001c0c0: 2c20 7072 6f6a 6563 743a 2073 7472 203d  , project: str =
+0001c0d0: 2022 220a 2020 2020 2920 2d3e 206d 6c72   "".    ) -> mlr
+0001c0e0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001c0f0: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0001c100: 3a0a 2020 2020 2020 2020 6465 6620 5f76  :.        def _v
+0001c110: 6572 6966 795f 6261 636b 6772 6f75 6e64  erify_background
+0001c120: 5f74 6173 6b5f 696e 5f74 6572 6d69 6e61  _task_in_termina
+0001c130: 6c5f 7374 6174 6528 293a 0a20 2020 2020  l_state():.     
+0001c140: 2020 2020 2020 2069 6620 7072 6f6a 6563         if projec
+0001c150: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001c160: 2020 2062 6163 6b67 726f 756e 645f 7461     background_ta
+0001c170: 736b 203d 2073 656c 662e 6765 745f 7072  sk = self.get_pr
+0001c180: 6f6a 6563 745f 6261 636b 6772 6f75 6e64  oject_background
+0001c190: 5f74 6173 6b28 7072 6f6a 6563 742c 206e  _task(project, n
+0001c1a0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+0001c1b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001c1c0: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
+0001c1d0: 645f 7461 736b 203d 2073 656c 662e 6765  d_task = self.ge
+0001c1e0: 745f 6261 636b 6772 6f75 6e64 5f74 6173  t_background_tas
+0001c1f0: 6b28 6e61 6d65 290a 2020 2020 2020 2020  k(name).        
+0001c200: 2020 2020 7374 6174 6520 3d20 6261 636b      state = back
+0001c210: 6772 6f75 6e64 5f74 6173 6b2e 7374 6174  ground_task.stat
+0001c220: 7573 2e73 7461 7465 0a20 2020 2020 2020  us.state.       
+0001c230: 2020 2020 2069 6620 7374 6174 6520 6e6f       if state no
+0001c240: 7420 696e 206d 6c72 756e 2e63 6f6d 6d6f  t in mlrun.commo
+0001c250: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+0001c260: 6f75 6e64 5461 736b 5374 6174 652e 7465  oundTaskState.te
+0001c270: 726d 696e 616c 5f73 7461 7465 7328 293a  rminal_states():
+0001c280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c290: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
+0001c2a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001c2b0: 2020 2020 2020 6622 4261 636b 6772 6f75        f"Backgrou
+0001c2c0: 6e64 2074 6173 6b20 6e6f 7420 696e 2074  nd task not in t
+0001c2d0: 6572 6d69 6e61 6c20 7374 6174 652e 206e  erminal state. n
+0001c2e0: 616d 653d 7b6e 616d 657d 2c20 7374 6174  ame={name}, stat
+0001c2f0: 653d 7b73 7461 7465 7d22 0a20 2020 2020  e={state}".     
+0001c300: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001c310: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001c320: 6261 636b 6772 6f75 6e64 5f74 6173 6b0a  background_task.
+0001c330: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001c340: 6d6c 7275 6e2e 7574 696c 732e 6865 6c70  mlrun.utils.help
+0001c350: 6572 732e 7265 7472 795f 756e 7469 6c5f  ers.retry_until_
+0001c360: 7375 6363 6573 7366 756c 280a 2020 2020  successful(.    
+0001c370: 2020 2020 2020 2020 7365 6c66 2e5f 7761          self._wa
+0001c380: 6974 5f66 6f72 5f62 6163 6b67 726f 756e  it_for_backgroun
+0001c390: 645f 7461 736b 5f74 6572 6d69 6e61 6c5f  d_task_terminal_
+0001c3a0: 7374 6174 655f 7265 7472 795f 696e 7465  state_retry_inte
+0001c3b0: 7276 616c 2c0a 2020 2020 2020 2020 2020  rval,.          
+0001c3c0: 2020 3630 202a 2036 302c 0a20 2020 2020    60 * 60,.     
+0001c3d0: 2020 2020 2020 206c 6f67 6765 722c 0a20         logger,. 
+0001c3e0: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0001c3f0: 2c0a 2020 2020 2020 2020 2020 2020 5f76  ,.            _v
+0001c400: 6572 6966 795f 6261 636b 6772 6f75 6e64  erify_background
+0001c410: 5f74 6173 6b5f 696e 5f74 6572 6d69 6e61  _task_in_termina
+0001c420: 6c5f 7374 6174 652c 0a20 2020 2020 2020  l_state,.       
+0001c430: 2029 0a0a 2020 2020 6465 6620 6372 6561   )..    def crea
+0001c440: 7465 5f70 726f 6a65 6374 5f73 6563 7265  te_project_secre
+0001c450: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
+0001c460: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+0001c470: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+0001c480: 7072 6f76 6964 6572 3a20 556e 696f 6e5b  provider: Union[
+0001c490: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0001c4a0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+0001c4b0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
+0001c4c0: 7669 6465 724e 616d 650a 2020 2020 2020  viderName.      
+0001c4d0: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+0001c4e0: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+0001c4f0: 7450 726f 7669 6465 724e 616d 652e 6b75  tProviderName.ku
+0001c500: 6265 726e 6574 6573 2c0a 2020 2020 2020  bernetes,.      
+0001c510: 2020 7365 6372 6574 733a 2064 6963 7420    secrets: dict 
+0001c520: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0001c530: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
+0001c540: 2070 726f 6a65 6374 2d63 6f6e 7465 7874   project-context
+0001c550: 2073 6563 7265 7473 2075 7369 6e67 2065   secrets using e
+0001c560: 6974 6865 7220 6060 7661 756c 7460 6020  ither ``vault`` 
+0001c570: 6f72 2060 606b 7562 6572 6e65 7465 7360  or ``kubernetes`
+0001c580: 6020 7072 6f76 6964 6572 2e0a 2020 2020  ` provider..    
+0001c590: 2020 2020 5768 656e 2075 7369 6e67 2077      When using w
+0001c5a0: 6974 6820 5661 756c 742c 2074 6869 7320  ith Vault, this 
+0001c5b0: 7769 6c6c 2063 7265 6174 6520 6e65 6564  will create need
+0001c5c0: 6564 2056 6175 6c74 2073 7472 7563 7475  ed Vault structu
+0001c5d0: 7265 7320 666f 7220 7374 6f72 696e 6720  res for storing 
+0001c5e0: 7365 6372 6574 7320 696e 2070 726f 6a65  secrets in proje
+0001c5f0: 6374 2d63 6f6e 7465 7874 2c20 616e 640a  ct-context, and.
+0001c600: 2020 2020 2020 2020 7374 6f72 6520 6120          store a 
+0001c610: 7365 7420 6f66 2073 6563 7265 7420 7661  set of secret va
+0001c620: 6c75 6573 2e20 5468 6520 6d65 7468 6f64  lues. The method
+0001c630: 2067 656e 6572 6174 6573 204b 7562 6572   generates Kuber
+0001c640: 6e65 7465 7320 7365 7276 6963 652d 6163  netes service-ac
+0001c650: 636f 756e 7420 616e 6420 7468 6520 5661  count and the Va
+0001c660: 756c 7420 6175 7468 656e 7469 6361 7469  ult authenticati
+0001c670: 6f6e 0a20 2020 2020 2020 2073 7472 7563  on.        struc
+0001c680: 7475 7265 7320 7468 6174 2061 7265 2072  tures that are r
+0001c690: 6571 7569 7265 6420 666f 7220 6675 6e63  equired for func
+0001c6a0: 7469 6f6e 2050 6f64 7320 746f 2061 7574  tion Pods to aut
+0001c6b0: 6865 6e74 6963 6174 6520 7769 7468 2056  henticate with V
+0001c6c0: 6175 6c74 2061 6e64 2062 6520 6162 6c65  ault and be able
+0001c6d0: 2074 6f20 6578 7472 6163 7420 7365 6372   to extract secr
+0001c6e0: 6574 2076 616c 7565 730a 2020 2020 2020  et values.      
+0001c6f0: 2020 7061 7373 6564 2061 7320 7061 7274    passed as part
+0001c700: 206f 6620 7468 6569 7220 636f 6e74 6578   of their contex
+0001c710: 742e 0a0a 2020 2020 2020 2020 4e6f 7465  t...        Note
+0001c720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001c730: 2020 5468 6973 206d 6574 686f 6420 7573    This method us
+0001c740: 6564 2077 6974 6820 5661 756c 7420 6973  ed with Vault is
+0001c750: 2063 7572 7265 6e74 6c79 2069 6e20 7465   currently in te
+0001c760: 6368 6e69 6361 6c20 7072 6576 6965 772c  chnical preview,
+0001c770: 2061 6e64 2072 6571 7569 7265 7320 6120   and requires a 
+0001c780: 4861 7368 6943 6f72 7020 5661 756c 740a  HashiCorp Vault.
+0001c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c7a0: 696e 6672 6173 7472 7563 7475 7265 2070  infrastructure p
+0001c7b0: 726f 7065 726c 7920 7365 7420 7570 2061  roperly set up a
+0001c7c0: 6e64 2063 6f6e 6e65 6374 6564 2074 6f20  nd connected to 
+0001c7d0: 7468 6520 4d4c 5275 6e20 4150 4920 7365  the MLRun API se
+0001c7e0: 7276 6572 2e0a 0a20 2020 2020 2020 2057  rver...        W
+0001c7f0: 6865 6e20 7573 6564 2077 6974 6820 4b75  hen used with Ku
+0001c800: 6265 726e 6574 6573 2c20 7468 6973 2077  bernetes, this w
+0001c810: 696c 6c20 6d61 6b65 2073 7572 6520 7468  ill make sure th
+0001c820: 6174 2074 6865 2070 726f 6a65 6374 2d73  at the project-s
+0001c830: 7065 6369 6669 6320 6b38 7320 7365 6372  pecific k8s secr
+0001c840: 6574 2069 7320 6372 6561 7465 642c 2061  et is created, a
+0001c850: 6e64 2077 696c 6c0a 2020 2020 2020 2020  nd will.        
+0001c860: 706f 7075 6c61 7465 2069 7420 7769 7468  populate it with
+0001c870: 2074 6865 2073 6563 7265 7473 2070 726f   the secrets pro
+0001c880: 7669 6465 642c 2072 6570 6c61 6369 6e67  vided, replacing
+0001c890: 2074 6865 6972 2076 616c 7565 7320 6966   their values if
+0001c8a0: 2074 6865 7920 6578 6973 742e 0a0a 2020   they exist...  
+0001c8b0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+0001c8c0: 6a65 6374 3a20 5468 6520 7072 6f6a 6563  ject: The projec
+0001c8d0: 7420 636f 6e74 6578 7420 666f 7220 7768  t context for wh
+0001c8e0: 6963 6820 746f 2067 656e 6572 6174 6520  ich to generate 
+0001c8f0: 7468 6520 696e 6672 6120 616e 6420 7374  the infra and st
+0001c900: 6f72 6520 7365 6372 6574 732e 0a20 2020  ore secrets..   
+0001c910: 2020 2020 203a 7061 7261 6d20 7072 6f76       :param prov
+0001c920: 6964 6572 3a20 5468 6520 6e61 6d65 206f  ider: The name o
+0001c930: 6620 7468 6520 7365 6372 6574 732d 7072  f the secrets-pr
+0001c940: 6f76 6964 6572 2074 6f20 776f 726b 2077  ovider to work w
+0001c950: 6974 682e 2041 6363 6570 7473 2061 0a20  ith. Accepts a. 
+0001c960: 2020 2020 2020 2020 2020 203a 7079 3a63             :py:c
+0001c970: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
+0001c980: 6d6f 6e2e 7363 6865 6d61 732e 7365 6372  mon.schemas.secr
+0001c990: 6574 2e53 6563 7265 7450 726f 7669 6465  et.SecretProvide
+0001c9a0: 724e 616d 6560 2065 6e75 6d2e 0a20 2020  rName` enum..   
+0001c9b0: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
+0001c9c0: 6574 733a 2041 2073 6574 206f 6620 7365  ets: A set of se
+0001c9d0: 6372 6574 2076 616c 7565 7320 746f 2073  cret values to s
+0001c9e0: 746f 7265 2e0a 2020 2020 2020 2020 2020  tore..          
+0001c9f0: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
+0001ca00: 2020 2020 2020 2020 2020 2020 2073 6563               sec
+0001ca10: 7265 7473 203d 207b 2770 6173 7377 6f72  rets = {'passwor
+0001ca20: 6427 3a20 276d 7950 6173 7377 3072 6427  d': 'myPassw0rd'
+0001ca30: 2c20 2761 7773 5f6b 6579 273a 2027 3131  , 'aws_key': '11
+0001ca40: 3132 3232 3333 3327 7d0a 2020 2020 2020  1222333'}.      
+0001ca50: 2020 2020 2020 2020 2020 6462 2e63 7265            db.cre
+0001ca60: 6174 655f 7072 6f6a 6563 745f 7365 6372  ate_project_secr
+0001ca70: 6574 7328 0a20 2020 2020 2020 2020 2020  ets(.           
+0001ca80: 2020 2020 2020 2020 2022 7072 6f6a 6563           "projec
+0001ca90: 7431 222c 0a20 2020 2020 2020 2020 2020  t1",.           
+0001caa0: 2020 2020 2020 2020 2070 726f 7669 6465           provide
+0001cab0: 723d 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  r=mlrun.common.s
+0001cac0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
+0001cad0: 7669 6465 724e 616d 652e 6b75 6265 726e  viderName.kubern
+0001cae0: 6574 6573 2c0a 2020 2020 2020 2020 2020  etes,.          
+0001caf0: 2020 2020 2020 2020 2020 7365 6372 6574            secret
+0001cb00: 733d 7365 6372 6574 730a 2020 2020 2020  s=secrets.      
+0001cb10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001cb20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001cb30: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0001cb40: 732f 7b70 726f 6a65 6374 7d2f 7365 6372  s/{project}/secr
+0001cb50: 6574 7322 0a20 2020 2020 2020 2073 6563  ets".        sec
+0001cb60: 7265 7473 5f69 6e70 7574 203d 206d 6c72  rets_input = mlr
+0001cb70: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001cb80: 732e 5365 6372 6574 7344 6174 6128 0a20  s.SecretsData(. 
+0001cb90: 2020 2020 2020 2020 2020 2073 6563 7265             secre
+0001cba0: 7473 3d73 6563 7265 7473 2c20 7072 6f76  ts=secrets, prov
+0001cbb0: 6964 6572 3d70 726f 7669 6465 720a 2020  ider=provider.  
+0001cbc0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001cbd0: 626f 6479 203d 2073 6563 7265 7473 5f69  body = secrets_i
+0001cbe0: 6e70 7574 2e64 6963 7428 290a 2020 2020  nput.dict().    
+0001cbf0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001cc00: 6520 3d20 6622 4661 696c 6564 2063 7265  e = f"Failed cre
+0001cc10: 6174 696e 6720 7365 6372 6574 2070 726f  ating secret pro
+0001cc20: 7669 6465 7220 7b70 726f 6a65 6374 7d2f  vider {project}/
+0001cc30: 7b70 726f 7669 6465 727d 220a 2020 2020  {provider}".    
+0001cc40: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001cc50: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+0001cc60: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
+0001cc70: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
+0001cc80: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+0001cc90: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+0001cca0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+0001ccb0: 6e28 626f 6479 292c 0a20 2020 2020 2020  n(body),.       
+0001ccc0: 2029 0a0a 2020 2020 6465 6620 6c69 7374   )..    def list
+0001ccd0: 5f70 726f 6a65 6374 5f73 6563 7265 7473  _project_secrets
+0001cce0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001ccf0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0001cd00: 2073 7472 2c0a 2020 2020 2020 2020 746f   str,.        to
+0001cd10: 6b65 6e3a 2073 7472 203d 204e 6f6e 652c  ken: str = None,
+0001cd20: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+0001cd30: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
+0001cd40: 2020 2020 2020 7374 722c 206d 6c72 756e        str, mlrun
+0001cd50: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001cd60: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+0001cd70: 6d65 0a20 2020 2020 2020 205d 203d 206d  me.        ] = m
+0001cd80: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001cd90: 6d61 732e 5365 6372 6574 5072 6f76 6964  mas.SecretProvid
+0001cda0: 6572 4e61 6d65 2e6b 7562 6572 6e65 7465  erName.kubernete
+0001cdb0: 732c 0a20 2020 2020 2020 2073 6563 7265  s,.        secre
+0001cdc0: 7473 3a20 6c69 7374 5b73 7472 5d20 3d20  ts: list[str] = 
+0001cdd0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 206d  None,.    ) -> m
+0001cde0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001cdf0: 6d61 732e 5365 6372 6574 7344 6174 613a  mas.SecretsData:
+0001ce00: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+0001ce10: 6965 7665 2070 726f 6a65 6374 2d63 6f6e  ieve project-con
+0001ce20: 7465 7874 2073 6563 7265 7473 2066 726f  text secrets fro
+0001ce30: 6d20 5661 756c 742e 0a0a 2020 2020 2020  m Vault...      
+0001ce40: 2020 4e6f 7465 3a0a 2020 2020 2020 2020    Note:.        
+0001ce50: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001ce60: 686f 6420 666f 7220 5661 756c 7420 6675  hod for Vault fu
+0001ce70: 6e63 7469 6f6e 616c 6974 7920 6973 2063  nctionality is c
+0001ce80: 7572 7265 6e74 6c79 2069 6e20 7465 6368  urrently in tech
+0001ce90: 6e69 6361 6c20 7072 6576 6965 772c 2061  nical preview, a
+0001cea0: 6e64 2072 6571 7569 7265 7320 6120 4861  nd requires a Ha
+0001ceb0: 7368 6943 6f72 7020 5661 756c 740a 2020  shiCorp Vault.  
+0001cec0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0001ced0: 6672 6173 7472 7563 7475 7265 2070 726f  frastructure pro
+0001cee0: 7065 726c 7920 7365 7420 7570 2061 6e64  perly set up and
+0001cef0: 2063 6f6e 6e65 6374 6564 2074 6f20 7468   connected to th
+0001cf00: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
+0001cf10: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
+0001cf20: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+0001cf30: 2070 726f 6a65 6374 206e 616d 652e 0a20   project name.. 
+0001cf40: 2020 2020 2020 203a 7061 7261 6d20 746f         :param to
+0001cf50: 6b65 6e3a 2056 6175 6c74 2074 6f6b 656e  ken: Vault token
+0001cf60: 2074 6f20 7573 6520 666f 7220 7265 7472   to use for retr
+0001cf70: 6965 7669 6e67 2073 6563 7265 7473 2e0a  ieving secrets..
+0001cf80: 2020 2020 2020 2020 2020 2020 4d75 7374              Must
+0001cf90: 2062 6520 6120 7661 6c69 6420 5661 756c   be a valid Vaul
+0001cfa0: 7420 746f 6b65 6e2c 2077 6974 6820 7065  t token, with pe
+0001cfb0: 726d 6973 7369 6f6e 7320 746f 2072 6574  rmissions to ret
+0001cfc0: 7269 6576 6520 7365 6372 6574 7320 6f66  rieve secrets of
+0001cfd0: 2074 6865 2070 726f 6a65 6374 2069 6e20   the project in 
+0001cfe0: 7175 6573 7469 6f6e 2e0a 2020 2020 2020  question..      
+0001cff0: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
+0001d000: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
+0001d010: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
+0001d020: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
+0001d030: 2e20 4375 7272 656e 746c 7920 6f6e 6c79  . Currently only
+0001d040: 2060 6076 6175 6c74 6060 2069 7320 6163   ``vault`` is ac
+0001d050: 6365 7074 6564 2e0a 2020 2020 2020 2020  cepted..        
+0001d060: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
+0001d070: 4120 6c69 7374 206f 6620 7365 6372 6574  A list of secret
+0001d080: 206e 616d 6573 2074 6f20 7265 7472 6965   names to retrie
+0001d090: 7665 2e20 416e 2065 6d70 7479 206c 6973  ve. An empty lis
+0001d0a0: 7420 6060 5b5d 6060 2077 696c 6c20 7265  t ``[]`` will re
+0001d0b0: 7472 6965 7665 2061 6c6c 2073 6563 7265  trieve all secre
+0001d0c0: 7473 2061 7373 6967 6e65 640a 2020 2020  ts assigned.    
+0001d0d0: 2020 2020 2020 2020 746f 2074 6869 7320          to this 
+0001d0e0: 7370 6563 6966 6963 2070 726f 6a65 6374  specific project
+0001d0f0: 2e20 6060 6b75 6265 726e 6574 6573 6060  . ``kubernetes``
+0001d100: 2070 726f 7669 6465 7220 6f6e 6c79 2073   provider only s
+0001d110: 7570 706f 7274 7320 616e 2065 6d70 7479  upports an empty
+0001d120: 206c 6973 742e 0a20 2020 2020 2020 2022   list..        "
+0001d130: 2222 0a0a 2020 2020 2020 2020 6966 2028  ""..        if (
+0001d140: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0001d150: 7669 6465 7220 3d3d 206d 6c72 756e 2e63  vider == mlrun.c
+0001d160: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+0001d170: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+0001d180: 2e76 6175 6c74 2e76 616c 7565 0a20 2020  .vault.value.   
+0001d190: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
+0001d1a0: 2074 6f6b 656e 0a20 2020 2020 2020 2029   token.        )
+0001d1b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001d1c0: 6973 6520 4d4c 5275 6e49 6e76 616c 6964  ise MLRunInvalid
+0001d1d0: 4172 6775 6d65 6e74 4572 726f 7228 0a20  ArgumentError(. 
+0001d1e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d1f0: 4120 7661 756c 7420 746f 6b65 6e20 6d75  A vault token mu
+0001d200: 7374 2062 6520 7072 6f76 6964 6564 2077  st be provided w
+0001d210: 6865 6e20 6163 6365 7373 696e 6720 7661  hen accessing va
+0001d220: 756c 7420 7365 6372 6574 7322 0a20 2020  ult secrets".   
+0001d230: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001d240: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001d250: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001d260: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+0001d270: 2070 6172 616d 7320 3d20 7b22 7072 6f76   params = {"prov
+0001d280: 6964 6572 223a 2070 726f 7669 6465 722c  ider": provider,
+0001d290: 2022 7365 6372 6574 223a 2073 6563 7265   "secret": secre
+0001d2a0: 7473 7d0a 2020 2020 2020 2020 6865 6164  ts}.        head
+0001d2b0: 6572 7320 3d20 7b6d 6c72 756e 2e63 6f6d  ers = {mlrun.com
+0001d2c0: 6d6f 6e2e 7363 6865 6d61 732e 4865 6164  mon.schemas.Head
+0001d2d0: 6572 4e61 6d65 732e 7365 6372 6574 5f73  erNames.secret_s
+0001d2e0: 746f 7265 5f74 6f6b 656e 3a20 746f 6b65  tore_token: toke
+0001d2f0: 6e7d 0a20 2020 2020 2020 2065 7272 6f72  n}.        error
+0001d300: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+0001d310: 6c65 6420 7265 7472 6965 7669 6e67 2073  led retrieving s
+0001d320: 6563 7265 7473 207b 7072 6f6a 6563 747d  ecrets {project}
+0001d330: 2f7b 7072 6f76 6964 6572 7d22 0a20 2020  /{provider}".   
+0001d340: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
+0001d350: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0001d360: 2020 2020 2020 2020 2022 4745 5422 2c0a           "GET",.
+0001d370: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001d380: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
+0001d390: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+0001d3a0: 2020 2020 2020 2020 2070 6172 616d 733d           params=
+0001d3b0: 7061 7261 6d73 2c0a 2020 2020 2020 2020  params,.        
+0001d3c0: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
+0001d3d0: 6572 732c 0a20 2020 2020 2020 2029 0a20  ers,.        ). 
+0001d3e0: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
+0001d3f0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001d400: 6173 2e53 6563 7265 7473 4461 7461 282a  as.SecretsData(*
+0001d410: 2a72 6573 756c 742e 6a73 6f6e 2829 290a  *result.json()).
+0001d420: 0a20 2020 2064 6566 206c 6973 745f 7072  .    def list_pr
+0001d430: 6f6a 6563 745f 7365 6372 6574 5f6b 6579  oject_secret_key
+0001d440: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0001d450: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0001d460: 3a20 7374 722c 0a20 2020 2020 2020 2070  : str,.        p
+0001d470: 726f 7669 6465 723a 2055 6e69 6f6e 5b0a  rovider: Union[.
+0001d480: 2020 2020 2020 2020 2020 2020 7374 722c              str,
+0001d490: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001d4a0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+0001d4b0: 6964 6572 4e61 6d65 0a20 2020 2020 2020  iderName.       
+0001d4c0: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
+0001d4d0: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+0001d4e0: 5072 6f76 6964 6572 4e61 6d65 2e6b 7562  ProviderName.kub
+0001d4f0: 6572 6e65 7465 732c 0a20 2020 2020 2020  ernetes,.       
+0001d500: 2074 6f6b 656e 3a20 7374 7220 3d20 4e6f   token: str = No
+0001d510: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
+0001d520: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001d530: 732e 5365 6372 6574 4b65 7973 4461 7461  s.SecretKeysData
+0001d540: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0001d550: 7269 6576 6520 7072 6f6a 6563 742d 636f  rieve project-co
+0001d560: 6e74 6578 7420 7365 6372 6574 206b 6579  ntext secret key
+0001d570: 7320 6672 6f6d 2056 6175 6c74 206f 7220  s from Vault or 
+0001d580: 4b75 6265 726e 6574 6573 2e0a 0a20 2020  Kubernetes...   
+0001d590: 2020 2020 204e 6f74 653a 0a20 2020 2020       Note:.     
+0001d5a0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+0001d5b0: 6d65 7468 6f64 2066 6f72 2056 6175 6c74  method for Vault
+0001d5c0: 2066 756e 6374 696f 6e61 6c69 7479 2069   functionality i
+0001d5d0: 7320 6375 7272 656e 746c 7920 696e 2074  s currently in t
+0001d5e0: 6563 686e 6963 616c 2070 7265 7669 6577  echnical preview
+0001d5f0: 2c20 616e 6420 7265 7175 6972 6573 2061  , and requires a
+0001d600: 2048 6173 6869 436f 7270 2056 6175 6c74   HashiCorp Vault
+0001d610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d620: 2069 6e66 7261 7374 7275 6374 7572 6520   infrastructure 
+0001d630: 7072 6f70 6572 6c79 2073 6574 2075 7020  properly set up 
+0001d640: 616e 6420 636f 6e6e 6563 7465 6420 746f  and connected to
+0001d650: 2074 6865 204d 4c52 756e 2041 5049 2073   the MLRun API s
+0001d660: 6572 7665 722e 0a0a 2020 2020 2020 2020  erver...        
+0001d670: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+0001d680: 5468 6520 7072 6f6a 6563 7420 6e61 6d65  The project name
+0001d690: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001d6a0: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+0001d6b0: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+0001d6c0: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+0001d6d0: 6f72 6b20 7769 7468 2e20 4163 6365 7074  ork with. Accept
+0001d6e0: 7320 610a 2020 2020 2020 2020 2020 2020  s a.            
+0001d6f0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+0001d700: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001d710: 2e73 6563 7265 742e 5365 6372 6574 5072  .secret.SecretPr
+0001d720: 6f76 6964 6572 4e61 6d65 6020 656e 756d  oviderName` enum
+0001d730: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001d740: 2074 6f6b 656e 3a20 5661 756c 7420 746f   token: Vault to
+0001d750: 6b65 6e20 746f 2075 7365 2066 6f72 2072  ken to use for r
+0001d760: 6574 7269 6576 696e 6720 7365 6372 6574  etrieving secret
+0001d770: 732e 204f 6e6c 7920 696e 2075 7365 2069  s. Only in use i
+0001d780: 6620 6060 7072 6f76 6964 6572 6060 2069  f ``provider`` i
+0001d790: 7320 6060 7661 756c 7460 602e 0a20 2020  s ``vault``..   
+0001d7a0: 2020 2020 2020 2020 204d 7573 7420 6265           Must be
+0001d7b0: 2061 2076 616c 6964 2056 6175 6c74 2074   a valid Vault t
+0001d7c0: 6f6b 656e 2c20 7769 7468 2070 6572 6d69  oken, with permi
+0001d7d0: 7373 696f 6e73 2074 6f20 7265 7472 6965  ssions to retrie
+0001d7e0: 7665 2073 6563 7265 7473 206f 6620 7468  ve secrets of th
+0001d7f0: 6520 7072 6f6a 6563 7420 696e 2071 7565  e project in que
+0001d800: 7374 696f 6e2e 0a20 2020 2020 2020 2022  stion..        "
+0001d810: 2222 0a0a 2020 2020 2020 2020 6966 2028  ""..        if (
+0001d820: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0001d830: 7669 6465 7220 3d3d 206d 6c72 756e 2e63  vider == mlrun.c
+0001d840: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+0001d850: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+0001d860: 2e76 6175 6c74 2e76 616c 7565 0a20 2020  .vault.value.   
+0001d870: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
+0001d880: 2074 6f6b 656e 0a20 2020 2020 2020 2029   token.        )
+0001d890: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001d8a0: 6973 6520 4d4c 5275 6e49 6e76 616c 6964  ise MLRunInvalid
+0001d8b0: 4172 6775 6d65 6e74 4572 726f 7228 0a20  ArgumentError(. 
+0001d8c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d8d0: 4120 7661 756c 7420 746f 6b65 6e20 6d75  A vault token mu
+0001d8e0: 7374 2062 6520 7072 6f76 6964 6564 2077  st be provided w
+0001d8f0: 6865 6e20 6163 6365 7373 696e 6720 7661  hen accessing va
+0001d900: 756c 7420 7365 6372 6574 7322 0a20 2020  ult secrets".   
+0001d910: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001d920: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001d930: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001d940: 7365 6372 6574 2d6b 6579 7322 0a20 2020  secret-keys".   
+0001d950: 2020 2020 2070 6172 616d 7320 3d20 7b22       params = {"
+0001d960: 7072 6f76 6964 6572 223a 2070 726f 7669  provider": provi
+0001d970: 6465 727d 0a20 2020 2020 2020 2068 6561  der}.        hea
+0001d980: 6465 7273 203d 2028 0a20 2020 2020 2020  ders = (.       
+0001d990: 2020 2020 207b 6d6c 7275 6e2e 636f 6d6d       {mlrun.comm
+0001d9a0: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
+0001d9b0: 724e 616d 6573 2e73 6563 7265 745f 7374  rNames.secret_st
+0001d9c0: 6f72 655f 746f 6b65 6e3a 2074 6f6b 656e  ore_token: token
+0001d9d0: 7d0a 2020 2020 2020 2020 2020 2020 6966  }.            if
+0001d9e0: 2070 726f 7669 6465 7220 3d3d 206d 6c72   provider == mlr
+0001d9f0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001da00: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+0001da10: 4e61 6d65 2e76 6175 6c74 2e76 616c 7565  Name.vault.value
+0001da20: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001da30: 6520 4e6f 6e65 0a20 2020 2020 2020 2029  e None.        )
+0001da40: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+0001da50: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+0001da60: 6420 7265 7472 6965 7669 6e67 2073 6563  d retrieving sec
+0001da70: 7265 7420 6b65 7973 207b 7072 6f6a 6563  ret keys {projec
+0001da80: 747d 2f7b 7072 6f76 6964 6572 7d22 0a20  t}/{provider}". 
+0001da90: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0001daa0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001dab0: 2020 2020 2020 2020 2020 2022 4745 5422             "GET"
+0001dac0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001dad0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+0001dae0: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
+0001daf0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001db00: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
+0001db10: 2020 2020 2020 6865 6164 6572 733d 6865        headers=he
+0001db20: 6164 6572 732c 0a20 2020 2020 2020 2029  aders,.        )
+0001db30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001db40: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001db50: 656d 6173 2e53 6563 7265 744b 6579 7344  emas.SecretKeysD
+0001db60: 6174 6128 2a2a 7265 7375 6c74 2e6a 736f  ata(**result.jso
+0001db70: 6e28 2929 0a0a 2020 2020 6465 6620 6465  n())..    def de
+0001db80: 6c65 7465 5f70 726f 6a65 6374 5f73 6563  lete_project_sec
+0001db90: 7265 7473 280a 2020 2020 2020 2020 7365  rets(.        se
+0001dba0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+0001dbb0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
+0001dbc0: 2020 7072 6f76 6964 6572 3a20 556e 696f    provider: Unio
+0001dbd0: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
+0001dbe0: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
+0001dbf0: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
+0001dc00: 726f 7669 6465 724e 616d 650a 2020 2020  roviderName.    
+0001dc10: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
+0001dc20: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
+0001dc30: 7265 7450 726f 7669 6465 724e 616d 652e  retProviderName.
+0001dc40: 6b75 6265 726e 6574 6573 2c0a 2020 2020  kubernetes,.    
+0001dc50: 2020 2020 7365 6372 6574 733a 206c 6973      secrets: lis
+0001dc60: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
+0001dc70: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0001dc80: 2244 656c 6574 6520 7072 6f6a 6563 742d  "Delete project-
+0001dc90: 636f 6e74 6578 7420 7365 6372 6574 7320  context secrets 
+0001dca0: 6672 6f6d 204b 7562 6572 6e65 7465 732e  from Kubernetes.
+0001dcb0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001dcc0: 2070 726f 6a65 6374 3a20 5468 6520 7072   project: The pr
+0001dcd0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
+0001dce0: 2020 2020 3a70 6172 616d 2070 726f 7669      :param provi
+0001dcf0: 6465 723a 2054 6865 206e 616d 6520 6f66  der: The name of
+0001dd00: 2074 6865 2073 6563 7265 7473 2d70 726f   the secrets-pro
+0001dd10: 7669 6465 7220 746f 2077 6f72 6b20 7769  vider to work wi
+0001dd20: 7468 2e20 4375 7272 656e 746c 7920 6f6e  th. Currently on
+0001dd30: 6c79 2060 606b 7562 6572 6e65 7465 7360  ly ``kubernetes`
+0001dd40: 6020 6973 2073 7570 706f 7274 6564 2e0a  ` is supported..
+0001dd50: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+0001dd60: 6563 7265 7473 3a20 4120 6c69 7374 206f  ecrets: A list o
+0001dd70: 6620 7365 6372 6574 206e 616d 6573 2074  f secret names t
+0001dd80: 6f20 6465 6c65 7465 2e20 416e 2065 6d70  o delete. An emp
+0001dd90: 7479 206c 6973 7420 7769 6c6c 2064 656c  ty list will del
+0001dda0: 6574 6520 616c 6c20 7365 6372 6574 7320  ete all secrets 
+0001ddb0: 6173 7369 676e 6564 0a20 2020 2020 2020  assigned.       
+0001ddc0: 2020 2020 2074 6f20 7468 6973 2073 7065       to this spe
+0001ddd0: 6369 6669 6320 7072 6f6a 6563 742e 0a20  cific project.. 
+0001dde0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001ddf0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001de00: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001de10: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+0001de20: 2070 6172 616d 7320 3d20 7b22 7072 6f76   params = {"prov
+0001de30: 6964 6572 223a 2070 726f 7669 6465 722c  ider": provider,
+0001de40: 2022 7365 6372 6574 223a 2073 6563 7265   "secret": secre
+0001de50: 7473 7d0a 2020 2020 2020 2020 6572 726f  ts}.        erro
+0001de60: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0001de70: 696c 6564 2064 656c 6574 696e 6720 7365  iled deleting se
+0001de80: 6372 6574 7320 7b70 726f 6a65 6374 7d2f  crets {project}/
+0001de90: 7b70 726f 7669 6465 727d 220a 2020 2020  {provider}".    
+0001dea0: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001deb0: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+0001dec0: 4445 4c45 5445 222c 0a20 2020 2020 2020  DELETE",.       
+0001ded0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+0001dee0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0001def0: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+0001df00: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
+0001df10: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001df20: 6465 6620 6372 6561 7465 5f75 7365 725f  def create_user_
+0001df30: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
+0001df40: 2073 656c 662c 0a20 2020 2020 2020 2075   self,.        u
+0001df50: 7365 723a 2073 7472 2c0a 2020 2020 2020  ser: str,.      
+0001df60: 2020 7072 6f76 6964 6572 3a20 556e 696f    provider: Unio
+0001df70: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
+0001df80: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
+0001df90: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
+0001dfa0: 726f 7669 6465 724e 616d 650a 2020 2020  roviderName.    
+0001dfb0: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
+0001dfc0: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
+0001dfd0: 7265 7450 726f 7669 6465 724e 616d 652e  retProviderName.
+0001dfe0: 7661 756c 742c 0a20 2020 2020 2020 2073  vault,.        s
+0001dff0: 6563 7265 7473 3a20 6469 6374 203d 204e  ecrets: dict = N
+0001e000: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+0001e010: 2020 2020 2222 2243 7265 6174 6520 7573      """Create us
+0001e020: 6572 2d63 6f6e 7465 7874 2073 6563 7265  er-context secre
+0001e030: 7420 696e 2056 6175 6c74 2e20 506c 6561  t in Vault. Plea
+0001e040: 7365 2072 6566 6572 2074 6f20 3a70 793a  se refer to :py:
+0001e050: 6675 6e63 3a60 6372 6561 7465 5f70 726f  func:`create_pro
+0001e060: 6a65 6374 5f73 6563 7265 7473 6020 666f  ject_secrets` fo
+0001e070: 7220 6d6f 7265 2064 6574 6169 6c73 0a20  r more details. 
+0001e080: 2020 2020 2020 2061 6e64 2073 7461 7475         and statu
+0001e090: 7320 6f66 2074 6869 7320 6675 6e63 7469  s of this functi
+0001e0a0: 6f6e 616c 6974 792e 0a0a 2020 2020 2020  onality...      
+0001e0b0: 2020 4e6f 7465 3a0a 2020 2020 2020 2020    Note:.        
+0001e0c0: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001e0d0: 686f 6420 6973 2063 7572 7265 6e74 6c79  hod is currently
+0001e0e0: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
+0001e0f0: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
+0001e100: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
+0001e110: 5661 756c 7420 696e 6672 6173 7472 7563  Vault infrastruc
+0001e120: 7475 7265 0a20 2020 2020 2020 2020 2020  ture.           
+0001e130: 2020 2020 2070 726f 7065 726c 7920 7365       properly se
+0001e140: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
+0001e150: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
+0001e160: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
+0001e170: 2020 2020 203a 7061 7261 6d20 7573 6572       :param user
+0001e180: 3a20 5468 6520 7573 6572 2063 6f6e 7465  : The user conte
+0001e190: 7874 2066 6f72 2077 6869 6368 2074 6f20  xt for which to 
+0001e1a0: 6765 6e65 7261 7465 2074 6865 2069 6e66  generate the inf
+0001e1b0: 7261 2061 6e64 2073 746f 7265 2073 6563  ra and store sec
+0001e1c0: 7265 7473 2e0a 2020 2020 2020 2020 3a70  rets..        :p
+0001e1d0: 6172 616d 2070 726f 7669 6465 723a 2054  aram provider: T
+0001e1e0: 6865 206e 616d 6520 6f66 2074 6865 2073  he name of the s
+0001e1f0: 6563 7265 7473 2d70 726f 7669 6465 7220  ecrets-provider 
+0001e200: 746f 2077 6f72 6b20 7769 7468 2e20 4375  to work with. Cu
+0001e210: 7272 656e 746c 7920 6f6e 6c79 2060 6076  rrently only ``v
+0001e220: 6175 6c74 6060 2069 7320 7375 7070 6f72  ault`` is suppor
+0001e230: 7465 642e 0a20 2020 2020 2020 203a 7061  ted..        :pa
+0001e240: 7261 6d20 7365 6372 6574 733a 2041 2073  ram secrets: A s
+0001e250: 6574 206f 6620 7365 6372 6574 2076 616c  et of secret val
+0001e260: 7565 7320 746f 2073 746f 7265 2077 6974  ues to store wit
+0001e270: 6869 6e20 7468 6520 5661 756c 742e 0a20  hin the Vault.. 
+0001e280: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001e290: 2020 2070 6174 6820 3d20 2275 7365 722d     path = "user-
+0001e2a0: 7365 6372 6574 7322 0a20 2020 2020 2020  secrets".       
+0001e2b0: 2073 6563 7265 7473 5f63 7265 6174 696f   secrets_creatio
+0001e2c0: 6e5f 7265 7175 6573 7420 3d20 6d6c 7275  n_request = mlru
+0001e2d0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001e2e0: 2e55 7365 7253 6563 7265 7443 7265 6174  .UserSecretCreat
+0001e2f0: 696f 6e52 6571 7565 7374 280a 2020 2020  ionRequest(.    
+0001e300: 2020 2020 2020 2020 7573 6572 3d75 7365          user=use
+0001e310: 722c 0a20 2020 2020 2020 2020 2020 2070  r,.            p
+0001e320: 726f 7669 6465 723d 7072 6f76 6964 6572  rovider=provider
+0001e330: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+0001e340: 6372 6574 733d 7365 6372 6574 732c 0a20  crets=secrets,. 
+0001e350: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001e360: 2062 6f64 7920 3d20 7365 6372 6574 735f   body = secrets_
+0001e370: 6372 6561 7469 6f6e 5f72 6571 7565 7374  creation_request
+0001e380: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
+0001e390: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0001e3a0: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+0001e3b0: 6720 7573 6572 2073 6563 7265 7473 202d  g user secrets -
+0001e3c0: 207b 7573 6572 7d22 0a20 2020 2020 2020   {user}".       
+0001e3d0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+0001e3e0: 2020 2020 2020 2020 2020 2020 2250 4f53              "POS
+0001e3f0: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
+0001e400: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0001e410: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
+0001e420: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+0001e430: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2862  y=dict_to_json(b
+0001e440: 6f64 7929 2c0a 2020 2020 2020 2020 290a  ody),.        ).
+0001e450: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0001e460: 6f64 0a20 2020 2064 6566 205f 7661 6c69  od.    def _vali
+0001e470: 6461 7465 5f76 6572 7369 6f6e 5f63 6f6d  date_version_com
+0001e480: 7061 7469 6269 6c69 7479 2873 6572 7665  patibility(serve
+0001e490: 725f 7665 7273 696f 6e2c 2063 6c69 656e  r_version, clien
+0001e4a0: 745f 7665 7273 696f 6e29 202d 3e20 626f  t_version) -> bo
+0001e4b0: 6f6c 3a0a 2020 2020 2020 2020 7472 793a  ol:.        try:
+0001e4c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0001e4d0: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
+0001e4e0: 6f6e 203d 2073 656d 7665 722e 5665 7273  on = semver.Vers
+0001e4f0: 696f 6e49 6e66 6f2e 7061 7273 6528 7365  ionInfo.parse(se
+0001e500: 7276 6572 5f76 6572 7369 6f6e 290a 2020  rver_version).  
+0001e510: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
+0001e520: 5f63 6c69 656e 745f 7665 7273 696f 6e20  _client_version 
+0001e530: 3d20 7365 6d76 6572 2e56 6572 7369 6f6e  = semver.Version
+0001e540: 496e 666f 2e70 6172 7365 2863 6c69 656e  Info.parse(clien
+0001e550: 745f 7665 7273 696f 6e29 0a20 2020 2020  t_version).     
+0001e560: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+0001e570: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0001e580: 2020 2320 5468 6973 2077 696c 6c20 6d6f    # This will mo
+0001e590: 7374 6c79 2068 6170 7065 6e20 696e 2064  stly happen in d
+0001e5a0: 6576 2073 6365 6e61 7269 6f73 2077 6865  ev scenarios whe
+0001e5b0: 6e20 7468 6520 7665 7273 696f 6e20 6973  n the version is
+0001e5c0: 2075 6e73 7461 626c 6520 616e 6420 7375   unstable and su
+0001e5d0: 6368 202d 2074 6865 7265 666f 7265 2077  ch - therefore w
+0001e5e0: 6527 7265 2069 676e 6f72 696e 670a 2020  e're ignoring.  
+0001e5f0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0001e600: 2e77 6172 6e69 6e67 280a 2020 2020 2020  .warning(.      
+0001e610: 2020 2020 2020 2020 2020 2255 6e61 626c            "Unabl
+0001e620: 6520 746f 2070 6172 7365 2073 6572 7665  e to parse serve
+0001e630: 7220 6f72 2063 6c69 656e 7420 7665 7273  r or client vers
+0001e640: 696f 6e2e 2041 7373 756d 696e 6720 636f  ion. Assuming co
+0001e650: 6d70 6174 6962 6c65 222c 0a20 2020 2020  mpatible",.     
+0001e660: 2020 2020 2020 2020 2020 2073 6572 7665             serve
+0001e670: 725f 7665 7273 696f 6e3d 7365 7276 6572  r_version=server
+0001e680: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001e690: 2020 2020 2020 2020 2020 636c 6965 6e74            client
+0001e6a0: 5f76 6572 7369 6f6e 3d63 6c69 656e 745f  _version=client_
+0001e6b0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+0001e6c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001e6d0: 2020 2072 6574 7572 6e20 5472 7565 0a20     return True. 
+0001e6e0: 2020 2020 2020 2069 6620 2870 6172 7365         if (parse
+0001e6f0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
+0001e700: 2e6d 616a 6f72 203d 3d20 3020 616e 6420  .major == 0 and 
+0001e710: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001e720: 7273 696f 6e2e 6d69 6e6f 7220 3d3d 2030  rsion.minor == 0
+0001e730: 2920 6f72 2028 0a20 2020 2020 2020 2020  ) or (.         
+0001e740: 2020 2070 6172 7365 645f 636c 6965 6e74     parsed_client
+0001e750: 5f76 6572 7369 6f6e 2e6d 616a 6f72 203d  _version.major =
+0001e760: 3d20 3020 616e 6420 7061 7273 6564 5f63  = 0 and parsed_c
+0001e770: 6c69 656e 745f 7665 7273 696f 6e2e 6d69  lient_version.mi
+0001e780: 6e6f 7220 3d3d 2030 0a20 2020 2020 2020  nor == 0.       
+0001e790: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0001e7a0: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
+0001e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e7c0: 2253 6572 7665 7220 6f72 2063 6c69 656e  "Server or clien
+0001e7d0: 7420 7665 7273 696f 6e20 6973 2075 6e73  t version is uns
+0001e7e0: 7461 626c 652e 2041 7373 756d 696e 6720  table. Assuming 
+0001e7f0: 636f 6d70 6174 6962 6c65 222c 0a20 2020  compatible",.   
+0001e800: 2020 2020 2020 2020 2020 2020 2073 6572               ser
+0001e810: 7665 725f 7665 7273 696f 6e3d 7365 7276  ver_version=serv
+0001e820: 6572 5f76 6572 7369 6f6e 2c0a 2020 2020  er_version,.    
+0001e830: 2020 2020 2020 2020 2020 2020 636c 6965              clie
+0001e840: 6e74 5f76 6572 7369 6f6e 3d63 6c69 656e  nt_version=clien
+0001e850: 745f 7665 7273 696f 6e2c 0a20 2020 2020  t_version,.     
+0001e860: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001e870: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+0001e880: 0a20 2020 2020 2020 2069 6620 7061 7273  .        if pars
+0001e890: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
+0001e8a0: 6e2e 6d61 6a6f 7220 213d 2070 6172 7365  n.major != parse
+0001e8b0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001e8c0: 2e6d 616a 6f72 3a0a 2020 2020 2020 2020  .major:.        
+0001e8d0: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
+0001e8e0: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
+0001e8f0: 2020 2020 2253 6572 7665 7220 616e 6420      "Server and 
+0001e900: 636c 6965 6e74 2076 6572 7369 6f6e 7320  client versions 
+0001e910: 6172 6520 696e 636f 6d70 6174 6962 6c65  are incompatible
+0001e920: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001e930: 2020 2070 6172 7365 645f 7365 7276 6572     parsed_server
+0001e940: 5f76 6572 7369 6f6e 3d70 6172 7365 645f  _version=parsed_
+0001e950: 7365 7276 6572 5f76 6572 7369 6f6e 2c0a  server_version,.
+0001e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e970: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
+0001e980: 7273 696f 6e3d 7061 7273 6564 5f63 6c69  rsion=parsed_cli
+0001e990: 656e 745f 7665 7273 696f 6e2c 0a20 2020  ent_version,.   
+0001e9a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001e9b0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
+0001e9c0: 6c73 650a 2020 2020 2020 2020 6966 2070  lse.        if p
+0001e9d0: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001e9e0: 7369 6f6e 2e6d 696e 6f72 203e 2070 6172  sion.minor > par
+0001e9f0: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001ea00: 6f6e 2e6d 696e 6f72 202b 2032 3a0a 2020  on.minor + 2:.  
+0001ea10: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0001ea20: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
+0001ea30: 2020 2020 2020 2022 4261 636b 7761 7264         "Backward
+0001ea40: 7320 636f 6d70 6174 6962 696c 6974 7920  s compatibility 
+0001ea50: 6d69 6768 7420 6e6f 7420 6170 706c 7920  might not apply 
+0001ea60: 6265 7477 6565 6e20 7468 6520 7365 7276  between the serv
+0001ea70: 6572 2061 6e64 2063 6c69 656e 7420 7665  er and client ve
+0001ea80: 7273 696f 6e22 2c0a 2020 2020 2020 2020  rsion",.        
+0001ea90: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
+0001eaa0: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
+0001eab0: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001eac0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001ead0: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
+0001eae0: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
+0001eaf0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001eb00: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001eb10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001eb20: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
+0001eb30: 2069 6620 7061 7273 6564 5f63 6c69 656e   if parsed_clien
+0001eb40: 745f 7665 7273 696f 6e2e 6d69 6e6f 7220  t_version.minor 
+0001eb50: 3e20 7061 7273 6564 5f73 6572 7665 725f  > parsed_server_
+0001eb60: 7665 7273 696f 6e2e 6d69 6e6f 723a 0a20  version.minor:. 
+0001eb70: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0001eb80: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
+0001eb90: 2020 2020 2020 2020 2020 2022 436c 6965             "Clie
+0001eba0: 6e74 2076 6572 7369 6f6e 2077 6974 6820  nt version with 
+0001ebb0: 6869 6768 6572 2076 6572 7369 6f6e 2074  higher version t
+0001ebc0: 6861 6e20 7365 7276 6572 2076 6572 7369  han server versi
+0001ebd0: 6f6e 2069 736e 2774 2073 7570 706f 7274  on isn't support
+0001ebe0: 6564 2c22 0a20 2020 2020 2020 2020 2020  ed,".           
+0001ebf0: 2020 2020 2022 2061 6c69 676e 2079 6f75       " align you
+0001ec00: 7220 636c 6965 6e74 2074 6f20 7468 6520  r client to the 
+0001ec10: 7365 7276 6572 2076 6572 7369 6f6e 222c  server version",
+0001ec20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ec30: 2070 6172 7365 645f 7365 7276 6572 5f76   parsed_server_v
+0001ec40: 6572 7369 6f6e 3d70 6172 7365 645f 7365  ersion=parsed_se
+0001ec50: 7276 6572 5f76 6572 7369 6f6e 2c0a 2020  rver_version,.  
+0001ec60: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0001ec70: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
+0001ec80: 696f 6e3d 7061 7273 6564 5f63 6c69 656e  ion=parsed_clien
+0001ec90: 745f 7665 7273 696f 6e2c 0a20 2020 2020  t_version,.     
+0001eca0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001ecb0: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+0001ecc0: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
+0001ecd0: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
+0001ece0: 6f6e 2e6d 696e 6f72 2021 3d20 7061 7273  on.minor != pars
+0001ecf0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001ed00: 6e2e 6d69 6e6f 723a 0a20 2020 2020 2020  n.minor:.       
+0001ed10: 2020 2020 206c 6f67 6765 722e 696e 666f       logger.info
+0001ed20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ed30: 2020 2253 6572 7665 7220 616e 6420 636c    "Server and cl
+0001ed40: 6965 6e74 2076 6572 7369 6f6e 7320 6172  ient versions ar
+0001ed50: 6520 6e6f 7420 7468 6520 7361 6d65 2062  e not the same b
+0001ed60: 7574 2063 6f6d 7061 7469 626c 6522 2c0a  ut compatible",.
+0001ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed80: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001ed90: 7273 696f 6e3d 7061 7273 6564 5f73 6572  rsion=parsed_ser
+0001eda0: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
+0001edb0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001edc0: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001edd0: 6f6e 3d70 6172 7365 645f 636c 6965 6e74  on=parsed_client
+0001ede0: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001edf0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001ee00: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+0001ee10: 2064 6566 2063 7265 6174 655f 6d6f 6465   def create_mode
+0001ee20: 6c5f 656e 6470 6f69 6e74 280a 2020 2020  l_endpoint(.    
+0001ee30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001ee40: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+0001ee50: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+0001ee60: 5f69 643a 2073 7472 2c0a 2020 2020 2020  _id: str,.      
+0001ee70: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
+0001ee80: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+0001ee90: 2020 2020 206d 6c72 756e 2e6d 6f64 656c       mlrun.model
+0001eea0: 5f6d 6f6e 6974 6f72 696e 672e 6d6f 6465  _monitoring.mode
+0001eeb0: 6c5f 656e 6470 6f69 6e74 2e4d 6f64 656c  l_endpoint.Model
+0001eec0: 456e 6470 6f69 6e74 2c20 6469 6374 0a20  Endpoint, dict. 
+0001eed0: 2020 2020 2020 205d 2c0a 2020 2020 293a         ],.    ):
+0001eee0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001eef0: 2020 2020 2043 7265 6174 6573 2061 2044       Creates a D
+0001ef00: 4220 7265 636f 7264 2077 6974 6820 7468  B record with th
+0001ef10: 6520 6769 7665 6e20 6d6f 6465 6c5f 656e  e given model_en
+0001ef20: 6470 6f69 6e74 2072 6563 6f72 642e 0a0a  dpoint record...
+0001ef30: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0001ef40: 726f 6a65 6374 3a20 5468 6520 6e61 6d65  roject: The name
+0001ef50: 206f 6620 7468 6520 7072 6f6a 6563 742e   of the project.
+0001ef60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001ef70: 656e 6470 6f69 6e74 5f69 643a 2054 6865  endpoint_id: The
+0001ef80: 2069 6420 6f66 2074 6865 2065 6e64 706f   id of the endpo
+0001ef90: 696e 742e 0a20 2020 2020 2020 203a 7061  int..        :pa
+0001efa0: 7261 6d20 6d6f 6465 6c5f 656e 6470 6f69  ram model_endpoi
+0001efb0: 6e74 3a20 416e 206f 626a 6563 7420 7265  nt: An object re
+0001efc0: 7072 6573 656e 7469 6e67 2074 6865 206d  presenting the m
+0001efd0: 6f64 656c 2065 6e64 706f 696e 742e 0a20  odel endpoint.. 
+0001efe0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001eff0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001f000: 6528 0a20 2020 2020 2020 2020 2020 206d  e(.            m
+0001f010: 6f64 656c 5f65 6e64 706f 696e 742c 206d  odel_endpoint, m
+0001f020: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
+0001f030: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
+0001f040: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
+0001f050: 6e74 0a20 2020 2020 2020 2029 3a0a 2020  nt.        ):.  
+0001f060: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+0001f070: 656e 6470 6f69 6e74 203d 206d 6f64 656c  endpoint = model
+0001f080: 5f65 6e64 706f 696e 742e 746f 5f64 6963  _endpoint.to_dic
+0001f090: 7428 290a 0a20 2020 2020 2020 2070 6174  t()..        pat
+0001f0a0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+0001f0b0: 7072 6f6a 6563 747d 2f6d 6f64 656c 2d65  project}/model-e
+0001f0c0: 6e64 706f 696e 7473 2f7b 656e 6470 6f69  ndpoints/{endpoi
+0001f0d0: 6e74 5f69 647d 220a 2020 2020 2020 2020  nt_id}".        
+0001f0e0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001f0f0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0001f100: 643d 2250 4f53 5422 2c0a 2020 2020 2020  d="POST",.      
+0001f110: 2020 2020 2020 7061 7468 3d70 6174 682c        path=path,
+0001f120: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+0001f130: 793d 6469 6374 5f74 6f5f 6a73 6f6e 286d  y=dict_to_json(m
+0001f140: 6f64 656c 5f65 6e64 706f 696e 7429 2c0a  odel_endpoint),.
+0001f150: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001f160: 6566 2064 656c 6574 655f 6d6f 6465 6c5f  ef delete_model_
+0001f170: 656e 6470 6f69 6e74 280a 2020 2020 2020  endpoint(.      
+0001f180: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001f190: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+0001f1a0: 2020 2020 2020 656e 6470 6f69 6e74 5f69        endpoint_i
+0001f1b0: 643a 2073 7472 2c0a 2020 2020 293a 0a20  d: str,.    ):. 
+0001f1c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001f1d0: 2020 2044 656c 6574 6573 2074 6865 2044     Deletes the D
+0001f1e0: 4220 7265 636f 7264 206f 6620 6120 6769  B record of a gi
+0001f1f0: 7665 6e20 6d6f 6465 6c20 656e 6470 6f69  ven model endpoi
+0001f200: 6e74 2c20 7072 6f6a 6563 7420 616e 6420  nt, project and 
+0001f210: 656e 6470 6f69 6e74 5f69 6420 6172 6520  endpoint_id are 
+0001f220: 7573 6564 2066 6f72 206c 6f6f 6b75 700a  used for lookup.
+0001f230: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001f240: 7072 6f6a 6563 743a 2054 6865 206e 616d  project: The nam
+0001f250: 6520 6f66 2074 6865 2070 726f 6a65 6374  e of the project
+0001f260: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001f270: 656e 6470 6f69 6e74 5f69 643a 2054 6865  endpoint_id: The
+0001f280: 2069 6420 6f66 2074 6865 2065 6e64 706f   id of the endpo
+0001f290: 696e 740a 2020 2020 2020 2020 2222 220a  int.        """.
+0001f2a0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0001f2b0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0001f2c0: 6563 747d 2f6d 6f64 656c 2d65 6e64 706f  ect}/model-endpo
+0001f2d0: 696e 7473 2f7b 656e 6470 6f69 6e74 5f69  ints/{endpoint_i
+0001f2e0: 647d 220a 2020 2020 2020 2020 7365 6c66  d}".        self
+0001f2f0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001f300: 2020 2020 2020 206d 6574 686f 643d 2244         method="D
+0001f310: 454c 4554 4522 2c0a 2020 2020 2020 2020  ELETE",.        
+0001f320: 2020 2020 7061 7468 3d70 6174 682c 0a20      path=path,. 
+0001f330: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+0001f340: 6620 6c69 7374 5f6d 6f64 656c 5f65 6e64  f list_model_end
+0001f350: 706f 696e 7473 280a 2020 2020 2020 2020  points(.        
+0001f360: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+0001f370: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
+0001f380: 2020 2020 6d6f 6465 6c3a 204f 7074 696f      model: Optio
+0001f390: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0001f3a0: 0a20 2020 2020 2020 2066 756e 6374 696f  .        functio
+0001f3b0: 6e3a 204f 7074 696f 6e61 6c5b 7374 725d  n: Optional[str]
+0001f3c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001f3d0: 206c 6162 656c 733a 206c 6973 745b 7374   labels: list[st
+0001f3e0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0001f3f0: 2020 2073 7461 7274 3a20 7374 7220 3d20     start: str = 
+0001f400: 226e 6f77 2d31 6822 2c0a 2020 2020 2020  "now-1h",.      
+0001f410: 2020 656e 643a 2073 7472 203d 2022 6e6f    end: str = "no
+0001f420: 7722 2c0a 2020 2020 2020 2020 6d65 7472  w",.        metr
+0001f430: 6963 733a 204f 7074 696f 6e61 6c5b 6c69  ics: Optional[li
+0001f440: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
+0001f450: 0a20 2020 2020 2020 2074 6f70 5f6c 6576  .        top_lev
+0001f460: 656c 3a20 626f 6f6c 203d 2046 616c 7365  el: bool = False
+0001f470: 2c0a 2020 2020 2020 2020 7569 6473 3a20  ,.        uids: 
+0001f480: 4f70 7469 6f6e 616c 5b6c 6973 745b 7374  Optional[list[st
+0001f490: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+0001f4a0: 2920 2d3e 206c 6973 745b 6d6c 7275 6e2e  ) -> list[mlrun.
+0001f4b0: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
+0001f4c0: 2e6d 6f64 656c 5f65 6e64 706f 696e 742e  .model_endpoint.
+0001f4d0: 4d6f 6465 6c45 6e64 706f 696e 745d 3a0a  ModelEndpoint]:.
+0001f4e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001f4f0: 2020 2020 5265 7475 726e 7320 6120 6c69      Returns a li
+0001f500: 7374 206f 6620 604d 6f64 656c 456e 6470  st of `ModelEndp
+0001f510: 6f69 6e74 6020 6f62 6a65 6374 732e 2045  oint` objects. E
+0001f520: 6163 6820 604d 6f64 656c 456e 6470 6f69  ach `ModelEndpoi
+0001f530: 6e74 6020 6f62 6a65 6374 2072 6570 7265  nt` object repre
+0001f540: 7365 6e74 7320 7468 6520 6375 7272 656e  sents the curren
+0001f550: 7420 7374 6174 6520 6f66 2061 0a20 2020  t state of a.   
+0001f560: 2020 2020 206d 6f64 656c 2065 6e64 706f       model endpo
+0001f570: 696e 742e 2054 6869 7320 6675 6e63 7469  int. This functi
+0001f580: 6f6e 7320 7375 7070 6f72 7473 2066 696c  ons supports fil
+0001f590: 7465 7269 6e67 2062 7920 7468 6520 666f  tering by the fo
+0001f5a0: 6c6c 6f77 696e 6720 7061 7261 6d65 7465  llowing paramete
+0001f5b0: 7273 3a0a 2020 2020 2020 2020 3129 206d  rs:.        1) m
+0001f5c0: 6f64 656c 0a20 2020 2020 2020 2032 2920  odel.        2) 
+0001f5d0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+0001f5e0: 2033 2920 6c61 6265 6c73 0a20 2020 2020   3) labels.     
+0001f5f0: 2020 2034 2920 746f 7020 6c65 7665 6c0a     4) top level.
+0001f600: 2020 2020 2020 2020 3529 2075 6964 730a          5) uids.
+0001f610: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
+0001f620: 6c74 2c20 7768 656e 206e 6f20 6669 6c74  lt, when no filt
+0001f630: 6572 7320 6172 6520 6170 706c 6965 642c  ers are applied,
+0001f640: 2061 6c6c 2061 7661 696c 6162 6c65 2065   all available e
+0001f650: 6e64 706f 696e 7473 2066 6f72 2074 6865  ndpoints for the
+0001f660: 2067 6976 656e 2070 726f 6a65 6374 2077   given project w
+0001f670: 696c 6c20 6265 206c 6973 7465 642e 0a0a  ill be listed...
+0001f680: 2020 2020 2020 2020 496e 2061 6464 6974          In addit
+0001f690: 696f 6e2c 2074 6869 7320 6675 6e63 7469  ion, this functi
+0001f6a0: 6f6e 7320 7072 6f76 6964 6573 2061 2066  ons provides a f
+0001f6b0: 6163 6164 6520 666f 7220 6c69 7374 696e  acade for listin
+0001f6c0: 6720 656e 6470 6f69 6e74 2072 656c 6174  g endpoint relat
+0001f6d0: 6564 206d 6574 7269 6373 2e20 5468 6973  ed metrics. This
+0001f6e0: 2066 6163 6164 6520 6973 2074 696d 652d   facade is time-
+0001f6f0: 6261 7365 640a 2020 2020 2020 2020 616e  based.        an
+0001f700: 6420 6465 7065 6e64 7320 6f6e 2074 6865  d depends on the
+0001f710: 2027 7374 6172 7427 2061 6e64 2027 656e   'start' and 'en
+0001f720: 6427 2070 6172 616d 6574 6572 732e 2042  d' parameters. B
+0001f730: 7920 6465 6661 756c 742c 2077 6865 6e20  y default, when 
+0001f740: 7468 6520 6d65 7472 6963 7320 7061 7261  the metrics para
+0001f750: 6d65 7465 7220 6973 204e 6f6e 652c 206e  meter is None, n
+0001f760: 6f20 6d65 7472 6963 7320 6172 650a 2020  o metrics are.  
+0001f770: 2020 2020 2020 6164 6465 6420 746f 2074        added to t
+0001f780: 6865 206f 7574 7075 7420 6f66 2074 6869  he output of thi
+0001f790: 7320 6675 6e63 7469 6f6e 2e0a 0a20 2020  s function...   
+0001f7a0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0001f7b0: 6563 743a 2054 6865 206e 616d 6520 6f66  ect: The name of
+0001f7c0: 2074 6865 2070 726f 6a65 6374 0a20 2020   the project.   
+0001f7d0: 2020 2020 203a 7061 7261 6d20 6d6f 6465       :param mode
+0001f7e0: 6c3a 2054 6865 206e 616d 6520 6f66 2074  l: The name of t
+0001f7f0: 6865 206d 6f64 656c 2074 6f20 6669 6c74  he model to filt
+0001f800: 6572 2062 790a 2020 2020 2020 2020 3a70  er by.        :p
+0001f810: 6172 616d 2066 756e 6374 696f 6e3a 2054  aram function: T
+0001f820: 6865 206e 616d 6520 6f66 2074 6865 2066  he name of the f
+0001f830: 756e 6374 696f 6e20 746f 2066 696c 7465  unction to filte
+0001f840: 7220 6279 0a20 2020 2020 2020 203a 7061  r by.        :pa
+0001f850: 7261 6d20 6c61 6265 6c73 3a20 4120 6c69  ram labels: A li
+0001f860: 7374 206f 6620 6c61 6265 6c73 2074 6f20  st of labels to 
+0001f870: 6669 6c74 6572 2062 792e 204c 6162 656c  filter by. Label
+0001f880: 2066 696c 7465 7273 2077 6f72 6b20 6279   filters work by
+0001f890: 2065 6974 6865 7220 6669 6c74 6572 696e   either filterin
+0001f8a0: 6720 6120 7370 6563 6966 6963 2076 616c  g a specific val
+0001f8b0: 7565 206f 6620 610a 2020 2020 2020 2020  ue of a.        
+0001f8c0: 206c 6162 656c 2028 692e 652e 206c 6973   label (i.e. lis
+0001f8d0: 7428 226b 6579 3d76 616c 7565 2229 2920  t("key=value")) 
+0001f8e0: 6f72 2062 7920 6c6f 6f6b 696e 6720 666f  or by looking fo
+0001f8f0: 7220 7468 6520 6578 6973 7465 6e63 6520  r the existence 
+0001f900: 6f66 2061 2067 6976 656e 206b 6579 2028  of a given key (
+0001f910: 692e 652e 2022 6b65 7922 290a 2020 2020  i.e. "key").    
+0001f920: 2020 2020 3a70 6172 616d 206d 6574 7269      :param metri
+0001f930: 6373 3a20 4120 6c69 7374 206f 6620 6d65  cs: A list of me
+0001f940: 7472 6963 7320 746f 2072 6574 7572 6e20  trics to return 
+0001f950: 666f 7220 6561 6368 2065 6e64 706f 696e  for each endpoin
+0001f960: 742c 2072 6561 6420 6d6f 7265 2069 6e20  t, read more in 
+0001f970: 2754 696d 654d 6574 7269 6327 0a20 2020  'TimeMetric'.   
+0001f980: 2020 2020 203a 7061 7261 6d20 7374 6172       :param star
+0001f990: 743a 2054 6865 2073 7461 7274 2074 696d  t: The start tim
+0001f9a0: 6520 6f66 2074 6865 206d 6574 7269 6373  e of the metrics
+0001f9b0: 2e20 4361 6e20 6265 2072 6570 7265 7365  . Can be represe
+0001f9c0: 6e74 6564 2062 7920 6120 7374 7269 6e67  nted by a string
+0001f9d0: 2063 6f6e 7461 696e 696e 6720 616e 2052   containing an R
+0001f9e0: 4643 2033 3333 390a 2020 2020 2020 2020  FC 3339.        
+0001f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa00: 2020 2020 2020 2020 2074 696d 652c 2061           time, a
+0001fa10: 2055 6e69 7820 7469 6d65 7374 616d 7020   Unix timestamp 
+0001fa20: 696e 206d 696c 6c69 7365 636f 6e64 732c  in milliseconds,
+0001fa30: 2061 2072 656c 6174 6976 6520 7469 6d65   a relative time
+0001fa40: 2028 6027 6e6f 7727 6020 6f72 0a20 2020   (`'now'` or.   
+0001fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa60: 2020 2020 2020 2020 2020 2020 2020 6027                `'
+0001fa70: 6e6f 772d 5b30 2d39 5d2b 5b6d 6864 5d27  now-[0-9]+[mhd]'
+0001fa80: 602c 2077 6865 7265 2060 6d60 203d 206d  `, where `m` = m
+0001fa90: 696e 7574 6573 2c20 6068 6020 3d20 686f  inutes, `h` = ho
+0001faa0: 7572 732c 2061 6e64 2060 2764 2760 203d  urs, and `'d'` =
+0001fab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fad0: 2020 6461 7973 292c 206f 7220 3020 666f    days), or 0 fo
+0001fae0: 7220 7468 6520 6561 726c 6965 7374 2074  r the earliest t
+0001faf0: 696d 652e 0a20 2020 2020 2020 203a 7061  ime..        :pa
+0001fb00: 7261 6d20 656e 643a 2054 6865 2065 6e64  ram end: The end
+0001fb10: 2074 696d 6520 6f66 2074 6865 206d 6574   time of the met
+0001fb20: 7269 6373 2e20 4361 6e20 6265 2072 6570  rics. Can be rep
+0001fb30: 7265 7365 6e74 6564 2062 7920 6120 7374  resented by a st
+0001fb40: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
+0001fb50: 616e 2052 4643 2033 3333 390a 2020 2020  an RFC 3339.    
 0001fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb70: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
-0001fb80: 7320 666f 7220 6d6f 6465 6c20 656e 6470  s for model endp
-0001fb90: 6f69 6e74 7320 7375 6368 2061 7320 7072  oints such as pr
-0001fba0: 6564 6963 7469 6f6e 735f 7065 725f 7365  edictions_per_se
-0001fbb0: 636f 6e64 2061 6e64 0a20 2020 2020 2020  cond and.       
-0001fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb70: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+0001fb80: 652c 2061 2055 6e69 7820 7469 6d65 7374  e, a Unix timest
+0001fb90: 616d 7020 696e 206d 696c 6c69 7365 636f  amp in milliseco
+0001fba0: 6e64 732c 2061 2072 656c 6174 6976 6520  nds, a relative 
+0001fbb0: 7469 6d65 2028 6027 6e6f 7727 6020 6f72  time (`'now'` or
+0001fbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbe0: 2020 2020 6c61 7465 6e63 795f 6176 675f      latency_avg_
-0001fbf0: 356d 2062 7574 2061 6c73 6f20 6375 7374  5m but also cust
-0001fc00: 6f6d 206d 6574 7269 6373 2064 6566 696e  om metrics defin
-0001fc10: 6564 2062 7920 7468 6520 7573 6572 2e20  ed by the user. 
-0001fc20: 506c 6561 7365 206e 6f74 6520 7468 6174  Please note that
-0001fc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fc50: 2020 2020 2020 2020 2020 2020 7468 6573              thes
-0001fc60: 6520 6d65 7472 6963 7320 6172 6520 7374  e metrics are st
-0001fc70: 6f72 6564 2069 6e20 7468 6520 7469 6d65  ored in the time
-0001fc80: 2073 6572 6965 7320 4442 2061 6e64 2074   series DB and t
-0001fc90: 6865 2072 6573 756c 7473 2077 696c 6c20  he results will 
-0001fca0: 6265 0a20 2020 2020 2020 2020 2020 2020  be.             
-0001fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fcc0: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-0001fcd0: 7065 6172 6564 2075 6e64 6572 206d 6f64  peared under mod
-0001fce0: 656c 5f65 6e64 706f 696e 742e 7370 6563  el_endpoint.spec
-0001fcf0: 2e6d 6574 7269 6373 2e0a 2020 2020 2020  .metrics..      
-0001fd00: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
-0001fd10: 5f61 6e61 6c79 7369 733a 2020 2020 2020  _analysis:      
-0001fd20: 2020 2020 2057 6865 6e20 5472 7565 2c20       When True, 
-0001fd30: 7468 6520 6261 7365 2066 6561 7475 7265  the base feature
-0001fd40: 2073 7461 7469 7374 6963 7320 616e 6420   statistics and 
-0001fd50: 6375 7272 656e 7420 6665 6174 7572 6520  current feature 
-0001fd60: 7374 6174 6973 7469 6373 2077 696c 6c0a  statistics will.
-0001fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd90: 2020 2020 2020 2020 2020 2062 6520 6164             be ad
-0001fda0: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
-0001fdb0: 7420 6f66 2074 6865 2072 6573 756c 7469  t of the resulti
-0001fdc0: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
-0001fdd0: 2020 2020 3a72 6574 7572 6e3a 2041 2060      :return: A `
-0001fde0: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
-0001fdf0: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
-0001fe00: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-0001fe10: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001fe20: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
-0001fe30: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
-0001fe40: 745f 6964 7d22 0a20 2020 2020 2020 2072  t_id}".        r
-0001fe50: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-0001fe60: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001fe70: 2020 2020 206d 6574 686f 643d 2247 4554       method="GET
-0001fe80: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0001fe90: 6174 683d 7061 7468 2c0a 2020 2020 2020  ath=path,.      
-0001fea0: 2020 2020 2020 7061 7261 6d73 3d7b 0a20        params={. 
-0001feb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001fec0: 7374 6172 7422 3a20 7374 6172 742c 0a20  start": start,. 
-0001fed0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001fee0: 656e 6422 3a20 656e 642c 0a20 2020 2020  end": end,.     
-0001fef0: 2020 2020 2020 2020 2020 2022 6d65 7472             "metr
-0001ff00: 6963 223a 206d 6574 7269 6373 206f 7220  ic": metrics or 
-0001ff10: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-0001ff20: 2020 2020 2266 6561 7475 7265 5f61 6e61      "feature_ana
-0001ff30: 6c79 7369 7322 3a20 6665 6174 7572 655f  lysis": feature_
-0001ff40: 616e 616c 7973 6973 2c0a 2020 2020 2020  analysis,.      
-0001ff50: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-0001ff60: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-0001ff70: 726e 206d 6c72 756e 2e6d 6f64 656c 5f6d  rn mlrun.model_m
-0001ff80: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
-0001ff90: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
-0001ffa0: 6470 6f69 6e74 2e66 726f 6d5f 6469 6374  dpoint.from_dict
-0001ffb0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-0001ffc0: 7370 6f6e 7365 2e6a 736f 6e28 290a 2020  sponse.json().  
-0001ffd0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0001ffe0: 2070 6174 6368 5f6d 6f64 656c 5f65 6e64   patch_model_end
-0001fff0: 706f 696e 7428 0a20 2020 2020 2020 2073  point(.        s
-00020000: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-00020010: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-00020020: 2020 2065 6e64 706f 696e 745f 6964 3a20     endpoint_id: 
-00020030: 7374 722c 0a20 2020 2020 2020 2061 7474  str,.        att
-00020040: 7269 6275 7465 733a 2064 6963 742c 0a20  ributes: dict,. 
-00020050: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00020060: 220a 2020 2020 2020 2020 5570 6461 7465  ".        Update
-00020070: 7320 6d6f 6465 6c20 656e 6470 6f69 6e74  s model endpoint
-00020080: 2077 6974 6820 7072 6f76 6964 6564 2061   with provided a
-00020090: 7474 7269 6275 7465 732e 0a0a 2020 2020  ttributes...    
-000200a0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-000200b0: 6374 3a20 5468 6520 6e61 6d65 206f 6620  ct: The name of 
-000200c0: 7468 6520 7072 6f6a 6563 742e 0a20 2020  the project..   
-000200d0: 2020 2020 203a 7061 7261 6d20 656e 6470       :param endp
-000200e0: 6f69 6e74 5f69 643a 2054 6865 2069 6420  oint_id: The id 
-000200f0: 6f66 2074 6865 2065 6e64 706f 696e 742e  of the endpoint.
-00020100: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00020110: 6174 7472 6962 7574 6573 3a20 4469 6374  attributes: Dict
-00020120: 696f 6e61 7279 206f 6620 6174 7472 6962  ionary of attrib
-00020130: 7574 6573 2074 6861 7420 7769 6c6c 2062  utes that will b
-00020140: 6520 7573 6564 2066 6f72 2075 7064 6174  e used for updat
-00020150: 6520 7468 6520 6d6f 6465 6c20 656e 6470  e the model endp
-00020160: 6f69 6e74 2e20 5468 6520 6b65 7973 0a20  oint. The keys. 
-00020170: 2020 2020 2020 2020 2020 206f 6620 7468             of th
-00020180: 6973 2064 6963 7469 6f6e 6172 7920 7368  is dictionary sh
-00020190: 6f75 6c64 2065 7869 7374 2069 6e20 7468  ould exist in th
-000201a0: 6520 7461 7267 6574 2074 6162 6c65 2e20  e target table. 
-000201b0: 4e6f 7465 2074 6861 7420 7468 6520 7661  Note that the va
-000201c0: 6c75 6573 2073 686f 756c 6420 6265 2066  lues should be f
-000201d0: 726f 6d20 7479 7065 2073 7472 696e 6720  rom type string 
-000201e0: 6f72 2066 726f 6d0a 2020 2020 2020 2020  or from.        
-000201f0: 2020 2020 6120 7661 6c69 6420 6e75 6d65      a valid nume
-00020200: 7269 6361 6c20 7479 7065 2073 7563 6820  rical type such 
-00020210: 6173 2069 6e74 206f 7220 666c 6f61 742e  as int or float.
-00020220: 204d 6f72 6520 6465 7461 696c 7320 6162   More details ab
-00020230: 6f75 7420 7468 6520 6d6f 6465 6c20 656e  out the model en
-00020240: 6470 6f69 6e74 2061 7661 696c 6162 6c65  dpoint available
-00020250: 2061 7474 7269 6275 7465 7320 6361 6e0a   attributes can.
-00020260: 2020 2020 2020 2020 2020 2020 6265 2066              be f
-00020270: 6f75 6e64 2075 6e64 6572 203a 7079 3a63  ound under :py:c
-00020280: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
-00020290: 6d6f 6e2e 7363 6865 6d61 732e 4d6f 6465  mon.schemas.Mode
-000202a0: 6c45 6e64 706f 696e 7460 2e0a 0a20 2020  lEndpoint`...   
-000202b0: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
-000202c0: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
-000202d0: 6e65 7261 7465 2063 7572 7265 6e74 2073  nerate current s
-000202e0: 7461 7473 2066 6f72 2074 776f 2066 6561  tats for two fea
-000202f0: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-00020300: 2020 6375 7272 656e 745f 7374 6174 7320    current_stats 
-00020310: 3d20 7b27 7476 645f 7375 6d27 3a20 322e  = {'tvd_sum': 2.
-00020320: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
-00020330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020340: 2774 7664 5f6d 6561 6e27 3a20 302e 352c  'tvd_mean': 0.5,
-00020350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020360: 2020 2020 2020 2020 2020 2020 2020 2768                'h
-00020370: 656c 6c69 6e67 6572 5f73 756d 273a 2033  ellinger_sum': 3
-00020380: 2e36 2c0a 2020 2020 2020 2020 2020 2020  .6,.            
+0001fbe0: 2020 6027 6e6f 772d 5b30 2d39 5d2b 5b6d    `'now-[0-9]+[m
+0001fbf0: 6864 5d27 602c 2077 6865 7265 2060 6d60  hd]'`, where `m`
+0001fc00: 203d 206d 696e 7574 6573 2c20 6068 6020   = minutes, `h` 
+0001fc10: 3d20 686f 7572 732c 2061 6e64 2060 2764  = hours, and `'d
+0001fc20: 2760 203d 0a20 2020 2020 2020 2020 2020  '` =.           
+0001fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc40: 2020 2020 2020 6461 7973 292c 206f 7220        days), or 
+0001fc50: 3020 666f 7220 7468 6520 6561 726c 6965  0 for the earlie
+0001fc60: 7374 2074 696d 652e 0a20 2020 2020 2020  st time..       
+0001fc70: 203a 7061 7261 6d20 746f 705f 6c65 7665   :param top_leve
+0001fc80: 6c3a 2069 6620 7472 7565 2077 696c 6c20  l: if true will 
+0001fc90: 7265 7475 726e 206f 6e6c 7920 726f 7574  return only rout
+0001fca0: 6572 7320 616e 6420 656e 6470 6f69 6e74  ers and endpoint
+0001fcb0: 2074 6861 7420 6172 6520 4e4f 5420 6368   that are NOT ch
+0001fcc0: 696c 6472 656e 206f 6620 616e 7920 726f  ildren of any ro
+0001fcd0: 7574 6572 0a20 2020 2020 2020 203a 7061  uter.        :pa
+0001fce0: 7261 6d20 7569 6473 3a20 6966 2070 6173  ram uids: if pas
+0001fcf0: 7365 6420 7769 6c6c 2072 6574 7572 6e20  sed will return 
+0001fd00: 6120 6c69 7374 2060 4d6f 6465 6c45 6e64  a list `ModelEnd
+0001fd10: 706f 696e 7460 206f 626a 6563 7420 7769  point` object wi
+0001fd20: 7468 2075 6964 2069 6e20 7569 6473 0a20  th uid in uids. 
+0001fd30: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001fd40: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+0001fd50: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+0001fd60: 6d6f 6465 6c2d 656e 6470 6f69 6e74 7322  model-endpoints"
+0001fd70: 0a0a 2020 2020 2020 2020 6966 206c 6162  ..        if lab
+0001fd80: 656c 7320 616e 6420 6973 696e 7374 616e  els and isinstan
+0001fd90: 6365 286c 6162 656c 732c 2064 6963 7429  ce(labels, dict)
+0001fda0: 3a0a 2020 2020 2020 2020 2020 2020 6c61  :.            la
+0001fdb0: 6265 6c73 203d 205b 6622 7b6b 6579 7d3d  bels = [f"{key}=
+0001fdc0: 7b76 616c 7565 7d22 2066 6f72 206b 6579  {value}" for key
+0001fdd0: 2c20 7661 6c75 6520 696e 206c 6162 656c  , value in label
+0001fde0: 732e 6974 656d 7328 295d 0a0a 2020 2020  s.items()]..    
+0001fdf0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0001fe00: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001fe10: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001fe20: 3d22 4745 5422 2c0a 2020 2020 2020 2020  ="GET",.        
+0001fe30: 2020 2020 7061 7468 3d70 6174 682c 0a20      path=path,. 
+0001fe40: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0001fe50: 733d 7b0a 2020 2020 2020 2020 2020 2020  s={.            
+0001fe60: 2020 2020 226d 6f64 656c 223a 206d 6f64      "model": mod
+0001fe70: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0001fe80: 2020 2020 2266 756e 6374 696f 6e22 3a20      "function": 
+0001fe90: 6675 6e63 7469 6f6e 2c0a 2020 2020 2020  function,.      
+0001fea0: 2020 2020 2020 2020 2020 226c 6162 656c            "label
+0001feb0: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
+0001fec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fed0: 2022 7374 6172 7422 3a20 7374 6172 742c   "start": start,
+0001fee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fef0: 2022 656e 6422 3a20 656e 642c 0a20 2020   "end": end,.   
+0001ff00: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
+0001ff10: 7472 6963 223a 206d 6574 7269 6373 206f  tric": metrics o
+0001ff20: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
+0001ff30: 2020 2020 2020 2274 6f70 2d6c 6576 656c        "top-level
+0001ff40: 223a 2074 6f70 5f6c 6576 656c 2c0a 2020  ": top_level,.  
+0001ff50: 2020 2020 2020 2020 2020 2020 2020 2275                "u
+0001ff60: 6964 223a 2075 6964 732c 0a20 2020 2020  id": uids,.     
+0001ff70: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0001ff80: 2020 290a 0a20 2020 2020 2020 2023 2047    )..        # G
+0001ff90: 656e 6572 6174 6520 6120 6c69 7374 206f  enerate a list o
+0001ffa0: 6620 6120 6d6f 6465 6c20 656e 6470 6f69  f a model endpoi
+0001ffb0: 6e74 2064 6963 7469 6f6e 6172 6965 730a  nt dictionaries.
+0001ffc0: 2020 2020 2020 2020 6d6f 6465 6c5f 656e          model_en
+0001ffd0: 6470 6f69 6e74 7320 3d20 7265 7370 6f6e  dpoints = respon
+0001ffe0: 7365 2e6a 736f 6e28 295b 2265 6e64 706f  se.json()["endpo
+0001fff0: 696e 7473 225d 0a20 2020 2020 2020 2069  ints"].        i
+00020000: 6620 6d6f 6465 6c5f 656e 6470 6f69 6e74  f model_endpoint
+00020010: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00020020: 6574 7572 6e20 5b0a 2020 2020 2020 2020  eturn [.        
+00020030: 2020 2020 2020 2020 6d6c 7275 6e2e 6d6f          mlrun.mo
+00020040: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
+00020050: 6f64 656c 5f65 6e64 706f 696e 742e 4d6f  odel_endpoint.Mo
+00020060: 6465 6c45 6e64 706f 696e 742e 6672 6f6d  delEndpoint.from
+00020070: 5f64 6963 7428 6f62 6a29 0a20 2020 2020  _dict(obj).     
+00020080: 2020 2020 2020 2020 2020 2066 6f72 206f             for o
+00020090: 626a 2069 6e20 6d6f 6465 6c5f 656e 6470  bj in model_endp
+000200a0: 6f69 6e74 730a 2020 2020 2020 2020 2020  oints.          
+000200b0: 2020 5d0a 2020 2020 2020 2020 7265 7475    ].        retu
+000200c0: 726e 205b 5d0a 0a20 2020 2064 6566 2067  rn []..    def g
+000200d0: 6574 5f6d 6f64 656c 5f65 6e64 706f 696e  et_model_endpoin
+000200e0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+000200f0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00020100: 3a20 7374 722c 0a20 2020 2020 2020 2065  : str,.        e
+00020110: 6e64 706f 696e 745f 6964 3a20 7374 722c  ndpoint_id: str,
+00020120: 0a20 2020 2020 2020 2073 7461 7274 3a20  .        start: 
+00020130: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00020140: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
+00020150: 643a 204f 7074 696f 6e61 6c5b 7374 725d  d: Optional[str]
+00020160: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00020170: 206d 6574 7269 6373 3a20 4f70 7469 6f6e   metrics: Option
+00020180: 616c 5b6c 6973 745b 7374 725d 5d20 3d20  al[list[str]] = 
+00020190: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
+000201a0: 6174 7572 655f 616e 616c 7973 6973 3a20  ature_analysis: 
+000201b0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+000201c0: 2020 2920 2d3e 206d 6c72 756e 2e6d 6f64    ) -> mlrun.mod
+000201d0: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
+000201e0: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
+000201f0: 656c 456e 6470 6f69 6e74 3a0a 2020 2020  elEndpoint:.    
+00020200: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00020210: 5265 7475 726e 7320 6120 7369 6e67 6c65  Returns a single
+00020220: 2060 4d6f 6465 6c45 6e64 706f 696e 7460   `ModelEndpoint`
+00020230: 206f 626a 6563 7420 7769 7468 2061 6464   object with add
+00020240: 6974 696f 6e61 6c20 6d65 7472 6963 7320  itional metrics 
+00020250: 616e 6420 6665 6174 7572 6520 7265 6c61  and feature rela
+00020260: 7465 6420 6461 7461 2e0a 0a20 2020 2020  ted data...     
+00020270: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00020280: 743a 2020 2020 2020 2020 2020 2020 2020  t:              
+00020290: 2020 2020 2020 5468 6520 6e61 6d65 206f        The name o
+000202a0: 6620 7468 6520 7072 6f6a 6563 740a 2020  f the project.  
+000202b0: 2020 2020 2020 3a70 6172 616d 2065 6e64        :param end
+000202c0: 706f 696e 745f 6964 3a20 2020 2020 2020  point_id:       
+000202d0: 2020 2020 2020 2020 2054 6865 2075 6e69           The uni
+000202e0: 7175 6520 6964 206f 6620 7468 6520 6d6f  que id of the mo
+000202f0: 6465 6c20 656e 6470 6f69 6e74 2e0a 2020  del endpoint..  
+00020300: 2020 2020 2020 3a70 6172 616d 2073 7461        :param sta
+00020310: 7274 3a20 2020 2020 2020 2020 2020 2020  rt:             
+00020320: 2020 2020 2020 2020 2054 6865 2073 7461           The sta
+00020330: 7274 2074 696d 6520 6f66 2074 6865 206d  rt time of the m
+00020340: 6574 7269 6373 2e20 4361 6e20 6265 2072  etrics. Can be r
+00020350: 6570 7265 7365 6e74 6564 2062 7920 6120  epresented by a 
+00020360: 7374 7269 6e67 2063 6f6e 7461 696e 696e  string containin
+00020370: 6720 616e 0a20 2020 2020 2020 2020 2020  g an.           
+00020380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203a0: 2027 6865 6c6c 696e 6765 725f 6d65 616e   'hellinger_mean
-000203b0: 273a 2030 2e39 2c0a 2020 2020 2020 2020  ': 0.9,.        
-000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203d0: 2020 2020 2027 6b6c 645f 7375 6d27 3a20       'kld_sum': 
-000203e0: 3234 2e32 2c0a 2020 2020 2020 2020 2020  24.2,.          
+000203a0: 5246 4320 3333 3339 2074 696d 652c 2061  RFC 3339 time, a
+000203b0: 2055 6e69 7820 7469 6d65 7374 616d 7020   Unix timestamp 
+000203c0: 696e 206d 696c 6c69 7365 636f 6e64 732c  in milliseconds,
+000203d0: 2061 2072 656c 6174 6976 6520 7469 6d65   a relative time
+000203e0: 2028 6027 6e6f 7727 6020 6f72 0a20 2020   (`'now'` or.   
 000203f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020400: 2020 2027 6b6c 645f 6d65 616e 273a 2036     'kld_mean': 6
-00020410: 2e30 2c0a 2020 2020 2020 2020 2020 2020  .0,.            
-00020420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020430: 2027 6631 273a 207b 2774 7664 273a 2030   'f1': {'tvd': 0
-00020440: 2e35 2c20 2768 656c 6c69 6e67 6572 273a  .5, 'hellinger':
-00020450: 2031 2e30 2c20 276b 6c64 273a 2036 2e34   1.0, 'kld': 6.4
-00020460: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00020400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020410: 2020 2020 2020 2020 6027 6e6f 772d 5b30          `'now-[0
+00020420: 2d39 5d2b 5b6d 6864 5d27 602c 2077 6865  -9]+[mhd]'`, whe
+00020430: 7265 2060 6d60 203d 206d 696e 7574 6573  re `m` = minutes
+00020440: 2c20 6068 6020 3d20 686f 7572 732c 2061  , `h` = hours, a
+00020450: 6e64 2060 2764 2760 203d 2064 6179 7329  nd `'d'` = days)
+00020460: 2c20 6f72 0a20 2020 2020 2020 2020 2020  , or.           
 00020470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020480: 2766 3227 3a20 7b27 7476 6427 3a20 302e  'f2': {'tvd': 0.
-00020490: 352c 2027 6865 6c6c 696e 6765 7227 3a20  5, 'hellinger': 
-000204a0: 312e 302c 2027 6b6c 6427 3a20 362e 357d  1.0, 'kld': 6.5}
-000204b0: 7d0a 0a20 2020 2020 2020 2020 2020 2023  }..            #
-000204c0: 2043 7265 6174 6520 6174 7472 6962 7574   Create attribut
-000204d0: 6573 2064 6963 7469 6f6e 6172 7920 6163  es dictionary ac
-000204e0: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
-000204f0: 6571 7569 7265 6420 666f 726d 6174 0a20  equired format. 
-00020500: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00020510: 6275 7465 7320 3d20 7b60 6375 7272 656e  butes = {`curren
-00020520: 745f 7374 6174 7360 3a20 6a73 6f6e 2e64  t_stats`: json.d
-00020530: 756d 7073 2863 7572 7265 6e74 5f73 7461  umps(current_sta
-00020540: 7473 292c 0a20 2020 2020 2020 2020 2020  ts),.           
-00020550: 2020 2020 2020 2020 2020 2020 2020 2060                 `
-00020560: 6472 6966 745f 7374 6174 7573 603a 2022  drift_status`: "
-00020570: 4452 4946 545f 4445 5445 4354 4544 227d  DRIFT_DETECTED"}
-00020580: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00020590: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-000205a0: 7320 3d20 7b22 6174 7472 6962 7574 6573  s = {"attributes
-000205b0: 223a 205f 6173 5f6a 736f 6e28 6174 7472  ": _as_json(attr
-000205c0: 6962 7574 6573 297d 0a20 2020 2020 2020  ibutes)}.       
-000205d0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-000205e0: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
-000205f0: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
-00020600: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
-00020610: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-00020620: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
-00020630: 6574 686f 643d 2250 4154 4348 222c 0a20  ethod="PATCH",. 
-00020640: 2020 2020 2020 2020 2020 2070 6174 683d             path=
-00020650: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-00020660: 2020 7061 7261 6d73 3d61 7474 7269 6275    params=attribu
-00020670: 7465 732c 0a20 2020 2020 2020 2029 0a0a  tes,.        )..
-00020680: 2020 2020 6465 6620 7570 6461 7465 5f6d      def update_m
-00020690: 6f64 656c 5f6d 6f6e 6974 6f72 696e 675f  odel_monitoring_
-000206a0: 636f 6e74 726f 6c6c 6572 280a 2020 2020  controller(.    
-000206b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000206c0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-000206d0: 2020 2020 2020 2020 6261 7365 5f70 6572          base_per
-000206e0: 696f 643a 2069 6e74 203d 2031 302c 0a20  iod: int = 10,. 
-000206f0: 2020 2020 2020 2069 6d61 6765 3a20 7374         image: st
-00020700: 7220 3d20 226d 6c72 756e 2f6d 6c72 756e  r = "mlrun/mlrun
-00020710: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
-00020720: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00020730: 6465 706c 6f79 206d 6f64 656c 206d 6f6e  deploy model mon
-00020740: 6974 6f72 696e 6720 6170 706c 6963 6174  itoring applicat
-00020750: 696f 6e20 636f 6e74 726f 6c6c 6572 2066  ion controller f
-00020760: 756e 6374 696f 6e2e 0a0a 2020 2020 2020  unction...      
-00020770: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00020780: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
-00020790: 2020 2050 726f 6a65 6374 206e 616d 652e     Project name.
-000207a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-000207b0: 6261 7365 5f70 6572 696f 643a 2020 2020  base_period:    
-000207c0: 2020 2020 2020 2020 2020 5468 6520 7469            The ti
-000207d0: 6d65 2070 6572 696f 6420 696e 206d 696e  me period in min
-000207e0: 7574 6573 2069 6e20 7768 6963 6820 7468  utes in which th
-000207f0: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
-00020800: 6e67 2063 6f6e 7472 6f6c 6c65 7220 6675  ng controller fu
-00020810: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00020480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020490: 3020 666f 7220 7468 6520 6561 726c 6965  0 for the earlie
+000204a0: 7374 2074 696d 652e 0a20 2020 2020 2020  st time..       
+000204b0: 203a 7061 7261 6d20 656e 643a 2020 2020   :param end:    
+000204c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204d0: 2020 2020 5468 6520 656e 6420 7469 6d65      The end time
+000204e0: 206f 6620 7468 6520 6d65 7472 6963 732e   of the metrics.
+000204f0: 2043 616e 2062 6520 7265 7072 6573 656e   Can be represen
+00020500: 7465 6420 6279 2061 2073 7472 696e 6720  ted by a string 
+00020510: 636f 6e74 6169 6e69 6e67 2061 6e0a 2020  containing an.  
+00020520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020540: 2020 2020 2020 2020 2052 4643 2033 3333           RFC 333
+00020550: 3920 7469 6d65 2c20 6120 556e 6978 2074  9 time, a Unix t
+00020560: 696d 6573 7461 6d70 2069 6e20 6d69 6c6c  imestamp in mill
+00020570: 6973 6563 6f6e 6473 2c20 6120 7265 6c61  iseconds, a rela
+00020580: 7469 7665 2074 696d 6520 2860 276e 6f77  tive time (`'now
+00020590: 2760 206f 720a 2020 2020 2020 2020 2020  '` or.          
+000205a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000205b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000205c0: 2060 276e 6f77 2d5b 302d 395d 2b5b 6d68   `'now-[0-9]+[mh
+000205d0: 645d 2760 2c20 7768 6572 6520 606d 6020  d]'`, where `m` 
+000205e0: 3d20 6d69 6e75 7465 732c 2060 6860 203d  = minutes, `h` =
+000205f0: 2068 6f75 7273 2c20 616e 6420 6027 6427   hours, and `'d'
+00020600: 6020 3d20 6461 7973 292c 206f 720a 2020  ` = days), or.  
+00020610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020630: 2020 2020 2020 2020 2030 2066 6f72 2074           0 for t
+00020640: 6865 2065 6172 6c69 6573 7420 7469 6d65  he earliest time
+00020650: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00020660: 206d 6574 7269 6373 3a20 2020 2020 2020   metrics:       
+00020670: 2020 2020 2020 2020 2020 2020 2041 206c               A l
+00020680: 6973 7420 6f66 206d 6574 7269 6373 2074  ist of metrics t
+00020690: 6f20 7265 7475 726e 2066 6f72 2074 6865  o return for the
+000206a0: 206d 6f64 656c 2065 6e64 706f 696e 742e   model endpoint.
+000206b0: 2054 6865 7265 2061 7265 2070 7265 2d64   There are pre-d
+000206c0: 6566 696e 6564 0a20 2020 2020 2020 2020  efined.         
+000206d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000206e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000206f0: 2020 6d65 7472 6963 7320 666f 7220 6d6f    metrics for mo
+00020700: 6465 6c20 656e 6470 6f69 6e74 7320 7375  del endpoints su
+00020710: 6368 2061 7320 7072 6564 6963 7469 6f6e  ch as prediction
+00020720: 735f 7065 725f 7365 636f 6e64 2061 6e64  s_per_second and
+00020730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020750: 2020 2020 2020 2020 2020 2020 6c61 7465              late
+00020760: 6e63 795f 6176 675f 356d 2062 7574 2061  ncy_avg_5m but a
+00020770: 6c73 6f20 6375 7374 6f6d 206d 6574 7269  lso custom metri
+00020780: 6373 2064 6566 696e 6564 2062 7920 7468  cs defined by th
+00020790: 6520 7573 6572 2e20 506c 6561 7365 206e  e user. Please n
+000207a0: 6f74 6520 7468 6174 0a20 2020 2020 2020  ote that.       
+000207b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000207c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000207d0: 2020 2020 7468 6573 6520 6d65 7472 6963      these metric
+000207e0: 7320 6172 6520 7374 6f72 6564 2069 6e20  s are stored in 
+000207f0: 7468 6520 7469 6d65 2073 6572 6965 7320  the time series 
+00020800: 4442 2061 6e64 2074 6865 2072 6573 756c  DB and the resul
+00020810: 7473 2077 696c 6c20 6265 0a20 2020 2020  ts will be.     
 00020820: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00020830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020840: 7472 6967 6765 7273 2e20 4279 2064 6566  triggers. By def
-00020850: 6175 6c74 2c20 7468 6520 6261 7365 2070  ault, the base p
-00020860: 6572 696f 6420 6973 2031 3020 6d69 6e75  eriod is 10 minu
-00020870: 7465 732e 0a20 2020 2020 2020 203a 7061  tes..        :pa
-00020880: 7261 6d20 696d 6167 653a 2054 6865 2069  ram image: The i
-00020890: 6d61 6765 206f 6620 7468 6520 6d6f 6465  mage of the mode
-000208a0: 6c20 6d6f 6e69 746f 7269 6e67 2063 6f6e  l monitoring con
-000208b0: 7472 6f6c 6c65 7220 6675 6e63 7469 6f6e  troller function
-000208c0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000208e0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
-000208f0: 6661 756c 742c 2074 6865 2069 6d61 6765  fault, the image
-00020900: 2069 7320 6d6c 7275 6e2f 6d6c 7275 6e2e   is mlrun/mlrun.
-00020910: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00020920: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00020930: 0a20 2020 2020 2020 2020 2020 2022 696d  .            "im
-00020940: 6167 6522 3a20 696d 6167 652c 0a20 2020  age": image,.   
-00020950: 2020 2020 2020 2020 2022 6261 7365 5f70           "base_p
-00020960: 6572 696f 6422 3a20 6261 7365 5f70 6572  eriod": base_per
-00020970: 696f 642c 0a20 2020 2020 2020 207d 0a20  iod,.        }. 
-00020980: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00020990: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000209a0: 747d 2f6d 6f64 656c 2d6d 6f6e 6974 6f72  t}/model-monitor
-000209b0: 696e 672f 6d6f 6465 6c2d 6d6f 6e69 746f  ing/model-monito
-000209c0: 7269 6e67 2d63 6f6e 7472 6f6c 6c65 7222  ring-controller"
-000209d0: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-000209e0: 695f 6361 6c6c 286d 6574 686f 643d 2250  i_call(method="P
-000209f0: 4f53 5422 2c20 7061 7468 3d70 6174 682c  OST", path=path,
-00020a00: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
-00020a10: 0a20 2020 2064 6566 2065 6e61 626c 655f  .    def enable_
-00020a20: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
-00020a30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00020a40: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-00020a50: 2073 7472 2c0a 2020 2020 2020 2020 6261   str,.        ba
-00020a60: 7365 5f70 6572 696f 643a 2069 6e74 203d  se_period: int =
-00020a70: 2031 302c 0a20 2020 2020 2020 2069 6d61   10,.        ima
-00020a80: 6765 3a20 7374 7220 3d20 226d 6c72 756e  ge: str = "mlrun
-00020a90: 2f6d 6c72 756e 222c 0a20 2020 2020 2020  /mlrun",.       
-00020aa0: 2064 6570 6c6f 795f 6869 7374 6f67 7261   deploy_histogra
-00020ab0: 6d5f 6461 7461 5f64 7269 6674 5f61 7070  m_data_drift_app
-00020ac0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
-00020ad0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00020ae0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020af0: 2020 4465 706c 6f79 206d 6f64 656c 206d    Deploy model m
-00020b00: 6f6e 6974 6f72 696e 6720 6170 706c 6963  onitoring applic
-00020b10: 6174 696f 6e20 636f 6e74 726f 6c6c 6572  ation controller
-00020b20: 2c20 7772 6974 6572 2061 6e64 2073 7472  , writer and str
-00020b30: 6561 6d20 6675 6e63 7469 6f6e 732e 0a20  eam functions.. 
-00020b40: 2020 2020 2020 2057 6869 6c65 2074 6865         While the
-00020b50: 206d 6169 6e20 676f 616c 206f 6620 7468   main goal of th
-00020b60: 6520 636f 6e74 726f 6c6c 6572 2066 756e  e controller fun
-00020b70: 6374 696f 6e20 6973 2074 6f20 6861 6e64  ction is to hand
-00020b80: 6c65 2074 6865 206d 6f6e 6974 6f72 696e  le the monitorin
-00020b90: 6720 7072 6f63 6573 7369 6e67 2061 6e64  g processing and
-00020ba0: 2074 7269 6767 6572 696e 670a 2020 2020   triggering.    
-00020bb0: 2020 2020 6170 706c 6963 6174 696f 6e73      applications
-00020bc0: 2c20 7468 6520 676f 616c 206f 6620 7468  , the goal of th
-00020bd0: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
-00020be0: 6e67 2077 7269 7465 7220 6675 6e63 7469  ng writer functi
-00020bf0: 6f6e 2069 7320 746f 2077 7269 7465 2061  on is to write a
-00020c00: 6c6c 2074 6865 206d 6f6e 6974 6f72 696e  ll the monitorin
-00020c10: 670a 2020 2020 2020 2020 6170 706c 6963  g.        applic
-00020c20: 6174 696f 6e20 7265 7375 6c74 7320 746f  ation results to
-00020c30: 2074 6865 2064 6174 6162 6173 6573 2e0a   the databases..
-00020c40: 2020 2020 2020 2020 5468 6520 7374 7265          The stre
-00020c50: 616d 2066 756e 6374 696f 6e20 676f 616c  am function goal
-00020c60: 2069 7320 746f 206d 6f6e 6974 6f72 2074   is to monitor t
-00020c70: 6865 206c 6f67 206f 6620 7468 6520 6461  he log of the da
-00020c80: 7461 2073 7472 6561 6d2e 2049 7420 6973  ta stream. It is
-00020c90: 2074 7269 6767 6572 6564 2077 6865 6e20   triggered when 
-00020ca0: 6120 6e65 7720 6c6f 6720 656e 7472 790a  a new log entry.
-00020cb0: 2020 2020 2020 2020 6973 2064 6574 6563          is detec
-00020cc0: 7465 642e 2049 7420 7072 6f63 6573 7365  ted. It processe
-00020cd0: 7320 7468 6520 6e65 7720 6576 656e 7473  s the new events
-00020ce0: 2069 6e74 6f20 7374 6174 6973 7469 6373   into statistics
-00020cf0: 2074 6861 7420 6172 6520 7468 656e 2077   that are then w
-00020d00: 7269 7474 656e 2074 6f20 7374 6174 6973  ritten to statis
-00020d10: 7469 6373 2064 6174 6162 6173 6573 2e0a  tics databases..
-00020d20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00020d30: 7072 6f6a 6563 743a 2020 2020 2050 726f  project:     Pro
-00020d40: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
-00020d50: 2020 203a 7061 7261 6d20 6261 7365 5f70     :param base_p
-00020d60: 6572 696f 643a 2054 6865 2074 696d 6520  eriod: The time 
-00020d70: 7065 7269 6f64 2069 6e20 6d69 6e75 7465  period in minute
-00020d80: 7320 696e 2077 6869 6368 2074 6865 206d  s in which the m
-00020d90: 6f64 656c 206d 6f6e 6974 6f72 696e 6720  odel monitoring 
-00020da0: 636f 6e74 726f 6c6c 6572 2066 756e 6374  controller funct
-00020db0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00020dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020dd0: 7472 6967 6765 7273 2e20 4279 2064 6566  triggers. By def
-00020de0: 6175 6c74 2c20 7468 6520 6261 7365 2070  ault, the base p
-00020df0: 6572 696f 6420 6973 2031 3020 6d69 6e75  eriod is 10 minu
-00020e00: 7465 732e 0a20 2020 2020 2020 203a 7061  tes..        :pa
-00020e10: 7261 6d20 696d 6167 653a 2020 2020 2020  ram image:      
-00020e20: 2054 6865 2069 6d61 6765 206f 6620 7468   The image of th
-00020e30: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
-00020e40: 6e67 2063 6f6e 7472 6f6c 6c65 722c 2077  ng controller, w
-00020e50: 7269 7465 7220 2620 6d6f 6e69 746f 7269  riter & monitori
-00020e60: 6e67 0a20 2020 2020 2020 2020 2020 2020  ng.             
-00020e70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020e80: 7472 6561 6d20 6675 6e63 7469 6f6e 732c  tream functions,
-00020e90: 2077 6869 6368 2061 7265 2072 6561 6c20   which are real 
-00020ea0: 7469 6d65 206e 7563 6c69 6f20 6675 6e63  time nuclio func
-00020eb0: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-00020ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ed0: 2020 2042 7920 6465 6661 756c 742c 2074     By default, t
-00020ee0: 6865 2069 6d61 6765 2069 7320 6d6c 7275  he image is mlru
-00020ef0: 6e2f 6d6c 7275 6e2e 0a20 2020 2020 2020  n/mlrun..       
-00020f00: 203a 7061 7261 6d20 6465 706c 6f79 5f68   :param deploy_h
-00020f10: 6973 746f 6772 616d 5f64 6174 615f 6472  istogram_data_dr
-00020f20: 6966 745f 6170 703a 2049 6620 7472 7565  ift_app: If true
-00020f30: 2c20 6465 706c 6f79 2074 6865 2064 6566  , deploy the def
-00020f40: 6175 6c74 2068 6973 746f 6772 616d 2d62  ault histogram-b
-00020f50: 6173 6564 2064 6174 6120 6472 6966 7420  ased data drift 
-00020f60: 6170 706c 6963 6174 696f 6e2e 0a20 2020  application..   
-00020f70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00020f80: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00020f90: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00020fa0: 6f64 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  od=mlrun.common.
-00020fb0: 7479 7065 732e 4854 5450 4d65 7468 6f64  types.HTTPMethod
-00020fc0: 2e50 4f53 542c 0a20 2020 2020 2020 2020  .POST,.         
-00020fd0: 2020 2070 6174 683d 6622 7072 6f6a 6563     path=f"projec
-00020fe0: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
-00020ff0: 656c 2d6d 6f6e 6974 6f72 696e 672f 656e  el-monitoring/en
-00021000: 6162 6c65 2d6d 6f64 656c 2d6d 6f6e 6974  able-model-monit
-00021010: 6f72 696e 6722 2c0a 2020 2020 2020 2020  oring",.        
-00021020: 2020 2020 7061 7261 6d73 3d7b 0a20 2020      params={.   
-00021030: 2020 2020 2020 2020 2020 2020 2022 6261               "ba
-00021040: 7365 5f70 6572 696f 6422 3a20 6261 7365  se_period": base
-00021050: 5f70 6572 696f 642c 0a20 2020 2020 2020  _period,.       
-00021060: 2020 2020 2020 2020 2022 696d 6167 6522           "image"
-00021070: 3a20 696d 6167 652c 0a20 2020 2020 2020  : image,.       
-00021080: 2020 2020 2020 2020 2022 6465 706c 6f79           "deploy
-00021090: 5f68 6973 746f 6772 616d 5f64 6174 615f  _histogram_data_
-000210a0: 6472 6966 745f 6170 7022 3a20 6465 706c  drift_app": depl
-000210b0: 6f79 5f68 6973 746f 6772 616d 5f64 6174  oy_histogram_dat
-000210c0: 615f 6472 6966 745f 6170 702c 0a20 2020  a_drift_app,.   
-000210d0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-000210e0: 2020 2020 290a 0a20 2020 2064 6566 2064      )..    def d
-000210f0: 6570 6c6f 795f 6869 7374 6f67 7261 6d5f  eploy_histogram_
-00021100: 6461 7461 5f64 7269 6674 5f61 7070 280a  data_drift_app(.
-00021110: 2020 2020 2020 2020 7365 6c66 2c20 7072          self, pr
-00021120: 6f6a 6563 743a 2073 7472 2c20 696d 6167  oject: str, imag
-00021130: 653a 2073 7472 203d 2022 6d6c 7275 6e2f  e: str = "mlrun/
-00021140: 6d6c 7275 6e22 0a20 2020 2029 202d 3e20  mlrun".    ) -> 
-00021150: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-00021160: 220a 2020 2020 2020 2020 4465 706c 6f79  ".        Deploy
-00021170: 2074 6865 2068 6973 746f 6772 616d 2064   the histogram d
-00021180: 6174 6120 6472 6966 7420 6170 706c 6963  ata drift applic
-00021190: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-000211a0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-000211b0: 5072 6f6a 6563 7420 6e61 6d65 2e0a 2020  Project name..  
-000211c0: 2020 2020 2020 3a70 6172 616d 2069 6d61        :param ima
-000211d0: 6765 3a20 2020 5468 6520 696d 6167 6520  ge:   The image 
-000211e0: 6f6e 2077 6869 6368 2074 6865 2061 7070  on which the app
-000211f0: 6c69 6361 7469 6f6e 2077 696c 6c20 7275  lication will ru
-00021200: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
-00021210: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00021220: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-00021230: 2020 6d65 7468 6f64 3d6d 6c72 756e 2e63    method=mlrun.c
-00021240: 6f6d 6d6f 6e2e 7479 7065 732e 4854 5450  ommon.types.HTTP
-00021250: 4d65 7468 6f64 2e50 4f53 542c 0a20 2020  Method.POST,.   
-00021260: 2020 2020 2020 2020 2070 6174 683d 6622           path=f"
-00021270: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00021280: 747d 2f6d 6f64 656c 2d6d 6f6e 6974 6f72  t}/model-monitor
-00021290: 696e 672f 6465 706c 6f79 2d68 6973 746f  ing/deploy-histo
-000212a0: 6772 616d 2d64 6174 612d 6472 6966 742d  gram-data-drift-
-000212b0: 6170 7022 2c0a 2020 2020 2020 2020 2020  app",.          
-000212c0: 2020 7061 7261 6d73 3d7b 2269 6d61 6765    params={"image
-000212d0: 223a 2069 6d61 6765 7d2c 0a20 2020 2020  ": image},.     
-000212e0: 2020 2029 0a0a 2020 2020 6465 6620 6372     )..    def cr
-000212f0: 6561 7465 5f68 7562 5f73 6f75 7263 6528  eate_hub_source(
-00021300: 0a20 2020 2020 2020 2073 656c 662c 2073  .        self, s
-00021310: 6f75 7263 653a 2055 6e69 6f6e 5b64 6963  ource: Union[dic
-00021320: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00021330: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
-00021340: 7562 536f 7572 6365 5d0a 2020 2020 293a  ubSource].    ):
-00021350: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00021360: 2020 2020 2041 6464 2061 206e 6577 2068       Add a new h
-00021370: 7562 2073 6f75 7263 652e 0a0a 2020 2020  ub source...    
-00021380: 2020 2020 4d4c 5275 6e20 6d61 696e 7461      MLRun mainta
-00021390: 696e 7320 616e 206f 7264 6572 6564 206c  ins an ordered l
-000213a0: 6973 7420 6f66 2068 7562 2073 6f75 7263  ist of hub sourc
-000213b0: 6573 2028 e280 9c73 6f75 7263 6573 e280  es (...sources..
-000213c0: 9d29 2045 6163 6820 736f 7572 6365 2068  .) Each source h
-000213d0: 6173 0a20 2020 2020 2020 2069 7473 2064  as.        its d
-000213e0: 6574 6169 6c73 2072 6567 6973 7465 7265  etails registere
-000213f0: 6420 616e 6420 6974 7320 6f72 6465 7220  d and its order 
-00021400: 7769 7468 696e 2074 6865 206c 6973 742e  within the list.
-00021410: 2057 6865 6e20 6372 6561 7469 6e67 2061   When creating a
-00021420: 206e 6577 2073 6f75 7263 652c 2074 6865   new source, the
-00021430: 2073 7065 6369 616c 206f 7264 6572 2060   special order `
-00021440: 602d 3160 600a 2020 2020 2020 2020 6361  `-1``.        ca
-00021450: 6e20 6265 2075 7365 6420 746f 206d 6172  n be used to mar
-00021460: 6b20 7468 6973 2073 6f75 7263 6520 6173  k this source as
-00021470: 206c 6173 7420 696e 2074 6865 206c 6973   last in the lis
-00021480: 742e 2048 6f77 6576 6572 2c20 6f6e 6365  t. However, once
-00021490: 2074 6865 2073 6f75 7263 6520 6973 2069   the source is i
-000214a0: 6e20 7468 6520 4d4c 5275 6e20 6c69 7374  n the MLRun list
-000214b0: 2c0a 2020 2020 2020 2020 6974 7320 6f72  ,.        its or
-000214c0: 6465 7220 7769 6c6c 2061 6c77 6179 7320  der will always 
-000214d0: 6265 2060 603e 3060 602e 0a0a 2020 2020  be ``>0``...    
-000214e0: 2020 2020 5468 6520 676c 6f62 616c 2068      The global h
-000214f0: 7562 2073 6f75 7263 6520 616c 7761 7973  ub source always
-00021500: 2065 7869 7374 7320 696e 2074 6865 206c   exists in the l
-00021510: 6973 742c 2061 6e64 2069 7320 616c 7761  ist, and is alwa
-00021520: 7973 2074 6865 206c 6173 7420 736f 7572  ys the last sour
-00021530: 6365 0a20 2020 2020 2020 2028 6060 6f72  ce.        (``or
-00021540: 6465 7220 3d20 2d31 6060 292e 2049 7420  der = -1``). It 
-00021550: 6361 6e6e 6f74 2062 6520 6d6f 6469 6669  cannot be modifi
-00021560: 6564 206e 6f72 2063 616e 2069 7420 6265  ed nor can it be
-00021570: 206d 6f76 6564 2074 6f20 616e 6f74 6865   moved to anothe
-00021580: 7220 6f72 6465 7220 696e 2074 6865 206c  r order in the l
-00021590: 6973 742e 0a0a 2020 2020 2020 2020 5468  ist...        Th
-000215a0: 6520 736f 7572 6365 206f 626a 6563 7420  e source object 
-000215b0: 6d61 7920 636f 6e74 6169 6e20 6372 6564  may contain cred
-000215c0: 656e 7469 616c 7320 7768 6963 6820 6172  entials which ar
-000215d0: 6520 6e65 6564 6564 2074 6f20 6163 6365  e needed to acce
-000215e0: 7373 2074 6865 2064 6174 6173 746f 7265  ss the datastore
-000215f0: 2077 6865 7265 2074 6865 2073 6f75 7263   where the sourc
-00021600: 6520 6973 2073 746f 7265 642e 0a20 2020  e is stored..   
-00021610: 2020 2020 2054 6865 7365 2063 7265 6465       These crede
-00021620: 6e74 6961 6c73 2061 7265 206e 6f74 206b  ntials are not k
-00021630: 6570 7420 696e 2074 6865 204d 4c52 756e  ept in the MLRun
-00021640: 2044 422c 2062 7574 2061 7265 2073 746f   DB, but are sto
-00021650: 7265 6420 696e 7369 6465 2061 206b 7562  red inside a kub
-00021660: 6572 6e65 7465 7320 7365 6372 6574 206f  ernetes secret o
-00021670: 626a 6563 7420 6d61 696e 7461 696e 6564  bject maintained
-00021680: 2062 790a 2020 2020 2020 2020 4d4c 5275   by.        MLRu
-00021690: 6e2e 2054 6865 7920 6172 6520 6e6f 7420  n. They are not 
-000216a0: 7265 7475 726e 6564 2074 6872 6f75 6768  returned through
-000216b0: 2061 6e79 2041 5049 2066 726f 6d20 4d4c   any API from ML
-000216c0: 5275 6e2e 0a0a 2020 2020 2020 2020 4578  Run...        Ex
-000216d0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-000216e0: 2020 2020 2069 6d70 6f72 7420 6d6c 7275       import mlru
-000216f0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00021700: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00021710: 4164 6420 6120 7072 6976 6174 6520 736f  Add a private so
-00021720: 7572 6365 2061 7320 7468 6520 6c61 7374  urce as the last
-00021730: 206f 6e65 2028 7769 6c6c 2062 6520 2331   one (will be #1
-00021740: 2069 6e20 7468 6520 6c69 7374 290a 2020   in the list).  
-00021750: 2020 2020 2020 2020 2020 7072 6976 6174            privat
-00021760: 655f 736f 7572 6365 203d 206d 6c72 756e  e_source = mlrun
-00021770: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00021780: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
-00021790: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000217a0: 2020 6f72 6465 723d 2d31 2c0a 2020 2020    order=-1,.    
-000217b0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-000217c0: 6365 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  ce=mlrun.common.
-000217d0: 7363 6865 6d61 732e 4875 6253 6f75 7263  schemas.HubSourc
-000217e0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-000217f0: 2020 2020 2020 206d 6574 6164 6174 613d         metadata=
-00021800: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00021810: 656d 6173 2e48 7562 4f62 6a65 6374 4d65  emas.HubObjectMe
-00021820: 7461 6461 7461 280a 2020 2020 2020 2020  tadata(.        
-00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021840: 6e61 6d65 3d22 7072 6976 222c 2064 6573  name="priv", des
-00021850: 6372 6970 7469 6f6e 3d22 6120 7072 6976  cription="a priv
-00021860: 6174 6520 736f 7572 6365 220a 2020 2020  ate source".    
-00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021880: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00021890: 2020 2020 2020 2073 7065 633d 6d6c 7275         spec=mlru
-000218a0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-000218b0: 2e48 7562 536f 7572 6365 5370 6563 2870  .HubSourceSpec(p
-000218c0: 6174 683d 222f 6c6f 6361 6c2f 7061 7468  ath="/local/path
-000218d0: 2f74 6f2f 736f 7572 6365 222c 2063 6861  /to/source", cha
-000218e0: 6e6e 656c 3d22 6465 7665 6c6f 706d 656e  nnel="developmen
-000218f0: 7422 290a 2020 2020 2020 2020 2020 2020  t").            
-00021900: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00021910: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021920: 6462 2e63 7265 6174 655f 6875 625f 736f  db.create_hub_so
-00021930: 7572 6365 2870 7269 7661 7465 5f73 6f75  urce(private_sou
-00021940: 7263 6529 0a0a 2020 2020 2020 2020 2020  rce)..          
-00021950: 2020 2320 4164 6420 616e 6f74 6865 7220    # Add another 
-00021960: 736f 7572 6365 2061 7320 3173 7420 696e  source as 1st in
-00021970: 2074 6865 206c 6973 7420 2d20 7769 6c6c   the list - will
-00021980: 2070 7573 6820 7072 6576 696f 7573 206f   push previous o
-00021990: 6e65 2074 6f20 6265 2023 320a 2020 2020  ne to be #2.    
-000219a0: 2020 2020 2020 2020 616e 6f74 6865 725f          another_
-000219b0: 736f 7572 6365 203d 206d 6c72 756e 2e63  source = mlrun.c
-000219c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
-000219d0: 6465 7865 6448 7562 536f 7572 6365 280a  dexedHubSource(.
+00020840: 2020 2020 2020 6170 7065 6172 6564 2075        appeared u
+00020850: 6e64 6572 206d 6f64 656c 5f65 6e64 706f  nder model_endpo
+00020860: 696e 742e 7370 6563 2e6d 6574 7269 6373  int.spec.metrics
+00020870: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00020880: 2066 6561 7475 7265 5f61 6e61 6c79 7369   feature_analysi
+00020890: 733a 2020 2020 2020 2020 2020 2057 6865  s:           Whe
+000208a0: 6e20 5472 7565 2c20 7468 6520 6261 7365  n True, the base
+000208b0: 2066 6561 7475 7265 2073 7461 7469 7374   feature statist
+000208c0: 6963 7320 616e 6420 6375 7272 656e 7420  ics and current 
+000208d0: 6665 6174 7572 6520 7374 6174 6973 7469  feature statisti
+000208e0: 6373 2077 696c 6c0a 2020 2020 2020 2020  cs will.        
+000208f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020910: 2020 2062 6520 6164 6465 6420 746f 2074     be added to t
+00020920: 6865 206f 7574 7075 7420 6f66 2074 6865  he output of the
+00020930: 2072 6573 756c 7469 6e67 206f 626a 6563   resulting objec
+00020940: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
+00020950: 7572 6e3a 2041 2060 4d6f 6465 6c45 6e64  urn: A `ModelEnd
+00020960: 706f 696e 7460 206f 626a 6563 742e 0a20  point` object.. 
+00020970: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00020980: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00020990: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+000209a0: 6d6f 6465 6c2d 656e 6470 6f69 6e74 732f  model-endpoints/
+000209b0: 7b65 6e64 706f 696e 745f 6964 7d22 0a20  {endpoint_id}". 
+000209c0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+000209d0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+000209e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+000209f0: 686f 643d 2247 4554 222c 0a20 2020 2020  hod="GET",.     
+00020a00: 2020 2020 2020 2070 6174 683d 7061 7468         path=path
+00020a10: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+00020a20: 7261 6d73 3d7b 0a20 2020 2020 2020 2020  rams={.         
+00020a30: 2020 2020 2020 2022 7374 6172 7422 3a20         "start": 
+00020a40: 7374 6172 742c 0a20 2020 2020 2020 2020  start,.         
+00020a50: 2020 2020 2020 2022 656e 6422 3a20 656e         "end": en
+00020a60: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+00020a70: 2020 2022 6d65 7472 6963 223a 206d 6574     "metric": met
+00020a80: 7269 6373 206f 7220 5b5d 2c0a 2020 2020  rics or [],.    
+00020a90: 2020 2020 2020 2020 2020 2020 2266 6561              "fea
+00020aa0: 7475 7265 5f61 6e61 6c79 7369 7322 3a20  ture_analysis": 
+00020ab0: 6665 6174 7572 655f 616e 616c 7973 6973  feature_analysis
+00020ac0: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+00020ad0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00020ae0: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+00020af0: 2e6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  .model_monitorin
+00020b00: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
+00020b10: 2e4d 6f64 656c 456e 6470 6f69 6e74 2e66  .ModelEndpoint.f
+00020b20: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
+00020b30: 2020 2020 2020 7265 7370 6f6e 7365 2e6a        response.j
+00020b40: 736f 6e28 290a 2020 2020 2020 2020 290a  son().        ).
+00020b50: 0a20 2020 2064 6566 2070 6174 6368 5f6d  .    def patch_m
+00020b60: 6f64 656c 5f65 6e64 706f 696e 7428 0a20  odel_endpoint(. 
+00020b70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00020b80: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+00020b90: 722c 0a20 2020 2020 2020 2065 6e64 706f  r,.        endpo
+00020ba0: 696e 745f 6964 3a20 7374 722c 0a20 2020  int_id: str,.   
+00020bb0: 2020 2020 2061 7474 7269 6275 7465 733a       attributes:
+00020bc0: 2064 6963 742c 0a20 2020 2029 3a0a 2020   dict,.    ):.  
+00020bd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020be0: 2020 5570 6461 7465 7320 6d6f 6465 6c20    Updates model 
+00020bf0: 656e 6470 6f69 6e74 2077 6974 6820 7072  endpoint with pr
+00020c00: 6f76 6964 6564 2061 7474 7269 6275 7465  ovided attribute
+00020c10: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+00020c20: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
+00020c30: 6e61 6d65 206f 6620 7468 6520 7072 6f6a  name of the proj
+00020c40: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
+00020c50: 7261 6d20 656e 6470 6f69 6e74 5f69 643a  ram endpoint_id:
+00020c60: 2054 6865 2069 6420 6f66 2074 6865 2065   The id of the e
+00020c70: 6e64 706f 696e 742e 0a20 2020 2020 2020  ndpoint..       
+00020c80: 203a 7061 7261 6d20 6174 7472 6962 7574   :param attribut
+00020c90: 6573 3a20 4469 6374 696f 6e61 7279 206f  es: Dictionary o
+00020ca0: 6620 6174 7472 6962 7574 6573 2074 6861  f attributes tha
+00020cb0: 7420 7769 6c6c 2062 6520 7573 6564 2066  t will be used f
+00020cc0: 6f72 2075 7064 6174 6520 7468 6520 6d6f  or update the mo
+00020cd0: 6465 6c20 656e 6470 6f69 6e74 2e20 5468  del endpoint. Th
+00020ce0: 6520 6b65 7973 0a20 2020 2020 2020 2020  e keys.         
+00020cf0: 2020 206f 6620 7468 6973 2064 6963 7469     of this dicti
+00020d00: 6f6e 6172 7920 7368 6f75 6c64 2065 7869  onary should exi
+00020d10: 7374 2069 6e20 7468 6520 7461 7267 6574  st in the target
+00020d20: 2074 6162 6c65 2e20 4e6f 7465 2074 6861   table. Note tha
+00020d30: 7420 7468 6520 7661 6c75 6573 2073 686f  t the values sho
+00020d40: 756c 6420 6265 2066 726f 6d20 7479 7065  uld be from type
+00020d50: 2073 7472 696e 6720 6f72 2066 726f 6d0a   string or from.
+00020d60: 2020 2020 2020 2020 2020 2020 6120 7661              a va
+00020d70: 6c69 6420 6e75 6d65 7269 6361 6c20 7479  lid numerical ty
+00020d80: 7065 2073 7563 6820 6173 2069 6e74 206f  pe such as int o
+00020d90: 7220 666c 6f61 742e 204d 6f72 6520 6465  r float. More de
+00020da0: 7461 696c 7320 6162 6f75 7420 7468 6520  tails about the 
+00020db0: 6d6f 6465 6c20 656e 6470 6f69 6e74 2061  model endpoint a
+00020dc0: 7661 696c 6162 6c65 2061 7474 7269 6275  vailable attribu
+00020dd0: 7465 7320 6361 6e0a 2020 2020 2020 2020  tes can.        
+00020de0: 2020 2020 6265 2066 6f75 6e64 2075 6e64      be found und
+00020df0: 6572 203a 7079 3a63 6c61 7373 3a60 7e6d  er :py:class:`~m
+00020e00: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00020e10: 6d61 732e 4d6f 6465 6c45 6e64 706f 696e  mas.ModelEndpoin
+00020e20: 7460 2e0a 0a20 2020 2020 2020 2045 7861  t`...        Exa
+00020e30: 6d70 6c65 3a3a 0a0a 2020 2020 2020 2020  mple::..        
+00020e40: 2020 2020 2320 4765 6e65 7261 7465 2063      # Generate c
+00020e50: 7572 7265 6e74 2073 7461 7473 2066 6f72  urrent stats for
+00020e60: 2074 776f 2066 6561 7475 7265 730a 2020   two features.  
+00020e70: 2020 2020 2020 2020 2020 6375 7272 656e            curren
+00020e80: 745f 7374 6174 7320 3d20 7b27 7476 645f  t_stats = {'tvd_
+00020e90: 7375 6d27 3a20 322e 322c 0a20 2020 2020  sum': 2.2,.     
+00020ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020eb0: 2020 2020 2020 2020 2774 7664 5f6d 6561          'tvd_mea
+00020ec0: 6e27 3a20 302e 352c 0a20 2020 2020 2020  n': 0.5,.       
+00020ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ee0: 2020 2020 2020 2768 656c 6c69 6e67 6572        'hellinger
+00020ef0: 5f73 756d 273a 2033 2e36 2c0a 2020 2020  _sum': 3.6,.    
+00020f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f10: 2020 2020 2020 2020 2027 6865 6c6c 696e           'hellin
+00020f20: 6765 725f 6d65 616e 273a 2030 2e39 2c0a  ger_mean': 0.9,.
+00020f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f40: 2020 2020 2020 2020 2020 2020 2027 6b6c               'kl
+00020f50: 645f 7375 6d27 3a20 3234 2e32 2c0a 2020  d_sum': 24.2,.  
+00020f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f70: 2020 2020 2020 2020 2020 2027 6b6c 645f             'kld_
+00020f80: 6d65 616e 273a 2036 2e30 2c0a 2020 2020  mean': 6.0,.    
+00020f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020fa0: 2020 2020 2020 2020 2027 6631 273a 207b           'f1': {
+00020fb0: 2774 7664 273a 2030 2e35 2c20 2768 656c  'tvd': 0.5, 'hel
+00020fc0: 6c69 6e67 6572 273a 2031 2e30 2c20 276b  linger': 1.0, 'k
+00020fd0: 6c64 273a 2036 2e34 7d2c 0a20 2020 2020  ld': 6.4},.     
+00020fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ff0: 2020 2020 2020 2020 2766 3227 3a20 7b27          'f2': {'
+00021000: 7476 6427 3a20 302e 352c 2027 6865 6c6c  tvd': 0.5, 'hell
+00021010: 696e 6765 7227 3a20 312e 302c 2027 6b6c  inger': 1.0, 'kl
+00021020: 6427 3a20 362e 357d 7d0a 0a20 2020 2020  d': 6.5}}..     
+00021030: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+00021040: 6174 7472 6962 7574 6573 2064 6963 7469  attributes dicti
+00021050: 6f6e 6172 7920 6163 636f 7264 696e 6720  onary according 
+00021060: 746f 2074 6865 2072 6571 7569 7265 6420  to the required 
+00021070: 666f 726d 6174 0a20 2020 2020 2020 2020  format.         
+00021080: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+00021090: 7b60 6375 7272 656e 745f 7374 6174 7360  {`current_stats`
+000210a0: 3a20 6a73 6f6e 2e64 756d 7073 2863 7572  : json.dumps(cur
+000210b0: 7265 6e74 5f73 7461 7473 292c 0a20 2020  rent_stats),.   
+000210c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000210d0: 2020 2020 2020 2060 6472 6966 745f 7374         `drift_st
+000210e0: 6174 7573 603a 2022 4452 4946 545f 4445  atus`: "DRIFT_DE
+000210f0: 5445 4354 4544 227d 0a0a 2020 2020 2020  TECTED"}..      
+00021100: 2020 2222 220a 0a20 2020 2020 2020 2061    """..        a
+00021110: 7474 7269 6275 7465 7320 3d20 7b22 6174  ttributes = {"at
+00021120: 7472 6962 7574 6573 223a 205f 6173 5f6a  tributes": _as_j
+00021130: 736f 6e28 6174 7472 6962 7574 6573 297d  son(attributes)}
+00021140: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00021150: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00021160: 6563 747d 2f6d 6f64 656c 2d65 6e64 706f  ect}/model-endpo
+00021170: 696e 7473 2f7b 656e 6470 6f69 6e74 5f69  ints/{endpoint_i
+00021180: 647d 220a 2020 2020 2020 2020 7365 6c66  d}".        self
+00021190: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+000211a0: 2020 2020 2020 206d 6574 686f 643d 2250         method="P
+000211b0: 4154 4348 222c 0a20 2020 2020 2020 2020  ATCH",.         
+000211c0: 2020 2070 6174 683d 7061 7468 2c0a 2020     path=path,.  
+000211d0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+000211e0: 3d61 7474 7269 6275 7465 732c 0a20 2020  =attributes,.   
+000211f0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00021200: 7570 6461 7465 5f6d 6f64 656c 5f6d 6f6e  update_model_mon
+00021210: 6974 6f72 696e 675f 636f 6e74 726f 6c6c  itoring_controll
+00021220: 6572 280a 2020 2020 2020 2020 7365 6c66  er(.        self
+00021230: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00021240: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00021250: 6261 7365 5f70 6572 696f 643a 2069 6e74  base_period: int
+00021260: 203d 2031 302c 0a20 2020 2020 2020 2069   = 10,.        i
+00021270: 6d61 6765 3a20 7374 7220 3d20 226d 6c72  mage: str = "mlr
+00021280: 756e 2f6d 6c72 756e 222c 0a20 2020 2029  un/mlrun",.    )
+00021290: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000212a0: 2020 2020 2020 5265 6465 706c 6f79 206d        Redeploy m
+000212b0: 6f64 656c 206d 6f6e 6974 6f72 696e 6720  odel monitoring 
+000212c0: 6170 706c 6963 6174 696f 6e20 636f 6e74  application cont
+000212d0: 726f 6c6c 6572 2066 756e 6374 696f 6e2e  roller function.
+000212e0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000212f0: 2070 726f 6a65 6374 3a20 2020 2020 2020   project:       
+00021300: 2020 2020 2020 2020 2020 2050 726f 6a65             Proje
+00021310: 6374 206e 616d 652e 0a20 2020 2020 2020  ct name..       
+00021320: 203a 7061 7261 6d20 6261 7365 5f70 6572   :param base_per
+00021330: 696f 643a 2020 2020 2020 2020 2020 2020  iod:            
+00021340: 2020 5468 6520 7469 6d65 2070 6572 696f    The time perio
+00021350: 6420 696e 206d 696e 7574 6573 2069 6e20  d in minutes in 
+00021360: 7768 6963 6820 7468 6520 6d6f 6465 6c20  which the model 
+00021370: 6d6f 6e69 746f 7269 6e67 2063 6f6e 7472  monitoring contr
+00021380: 6f6c 6c65 7220 6675 6e63 7469 6f6e 0a20  oller function. 
+00021390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213b0: 2020 2020 2020 2020 7472 6967 6765 7273          triggers
+000213c0: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+000213d0: 6520 6261 7365 2070 6572 696f 6420 6973  e base period is
+000213e0: 2031 3020 6d69 6e75 7465 732e 0a20 2020   10 minutes..   
+000213f0: 2020 2020 203a 7061 7261 6d20 696d 6167       :param imag
+00021400: 653a 2054 6865 2069 6d61 6765 206f 6620  e: The image of 
+00021410: 7468 6520 6d6f 6465 6c20 6d6f 6e69 746f  the model monito
+00021420: 7269 6e67 2063 6f6e 7472 6f6c 6c65 7220  ring controller 
+00021430: 6675 6e63 7469 6f6e 2e0a 2020 2020 2020  function..      
+00021440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021460: 2020 2042 7920 6465 6661 756c 742c 2074     By default, t
+00021470: 6865 2069 6d61 6765 2069 7320 6d6c 7275  he image is mlru
+00021480: 6e2f 6d6c 7275 6e2e 0a20 2020 2020 2020  n/mlrun..       
+00021490: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
+000214a0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+000214b0: 2020 2020 2022 696d 6167 6522 3a20 696d       "image": im
+000214c0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+000214d0: 2022 6261 7365 5f70 6572 696f 6422 3a20   "base_period": 
+000214e0: 6261 7365 5f70 6572 696f 642c 0a20 2020  base_period,.   
+000214f0: 2020 2020 207d 0a20 2020 2020 2020 2070       }.        p
+00021500: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00021510: 2f7b 7072 6f6a 6563 747d 2f6d 6f64 656c  /{project}/model
+00021520: 2d6d 6f6e 6974 6f72 696e 672f 6d6f 6465  -monitoring/mode
+00021530: 6c2d 6d6f 6e69 746f 7269 6e67 2d63 6f6e  l-monitoring-con
+00021540: 7472 6f6c 6c65 7222 0a20 2020 2020 2020  troller".       
+00021550: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
+00021560: 6574 686f 643d 2250 4f53 5422 2c20 7061  ethod="POST", pa
+00021570: 7468 3d70 6174 682c 2070 6172 616d 733d  th=path, params=
+00021580: 7061 7261 6d73 290a 0a20 2020 2064 6566  params)..    def
+00021590: 2065 6e61 626c 655f 6d6f 6465 6c5f 6d6f   enable_model_mo
+000215a0: 6e69 746f 7269 6e67 280a 2020 2020 2020  nitoring(.      
+000215b0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000215c0: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+000215d0: 2020 2020 2020 6261 7365 5f70 6572 696f        base_perio
+000215e0: 643a 2069 6e74 203d 2031 302c 0a20 2020  d: int = 10,.   
+000215f0: 2020 2020 2069 6d61 6765 3a20 7374 7220       image: str 
+00021600: 3d20 226d 6c72 756e 2f6d 6c72 756e 222c  = "mlrun/mlrun",
+00021610: 0a20 2020 2020 2020 2064 6570 6c6f 795f  .        deploy_
+00021620: 6869 7374 6f67 7261 6d5f 6461 7461 5f64  histogram_data_d
+00021630: 7269 6674 5f61 7070 3a20 626f 6f6c 203d  rift_app: bool =
+00021640: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
+00021650: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00021660: 220a 2020 2020 2020 2020 4465 706c 6f79  ".        Deploy
+00021670: 206d 6f64 656c 206d 6f6e 6974 6f72 696e   model monitorin
+00021680: 6720 6170 706c 6963 6174 696f 6e20 636f  g application co
+00021690: 6e74 726f 6c6c 6572 2c20 7772 6974 6572  ntroller, writer
+000216a0: 2061 6e64 2073 7472 6561 6d20 6675 6e63   and stream func
+000216b0: 7469 6f6e 732e 0a20 2020 2020 2020 2057  tions..        W
+000216c0: 6869 6c65 2074 6865 206d 6169 6e20 676f  hile the main go
+000216d0: 616c 206f 6620 7468 6520 636f 6e74 726f  al of the contro
+000216e0: 6c6c 6572 2066 756e 6374 696f 6e20 6973  ller function is
+000216f0: 2074 6f20 6861 6e64 6c65 2074 6865 206d   to handle the m
+00021700: 6f6e 6974 6f72 696e 6720 7072 6f63 6573  onitoring proces
+00021710: 7369 6e67 2061 6e64 2074 7269 6767 6572  sing and trigger
+00021720: 696e 670a 2020 2020 2020 2020 6170 706c  ing.        appl
+00021730: 6963 6174 696f 6e73 2c20 7468 6520 676f  ications, the go
+00021740: 616c 206f 6620 7468 6520 6d6f 6465 6c20  al of the model 
+00021750: 6d6f 6e69 746f 7269 6e67 2077 7269 7465  monitoring write
+00021760: 7220 6675 6e63 7469 6f6e 2069 7320 746f  r function is to
+00021770: 2077 7269 7465 2061 6c6c 2074 6865 206d   write all the m
+00021780: 6f6e 6974 6f72 696e 670a 2020 2020 2020  onitoring.      
+00021790: 2020 6170 706c 6963 6174 696f 6e20 7265    application re
+000217a0: 7375 6c74 7320 746f 2074 6865 2064 6174  sults to the dat
+000217b0: 6162 6173 6573 2e0a 2020 2020 2020 2020  abases..        
+000217c0: 5468 6520 7374 7265 616d 2066 756e 6374  The stream funct
+000217d0: 696f 6e20 676f 616c 2069 7320 746f 206d  ion goal is to m
+000217e0: 6f6e 6974 6f72 2074 6865 206c 6f67 206f  onitor the log o
+000217f0: 6620 7468 6520 6461 7461 2073 7472 6561  f the data strea
+00021800: 6d2e 2049 7420 6973 2074 7269 6767 6572  m. It is trigger
+00021810: 6564 2077 6865 6e20 6120 6e65 7720 6c6f  ed when a new lo
+00021820: 6720 656e 7472 790a 2020 2020 2020 2020  g entry.        
+00021830: 6973 2064 6574 6563 7465 642e 2049 7420  is detected. It 
+00021840: 7072 6f63 6573 7365 7320 7468 6520 6e65  processes the ne
+00021850: 7720 6576 656e 7473 2069 6e74 6f20 7374  w events into st
+00021860: 6174 6973 7469 6373 2074 6861 7420 6172  atistics that ar
+00021870: 6520 7468 656e 2077 7269 7474 656e 2074  e then written t
+00021880: 6f20 7374 6174 6973 7469 6373 2064 6174  o statistics dat
+00021890: 6162 6173 6573 2e0a 0a20 2020 2020 2020  abases...       
+000218a0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+000218b0: 2020 2020 2050 726f 6a65 6374 206e 616d       Project nam
+000218c0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000218d0: 6d20 6261 7365 5f70 6572 696f 643a 2054  m base_period: T
+000218e0: 6865 2074 696d 6520 7065 7269 6f64 2069  he time period i
+000218f0: 6e20 6d69 6e75 7465 7320 696e 2077 6869  n minutes in whi
+00021900: 6368 2074 6865 206d 6f64 656c 206d 6f6e  ch the model mon
+00021910: 6974 6f72 696e 6720 636f 6e74 726f 6c6c  itoring controll
+00021920: 6572 2066 756e 6374 696f 6e0a 2020 2020  er function.    
+00021930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021940: 2020 2020 2020 2020 7472 6967 6765 7273          triggers
+00021950: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+00021960: 6520 6261 7365 2070 6572 696f 6420 6973  e base period is
+00021970: 2031 3020 6d69 6e75 7465 732e 0a20 2020   10 minutes..   
+00021980: 2020 2020 203a 7061 7261 6d20 696d 6167       :param imag
+00021990: 653a 2020 2020 2020 2054 6865 2069 6d61  e:       The ima
+000219a0: 6765 206f 6620 7468 6520 6d6f 6465 6c20  ge of the model 
+000219b0: 6d6f 6e69 746f 7269 6e67 2063 6f6e 7472  monitoring contr
+000219c0: 6f6c 6c65 722c 2077 7269 7465 7220 2620  oller, writer & 
+000219d0: 6d6f 6e69 746f 7269 6e67 0a20 2020 2020  monitoring.     
 000219e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219f0: 6f72 6465 723d 312c 0a20 2020 2020 2020  order=1,.       
-00021a00: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00021a10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00021a20: 656d 6173 2e48 7562 536f 7572 6365 280a  emas.HubSource(.
+000219f0: 2020 2020 2020 2073 7472 6561 6d20 6675         stream fu
+00021a00: 6e63 7469 6f6e 732c 2077 6869 6368 2061  nctions, which a
+00021a10: 7265 2072 6561 6c20 7469 6d65 206e 7563  re real time nuc
+00021a20: 6c69 6f20 6675 6e63 7469 6f6e 732e 0a20  lio functions.. 
 00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a40: 2020 2020 6d65 7461 6461 7461 3d6d 6c72      metadata=mlr
-00021a50: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00021a60: 732e 4875 624f 626a 6563 744d 6574 6164  s.HubObjectMetad
-00021a70: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
-00021a80: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00021a90: 653d 2270 7269 762d 3222 2c20 6465 7363  e="priv-2", desc
-00021aa0: 7269 7074 696f 6e3d 2261 6e6f 7468 6572  ription="another
-00021ab0: 2073 6f75 7263 6522 0a20 2020 2020 2020   source".       
-00021ac0: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
-00021ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ae0: 2020 2020 7370 6563 3d6d 6c72 756e 2e63      spec=mlrun.c
-00021af0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
-00021b00: 6253 6f75 7263 6553 7065 6328 0a20 2020  bSourceSpec(.   
-00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b20: 2020 2020 2070 6174 683d 222f 6c6f 6361       path="/loca
-00021b30: 6c2f 7061 7468 2f74 6f2f 736f 7572 6365  l/path/to/source
-00021b40: 2f32 222c 0a20 2020 2020 2020 2020 2020  /2",.           
-00021b50: 2020 2020 2020 2020 2020 2020 2063 6861               cha
-00021b60: 6e6e 656c 3d22 6465 7665 6c6f 706d 656e  nnel="developmen
-00021b70: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00021b80: 2020 2020 2020 2020 2020 2020 6372 6564              cred
-00021b90: 656e 7469 616c 733d 7b2e 2e2e 7d0a 2020  entials={...}.  
-00021ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bb0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021bc0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00021bd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021be0: 6462 2e63 7265 6174 655f 6875 625f 736f  db.create_hub_so
-00021bf0: 7572 6365 2861 6e6f 7468 6572 5f73 6f75  urce(another_sou
-00021c00: 7263 6529 0a0a 2020 2020 2020 2020 3a70  rce)..        :p
-00021c10: 6172 616d 2073 6f75 7263 653a 2054 6865  aram source: The
-00021c20: 2073 6f75 7263 6520 616e 6420 6974 7320   source and its 
-00021c30: 6f72 6465 722c 206f 6620 7479 7065 0a20  order, of type. 
-00021c40: 2020 2020 2020 2020 2020 203a 7079 3a63             :py:c
-00021c50: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
-00021c60: 6d6f 6e2e 7363 6865 6d61 732e 6875 622e  mon.schemas.hub.
-00021c70: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
-00021c80: 602c 206f 7220 696e 2064 6963 7469 6f6e  `, or in diction
-00021c90: 6172 7920 666f 726d 2e0a 2020 2020 2020  ary form..      
-00021ca0: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
-00021cb0: 736f 7572 6365 206f 626a 6563 7420 6173  source object as
-00021cc0: 2069 6e73 6572 7465 6420 696e 746f 2074   inserted into t
-00021cd0: 6865 2064 6174 6162 6173 652c 2077 6974  he database, wit
-00021ce0: 6820 6372 6564 656e 7469 616c 7320 7374  h credentials st
-00021cf0: 7269 7070 6564 2e0a 2020 2020 2020 2020  ripped..        
-00021d00: 2222 220a 2020 2020 2020 2020 7061 7468  """.        path
-00021d10: 203d 2022 6875 622f 736f 7572 6365 7322   = "hub/sources"
-00021d20: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00021d30: 7374 616e 6365 2873 6f75 7263 652c 206d  stance(source, m
-00021d40: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00021d50: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
-00021d60: 7572 6365 293a 0a20 2020 2020 2020 2020  urce):.         
-00021d70: 2020 2073 6f75 7263 6520 3d20 736f 7572     source = sour
-00021d80: 6365 2e64 6963 7428 290a 2020 2020 2020  ce.dict().      
-00021d90: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00021da0: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
-00021db0: 643d 2250 4f53 5422 2c20 7061 7468 3d70  d="POST", path=p
-00021dc0: 6174 682c 206a 736f 6e3d 736f 7572 6365  ath, json=source
-00021dd0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00021de0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00021df0: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
-00021e00: 536f 7572 6365 282a 2a72 6573 706f 6e73  Source(**respons
-00021e10: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
-00021e20: 6566 2073 746f 7265 5f68 7562 5f73 6f75  ef store_hub_sou
-00021e30: 7263 6528 0a20 2020 2020 2020 2073 656c  rce(.        sel
-00021e40: 662c 0a20 2020 2020 2020 2073 6f75 7263  f,.        sourc
-00021e50: 655f 6e61 6d65 3a20 7374 722c 0a20 2020  e_name: str,.   
-00021e60: 2020 2020 2073 6f75 7263 653a 2055 6e69       source: Uni
-00021e70: 6f6e 5b64 6963 742c 206d 6c72 756e 2e63  on[dict, mlrun.c
-00021e80: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
-00021e90: 6465 7865 6448 7562 536f 7572 6365 5d2c  dexedHubSource],
-00021ea0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00021eb0: 2222 220a 2020 2020 2020 2020 4372 6561  """.        Crea
-00021ec0: 7465 206f 7220 7265 706c 6163 6520 6120  te or replace a 
-00021ed0: 6875 6220 736f 7572 6365 2e0a 2020 2020  hub source..    
-00021ee0: 2020 2020 466f 7220 616e 2065 7861 6d70      For an examp
-00021ef0: 6c65 206f 6620 7468 6520 736f 7572 6365  le of the source
-00021f00: 2066 6f72 6d61 7420 616e 6420 6578 706c   format and expl
-00021f10: 616e 6174 696f 6e20 6f66 2074 6865 2073  anation of the s
-00021f20: 6f75 7263 6520 6f72 6465 7220 6c6f 6769  ource order logi
-00021f30: 632c 0a20 2020 2020 2020 2070 6c65 6173  c,.        pleas
-00021f40: 6520 7365 6520 3a70 793a 6675 6e63 3a60  e see :py:func:`
-00021f50: 7e63 7265 6174 655f 6875 625f 736f 7572  ~create_hub_sour
-00021f60: 6365 602e 2054 6869 7320 6d65 7468 6f64  ce`. This method
-00021f70: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00021f80: 6d6f 6469 6679 2074 6865 2073 6f75 7263  modify the sourc
-00021f90: 6520 6974 7365 6c66 206f 7220 6974 730a  e itself or its.
-00021fa0: 2020 2020 2020 2020 6f72 6465 7220 696e          order in
-00021fb0: 2074 6865 206c 6973 7420 6f66 2073 6f75   the list of sou
-00021fc0: 7263 6573 2e0a 0a20 2020 2020 2020 203a  rces...        :
-00021fd0: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
-00021fe0: 653a 204e 616d 6520 6f66 2074 6865 2073  e: Name of the s
-00021ff0: 6f75 7263 6520 6f62 6a65 6374 2074 6f20  ource object to 
-00022000: 6d6f 6469 6679 2f63 7265 6174 652e 2049  modify/create. I
-00022010: 7420 6d75 7374 206d 6174 6368 2074 6865  t must match the
-00022020: 2060 6073 6f75 7263 652e 6d65 7461 6461   ``source.metada
-00022030: 7461 2e6e 616d 6560 600a 2020 2020 2020  ta.name``.      
-00022040: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
-00022050: 696e 2074 6865 2073 6f75 7263 6520 6974  in the source it
-00022060: 7365 6c66 2e0a 2020 2020 2020 2020 3a70  self..        :p
-00022070: 6172 616d 2073 6f75 7263 653a 2053 6f75  aram source: Sou
-00022080: 7263 6520 6f62 6a65 6374 2074 6f20 7374  rce object to st
-00022090: 6f72 6520 696e 2074 6865 2064 6174 6162  ore in the datab
-000220a0: 6173 652e 0a20 2020 2020 2020 203a 7265  ase..        :re
-000220b0: 7475 726e 733a 2054 6865 2073 6f75 7263  turns: The sourc
-000220c0: 6520 6f62 6a65 6374 2061 7320 7374 6f72  e object as stor
-000220d0: 6564 2069 6e20 7468 6520 4442 2e0a 2020  ed in the DB..  
-000220e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000220f0: 2020 7061 7468 203d 2066 2268 7562 2f73    path = f"hub/s
-00022100: 6f75 7263 6573 2f7b 736f 7572 6365 5f6e  ources/{source_n
-00022110: 616d 657d 220a 2020 2020 2020 2020 6966  ame}".        if
-00022120: 2069 7369 6e73 7461 6e63 6528 736f 7572   isinstance(sour
-00022130: 6365 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ce, mlrun.common
-00022140: 2e73 6368 656d 6173 2e49 6e64 6578 6564  .schemas.Indexed
-00022150: 4875 6253 6f75 7263 6529 3a0a 2020 2020  HubSource):.    
-00022160: 2020 2020 2020 2020 736f 7572 6365 203d          source =
-00022170: 2073 6f75 7263 652e 6469 6374 2829 0a0a   source.dict()..
-00022180: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-00022190: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000221a0: 286d 6574 686f 643d 2250 5554 222c 2070  (method="PUT", p
-000221b0: 6174 683d 7061 7468 2c20 6a73 6f6e 3d73  ath=path, json=s
-000221c0: 6f75 7263 6529 0a20 2020 2020 2020 2072  ource).        r
-000221d0: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
-000221e0: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-000221f0: 6564 4875 6253 6f75 7263 6528 2a2a 7265  edHubSource(**re
-00022200: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-00022210: 2020 2020 6465 6620 6c69 7374 5f68 7562      def list_hub
-00022220: 5f73 6f75 7263 6573 280a 2020 2020 2020  _sources(.      
-00022230: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00022240: 6974 656d 5f6e 616d 653a 204f 7074 696f  item_name: Optio
-00022250: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00022260: 0a20 2020 2020 2020 2074 6167 3a20 4f70  .        tag: Op
-00022270: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-00022280: 6e65 2c0a 2020 2020 2020 2020 7665 7273  ne,.        vers
-00022290: 696f 6e3a 204f 7074 696f 6e61 6c5b 7374  ion: Optional[st
-000222a0: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
-000222b0: 202d 3e20 6c69 7374 5b6d 6c72 756e 2e63   -> list[mlrun.c
-000222c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 6875  ommon.schemas.hu
-000222d0: 622e 496e 6465 7865 6448 7562 536f 7572  b.IndexedHubSour
-000222e0: 6365 5d3a 0a20 2020 2020 2020 2022 2222  ce]:.        """
-000222f0: 0a20 2020 2020 2020 204c 6973 7420 6875  .        List hu
-00022300: 6220 736f 7572 6365 7320 696e 2074 6865  b sources in the
-00022310: 204d 4c52 756e 2044 422e 0a0a 2020 2020   MLRun DB...    
-00022320: 2020 2020 3a70 6172 616d 2069 7465 6d5f      :param item_
-00022330: 6e61 6d65 3a20 2020 536f 7572 6365 7320  name:   Sources 
-00022340: 636f 6e74 6169 6e20 7468 6973 2069 7465  contain this ite
-00022350: 6d20 7769 6c6c 2062 6520 7265 7475 726e  m will be return
-00022360: 6564 2c20 4966 206e 6f74 2070 726f 7669  ed, If not provi
-00022370: 6465 6420 616c 6c20 736f 7572 6365 7320  ded all sources 
-00022380: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-00022390: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000223a0: 2074 6167 3a20 2020 2020 2020 2020 4974   tag:         It
-000223b0: 656d 2074 6167 2074 6f20 6669 6c74 6572  em tag to filter
-000223c0: 2062 792c 2073 7570 706f 7274 6564 206f   by, supported o
-000223d0: 6e6c 7920 6966 2069 7465 6d20 6e61 6d65  nly if item name
-000223e0: 2069 7320 7072 6f76 6964 6564 2e0a 2020   is provided..  
-000223f0: 2020 2020 2020 3a70 6172 616d 2076 6572        :param ver
-00022400: 7369 6f6e 3a20 2020 2020 4974 656d 2076  sion:     Item v
-00022410: 6572 7369 6f6e 2074 6f20 6669 6c74 6572  ersion to filter
-00022420: 2062 792c 2073 7570 706f 7274 6564 206f   by, supported o
-00022430: 6e6c 7920 6966 2069 7465 6d20 6e61 6d65  nly if item name
-00022440: 2069 7320 7072 6f76 6964 6564 2061 6e64   is provided and
-00022450: 2074 6167 2069 7320 6e6f 742e 0a0a 2020   tag is not...  
-00022460: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00022470: 4c69 7374 206f 6620 696e 6465 7865 6420  List of indexed 
-00022480: 6875 6220 736f 7572 6365 732e 0a20 2020  hub sources..   
-00022490: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000224a0: 2070 6174 6820 3d20 2268 7562 2f73 6f75   path = "hub/sou
-000224b0: 7263 6573 220a 2020 2020 2020 2020 7061  rces".        pa
-000224c0: 7261 6d73 203d 207b 7d0a 2020 2020 2020  rams = {}.      
-000224d0: 2020 6966 2069 7465 6d5f 6e61 6d65 3a0a    if item_name:.
-000224e0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-000224f0: 6d73 5b22 6974 656d 2d6e 616d 6522 5d20  ms["item-name"] 
-00022500: 3d20 6e6f 726d 616c 697a 655f 6e61 6d65  = normalize_name
-00022510: 2869 7465 6d5f 6e61 6d65 290a 2020 2020  (item_name).    
-00022520: 2020 2020 6966 2074 6167 3a0a 2020 2020      if tag:.    
-00022530: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
-00022540: 7461 6722 5d20 3d20 7461 670a 2020 2020  tag"] = tag.    
-00022550: 2020 2020 6966 2076 6572 7369 6f6e 3a0a      if version:.
-00022560: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00022570: 6d73 5b22 7665 7273 696f 6e22 5d20 3d20  ms["version"] = 
-00022580: 7665 7273 696f 6e0a 2020 2020 2020 2020  version.        
-00022590: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-000225a0: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
-000225b0: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
-000225c0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-000225d0: 2e6a 736f 6e28 290a 2020 2020 2020 2020  .json().        
-000225e0: 7265 7375 6c74 7320 3d20 5b5d 0a20 2020  results = [].   
-000225f0: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
-00022600: 2072 6573 706f 6e73 653a 0a20 2020 2020   response:.     
-00022610: 2020 2020 2020 2072 6573 756c 7473 2e61         results.a
-00022620: 7070 656e 6428 6d6c 7275 6e2e 636f 6d6d  ppend(mlrun.comm
-00022630: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-00022640: 6564 4875 6253 6f75 7263 6528 2a2a 6974  edHubSource(**it
-00022650: 656d 2929 0a20 2020 2020 2020 2072 6574  em)).        ret
-00022660: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-00022670: 2064 6566 2067 6574 5f68 7562 5f73 6f75   def get_hub_sou
-00022680: 7263 6528 7365 6c66 2c20 736f 7572 6365  rce(self, source
-00022690: 5f6e 616d 653a 2073 7472 293a 0a20 2020  _name: str):.   
-000226a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000226b0: 2052 6574 7269 6576 6520 6120 6875 6220   Retrieve a hub 
-000226c0: 736f 7572 6365 2066 726f 6d20 7468 6520  source from the 
-000226d0: 4442 2e0a 0a20 2020 2020 2020 203a 7061  DB...        :pa
-000226e0: 7261 6d20 736f 7572 6365 5f6e 616d 653a  ram source_name:
-000226f0: 204e 616d 6520 6f66 2074 6865 2068 7562   Name of the hub
-00022700: 2073 6f75 7263 6520 746f 2072 6574 7269   source to retri
-00022710: 6576 652e 0a20 2020 2020 2020 2022 2222  eve..        """
-00022720: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00022730: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
-00022740: 6f75 7263 655f 6e61 6d65 7d22 0a20 2020  ource_name}".   
-00022750: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-00022760: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
-00022770: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
-00022780: 3d70 6174 6829 0a20 2020 2020 2020 2072  =path).        r
-00022790: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
-000227a0: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-000227b0: 6564 4875 6253 6f75 7263 6528 2a2a 7265  edHubSource(**re
-000227c0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-000227d0: 2020 2020 6465 6620 6465 6c65 7465 5f68      def delete_h
-000227e0: 7562 5f73 6f75 7263 6528 7365 6c66 2c20  ub_source(self, 
-000227f0: 736f 7572 6365 5f6e 616d 653a 2073 7472  source_name: str
-00022800: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00022810: 2020 2020 2020 2044 656c 6574 6520 6120         Delete a 
-00022820: 6875 6220 736f 7572 6365 2066 726f 6d20  hub source from 
-00022830: 7468 6520 4442 2e0a 2020 2020 2020 2020  the DB..        
-00022840: 5468 6520 736f 7572 6365 2077 696c 6c20  The source will 
-00022850: 6265 2064 656c 6574 6564 2066 726f 6d20  be deleted from 
-00022860: 7468 6520 6c69 7374 2c20 616e 6420 616e  the list, and an
-00022870: 7920 666f 6c6c 6f77 696e 6720 736f 7572  y following sour
-00022880: 6365 7320 7769 6c6c 2062 6520 7072 6f6d  ces will be prom
-00022890: 6f74 6564 202d 2066 6f72 2065 7861 6d70  oted - for examp
-000228a0: 6c65 2c20 6966 2074 6865 0a20 2020 2020  le, if the.     
-000228b0: 2020 2031 7374 2073 6f75 7263 6520 6973     1st source is
-000228c0: 2064 656c 6574 6564 2c20 7468 6520 326e   deleted, the 2n
-000228d0: 6420 736f 7572 6365 2077 696c 6c20 6265  d source will be
-000228e0: 636f 6d65 2023 3120 696e 2074 6865 206c  come #1 in the l
-000228f0: 6973 742e 0a20 2020 2020 2020 2054 6865  ist..        The
-00022900: 2067 6c6f 6261 6c20 6875 6220 736f 7572   global hub sour
-00022910: 6365 2063 616e 6e6f 7420 6265 2064 656c  ce cannot be del
-00022920: 6574 6564 2e0a 0a20 2020 2020 2020 203a  eted...        :
-00022930: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
-00022940: 653a 204e 616d 6520 6f66 2074 6865 2068  e: Name of the h
-00022950: 7562 2073 6f75 7263 6520 746f 2064 656c  ub source to del
-00022960: 6574 652e 0a20 2020 2020 2020 2022 2222  ete..        """
-00022970: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00022980: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
-00022990: 6f75 7263 655f 6e61 6d65 7d22 0a20 2020  ource_name}".   
-000229a0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-000229b0: 6c6c 286d 6574 686f 643d 2244 454c 4554  ll(method="DELET
-000229c0: 4522 2c20 7061 7468 3d70 6174 6829 0a0a  E", path=path)..
-000229d0: 2020 2020 6465 6620 6765 745f 6875 625f      def get_hub_
-000229e0: 6361 7461 6c6f 6728 0a20 2020 2020 2020  catalog(.       
-000229f0: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-00022a00: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
-00022a10: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-00022a20: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00022a30: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
-00022a40: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
-00022a50: 6f72 6365 5f72 6566 7265 7368 3a20 626f  orce_refresh: bo
-00022a60: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00022a70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00022a80: 2020 2020 2020 2052 6574 7269 6576 6520         Retrieve 
-00022a90: 7468 6520 6974 656d 2063 6174 616c 6f67  the item catalog
-00022aa0: 2066 6f72 2061 2073 7065 6369 6669 6564   for a specified
-00022ab0: 2068 7562 2073 6f75 7263 652e 0a20 2020   hub source..   
-00022ac0: 2020 2020 2054 6865 206c 6973 7420 6f66       The list of
-00022ad0: 2069 7465 6d73 2063 616e 2062 6520 6669   items can be fi
-00022ae0: 6c74 6572 6564 2061 6363 6f72 6469 6e67  ltered according
-00022af0: 2074 6f20 7661 7269 6f75 7320 6669 6c74   to various filt
-00022b00: 6572 732c 2075 7369 6e67 2069 7465 6d27  ers, using item'
-00022b10: 7320 6d65 7461 6461 7461 2074 6f20 6669  s metadata to fi
-00022b20: 6c74 6572 2e0a 0a20 2020 2020 2020 203a  lter...        :
-00022b30: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
-00022b40: 653a 204e 616d 6520 6f66 2074 6865 2073  e: Name of the s
-00022b50: 6f75 7263 652e 0a20 2020 2020 2020 203a  ource..        :
-00022b60: 7061 7261 6d20 7665 7273 696f 6e3a 2046  param version: F
-00022b70: 696c 7465 7220 6974 656d 7320 6163 636f  ilter items acco
-00022b80: 7264 696e 6720 746f 2074 6865 6972 2076  rding to their v
-00022b90: 6572 7369 6f6e 2e0a 2020 2020 2020 2020  ersion..        
-00022ba0: 3a70 6172 616d 2074 6167 3a20 4669 6c74  :param tag: Filt
-00022bb0: 6572 2069 7465 6d73 2062 6173 6564 206f  er items based o
-00022bc0: 6e20 7461 672e 0a20 2020 2020 2020 203a  n tag..        :
-00022bd0: 7061 7261 6d20 666f 7263 655f 7265 6672  param force_refr
-00022be0: 6573 683a 204d 616b 6520 7468 6520 7365  esh: Make the se
-00022bf0: 7276 6572 2066 6574 6368 2074 6865 2063  rver fetch the c
-00022c00: 6174 616c 6f67 2066 726f 6d20 7468 6520  atalog from the 
-00022c10: 6163 7475 616c 2068 7562 2073 6f75 7263  actual hub sourc
-00022c20: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
-00022c30: 6174 6865 7220 7468 616e 2072 656c 7920  ather than rely 
-00022c40: 6f6e 2063 6163 6865 6420 696e 666f 726d  on cached inform
-00022c50: 6174 696f 6e20 7768 6963 6820 6d61 7920  ation which may 
-00022c60: 6578 6973 7420 6672 6f6d 2070 7265 7669  exist from previ
-00022c70: 6f75 7320 6765 7420 7265 7175 6573 7473  ous get requests
-00022c80: 2e20 466f 7220 6578 616d 706c 652c 0a20  . For example,. 
-00022c90: 2020 2020 2020 2020 2020 2069 6620 7468             if th
-00022ca0: 6520 736f 7572 6365 2077 6173 2072 652d  e source was re-
-00022cb0: 6275 696c 742c 0a20 2020 2020 2020 2020  built,.         
-00022cc0: 2020 2074 6869 7320 7769 6c6c 206d 616b     this will mak
-00022cd0: 6520 7468 6520 7365 7276 6572 2067 6574  e the server get
-00022ce0: 2074 6865 2075 7064 6174 6564 2069 6e66   the updated inf
-00022cf0: 6f72 6d61 7469 6f6e 2e20 4465 6661 756c  ormation. Defaul
-00022d00: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
-00022d10: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00022d20: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
-00022d30: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00022d40: 6173 2e68 7562 2e48 7562 4361 7461 6c6f  as.hub.HubCatalo
-00022d50: 6760 206f 626a 6563 742c 2077 6869 6368  g` object, which
-00022d60: 2069 7320 6573 7365 6e74 6961 6c6c 7920   is essentially 
-00022d70: 6120 6c69 7374 0a20 2020 2020 2020 2020  a list.         
-00022d80: 2020 206f 6620 3a70 793a 636c 6173 733a     of :py:class:
-00022d90: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
-00022da0: 6368 656d 6173 2e68 7562 2e48 7562 4974  chemas.hub.HubIt
-00022db0: 656d 6020 656e 7472 6965 732e 0a20 2020  em` entries..   
-00022dc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00022dd0: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
-00022de0: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
-00022df0: 6d65 7d2f 6974 656d 7322 0a20 2020 2020  me}/items".     
-00022e00: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-00022e10: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
-00022e20: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
-00022e30: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
-00022e40: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
-00022e50: 2020 2266 6f72 6365 2d72 6566 7265 7368    "force-refresh
-00022e60: 223a 2066 6f72 6365 5f72 6566 7265 7368  ": force_refresh
-00022e70: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00022e80: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00022e90: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
-00022ea0: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
-00022eb0: 7061 7468 2c20 7061 7261 6d73 3d70 6172  path, params=par
-00022ec0: 616d 7329 0a20 2020 2020 2020 2072 6574  ams).        ret
-00022ed0: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
-00022ee0: 2e73 6368 656d 6173 2e48 7562 4361 7461  .schemas.HubCata
-00022ef0: 6c6f 6728 2a2a 7265 7370 6f6e 7365 2e6a  log(**response.j
-00022f00: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
-00022f10: 6765 745f 6875 625f 6974 656d 280a 2020  get_hub_item(.  
-00022f20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00022f30: 2020 2020 736f 7572 6365 5f6e 616d 653a      source_name:
-00022f40: 2073 7472 2c0a 2020 2020 2020 2020 6974   str,.        it
-00022f50: 656d 5f6e 616d 653a 2073 7472 2c0a 2020  em_name: str,.  
-00022f60: 2020 2020 2020 7665 7273 696f 6e3a 2073        version: s
-00022f70: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00022f80: 2020 2074 6167 3a20 7374 7220 3d20 226c     tag: str = "l
-00022f90: 6174 6573 7422 2c0a 2020 2020 2020 2020  atest",.        
-00022fa0: 666f 7263 655f 7265 6672 6573 683a 2062  force_refresh: b
-00022fb0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00022fc0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-00022fd0: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
-00022fe0: 2061 2073 7065 6369 6669 6320 6875 6220   a specific hub 
-00022ff0: 6974 656d 2e0a 0a20 2020 2020 2020 203a  item...        :
-00023000: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
-00023010: 653a 204e 616d 6520 6f66 2073 6f75 7263  e: Name of sourc
-00023020: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00023030: 6d20 6974 656d 5f6e 616d 653a 204e 616d  m item_name: Nam
-00023040: 6520 6f66 2074 6865 2069 7465 6d20 746f  e of the item to
-00023050: 2072 6574 7269 6576 652c 2061 7320 6974   retrieve, as it
-00023060: 2061 7070 6561 7273 2069 6e20 7468 6520   appears in the 
-00023070: 6361 7461 6c6f 672e 0a20 2020 2020 2020  catalog..       
-00023080: 203a 7061 7261 6d20 7665 7273 696f 6e3a   :param version:
-00023090: 2047 6574 2061 2073 7065 6369 6669 6320   Get a specific 
-000230a0: 7665 7273 696f 6e20 6f66 2074 6865 2069  version of the i
-000230b0: 7465 6d2e 2044 6566 6175 6c74 2069 7320  tem. Default is 
-000230c0: 6060 4e6f 6e65 6060 2e0a 2020 2020 2020  ``None``..      
-000230d0: 2020 3a70 6172 616d 2074 6167 3a20 4765    :param tag: Ge
-000230e0: 7420 6120 7370 6563 6966 6963 2076 6572  t a specific ver
-000230f0: 7369 6f6e 206f 6620 7468 6520 6974 656d  sion of the item
-00023100: 2069 6465 6e74 6966 6965 6420 6279 2074   identified by t
-00023110: 6167 2e20 4465 6661 756c 7420 6973 2060  ag. Default is `
-00023120: 606c 6174 6573 7460 602e 0a20 2020 2020  `latest``..     
-00023130: 2020 203a 7061 7261 6d20 666f 7263 655f     :param force_
-00023140: 7265 6672 6573 683a 204d 616b 6520 7468  refresh: Make th
-00023150: 6520 7365 7276 6572 2066 6574 6368 2074  e server fetch t
-00023160: 6865 2069 6e66 6f72 6d61 7469 6f6e 2066  he information f
-00023170: 726f 6d20 7468 6520 6163 7475 616c 2068  rom the actual h
-00023180: 7562 0a20 2020 2020 2020 2020 2020 2073  ub.            s
-00023190: 6f75 7263 652c 2072 6174 6865 7220 7468  ource, rather th
-000231a0: 616e 0a20 2020 2020 2020 2020 2020 2072  an.            r
-000231b0: 656c 7920 6f6e 2063 6163 6865 6420 696e  ely on cached in
-000231c0: 666f 726d 6174 696f 6e2e 2044 6566 6175  formation. Defau
-000231d0: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-000231e0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-000231f0: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-00023200: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00023210: 6d61 732e 6875 622e 4875 6249 7465 6d60  mas.hub.HubItem`
-00023220: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00023230: 2020 2020 2020 7061 7468 203d 2028 6622        path = (f"
-00023240: 6875 622f 736f 7572 6365 732f 7b73 6f75  hub/sources/{sou
-00023250: 7263 655f 6e61 6d65 7d2f 6974 656d 732f  rce_name}/items/
-00023260: 7b69 7465 6d5f 6e61 6d65 7d22 2c29 0a20  {item_name}",). 
-00023270: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00023280: 7b0a 2020 2020 2020 2020 2020 2020 2276  {.            "v
-00023290: 6572 7369 6f6e 223a 2076 6572 7369 6f6e  ersion": version
-000232a0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-000232b0: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-000232c0: 2020 2020 2020 2266 6f72 6365 2d72 6566        "force-ref
-000232d0: 7265 7368 223a 2066 6f72 6365 5f72 6566  resh": force_ref
-000232e0: 7265 7368 2c0a 2020 2020 2020 2020 7d0a  resh,.        }.
-000232f0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-00023300: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00023310: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
-00023320: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
-00023330: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00023340: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-00023350: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
-00023360: 4974 656d 282a 2a72 6573 706f 6e73 652e  Item(**response.
-00023370: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-00023380: 2067 6574 5f68 7562 5f61 7373 6574 280a   get_hub_asset(.
-00023390: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000233a0: 2020 2020 2020 736f 7572 6365 5f6e 616d        source_nam
-000233b0: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
-000233c0: 6974 656d 5f6e 616d 653a 2073 7472 2c0a  item_name: str,.
-000233d0: 2020 2020 2020 2020 6173 7365 745f 6e61          asset_na
-000233e0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-000233f0: 2076 6572 7369 6f6e 3a20 7374 7220 3d20   version: str = 
-00023400: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
-00023410: 673a 2073 7472 203d 2022 6c61 7465 7374  g: str = "latest
-00023420: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
-00023430: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
-00023440: 7420 6875 6220 6173 7365 7420 6672 6f6d  t hub asset from
-00023450: 2069 7465 6d2e 0a0a 2020 2020 2020 2020   item...        
-00023460: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-00023470: 6d65 3a20 4e61 6d65 206f 6620 736f 7572  me: Name of sour
-00023480: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
-00023490: 616d 2069 7465 6d5f 6e61 6d65 3a20 2020  am item_name:   
-000234a0: 4e61 6d65 206f 6620 7468 6520 6974 656d  Name of the item
-000234b0: 2077 6869 6368 2068 6f6c 6473 2074 6865   which holds the
-000234c0: 2061 7373 6574 2e0a 2020 2020 2020 2020   asset..        
-000234d0: 3a70 6172 616d 2061 7373 6574 5f6e 616d  :param asset_nam
-000234e0: 653a 2020 4e61 6d65 206f 6620 7468 6520  e:  Name of the 
-000234f0: 6173 7365 7420 746f 2072 6574 7269 6576  asset to retriev
-00023500: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00023510: 6d20 7665 7273 696f 6e3a 2047 6574 2061  m version: Get a
-00023520: 2073 7065 6369 6669 6320 7665 7273 696f   specific versio
-00023530: 6e20 6f66 2074 6865 2069 7465 6d2e 2044  n of the item. D
-00023540: 6566 6175 6c74 2069 7320 6060 4e6f 6e65  efault is ``None
-00023550: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
-00023560: 616d 2074 6167 3a20 4765 7420 6120 7370  am tag: Get a sp
-00023570: 6563 6966 6963 2076 6572 7369 6f6e 206f  ecific version o
-00023580: 6620 7468 6520 6974 656d 2069 6465 6e74  f the item ident
-00023590: 6966 6965 6420 6279 2074 6167 2e20 4465  ified by tag. De
-000235a0: 6661 756c 7420 6973 2060 606c 6174 6573  fault is ``lates
-000235b0: 7460 602e 0a0a 2020 2020 2020 2020 3a72  t``...        :r
-000235c0: 6574 7572 6e3a 2068 7474 7020 7265 7370  eturn: http resp
-000235d0: 6f6e 7365 2077 6974 6820 7468 6520 6173  onse with the as
-000235e0: 7365 7420 696e 2074 6865 2063 6f6e 7465  set in the conte
-000235f0: 6e74 2061 7474 7269 6275 7465 0a20 2020  nt attribute.   
-00023600: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00023610: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
-00023620: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
-00023630: 6d65 7d2f 6974 656d 732f 7b69 7465 6d5f  me}/items/{item_
-00023640: 6e61 6d65 7d2f 6173 7365 7473 2f7b 6173  name}/assets/{as
-00023650: 7365 745f 6e61 6d65 7d22 0a20 2020 2020  set_name}".     
-00023660: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-00023670: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
-00023680: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
-00023690: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
-000236a0: 2074 6167 2c0a 2020 2020 2020 2020 7d0a   tag,.        }.
-000236b0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-000236c0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000236d0: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
-000236e0: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
-000236f0: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00023700: 2072 6574 7572 6e20 7265 7370 6f6e 7365   return response
-00023710: 0a0a 2020 2020 6465 6620 7665 7269 6679  ..    def verify
-00023720: 5f61 7574 686f 7269 7a61 7469 6f6e 280a  _authorization(.
-00023730: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00023740: 2020 2020 2020 6175 7468 6f72 697a 6174        authorizat
-00023750: 696f 6e5f 7665 7269 6669 6361 7469 6f6e  ion_verification
-00023760: 5f69 6e70 7574 3a20 6d6c 7275 6e2e 636f  _input: mlrun.co
-00023770: 6d6d 6f6e 2e73 6368 656d 6173 2e41 7574  mmon.schemas.Aut
-00023780: 686f 7269 7a61 7469 6f6e 5665 7269 6669  horizationVerifi
-00023790: 6361 7469 6f6e 496e 7075 742c 0a20 2020  cationInput,.   
-000237a0: 2029 3a0a 2020 2020 2020 2020 2222 2256   ):.        """V
-000237b0: 6572 6966 6965 7320 6175 7468 6f72 697a  erifies authoriz
-000237c0: 6174 696f 6e20 666f 7220 7468 6520 7072  ation for the pr
-000237d0: 6f76 6964 6564 2061 6374 696f 6e20 6f6e  ovided action on
-000237e0: 2074 6865 2070 726f 7669 6465 6420 7265   the provided re
-000237f0: 736f 7572 6365 2e0a 0a20 2020 2020 2020  source...       
-00023800: 203a 7061 7261 6d20 6175 7468 6f72 697a   :param authoriz
-00023810: 6174 696f 6e5f 7665 7269 6669 6361 7469  ation_verificati
-00023820: 6f6e 5f69 6e70 7574 3a20 496e 7374 616e  on_input: Instan
-00023830: 6365 206f 660a 2020 2020 2020 2020 2020  ce of.          
-00023840: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
-00023850: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00023860: 6173 2e41 7574 686f 7269 7a61 7469 6f6e  as.Authorization
-00023870: 5665 7269 6669 6361 7469 6f6e 496e 7075  VerificationInpu
-00023880: 7460 2074 6861 7420 696e 636c 7564 6573  t` that includes
-00023890: 2061 6c6c 2074 6865 206e 6565 6465 6420   all the needed 
-000238a0: 7061 7261 6d65 7465 7273 2066 6f72 0a20  parameters for. 
-000238b0: 2020 2020 2020 2020 2020 2074 6865 2061             the a
-000238c0: 7574 6820 7665 7269 6669 6361 7469 6f6e  uth verification
-000238d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000238e0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-000238f0: 6765 203d 2022 4175 7468 6f72 697a 6174  ge = "Authorizat
-00023900: 696f 6e20 6368 6563 6b20 6661 696c 6564  ion check failed
-00023910: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-00023920: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-00023930: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
-00023940: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
-00023950: 697a 6174 696f 6e2f 7665 7269 6669 6361  ization/verifica
-00023960: 7469 6f6e 7322 2c0a 2020 2020 2020 2020  tions",.        
-00023970: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00023980: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
-00023990: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
-000239a0: 2861 7574 686f 7269 7a61 7469 6f6e 5f76  (authorization_v
-000239b0: 6572 6966 6963 6174 696f 6e5f 696e 7075  erification_inpu
-000239c0: 742e 6469 6374 2829 292c 0a20 2020 2020  t.dict()),.     
-000239d0: 2020 2029 0a0a 2020 2020 6465 6620 6c69     )..    def li
-000239e0: 7374 5f61 7069 5f67 6174 6577 6179 7328  st_api_gateways(
-000239f0: 7365 6c66 2c20 7072 6f6a 6563 743d 4e6f  self, project=No
-00023a00: 6e65 2920 2d3e 206d 6c72 756e 2e63 6f6d  ne) -> mlrun.com
-00023a10: 6d6f 6e2e 7363 6865 6d61 732e 4150 4947  mon.schemas.APIG
-00023a20: 6174 6577 6179 734f 7574 7075 743a 0a20  atewaysOutput:. 
-00023a30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023a40: 2020 2052 6574 7572 6e73 2061 206c 6973     Returns a lis
-00023a50: 7420 6f66 204e 7563 6c69 6f20 6170 6920  t of Nuclio api 
-00023a60: 6761 7465 7761 7973 0a20 2020 2020 2020  gateways.       
-00023a70: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00023a80: 206f 7074 696f 6e61 6c20 7374 7220 7061   optional str pa
-00023a90: 7261 6d65 7465 7220 746f 2066 696c 7465  rameter to filte
-00023aa0: 7220 6279 2070 726f 6a65 6374 2c20 6966  r by project, if
-00023ab0: 206e 6f74 2070 6173 7365 642c 2064 6566   not passed, def
-00023ac0: 6175 6c74 2070 726f 6a65 6374 2076 616c  ault project val
-00023ad0: 7565 2069 7320 7461 6b65 6e0a 0a20 2020  ue is taken..   
-00023ae0: 2020 2020 203a 7265 7475 726e 3a20 3a70       :return: :p
-00023af0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-00023b00: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e41  common.schemas.A
-00023b10: 5049 4761 7465 7761 7973 602e 0a20 2020  PIGateways`..   
-00023b20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00023b30: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00023b40: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00023b50: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00023b60: 2020 2020 2065 7272 6f72 203d 2022 6c69       error = "li
-00023b70: 7374 2061 7069 2067 6174 6577 6179 7322  st api gateways"
-00023b80: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-00023b90: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
-00023ba0: 6374 732f 7b70 726f 6a65 6374 7d2f 6170  cts/{project}/ap
-00023bb0: 692d 6761 7465 7761 7973 220a 2020 2020  i-gateways".    
-00023bc0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00023bd0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
-00023be0: 5422 2c20 656e 6470 6f69 6e74 5f70 6174  T", endpoint_pat
-00023bf0: 682c 2065 7272 6f72 290a 2020 2020 2020  h, error).      
-00023c00: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
-00023c10: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4150  ommon.schemas.AP
-00023c20: 4947 6174 6577 6179 734f 7574 7075 7428  IGatewaysOutput(
-00023c30: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-00023c40: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
-00023c50: 6170 695f 6761 7465 7761 7928 7365 6c66  api_gateway(self
-00023c60: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
-00023c70: 4e6f 6e65 2920 2d3e 206d 6c72 756e 2e63  None) -> mlrun.c
-00023c80: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4150  ommon.schemas.AP
-00023c90: 4947 6174 6577 6179 3a0a 2020 2020 2020  IGateway:.      
-00023ca0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00023cb0: 7475 726e 7320 616e 2041 5049 2067 6174  turns an API gat
-00023cc0: 6577 6179 0a20 2020 2020 2020 203a 7061  eway.        :pa
-00023cd0: 7261 6d20 6e61 6d65 3a20 4150 4920 6761  ram name: API ga
-00023ce0: 7465 7761 7920 6e61 6d65 0a20 2020 2020  teway name.     
-00023cf0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00023d00: 743a 206f 7074 696f 6e61 6c20 7374 7220  t: optional str 
-00023d10: 7061 7261 6d65 7465 7220 746f 2066 696c  parameter to fil
-00023d20: 7465 7220 6279 2070 726f 6a65 6374 2c20  ter by project, 
-00023d30: 6966 206e 6f74 2070 6173 7365 642c 2064  if not passed, d
-00023d40: 6566 6175 6c74 2070 726f 6a65 6374 2076  efault project v
-00023d50: 616c 7565 2069 7320 7461 6b65 6e0a 0a20  alue is taken.. 
-00023d60: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00023d70: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-00023d80: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00023d90: 732e 4150 4947 6174 6577 6179 602e 0a20  s.APIGateway`.. 
-00023da0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023db0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-00023dc0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-00023dd0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-00023de0: 2020 2020 2020 2065 7272 6f72 203d 2022         error = "
-00023df0: 6765 7420 6170 6920 6761 7465 7761 7922  get api gateway"
-00023e00: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-00023e10: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
-00023e20: 6374 732f 7b70 726f 6a65 6374 7d2f 6170  cts/{project}/ap
-00023e30: 692d 6761 7465 7761 7973 2f7b 6e61 6d65  i-gateways/{name
-00023e40: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
-00023e50: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-00023e60: 616c 6c28 2247 4554 222c 2065 6e64 706f  all("GET", endpo
-00023e70: 696e 745f 7061 7468 2c20 6572 726f 7229  int_path, error)
-00023e80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023e90: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00023ea0: 656d 6173 2e41 5049 4761 7465 7761 7928  emas.APIGateway(
-00023eb0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-00023ec0: 2929 0a0a 2020 2020 6465 6620 6465 6c65  ))..    def dele
-00023ed0: 7465 5f61 7069 5f67 6174 6577 6179 2873  te_api_gateway(s
-00023ee0: 656c 662c 206e 616d 652c 2070 726f 6a65  elf, name, proje
-00023ef0: 6374 3d4e 6f6e 6529 3a0a 2020 2020 2020  ct=None):.      
-00023f00: 2020 2222 220a 2020 2020 2020 2020 4465    """.        De
-00023f10: 6c65 7465 7320 616e 2041 5049 2067 6174  letes an API gat
-00023f20: 6577 6179 0a20 2020 2020 2020 203a 7061  eway.        :pa
-00023f30: 7261 6d20 6e61 6d65 3a20 4150 4920 6761  ram name: API ga
-00023f40: 7465 7761 7920 6e61 6d65 0a20 2020 2020  teway name.     
-00023f50: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00023f60: 743a 2050 726f 6a65 6374 206e 616d 650a  t: Project name.
-00023f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00023f80: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00023f90: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00023fa0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00023fb0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00023fc0: 2264 656c 6574 6520 6170 6920 6761 7465  "delete api gate
-00023fd0: 7761 7922 0a20 2020 2020 2020 2065 6e64  way".        end
-00023fe0: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
-00023ff0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00024000: 7d2f 6170 692d 6761 7465 7761 7973 2f7b  }/api-gateways/{
-00024010: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-00024020: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
-00024030: 4c45 5445 222c 2065 6e64 706f 696e 745f  LETE", endpoint_
-00024040: 7061 7468 2c20 6572 726f 7229 0a0a 2020  path, error)..  
-00024050: 2020 6465 6620 7374 6f72 655f 6170 695f    def store_api_
-00024060: 6761 7465 7761 7928 0a20 2020 2020 2020  gateway(.       
-00024070: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00024080: 7069 5f67 6174 6577 6179 3a20 556e 696f  pi_gateway: Unio
-00024090: 6e5b 0a20 2020 2020 2020 2020 2020 206d  n[.            m
-000240a0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-000240b0: 6d61 732e 4150 4947 6174 6577 6179 2c0a  mas.APIGateway,.
-000240c0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
-000240d0: 6e2e 7275 6e74 696d 6573 2e6e 7563 6c69  n.runtimes.nucli
-000240e0: 6f2e 6170 695f 6761 7465 7761 792e 4150  o.api_gateway.AP
-000240f0: 4947 6174 6577 6179 2c0a 2020 2020 2020  IGateway,.      
-00024100: 2020 5d2c 0a20 2020 2020 2020 2070 726f    ],.        pro
-00024110: 6a65 6374 3a20 4f70 7469 6f6e 616c 5b73  ject: Optional[s
-00024120: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00024130: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-00024140: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
-00024150: 6577 6179 3a0a 2020 2020 2020 2020 2222  eway:.        ""
-00024160: 220a 2020 2020 2020 2020 5374 6f72 6573  ".        Stores
-00024170: 2061 6e20 4150 4920 4761 7465 7761 792e   an API Gateway.
-00024180: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00024190: 6170 695f 6761 7465 7761 7920 3a70 793a  api_gateway :py:
-000241a0: 636c 6173 733a 607e 6d6c 7275 6e2e 7275  class:`~mlrun.ru
-000241b0: 6e74 696d 6573 2e6e 7563 6c69 6f2e 4150  ntimes.nuclio.AP
-000241c0: 4947 6174 6577 6179 600a 2020 2020 2020  IGateway`.      
-000241d0: 2020 2020 2020 6f72 203a 7079 3a63 6c61        or :py:cla
-000241e0: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
-000241f0: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
-00024200: 6577 6179 603a 2041 5049 2047 6174 6577  eway`: API Gatew
-00024210: 6179 2065 6e74 6974 792e 0a20 2020 2020  ay entity..     
-00024220: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00024230: 743a 2070 726f 6a65 6374 206e 616d 652e  t: project name.
-00024240: 204d 616e 6461 746f 7279 2069 6620 6170   Mandatory if ap
-00024250: 695f 6761 7465 7761 7920 6973 206d 6c72  i_gateway is mlr
-00024260: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00024270: 732e 4150 4947 6174 6577 6179 2e0a 0a20  s.APIGateway... 
-00024280: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
-00024290: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-000242a0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000242b0: 732e 4150 4947 6174 6577 6179 602e 0a20  s.APIGateway`.. 
-000242c0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-000242d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000242e0: 6528 6170 695f 6761 7465 7761 792c 206d  e(api_gateway, m
-000242f0: 6c72 756e 2e72 756e 7469 6d65 732e 6e75  lrun.runtimes.nu
-00024300: 636c 696f 2e61 7069 5f67 6174 6577 6179  clio.api_gateway
-00024310: 2e41 5049 4761 7465 7761 7929 3a0a 2020  .APIGateway):.  
-00024320: 2020 2020 2020 2020 2020 6170 695f 6761            api_ga
-00024330: 7465 7761 7920 3d20 6170 695f 6761 7465  teway = api_gate
-00024340: 7761 792e 746f 5f73 6368 656d 6528 290a  way.to_scheme().
-00024350: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
-00024360: 5f70 6174 6820 3d20 6622 7072 6f6a 6563  _path = f"projec
-00024370: 7473 2f7b 7072 6f6a 6563 747d 2f61 7069  ts/{project}/api
-00024380: 2d67 6174 6577 6179 732f 7b61 7069 5f67  -gateways/{api_g
-00024390: 6174 6577 6179 2e6d 6574 6164 6174 612e  ateway.metadata.
-000243a0: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
-000243b0: 7272 6f72 203d 2022 7374 6f72 6520 6170  rror = "store ap
-000243c0: 6920 6761 7465 7761 7973 220a 2020 2020  i gateways".    
-000243d0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-000243e0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-000243f0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
-00024400: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-00024410: 706f 696e 745f 7061 7468 2c0a 2020 2020  point_path,.    
-00024420: 2020 2020 2020 2020 6572 726f 722c 0a20          error,. 
-00024430: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
-00024440: 6170 695f 6761 7465 7761 792e 6469 6374  api_gateway.dict
-00024450: 2865 7863 6c75 6465 5f6e 6f6e 653d 5472  (exclude_none=Tr
-00024460: 7565 292c 0a20 2020 2020 2020 2029 0a20  ue),.        ). 
-00024470: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
-00024480: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00024490: 6173 2e41 5049 4761 7465 7761 7928 2a2a  as.APIGateway(**
-000244a0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-000244b0: 0a0a 2020 2020 6465 6620 7472 6967 6765  ..    def trigge
-000244c0: 725f 6d69 6772 6174 696f 6e73 2873 656c  r_migrations(sel
-000244d0: 6629 202d 3e20 4f70 7469 6f6e 616c 5b6d  f) -> Optional[m
-000244e0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-000244f0: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
-00024500: 736b 5d3a 0a20 2020 2020 2020 2022 2222  sk]:.        """
-00024510: 5472 6967 6765 7220 6d69 6772 6174 696f  Trigger migratio
-00024520: 6e73 2028 7769 6c6c 2064 6f20 6e6f 7468  ns (will do noth
-00024530: 696e 6720 6966 206e 6f20 6d69 6772 6174  ing if no migrat
-00024540: 696f 6e73 2061 7265 206e 6565 6465 6429  ions are needed)
-00024550: 2061 6e64 2077 6169 7420 666f 7220 7468   and wait for th
-00024560: 656d 2074 6f20 6669 6e69 7368 2069 6620  em to finish if 
-00024570: 6163 7475 616c 6c79 0a20 2020 2020 2020  actually.       
-00024580: 2074 7269 6767 6572 6564 0a20 2020 2020   triggered.     
-00024590: 2020 203a 7265 7475 726e 733a 203a 7079     :returns: :py
-000245a0: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
-000245b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4261  ommon.schemas.Ba
-000245c0: 636b 6772 6f75 6e64 5461 736b 602e 0a20  ckgroundTask`.. 
-000245d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000245e0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-000245f0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00024600: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
-00024610: 0a20 2020 2020 2020 2020 2020 2022 6f70  .            "op
-00024620: 6572 6174 696f 6e73 2f6d 6967 7261 7469  erations/migrati
-00024630: 6f6e 7322 2c0a 2020 2020 2020 2020 2020  ons",.          
-00024640: 2020 2246 6169 6c65 6420 7472 6967 6765    "Failed trigge
-00024650: 7269 6e67 206d 6967 7261 7469 6f6e 7322  ring migrations"
-00024660: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00024670: 2020 2020 6966 2072 6573 706f 6e73 652e      if response.
-00024680: 7374 6174 7573 5f63 6f64 6520 3d3d 2068  status_code == h
-00024690: 7474 702e 4854 5450 5374 6174 7573 2e41  ttp.HTTPStatus.A
-000246a0: 4343 4550 5445 443a 0a20 2020 2020 2020  CCEPTED:.       
-000246b0: 2020 2020 2062 6163 6b67 726f 756e 645f       background_
-000246c0: 7461 736b 203d 206d 6c72 756e 2e63 6f6d  task = mlrun.com
-000246d0: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
-000246e0: 6772 6f75 6e64 5461 736b 282a 2a72 6573  groundTask(**res
-000246f0: 706f 6e73 652e 6a73 6f6e 2829 290a 2020  ponse.json()).  
-00024700: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00024710: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
-00024720: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
-00024730: 746f 5f72 6561 6368 5f74 6572 6d69 6e61  to_reach_termina
-00024740: 6c5f 7374 6174 6528 0a20 2020 2020 2020  l_state(.       
-00024750: 2020 2020 2020 2020 2062 6163 6b67 726f           backgro
-00024760: 756e 645f 7461 736b 2e6d 6574 6164 6174  und_task.metadat
-00024770: 612e 6e61 6d65 0a20 2020 2020 2020 2020  a.name.         
-00024780: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00024790: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
-000247a0: 6620 7365 745f 7275 6e5f 6e6f 7469 6669  f set_run_notifi
-000247b0: 6361 7469 6f6e 7328 0a20 2020 2020 2020  cations(.       
-000247c0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-000247d0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-000247e0: 2020 2020 2072 756e 5f75 6964 3a20 7374       run_uid: st
-000247f0: 722c 0a20 2020 2020 2020 206e 6f74 6966  r,.        notif
-00024800: 6963 6174 696f 6e73 3a20 6c69 7374 5b6d  ications: list[m
-00024810: 6c72 756e 2e6d 6f64 656c 2e4e 6f74 6966  lrun.model.Notif
-00024820: 6963 6174 696f 6e5d 203d 204e 6f6e 652c  ication] = None,
-00024830: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00024840: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
-00024850: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
-00024860: 2061 2072 756e 2e20 5468 6973 2077 696c   a run. This wil
-00024870: 6c20 6f76 6572 7269 6465 2061 6e79 2065  l override any e
-00024880: 7869 7374 696e 6720 6e6f 7469 6669 6361  xisting notifica
-00024890: 7469 6f6e 7320 6f6e 2074 6865 2072 756e  tions on the run
-000248a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000248b0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-000248c0: 7420 636f 6e74 6169 6e69 6e67 2074 6865  t containing the
-000248d0: 2072 756e 2e0a 2020 2020 2020 2020 3a70   run..        :p
-000248e0: 6172 616d 2072 756e 5f75 6964 3a20 5549  aram run_uid: UI
-000248f0: 4420 6f66 2074 6865 2072 756e 2e0a 2020  D of the run..  
-00024900: 2020 2020 2020 3a70 6172 616d 206e 6f74        :param not
-00024910: 6966 6963 6174 696f 6e73 3a20 4c69 7374  ifications: List
-00024920: 206f 6620 6e6f 7469 6669 6361 7469 6f6e   of notification
-00024930: 7320 746f 2073 6574 206f 6e20 7468 6520  s to set on the 
-00024940: 7275 6e2e 2044 6566 6175 6c74 2069 7320  run. Default is 
-00024950: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
-00024960: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00024970: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
-00024980: 203d 206e 6f74 6966 6963 6174 696f 6e73   = notifications
-00024990: 206f 7220 5b5d 0a0a 2020 2020 2020 2020   or []..        
-000249a0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-000249b0: 2020 2020 2020 2020 2020 2022 5055 5422             "PUT"
-000249c0: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
-000249d0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-000249e0: 747d 2f72 756e 732f 7b72 756e 5f75 6964  t}/runs/{run_uid
-000249f0: 7d2f 6e6f 7469 6669 6361 7469 6f6e 7322  }/notifications"
-00024a00: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
-00024a10: 4661 696c 6564 2074 6f20 7365 7420 6e6f  Failed to set no
-00024a20: 7469 6669 6361 7469 6f6e 7320 6f6e 2072  tifications on r
-00024a30: 756e 2e20 7569 643d 7b72 756e 5f75 6964  un. uid={run_uid
-00024a40: 7d2c 2070 726f 6a65 6374 3d7b 7072 6f6a  }, project={proj
-00024a50: 6563 747d 222c 0a20 2020 2020 2020 2020  ect}",.         
-00024a60: 2020 206a 736f 6e3d 7b0a 2020 2020 2020     json={.      
-00024a70: 2020 2020 2020 2020 2020 226e 6f74 6966            "notif
-00024a80: 6963 6174 696f 6e73 223a 205b 0a20 2020  ications": [.   
-00024a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024aa0: 206e 6f74 6966 6963 6174 696f 6e2e 746f   notification.to
-00024ab0: 5f64 6963 7428 2920 666f 7220 6e6f 7469  _dict() for noti
-00024ac0: 6669 6361 7469 6f6e 2069 6e20 6e6f 7469  fication in noti
-00024ad0: 6669 6361 7469 6f6e 730a 2020 2020 2020  fications.      
-00024ae0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00024af0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00024b00: 2020 2020 290a 0a20 2020 2064 6566 2073      )..    def s
-00024b10: 6574 5f73 6368 6564 756c 655f 6e6f 7469  et_schedule_noti
-00024b20: 6669 6361 7469 6f6e 7328 0a20 2020 2020  fications(.     
-00024b30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00024b40: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-00024b50: 2020 2020 2020 2073 6368 6564 756c 655f         schedule_
-00024b60: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
-00024b70: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
-00024b80: 3a20 6c69 7374 5b6d 6c72 756e 2e6d 6f64  : list[mlrun.mod
-00024b90: 656c 2e4e 6f74 6966 6963 6174 696f 6e5d  el.Notification]
-00024ba0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-00024bb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00024bc0: 2020 2020 5365 7420 6e6f 7469 6669 6361      Set notifica
-00024bd0: 7469 6f6e 7320 6f6e 2061 2073 6368 6564  tions on a sched
-00024be0: 756c 652e 2054 6869 7320 7769 6c6c 206f  ule. This will o
-00024bf0: 7665 7272 6964 6520 616e 7920 6578 6973  verride any exis
-00024c00: 7469 6e67 206e 6f74 6966 6963 6174 696f  ting notificatio
-00024c10: 6e73 206f 6e20 7468 6520 7363 6865 6475  ns on the schedu
-00024c20: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
-00024c30: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-00024c40: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
-00024c50: 6865 2073 6368 6564 756c 652e 0a20 2020  he schedule..   
-00024c60: 2020 2020 203a 7061 7261 6d20 7363 6865       :param sche
-00024c70: 6475 6c65 5f6e 616d 653a 204e 616d 6520  dule_name: Name 
-00024c80: 6f66 2074 6865 2073 6368 6564 756c 652e  of the schedule.
-00024c90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00024ca0: 6e6f 7469 6669 6361 7469 6f6e 733a 204c  notifications: L
-00024cb0: 6973 7420 6f66 206e 6f74 6966 6963 6174  ist of notificat
-00024cc0: 696f 6e73 2074 6f20 7365 7420 6f6e 2074  ions to set on t
-00024cd0: 6865 2073 6368 6564 756c 652e 2044 6566  he schedule. Def
-00024ce0: 6175 6c74 2069 7320 616e 2065 6d70 7479  ault is an empty
-00024cf0: 206c 6973 742e 0a20 2020 2020 2020 2022   list..        "
-00024d00: 2222 0a20 2020 2020 2020 206e 6f74 6966  "".        notif
-00024d10: 6963 6174 696f 6e73 203d 206e 6f74 6966  ications = notif
-00024d20: 6963 6174 696f 6e73 206f 7220 5b5d 0a0a  ications or []..
-00024d30: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-00024d40: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00024d50: 2020 2022 5055 5422 2c0a 2020 2020 2020     "PUT",.      
-00024d60: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
-00024d70: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
-00024d80: 756c 6573 2f7b 7363 6865 6475 6c65 5f6e  ules/{schedule_n
-00024d90: 616d 657d 2f6e 6f74 6966 6963 6174 696f  ame}/notificatio
-00024da0: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
-00024db0: 2066 2246 6169 6c65 6420 746f 2073 6574   f"Failed to set
-00024dc0: 206e 6f74 6966 6963 6174 696f 6e73 206f   notifications o
-00024dd0: 6e20 7363 6865 6475 6c65 2e20 7363 6865  n schedule. sche
-00024de0: 6475 6c65 3d7b 7363 6865 6475 6c65 5f6e  dule={schedule_n
-00024df0: 616d 657d 2c20 7072 6f6a 6563 743d 7b70  ame}, project={p
-00024e00: 726f 6a65 6374 7d22 2c0a 2020 2020 2020  roject}",.      
-00024e10: 2020 2020 2020 6a73 6f6e 3d7b 0a20 2020        json={.   
-00024e20: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
-00024e30: 7469 6669 6361 7469 6f6e 7322 3a20 5b0a  tifications": [.
-00024e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e50: 2020 2020 6e6f 7469 6669 6361 7469 6f6e      notification
-00024e60: 2e74 6f5f 6469 6374 2829 2066 6f72 206e  .to_dict() for n
-00024e70: 6f74 6966 6963 6174 696f 6e20 696e 206e  otification in n
-00024e80: 6f74 6966 6963 6174 696f 6e73 0a20 2020  otifications.   
-00024e90: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
-00024ea0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-00024eb0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00024ec0: 6620 7374 6f72 655f 7275 6e5f 6e6f 7469  f store_run_noti
-00024ed0: 6669 6361 7469 6f6e 7328 0a20 2020 2020  fications(.     
-00024ee0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00024ef0: 206e 6f74 6966 6963 6174 696f 6e5f 6f62   notification_ob
-00024f00: 6a65 6374 733a 206c 6973 745b 6d6c 7275  jects: list[mlru
-00024f10: 6e2e 6d6f 6465 6c2e 4e6f 7469 6669 6361  n.model.Notifica
-00024f20: 7469 6f6e 5d2c 0a20 2020 2020 2020 2072  tion],.        r
-00024f30: 756e 5f75 6964 3a20 7374 722c 0a20 2020  un_uid: str,.   
-00024f40: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00024f50: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00024f60: 2020 6d61 736b 5f70 6172 616d 733a 2062    mask_params: b
-00024f70: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00024f80: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00024f90: 2020 2020 2020 2046 6f72 2069 6e74 6572         For inter
-00024fa0: 6e61 6c20 7573 652e 0a20 2020 2020 2020  nal use..       
-00024fb0: 2054 6865 206e 6f74 6966 6963 6174 696f   The notificatio
-00024fc0: 6e20 6d65 6368 616e 6973 6d20 6d61 7920  n mechanism may 
-00024fd0: 7275 6e20 226c 6f63 616c 6c79 2220 666f  run "locally" fo
-00024fe0: 7220 6365 7274 6169 6e20 7275 6e74 696d  r certain runtim
-00024ff0: 6573 2e0a 2020 2020 2020 2020 486f 7765  es..        Howe
-00025000: 7665 722c 2074 6865 2075 7064 6174 6573  ver, the updates
-00025010: 206f 6363 7572 2069 6e20 7468 6520 4150   occur in the AP
-00025020: 4920 736f 206e 6f74 6869 6e67 2074 6f20  I so nothing to 
-00025030: 646f 2068 6572 652e 0a20 2020 2020 2020  do here..       
-00025040: 2022 2222 0a20 2020 2020 2020 2070 6173   """.        pas
-00025050: 730a 0a20 2020 2064 6566 2073 7562 6d69  s..    def submi
-00025060: 745f 776f 726b 666c 6f77 280a 2020 2020  t_workflow(.    
-00025070: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00025080: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
-00025090: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
-000250a0: 722c 0a20 2020 2020 2020 2077 6f72 6b66  r,.        workf
-000250b0: 6c6f 775f 7370 6563 3a20 556e 696f 6e5b  low_spec: Union[
-000250c0: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
-000250d0: 756e 2e70 726f 6a65 6374 732e 7069 7065  un.projects.pipe
-000250e0: 6c69 6e65 732e 576f 726b 666c 6f77 5370  lines.WorkflowSp
-000250f0: 6563 2c0a 2020 2020 2020 2020 2020 2020  ec,.            
-00025100: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00025110: 656d 6173 2e57 6f72 6b66 6c6f 7753 7065  emas.WorkflowSpe
-00025120: 632c 0a20 2020 2020 2020 2020 2020 2064  c,.            d
-00025130: 6963 742c 0a20 2020 2020 2020 205d 2c0a  ict,.        ],.
-00025140: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00025150: 733a 204f 7074 696f 6e61 6c5b 6469 6374  s: Optional[dict
-00025160: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00025170: 2020 6172 7469 6661 6374 5f70 6174 683a    artifact_path:
-00025180: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-00025190: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-000251a0: 6f75 7263 653a 204f 7074 696f 6e61 6c5b  ource: Optional[
-000251b0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-000251c0: 2020 2020 2072 756e 5f6e 616d 653a 204f       run_name: O
-000251d0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-000251e0: 6f6e 652c 0a20 2020 2020 2020 206e 616d  one,.        nam
-000251f0: 6573 7061 6365 3a20 4f70 7469 6f6e 616c  espace: Optional
-00025200: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00025210: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
-00025220: 6f6e 733a 206c 6973 745b 6d6c 7275 6e2e  ons: list[mlrun.
-00025230: 6d6f 6465 6c2e 4e6f 7469 6669 6361 7469  model.Notificati
-00025240: 6f6e 5d20 3d20 4e6f 6e65 2c0a 2020 2020  on] = None,.    
-00025250: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-00025260: 6e2e 7363 6865 6d61 732e 576f 726b 666c  n.schemas.Workfl
-00025270: 6f77 5265 7370 6f6e 7365 3a0a 2020 2020  owResponse:.    
-00025280: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00025290: 5375 626d 6974 7469 6e67 2077 6f72 6b66  Submitting workf
-000252a0: 6c6f 7720 666f 7220 6120 7265 6d6f 7465  low for a remote
-000252b0: 2065 7865 6375 7469 6f6e 2e0a 0a20 2020   execution...   
-000252c0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-000252d0: 6563 743a 2020 2020 2020 2020 2070 726f  ect:         pro
-000252e0: 6a65 6374 206e 616d 650a 2020 2020 2020  ject name.      
-000252f0: 2020 3a70 6172 616d 206e 616d 653a 2020    :param name:  
-00025300: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
-00025310: 6f77 206e 616d 650a 2020 2020 2020 2020  ow name.        
-00025320: 3a70 6172 616d 2077 6f72 6b66 6c6f 775f  :param workflow_
-00025330: 7370 6563 3a20 2020 7468 6520 776f 726b  spec:   the work
-00025340: 666c 6f77 2073 7065 6320 746f 2065 7865  flow spec to exe
-00025350: 6375 7465 0a20 2020 2020 2020 203a 7061  cute.        :pa
-00025360: 7261 6d20 6172 6775 6d65 6e74 733a 2020  ram arguments:  
-00025370: 2020 2020 2061 7267 756d 656e 7473 2066       arguments f
-00025380: 6f72 2074 6865 2077 6f72 6b66 6c6f 770a  or the workflow.
-00025390: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-000253a0: 7274 6966 6163 745f 7061 7468 3a20 2020  rtifact_path:   
-000253b0: 6172 7469 6661 6374 2074 6172 6765 7420  artifact target 
-000253c0: 7061 7468 206f 6620 7468 6520 776f 726b  path of the work
-000253d0: 666c 6f77 0a20 2020 2020 2020 203a 7061  flow.        :pa
-000253e0: 7261 6d20 736f 7572 6365 3a20 2020 2020  ram source:     
-000253f0: 2020 2020 2073 6f75 7263 6520 7572 6c20       source url 
-00025400: 6f66 2074 6865 2070 726f 6a65 6374 0a20  of the project. 
-00025410: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
-00025420: 6e5f 6e61 6d65 3a20 2020 2020 2020 2072  n_name:        r
-00025430: 756e 206e 616d 6520 746f 206f 7665 7272  un name to overr
-00025440: 6964 6520 7468 6520 6465 6661 756c 743a  ide the default:
-00025450: 2027 776f 726b 666c 6f77 2d72 756e 6e65   'workflow-runne
-00025460: 722d 3c77 6f72 6b66 6c6f 7720 6e61 6d65  r-<workflow name
-00025470: 3e27 0a20 2020 2020 2020 203a 7061 7261  >'.        :para
-00025480: 6d20 6e61 6d65 7370 6163 653a 2020 2020  m namespace:    
-00025490: 2020 206b 7562 6572 6e65 7465 7320 6e61     kubernetes na
-000254a0: 6d65 7370 6163 6520 6966 206f 7468 6572  mespace if other
-000254b0: 2074 6861 6e20 6465 6661 756c 740a 2020   than default.  
-000254c0: 2020 2020 2020 3a70 6172 616d 206e 6f74        :param not
-000254d0: 6966 6963 6174 696f 6e73 3a20 2020 6c69  ifications:   li
-000254e0: 7374 206f 6620 6e6f 7469 6669 6361 7469  st of notificati
-000254f0: 6f6e 7320 746f 2073 656e 6420 7768 656e  ons to send when
-00025500: 2077 6f72 6b66 6c6f 7720 6578 6563 7574   workflow execut
-00025510: 696f 6e20 6973 2063 6f6d 706c 6574 6564  ion is completed
-00025520: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00025530: 6e73 3a20 2020 203a 7079 3a63 6c61 7373  ns:    :py:class
-00025540: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-00025550: 7363 6865 6d61 732e 576f 726b 666c 6f77  schemas.Workflow
-00025560: 5265 7370 6f6e 7365 602e 0a20 2020 2020  Response`..     
-00025570: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00025580: 6d61 6765 203d 2028 0a20 2020 2020 2020  mage = (.       
-00025590: 2020 2020 2077 6f72 6b66 6c6f 775f 7370       workflow_sp
-000255a0: 6563 2e69 6d61 6765 0a20 2020 2020 2020  ec.image.       
-000255b0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
-000255c0: 776f 726b 666c 6f77 5f73 7065 632c 2022  workflow_spec, "
-000255d0: 696d 6167 6522 290a 2020 2020 2020 2020  image").        
-000255e0: 2020 2020 656c 7365 2077 6f72 6b66 6c6f      else workflo
-000255f0: 775f 7370 6563 2e67 6574 2822 696d 6167  w_spec.get("imag
-00025600: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
-00025610: 2020 290a 2020 2020 2020 2020 776f 726b    ).        work
-00025620: 666c 6f77 5f6e 616d 6520 3d20 6e61 6d65  flow_name = name
-00025630: 206f 7220 280a 2020 2020 2020 2020 2020   or (.          
-00025640: 2020 776f 726b 666c 6f77 5f73 7065 632e    workflow_spec.
-00025650: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-00025660: 2069 6620 6861 7361 7474 7228 776f 726b   if hasattr(work
-00025670: 666c 6f77 5f73 7065 632c 2022 6e61 6d65  flow_spec, "name
-00025680: 2229 0a20 2020 2020 2020 2020 2020 2065  ").            e
-00025690: 6c73 6520 776f 726b 666c 6f77 5f73 7065  lse workflow_spe
-000256a0: 632e 6765 7428 226e 616d 6522 2c20 4e6f  c.get("name", No
-000256b0: 6e65 290a 2020 2020 2020 2020 290a 2020  ne).        ).  
-000256c0: 2020 2020 2020 7265 7120 3d20 7b0a 2020        req = {.  
-000256d0: 2020 2020 2020 2020 2020 2261 7267 756d            "argum
-000256e0: 656e 7473 223a 2061 7267 756d 656e 7473  ents": arguments
-000256f0: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
-00025700: 7274 6966 6163 745f 7061 7468 223a 2061  rtifact_path": a
-00025710: 7274 6966 6163 745f 7061 7468 2c0a 2020  rtifact_path,.  
-00025720: 2020 2020 2020 2020 2020 2273 6f75 7263            "sourc
-00025730: 6522 3a20 736f 7572 6365 2c0a 2020 2020  e": source,.    
-00025740: 2020 2020 2020 2020 2272 756e 5f6e 616d          "run_nam
-00025750: 6522 3a20 7275 6e5f 6e61 6d65 2c0a 2020  e": run_name,.  
-00025760: 2020 2020 2020 2020 2020 226e 616d 6573            "names
-00025770: 7061 6365 223a 206e 616d 6573 7061 6365  pace": namespace
-00025780: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00025790: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000257a0: 6528 0a20 2020 2020 2020 2020 2020 2077  e(.            w
-000257b0: 6f72 6b66 6c6f 775f 7370 6563 2c0a 2020  orkflow_spec,.  
-000257c0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-000257d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e57  common.schemas.W
-000257e0: 6f72 6b66 6c6f 7753 7065 632c 0a20 2020  orkflowSpec,.   
-000257f0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00025800: 2020 2020 7265 715b 2273 7065 6322 5d20      req["spec"] 
-00025810: 3d20 776f 726b 666c 6f77 5f73 7065 632e  = workflow_spec.
-00025820: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00025830: 6c69 6620 6973 696e 7374 616e 6365 2877  lif isinstance(w
-00025840: 6f72 6b66 6c6f 775f 7370 6563 2c20 6d6c  orkflow_spec, ml
-00025850: 7275 6e2e 7072 6f6a 6563 7473 2e70 6970  run.projects.pip
-00025860: 656c 696e 6573 2e57 6f72 6b66 6c6f 7753  elines.WorkflowS
-00025870: 7065 6329 3a0a 2020 2020 2020 2020 2020  pec):.          
-00025880: 2020 7265 715b 2273 7065 6322 5d20 3d20    req["spec"] = 
-00025890: 776f 726b 666c 6f77 5f73 7065 632e 746f  workflow_spec.to
-000258a0: 5f64 6963 7428 290a 2020 2020 2020 2020  _dict().        
-000258b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000258c0: 2020 7265 715b 2273 7065 6322 5d20 3d20    req["spec"] = 
-000258d0: 776f 726b 666c 6f77 5f73 7065 630a 2020  workflow_spec.  
-000258e0: 2020 2020 2020 7265 715b 2273 7065 6322        req["spec"
-000258f0: 5d5b 2269 6d61 6765 225d 203d 2069 6d61  ]["image"] = ima
-00025900: 6765 0a20 2020 2020 2020 2072 6571 5b22  ge.        req["
-00025910: 7370 6563 225d 5b22 6e61 6d65 225d 203d  spec"]["name"] =
-00025920: 2077 6f72 6b66 6c6f 775f 6e61 6d65 0a20   workflow_name. 
-00025930: 2020 2020 2020 2069 6620 6e6f 7469 6669         if notifi
-00025940: 6361 7469 6f6e 733a 0a20 2020 2020 2020  cations:.       
-00025950: 2020 2020 2072 6571 5b22 6e6f 7469 6669       req["notifi
-00025960: 6361 7469 6f6e 7322 5d20 3d20 5b0a 2020  cations"] = [.  
-00025970: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-00025980: 7469 6669 6361 7469 6f6e 2e74 6f5f 6469  tification.to_di
-00025990: 6374 2829 2066 6f72 206e 6f74 6966 6963  ct() for notific
-000259a0: 6174 696f 6e20 696e 206e 6f74 6966 6963  ation in notific
-000259b0: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
-000259c0: 2020 205d 0a0a 2020 2020 2020 2020 7265     ]..        re
-000259d0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-000259e0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-000259f0: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-00025a00: 2020 2020 2020 2020 6622 7072 6f6a 6563          f"projec
-00025a10: 7473 2f7b 7072 6f6a 6563 747d 2f77 6f72  ts/{project}/wor
-00025a20: 6b66 6c6f 7773 2f7b 776f 726b 666c 6f77  kflows/{workflow
-00025a30: 5f6e 616d 657d 2f73 7562 6d69 7422 2c0a  _name}/submit",.
-00025a40: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
-00025a50: 3d72 6571 2c0a 2020 2020 2020 2020 290a  =req,.        ).
-00025a60: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-00025a70: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00025a80: 6d61 732e 576f 726b 666c 6f77 5265 7370  mas.WorkflowResp
-00025a90: 6f6e 7365 282a 2a72 6573 706f 6e73 652e  onse(**response.
-00025aa0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-00025ab0: 2067 6574 5f77 6f72 6b66 6c6f 775f 6964   get_workflow_id
-00025ac0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00025ad0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-00025ae0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
-00025af0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00025b00: 2072 756e 5f69 643a 2073 7472 2c0a 2020   run_id: str,.  
-00025b10: 2020 2020 2020 656e 6769 6e65 3a20 7374        engine: st
-00025b20: 7220 3d20 2222 2c0a 2020 2020 293a 0a20  r = "",.    ):. 
-00025b30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00025b40: 2020 2052 6574 7269 6576 6520 776f 726b     Retrieve work
-00025b50: 666c 6f77 2069 6420 6672 6f6d 2074 6865  flow id from the
-00025b60: 2075 6964 206f 6620 7468 6520 776f 726b   uid of the work
-00025b70: 666c 6f77 2072 756e 6e65 722e 0a0a 2020  flow runner...  
-00025b80: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-00025b90: 6a65 6374 3a20 7072 6f6a 6563 7420 6e61  ject: project na
-00025ba0: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
-00025bb0: 6d20 6e61 6d65 3a20 2020 2077 6f72 6b66  m name:    workf
-00025bc0: 6c6f 7720 6e61 6d65 0a20 2020 2020 2020  low name.       
-00025bd0: 203a 7061 7261 6d20 7275 6e5f 6964 3a20   :param run_id: 
-00025be0: 2074 6865 2069 6420 6f66 2074 6865 2077   the id of the w
-00025bf0: 6f72 6b66 6c6f 7720 7275 6e6e 6572 202d  orkflow runner -
-00025c00: 2074 6865 206a 6f62 2074 6861 7420 7275   the job that ru
-00025c10: 6e73 2074 6865 2077 6f72 6b66 6c6f 770a  ns the workflow.
-00025c20: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
-00025c30: 6e67 696e 653a 2020 7069 7065 6c69 6e65  ngine:  pipeline
-00025c40: 2072 756e 6e65 720a 0a20 2020 2020 2020   runner..       
-00025c50: 203a 7265 7475 726e 733a 2020 203a 7079   :returns:   :py
-00025c60: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
-00025c70: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4765  ommon.schemas.Ge
-00025c80: 7457 6f72 6b66 6c6f 7752 6573 706f 6e73  tWorkflowRespons
-00025c90: 6560 2e0a 2020 2020 2020 2020 2222 220a  e`..        """.
-00025ca0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00025cb0: 207b 7d0a 2020 2020 2020 2020 6966 2065   {}.        if e
-00025cc0: 6e67 696e 653a 0a20 2020 2020 2020 2020  ngine:.         
-00025cd0: 2020 2070 6172 616d 735b 2265 6e67 696e     params["engin
-00025ce0: 6522 5d20 3d20 656e 6769 6e65 0a20 2020  e"] = engine.   
-00025cf0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-00025d00: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-00025d10: 2020 2020 2020 2020 2020 2022 4745 5422             "GET"
-00025d20: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
-00025d30: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00025d40: 747d 2f77 6f72 6b66 6c6f 7773 2f7b 6e61  t}/workflows/{na
-00025d50: 6d65 7d2f 7275 6e73 2f7b 7275 6e5f 6964  me}/runs/{run_id
-00025d60: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
-00025d70: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
-00025d80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00025d90: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-00025da0: 6d6d 6f6e 2e73 6368 656d 6173 2e47 6574  mmon.schemas.Get
-00025db0: 576f 726b 666c 6f77 5265 7370 6f6e 7365  WorkflowResponse
-00025dc0: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-00025dd0: 2829 290a 0a20 2020 2064 6566 206c 6f61  ())..    def loa
-00025de0: 645f 7072 6f6a 6563 7428 0a20 2020 2020  d_project(.     
-00025df0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00025e00: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-00025e10: 2020 2020 7572 6c3a 2073 7472 2c0a 2020      url: str,.  
-00025e20: 2020 2020 2020 7365 6372 6574 733a 204f        secrets: O
-00025e30: 7074 696f 6e61 6c5b 6469 6374 5d20 3d20  ptional[dict] = 
-00025e40: 4e6f 6e65 2c0a 2020 2020 2020 2020 7361  None,.        sa
-00025e50: 7665 5f73 6563 7265 7473 3a20 626f 6f6c  ve_secrets: bool
-00025e60: 203d 2054 7275 652c 0a20 2020 2029 202d   = True,.    ) -
-00025e70: 3e20 7374 723a 0a20 2020 2020 2020 2022  > str:.        "
-00025e80: 2222 0a20 2020 2020 2020 204c 6f61 6469  "".        Loadi
-00025e90: 6e67 2061 2070 726f 6a65 6374 2072 656d  ng a project rem
-00025ea0: 6f74 656c 7920 6672 6f6d 2074 6865 2067  otely from the g
-00025eb0: 6976 656e 2073 6f75 7263 652e 0a20 2020  iven source..   
-00025ec0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-00025ed0: 3a20 2020 2070 726f 6a65 6374 206e 616d  :    project nam
-00025ee0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
-00025ef0: 2075 726c 3a20 2020 2020 6769 7420 6f72   url:     git or
-00025f00: 2074 6172 2e67 7a20 6f72 202e 7a69 7020   tar.gz or .zip 
-00025f10: 736f 7572 6365 7320 6172 6368 6976 6520  sources archive 
-00025f20: 7061 7468 2065 2e67 2e3a 0a20 2020 2020  path e.g.:.     
-00025f30: 2020 2067 6974 3a2f 2f67 6974 6875 622e     git://github.
-00025f40: 636f 6d2f 6d6c 7275 6e2f 6465 6d6f 2d78  com/mlrun/demo-x
-00025f50: 6762 2d70 726f 6a65 6374 2e67 6974 0a20  gb-project.git. 
-00025f60: 2020 2020 2020 2068 7474 703a 2f2f 6d79         http://my
-00025f70: 7369 7465 2f61 7263 6869 7665 642d 7072  site/archived-pr
-00025f80: 6f6a 6563 742e 7a69 700a 2020 2020 2020  oject.zip.      
-00025f90: 2020 5468 6520 6769 7420 7072 6f6a 6563    The git projec
-00025fa0: 7420 7368 6f75 6c64 2069 6e63 6c75 6465  t should include
-00025fb0: 2074 6865 2070 726f 6a65 6374 2079 616d   the project yam
-00025fc0: 6c20 6669 6c65 2e0a 2020 2020 2020 2020  l file..        
-00025fd0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
-00025fe0: 2020 2020 2020 2020 5365 6372 6574 7320          Secrets 
-00025ff0: 746f 2073 746f 7265 2069 6e20 7072 6f6a  to store in proj
-00026000: 6563 7420 696e 206f 7264 6572 2074 6f20  ect in order to 
-00026010: 6c6f 6164 2069 7420 6672 6f6d 2074 6865  load it from the
-00026020: 2070 726f 7669 6465 6420 7572 6c2e 2046   provided url. F
-00026030: 6f72 206d 6f72 650a 2020 2020 2020 2020  or more.        
-00026040: 696e 666f 726d 6174 696f 6e20 7365 6520  information see 
-00026050: 3a70 793a 6675 6e63 3a60 6d6c 7275 6e2e  :py:func:`mlrun.
-00026060: 6c6f 6164 5f70 726f 6a65 6374 6020 6675  load_project` fu
-00026070: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
-00026080: 3a70 6172 616d 2073 6176 655f 7365 6372  :param save_secr
-00026090: 6574 733a 2020 2020 5768 6574 6865 7220  ets:    Whether 
-000260a0: 746f 2073 746f 7265 2073 6563 7265 7473  to store secrets
-000260b0: 2069 6e20 7468 6520 6c6f 6164 6564 2070   in the loaded p
-000260c0: 726f 6a65 6374 2e20 5365 7474 696e 6720  roject. Setting 
-000260d0: 746f 2046 616c 7365 2077 696c 6c20 6361  to False will ca
-000260e0: 7573 6520 7761 6974 696e 670a 2020 2020  use waiting.    
-000260f0: 2020 2020 666f 7220 7468 6520 7072 6f63      for the proc
-00026100: 6573 7320 636f 6d70 6c65 7469 6f6e 2e0a  ess completion..
-00026110: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00026120: 733a 2020 2020 2020 2020 2020 2020 2020  s:              
-00026130: 2054 6865 2074 6572 6d69 6e61 6c20 7374   The terminal st
-00026140: 6174 6520 6f66 206c 6f61 6420 7072 6f6a  ate of load proj
-00026150: 6563 7420 7072 6f63 6573 732e 0a20 2020  ect process..   
-00026160: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00026170: 2070 6172 616d 7320 3d20 7b22 7572 6c22   params = {"url"
-00026180: 3a20 7572 6c7d 0a20 2020 2020 2020 2062  : url}.        b
-00026190: 6f64 7920 3d20 4e6f 6e65 0a20 2020 2020  ody = None.     
-000261a0: 2020 2069 6620 7365 6372 6574 733a 0a20     if secrets:. 
-000261b0: 2020 2020 2020 2020 2020 2070 726f 7669             provi
-000261c0: 6465 7220 3d20 6d6c 7275 6e2e 636f 6d6d  der = mlrun.comm
-000261d0: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
-000261e0: 7450 726f 7669 6465 724e 616d 652e 6b75  tProviderName.ku
-000261f0: 6265 726e 6574 6573 0a20 2020 2020 2020  bernetes.       
-00026200: 2020 2020 2073 6563 7265 7473 5f69 6e70       secrets_inp
-00026210: 7574 203d 206d 6c72 756e 2e63 6f6d 6d6f  ut = mlrun.commo
-00026220: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-00026230: 7344 6174 6128 0a20 2020 2020 2020 2020  sData(.         
-00026240: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
-00026250: 7072 6f76 6964 6572 2c20 7365 6372 6574  provider, secret
-00026260: 733d 7365 6372 6574 730a 2020 2020 2020  s=secrets.      
-00026270: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026280: 2020 2020 626f 6479 203d 2073 6563 7265      body = secre
-00026290: 7473 5f69 6e70 7574 2e64 6963 7428 290a  ts_input.dict().
-000262a0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-000262b0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000262c0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-000262d0: 4f53 5422 2c20 6622 7072 6f6a 6563 7473  OST", f"projects
-000262e0: 2f7b 6e61 6d65 7d2f 6c6f 6164 222c 2070  /{name}/load", p
-000262f0: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
-00026300: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00026310: 626f 6479 290a 2020 2020 2020 2020 290a  body).        ).
-00026320: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-00026330: 203d 2072 6573 706f 6e73 652e 6a73 6f6e   = response.json
-00026340: 2829 0a20 2020 2020 2020 2072 756e 203d  ().        run =
-00026350: 206d 6c72 756e 2e52 756e 4f62 6a65 6374   mlrun.RunObject
-00026360: 2e66 726f 6d5f 6469 6374 2872 6573 706f  .from_dict(respo
-00026370: 6e73 655b 2264 6174 6122 5d29 0a20 2020  nse["data"]).   
-00026380: 2020 2020 2073 7461 7465 2c20 5f20 3d20       state, _ = 
-00026390: 7275 6e2e 6c6f 6773 2829 0a0a 2020 2020  run.logs()..    
-000263a0: 2020 2020 6966 2073 6563 7265 7473 2061      if secrets a
-000263b0: 6e64 206e 6f74 2073 6176 655f 7365 6372  nd not save_secr
-000263c0: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
-000263d0: 2073 656c 662e 6465 6c65 7465 5f70 726f   self.delete_pro
-000263e0: 6a65 6374 5f73 6563 7265 7473 2870 726f  ject_secrets(pro
-000263f0: 6a65 6374 3d6e 616d 652c 2073 6563 7265  ject=name, secre
-00026400: 7473 3d6c 6973 7428 7365 6372 6574 732e  ts=list(secrets.
-00026410: 6b65 7973 2829 2929 0a20 2020 2020 2020  keys())).       
-00026420: 2020 2020 2069 6620 7374 6174 6520 213d       if state !=
-00026430: 2022 636f 6d70 6c65 7465 6422 3a0a 2020   "completed":.  
-00026440: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00026450: 6767 6572 2e65 7272 6f72 2822 4c6f 6164  gger.error("Load
-00026460: 2070 726f 6a65 6374 2074 6173 6b20 6661   project task fa
-00026470: 696c 6564 2c20 6465 6c65 7469 6e67 2070  iled, deleting p
-00026480: 726f 6a65 6374 2229 0a20 2020 2020 2020  roject").       
-00026490: 2020 2020 2020 2020 2073 656c 662e 6465           self.de
-000264a0: 6c65 7465 5f70 726f 6a65 6374 286e 616d  lete_project(nam
-000264b0: 652c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  e, mlrun.common.
-000264c0: 7363 6865 6d61 732e 4465 6c65 7469 6f6e  schemas.Deletion
-000264d0: 5374 7261 7465 6779 2e63 6173 6361 6465  Strategy.cascade
-000264e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000264f0: 6e20 7374 6174 650a 0a20 2020 2064 6566  n state..    def
-00026500: 2067 6574 5f64 6174 6173 746f 7265 5f70   get_datastore_p
-00026510: 726f 6669 6c65 280a 2020 2020 2020 2020  rofile(.        
-00026520: 7365 6c66 2c20 6e61 6d65 3a20 7374 722c  self, name: str,
-00026530: 2070 726f 6a65 6374 3a20 7374 720a 2020   project: str.  
-00026540: 2020 2920 2d3e 204f 7074 696f 6e61 6c5b    ) -> Optional[
-00026550: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00026560: 656d 6173 2e44 6174 6173 746f 7265 5072  emas.DatastorePr
-00026570: 6f66 696c 655d 3a0a 2020 2020 2020 2020  ofile]:.        
-00026580: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
-00026590: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
-000265a0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-000265b0: 2020 2020 5f70 6174 6820 3d20 7365 6c66      _path = self
-000265c0: 2e5f 7061 7468 5f6f 6628 2264 6174 6173  ._path_of("datas
-000265d0: 746f 7265 2d70 726f 6669 6c65 7322 2c20  tore-profiles", 
-000265e0: 7072 6f6a 6563 742c 206e 616d 6529 0a0a  project, name)..
-000265f0: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
-00026600: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-00026610: 6f64 3d22 4745 5422 2c20 7061 7468 3d5f  od="GET", path=_
-00026620: 7061 7468 290a 2020 2020 2020 2020 6966  path).        if
-00026630: 2072 6573 3a0a 2020 2020 2020 2020 2020   res:.          
-00026640: 2020 7075 626c 6963 5f77 7261 7070 6572    public_wrapper
-00026650: 203d 2072 6573 2e6a 736f 6e28 290a 2020   = res.json().  
-00026660: 2020 2020 2020 2020 2020 6461 7461 7374            datast
-00026670: 6f72 6520 3d20 4461 7461 7374 6f72 6550  ore = DatastoreP
-00026680: 726f 6669 6c65 324a 736f 6e2e 6372 6561  rofile2Json.crea
-00026690: 7465 5f66 726f 6d5f 6a73 6f6e 280a 2020  te_from_json(.  
-000266a0: 2020 2020 2020 2020 2020 2020 2020 7075                pu
-000266b0: 626c 6963 5f6a 736f 6e3d 7075 626c 6963  blic_json=public
-000266c0: 5f77 7261 7070 6572 5b22 6f62 6a65 6374  _wrapper["object
-000266d0: 225d 0a20 2020 2020 2020 2020 2020 2029  "].            )
-000266e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000266f0: 7572 6e20 6461 7461 7374 6f72 650a 2020  urn datastore.  
-00026700: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-00026710: 650a 0a20 2020 2064 6566 2064 656c 6574  e..    def delet
-00026720: 655f 6461 7461 7374 6f72 655f 7072 6f66  e_datastore_prof
-00026730: 696c 6528 7365 6c66 2c20 6e61 6d65 3a20  ile(self, name: 
-00026740: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
-00026750: 7229 3a0a 2020 2020 2020 2020 7072 6f6a  r):.        proj
-00026760: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-00026770: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00026780: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-00026790: 5f70 6174 6820 3d20 7365 6c66 2e5f 7061  _path = self._pa
-000267a0: 7468 5f6f 6628 2264 6174 6173 746f 7265  th_of("datastore
-000267b0: 2d70 726f 6669 6c65 7322 2c20 7072 6f6a  -profiles", proj
-000267c0: 6563 742c 206e 616d 6529 0a20 2020 2020  ect, name).     
-000267d0: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-000267e0: 286d 6574 686f 643d 2244 454c 4554 4522  (method="DELETE"
-000267f0: 2c20 7061 7468 3d5f 7061 7468 290a 2020  , path=_path).  
-00026800: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-00026810: 650a 0a20 2020 2064 6566 206c 6973 745f  e..    def list_
-00026820: 6461 7461 7374 6f72 655f 7072 6f66 696c  datastore_profil
-00026830: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
-00026840: 2c20 7072 6f6a 6563 743a 2073 7472 0a20  , project: str. 
-00026850: 2020 2029 202d 3e20 6c69 7374 5b6d 6c72     ) -> list[mlr
-00026860: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00026870: 732e 4461 7461 7374 6f72 6550 726f 6669  s.DatastoreProfi
-00026880: 6c65 5d3a 0a20 2020 2020 2020 2070 726f  le]:.        pro
-00026890: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-000268a0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-000268b0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-000268c0: 205f 7061 7468 203d 2073 656c 662e 5f70   _path = self._p
-000268d0: 6174 685f 6f66 2822 6461 7461 7374 6f72  ath_of("datastor
-000268e0: 652d 7072 6f66 696c 6573 222c 2070 726f  e-profiles", pro
-000268f0: 6a65 6374 290a 0a20 2020 2020 2020 2072  ject)..        r
-00026900: 6573 203d 2073 656c 662e 6170 695f 6361  es = self.api_ca
-00026910: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
-00026920: 2070 6174 683d 5f70 6174 6829 0a20 2020   path=_path).   
-00026930: 2020 2020 2069 6620 7265 733a 0a20 2020       if res:.   
-00026940: 2020 2020 2020 2020 2070 7562 6c69 635f           public_
-00026950: 7772 6170 7065 7220 3d20 7265 732e 6a73  wrapper = res.js
-00026960: 6f6e 2829 0a20 2020 2020 2020 2020 2020  on().           
-00026970: 2064 6174 6173 746f 7265 7320 3d20 5b0a   datastores = [.
-00026980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026990: 4461 7461 7374 6f72 6550 726f 6669 6c65  DatastoreProfile
-000269a0: 324a 736f 6e2e 6372 6561 7465 5f66 726f  2Json.create_fro
-000269b0: 6d5f 6a73 6f6e 2878 5b22 6f62 6a65 6374  m_json(x["object
-000269c0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-000269d0: 2020 2020 666f 7220 7820 696e 2070 7562      for x in pub
-000269e0: 6c69 635f 7772 6170 7065 720a 2020 2020  lic_wrapper.    
-000269f0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00026a00: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
-00026a10: 6173 746f 7265 730a 2020 2020 2020 2020  astores.        
-00026a20: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
-00026a30: 2064 6566 2073 746f 7265 5f64 6174 6173   def store_datas
-00026a40: 746f 7265 5f70 726f 6669 6c65 280a 2020  tore_profile(.  
-00026a50: 2020 2020 2020 7365 6c66 2c20 7072 6f66        self, prof
-00026a60: 696c 653a 206d 6c72 756e 2e63 6f6d 6d6f  ile: mlrun.commo
-00026a70: 6e2e 7363 6865 6d61 732e 4461 7461 7374  n.schemas.Datast
-00026a80: 6f72 6550 726f 6669 6c65 2c20 7072 6f6a  oreProfile, proj
-00026a90: 6563 743a 2073 7472 0a20 2020 2029 3a0a  ect: str.    ):.
-00026aa0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00026ab0: 2020 2020 4372 6561 7465 206f 7220 7265      Create or re
-00026ac0: 706c 6163 6520 6120 6461 7461 7374 6f72  place a datastor
-00026ad0: 6520 7072 6f66 696c 652e 0a20 2020 2020  e profile..     
-00026ae0: 2020 203a 7265 7475 726e 733a 204e 6f6e     :returns: Non
-00026af0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-00026b00: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00026b10: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00026b20: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00026b30: 740a 2020 2020 2020 2020 5f70 6174 6820  t.        _path 
-00026b40: 3d20 7365 6c66 2e5f 7061 7468 5f6f 6628  = self._path_of(
-00026b50: 2264 6174 6173 746f 7265 2d70 726f 6669  "datastore-profi
-00026b60: 6c65 7322 2c20 7072 6f6a 6563 7429 0a0a  les", project)..
-00026b70: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-00026b80: 5f63 616c 6c28 6d65 7468 6f64 3d22 5055  _call(method="PU
-00026b90: 5422 2c20 7061 7468 3d5f 7061 7468 2c20  T", path=_path, 
-00026ba0: 6a73 6f6e 3d70 726f 6669 6c65 2e64 6963  json=profile.dic
-00026bb0: 7428 2929 0a0a 0a64 6566 205f 6173 5f6a  t())...def _as_j
-00026bc0: 736f 6e28 6f62 6a29 3a0a 2020 2020 666e  son(obj):.    fn
-00026bd0: 203d 2067 6574 6174 7472 286f 626a 2c20   = getattr(obj, 
-00026be0: 2274 6f5f 6a73 6f6e 222c 204e 6f6e 6529  "to_json", None)
-00026bf0: 0a20 2020 2069 6620 666e 3a0a 2020 2020  .    if fn:.    
-00026c00: 2020 2020 7265 7475 726e 2066 6e28 290a      return fn().
-00026c10: 2020 2020 7265 7475 726e 2064 6963 745f      return dict_
-00026c20: 746f 5f6a 736f 6e28 6f62 6a29 0a         to_json(obj).
+00021a40: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+00021a50: 6661 756c 742c 2074 6865 2069 6d61 6765  fault, the image
+00021a60: 2069 7320 6d6c 7275 6e2f 6d6c 7275 6e2e   is mlrun/mlrun.
+00021a70: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00021a80: 6465 706c 6f79 5f68 6973 746f 6772 616d  deploy_histogram
+00021a90: 5f64 6174 615f 6472 6966 745f 6170 703a  _data_drift_app:
+00021aa0: 2049 6620 7472 7565 2c20 6465 706c 6f79   If true, deploy
+00021ab0: 2074 6865 2064 6566 6175 6c74 2068 6973   the default his
+00021ac0: 746f 6772 616d 2d62 6173 6564 2064 6174  togram-based dat
+00021ad0: 6120 6472 6966 7420 6170 706c 6963 6174  a drift applicat
+00021ae0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
+00021af0: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+00021b00: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00021b10: 2020 2020 6d65 7468 6f64 3d6d 6c72 756e      method=mlrun
+00021b20: 2e63 6f6d 6d6f 6e2e 7479 7065 732e 4854  .common.types.HT
+00021b30: 5450 4d65 7468 6f64 2e50 4f53 542c 0a20  TPMethod.POST,. 
+00021b40: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+00021b50: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00021b60: 6563 747d 2f6d 6f64 656c 2d6d 6f6e 6974  ect}/model-monit
+00021b70: 6f72 696e 672f 656e 6162 6c65 2d6d 6f64  oring/enable-mod
+00021b80: 656c 2d6d 6f6e 6974 6f72 696e 6722 2c0a  el-monitoring",.
+00021b90: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00021ba0: 6d73 3d7b 0a20 2020 2020 2020 2020 2020  ms={.           
+00021bb0: 2020 2020 2022 6261 7365 5f70 6572 696f       "base_perio
+00021bc0: 6422 3a20 6261 7365 5f70 6572 696f 642c  d": base_period,
+00021bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021be0: 2022 696d 6167 6522 3a20 696d 6167 652c   "image": image,
+00021bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021c00: 2022 6465 706c 6f79 5f68 6973 746f 6772   "deploy_histogr
+00021c10: 616d 5f64 6174 615f 6472 6966 745f 6170  am_data_drift_ap
+00021c20: 7022 3a20 6465 706c 6f79 5f68 6973 746f  p": deploy_histo
+00021c30: 6772 616d 5f64 6174 615f 6472 6966 745f  gram_data_drift_
+00021c40: 6170 702c 0a20 2020 2020 2020 2020 2020  app,.           
+00021c50: 207d 2c0a 2020 2020 2020 2020 290a 0a20   },.        ).. 
+00021c60: 2020 2064 6566 2064 6570 6c6f 795f 6869     def deploy_hi
+00021c70: 7374 6f67 7261 6d5f 6461 7461 5f64 7269  stogram_data_dri
+00021c80: 6674 5f61 7070 280a 2020 2020 2020 2020  ft_app(.        
+00021c90: 7365 6c66 2c20 7072 6f6a 6563 743a 2073  self, project: s
+00021ca0: 7472 2c20 696d 6167 653a 2073 7472 203d  tr, image: str =
+00021cb0: 2022 6d6c 7275 6e2f 6d6c 7275 6e22 0a20   "mlrun/mlrun". 
+00021cc0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00021cd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00021ce0: 2020 4465 706c 6f79 2074 6865 2068 6973    Deploy the his
+00021cf0: 746f 6772 616d 2064 6174 6120 6472 6966  togram data drif
+00021d00: 7420 6170 706c 6963 6174 696f 6e2e 0a0a  t application...
+00021d10: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+00021d20: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
+00021d30: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
+00021d40: 6172 616d 2069 6d61 6765 3a20 2020 5468  aram image:   Th
+00021d50: 6520 696d 6167 6520 6f6e 2077 6869 6368  e image on which
+00021d60: 2074 6865 2061 7070 6c69 6361 7469 6f6e   the application
+00021d70: 2077 696c 6c20 7275 6e2e 0a20 2020 2020   will run..     
+00021d80: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+00021d90: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00021da0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00021db0: 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7479  =mlrun.common.ty
+00021dc0: 7065 732e 4854 5450 4d65 7468 6f64 2e50  pes.HTTPMethod.P
+00021dd0: 4f53 542c 0a20 2020 2020 2020 2020 2020  OST,.           
+00021de0: 2070 6174 683d 6622 7072 6f6a 6563 7473   path=f"projects
+00021df0: 2f7b 7072 6f6a 6563 747d 2f6d 6f64 656c  /{project}/model
+00021e00: 2d6d 6f6e 6974 6f72 696e 672f 6465 706c  -monitoring/depl
+00021e10: 6f79 2d68 6973 746f 6772 616d 2d64 6174  oy-histogram-dat
+00021e20: 612d 6472 6966 742d 6170 7022 2c0a 2020  a-drift-app",.  
+00021e30: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00021e40: 3d7b 2269 6d61 6765 223a 2069 6d61 6765  ={"image": image
+00021e50: 7d2c 0a20 2020 2020 2020 2029 0a0a 2020  },.        )..  
+00021e60: 2020 6465 6620 6372 6561 7465 5f68 7562    def create_hub
+00021e70: 5f73 6f75 7263 6528 0a20 2020 2020 2020  _source(.       
+00021e80: 2073 656c 662c 2073 6f75 7263 653a 2055   self, source: U
+00021e90: 6e69 6f6e 5b64 6963 742c 206d 6c72 756e  nion[dict, mlrun
+00021ea0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00021eb0: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
+00021ec0: 5d0a 2020 2020 293a 0a20 2020 2020 2020  ].    ):.       
+00021ed0: 2022 2222 0a20 2020 2020 2020 2041 6464   """.        Add
+00021ee0: 2061 206e 6577 2068 7562 2073 6f75 7263   a new hub sourc
+00021ef0: 652e 0a0a 2020 2020 2020 2020 4d4c 5275  e...        MLRu
+00021f00: 6e20 6d61 696e 7461 696e 7320 616e 206f  n maintains an o
+00021f10: 7264 6572 6564 206c 6973 7420 6f66 2068  rdered list of h
+00021f20: 7562 2073 6f75 7263 6573 2028 e280 9c73  ub sources (...s
+00021f30: 6f75 7263 6573 e280 9d29 2045 6163 6820  ources...) Each 
+00021f40: 736f 7572 6365 2068 6173 0a20 2020 2020  source has.     
+00021f50: 2020 2069 7473 2064 6574 6169 6c73 2072     its details r
+00021f60: 6567 6973 7465 7265 6420 616e 6420 6974  egistered and it
+00021f70: 7320 6f72 6465 7220 7769 7468 696e 2074  s order within t
+00021f80: 6865 206c 6973 742e 2057 6865 6e20 6372  he list. When cr
+00021f90: 6561 7469 6e67 2061 206e 6577 2073 6f75  eating a new sou
+00021fa0: 7263 652c 2074 6865 2073 7065 6369 616c  rce, the special
+00021fb0: 206f 7264 6572 2060 602d 3160 600a 2020   order ``-1``.  
+00021fc0: 2020 2020 2020 6361 6e20 6265 2075 7365        can be use
+00021fd0: 6420 746f 206d 6172 6b20 7468 6973 2073  d to mark this s
+00021fe0: 6f75 7263 6520 6173 206c 6173 7420 696e  ource as last in
+00021ff0: 2074 6865 206c 6973 742e 2048 6f77 6576   the list. Howev
+00022000: 6572 2c20 6f6e 6365 2074 6865 2073 6f75  er, once the sou
+00022010: 7263 6520 6973 2069 6e20 7468 6520 4d4c  rce is in the ML
+00022020: 5275 6e20 6c69 7374 2c0a 2020 2020 2020  Run list,.      
+00022030: 2020 6974 7320 6f72 6465 7220 7769 6c6c    its order will
+00022040: 2061 6c77 6179 7320 6265 2060 603e 3060   always be ``>0`
+00022050: 602e 0a0a 2020 2020 2020 2020 5468 6520  `...        The 
+00022060: 676c 6f62 616c 2068 7562 2073 6f75 7263  global hub sourc
+00022070: 6520 616c 7761 7973 2065 7869 7374 7320  e always exists 
+00022080: 696e 2074 6865 206c 6973 742c 2061 6e64  in the list, and
+00022090: 2069 7320 616c 7761 7973 2074 6865 206c   is always the l
+000220a0: 6173 7420 736f 7572 6365 0a20 2020 2020  ast source.     
+000220b0: 2020 2028 6060 6f72 6465 7220 3d20 2d31     (``order = -1
+000220c0: 6060 292e 2049 7420 6361 6e6e 6f74 2062  ``). It cannot b
+000220d0: 6520 6d6f 6469 6669 6564 206e 6f72 2063  e modified nor c
+000220e0: 616e 2069 7420 6265 206d 6f76 6564 2074  an it be moved t
+000220f0: 6f20 616e 6f74 6865 7220 6f72 6465 7220  o another order 
+00022100: 696e 2074 6865 206c 6973 742e 0a0a 2020  in the list...  
+00022110: 2020 2020 2020 5468 6520 736f 7572 6365        The source
+00022120: 206f 626a 6563 7420 6d61 7920 636f 6e74   object may cont
+00022130: 6169 6e20 6372 6564 656e 7469 616c 7320  ain credentials 
+00022140: 7768 6963 6820 6172 6520 6e65 6564 6564  which are needed
+00022150: 2074 6f20 6163 6365 7373 2074 6865 2064   to access the d
+00022160: 6174 6173 746f 7265 2077 6865 7265 2074  atastore where t
+00022170: 6865 2073 6f75 7263 6520 6973 2073 746f  he source is sto
+00022180: 7265 642e 0a20 2020 2020 2020 2054 6865  red..        The
+00022190: 7365 2063 7265 6465 6e74 6961 6c73 2061  se credentials a
+000221a0: 7265 206e 6f74 206b 6570 7420 696e 2074  re not kept in t
+000221b0: 6865 204d 4c52 756e 2044 422c 2062 7574  he MLRun DB, but
+000221c0: 2061 7265 2073 746f 7265 6420 696e 7369   are stored insi
+000221d0: 6465 2061 206b 7562 6572 6e65 7465 7320  de a kubernetes 
+000221e0: 7365 6372 6574 206f 626a 6563 7420 6d61  secret object ma
+000221f0: 696e 7461 696e 6564 2062 790a 2020 2020  intained by.    
+00022200: 2020 2020 4d4c 5275 6e2e 2054 6865 7920      MLRun. They 
+00022210: 6172 6520 6e6f 7420 7265 7475 726e 6564  are not returned
+00022220: 2074 6872 6f75 6768 2061 6e79 2041 5049   through any API
+00022230: 2066 726f 6d20 4d4c 5275 6e2e 0a0a 2020   from MLRun...  
+00022240: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
+00022250: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+00022260: 6f72 7420 6d6c 7275 6e2e 636f 6d6d 6f6e  ort mlrun.common
+00022270: 2e73 6368 656d 6173 0a0a 2020 2020 2020  .schemas..      
+00022280: 2020 2020 2020 2320 4164 6420 6120 7072        # Add a pr
+00022290: 6976 6174 6520 736f 7572 6365 2061 7320  ivate source as 
+000222a0: 7468 6520 6c61 7374 206f 6e65 2028 7769  the last one (wi
+000222b0: 6c6c 2062 6520 2331 2069 6e20 7468 6520  ll be #1 in the 
+000222c0: 6c69 7374 290a 2020 2020 2020 2020 2020  list).          
+000222d0: 2020 7072 6976 6174 655f 736f 7572 6365    private_source
+000222e0: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+000222f0: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
+00022300: 7562 536f 7572 6365 280a 2020 2020 2020  ubSource(.      
+00022310: 2020 2020 2020 2020 2020 6f72 6465 723d            order=
+00022320: 2d31 2c0a 2020 2020 2020 2020 2020 2020  -1,.            
+00022330: 2020 2020 736f 7572 6365 3d6d 6c72 756e      source=mlrun
+00022340: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00022350: 4875 6253 6f75 7263 6528 0a20 2020 2020  HubSource(.     
+00022360: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00022370: 6574 6164 6174 613d 6d6c 7275 6e2e 636f  etadata=mlrun.co
+00022380: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
+00022390: 4f62 6a65 6374 4d65 7461 6461 7461 280a  ObjectMetadata(.
+000223a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223b0: 2020 2020 2020 2020 6e61 6d65 3d22 7072          name="pr
+000223c0: 6976 222c 2064 6573 6372 6970 7469 6f6e  iv", description
+000223d0: 3d22 6120 7072 6976 6174 6520 736f 7572  ="a private sour
+000223e0: 6365 220a 2020 2020 2020 2020 2020 2020  ce".            
+000223f0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00022400: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00022410: 7065 633d 6d6c 7275 6e2e 636f 6d6d 6f6e  pec=mlrun.common
+00022420: 2e73 6368 656d 6173 2e48 7562 536f 7572  .schemas.HubSour
+00022430: 6365 5370 6563 2870 6174 683d 222f 6c6f  ceSpec(path="/lo
+00022440: 6361 6c2f 7061 7468 2f74 6f2f 736f 7572  cal/path/to/sour
+00022450: 6365 222c 2063 6861 6e6e 656c 3d22 6465  ce", channel="de
+00022460: 7665 6c6f 706d 656e 7422 290a 2020 2020  velopment").    
+00022470: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022480: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022490: 2020 2020 2020 2020 6462 2e63 7265 6174          db.creat
+000224a0: 655f 6875 625f 736f 7572 6365 2870 7269  e_hub_source(pri
+000224b0: 7661 7465 5f73 6f75 7263 6529 0a0a 2020  vate_source)..  
+000224c0: 2020 2020 2020 2020 2020 2320 4164 6420            # Add 
+000224d0: 616e 6f74 6865 7220 736f 7572 6365 2061  another source a
+000224e0: 7320 3173 7420 696e 2074 6865 206c 6973  s 1st in the lis
+000224f0: 7420 2d20 7769 6c6c 2070 7573 6820 7072  t - will push pr
+00022500: 6576 696f 7573 206f 6e65 2074 6f20 6265  evious one to be
+00022510: 2023 320a 2020 2020 2020 2020 2020 2020   #2.            
+00022520: 616e 6f74 6865 725f 736f 7572 6365 203d  another_source =
+00022530: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00022540: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
+00022550: 536f 7572 6365 280a 2020 2020 2020 2020  Source(.        
+00022560: 2020 2020 2020 2020 6f72 6465 723d 312c          order=1,
+00022570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022580: 2073 6f75 7263 653d 6d6c 7275 6e2e 636f   source=mlrun.co
+00022590: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
+000225a0: 536f 7572 6365 280a 2020 2020 2020 2020  Source(.        
+000225b0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+000225c0: 6461 7461 3d6d 6c72 756e 2e63 6f6d 6d6f  data=mlrun.commo
+000225d0: 6e2e 7363 6865 6d61 732e 4875 624f 626a  n.schemas.HubObj
+000225e0: 6563 744d 6574 6164 6174 6128 0a20 2020  ectMetadata(.   
+000225f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022600: 2020 2020 206e 616d 653d 2270 7269 762d       name="priv-
+00022610: 3222 2c20 6465 7363 7269 7074 696f 6e3d  2", description=
+00022620: 2261 6e6f 7468 6572 2073 6f75 7263 6522  "another source"
+00022630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022640: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00022650: 2020 2020 2020 2020 2020 2020 7370 6563              spec
+00022660: 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  =mlrun.common.sc
+00022670: 6865 6d61 732e 4875 6253 6f75 7263 6553  hemas.HubSourceS
+00022680: 7065 6328 0a20 2020 2020 2020 2020 2020  pec(.           
+00022690: 2020 2020 2020 2020 2020 2020 2070 6174               pat
+000226a0: 683d 222f 6c6f 6361 6c2f 7061 7468 2f74  h="/local/path/t
+000226b0: 6f2f 736f 7572 6365 2f32 222c 0a20 2020  o/source/2",.   
+000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226d0: 2020 2020 2063 6861 6e6e 656c 3d22 6465       channel="de
+000226e0: 7665 6c6f 706d 656e 7422 2c0a 2020 2020  velopment",.    
+000226f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022700: 2020 2020 6372 6564 656e 7469 616c 733d      credentials=
+00022710: 7b2e 2e2e 7d0a 2020 2020 2020 2020 2020  {...}.          
+00022720: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022730: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022740: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022750: 2020 2020 2020 2020 6462 2e63 7265 6174          db.creat
+00022760: 655f 6875 625f 736f 7572 6365 2861 6e6f  e_hub_source(ano
+00022770: 7468 6572 5f73 6f75 7263 6529 0a0a 2020  ther_source)..  
+00022780: 2020 2020 2020 3a70 6172 616d 2073 6f75        :param sou
+00022790: 7263 653a 2054 6865 2073 6f75 7263 6520  rce: The source 
+000227a0: 616e 6420 6974 7320 6f72 6465 722c 206f  and its order, o
+000227b0: 6620 7479 7065 0a20 2020 2020 2020 2020  f type.         
+000227c0: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
+000227d0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+000227e0: 6d61 732e 6875 622e 496e 6465 7865 6448  mas.hub.IndexedH
+000227f0: 7562 536f 7572 6365 602c 206f 7220 696e  ubSource`, or in
+00022800: 2064 6963 7469 6f6e 6172 7920 666f 726d   dictionary form
+00022810: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00022820: 6e73 3a20 5468 6520 736f 7572 6365 206f  ns: The source o
+00022830: 626a 6563 7420 6173 2069 6e73 6572 7465  bject as inserte
+00022840: 6420 696e 746f 2074 6865 2064 6174 6162  d into the datab
+00022850: 6173 652c 2077 6974 6820 6372 6564 656e  ase, with creden
+00022860: 7469 616c 7320 7374 7269 7070 6564 2e0a  tials stripped..
+00022870: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00022880: 2020 2020 7061 7468 203d 2022 6875 622f      path = "hub/
+00022890: 736f 7572 6365 7322 0a20 2020 2020 2020  sources".       
+000228a0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+000228b0: 6f75 7263 652c 206d 6c72 756e 2e63 6f6d  ource, mlrun.com
+000228c0: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
+000228d0: 7865 6448 7562 536f 7572 6365 293a 0a20  xedHubSource):. 
+000228e0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+000228f0: 6520 3d20 736f 7572 6365 2e64 6963 7428  e = source.dict(
+00022900: 290a 2020 2020 2020 2020 7265 7370 6f6e  ).        respon
+00022910: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+00022920: 6c6c 286d 6574 686f 643d 2250 4f53 5422  ll(method="POST"
+00022930: 2c20 7061 7468 3d70 6174 682c 206a 736f  , path=path, jso
+00022940: 6e3d 736f 7572 6365 290a 2020 2020 2020  n=source).      
+00022950: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
+00022960: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
+00022970: 6465 7865 6448 7562 536f 7572 6365 282a  dexedHubSource(*
+00022980: 2a72 6573 706f 6e73 652e 6a73 6f6e 2829  *response.json()
+00022990: 290a 0a20 2020 2064 6566 2073 746f 7265  )..    def store
+000229a0: 5f68 7562 5f73 6f75 7263 6528 0a20 2020  _hub_source(.   
+000229b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000229c0: 2020 2073 6f75 7263 655f 6e61 6d65 3a20     source_name: 
+000229d0: 7374 722c 0a20 2020 2020 2020 2073 6f75  str,.        sou
+000229e0: 7263 653a 2055 6e69 6f6e 5b64 6963 742c  rce: Union[dict,
+000229f0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00022a00: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
+00022a10: 536f 7572 6365 5d2c 0a20 2020 2029 3a0a  Source],.    ):.
+00022a20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00022a30: 2020 2020 4372 6561 7465 206f 7220 7265      Create or re
+00022a40: 706c 6163 6520 6120 6875 6220 736f 7572  place a hub sour
+00022a50: 6365 2e0a 2020 2020 2020 2020 466f 7220  ce..        For 
+00022a60: 616e 2065 7861 6d70 6c65 206f 6620 7468  an example of th
+00022a70: 6520 736f 7572 6365 2066 6f72 6d61 7420  e source format 
+00022a80: 616e 6420 6578 706c 616e 6174 696f 6e20  and explanation 
+00022a90: 6f66 2074 6865 2073 6f75 7263 6520 6f72  of the source or
+00022aa0: 6465 7220 6c6f 6769 632c 0a20 2020 2020  der logic,.     
+00022ab0: 2020 2070 6c65 6173 6520 7365 6520 3a70     please see :p
+00022ac0: 793a 6675 6e63 3a60 7e63 7265 6174 655f  y:func:`~create_
+00022ad0: 6875 625f 736f 7572 6365 602e 2054 6869  hub_source`. Thi
+00022ae0: 7320 6d65 7468 6f64 2063 616e 2062 6520  s method can be 
+00022af0: 7573 6564 2074 6f20 6d6f 6469 6679 2074  used to modify t
+00022b00: 6865 2073 6f75 7263 6520 6974 7365 6c66  he source itself
+00022b10: 206f 7220 6974 730a 2020 2020 2020 2020   or its.        
+00022b20: 6f72 6465 7220 696e 2074 6865 206c 6973  order in the lis
+00022b30: 7420 6f66 2073 6f75 7263 6573 2e0a 0a20  t of sources... 
+00022b40: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+00022b50: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+00022b60: 6f66 2074 6865 2073 6f75 7263 6520 6f62  of the source ob
+00022b70: 6a65 6374 2074 6f20 6d6f 6469 6679 2f63  ject to modify/c
+00022b80: 7265 6174 652e 2049 7420 6d75 7374 206d  reate. It must m
+00022b90: 6174 6368 2074 6865 2060 6073 6f75 7263  atch the ``sourc
+00022ba0: 652e 6d65 7461 6461 7461 2e6e 616d 6560  e.metadata.name`
+00022bb0: 600a 2020 2020 2020 2020 2020 2020 7061  `.            pa
+00022bc0: 7261 6d65 7465 7220 696e 2074 6865 2073  rameter in the s
+00022bd0: 6f75 7263 6520 6974 7365 6c66 2e0a 2020  ource itself..  
+00022be0: 2020 2020 2020 3a70 6172 616d 2073 6f75        :param sou
+00022bf0: 7263 653a 2053 6f75 7263 6520 6f62 6a65  rce: Source obje
+00022c00: 6374 2074 6f20 7374 6f72 6520 696e 2074  ct to store in t
+00022c10: 6865 2064 6174 6162 6173 652e 0a20 2020  he database..   
+00022c20: 2020 2020 203a 7265 7475 726e 733a 2054       :returns: T
+00022c30: 6865 2073 6f75 7263 6520 6f62 6a65 6374  he source object
+00022c40: 2061 7320 7374 6f72 6564 2069 6e20 7468   as stored in th
+00022c50: 6520 4442 2e0a 2020 2020 2020 2020 2222  e DB..        ""
+00022c60: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
+00022c70: 2066 2268 7562 2f73 6f75 7263 6573 2f7b   f"hub/sources/{
+00022c80: 736f 7572 6365 5f6e 616d 657d 220a 2020  source_name}".  
+00022c90: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00022ca0: 6e63 6528 736f 7572 6365 2c20 6d6c 7275  nce(source, mlru
+00022cb0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00022cc0: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
+00022cd0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00022ce0: 736f 7572 6365 203d 2073 6f75 7263 652e  source = source.
+00022cf0: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+00022d00: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+00022d10: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
+00022d20: 2250 5554 222c 2070 6174 683d 7061 7468  "PUT", path=path
+00022d30: 2c20 6a73 6f6e 3d73 6f75 7263 6529 0a20  , json=source). 
+00022d40: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
+00022d50: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00022d60: 6173 2e49 6e64 6578 6564 4875 6253 6f75  as.IndexedHubSou
+00022d70: 7263 6528 2a2a 7265 7370 6f6e 7365 2e6a  rce(**response.j
+00022d80: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+00022d90: 6c69 7374 5f68 7562 5f73 6f75 7263 6573  list_hub_sources
+00022da0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00022db0: 2020 2020 2020 2020 6974 656d 5f6e 616d          item_nam
+00022dc0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+00022dd0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00022de0: 2074 6167 3a20 4f70 7469 6f6e 616c 5b73   tag: Optional[s
+00022df0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00022e00: 2020 2020 7665 7273 696f 6e3a 204f 7074      version: Opt
+00022e10: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00022e20: 652c 0a20 2020 2029 202d 3e20 6c69 7374  e,.    ) -> list
+00022e30: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
+00022e40: 6865 6d61 732e 6875 622e 496e 6465 7865  hemas.hub.Indexe
+00022e50: 6448 7562 536f 7572 6365 5d3a 0a20 2020  dHubSource]:.   
+00022e60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00022e70: 204c 6973 7420 6875 6220 736f 7572 6365   List hub source
+00022e80: 7320 696e 2074 6865 204d 4c52 756e 2044  s in the MLRun D
+00022e90: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
+00022ea0: 616d 2069 7465 6d5f 6e61 6d65 3a20 2020  am item_name:   
+00022eb0: 536f 7572 6365 7320 636f 6e74 6169 6e20  Sources contain 
+00022ec0: 7468 6973 2069 7465 6d20 7769 6c6c 2062  this item will b
+00022ed0: 6520 7265 7475 726e 6564 2c20 4966 206e  e returned, If n
+00022ee0: 6f74 2070 726f 7669 6465 6420 616c 6c20  ot provided all 
+00022ef0: 736f 7572 6365 7320 7769 6c6c 2062 6520  sources will be 
+00022f00: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
+00022f10: 2020 3a70 6172 616d 2074 6167 3a20 2020    :param tag:   
+00022f20: 2020 2020 2020 4974 656d 2074 6167 2074        Item tag t
+00022f30: 6f20 6669 6c74 6572 2062 792c 2073 7570  o filter by, sup
+00022f40: 706f 7274 6564 206f 6e6c 7920 6966 2069  ported only if i
+00022f50: 7465 6d20 6e61 6d65 2069 7320 7072 6f76  tem name is prov
+00022f60: 6964 6564 2e0a 2020 2020 2020 2020 3a70  ided..        :p
+00022f70: 6172 616d 2076 6572 7369 6f6e 3a20 2020  aram version:   
+00022f80: 2020 4974 656d 2076 6572 7369 6f6e 2074    Item version t
+00022f90: 6f20 6669 6c74 6572 2062 792c 2073 7570  o filter by, sup
+00022fa0: 706f 7274 6564 206f 6e6c 7920 6966 2069  ported only if i
+00022fb0: 7465 6d20 6e61 6d65 2069 7320 7072 6f76  tem name is prov
+00022fc0: 6964 6564 2061 6e64 2074 6167 2069 7320  ided and tag is 
+00022fd0: 6e6f 742e 0a0a 2020 2020 2020 2020 3a72  not...        :r
+00022fe0: 6574 7572 6e73 3a20 4c69 7374 206f 6620  eturns: List of 
+00022ff0: 696e 6465 7865 6420 6875 6220 736f 7572  indexed hub sour
+00023000: 6365 732e 0a20 2020 2020 2020 2022 2222  ces..        """
+00023010: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00023020: 2268 7562 2f73 6f75 7263 6573 220a 2020  "hub/sources".  
+00023030: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+00023040: 7d0a 2020 2020 2020 2020 6966 2069 7465  }.        if ite
+00023050: 6d5f 6e61 6d65 3a0a 2020 2020 2020 2020  m_name:.        
+00023060: 2020 2020 7061 7261 6d73 5b22 6974 656d      params["item
+00023070: 2d6e 616d 6522 5d20 3d20 6e6f 726d 616c  -name"] = normal
+00023080: 697a 655f 6e61 6d65 2869 7465 6d5f 6e61  ize_name(item_na
+00023090: 6d65 290a 2020 2020 2020 2020 6966 2074  me).        if t
+000230a0: 6167 3a0a 2020 2020 2020 2020 2020 2020  ag:.            
+000230b0: 7061 7261 6d73 5b22 7461 6722 5d20 3d20  params["tag"] = 
+000230c0: 7461 670a 2020 2020 2020 2020 6966 2076  tag.        if v
+000230d0: 6572 7369 6f6e 3a0a 2020 2020 2020 2020  ersion:.        
+000230e0: 2020 2020 7061 7261 6d73 5b22 7665 7273      params["vers
+000230f0: 696f 6e22 5d20 3d20 7665 7273 696f 6e0a  ion"] = version.
+00023100: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00023110: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00023120: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
+00023130: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
+00023140: 3d70 6172 616d 7329 2e6a 736f 6e28 290a  =params).json().
+00023150: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+00023160: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00023170: 2069 7465 6d20 696e 2072 6573 706f 6e73   item in respons
+00023180: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00023190: 6573 756c 7473 2e61 7070 656e 6428 6d6c  esults.append(ml
+000231a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000231b0: 6173 2e49 6e64 6578 6564 4875 6253 6f75  as.IndexedHubSou
+000231c0: 7263 6528 2a2a 6974 656d 2929 0a20 2020  rce(**item)).   
+000231d0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+000231e0: 6c74 730a 0a20 2020 2064 6566 2067 6574  lts..    def get
+000231f0: 5f68 7562 5f73 6f75 7263 6528 7365 6c66  _hub_source(self
+00023200: 2c20 736f 7572 6365 5f6e 616d 653a 2073  , source_name: s
+00023210: 7472 293a 0a20 2020 2020 2020 2022 2222  tr):.        """
+00023220: 0a20 2020 2020 2020 2052 6574 7269 6576  .        Retriev
+00023230: 6520 6120 6875 6220 736f 7572 6365 2066  e a hub source f
+00023240: 726f 6d20 7468 6520 4442 2e0a 0a20 2020  rom the DB...   
+00023250: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
+00023260: 6365 5f6e 616d 653a 204e 616d 6520 6f66  ce_name: Name of
+00023270: 2074 6865 2068 7562 2073 6f75 7263 6520   the hub source 
+00023280: 746f 2072 6574 7269 6576 652e 0a20 2020  to retrieve..   
+00023290: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000232a0: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
+000232b0: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+000232c0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+000232d0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+000232e0: 5f63 616c 6c28 6d65 7468 6f64 3d22 4745  _call(method="GE
+000232f0: 5422 2c20 7061 7468 3d70 6174 6829 0a20  T", path=path). 
+00023300: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
+00023310: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00023320: 6173 2e49 6e64 6578 6564 4875 6253 6f75  as.IndexedHubSou
+00023330: 7263 6528 2a2a 7265 7370 6f6e 7365 2e6a  rce(**response.j
+00023340: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+00023350: 6465 6c65 7465 5f68 7562 5f73 6f75 7263  delete_hub_sourc
+00023360: 6528 7365 6c66 2c20 736f 7572 6365 5f6e  e(self, source_n
+00023370: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+00023380: 2020 2022 2222 0a20 2020 2020 2020 2044     """.        D
+00023390: 656c 6574 6520 6120 6875 6220 736f 7572  elete a hub sour
+000233a0: 6365 2066 726f 6d20 7468 6520 4442 2e0a  ce from the DB..
+000233b0: 2020 2020 2020 2020 5468 6520 736f 7572          The sour
+000233c0: 6365 2077 696c 6c20 6265 2064 656c 6574  ce will be delet
+000233d0: 6564 2066 726f 6d20 7468 6520 6c69 7374  ed from the list
+000233e0: 2c20 616e 6420 616e 7920 666f 6c6c 6f77  , and any follow
+000233f0: 696e 6720 736f 7572 6365 7320 7769 6c6c  ing sources will
+00023400: 2062 6520 7072 6f6d 6f74 6564 202d 2066   be promoted - f
+00023410: 6f72 2065 7861 6d70 6c65 2c20 6966 2074  or example, if t
+00023420: 6865 0a20 2020 2020 2020 2031 7374 2073  he.        1st s
+00023430: 6f75 7263 6520 6973 2064 656c 6574 6564  ource is deleted
+00023440: 2c20 7468 6520 326e 6420 736f 7572 6365  , the 2nd source
+00023450: 2077 696c 6c20 6265 636f 6d65 2023 3120   will become #1 
+00023460: 696e 2074 6865 206c 6973 742e 0a20 2020  in the list..   
+00023470: 2020 2020 2054 6865 2067 6c6f 6261 6c20       The global 
+00023480: 6875 6220 736f 7572 6365 2063 616e 6e6f  hub source canno
+00023490: 7420 6265 2064 656c 6574 6564 2e0a 0a20  t be deleted... 
+000234a0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+000234b0: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+000234c0: 6f66 2074 6865 2068 7562 2073 6f75 7263  of the hub sourc
+000234d0: 6520 746f 2064 656c 6574 652e 0a20 2020  e to delete..   
+000234e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000234f0: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
+00023500: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+00023510: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
+00023520: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
+00023530: 643d 2244 454c 4554 4522 2c20 7061 7468  d="DELETE", path
+00023540: 3d70 6174 6829 0a0a 2020 2020 6465 6620  =path)..    def 
+00023550: 6765 745f 6875 625f 6361 7461 6c6f 6728  get_hub_catalog(
+00023560: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00023570: 2020 2020 2020 2073 6f75 7263 655f 6e61         source_na
+00023580: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+00023590: 2076 6572 7369 6f6e 3a20 7374 7220 3d20   version: str = 
+000235a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
+000235b0: 673a 2073 7472 203d 204e 6f6e 652c 0a20  g: str = None,. 
+000235c0: 2020 2020 2020 2066 6f72 6365 5f72 6566         force_ref
+000235d0: 7265 7368 3a20 626f 6f6c 203d 2046 616c  resh: bool = Fal
+000235e0: 7365 2c0a 2020 2020 293a 0a20 2020 2020  se,.    ):.     
+000235f0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00023600: 6574 7269 6576 6520 7468 6520 6974 656d  etrieve the item
+00023610: 2063 6174 616c 6f67 2066 6f72 2061 2073   catalog for a s
+00023620: 7065 6369 6669 6564 2068 7562 2073 6f75  pecified hub sou
+00023630: 7263 652e 0a20 2020 2020 2020 2054 6865  rce..        The
+00023640: 206c 6973 7420 6f66 2069 7465 6d73 2063   list of items c
+00023650: 616e 2062 6520 6669 6c74 6572 6564 2061  an be filtered a
+00023660: 6363 6f72 6469 6e67 2074 6f20 7661 7269  ccording to vari
+00023670: 6f75 7320 6669 6c74 6572 732c 2075 7369  ous filters, usi
+00023680: 6e67 2069 7465 6d27 7320 6d65 7461 6461  ng item's metada
+00023690: 7461 2074 6f20 6669 6c74 6572 2e0a 0a20  ta to filter... 
+000236a0: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+000236b0: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+000236c0: 6f66 2074 6865 2073 6f75 7263 652e 0a20  of the source.. 
+000236d0: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+000236e0: 7273 696f 6e3a 2046 696c 7465 7220 6974  rsion: Filter it
+000236f0: 656d 7320 6163 636f 7264 696e 6720 746f  ems according to
+00023700: 2074 6865 6972 2076 6572 7369 6f6e 2e0a   their version..
+00023710: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+00023720: 6167 3a20 4669 6c74 6572 2069 7465 6d73  ag: Filter items
+00023730: 2062 6173 6564 206f 6e20 7461 672e 0a20   based on tag.. 
+00023740: 2020 2020 2020 203a 7061 7261 6d20 666f         :param fo
+00023750: 7263 655f 7265 6672 6573 683a 204d 616b  rce_refresh: Mak
+00023760: 6520 7468 6520 7365 7276 6572 2066 6574  e the server fet
+00023770: 6368 2074 6865 2063 6174 616c 6f67 2066  ch the catalog f
+00023780: 726f 6d20 7468 6520 6163 7475 616c 2068  rom the actual h
+00023790: 7562 2073 6f75 7263 652c 0a20 2020 2020  ub source,.     
+000237a0: 2020 2020 2020 2072 6174 6865 7220 7468         rather th
+000237b0: 616e 2072 656c 7920 6f6e 2063 6163 6865  an rely on cache
+000237c0: 6420 696e 666f 726d 6174 696f 6e20 7768  d information wh
+000237d0: 6963 6820 6d61 7920 6578 6973 7420 6672  ich may exist fr
+000237e0: 6f6d 2070 7265 7669 6f75 7320 6765 7420  om previous get 
+000237f0: 7265 7175 6573 7473 2e20 466f 7220 6578  requests. For ex
+00023800: 616d 706c 652c 0a20 2020 2020 2020 2020  ample,.         
+00023810: 2020 2069 6620 7468 6520 736f 7572 6365     if the source
+00023820: 2077 6173 2072 652d 6275 696c 742c 0a20   was re-built,. 
+00023830: 2020 2020 2020 2020 2020 2074 6869 7320             this 
+00023840: 7769 6c6c 206d 616b 6520 7468 6520 7365  will make the se
+00023850: 7276 6572 2067 6574 2074 6865 2075 7064  rver get the upd
+00023860: 6174 6564 2069 6e66 6f72 6d61 7469 6f6e  ated information
+00023870: 2e20 4465 6661 756c 7420 6973 2060 6046  . Default is ``F
+00023880: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
+00023890: 3a72 6574 7572 6e73 3a20 3a70 793a 636c  :returns: :py:cl
+000238a0: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
+000238b0: 6f6e 2e73 6368 656d 6173 2e68 7562 2e48  on.schemas.hub.H
+000238c0: 7562 4361 7461 6c6f 6760 206f 626a 6563  ubCatalog` objec
+000238d0: 742c 2077 6869 6368 2069 7320 6573 7365  t, which is esse
+000238e0: 6e74 6961 6c6c 7920 6120 6c69 7374 0a20  ntially a list. 
+000238f0: 2020 2020 2020 2020 2020 206f 6620 3a70             of :p
+00023900: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00023910: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e68  common.schemas.h
+00023920: 7562 2e48 7562 4974 656d 6020 656e 7472  ub.HubItem` entr
+00023930: 6965 732e 0a20 2020 2020 2020 2022 2222  ies..        """
+00023940: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00023950: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+00023960: 6f75 7263 655f 6e61 6d65 7d2f 6974 656d  ource_name}/item
+00023970: 7322 0a20 2020 2020 2020 2070 6172 616d  s".        param
+00023980: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00023990: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
+000239a0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+000239b0: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
+000239c0: 2020 2020 2020 2020 2020 2266 6f72 6365            "force
+000239d0: 2d72 6566 7265 7368 223a 2066 6f72 6365  -refresh": force
+000239e0: 5f72 6566 7265 7368 2c0a 2020 2020 2020  _refresh,.      
+000239f0: 2020 7d0a 2020 2020 2020 2020 7265 7370    }.        resp
+00023a00: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00023a10: 6361 6c6c 286d 6574 686f 643d 2247 4554  call(method="GET
+00023a20: 222c 2070 6174 683d 7061 7468 2c20 7061  ", path=path, pa
+00023a30: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+00023a40: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+00023a50: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00023a60: 2e48 7562 4361 7461 6c6f 6728 2a2a 7265  .HubCatalog(**re
+00023a70: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+00023a80: 2020 2020 6465 6620 6765 745f 6875 625f      def get_hub_
+00023a90: 6974 656d 280a 2020 2020 2020 2020 7365  item(.        se
+00023aa0: 6c66 2c0a 2020 2020 2020 2020 736f 7572  lf,.        sour
+00023ab0: 6365 5f6e 616d 653a 2073 7472 2c0a 2020  ce_name: str,.  
+00023ac0: 2020 2020 2020 6974 656d 5f6e 616d 653a        item_name:
+00023ad0: 2073 7472 2c0a 2020 2020 2020 2020 7665   str,.        ve
+00023ae0: 7273 696f 6e3a 2073 7472 203d 204e 6f6e  rsion: str = Non
+00023af0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
+00023b00: 7374 7220 3d20 226c 6174 6573 7422 2c0a  str = "latest",.
+00023b10: 2020 2020 2020 2020 666f 7263 655f 7265          force_re
+00023b20: 6672 6573 683a 2062 6f6f 6c20 3d20 4661  fresh: bool = Fa
+00023b30: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+00023b40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00023b50: 5265 7472 6965 7665 2061 2073 7065 6369  Retrieve a speci
+00023b60: 6669 6320 6875 6220 6974 656d 2e0a 0a20  fic hub item... 
+00023b70: 2020 2020 2020 203a 7061 7261 6d20 736f         :param so
+00023b80: 7572 6365 5f6e 616d 653a 204e 616d 6520  urce_name: Name 
+00023b90: 6f66 2073 6f75 7263 652e 0a20 2020 2020  of source..     
+00023ba0: 2020 203a 7061 7261 6d20 6974 656d 5f6e     :param item_n
+00023bb0: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00023bc0: 2069 7465 6d20 746f 2072 6574 7269 6576   item to retriev
+00023bd0: 652c 2061 7320 6974 2061 7070 6561 7273  e, as it appears
+00023be0: 2069 6e20 7468 6520 6361 7461 6c6f 672e   in the catalog.
+00023bf0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00023c00: 7665 7273 696f 6e3a 2047 6574 2061 2073  version: Get a s
+00023c10: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
+00023c20: 6f66 2074 6865 2069 7465 6d2e 2044 6566  of the item. Def
+00023c30: 6175 6c74 2069 7320 6060 4e6f 6e65 6060  ault is ``None``
+00023c40: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00023c50: 2074 6167 3a20 4765 7420 6120 7370 6563   tag: Get a spec
+00023c60: 6966 6963 2076 6572 7369 6f6e 206f 6620  ific version of 
+00023c70: 7468 6520 6974 656d 2069 6465 6e74 6966  the item identif
+00023c80: 6965 6420 6279 2074 6167 2e20 4465 6661  ied by tag. Defa
+00023c90: 756c 7420 6973 2060 606c 6174 6573 7460  ult is ``latest`
+00023ca0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
+00023cb0: 6d20 666f 7263 655f 7265 6672 6573 683a  m force_refresh:
+00023cc0: 204d 616b 6520 7468 6520 7365 7276 6572   Make the server
+00023cd0: 2066 6574 6368 2074 6865 2069 6e66 6f72   fetch the infor
+00023ce0: 6d61 7469 6f6e 2066 726f 6d20 7468 6520  mation from the 
+00023cf0: 6163 7475 616c 2068 7562 0a20 2020 2020  actual hub.     
+00023d00: 2020 2020 2020 2073 6f75 7263 652c 2072         source, r
+00023d10: 6174 6865 7220 7468 616e 0a20 2020 2020  ather than.     
+00023d20: 2020 2020 2020 2072 656c 7920 6f6e 2063         rely on c
+00023d30: 6163 6865 6420 696e 666f 726d 6174 696f  ached informatio
+00023d40: 6e2e 2044 6566 6175 6c74 2069 7320 6060  n. Default is ``
+00023d50: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+00023d60: 203a 7265 7475 726e 733a 203a 7079 3a63   :returns: :py:c
+00023d70: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
+00023d80: 6d6f 6e2e 7363 6865 6d61 732e 6875 622e  mon.schemas.hub.
+00023d90: 4875 6249 7465 6d60 2e0a 2020 2020 2020  HubItem`..      
+00023da0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
+00023db0: 7468 203d 2028 6622 6875 622f 736f 7572  th = (f"hub/sour
+00023dc0: 6365 732f 7b73 6f75 7263 655f 6e61 6d65  ces/{source_name
+00023dd0: 7d2f 6974 656d 732f 7b69 7465 6d5f 6e61  }/items/{item_na
+00023de0: 6d65 7d22 2c29 0a20 2020 2020 2020 2070  me}",).        p
+00023df0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00023e00: 2020 2020 2020 2276 6572 7369 6f6e 223a        "version":
+00023e10: 2076 6572 7369 6f6e 2c0a 2020 2020 2020   version,.      
+00023e20: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+00023e30: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
+00023e40: 6f72 6365 2d72 6566 7265 7368 223a 2066  orce-refresh": f
+00023e50: 6f72 6365 5f72 6566 7265 7368 2c0a 2020  orce_refresh,.  
+00023e60: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00023e70: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+00023e80: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
+00023e90: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
+00023ea0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+00023eb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023ec0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00023ed0: 656d 6173 2e48 7562 4974 656d 282a 2a72  emas.HubItem(**r
+00023ee0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+00023ef0: 0a20 2020 2064 6566 2067 6574 5f68 7562  .    def get_hub
+00023f00: 5f61 7373 6574 280a 2020 2020 2020 2020  _asset(.        
+00023f10: 7365 6c66 2c0a 2020 2020 2020 2020 736f  self,.        so
+00023f20: 7572 6365 5f6e 616d 653a 2073 7472 2c0a  urce_name: str,.
+00023f30: 2020 2020 2020 2020 6974 656d 5f6e 616d          item_nam
+00023f40: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+00023f50: 6173 7365 745f 6e61 6d65 3a20 7374 722c  asset_name: str,
+00023f60: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00023f70: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00023f80: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+00023f90: 2022 6c61 7465 7374 222c 0a20 2020 2029   "latest",.    )
+00023fa0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00023fb0: 2020 2020 2020 4765 7420 6875 6220 6173        Get hub as
+00023fc0: 7365 7420 6672 6f6d 2069 7465 6d2e 0a0a  set from item...
+00023fd0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00023fe0: 6f75 7263 655f 6e61 6d65 3a20 4e61 6d65  ource_name: Name
+00023ff0: 206f 6620 736f 7572 6365 2e0a 2020 2020   of source..    
+00024000: 2020 2020 3a70 6172 616d 2069 7465 6d5f      :param item_
+00024010: 6e61 6d65 3a20 2020 4e61 6d65 206f 6620  name:   Name of 
+00024020: 7468 6520 6974 656d 2077 6869 6368 2068  the item which h
+00024030: 6f6c 6473 2074 6865 2061 7373 6574 2e0a  olds the asset..
+00024040: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+00024050: 7373 6574 5f6e 616d 653a 2020 4e61 6d65  sset_name:  Name
+00024060: 206f 6620 7468 6520 6173 7365 7420 746f   of the asset to
+00024070: 2072 6574 7269 6576 652e 0a20 2020 2020   retrieve..     
+00024080: 2020 203a 7061 7261 6d20 7665 7273 696f     :param versio
+00024090: 6e3a 2047 6574 2061 2073 7065 6369 6669  n: Get a specifi
+000240a0: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
+000240b0: 2069 7465 6d2e 2044 6566 6175 6c74 2069   item. Default i
+000240c0: 7320 6060 4e6f 6e65 6060 2e0a 2020 2020  s ``None``..    
+000240d0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
+000240e0: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
+000240f0: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
+00024100: 656d 2069 6465 6e74 6966 6965 6420 6279  em identified by
+00024110: 2074 6167 2e20 4465 6661 756c 7420 6973   tag. Default is
+00024120: 2060 606c 6174 6573 7460 602e 0a0a 2020   ``latest``...  
+00024130: 2020 2020 2020 3a72 6574 7572 6e3a 2068        :return: h
+00024140: 7474 7020 7265 7370 6f6e 7365 2077 6974  ttp response wit
+00024150: 6820 7468 6520 6173 7365 7420 696e 2074  h the asset in t
+00024160: 6865 2063 6f6e 7465 6e74 2061 7474 7269  he content attri
+00024170: 6275 7465 0a20 2020 2020 2020 2022 2222  bute.        """
+00024180: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00024190: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+000241a0: 6f75 7263 655f 6e61 6d65 7d2f 6974 656d  ource_name}/item
+000241b0: 732f 7b69 7465 6d5f 6e61 6d65 7d2f 6173  s/{item_name}/as
+000241c0: 7365 7473 2f7b 6173 7365 745f 6e61 6d65  sets/{asset_name
+000241d0: 7d22 0a20 2020 2020 2020 2070 6172 616d  }".        param
+000241e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+000241f0: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
+00024200: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+00024210: 2020 2274 6167 223a 2074 6167 2c0a 2020    "tag": tag,.  
+00024220: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00024230: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+00024240: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
+00024250: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
+00024260: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+00024270: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024280: 7265 7370 6f6e 7365 0a0a 2020 2020 6465  response..    de
+00024290: 6620 7665 7269 6679 5f61 7574 686f 7269  f verify_authori
+000242a0: 7a61 7469 6f6e 280a 2020 2020 2020 2020  zation(.        
+000242b0: 7365 6c66 2c0a 2020 2020 2020 2020 6175  self,.        au
+000242c0: 7468 6f72 697a 6174 696f 6e5f 7665 7269  thorization_veri
+000242d0: 6669 6361 7469 6f6e 5f69 6e70 7574 3a20  fication_input: 
+000242e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000242f0: 656d 6173 2e41 7574 686f 7269 7a61 7469  emas.Authorizati
+00024300: 6f6e 5665 7269 6669 6361 7469 6f6e 496e  onVerificationIn
+00024310: 7075 742c 0a20 2020 2029 3a0a 2020 2020  put,.    ):.    
+00024320: 2020 2020 2222 2256 6572 6966 6965 7320      """Verifies 
+00024330: 6175 7468 6f72 697a 6174 696f 6e20 666f  authorization fo
+00024340: 7220 7468 6520 7072 6f76 6964 6564 2061  r the provided a
+00024350: 6374 696f 6e20 6f6e 2074 6865 2070 726f  ction on the pro
+00024360: 7669 6465 6420 7265 736f 7572 6365 2e0a  vided resource..
+00024370: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00024380: 6175 7468 6f72 697a 6174 696f 6e5f 7665  authorization_ve
+00024390: 7269 6669 6361 7469 6f6e 5f69 6e70 7574  rification_input
+000243a0: 3a20 496e 7374 616e 6365 206f 660a 2020  : Instance of.  
+000243b0: 2020 2020 2020 2020 2020 3a70 793a 636c            :py:cl
+000243c0: 6173 733a 607e 6d6c 7275 6e2e 636f 6d6d  ass:`~mlrun.comm
+000243d0: 6f6e 2e73 6368 656d 6173 2e41 7574 686f  on.schemas.Autho
+000243e0: 7269 7a61 7469 6f6e 5665 7269 6669 6361  rizationVerifica
+000243f0: 7469 6f6e 496e 7075 7460 2074 6861 7420  tionInput` that 
+00024400: 696e 636c 7564 6573 2061 6c6c 2074 6865  includes all the
+00024410: 206e 6565 6465 6420 7061 7261 6d65 7465   needed paramete
+00024420: 7273 2066 6f72 0a20 2020 2020 2020 2020  rs for.         
+00024430: 2020 2074 6865 2061 7574 6820 7665 7269     the auth veri
+00024440: 6669 6361 7469 6f6e 0a20 2020 2020 2020  fication.       
+00024450: 2022 2222 0a20 2020 2020 2020 2065 7272   """.        err
+00024460: 6f72 5f6d 6573 7361 6765 203d 2022 4175  or_message = "Au
+00024470: 7468 6f72 697a 6174 696f 6e20 6368 6563  thorization chec
+00024480: 6b20 6661 696c 6564 220a 2020 2020 2020  k failed".      
+00024490: 2020 7365 6c66 2e61 7069 5f63 616c 6c28    self.api_call(
+000244a0: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
+000244b0: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
+000244c0: 2022 6175 7468 6f72 697a 6174 696f 6e2f   "authorization/
+000244d0: 7665 7269 6669 6361 7469 6f6e 7322 2c0a  verifications",.
+000244e0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+000244f0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+00024500: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
+00024510: 5f74 6f5f 6a73 6f6e 2861 7574 686f 7269  _to_json(authori
+00024520: 7a61 7469 6f6e 5f76 6572 6966 6963 6174  zation_verificat
+00024530: 696f 6e5f 696e 7075 742e 6469 6374 2829  ion_input.dict()
+00024540: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
+00024550: 2020 6465 6620 6c69 7374 5f61 7069 5f67    def list_api_g
+00024560: 6174 6577 6179 7328 7365 6c66 2c20 7072  ateways(self, pr
+00024570: 6f6a 6563 743d 4e6f 6e65 2920 2d3e 206d  oject=None) -> m
+00024580: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00024590: 6d61 732e 4150 4947 6174 6577 6179 734f  mas.APIGatewaysO
+000245a0: 7574 7075 743a 0a20 2020 2020 2020 2022  utput:.        "
+000245b0: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+000245c0: 6e73 2061 206c 6973 7420 6f66 204e 7563  ns a list of Nuc
+000245d0: 6c69 6f20 6170 6920 6761 7465 7761 7973  lio api gateways
+000245e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000245f0: 7072 6f6a 6563 743a 206f 7074 696f 6e61  project: optiona
+00024600: 6c20 7374 7220 7061 7261 6d65 7465 7220  l str parameter 
+00024610: 746f 2066 696c 7465 7220 6279 2070 726f  to filter by pro
+00024620: 6a65 6374 2c20 6966 206e 6f74 2070 6173  ject, if not pas
+00024630: 7365 642c 2064 6566 6175 6c74 2070 726f  sed, default pro
+00024640: 6a65 6374 2076 616c 7565 2069 7320 7461  ject value is ta
+00024650: 6b65 6e0a 0a20 2020 2020 2020 203a 7265  ken..        :re
+00024660: 7475 726e 3a20 3a70 793a 636c 6173 733a  turn: :py:class:
+00024670: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
+00024680: 6368 656d 6173 2e41 5049 4761 7465 7761  chemas.APIGatewa
+00024690: 7973 602e 0a20 2020 2020 2020 2022 2222  ys`..        """
+000246a0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+000246b0: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+000246c0: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+000246d0: 6a65 6374 0a20 2020 2020 2020 2065 7272  ject.        err
+000246e0: 6f72 203d 2022 6c69 7374 2061 7069 2067  or = "list api g
+000246f0: 6174 6577 6179 7322 0a20 2020 2020 2020  ateways".       
+00024700: 2065 6e64 706f 696e 745f 7061 7468 203d   endpoint_path =
+00024710: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+00024720: 6a65 6374 7d2f 6170 692d 6761 7465 7761  ject}/api-gatewa
+00024730: 7973 220a 2020 2020 2020 2020 7265 7370  ys".        resp
+00024740: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00024750: 6361 6c6c 2822 4745 5422 2c20 656e 6470  call("GET", endp
+00024760: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
+00024770: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00024780: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00024790: 6865 6d61 732e 4150 4947 6174 6577 6179  hemas.APIGateway
+000247a0: 734f 7574 7075 7428 2a2a 7265 7370 6f6e  sOutput(**respon
+000247b0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
+000247c0: 6465 6620 6765 745f 6170 695f 6761 7465  def get_api_gate
+000247d0: 7761 7928 7365 6c66 2c20 6e61 6d65 2c20  way(self, name, 
+000247e0: 7072 6f6a 6563 743d 4e6f 6e65 2920 2d3e  project=None) ->
+000247f0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00024800: 6865 6d61 732e 4150 4947 6174 6577 6179  hemas.APIGateway
+00024810: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00024820: 2020 2020 2020 5265 7475 726e 7320 616e        Returns an
+00024830: 2041 5049 2067 6174 6577 6179 0a20 2020   API gateway.   
+00024840: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00024850: 3a20 4150 4920 6761 7465 7761 7920 6e61  : API gateway na
+00024860: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
+00024870: 6d20 7072 6f6a 6563 743a 206f 7074 696f  m project: optio
+00024880: 6e61 6c20 7374 7220 7061 7261 6d65 7465  nal str paramete
+00024890: 7220 746f 2066 696c 7465 7220 6279 2070  r to filter by p
+000248a0: 726f 6a65 6374 2c20 6966 206e 6f74 2070  roject, if not p
+000248b0: 6173 7365 642c 2064 6566 6175 6c74 2070  assed, default p
+000248c0: 726f 6a65 6374 2076 616c 7565 2069 7320  roject value is 
+000248d0: 7461 6b65 6e0a 0a20 2020 2020 2020 203a  taken..        :
+000248e0: 7265 7475 726e 3a20 203a 7079 3a63 6c61  return:  :py:cla
+000248f0: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
+00024900: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
+00024910: 6577 6179 602e 0a20 2020 2020 2020 2022  eway`..        "
+00024920: 2222 0a20 2020 2020 2020 2070 726f 6a65  "".        proje
+00024930: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+00024940: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00024950: 726f 6a65 6374 0a20 2020 2020 2020 2065  roject.        e
+00024960: 7272 6f72 203d 2022 6765 7420 6170 6920  rror = "get api 
+00024970: 6761 7465 7761 7922 0a20 2020 2020 2020  gateway".       
+00024980: 2065 6e64 706f 696e 745f 7061 7468 203d   endpoint_path =
+00024990: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+000249a0: 6a65 6374 7d2f 6170 692d 6761 7465 7761  ject}/api-gatewa
+000249b0: 7973 2f7b 6e61 6d65 7d22 0a20 2020 2020  ys/{name}".     
+000249c0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+000249d0: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
+000249e0: 222c 2065 6e64 706f 696e 745f 7061 7468  ", endpoint_path
+000249f0: 2c20 6572 726f 7229 0a20 2020 2020 2020  , error).       
+00024a00: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+00024a10: 6d6d 6f6e 2e73 6368 656d 6173 2e41 5049  mmon.schemas.API
+00024a20: 4761 7465 7761 7928 2a2a 7265 7370 6f6e  Gateway(**respon
+00024a30: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
+00024a40: 6465 6620 6465 6c65 7465 5f61 7069 5f67  def delete_api_g
+00024a50: 6174 6577 6179 2873 656c 662c 206e 616d  ateway(self, nam
+00024a60: 652c 2070 726f 6a65 6374 3d4e 6f6e 6529  e, project=None)
+00024a70: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00024a80: 2020 2020 2020 4465 6c65 7465 7320 616e        Deletes an
+00024a90: 2041 5049 2067 6174 6577 6179 0a20 2020   API gateway.   
+00024aa0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00024ab0: 3a20 4150 4920 6761 7465 7761 7920 6e61  : API gateway na
+00024ac0: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
+00024ad0: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+00024ae0: 6374 206e 616d 650a 2020 2020 2020 2020  ct name.        
+00024af0: 2222 220a 2020 2020 2020 2020 7072 6f6a  """.        proj
+00024b00: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+00024b10: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00024b20: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00024b30: 6572 726f 7220 3d20 2264 656c 6574 6520  error = "delete 
+00024b40: 6170 6920 6761 7465 7761 7922 0a20 2020  api gateway".   
+00024b50: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
+00024b60: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00024b70: 7b70 726f 6a65 6374 7d2f 6170 692d 6761  {project}/api-ga
+00024b80: 7465 7761 7973 2f7b 6e61 6d65 7d22 0a20  teways/{name}". 
+00024b90: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+00024ba0: 6361 6c6c 2822 4445 4c45 5445 222c 2065  call("DELETE", e
+00024bb0: 6e64 706f 696e 745f 7061 7468 2c20 6572  ndpoint_path, er
+00024bc0: 726f 7229 0a0a 2020 2020 6465 6620 7374  ror)..    def st
+00024bd0: 6f72 655f 6170 695f 6761 7465 7761 7928  ore_api_gateway(
+00024be0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00024bf0: 2020 2020 2020 2061 7069 5f67 6174 6577         api_gatew
+00024c00: 6179 3a20 556e 696f 6e5b 0a20 2020 2020  ay: Union[.     
+00024c10: 2020 2020 2020 206d 6c72 756e 2e63 6f6d         mlrun.com
+00024c20: 6d6f 6e2e 7363 6865 6d61 732e 4150 4947  mon.schemas.APIG
+00024c30: 6174 6577 6179 2c0a 2020 2020 2020 2020  ateway,.        
+00024c40: 2020 2020 6d6c 7275 6e2e 7275 6e74 696d      mlrun.runtim
+00024c50: 6573 2e6e 7563 6c69 6f2e 6170 695f 6761  es.nuclio.api_ga
+00024c60: 7465 7761 792e 4150 4947 6174 6577 6179  teway.APIGateway
+00024c70: 2c0a 2020 2020 2020 2020 5d2c 0a20 2020  ,.        ],.   
+00024c80: 2020 2020 2070 726f 6a65 6374 3a20 4f70       project: Op
+00024c90: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00024ca0: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
+00024cb0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00024cc0: 732e 4150 4947 6174 6577 6179 3a0a 2020  s.APIGateway:.  
+00024cd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00024ce0: 2020 5374 6f72 6573 2061 6e20 4150 4920    Stores an API 
+00024cf0: 4761 7465 7761 792e 0a20 2020 2020 2020  Gateway..       
+00024d00: 203a 7061 7261 6d20 6170 695f 6761 7465   :param api_gate
+00024d10: 7761 7920 3a70 793a 636c 6173 733a 607e  way :py:class:`~
+00024d20: 6d6c 7275 6e2e 7275 6e74 696d 6573 2e6e  mlrun.runtimes.n
+00024d30: 7563 6c69 6f2e 4150 4947 6174 6577 6179  uclio.APIGateway
+00024d40: 600a 2020 2020 2020 2020 2020 2020 6f72  `.            or
+00024d50: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+00024d60: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00024d70: 732e 4150 4947 6174 6577 6179 603a 2041  s.APIGateway`: A
+00024d80: 5049 2047 6174 6577 6179 2065 6e74 6974  PI Gateway entit
+00024d90: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+00024da0: 6d20 7072 6f6a 6563 743a 2070 726f 6a65  m project: proje
+00024db0: 6374 206e 616d 652e 204d 616e 6461 746f  ct name. Mandato
+00024dc0: 7279 2069 6620 6170 695f 6761 7465 7761  ry if api_gatewa
+00024dd0: 7920 6973 206d 6c72 756e 2e63 6f6d 6d6f  y is mlrun.commo
+00024de0: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
+00024df0: 6577 6179 2e0a 0a20 2020 2020 2020 203a  eway...        :
+00024e00: 7265 7475 726e 3a20 203a 7079 3a63 6c61  return:  :py:cla
+00024e10: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
+00024e20: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
+00024e30: 6577 6179 602e 0a20 2020 2020 2020 2022  eway`..        "
+00024e40: 2222 0a0a 2020 2020 2020 2020 6966 2069  ""..        if i
+00024e50: 7369 6e73 7461 6e63 6528 6170 695f 6761  sinstance(api_ga
+00024e60: 7465 7761 792c 206d 6c72 756e 2e72 756e  teway, mlrun.run
+00024e70: 7469 6d65 732e 6e75 636c 696f 2e61 7069  times.nuclio.api
+00024e80: 5f67 6174 6577 6179 2e41 5049 4761 7465  _gateway.APIGate
+00024e90: 7761 7929 3a0a 2020 2020 2020 2020 2020  way):.          
+00024ea0: 2020 6170 695f 6761 7465 7761 7920 3d20    api_gateway = 
+00024eb0: 6170 695f 6761 7465 7761 792e 746f 5f73  api_gateway.to_s
+00024ec0: 6368 656d 6528 290a 2020 2020 2020 2020  cheme().        
+00024ed0: 656e 6470 6f69 6e74 5f70 6174 6820 3d20  endpoint_path = 
+00024ee0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00024ef0: 6563 747d 2f61 7069 2d67 6174 6577 6179  ect}/api-gateway
+00024f00: 732f 7b61 7069 5f67 6174 6577 6179 2e6d  s/{api_gateway.m
+00024f10: 6574 6164 6174 612e 6e61 6d65 7d22 0a20  etadata.name}". 
+00024f20: 2020 2020 2020 2065 7272 6f72 203d 2022         error = "
+00024f30: 7374 6f72 6520 6170 6920 6761 7465 7761  store api gatewa
+00024f40: 7973 220a 2020 2020 2020 2020 7265 7370  ys".        resp
+00024f50: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+00024f60: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00024f70: 2020 2250 5554 222c 0a20 2020 2020 2020    "PUT",.       
+00024f80: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
+00024f90: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+00024fa0: 6572 726f 722c 0a20 2020 2020 2020 2020  error,.         
+00024fb0: 2020 206a 736f 6e3d 6170 695f 6761 7465     json=api_gate
+00024fc0: 7761 792e 6469 6374 2865 7863 6c75 6465  way.dict(exclude
+00024fd0: 5f6e 6f6e 653d 5472 7565 292c 0a20 2020  _none=True),.   
+00024fe0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00024ff0: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+00025000: 6f6e 2e73 6368 656d 6173 2e41 5049 4761  on.schemas.APIGa
+00025010: 7465 7761 7928 2a2a 7265 7370 6f6e 7365  teway(**response
+00025020: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+00025030: 6620 7472 6967 6765 725f 6d69 6772 6174  f trigger_migrat
+00025040: 696f 6e73 2873 656c 6629 202d 3e20 4f70  ions(self) -> Op
+00025050: 7469 6f6e 616c 5b6d 6c72 756e 2e63 6f6d  tional[mlrun.com
+00025060: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
+00025070: 6772 6f75 6e64 5461 736b 5d3a 0a20 2020  groundTask]:.   
+00025080: 2020 2020 2022 2222 5472 6967 6765 7220       """Trigger 
+00025090: 6d69 6772 6174 696f 6e73 2028 7769 6c6c  migrations (will
+000250a0: 2064 6f20 6e6f 7468 696e 6720 6966 206e   do nothing if n
+000250b0: 6f20 6d69 6772 6174 696f 6e73 2061 7265  o migrations are
+000250c0: 206e 6565 6465 6429 2061 6e64 2077 6169   needed) and wai
+000250d0: 7420 666f 7220 7468 656d 2074 6f20 6669  t for them to fi
+000250e0: 6e69 7368 2069 6620 6163 7475 616c 6c79  nish if actually
+000250f0: 0a20 2020 2020 2020 2074 7269 6767 6572  .        trigger
+00025100: 6564 0a20 2020 2020 2020 203a 7265 7475  ed.        :retu
+00025110: 726e 733a 203a 7079 3a63 6c61 7373 3a60  rns: :py:class:`
+00025120: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+00025130: 6865 6d61 732e 4261 636b 6772 6f75 6e64  hemas.Background
+00025140: 5461 736b 602e 0a20 2020 2020 2020 2022  Task`..        "
+00025150: 2222 0a20 2020 2020 2020 2072 6573 706f  "".        respo
+00025160: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+00025170: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00025180: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
+00025190: 2020 2020 2022 6f70 6572 6174 696f 6e73       "operations
+000251a0: 2f6d 6967 7261 7469 6f6e 7322 2c0a 2020  /migrations",.  
+000251b0: 2020 2020 2020 2020 2020 2246 6169 6c65            "Faile
+000251c0: 6420 7472 6967 6765 7269 6e67 206d 6967  d triggering mig
+000251d0: 7261 7469 6f6e 7322 2c0a 2020 2020 2020  rations",.      
+000251e0: 2020 290a 2020 2020 2020 2020 6966 2072    ).        if r
+000251f0: 6573 706f 6e73 652e 7374 6174 7573 5f63  esponse.status_c
+00025200: 6f64 6520 3d3d 2068 7474 702e 4854 5450  ode == http.HTTP
+00025210: 5374 6174 7573 2e41 4343 4550 5445 443a  Status.ACCEPTED:
+00025220: 0a20 2020 2020 2020 2020 2020 2062 6163  .            bac
+00025230: 6b67 726f 756e 645f 7461 736b 203d 206d  kground_task = m
+00025240: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00025250: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+00025260: 736b 282a 2a72 6573 706f 6e73 652e 6a73  sk(**response.js
+00025270: 6f6e 2829 290a 2020 2020 2020 2020 2020  on()).          
+00025280: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+00025290: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
+000252a0: 6e64 5f74 6173 6b5f 746f 5f72 6561 6368  nd_task_to_reach
+000252b0: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+000252c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000252d0: 2062 6163 6b67 726f 756e 645f 7461 736b   background_task
+000252e0: 2e6d 6574 6164 6174 612e 6e61 6d65 0a20  .metadata.name. 
+000252f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00025300: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+00025310: 0a0a 2020 2020 6465 6620 7365 745f 7275  ..    def set_ru
+00025320: 6e5f 6e6f 7469 6669 6361 7469 6f6e 7328  n_notifications(
+00025330: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00025340: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+00025350: 7374 722c 0a20 2020 2020 2020 2072 756e  str,.        run
+00025360: 5f75 6964 3a20 7374 722c 0a20 2020 2020  _uid: str,.     
+00025370: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
+00025380: 3a20 6c69 7374 5b6d 6c72 756e 2e6d 6f64  : list[mlrun.mod
+00025390: 656c 2e4e 6f74 6966 6963 6174 696f 6e5d  el.Notification]
+000253a0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
+000253b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000253c0: 2020 2020 5365 7420 6e6f 7469 6669 6361      Set notifica
+000253d0: 7469 6f6e 7320 6f6e 2061 2072 756e 2e20  tions on a run. 
+000253e0: 5468 6973 2077 696c 6c20 6f76 6572 7269  This will overri
+000253f0: 6465 2061 6e79 2065 7869 7374 696e 6720  de any existing 
+00025400: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
+00025410: 2074 6865 2072 756e 2e0a 2020 2020 2020   the run..      
+00025420: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00025430: 3a20 5072 6f6a 6563 7420 636f 6e74 6169  : Project contai
+00025440: 6e69 6e67 2074 6865 2072 756e 2e0a 2020  ning the run..  
+00025450: 2020 2020 2020 3a70 6172 616d 2072 756e        :param run
+00025460: 5f75 6964 3a20 5549 4420 6f66 2074 6865  _uid: UID of the
+00025470: 2072 756e 2e0a 2020 2020 2020 2020 3a70   run..        :p
+00025480: 6172 616d 206e 6f74 6966 6963 6174 696f  aram notificatio
+00025490: 6e73 3a20 4c69 7374 206f 6620 6e6f 7469  ns: List of noti
+000254a0: 6669 6361 7469 6f6e 7320 746f 2073 6574  fications to set
+000254b0: 206f 6e20 7468 6520 7275 6e2e 2044 6566   on the run. Def
+000254c0: 6175 6c74 2069 7320 616e 2065 6d70 7479  ault is an empty
+000254d0: 206c 6973 742e 0a20 2020 2020 2020 2022   list..        "
+000254e0: 2222 0a20 2020 2020 2020 206e 6f74 6966  "".        notif
+000254f0: 6963 6174 696f 6e73 203d 206e 6f74 6966  ications = notif
+00025500: 6963 6174 696f 6e73 206f 7220 5b5d 0a0a  ications or []..
+00025510: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00025520: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00025530: 2020 2022 5055 5422 2c0a 2020 2020 2020     "PUT",.      
+00025540: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
+00025550: 2f7b 7072 6f6a 6563 747d 2f72 756e 732f  /{project}/runs/
+00025560: 7b72 756e 5f75 6964 7d2f 6e6f 7469 6669  {run_uid}/notifi
+00025570: 6361 7469 6f6e 7322 2c0a 2020 2020 2020  cations",.      
+00025580: 2020 2020 2020 6622 4661 696c 6564 2074        f"Failed t
+00025590: 6f20 7365 7420 6e6f 7469 6669 6361 7469  o set notificati
+000255a0: 6f6e 7320 6f6e 2072 756e 2e20 7569 643d  ons on run. uid=
+000255b0: 7b72 756e 5f75 6964 7d2c 2070 726f 6a65  {run_uid}, proje
+000255c0: 6374 3d7b 7072 6f6a 6563 747d 222c 0a20  ct={project}",. 
+000255d0: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
+000255e0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000255f0: 2020 226e 6f74 6966 6963 6174 696f 6e73    "notifications
+00025600: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+00025610: 2020 2020 2020 2020 206e 6f74 6966 6963           notific
+00025620: 6174 696f 6e2e 746f 5f64 6963 7428 2920  ation.to_dict() 
+00025630: 666f 7220 6e6f 7469 6669 6361 7469 6f6e  for notification
+00025640: 2069 6e20 6e6f 7469 6669 6361 7469 6f6e   in notification
+00025650: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00025660: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00025670: 207d 2c0a 2020 2020 2020 2020 290a 0a20   },.        ).. 
+00025680: 2020 2064 6566 2073 6574 5f73 6368 6564     def set_sched
+00025690: 756c 655f 6e6f 7469 6669 6361 7469 6f6e  ule_notification
+000256a0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+000256b0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+000256c0: 3a20 7374 722c 0a20 2020 2020 2020 2073  : str,.        s
+000256d0: 6368 6564 756c 655f 6e61 6d65 3a20 7374  chedule_name: st
+000256e0: 722c 0a20 2020 2020 2020 206e 6f74 6966  r,.        notif
+000256f0: 6963 6174 696f 6e73 3a20 6c69 7374 5b6d  ications: list[m
+00025700: 6c72 756e 2e6d 6f64 656c 2e4e 6f74 6966  lrun.model.Notif
+00025710: 6963 6174 696f 6e5d 203d 204e 6f6e 652c  ication] = None,
+00025720: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00025730: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
+00025740: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
+00025750: 2061 2073 6368 6564 756c 652e 2054 6869   a schedule. Thi
+00025760: 7320 7769 6c6c 206f 7665 7272 6964 6520  s will override 
+00025770: 616e 7920 6578 6973 7469 6e67 206e 6f74  any existing not
+00025780: 6966 6963 6174 696f 6e73 206f 6e20 7468  ifications on th
+00025790: 6520 7363 6865 6475 6c65 2e0a 2020 2020  e schedule..    
+000257a0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+000257b0: 6374 3a20 5072 6f6a 6563 7420 636f 6e74  ct: Project cont
+000257c0: 6169 6e69 6e67 2074 6865 2073 6368 6564  aining the sched
+000257d0: 756c 652e 0a20 2020 2020 2020 203a 7061  ule..        :pa
+000257e0: 7261 6d20 7363 6865 6475 6c65 5f6e 616d  ram schedule_nam
+000257f0: 653a 204e 616d 6520 6f66 2074 6865 2073  e: Name of the s
+00025800: 6368 6564 756c 652e 0a20 2020 2020 2020  chedule..       
+00025810: 203a 7061 7261 6d20 6e6f 7469 6669 6361   :param notifica
+00025820: 7469 6f6e 733a 204c 6973 7420 6f66 206e  tions: List of n
+00025830: 6f74 6966 6963 6174 696f 6e73 2074 6f20  otifications to 
+00025840: 7365 7420 6f6e 2074 6865 2073 6368 6564  set on the sched
+00025850: 756c 652e 2044 6566 6175 6c74 2069 7320  ule. Default is 
+00025860: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
+00025870: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00025880: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
+00025890: 203d 206e 6f74 6966 6963 6174 696f 6e73   = notifications
+000258a0: 206f 7220 5b5d 0a0a 2020 2020 2020 2020   or []..        
+000258b0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+000258c0: 2020 2020 2020 2020 2020 2022 5055 5422             "PUT"
+000258d0: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
+000258e0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000258f0: 747d 2f73 6368 6564 756c 6573 2f7b 7363  t}/schedules/{sc
+00025900: 6865 6475 6c65 5f6e 616d 657d 2f6e 6f74  hedule_name}/not
+00025910: 6966 6963 6174 696f 6e73 222c 0a20 2020  ifications",.   
+00025920: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
+00025930: 6420 746f 2073 6574 206e 6f74 6966 6963  d to set notific
+00025940: 6174 696f 6e73 206f 6e20 7363 6865 6475  ations on schedu
+00025950: 6c65 2e20 7363 6865 6475 6c65 3d7b 7363  le. schedule={sc
+00025960: 6865 6475 6c65 5f6e 616d 657d 2c20 7072  hedule_name}, pr
+00025970: 6f6a 6563 743d 7b70 726f 6a65 6374 7d22  oject={project}"
+00025980: 2c0a 2020 2020 2020 2020 2020 2020 6a73  ,.            js
+00025990: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
+000259a0: 2020 2020 2022 6e6f 7469 6669 6361 7469       "notificati
+000259b0: 6f6e 7322 3a20 5b0a 2020 2020 2020 2020  ons": [.        
+000259c0: 2020 2020 2020 2020 2020 2020 6e6f 7469              noti
+000259d0: 6669 6361 7469 6f6e 2e74 6f5f 6469 6374  fication.to_dict
+000259e0: 2829 2066 6f72 206e 6f74 6966 6963 6174  () for notificat
+000259f0: 696f 6e20 696e 206e 6f74 6966 6963 6174  ion in notificat
+00025a00: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+00025a10: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00025a20: 2020 2020 7d2c 0a20 2020 2020 2020 2029      },.        )
+00025a30: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
+00025a40: 7275 6e5f 6e6f 7469 6669 6361 7469 6f6e  run_notification
+00025a50: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00025a60: 0a20 2020 2020 2020 206e 6f74 6966 6963  .        notific
+00025a70: 6174 696f 6e5f 6f62 6a65 6374 733a 206c  ation_objects: l
+00025a80: 6973 745b 6d6c 7275 6e2e 6d6f 6465 6c2e  ist[mlrun.model.
+00025a90: 4e6f 7469 6669 6361 7469 6f6e 5d2c 0a20  Notification],. 
+00025aa0: 2020 2020 2020 2072 756e 5f75 6964 3a20         run_uid: 
+00025ab0: 7374 722c 0a20 2020 2020 2020 2070 726f  str,.        pro
+00025ac0: 6a65 6374 3a20 7374 7220 3d20 4e6f 6e65  ject: str = None
+00025ad0: 2c0a 2020 2020 2020 2020 6d61 736b 5f70  ,.        mask_p
+00025ae0: 6172 616d 733a 2062 6f6f 6c20 3d20 5472  arams: bool = Tr
+00025af0: 7565 2c0a 2020 2020 293a 0a20 2020 2020  ue,.    ):.     
+00025b00: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
+00025b10: 6f72 2069 6e74 6572 6e61 6c20 7573 652e  or internal use.
+00025b20: 0a20 2020 2020 2020 2054 6865 206e 6f74  .        The not
+00025b30: 6966 6963 6174 696f 6e20 6d65 6368 616e  ification mechan
+00025b40: 6973 6d20 6d61 7920 7275 6e20 226c 6f63  ism may run "loc
+00025b50: 616c 6c79 2220 666f 7220 6365 7274 6169  ally" for certai
+00025b60: 6e20 7275 6e74 696d 6573 2e0a 2020 2020  n runtimes..    
+00025b70: 2020 2020 486f 7765 7665 722c 2074 6865      However, the
+00025b80: 2075 7064 6174 6573 206f 6363 7572 2069   updates occur i
+00025b90: 6e20 7468 6520 4150 4920 736f 206e 6f74  n the API so not
+00025ba0: 6869 6e67 2074 6f20 646f 2068 6572 652e  hing to do here.
+00025bb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00025bc0: 2020 2020 2070 6173 730a 0a20 2020 2064       pass..    d
+00025bd0: 6566 2073 7562 6d69 745f 776f 726b 666c  ef submit_workfl
+00025be0: 6f77 280a 2020 2020 2020 2020 7365 6c66  ow(.        self
+00025bf0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00025c00: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00025c10: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
+00025c20: 2020 2077 6f72 6b66 6c6f 775f 7370 6563     workflow_spec
+00025c30: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00025c40: 2020 2020 206d 6c72 756e 2e70 726f 6a65       mlrun.proje
+00025c50: 6374 732e 7069 7065 6c69 6e65 732e 576f  cts.pipelines.Wo
+00025c60: 726b 666c 6f77 5370 6563 2c0a 2020 2020  rkflowSpec,.    
+00025c70: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+00025c80: 6d6d 6f6e 2e73 6368 656d 6173 2e57 6f72  mmon.schemas.Wor
+00025c90: 6b66 6c6f 7753 7065 632c 0a20 2020 2020  kflowSpec,.     
+00025ca0: 2020 2020 2020 2064 6963 742c 0a20 2020         dict,.   
+00025cb0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00025cc0: 6172 6775 6d65 6e74 733a 204f 7074 696f  arguments: Optio
+00025cd0: 6e61 6c5b 6469 6374 5d20 3d20 4e6f 6e65  nal[dict] = None
+00025ce0: 2c0a 2020 2020 2020 2020 6172 7469 6661  ,.        artifa
+00025cf0: 6374 5f70 6174 683a 204f 7074 696f 6e61  ct_path: Optiona
+00025d00: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+00025d10: 2020 2020 2020 2073 6f75 7263 653a 204f         source: O
+00025d20: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00025d30: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
+00025d40: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
+00025d50: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00025d60: 2020 2020 206e 616d 6573 7061 6365 3a20       namespace: 
+00025d70: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00025d80: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e6f  None,.        no
+00025d90: 7469 6669 6361 7469 6f6e 733a 206c 6973  tifications: lis
+00025da0: 745b 6d6c 7275 6e2e 6d6f 6465 6c2e 4e6f  t[mlrun.model.No
+00025db0: 7469 6669 6361 7469 6f6e 5d20 3d20 4e6f  tification] = No
+00025dc0: 6e65 2c0a 2020 2020 2920 2d3e 206d 6c72  ne,.    ) -> mlr
+00025dd0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00025de0: 732e 576f 726b 666c 6f77 5265 7370 6f6e  s.WorkflowRespon
+00025df0: 7365 3a0a 2020 2020 2020 2020 2222 220a  se:.        """.
+00025e00: 2020 2020 2020 2020 5375 626d 6974 7469          Submitti
+00025e10: 6e67 2077 6f72 6b66 6c6f 7720 666f 7220  ng workflow for 
+00025e20: 6120 7265 6d6f 7465 2065 7865 6375 7469  a remote executi
+00025e30: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+00025e40: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
+00025e50: 2020 2020 2070 726f 6a65 6374 206e 616d       project nam
+00025e60: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+00025e70: 206e 616d 653a 2020 2020 2020 2020 2020   name:          
+00025e80: 2020 776f 726b 666c 6f77 206e 616d 650a    workflow name.
+00025e90: 2020 2020 2020 2020 3a70 6172 616d 2077          :param w
+00025ea0: 6f72 6b66 6c6f 775f 7370 6563 3a20 2020  orkflow_spec:   
+00025eb0: 7468 6520 776f 726b 666c 6f77 2073 7065  the workflow spe
+00025ec0: 6320 746f 2065 7865 6375 7465 0a20 2020  c to execute.   
+00025ed0: 2020 2020 203a 7061 7261 6d20 6172 6775       :param argu
+00025ee0: 6d65 6e74 733a 2020 2020 2020 2061 7267  ments:       arg
+00025ef0: 756d 656e 7473 2066 6f72 2074 6865 2077  uments for the w
+00025f00: 6f72 6b66 6c6f 770a 2020 2020 2020 2020  orkflow.        
+00025f10: 3a70 6172 616d 2061 7274 6966 6163 745f  :param artifact_
+00025f20: 7061 7468 3a20 2020 6172 7469 6661 6374  path:   artifact
+00025f30: 2074 6172 6765 7420 7061 7468 206f 6620   target path of 
+00025f40: 7468 6520 776f 726b 666c 6f77 0a20 2020  the workflow.   
+00025f50: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
+00025f60: 6365 3a20 2020 2020 2020 2020 2073 6f75  ce:          sou
+00025f70: 7263 6520 7572 6c20 6f66 2074 6865 2070  rce url of the p
+00025f80: 726f 6a65 6374 0a20 2020 2020 2020 203a  roject.        :
+00025f90: 7061 7261 6d20 7275 6e5f 6e61 6d65 3a20  param run_name: 
+00025fa0: 2020 2020 2020 2072 756e 206e 616d 6520         run name 
+00025fb0: 746f 206f 7665 7272 6964 6520 7468 6520  to override the 
+00025fc0: 6465 6661 756c 743a 2027 776f 726b 666c  default: 'workfl
+00025fd0: 6f77 2d72 756e 6e65 722d 3c77 6f72 6b66  ow-runner-<workf
+00025fe0: 6c6f 7720 6e61 6d65 3e27 0a20 2020 2020  low name>'.     
+00025ff0: 2020 203a 7061 7261 6d20 6e61 6d65 7370     :param namesp
+00026000: 6163 653a 2020 2020 2020 206b 7562 6572  ace:       kuber
+00026010: 6e65 7465 7320 6e61 6d65 7370 6163 6520  netes namespace 
+00026020: 6966 206f 7468 6572 2074 6861 6e20 6465  if other than de
+00026030: 6661 756c 740a 2020 2020 2020 2020 3a70  fault.        :p
+00026040: 6172 616d 206e 6f74 6966 6963 6174 696f  aram notificatio
+00026050: 6e73 3a20 2020 6c69 7374 206f 6620 6e6f  ns:   list of no
+00026060: 7469 6669 6361 7469 6f6e 7320 746f 2073  tifications to s
+00026070: 656e 6420 7768 656e 2077 6f72 6b66 6c6f  end when workflo
+00026080: 7720 6578 6563 7574 696f 6e20 6973 2063  w execution is c
+00026090: 6f6d 706c 6574 6564 0a0a 2020 2020 2020  ompleted..      
+000260a0: 2020 3a72 6574 7572 6e73 3a20 2020 203a    :returns:    :
+000260b0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+000260c0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+000260d0: 576f 726b 666c 6f77 5265 7370 6f6e 7365  WorkflowResponse
+000260e0: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+000260f0: 2020 2020 2020 2069 6d61 6765 203d 2028         image = (
+00026100: 0a20 2020 2020 2020 2020 2020 2077 6f72  .            wor
+00026110: 6b66 6c6f 775f 7370 6563 2e69 6d61 6765  kflow_spec.image
+00026120: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00026130: 6861 7361 7474 7228 776f 726b 666c 6f77  hasattr(workflow
+00026140: 5f73 7065 632c 2022 696d 6167 6522 290a  _spec, "image").
+00026150: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00026160: 2077 6f72 6b66 6c6f 775f 7370 6563 2e67   workflow_spec.g
+00026170: 6574 2822 696d 6167 6522 2c20 4e6f 6e65  et("image", None
+00026180: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00026190: 2020 2020 776f 726b 666c 6f77 5f6e 616d      workflow_nam
+000261a0: 6520 3d20 6e61 6d65 206f 7220 280a 2020  e = name or (.  
+000261b0: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
+000261c0: 6f77 5f73 7065 632e 6e61 6d65 0a20 2020  ow_spec.name.   
+000261d0: 2020 2020 2020 2020 2069 6620 6861 7361           if hasa
+000261e0: 7474 7228 776f 726b 666c 6f77 5f73 7065  ttr(workflow_spe
+000261f0: 632c 2022 6e61 6d65 2229 0a20 2020 2020  c, "name").     
+00026200: 2020 2020 2020 2065 6c73 6520 776f 726b         else work
+00026210: 666c 6f77 5f73 7065 632e 6765 7428 226e  flow_spec.get("n
+00026220: 616d 6522 2c20 4e6f 6e65 290a 2020 2020  ame", None).    
+00026230: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00026240: 7120 3d20 7b0a 2020 2020 2020 2020 2020  q = {.          
+00026250: 2020 2261 7267 756d 656e 7473 223a 2061    "arguments": a
+00026260: 7267 756d 656e 7473 2c0a 2020 2020 2020  rguments,.      
+00026270: 2020 2020 2020 2261 7274 6966 6163 745f        "artifact_
+00026280: 7061 7468 223a 2061 7274 6966 6163 745f  path": artifact_
+00026290: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+000262a0: 2020 2273 6f75 7263 6522 3a20 736f 7572    "source": sour
+000262b0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+000262c0: 2272 756e 5f6e 616d 6522 3a20 7275 6e5f  "run_name": run_
+000262d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+000262e0: 2020 226e 616d 6573 7061 6365 223a 206e    "namespace": n
+000262f0: 616d 6573 7061 6365 2c0a 2020 2020 2020  amespace,.      
+00026300: 2020 7d0a 2020 2020 2020 2020 6966 2069    }.        if i
+00026310: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
+00026320: 2020 2020 2020 2077 6f72 6b66 6c6f 775f         workflow_
+00026330: 7370 6563 2c0a 2020 2020 2020 2020 2020  spec,.          
+00026340: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+00026350: 6368 656d 6173 2e57 6f72 6b66 6c6f 7753  chemas.WorkflowS
+00026360: 7065 632c 0a20 2020 2020 2020 2029 3a0a  pec,.        ):.
+00026370: 2020 2020 2020 2020 2020 2020 7265 715b              req[
+00026380: 2273 7065 6322 5d20 3d20 776f 726b 666c  "spec"] = workfl
+00026390: 6f77 5f73 7065 632e 6469 6374 2829 0a20  ow_spec.dict(). 
+000263a0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000263b0: 7374 616e 6365 2877 6f72 6b66 6c6f 775f  stance(workflow_
+000263c0: 7370 6563 2c20 6d6c 7275 6e2e 7072 6f6a  spec, mlrun.proj
+000263d0: 6563 7473 2e70 6970 656c 696e 6573 2e57  ects.pipelines.W
+000263e0: 6f72 6b66 6c6f 7753 7065 6329 3a0a 2020  orkflowSpec):.  
+000263f0: 2020 2020 2020 2020 2020 7265 715b 2273            req["s
+00026400: 7065 6322 5d20 3d20 776f 726b 666c 6f77  pec"] = workflow
+00026410: 5f73 7065 632e 746f 5f64 6963 7428 290a  _spec.to_dict().
+00026420: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00026430: 2020 2020 2020 2020 2020 7265 715b 2273            req["s
+00026440: 7065 6322 5d20 3d20 776f 726b 666c 6f77  pec"] = workflow
+00026450: 5f73 7065 630a 2020 2020 2020 2020 7265  _spec.        re
+00026460: 715b 2273 7065 6322 5d5b 2269 6d61 6765  q["spec"]["image
+00026470: 225d 203d 2069 6d61 6765 0a20 2020 2020  "] = image.     
+00026480: 2020 2072 6571 5b22 7370 6563 225d 5b22     req["spec"]["
+00026490: 6e61 6d65 225d 203d 2077 6f72 6b66 6c6f  name"] = workflo
+000264a0: 775f 6e61 6d65 0a20 2020 2020 2020 2069  w_name.        i
+000264b0: 6620 6e6f 7469 6669 6361 7469 6f6e 733a  f notifications:
+000264c0: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
+000264d0: 5b22 6e6f 7469 6669 6361 7469 6f6e 7322  ["notifications"
+000264e0: 5d20 3d20 5b0a 2020 2020 2020 2020 2020  ] = [.          
+000264f0: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
+00026500: 6f6e 2e74 6f5f 6469 6374 2829 2066 6f72  on.to_dict() for
+00026510: 206e 6f74 6966 6963 6174 696f 6e20 696e   notification in
+00026520: 206e 6f74 6966 6963 6174 696f 6e73 0a20   notifications. 
+00026530: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
+00026540: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00026550: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00026560: 2020 2020 2020 2020 2020 2020 2250 4f53              "POS
+00026570: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
+00026580: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00026590: 6563 747d 2f77 6f72 6b66 6c6f 7773 2f7b  ect}/workflows/{
+000265a0: 776f 726b 666c 6f77 5f6e 616d 657d 2f73  workflow_name}/s
+000265b0: 7562 6d69 7422 2c0a 2020 2020 2020 2020  ubmit",.        
+000265c0: 2020 2020 6a73 6f6e 3d72 6571 2c0a 2020      json=req,.  
+000265d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000265e0: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
+000265f0: 6d6f 6e2e 7363 6865 6d61 732e 576f 726b  mon.schemas.Work
+00026600: 666c 6f77 5265 7370 6f6e 7365 282a 2a72  flowResponse(**r
+00026610: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
+00026620: 0a20 2020 2064 6566 2067 6574 5f77 6f72  .    def get_wor
+00026630: 6b66 6c6f 775f 6964 280a 2020 2020 2020  kflow_id(.      
+00026640: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00026650: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+00026660: 2020 2020 2020 6e61 6d65 3a20 7374 722c        name: str,
+00026670: 0a20 2020 2020 2020 2072 756e 5f69 643a  .        run_id:
+00026680: 2073 7472 2c0a 2020 2020 2020 2020 656e   str,.        en
+00026690: 6769 6e65 3a20 7374 7220 3d20 2222 2c0a  gine: str = "",.
+000266a0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+000266b0: 2222 0a20 2020 2020 2020 2052 6574 7269  "".        Retri
+000266c0: 6576 6520 776f 726b 666c 6f77 2069 6420  eve workflow id 
+000266d0: 6672 6f6d 2074 6865 2075 6964 206f 6620  from the uid of 
+000266e0: 7468 6520 776f 726b 666c 6f77 2072 756e  the workflow run
+000266f0: 6e65 722e 0a0a 2020 2020 2020 2020 3a70  ner...        :p
+00026700: 6172 616d 2070 726f 6a65 6374 3a20 7072  aram project: pr
+00026710: 6f6a 6563 7420 6e61 6d65 0a20 2020 2020  oject name.     
+00026720: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+00026730: 2020 2077 6f72 6b66 6c6f 7720 6e61 6d65     workflow name
+00026740: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00026750: 7275 6e5f 6964 3a20 2074 6865 2069 6420  run_id:  the id 
+00026760: 6f66 2074 6865 2077 6f72 6b66 6c6f 7720  of the workflow 
+00026770: 7275 6e6e 6572 202d 2074 6865 206a 6f62  runner - the job
+00026780: 2074 6861 7420 7275 6e73 2074 6865 2077   that runs the w
+00026790: 6f72 6b66 6c6f 770a 2020 2020 2020 2020  orkflow.        
+000267a0: 3a70 6172 616d 2065 6e67 696e 653a 2020  :param engine:  
+000267b0: 7069 7065 6c69 6e65 2072 756e 6e65 720a  pipeline runner.
+000267c0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+000267d0: 733a 2020 203a 7079 3a63 6c61 7373 3a60  s:   :py:class:`
+000267e0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+000267f0: 6865 6d61 732e 4765 7457 6f72 6b66 6c6f  hemas.GetWorkflo
+00026800: 7752 6573 706f 6e73 6560 2e0a 2020 2020  wResponse`..    
+00026810: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00026820: 7061 7261 6d73 203d 207b 7d0a 2020 2020  params = {}.    
+00026830: 2020 2020 6966 2065 6e67 696e 653a 0a20      if engine:. 
+00026840: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00026850: 735b 2265 6e67 696e 6522 5d20 3d20 656e  s["engine"] = en
+00026860: 6769 6e65 0a20 2020 2020 2020 2072 6573  gine.        res
+00026870: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+00026880: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00026890: 2020 2022 4745 5422 2c0a 2020 2020 2020     "GET",.      
+000268a0: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
+000268b0: 2f7b 7072 6f6a 6563 747d 2f77 6f72 6b66  /{project}/workf
+000268c0: 6c6f 7773 2f7b 6e61 6d65 7d2f 7275 6e73  lows/{name}/runs
+000268d0: 2f7b 7275 6e5f 6964 7d22 2c0a 2020 2020  /{run_id}",.    
+000268e0: 2020 2020 2020 2020 7061 7261 6d73 3d70          params=p
+000268f0: 6172 616d 732c 0a20 2020 2020 2020 2029  arams,.        )
+00026900: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026910: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00026920: 656d 6173 2e47 6574 576f 726b 666c 6f77  emas.GetWorkflow
+00026930: 5265 7370 6f6e 7365 282a 2a72 6573 706f  Response(**respo
+00026940: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
+00026950: 2064 6566 206c 6f61 645f 7072 6f6a 6563   def load_projec
+00026960: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00026970: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
+00026980: 7472 2c0a 2020 2020 2020 2020 7572 6c3a  tr,.        url:
+00026990: 2073 7472 2c0a 2020 2020 2020 2020 7365   str,.        se
+000269a0: 6372 6574 733a 204f 7074 696f 6e61 6c5b  crets: Optional[
+000269b0: 6469 6374 5d20 3d20 4e6f 6e65 2c0a 2020  dict] = None,.  
+000269c0: 2020 2020 2020 7361 7665 5f73 6563 7265        save_secre
+000269d0: 7473 3a20 626f 6f6c 203d 2054 7275 652c  ts: bool = True,
+000269e0: 0a20 2020 2029 202d 3e20 7374 723a 0a20  .    ) -> str:. 
+000269f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00026a00: 2020 204c 6f61 6469 6e67 2061 2070 726f     Loading a pro
+00026a10: 6a65 6374 2072 656d 6f74 656c 7920 6672  ject remotely fr
+00026a20: 6f6d 2074 6865 2067 6976 656e 2073 6f75  om the given sou
+00026a30: 7263 652e 0a20 2020 2020 2020 203a 7061  rce..        :pa
+00026a40: 7261 6d20 6e61 6d65 3a20 2020 2070 726f  ram name:    pro
+00026a50: 6a65 6374 206e 616d 650a 2020 2020 2020  ject name.      
+00026a60: 2020 3a70 6172 616d 2075 726c 3a20 2020    :param url:   
+00026a70: 2020 6769 7420 6f72 2074 6172 2e67 7a20    git or tar.gz 
+00026a80: 6f72 202e 7a69 7020 736f 7572 6365 7320  or .zip sources 
+00026a90: 6172 6368 6976 6520 7061 7468 2065 2e67  archive path e.g
+00026aa0: 2e3a 0a20 2020 2020 2020 2067 6974 3a2f  .:.        git:/
+00026ab0: 2f67 6974 6875 622e 636f 6d2f 6d6c 7275  /github.com/mlru
+00026ac0: 6e2f 6465 6d6f 2d78 6762 2d70 726f 6a65  n/demo-xgb-proje
+00026ad0: 6374 2e67 6974 0a20 2020 2020 2020 2068  ct.git.        h
+00026ae0: 7474 703a 2f2f 6d79 7369 7465 2f61 7263  ttp://mysite/arc
+00026af0: 6869 7665 642d 7072 6f6a 6563 742e 7a69  hived-project.zi
+00026b00: 700a 2020 2020 2020 2020 5468 6520 6769  p.        The gi
+00026b10: 7420 7072 6f6a 6563 7420 7368 6f75 6c64  t project should
+00026b20: 2069 6e63 6c75 6465 2074 6865 2070 726f   include the pro
+00026b30: 6a65 6374 2079 616d 6c20 6669 6c65 2e0a  ject yaml file..
+00026b40: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00026b50: 6563 7265 7473 3a20 2020 2020 2020 2020  ecrets:         
+00026b60: 5365 6372 6574 7320 746f 2073 746f 7265  Secrets to store
+00026b70: 2069 6e20 7072 6f6a 6563 7420 696e 206f   in project in o
+00026b80: 7264 6572 2074 6f20 6c6f 6164 2069 7420  rder to load it 
+00026b90: 6672 6f6d 2074 6865 2070 726f 7669 6465  from the provide
+00026ba0: 6420 7572 6c2e 2046 6f72 206d 6f72 650a  d url. For more.
+00026bb0: 2020 2020 2020 2020 696e 666f 726d 6174          informat
+00026bc0: 696f 6e20 7365 6520 3a70 793a 6675 6e63  ion see :py:func
+00026bd0: 3a60 6d6c 7275 6e2e 6c6f 6164 5f70 726f  :`mlrun.load_pro
+00026be0: 6a65 6374 6020 6675 6e63 7469 6f6e 2e0a  ject` function..
+00026bf0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+00026c00: 6176 655f 7365 6372 6574 733a 2020 2020  ave_secrets:    
+00026c10: 5768 6574 6865 7220 746f 2073 746f 7265  Whether to store
+00026c20: 2073 6563 7265 7473 2069 6e20 7468 6520   secrets in the 
+00026c30: 6c6f 6164 6564 2070 726f 6a65 6374 2e20  loaded project. 
+00026c40: 5365 7474 696e 6720 746f 2046 616c 7365  Setting to False
+00026c50: 2077 696c 6c20 6361 7573 6520 7761 6974   will cause wait
+00026c60: 696e 670a 2020 2020 2020 2020 666f 7220  ing.        for 
+00026c70: 7468 6520 7072 6f63 6573 7320 636f 6d70  the process comp
+00026c80: 6c65 7469 6f6e 2e0a 0a20 2020 2020 2020  letion...       
+00026c90: 203a 7265 7475 726e 733a 2020 2020 2020   :returns:      
+00026ca0: 2020 2020 2020 2020 2054 6865 2074 6572           The ter
+00026cb0: 6d69 6e61 6c20 7374 6174 6520 6f66 206c  minal state of l
+00026cc0: 6f61 6420 7072 6f6a 6563 7420 7072 6f63  oad project proc
+00026cd0: 6573 732e 0a20 2020 2020 2020 2022 2222  ess..        """
+00026ce0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00026cf0: 3d20 7b22 7572 6c22 3a20 7572 6c7d 0a20  = {"url": url}. 
+00026d00: 2020 2020 2020 2062 6f64 7920 3d20 4e6f         body = No
+00026d10: 6e65 0a20 2020 2020 2020 2069 6620 7365  ne.        if se
+00026d20: 6372 6574 733a 0a20 2020 2020 2020 2020  crets:.         
+00026d30: 2020 2070 726f 7669 6465 7220 3d20 6d6c     provider = ml
+00026d40: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00026d50: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+00026d60: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
+00026d70: 0a20 2020 2020 2020 2020 2020 2073 6563  .            sec
+00026d80: 7265 7473 5f69 6e70 7574 203d 206d 6c72  rets_input = mlr
+00026d90: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00026da0: 732e 5365 6372 6574 7344 6174 6128 0a20  s.SecretsData(. 
+00026db0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00026dc0: 726f 7669 6465 723d 7072 6f76 6964 6572  rovider=provider
+00026dd0: 2c20 7365 6372 6574 733d 7365 6372 6574  , secrets=secret
+00026de0: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
+00026df0: 2020 2020 2020 2020 2020 2020 626f 6479              body
+00026e00: 203d 2073 6563 7265 7473 5f69 6e70 7574   = secrets_input
+00026e10: 2e64 6963 7428 290a 2020 2020 2020 2020  .dict().        
+00026e20: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+00026e30: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
+00026e40: 2020 2020 2020 2250 4f53 5422 2c20 6622        "POST", f"
+00026e50: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d2f  projects/{name}/
+00026e60: 6c6f 6164 222c 2070 6172 616d 733d 7061  load", params=pa
+00026e70: 7261 6d73 2c20 626f 6479 3d64 6963 745f  rams, body=dict_
+00026e80: 746f 5f6a 736f 6e28 626f 6479 290a 2020  to_json(body).  
+00026e90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00026ea0: 7265 7370 6f6e 7365 203d 2072 6573 706f  response = respo
+00026eb0: 6e73 652e 6a73 6f6e 2829 0a20 2020 2020  nse.json().     
+00026ec0: 2020 2072 756e 203d 206d 6c72 756e 2e52     run = mlrun.R
+00026ed0: 756e 4f62 6a65 6374 2e66 726f 6d5f 6469  unObject.from_di
+00026ee0: 6374 2872 6573 706f 6e73 655b 2264 6174  ct(response["dat
+00026ef0: 6122 5d29 0a20 2020 2020 2020 2073 7461  a"]).        sta
+00026f00: 7465 2c20 5f20 3d20 7275 6e2e 6c6f 6773  te, _ = run.logs
+00026f10: 2829 0a0a 2020 2020 2020 2020 6966 2073  ()..        if s
+00026f20: 6563 7265 7473 2061 6e64 206e 6f74 2073  ecrets and not s
+00026f30: 6176 655f 7365 6372 6574 733a 0a20 2020  ave_secrets:.   
+00026f40: 2020 2020 2020 2020 2073 656c 662e 6465           self.de
+00026f50: 6c65 7465 5f70 726f 6a65 6374 5f73 6563  lete_project_sec
+00026f60: 7265 7473 2870 726f 6a65 6374 3d6e 616d  rets(project=nam
+00026f70: 652c 2073 6563 7265 7473 3d6c 6973 7428  e, secrets=list(
+00026f80: 7365 6372 6574 732e 6b65 7973 2829 2929  secrets.keys()))
+00026f90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00026fa0: 7374 6174 6520 213d 2022 636f 6d70 6c65  state != "comple
+00026fb0: 7465 6422 3a0a 2020 2020 2020 2020 2020  ted":.          
+00026fc0: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
+00026fd0: 6f72 2822 4c6f 6164 2070 726f 6a65 6374  or("Load project
+00026fe0: 2074 6173 6b20 6661 696c 6564 2c20 6465   task failed, de
+00026ff0: 6c65 7469 6e67 2070 726f 6a65 6374 2229  leting project")
+00027000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027010: 2073 656c 662e 6465 6c65 7465 5f70 726f   self.delete_pro
+00027020: 6a65 6374 286e 616d 652c 206d 6c72 756e  ject(name, mlrun
+00027030: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00027040: 4465 6c65 7469 6f6e 5374 7261 7465 6779  DeletionStrategy
+00027050: 2e63 6173 6361 6465 290a 0a20 2020 2020  .cascade)..     
+00027060: 2020 2072 6574 7572 6e20 7374 6174 650a     return state.
+00027070: 0a20 2020 2064 6566 2067 6574 5f64 6174  .    def get_dat
+00027080: 6173 746f 7265 5f70 726f 6669 6c65 280a  astore_profile(.
+00027090: 2020 2020 2020 2020 7365 6c66 2c20 6e61          self, na
+000270a0: 6d65 3a20 7374 722c 2070 726f 6a65 6374  me: str, project
+000270b0: 3a20 7374 720a 2020 2020 2920 2d3e 204f  : str.    ) -> O
+000270c0: 7074 696f 6e61 6c5b 6d6c 7275 6e2e 636f  ptional[mlrun.co
+000270d0: 6d6d 6f6e 2e73 6368 656d 6173 2e44 6174  mmon.schemas.Dat
+000270e0: 6173 746f 7265 5072 6f66 696c 655d 3a0a  astoreProfile]:.
+000270f0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00027100: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00027110: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00027120: 6563 740a 2020 2020 2020 2020 5f70 6174  ect.        _pat
+00027130: 6820 3d20 7365 6c66 2e5f 7061 7468 5f6f  h = self._path_o
+00027140: 6628 2264 6174 6173 746f 7265 2d70 726f  f("datastore-pro
+00027150: 6669 6c65 7322 2c20 7072 6f6a 6563 742c  files", project,
+00027160: 206e 616d 6529 0a0a 2020 2020 2020 2020   name)..        
+00027170: 7265 7320 3d20 7365 6c66 2e61 7069 5f63  res = self.api_c
+00027180: 616c 6c28 6d65 7468 6f64 3d22 4745 5422  all(method="GET"
+00027190: 2c20 7061 7468 3d5f 7061 7468 290a 2020  , path=_path).  
+000271a0: 2020 2020 2020 6966 2072 6573 3a0a 2020        if res:.  
+000271b0: 2020 2020 2020 2020 2020 7075 626c 6963            public
+000271c0: 5f77 7261 7070 6572 203d 2072 6573 2e6a  _wrapper = res.j
+000271d0: 736f 6e28 290a 2020 2020 2020 2020 2020  son().          
+000271e0: 2020 6461 7461 7374 6f72 6520 3d20 4461    datastore = Da
+000271f0: 7461 7374 6f72 6550 726f 6669 6c65 324a  tastoreProfile2J
+00027200: 736f 6e2e 6372 6561 7465 5f66 726f 6d5f  son.create_from_
+00027210: 6a73 6f6e 280a 2020 2020 2020 2020 2020  json(.          
+00027220: 2020 2020 2020 7075 626c 6963 5f6a 736f        public_jso
+00027230: 6e3d 7075 626c 6963 5f77 7261 7070 6572  n=public_wrapper
+00027240: 5b22 6f62 6a65 6374 225d 0a20 2020 2020  ["object"].     
+00027250: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027260: 2020 2020 2072 6574 7572 6e20 6461 7461       return data
+00027270: 7374 6f72 650a 2020 2020 2020 2020 7265  store.        re
+00027280: 7475 726e 204e 6f6e 650a 0a20 2020 2064  turn None..    d
+00027290: 6566 2064 656c 6574 655f 6461 7461 7374  ef delete_datast
+000272a0: 6f72 655f 7072 6f66 696c 6528 7365 6c66  ore_profile(self
+000272b0: 2c20 6e61 6d65 3a20 7374 722c 2070 726f  , name: str, pro
+000272c0: 6a65 6374 3a20 7374 7229 3a0a 2020 2020  ject: str):.    
+000272d0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+000272e0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+000272f0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00027300: 2020 2020 2020 2020 5f70 6174 6820 3d20          _path = 
+00027310: 7365 6c66 2e5f 7061 7468 5f6f 6628 2264  self._path_of("d
+00027320: 6174 6173 746f 7265 2d70 726f 6669 6c65  atastore-profile
+00027330: 7322 2c20 7072 6f6a 6563 742c 206e 616d  s", project, nam
+00027340: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00027350: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
+00027360: 2244 454c 4554 4522 2c20 7061 7468 3d5f  "DELETE", path=_
+00027370: 7061 7468 290a 2020 2020 2020 2020 7265  path).        re
+00027380: 7475 726e 204e 6f6e 650a 0a20 2020 2064  turn None..    d
+00027390: 6566 206c 6973 745f 6461 7461 7374 6f72  ef list_datastor
+000273a0: 655f 7072 6f66 696c 6573 280a 2020 2020  e_profiles(.    
+000273b0: 2020 2020 7365 6c66 2c20 7072 6f6a 6563      self, projec
+000273c0: 743a 2073 7472 0a20 2020 2029 202d 3e20  t: str.    ) -> 
+000273d0: 6c69 7374 5b6d 6c72 756e 2e63 6f6d 6d6f  list[mlrun.commo
+000273e0: 6e2e 7363 6865 6d61 732e 4461 7461 7374  n.schemas.Datast
+000273f0: 6f72 6550 726f 6669 6c65 5d3a 0a20 2020  oreProfile]:.   
+00027400: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00027410: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00027420: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00027430: 0a20 2020 2020 2020 205f 7061 7468 203d  .        _path =
+00027440: 2073 656c 662e 5f70 6174 685f 6f66 2822   self._path_of("
+00027450: 6461 7461 7374 6f72 652d 7072 6f66 696c  datastore-profil
+00027460: 6573 222c 2070 726f 6a65 6374 290a 0a20  es", project).. 
+00027470: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
+00027480: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
+00027490: 643d 2247 4554 222c 2070 6174 683d 5f70  d="GET", path=_p
+000274a0: 6174 6829 0a20 2020 2020 2020 2069 6620  ath).        if 
+000274b0: 7265 733a 0a20 2020 2020 2020 2020 2020  res:.           
+000274c0: 2070 7562 6c69 635f 7772 6170 7065 7220   public_wrapper 
+000274d0: 3d20 7265 732e 6a73 6f6e 2829 0a20 2020  = res.json().   
+000274e0: 2020 2020 2020 2020 2064 6174 6173 746f           datasto
+000274f0: 7265 7320 3d20 5b0a 2020 2020 2020 2020  res = [.        
+00027500: 2020 2020 2020 2020 4461 7461 7374 6f72          Datastor
+00027510: 6550 726f 6669 6c65 324a 736f 6e2e 6372  eProfile2Json.cr
+00027520: 6561 7465 5f66 726f 6d5f 6a73 6f6e 2878  eate_from_json(x
+00027530: 5b22 6f62 6a65 6374 225d 290a 2020 2020  ["object"]).    
+00027540: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00027550: 7820 696e 2070 7562 6c69 635f 7772 6170  x in public_wrap
+00027560: 7065 720a 2020 2020 2020 2020 2020 2020  per.            
+00027570: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
+00027580: 7475 726e 2064 6174 6173 746f 7265 730a  turn datastores.
+00027590: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+000275a0: 6f6e 650a 0a20 2020 2064 6566 2073 746f  one..    def sto
+000275b0: 7265 5f64 6174 6173 746f 7265 5f70 726f  re_datastore_pro
+000275c0: 6669 6c65 280a 2020 2020 2020 2020 7365  file(.        se
+000275d0: 6c66 2c20 7072 6f66 696c 653a 206d 6c72  lf, profile: mlr
+000275e0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000275f0: 732e 4461 7461 7374 6f72 6550 726f 6669  s.DatastoreProfi
+00027600: 6c65 2c20 7072 6f6a 6563 743a 2073 7472  le, project: str
+00027610: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00027620: 2222 220a 2020 2020 2020 2020 4372 6561  """.        Crea
+00027630: 7465 206f 7220 7265 706c 6163 6520 6120  te or replace a 
+00027640: 6461 7461 7374 6f72 6520 7072 6f66 696c  datastore profil
+00027650: 652e 0a20 2020 2020 2020 203a 7265 7475  e..        :retu
+00027660: 726e 733a 204e 6f6e 650a 2020 2020 2020  rns: None.      
+00027670: 2020 2222 220a 2020 2020 2020 2020 7072    """.        pr
+00027680: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+00027690: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+000276a0: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+000276b0: 2020 5f70 6174 6820 3d20 7365 6c66 2e5f    _path = self._
+000276c0: 7061 7468 5f6f 6628 2264 6174 6173 746f  path_of("datasto
+000276d0: 7265 2d70 726f 6669 6c65 7322 2c20 7072  re-profiles", pr
+000276e0: 6f6a 6563 7429 0a0a 2020 2020 2020 2020  oject)..        
+000276f0: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
+00027700: 7468 6f64 3d22 5055 5422 2c20 7061 7468  thod="PUT", path
+00027710: 3d5f 7061 7468 2c20 6a73 6f6e 3d70 726f  =_path, json=pro
+00027720: 6669 6c65 2e64 6963 7428 2929 0a0a 2020  file.dict())..  
+00027730: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+00027740: 2020 2020 6465 6620 7761 726e 5f6f 6e5f      def warn_on_
+00027750: 7333 5f61 6e64 5f65 6372 5f70 6572 6d69  s3_and_ecr_permi
+00027760: 7373 696f 6e73 5f63 6f6e 666c 6963 7428  ssions_conflict(
+00027770: 6675 6e63 293a 0a20 2020 2020 2020 2069  func):.        i
+00027780: 735f 7333 5f73 6f75 7263 6520 3d20 6675  s_s3_source = fu
+00027790: 6e63 2e73 7065 632e 6275 696c 642e 736f  nc.spec.build.so
+000277a0: 7572 6365 2061 6e64 2066 756e 632e 7370  urce and func.sp
+000277b0: 6563 2e62 7569 6c64 2e73 6f75 7263 652e  ec.build.source.
+000277c0: 7374 6172 7473 7769 7468 280a 2020 2020  startswith(.    
+000277d0: 2020 2020 2020 2020 2273 333a 2f2f 220a          "s3://".
+000277e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000277f0: 2020 6973 5f65 6372 5f69 6d61 6765 203d    is_ecr_image =
+00027800: 206d 6c72 756e 2e75 7469 6c73 2e69 735f   mlrun.utils.is_
+00027810: 6563 725f 7572 6c28 636f 6e66 6967 2e68  ecr_url(config.h
+00027820: 7474 7064 622e 6275 696c 6465 722e 646f  ttpdb.builder.do
+00027830: 636b 6572 5f72 6567 6973 7472 7929 0a20  cker_registry). 
+00027840: 2020 2020 2020 2069 6620 6e6f 7420 6675         if not fu
+00027850: 6e63 2e73 7065 632e 6275 696c 642e 6c6f  nc.spec.build.lo
+00027860: 6164 5f73 6f75 7263 655f 6f6e 5f72 756e  ad_source_on_run
+00027870: 2061 6e64 2069 735f 7333 5f73 6f75 7263   and is_s3_sourc
+00027880: 6520 616e 6420 6973 5f65 6372 5f69 6d61  e and is_ecr_ima
+00027890: 6765 3a0a 2020 2020 2020 2020 2020 2020  ge:.            
+000278a0: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
+000278b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278c0: 2242 7569 6c64 696e 6720 6120 6675 6e63  "Building a func
+000278d0: 7469 6f6e 2069 6d61 6765 2074 6f20 4543  tion image to EC
+000278e0: 5220 616e 6420 6c6f 6164 696e 6720 616e  R and loading an
+000278f0: 2053 3320 736f 7572 6365 2074 6f20 7468   S3 source to th
+00027900: 6520 696d 6167 6520 6d61 7920 7265 7175  e image may requ
+00027910: 6972 6520 636f 6e66 6c69 6374 696e 6720  ire conflicting 
+00027920: 6163 6365 7373 2022 0a20 2020 2020 2020  access ".       
+00027930: 2020 2020 2020 2020 2022 6b65 7973 2e20           "keys. 
+00027940: 4f6e 6c79 2074 6865 2070 6572 6d69 7373  Only the permiss
+00027950: 696f 6e73 2067 7261 6e74 6564 2074 6f20  ions granted to 
+00027960: 7468 6520 706c 6174 666f 726d 2773 2063  the platform's c
+00027970: 6f6e 6669 6775 7265 6420 7365 6372 6574  onfigured secret
+00027980: 2077 696c 6c20 7461 6b65 2061 6666 6563   will take affec
+00027990: 7420 220a 2020 2020 2020 2020 2020 2020  t ".            
+000279a0: 2020 2020 2228 7365 6520 6d6c 7275 6e2e      "(see mlrun.
+000279b0: 636f 6e66 6967 2e63 6f6e 6669 672e 6874  config.config.ht
+000279c0: 7470 6462 2e62 7569 6c64 6572 2e64 6f63  tpdb.builder.doc
+000279d0: 6b65 725f 7265 6769 7374 7279 5f73 6563  ker_registry_sec
+000279e0: 7265 7429 2e20 220a 2020 2020 2020 2020  ret). ".        
+000279f0: 2020 2020 2020 2020 2249 6e20 6361 7365          "In case
+00027a00: 2074 6865 2070 6572 6d69 7373 696f 6e73   the permissions
+00027a10: 2061 7265 206c 696d 6974 6564 2074 6f20   are limited to 
+00027a20: 4543 5220 7363 6f70 652c 2079 6f75 206d  ECR scope, you m
+00027a30: 6179 2075 7365 2070 756c 6c5f 6174 5f72  ay use pull_at_r
+00027a40: 756e 7469 6d65 3d54 7275 6520 696e 7374  untime=True inst
+00027a50: 6561 6422 2c0a 2020 2020 2020 2020 2020  ead",.          
+00027a60: 2020 2020 2020 736f 7572 6365 3d66 756e        source=fun
+00027a70: 632e 7370 6563 2e62 7569 6c64 2e73 6f75  c.spec.build.sou
+00027a80: 7263 652c 0a20 2020 2020 2020 2020 2020  rce,.           
+00027a90: 2020 2020 206c 6f61 645f 736f 7572 6365       load_source
+00027aa0: 5f6f 6e5f 7275 6e3d 6675 6e63 2e73 7065  _on_run=func.spe
+00027ab0: 632e 6275 696c 642e 6c6f 6164 5f73 6f75  c.build.load_sou
+00027ac0: 7263 655f 6f6e 5f72 756e 2c0a 2020 2020  rce_on_run,.    
+00027ad0: 2020 2020 2020 2020 2020 2020 6465 6661              defa
+00027ae0: 756c 745f 646f 636b 6572 5f72 6567 6973  ult_docker_regis
+00027af0: 7472 793d 636f 6e66 6967 2e68 7474 7064  try=config.httpd
+00027b00: 622e 6275 696c 6465 722e 646f 636b 6572  b.builder.docker
+00027b10: 5f72 6567 6973 7472 792c 0a20 2020 2020  _registry,.     
+00027b20: 2020 2020 2020 2029 0a0a 0a64 6566 205f         )...def _
+00027b30: 6173 5f6a 736f 6e28 6f62 6a29 3a0a 2020  as_json(obj):.  
+00027b40: 2020 666e 203d 2067 6574 6174 7472 286f    fn = getattr(o
+00027b50: 626a 2c20 2274 6f5f 6a73 6f6e 222c 204e  bj, "to_json", N
+00027b60: 6f6e 6529 0a20 2020 2069 6620 666e 3a0a  one).    if fn:.
+00027b70: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00027b80: 6e28 290a 2020 2020 7265 7475 726e 2064  n().    return d
+00027b90: 6963 745f 746f 5f6a 736f 6e28 6f62 6a29  ict_to_json(obj)
+00027ba0: 0a                                       .
```

## mlrun/db/nopdb.py

```diff
@@ -524,14 +524,73 @@
 
     def verify_authorization(
         self,
         authorization_verification_input: mlrun.common.schemas.AuthorizationVerificationInput,
     ):
         pass
 
+    def remote_builder(
+        self,
+        func: "mlrun.runtimes.BaseRuntime",
+        with_mlrun: bool,
+        mlrun_version_specifier: Optional[str] = None,
+        skip_deployed: bool = False,
+        builder_env: Optional[dict] = None,
+        force_build: bool = False,
+    ):
+        pass
+
+    def deploy_nuclio_function(
+        self,
+        func: "mlrun.runtimes.RemoteRuntime",
+        builder_env: Optional[dict] = None,
+    ):
+        pass
+
+    def get_builder_status(
+        self,
+        func: "mlrun.runtimes.BaseRuntime",
+        offset: int = 0,
+        logs: bool = True,
+        last_log_timestamp: float = 0.0,
+        verbose: bool = False,
+    ):
+        pass
+
+    def get_nuclio_deploy_status(
+        self,
+        func: "mlrun.runtimes.RemoteRuntime",
+        last_log_timestamp: float = 0.0,
+        verbose: bool = False,
+    ):
+        pass
+
+    def set_run_notifications(
+        self,
+        project: str,
+        runs: list[mlrun.model.RunObject],
+        notifications: list[mlrun.model.Notification],
+    ):
+        pass
+
+    def store_run_notifications(
+        self,
+        notification_objects: list[mlrun.model.Notification],
+        run_uid: str,
+        project: str = None,
+        mask_params: bool = True,
+    ):
+        pass
+
+    def get_log_size(self, uid, project=""):
+        pass
+
+    def watch_log(self, uid, project="", watch=True, offset=0):
+        pass
+
     def get_datastore_profile(
         self, name: str, project: str
     ) -> Optional[mlrun.common.schemas.DatastoreProfile]:
         pass
 
     def delete_datastore_profile(self, name: str, project: str):
         pass
@@ -541,7 +600,55 @@
     ) -> list[mlrun.common.schemas.DatastoreProfile]:
         pass
 
     def store_datastore_profile(
         self, profile: mlrun.common.schemas.DatastoreProfile, project: str
     ):
         pass
+
+    def function_status(self, project, name, kind, selector):
+        pass
+
+    def start_function(
+        self, func_url: str = None, function: "mlrun.runtimes.BaseRuntime" = None
+    ):
+        pass
+
+    def submit_workflow(
+        self,
+        project: str,
+        name: str,
+        workflow_spec: Union[
+            "mlrun.projects.pipelines.WorkflowSpec",
+            "mlrun.common.schemas.WorkflowSpec",
+            dict,
+        ],
+        arguments: Optional[dict] = None,
+        artifact_path: Optional[str] = None,
+        source: Optional[str] = None,
+        run_name: Optional[str] = None,
+        namespace: Optional[str] = None,
+        notifications: list["mlrun.model.Notification"] = None,
+    ) -> "mlrun.common.schemas.WorkflowResponse":
+        pass
+
+    def update_model_monitoring_controller(
+        self,
+        project: str,
+        base_period: int = 10,
+        image: str = "mlrun/mlrun",
+    ):
+        pass
+
+    def enable_model_monitoring(
+        self,
+        project: str,
+        base_period: int = 10,
+        image: str = "mlrun/mlrun",
+        deploy_histogram_data_drift_app: bool = True,
+    ) -> None:
+        raise NotImplementedError
+
+    def deploy_histogram_data_drift_app(
+        self, project: str, image: str = "mlrun/mlrun"
+    ) -> None:
+        raise NotImplementedError
```

## mlrun/feature_store/api.py

```diff
@@ -1117,25 +1117,26 @@
                 key_columns, timestamp_key, overwrite
             )
 
             df_to_write = df
             df_to_write = target.prepare_spark_df(
                 df_to_write, key_columns, timestamp_key, spark_options
             )
+            write_format = spark_options.pop("format", None)
             if overwrite:
                 write_spark_dataframe_with_options(
-                    spark_options, df_to_write, "overwrite"
+                    spark_options, df_to_write, "overwrite", write_format=write_format
                 )
             else:
                 # appending an empty dataframe may cause an empty file to be created (e.g. when writing to parquet)
                 # we would like to avoid that
                 df_to_write.persist()
                 if df_to_write.count() > 0:
                     write_spark_dataframe_with_options(
-                        spark_options, df_to_write, "append"
+                        spark_options, df_to_write, "append", write_format=write_format
                     )
             target.update_resource_status("ready")
 
         if isinstance(source, BaseSourceDriver) and source.schedule:
             max_time = df.agg({timestamp_key: "max"}).collect()[0][0]
             if not max_time:
                 # if max_time is None(no data), next scheduled run should be with same start_time
```

## mlrun/feature_store/retrieval/spark_merger.py

```diff
@@ -20,14 +20,40 @@
 
 from ...runtimes import RemoteSparkRuntime
 from ...runtimes.sparkjob import Spark3Runtime
 from .base import BaseMerger
 from .conversion import PandasConversionMixin
 
 
+def spark_df_to_pandas(spark_df):
+    # as of pyspark 3.2.3, toPandas fails to convert timestamps unless we work around the issue
+    # when we upgrade pyspark, we should check whether this workaround is still necessary
+    # see https://stackoverflow.com/questions/76389694/transforming-pyspark-to-pandas-dataframe
+    if semver.parse(pd.__version__)["major"] >= 2:
+        import pyspark.sql.functions as pyspark_functions
+
+        type_conversion_dict = {}
+        for field in spark_df.schema.fields:
+            if str(field.dataType) == "TimestampType":
+                spark_df = spark_df.withColumn(
+                    field.name,
+                    pyspark_functions.date_format(
+                        pyspark_functions.to_timestamp(field.name),
+                        "yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS",
+                    ),
+                )
+                type_conversion_dict[field.name] = "datetime64[ns]"
+        df = PandasConversionMixin.toPandas(spark_df)
+        if type_conversion_dict:
+            df = df.astype(type_conversion_dict)
+        return df
+    else:
+        return PandasConversionMixin.toPandas(spark_df)
+
+
 class SparkFeatureMerger(BaseMerger):
     engine = "spark"
     support_offline = True
 
     def __init__(self, vector, **engine_args):
         super().__init__(vector, **engine_args)
         self.spark = engine_args.get("spark", None)
@@ -162,37 +188,15 @@
             how=self._join_type,
         )
         return merged_df
 
     def get_df(self, to_pandas=True):
         if to_pandas:
             if self._pandas_df is None:
-                df = self._result_df
-                # as of pyspark 3.2.3, toPandas fails to convert timestamps unless we work around the issue
-                # when we upgrade pyspark, we should check whether this workaround is still necessary
-                # see https://stackoverflow.com/questions/76389694/transforming-pyspark-to-pandas-dataframe
-                if semver.parse(pd.__version__)["major"] >= 2:
-                    import pyspark.sql.functions as pyspark_functions
-
-                    type_conversion_dict = {}
-                    for field in df.schema.fields:
-                        if str(field.dataType) == "TimestampType":
-                            df = df.withColumn(
-                                field.name,
-                                pyspark_functions.date_format(
-                                    pyspark_functions.to_timestamp(field.name),
-                                    "yyyy-MM-dd'T'HH:mm:ss.SSSSSSSSS",
-                                ),
-                            )
-                            type_conversion_dict[field.name] = "datetime64[ns]"
-                    df = PandasConversionMixin.toPandas(df)
-                    if type_conversion_dict:
-                        df = df.astype(type_conversion_dict)
-                else:
-                    df = PandasConversionMixin.toPandas(df)
+                df = spark_df_to_pandas(self._result_df)
                 self._pandas_df = df
                 self._set_indexes(self._pandas_df)
             return self._pandas_df
 
         return self._result_df
 
     @classmethod
```

## mlrun/frameworks/tf_keras/mlrun_interface.py

```diff
@@ -13,37 +13,25 @@
 # limitations under the License.
 #
 import importlib
 import os
 from abc import ABC
 from typing import Union
 
-import semver
 import tensorflow as tf
 from tensorflow import keras
 from tensorflow.keras.optimizers import Optimizer
-
-if semver.VersionInfo.parse(tf.__version__) < semver.VersionInfo(2, 6):
-    from tensorflow.keras.callbacks import (
-        BaseLogger,
-        Callback,
-        CSVLogger,
-        ModelCheckpoint,
-        ProgbarLogger,
-        TensorBoard,
-    )
-else:
-    from keras.callbacks import (
-        BaseLogger,
-        Callback,
-        CSVLogger,
-        ModelCheckpoint,
-        ProgbarLogger,
-        TensorBoard,
-    )
+from tensorflow.python.keras.callbacks import (
+    BaseLogger,
+    Callback,
+    CSVLogger,
+    ModelCheckpoint,
+    ProgbarLogger,
+    TensorBoard,
+)
 
 import mlrun
 
 from .._common import MLRunInterface
 from .callbacks import LoggingCallback
 from .utils import TFKerasTypes
```

## mlrun/frameworks/tf_keras/callbacks/logging_callback.py

```diff
@@ -11,22 +11,17 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 from typing import Callable, Union
 
 import numpy as np
-import semver
 import tensorflow as tf
 from tensorflow import Tensor, Variable
-
-if semver.VersionInfo.parse(tf.__version__) < semver.VersionInfo(2, 6):
-    from tensorflow.keras.callbacks import Callback
-else:
-    from keras.callbacks import Callback
+from tensorflow.python.keras.callbacks import Callback
 
 import mlrun
 
 from ..._common import LoggingMode
 from ..._dl_common.loggers import Logger
 from ..utils import TFKerasTypes
```

## mlrun/launcher/base.py

```diff
@@ -349,15 +349,15 @@
         state_thresholds = (
             state_thresholds
             or run.spec.state_thresholds
             or getattr(runtime.spec, "state_thresholds", {})
             or {}
         )
         state_thresholds = (
-            mlrun.config.config.function.spec.state_thresholds.default.to_dict()
+            mlrun.mlconf.function.spec.state_thresholds.default.to_dict()
             | state_thresholds
         )
         run.spec.state_thresholds = state_thresholds or run.spec.state_thresholds
         return run
 
     @staticmethod
     def _run_has_valid_notifications(runobj) -> bool:
```

## mlrun/launcher/client.py

```diff
@@ -43,15 +43,15 @@
     @staticmethod
     def prepare_image_for_deploy(runtime: "mlrun.runtimes.BaseRuntime"):
         """
         Check if the runtime requires to build the image.
         If build is needed, set the image as the base_image for the build.
         If image is not given set the default one.
         """
-        if runtime.kind in mlrun.runtimes.RuntimeKinds.nuclio_runtimes():
+        if runtime.kind in mlrun.runtimes.RuntimeKinds.pure_nuclio_deployed_runtimes():
             return
 
         require_build = runtime.requires_build()
         image = runtime.spec.image
         # we allow users to not set an image, in that case we'll use the default
         if (
             not image
@@ -125,15 +125,15 @@
         results_tbl = mlrun.lists.RunList()
         if result:
             results_tbl.append(result)
         else:
             logger.info("no returned result (job may still be in progress)")
             results_tbl.append(run.to_dict())
 
-        if mlrun.utils.is_ipython and mlrun.config.config.ipython_widget:
+        if mlrun.utils.is_ipython and mlrun.mlconf.ipython_widget:
             results_tbl.show()
             print()
             ui_url = mlrun.utils.get_ui_url(project, uid)
             if ui_url:
                 ui_url = f' or <a href="{ui_url}" target="_blank">click here</a> to open in UI'
             IPython.display.display(
                 IPython.display.HTML(
```

## mlrun/projects/project.py

```diff
@@ -28,15 +28,15 @@
 from os import environ, makedirs, path
 from typing import Callable, Optional, Union
 
 import dotenv
 import git
 import git.exc
 import kfp
-import nuclio
+import nuclio.utils
 import requests
 import yaml
 
 import mlrun.common.helpers
 import mlrun.common.schemas.model_monitoring.constants as mm_constants
 import mlrun.db
 import mlrun.errors
@@ -2176,24 +2176,21 @@
         tag: str = None,
         requirements: typing.Union[str, list[str]] = None,
         requirements_file: str = "",
     ) -> tuple[str, str, mlrun.runtimes.BaseRuntime, dict]:
         if func is None and not _has_module(handler, kind):
             # if function path is not provided and it is not a module (no ".")
             # use the current notebook as default
-            if not is_ipython:
-                raise ValueError(
-                    "Function path or module must be specified (when not running inside a Notebook)"
-                )
-            from IPython import get_ipython
+            if is_ipython:
+                from IPython import get_ipython
 
-            kernel = get_ipython()
-            func = nuclio.utils.notebook_file_name(kernel)
-            if func.startswith(path.abspath(self.spec.context)):
-                func = path.relpath(func, self.spec.context)
+                kernel = get_ipython()
+                func = nuclio.utils.notebook_file_name(kernel)
+                if func.startswith(path.abspath(self.spec.context)):
+                    func = path.relpath(func, self.spec.context)
 
         func = func or ""
 
         name = mlrun.utils.normalize_name(name) if name else name
         untagged_name = name
         # validate tag in name if specified
         if len(split_name := name.split(":")) == 2:
@@ -3691,26 +3688,33 @@
         :param packager: The packager module path to remove.
 
         :raise MLRunInvalidArgumentError: In case the packager was not in the list.
         """
         self.spec.remove_custom_packager(packager=packager)
 
     def store_api_gateway(
-        self, api_gateway: mlrun.runtimes.nuclio.api_gateway.APIGateway
+        self,
+        api_gateway: mlrun.runtimes.nuclio.api_gateway.APIGateway,
+        wait_for_readiness=True,
+        max_wait_time=90,
     ) -> mlrun.runtimes.nuclio.api_gateway.APIGateway:
         """
         Creates or updates a Nuclio API Gateway using the provided APIGateway object.
 
         This method interacts with the MLRun service to create/update a Nuclio API Gateway based on the provided
         APIGateway object. Once done, it returns the updated APIGateway object containing all fields propagated
         on MLRun and Nuclio sides, such as the 'host' attribute.
         Nuclio docs here: https://docs.nuclio.io/en/latest/reference/api-gateway/http.html
 
         :param api_gateway: An instance of :py:class:`~mlrun.runtimes.nuclio.APIGateway` representing the configuration
-        of the API Gateway to be created
+        of the API Gateway to be created or updated.
+        :param wait_for_readiness: (Optional) A boolean indicating whether to wait for the API Gateway to become ready
+            after creation or update (default is True)
+        :param max_wait_time: (Optional) Maximum time to wait for API Gateway readiness in seconds (default is 90s)
+
 
         @return: An instance of :py:class:`~mlrun.runtimes.nuclio.APIGateway` with all fields populated based on the
         information retrieved from the Nuclio API
         """
 
         api_gateway_json = mlrun.db.get_run_db().store_api_gateway(
             api_gateway=api_gateway,
@@ -3718,14 +3722,17 @@
         )
 
         if api_gateway_json:
             # fill in all the fields in the user's api_gateway object
             api_gateway = mlrun.runtimes.nuclio.api_gateway.APIGateway.from_scheme(
                 api_gateway_json
             )
+            if wait_for_readiness:
+                api_gateway.wait_for_readiness(max_wait_time=max_wait_time)
+
         return api_gateway
 
     def list_api_gateways(self) -> list[mlrun.runtimes.nuclio.api_gateway.APIGateway]:
         """
         Retrieves a list of Nuclio API gateways associated with the project.
 
         @return: List of :py:class:`~mlrun.runtimes.nuclio.api_gateway.APIGateway` objects representing
@@ -3746,15 +3753,16 @@
 
         :param name: The name of the API gateway to retrieve.
 
         Returns:
             mlrun.runtimes.nuclio.APIGateway: An instance of APIGateway.
         """
 
-        return mlrun.db.get_run_db().get_api_gateway(name=name, project=self.name)
+        gateway = mlrun.db.get_run_db().get_api_gateway(name=name, project=self.name)
+        return mlrun.runtimes.nuclio.api_gateway.APIGateway.from_scheme(gateway)
 
     def delete_api_gateway(
         self,
         name: str,
     ):
         """
         Deletes an API gateway by name.
@@ -3936,18 +3944,14 @@
     handler = f.get("handler", None)
     with_repo = f.get("with_repo", False)
     requirements = f.get("requirements", None)
     requirements_file = f.get("requirements_file", None)
     tag = f.get("tag", None)
 
     has_module = _has_module(handler, kind)
-    if not url and "spec" not in f and not has_module:
-        # function must point to a file or a module or have a spec
-        raise ValueError("Function missing a url or a spec or a module")
-
     relative_url = url
     url, in_context = project.get_item_absolute_path(url)
 
     if "spec" in f:
         if "spec" in f["spec"]:
             # Functions are stored in the project yaml as a dict with a spec key where the spec is the function
             func = new_function(name, runtime=f["spec"])
@@ -3999,24 +4003,24 @@
                 filename=url,
                 image=image,
                 kind=kind or "job",
                 handler=handler,
                 tag=tag,
             )
 
-    elif image and kind in mlrun.runtimes.RuntimeKinds.nuclio_runtimes():
+    elif kind in mlrun.runtimes.RuntimeKinds.nuclio_runtimes():
         func = new_function(
             name,
             command=relative_url,
             image=image,
             kind=kind,
             handler=handler,
             tag=tag,
         )
-        if kind != mlrun.runtimes.RuntimeKinds.application:
+        if image and kind != mlrun.runtimes.RuntimeKinds.application:
             logger.info("Function code not specified, setting entry point to image")
             func.from_image(image)
     else:
         raise ValueError(f"Unsupported function url:handler {url}:{handler} or no spec")
 
     if with_repo:
         # mark source to be enriched before run with project source (enrich_function_object)
```

## mlrun/runtimes/__init__.py

```diff
@@ -151,14 +151,30 @@
             RuntimeKinds.remote,
             RuntimeKinds.nuclio,
             RuntimeKinds.serving,
             RuntimeKinds.application,
         ]
 
     @staticmethod
+    def pure_nuclio_deployed_runtimes():
+        return [
+            RuntimeKinds.remote,
+            RuntimeKinds.nuclio,
+            RuntimeKinds.serving,
+        ]
+
+    @staticmethod
+    def handlerless_runtimes():
+        return [
+            RuntimeKinds.serving,
+            # Application runtime handler is internal reverse proxy
+            RuntimeKinds.application,
+        ]
+
+    @staticmethod
     def local_runtimes():
         return [
             RuntimeKinds.local,
             RuntimeKinds.handler,
         ]
 
     @staticmethod
```

## mlrun/runtimes/base.py

```diff
@@ -19,14 +19,15 @@
 from base64 import b64encode
 from os import environ
 from typing import Callable, Optional, Union
 
 import requests.exceptions
 from nuclio.build import mlrun_footer
 
+import mlrun.common.constants
 import mlrun.common.schemas
 import mlrun.common.schemas.model_monitoring.constants as mm_constants
 import mlrun.db
 import mlrun.errors
 import mlrun.launcher.factory
 import mlrun.utils.helpers
 import mlrun.utils.notifications
@@ -630,15 +631,17 @@
 
     def full_image_path(
         self, image=None, client_version: str = None, client_python_version: str = None
     ):
         image = image or self.spec.image or ""
 
         image = enrich_image_url(image, client_version, client_python_version)
-        if not image.startswith("."):
+        if not image.startswith(
+            mlrun.common.constants.IMAGE_NAME_ENRICH_REGISTRY_PREFIX
+        ):
             return image
         registry, repository = get_parsed_docker_registry()
         if registry:
             if repository and repository not in image:
                 return f"{registry}/{repository}/{image[1:]}"
             return f"{registry}/{image[1:]}"
         namespace_domain = environ.get("IGZ_NAMESPACE_DOMAIN", None)
```

## mlrun/runtimes/kubejob.py

```diff
@@ -8,24 +8,22 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import time
 import warnings
 
 import mlrun.common.schemas
 import mlrun.db
 import mlrun.errors
 
 from ..kfpops import build_op
 from ..model import RunObject
-from ..utils import get_in, logger
 from .pod import KubeResource
 
 
 class KubejobRuntime(KubeResource):
     kind = "job"
     _is_nested = True
 
@@ -61,37 +59,21 @@
                                 note path source must exist on the image or exist locally when run is local
                                 (it is recommended to use 'workdir' when source is a filepath instead)
         :param handler:         default function handler
         :param workdir:         working dir relative to the archive root (e.g. './subdir') or absolute to the image root
         :param pull_at_runtime: load the archive into the container at job runtime vs on build/deploy
         :param target_dir:      target dir on runtime pod or repo clone / archive extraction
         """
-        mlrun.utils.helpers.validate_builder_source(source, pull_at_runtime, workdir)
-
-        self.spec.build.source = source
-        if handler:
-            self.spec.default_handler = handler
-        if workdir:
-            self.spec.workdir = workdir
-        if target_dir:
-            self.spec.build.source_code_target_dir = target_dir
-
-        self.spec.build.load_source_on_run = pull_at_runtime
-        if (
-            self.spec.build.base_image
-            and not self.spec.build.commands
-            and pull_at_runtime
-            and not self.spec.image
-        ):
-            # if we load source from repo and don't need a full build use the base_image as the image
-            self.spec.image = self.spec.build.base_image
-        elif not pull_at_runtime:
-            # clear the image so build will not be skipped
-            self.spec.build.base_image = self.spec.build.base_image or self.spec.image
-            self.spec.image = ""
+        self._configure_mlrun_build_with_source(
+            source=source,
+            workdir=workdir,
+            handler=handler,
+            pull_at_runtime=pull_at_runtime,
+            target_dir=target_dir,
+        )
 
     def build_config(
         self,
         image="",
         base_image=None,
         commands: list = None,
         secret=None,
@@ -165,124 +147,47 @@
         skip_deployed=False,
         is_kfp=False,
         mlrun_version_specifier=None,
         builder_env: dict = None,
         show_on_failure: bool = False,
         force_build: bool = False,
     ) -> bool:
-        """deploy function, build container with dependencies
+        """Deploy function, build container with dependencies
 
-        :param watch:                   wait for the deploy to complete (and print build logs)
-        :param with_mlrun:              add the current mlrun package to the container build
-        :param skip_deployed:           skip the build if we already have an image for the function
-        :param is_kfp:                  deploy as part of a kfp pipeline
-        :param mlrun_version_specifier: which mlrun package version to include (if not current)
+        :param watch:                   Wait for the deploy to complete (and print build logs)
+        :param with_mlrun:              Add the current mlrun package to the container build
+        :param skip_deployed:           Skip the build if we already have an image for the function
+        :param is_kfp:                  Deploy as part of a kfp pipeline
+        :param mlrun_version_specifier: Which mlrun package version to include (if not current)
         :param builder_env:             Kaniko builder pod env vars dict (for config/credentials)
                                         e.g. builder_env={"GIT_TOKEN": token}
-        :param show_on_failure:         show logs only in case of build failure
-        :param force_build:             set True for force building the image, even when no changes were made
+        :param show_on_failure:         Show logs only in case of build failure
+        :param force_build:             Set True for force building the image, even when no changes were made
 
         :return: True if the function is ready (deployed)
         """
 
         build = self.spec.build
+        with_mlrun = self._resolve_build_with_mlrun(with_mlrun)
 
-        if with_mlrun is None:
-            if build.with_mlrun is not None:
-                with_mlrun = build.with_mlrun
-            else:
-                with_mlrun = build.base_image and not (
-                    build.base_image.startswith("mlrun/")
-                    or "/mlrun/" in build.base_image
-                )
-
-        if (
-            not build.source
-            and not build.commands
-            and not build.requirements
-            and not build.extra
-            and with_mlrun
-        ):
-            logger.info(
-                "Running build to add mlrun package, set "
-                "with_mlrun=False to skip if its already in the image"
-            )
         self.status.state = ""
         if build.base_image:
             # clear the image so build will not be skipped
             self.spec.image = ""
 
-        # When we're in pipelines context we must watch otherwise the pipelines pod will exit before the operation
-        # is actually done. (when a pipelines pod exits, the pipeline step marked as done)
-        if is_kfp:
-            watch = True
-
-        ready = False
-        if self._is_remote_api():
-            db = self._get_db()
-            data = db.remote_builder(
-                self,
-                with_mlrun,
-                mlrun_version_specifier,
-                skip_deployed,
-                builder_env=builder_env,
-                force_build=force_build,
-            )
-            self.status = data["data"].get("status", None)
-            self.spec.image = get_in(data, "data.spec.image")
-            self.spec.build.base_image = self.spec.build.base_image or get_in(
-                data, "data.spec.build.base_image"
-            )
-            # Get the source target dir in case it was enriched due to loading source
-            self.spec.build.source_code_target_dir = get_in(
-                data, "data.spec.build.source_code_target_dir"
-            ) or get_in(data, "data.spec.clone_target_dir")
-            ready = data.get("ready", False)
-            if not ready:
-                logger.info(
-                    f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
-                )
-            if watch and not ready:
-                state = self._build_watch(watch, show_on_failure=show_on_failure)
-                ready = state == "ready"
-                self.status.state = state
-
-        if watch and not ready:
-            raise mlrun.errors.MLRunRuntimeError("Deploy failed")
-        return ready
-
-    def _build_watch(self, watch=True, logs=True, show_on_failure=False):
-        db = self._get_db()
-        offset = 0
-        try:
-            text, _ = db.get_builder_status(self, 0, logs=logs)
-        except mlrun.db.RunDBError:
-            raise ValueError("function or build process not found")
-
-        def print_log(text):
-            if text and (not show_on_failure or self.status.state == "error"):
-                print(text, end="")
-
-        print_log(text)
-        offset += len(text)
-        if watch:
-            while self.status.state in ["pending", "running"]:
-                time.sleep(2)
-                if show_on_failure:
-                    text = ""
-                    db.get_builder_status(self, 0, logs=False)
-                    if self.status.state == "error":
-                        # re-read the full log on failure
-                        text, _ = db.get_builder_status(self, offset, logs=logs)
-                else:
-                    text, _ = db.get_builder_status(self, offset, logs=logs)
-                print_log(text)
-                offset += len(text)
-
-        return self.status.state
+        return self._build_image(
+            builder_env=builder_env,
+            force_build=force_build,
+            mlrun_version_specifier=mlrun_version_specifier,
+            show_on_failure=show_on_failure,
+            skip_deployed=skip_deployed,
+            watch=watch,
+            is_kfp=is_kfp,
+            with_mlrun=with_mlrun,
+        )
 
     def deploy_step(
         self,
         image=None,
         base_image=None,
         commands: list = None,
         secret_name="",
```

## mlrun/runtimes/pod.py

```diff
@@ -11,14 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import copy
 import inspect
 import os
 import re
+import time
 import typing
 from enum import Enum
 
 import dotenv
 import kfp.dsl
 import kubernetes.client as k8s_client
 
@@ -1334,14 +1335,158 @@
                 self.spec.service_account = default_service_account
                 logger.info(
                     f"Setting default service account to function: {default_service_account}"
                 )
 
         self.spec.validate_service_account(allowed_service_accounts)
 
+    def _configure_mlrun_build_with_source(
+        self, source, workdir=None, handler=None, pull_at_runtime=True, target_dir=None
+    ):
+        mlrun.utils.helpers.validate_builder_source(source, pull_at_runtime, workdir)
+
+        self.spec.build.source = source
+        if handler:
+            self.spec.default_handler = handler
+        if workdir:
+            self.spec.workdir = workdir
+        if target_dir:
+            self.spec.build.source_code_target_dir = target_dir
+
+        self.spec.build.load_source_on_run = pull_at_runtime
+        if (
+            self.spec.build.base_image
+            and not self.spec.build.commands
+            and pull_at_runtime
+            and not self.spec.image
+        ):
+            # if we load source from repo and don't need a full build use the base_image as the image
+            self.spec.image = self.spec.build.base_image
+        elif not pull_at_runtime:
+            # clear the image so build will not be skipped
+            self.spec.build.base_image = self.spec.build.base_image or self.spec.image
+            self.spec.image = ""
+
+    def _resolve_build_with_mlrun(self, with_mlrun: typing.Optional[bool] = None):
+        build = self.spec.build
+        if with_mlrun is None:
+            if build.with_mlrun is not None:
+                with_mlrun = build.with_mlrun
+            else:
+                with_mlrun = build.base_image and not (
+                    build.base_image.startswith("mlrun/")
+                    or "/mlrun/" in build.base_image
+                )
+        if (
+            not build.source
+            and not build.commands
+            and not build.requirements
+            and not build.extra
+            and with_mlrun
+        ):
+            logger.info(
+                "Running build to add mlrun package, set "
+                "with_mlrun=False to skip if its already in the image"
+            )
+        return with_mlrun
+
+    def _build_image(
+        self,
+        builder_env,
+        force_build,
+        mlrun_version_specifier,
+        show_on_failure,
+        skip_deployed,
+        watch,
+        is_kfp,
+        with_mlrun,
+    ):
+        # When we're in pipelines context we must watch otherwise the pipelines pod will exit before the operation
+        # is actually done. (when a pipelines pod exits, the pipeline step marked as done)
+        if is_kfp:
+            watch = True
+
+        db = self._get_db()
+        data = db.remote_builder(
+            self,
+            with_mlrun,
+            mlrun_version_specifier,
+            skip_deployed,
+            builder_env=builder_env,
+            force_build=force_build,
+        )
+        self.status = data["data"].get("status", None)
+        self.spec.image = mlrun.utils.get_in(
+            data, "data.spec.image"
+        ) or mlrun.utils.get_in(data, "data.spec.build.image")
+        self.spec.build.base_image = self.spec.build.base_image or mlrun.utils.get_in(
+            data, "data.spec.build.base_image"
+        )
+        # Get the source target dir in case it was enriched due to loading source
+        self.spec.build.source_code_target_dir = mlrun.utils.get_in(
+            data, "data.spec.build.source_code_target_dir"
+        ) or mlrun.utils.get_in(data, "data.spec.clone_target_dir")
+        ready = data.get("ready", False)
+        if not ready:
+            logger.info(
+                f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
+            )
+        if watch and not ready:
+            state = self._build_watch(
+                watch=watch,
+                show_on_failure=show_on_failure,
+            )
+            ready = state == "ready"
+            self.status.state = state
+
+        if watch and not ready:
+            raise mlrun.errors.MLRunRuntimeError("Deploy failed")
+        return ready
+
+    def _build_watch(
+        self,
+        watch: bool = True,
+        logs: bool = True,
+        show_on_failure: bool = False,
+    ):
+        db = self._get_db()
+        offset = 0
+        try:
+            text, _ = db.get_builder_status(self, 0, logs=logs)
+        except mlrun.db.RunDBError:
+            raise ValueError("function or build process not found")
+
+        def print_log(text):
+            if text and (
+                not show_on_failure
+                or self.status.state == mlrun.common.schemas.FunctionState.error
+            ):
+                print(text, end="")
+
+        print_log(text)
+        offset += len(text)
+        if watch:
+            while self.status.state in [
+                mlrun.common.schemas.FunctionState.pending,
+                mlrun.common.schemas.FunctionState.running,
+            ]:
+                time.sleep(2)
+                if show_on_failure:
+                    text = ""
+                    db.get_builder_status(self, 0, logs=False)
+                    if self.status.state == mlrun.common.schemas.FunctionState.error:
+                        # re-read the full log on failure
+                        text, _ = db.get_builder_status(self, offset, logs=logs)
+                else:
+                    text, _ = db.get_builder_status(self, offset, logs=logs)
+                print_log(text)
+                offset += len(text)
+
+        return self.status.state
+
 
 def _resolve_if_type_sanitized(attribute_name, attribute):
     attribute_config = sanitized_attributes[attribute_name]
     # heuristic - if one of the keys contains _ as part of the dict it means to_dict on the kubernetes
     # object performed, there's nothing we can do at that point to transform it to the sanitized version
     for key in attribute.keys():
         if "_" in key:
```

## mlrun/runtimes/utils.py

```diff
@@ -413,42 +413,14 @@
     s = [f"{mlrun_key}project={project}"]
     if name:
         s.append(f"{mlrun_key}function={name}")
         s.append(f"{mlrun_key}tag={tag or 'latest'}")
     return s
 
 
-class k8s_resource:
-    kind = ""
-    per_run = False
-    per_function = False
-    k8client = None
-
-    def deploy_function(self, function):
-        pass
-
-    def release_function(self, function):
-        pass
-
-    def submit_run(self, function, runobj):
-        pass
-
-    def get_object(self, name, namespace=None):
-        return None
-
-    def get_status(self, name, namespace=None):
-        return None
-
-    def del_object(self, name, namespace=None):
-        pass
-
-    def get_pods(self, name, namespace=None, master=False):
-        return {}
-
-
 def enrich_function_from_dict(function, function_dict):
     override_function = mlrun.new_function(runtime=function_dict, kind=function.kind)
     for attribute in [
         "volumes",
         "volume_mounts",
         "env",
         "resources",
```

## mlrun/runtimes/nuclio/api_gateway.py

```diff
@@ -18,15 +18,16 @@
 
 import requests
 from requests.auth import HTTPBasicAuth
 
 import mlrun
 import mlrun.common.schemas
 
-from .function import RemoteRuntime, get_fullname
+from ..utils import logger
+from .function import RemoteRuntime, get_fullname, min_nuclio_versions
 from .serving import ServingRuntime
 
 NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH = "basicAuth"
 NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_NONE = "none"
 PROJECT_NAME_LABEL = "nuclio.io/project-name"
 
 
@@ -88,14 +89,15 @@
             "basicAuth": mlrun.common.schemas.APIGatewayBasicAuth(
                 username=self._username, password=self._password
             )
         }
 
 
 class APIGateway:
+    @min_nuclio_versions("1.13.1")
     def __init__(
         self,
         project,
         name: str,
         functions: Union[
             list[str],
             Union[
@@ -190,14 +192,35 @@
             method=method,
             url=self.invoke_url,
             headers=headers,
             **kwargs,
             auth=HTTPBasicAuth(*auth) if auth else None,
         )
 
+    def wait_for_readiness(self, max_wait_time=90):
+        """
+        Wait for the API gateway to become ready within the maximum wait time.
+
+        Parameters:
+            max_wait_time: int - Maximum time to wait in seconds (default is 90 seconds).
+
+        Returns:
+            bool: True if the entity becomes ready within the maximum wait time, False otherwise
+        """
+
+        def _ensure_ready():
+            if not self.is_ready():
+                raise AssertionError(
+                    f"Waiting for gateway readiness is taking more than {max_wait_time} seconds"
+                )
+
+        return mlrun.utils.helpers.retry_until_successful(
+            3, max_wait_time, logger, False, _ensure_ready
+        )
+
     def is_ready(self):
         if self.state is not mlrun.common.schemas.api_gateway.APIGatewayState.ready:
             # try to sync the state
             self.sync()
         return self.state == mlrun.common.schemas.api_gateway.APIGatewayState.ready
 
     def sync(self):
@@ -320,17 +343,18 @@
         self,
     ):
         """
         Get the invoke URL.
 
         :return: (str) The invoke URL.
         """
+        host = self.host
         if not self.host.startswith("http"):
-            self.host = f"https://{self.host}"
-        return urljoin(self.host, self.path)
+            host = f"https://{self.host}"
+        return urljoin(host, self.path)
 
     def _validate(
         self,
         name: str,
         project: str,
         functions: Union[
             list[str],
```

## mlrun/runtimes/nuclio/function.py

```diff
@@ -539,19 +539,24 @@
         force_build: bool = False,
     ):
         """Deploy the nuclio function to the cluster
 
         :param project:    project name
         :param tag:        function tag
         :param verbose:    set True for verbose logging
-        :param auth_info:  service AuthInfo
+        :param auth_info:  service AuthInfo (deprecated and ignored)
         :param builder_env: env vars dict for source archive config/credentials e.g. builder_env={"GIT_TOKEN": token}
         :param force_build: set True for force building the image
         """
-        # todo: verify that the function name is normalized
+        if auth_info:
+            # TODO: remove in 1.9.0
+            warnings.warn(
+                "'auth_info' is deprecated for nuclio runtimes in 1.7.0 and will be removed in 1.9.0",
+                FutureWarning,
+            )
 
         old_http_session = getattr(self, "_http_session", None)
         if old_http_session:
             # ensure existing http session is terminated prior to (re)deploy to ensure that a connection to an old
             # replica will not be reused
             old_http_session.close()
             self._http_session = None
@@ -566,17 +571,15 @@
 
         save_record = False
         # Attempt auto-mounting, before sending to remote build
         self.try_auto_mount_based_on_config()
         self._fill_credentials()
         db = self._get_db()
         logger.info("Starting remote function deploy")
-        data = db.remote_builder(
-            self, False, builder_env=builder_env, force_build=force_build
-        )
+        data = db.deploy_nuclio_function(func=self, builder_env=builder_env)
         self.status = data["data"].get("status")
         self._update_credentials_from_remote_build(data["data"])
 
         # when a function is deployed, we wait for it to be ready by default
         # this also means that the function object will be updated with the function status
         self._wait_for_function_deployment(db, verbose=verbose)
 
@@ -609,15 +612,15 @@
         state = ""
         last_log_timestamp = 1
         while state not in ["ready", "error", "unhealthy"]:
             sleep(
                 int(mlrun.mlconf.httpdb.logs.nuclio.pull_deploy_status_default_interval)
             )
             try:
-                text, last_log_timestamp = db.get_builder_status(
+                text, last_log_timestamp = db.get_nuclio_deploy_status(
                     self, last_log_timestamp=last_log_timestamp, verbose=verbose
                 )
             except mlrun.db.RunDBError:
                 raise ValueError("function or deploy process not found")
             state = self.status.state
             if text:
                 print(text)
@@ -991,18 +994,18 @@
                 "containerPort": port,
                 "protocol": "TCP",
             }
             for port in ports
         ]
 
         if command:
-            sidecar["command"] = command
+            sidecar["command"] = mlrun.utils.helpers.as_list(command)
 
         if args:
-            sidecar["args"] = args
+            sidecar["args"] = mlrun.utils.helpers.as_list(args)
 
     def _set_sidecar(self, name: str) -> dict:
         self.spec.config.setdefault("spec.sidecars", [])
         sidecars = self.spec.config["spec.sidecars"]
         for sidecar in sidecars:
             if sidecar["name"] == name:
                 return sidecar
```

## mlrun/runtimes/nuclio/serving.py

```diff
@@ -487,17 +487,17 @@
                     trigger_args["extra_attributes"] = extra_attributes
                     extra_attributes["worker_allocation_mode"] = extra_attributes.get(
                         "worker_allocation_mode", "static"
                     )
 
                 if (
                     stream.path.startswith("kafka://")
-                    or "kafka_bootstrap_servers" in stream.options
+                    or "kafka_brokers" in stream.options
                 ):
-                    brokers = stream.options.get("kafka_bootstrap_servers")
+                    brokers = stream.options.get("kafka_brokers")
                     if brokers:
                         brokers = brokers.split(",")
                     topic, brokers = parse_kafka_url(stream.path, brokers)
                     trigger = KafkaTrigger(
                         brokers=brokers,
                         topics=[topic],
                         consumer_group=group,
```

## mlrun/runtimes/nuclio/application/application.py

```diff
@@ -219,24 +219,102 @@
         self,
         project="",
         tag="",
         verbose=False,
         auth_info: AuthInfo = None,
         builder_env: dict = None,
         force_build: bool = False,
+        with_mlrun=None,
+        skip_deployed=False,
+        is_kfp=False,
+        mlrun_version_specifier=None,
+        show_on_failure: bool = False,
     ):
+        """
+        Deploy function, builds the application image if required (self.requires_build()) or force_build is True,
+        Once the image is built, the function is deployed.
+        :param project:                 Project name
+        :param tag:                     Function tag
+        :param verbose:                 Set True for verbose logging
+        :param auth_info:               Service AuthInfo (deprecated and ignored)
+        :param builder_env:             Env vars dict for source archive config/credentials
+                                        e.g. builder_env={"GIT_TOKEN": token}
+        :param force_build:             Set True for force building the application image
+        :param with_mlrun:              Add the current mlrun package to the container build
+        :param skip_deployed:           Skip the build if we already have an image for the function
+        :param is_kfp:                  Deploy as part of a kfp pipeline
+        :param mlrun_version_specifier: Which mlrun package version to include (if not current)
+        :param show_on_failure:         Show logs only in case of build failure
+        :return: True if the function is ready (deployed)
+        """
+        if self.requires_build() or force_build:
+            self._fill_credentials()
+            self._build_application_image(
+                builder_env=builder_env,
+                force_build=force_build,
+                watch=True,
+                with_mlrun=with_mlrun,
+                skip_deployed=skip_deployed,
+                is_kfp=is_kfp,
+                mlrun_version_specifier=mlrun_version_specifier,
+                show_on_failure=show_on_failure,
+            )
+
         self._ensure_reverse_proxy_configurations()
         self._configure_application_sidecar()
         super().deploy(
             project,
             tag,
             verbose,
             auth_info,
             builder_env,
-            force_build,
+        )
+
+    def with_source_archive(
+        self, source, workdir=None, pull_at_runtime=True, target_dir=None
+    ):
+        """load the code from git/tar/zip archive at runtime or build
+
+        :param source:          valid absolute path or URL to git, zip, or tar file, e.g.
+                                git://github.com/mlrun/something.git
+                                http://some/url/file.zip
+                                note path source must exist on the image or exist locally when run is local
+                                (it is recommended to use 'workdir' when source is a filepath instead)
+        :param workdir:         working dir relative to the archive root (e.g. './subdir') or absolute to the image root
+        :param pull_at_runtime: load the archive into the container at job runtime vs on build/deploy
+        :param target_dir:      target dir on runtime pod or repo clone / archive extraction
+        """
+        self._configure_mlrun_build_with_source(
+            source=source,
+            workdir=workdir,
+            pull_at_runtime=pull_at_runtime,
+            target_dir=target_dir,
+        )
+
+    def _build_application_image(
+        self,
+        builder_env: dict = None,
+        force_build: bool = False,
+        watch=True,
+        with_mlrun=None,
+        skip_deployed=False,
+        is_kfp=False,
+        mlrun_version_specifier=None,
+        show_on_failure: bool = False,
+    ):
+        with_mlrun = self._resolve_build_with_mlrun(with_mlrun)
+        return self._build_image(
+            builder_env=builder_env,
+            force_build=force_build,
+            mlrun_version_specifier=mlrun_version_specifier,
+            show_on_failure=show_on_failure,
+            skip_deployed=skip_deployed,
+            watch=watch,
+            is_kfp=is_kfp,
+            with_mlrun=with_mlrun,
         )
 
     def _ensure_reverse_proxy_configurations(self):
         if self.spec.build.functionSourceCode or self.status.container_image:
             return
 
         filename, handler = ApplicationRuntime.get_filename_and_handler()
```

## mlrun/runtimes/nuclio/application/reverse_proxy.go

```diff
@@ -35,19 +35,27 @@
     if err != nil {
         context.Logger.ErrorWith("Failed to create a reverse proxy request")
         return nil, err
     }
     for k, v := range event.GetHeaders() {
         httpRequest.Header[k] = []string{v.(string)}
     }
+
+    // populate query params
+    query := httpRequest.URL.Query()
+    for k, v := range event.GetFields() {
+        query.Set(k, v.(string))
+    }
+    httpRequest.URL.RawQuery = query.Encode()
+
     recorder := httptest.NewRecorder()
     reverseProxy.ServeHTTP(recorder, httpRequest)
 
     // send request to sidecar
-    context.Logger.InfoWith("Forwarding request to sidecar", "sidecarUrl", sidecarUrl)
+    context.Logger.DebugWith("Forwarding request to sidecar", "sidecarUrl", sidecarUrl, "query", httpRequest.URL.Query())
     response := recorder.Result()
 
     headers := make(map[string]interface{})
     for key, value := range response.Header {
         headers[key] = value[0]
     }
```

## mlrun/serving/remote.py

```diff
@@ -168,28 +168,27 @@
         await self._do_downstream(new_event)
 
     def do_event(self, event):
         # sync implementation (without storey)
         if not self._session:
             self._session = mlrun.utils.HTTPSessionWithRetry(
                 self.retries,
-                self.backoff_factor
-                or mlrun.config.config.http_retry_defaults.backoff_factor,
+                self.backoff_factor or mlrun.mlconf.http_retry_defaults.backoff_factor,
                 retry_on_exception=False,
                 retry_on_status=self.retries > 0,
                 retry_on_post=True,
             )
 
         body = _extract_input_data(self._input_path, event.body)
         method, url, headers, body = self._generate_request(event, body)
         try:
             resp = self._session.request(
                 method,
                 url,
-                verify=mlrun.config.config.httpdb.http.verify,
+                verify=mlrun.mlconf.httpdb.http.verify,
                 headers=headers,
                 data=body,
                 timeout=self.timeout,
             )
         except requests.exceptions.ReadTimeout as err:
             raise requests.exceptions.ReadTimeout(
                 f"http request to {url} timed out in RemoteStep {self.name}, {err_to_str(err)}"
```

## mlrun/serving/server.py

```diff
@@ -49,15 +49,15 @@
     that will be used for pushing the events from the nuclio model serving function"""
 
     def __init__(self, enabled: bool, parameters: dict, function_uri: str):
         """
         Initialize _StreamContext object.
         :param enabled:      A boolean indication for applying the stream context
         :param parameters:   Dictionary of optional parameters, such as `log_stream` and `stream_args`. Note that these
-                             parameters might be relevant to the output source such as `kafka_bootstrap_servers` if
+                             parameters might be relevant to the output source such as `kafka_brokers` if
                              the output source is from type Kafka.
         :param function_uri: Full value of the function uri, usually it's <project-name>/<function-name>
         """
 
         self.enabled = False
         self.hostname = socket.gethostname()
         self.function_uri = function_uri
```

## mlrun/serving/states.py

```diff
@@ -1520,29 +1520,26 @@
             if step.kind == StepKinds.queue:
                 skip_stream = context.is_mock and step.next
                 if step.path and not skip_stream:
                     stream_path = step.path
                     endpoint = None
                     options = {}
                     options.update(step.options)
-                    kafka_bootstrap_servers = options.pop(
-                        "kafka_bootstrap_servers", None
-                    )
-                    if stream_path.startswith("kafka://") or kafka_bootstrap_servers:
-                        topic, bootstrap_servers = parse_kafka_url(
-                            stream_path, kafka_bootstrap_servers
-                        )
+                    kafka_brokers = options.pop("kafka_brokers", None)
+                    if stream_path.startswith("kafka://") or kafka_brokers:
+                        topic, brokers = parse_kafka_url(stream_path, kafka_brokers)
 
                         kafka_producer_options = options.pop(
-                            "kafka_producer_options", None
+                            "kafka_producer_options",
+                            options.pop("kafka_bootstrap_servers", None),
                         )
 
                         step._async_object = storey.KafkaTarget(
                             topic=topic,
-                            bootstrap_servers=bootstrap_servers,
+                            brokers=brokers,
                             producer_options=kafka_producer_options,
                             context=context,
                             **options,
                         )
                     else:
                         if stream_path.startswith("v3io://"):
                             endpoint, stream_path = parse_path(step.path)
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'3396f9ef4c278411ca6227b1792ff7df20005a42'", "'version'": "'1.7.0-rc9'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "cc1ff1e98ef6b7951710f45c3d297d0d0b4319c0",
-    "version": "1.7.0-rc8"
+    "git_commit": "3396f9ef4c278411ca6227b1792ff7df20005a42",
+    "version": "1.7.0-rc9"
 }
```

## Comparing `mlrun-1.7.0rc8.dist-info/LICENSE` & `mlrun-1.7.0rc9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.7.0rc8.dist-info/METADATA` & `mlrun-1.7.0rc9.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.7.0rc8
+Version: 1.7.0rc9
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: Apache License 2.0
 Keywords: mlrun,mlops,data-science,machine-learning,experiment-tracking
 Classifier: Development Status :: 4 - Beta
@@ -40,15 +40,15 @@
 Requires-Dist: pydantic <1.10.15,>=1.10.8
 Requires-Dist: mergedeep ~=1.3
 Requires-Dist: v3io-frames ~=0.10.12
 Requires-Dist: semver ~=3.0
 Requires-Dist: dependency-injector ~=4.41
 Requires-Dist: fsspec <2024.4,>=2023.9.2
 Requires-Dist: v3iofs ~=0.1.17
-Requires-Dist: storey ~=1.7.6
+Requires-Dist: storey ~=1.7.7
 Requires-Dist: inflection ~=0.5.0
 Requires-Dist: python-dotenv ~=0.17.0
 Requires-Dist: setuptools ~=69.1
 Requires-Dist: deprecated ~=1.2
 Requires-Dist: jinja2 >=3.1.3,~=3.1
 Requires-Dist: orjson <4,>=3.9.15
 Provides-Extra: alibaba-oss
@@ -82,15 +82,15 @@
 Requires-Dist: s3fs <2024.4,>=2023.9.2 ; extra == 'all'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'all'
 Provides-Extra: api
 Requires-Dist: uvicorn ~=0.27.1 ; extra == 'api'
 Requires-Dist: dask-kubernetes ~=0.11.0 ; extra == 'api'
 Requires-Dist: apscheduler <4,>=3.10.3 ; extra == 'api'
 Requires-Dist: objgraph ~=3.6 ; extra == 'api'
-Requires-Dist: igz-mgmt ~=0.1.1 ; extra == 'api'
+Requires-Dist: igz-mgmt ~=0.1.3 ; extra == 'api'
 Requires-Dist: humanfriendly ~=10.0 ; extra == 'api'
 Requires-Dist: fastapi ~=0.110.0 ; extra == 'api'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'api'
 Requires-Dist: pymysql ~=1.0 ; extra == 'api'
 Requires-Dist: alembic ~=1.9 ; extra == 'api'
 Requires-Dist: timelength ~=1.1 ; extra == 'api'
 Provides-Extra: azure-blob-storage
@@ -143,15 +143,15 @@
 Requires-Dist: databricks-sdk ~=0.13.0 ; extra == 'complete-api'
 Requires-Dist: distributed ~=2023.9.0 ; extra == 'complete-api'
 Requires-Dist: fastapi ~=0.110.0 ; extra == 'complete-api'
 Requires-Dist: gcsfs <2024.4,>=2023.9.2 ; extra == 'complete-api'
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ==3.14.1 ; extra == 'complete-api'
 Requires-Dist: graphviz ~=0.20.0 ; extra == 'complete-api'
 Requires-Dist: humanfriendly ~=10.0 ; extra == 'complete-api'
-Requires-Dist: igz-mgmt ~=0.1.1 ; extra == 'complete-api'
+Requires-Dist: igz-mgmt ~=0.1.3 ; extra == 'complete-api'
 Requires-Dist: kafka-python ~=2.0 ; extra == 'complete-api'
 Requires-Dist: mlflow ~=2.8 ; extra == 'complete-api'
 Requires-Dist: msrest ~=0.6.21 ; extra == 'complete-api'
 Requires-Dist: objgraph ~=3.6 ; extra == 'complete-api'
 Requires-Dist: oss2 ==2.18.1 ; extra == 'complete-api'
 Requires-Dist: ossfs ==2023.12.0 ; extra == 'complete-api'
 Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'complete-api'
```

## Comparing `mlrun-1.7.0rc8.dist-info/RECORD` & `mlrun-1.7.0rc9.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 mlrun/__init__.py,sha256=o9dHUfVFADfsi6GnOPLr2OkfkHdPvOnA7rkoECen0-I,7248
 mlrun/__main__.py,sha256=LKskOWulg04o0IFm33Pfmokuxo6P9wLSl3ZHkiS9eZc,49326
-mlrun/config.py,sha256=7HGuYhgeCLETYxNxqjSgtSFfNMQ5PcAPaWmtBRX-uoo,63992
+mlrun/config.py,sha256=s5U9ZHhbqbtQA1lteHFJaC2hV2dijKk-_wLTXJds-60,64038
 mlrun/errors.py,sha256=HmOAdfpL0bCDisZMUoJPOumneq71ko49Ph-XBL-A4xA,7080
 mlrun/execution.py,sha256=meZ_qSdTmnpqW7DKv7LdBmuE1Ut34E1RbK2kO0MD_QM,40866
 mlrun/features.py,sha256=nPDvy8tJuxwbRr843oWcnLBrqMJDPUanzn2Sb3BBi6w,15569
 mlrun/k8s_utils.py,sha256=YyFZT2WNZrJkcZoqxrkduQgzQ1X-7195O0mmEqvaIug,7023
 mlrun/kfpops.py,sha256=bCHfvzz9E_fOSM8ASPqBcbG4pGRo8Sq5IMvGIYiEYRI,30446
 mlrun/lists.py,sha256=ev-gLBPc_az03yQEHrKyDPq_Bjosa4D_XFiVbRIpmRY,8286
 mlrun/model.py,sha256=BkPHhOQZJUQI4YB74FE8gEBOHwY1rpEhiEBcjzWIJtw,70641
 mlrun/render.py,sha256=aMH3U2z7ELpW8MwYEGOrqLdEUwMX29shqy6V6-KbgiM,13009
-mlrun/run.py,sha256=38xMRfYQU7qpEtWjzFOul-gYLzL6vrnolXDmQU4eB7s,42968
+mlrun/run.py,sha256=N_Am8QndD4hZ2kdUL3nOOEoq8AEJ3iLsvE1qXmlzvNk,43112
 mlrun/secrets.py,sha256=Nl_7ZNSErd-AOH19vVx_PjrLg9bJM9L-BvEYoPolB1c,7776
 mlrun/api/schemas/__init__.py,sha256=LhfO3myrnLVxC0MYCAc1_LTuqhRlYV3H7BwJkjOu3dQ,14211
 mlrun/artifacts/__init__.py,sha256=LxEWcMYPawJYvNOl6H2_UvrxdLTNYfKeZcMEKFZnGgA,1187
 mlrun/artifacts/base.py,sha256=2UYjwp7o_Fxhr1sMYE5mSUpxGA8yt2ZU1_UicreL7hk,34978
 mlrun/artifacts/dataset.py,sha256=hKdKtyAJqPWUGs1yefOAxa10s_ar3o7MaO7oiiD_HqU,22360
 mlrun/artifacts/manager.py,sha256=p6CmIJH91vm9DsEZHgHxKYTHU2BvF9IwpLv85cqoHNs,14425
 mlrun/artifacts/model.py,sha256=DXT24CH1ZgQLz9HcWBfjRAEhCBfznoa7-pB52N9qMOI,25205
@@ -23,94 +23,96 @@
 mlrun/common/helpers.py,sha256=BAhyuUnZvD_BT43i0_1EszuSbKgZx7bFy2KRIWP0XeA,1087
 mlrun/common/secrets.py,sha256=vc8WV82EZsCB5ENjUkObFOzZP59aZ1w8F82PTnqwBnc,5181
 mlrun/common/types.py,sha256=nNqNqNpn-xl4xliy-ofBAWVX02q5NFh6wxmvOnD4wW8,949
 mlrun/common/db/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/common/db/sql_session.py,sha256=Znc8KE2oLy4lg3_vRki1sVlNx59TgDSOTCXfU561hBU,2659
 mlrun/common/model_monitoring/__init__.py,sha256=x0EMEvxVjHsm858J1t6IEA9dtKTdFpJ9sKhss10ld8A,721
 mlrun/common/model_monitoring/helpers.py,sha256=1CpxIDQPumFnpUB1eqcvCpLlyPFVeW2sL6prM-N5A1A,4405
-mlrun/common/schemas/__init__.py,sha256=kMQDBUWtuJxBhCUakS8knGUyZa_izTAJpMOFJrivkjM,5005
+mlrun/common/schemas/__init__.py,sha256=dkT3YzrzLg8mdghBIX3IQbc81kcX36_8JOUngD77jYU,5063
 mlrun/common/schemas/api_gateway.py,sha256=mw47rpTBAVIRV6TdMQ_A6rIgnEHOUweU7iT3VbINvBE,2519
 mlrun/common/schemas/artifact.py,sha256=d6srME_eWn2MpGuqvPQZtePRFkjDfNJgQ6JDd51qVrI,2796
 mlrun/common/schemas/auth.py,sha256=KOQfABIXTrcMh3Us5vlmnN4w3bJB7Rl3Xd5GTAFpr-g,5970
 mlrun/common/schemas/background_task.py,sha256=2qZxib2qrF_nPZj0ncitCG-2jxz2hg1qj0hFc8eswWQ,1707
 mlrun/common/schemas/client_spec.py,sha256=EFYUSstblo13-O0LTwJfnsYmxbGPAypY3idy8SHpq1c,2858
 mlrun/common/schemas/clusterization_spec.py,sha256=aeaFJZms7r7h2HDv6ML_GDAT6gboW-PxBbc3GKPalGk,888
 mlrun/common/schemas/common.py,sha256=00upzVLPN7O511Q87yt-fvRcDQFbXra4j0_lqMGg6rs,1557
 mlrun/common/schemas/constants.py,sha256=UnnhyLeF-SSjy8KaV5a-TBw4Ws675gueYGiP1fr5NfU,6476
 mlrun/common/schemas/datastore_profile.py,sha256=hJ8q54A8VZKsnOvSIjcllj4MZ1bBhb_EmBgsqpwSF_Y,750
 mlrun/common/schemas/events.py,sha256=ROHJLo_fqYjc96pek7yhAUPpPRIuAR76lwxvNz8LIr8,1026
 mlrun/common/schemas/feature_store.py,sha256=577OHVRZbV3kqYei4drVdTmCcGLJU8UXSGEpfo9FTQk,3717
 mlrun/common/schemas/frontend_spec.py,sha256=NPQZB7-A7ERXseTsdlxxG81CDL2oEcaUIj7OG2J9qPQ,2418
 mlrun/common/schemas/function.py,sha256=wnsIT0UxYB-GSzDx7FJ-O-TQRnGLsq1rQtRi4cJaINw,4577
 mlrun/common/schemas/http.py,sha256=1PtYFhF6sqLSBRcuPMtYcUGmroBhaleqLmYidSdL9LM,705
-mlrun/common/schemas/hub.py,sha256=HOlUwmrlhXaigJ8H8NgFykttoktTaedpIr-SYA2XcCM,4203
+mlrun/common/schemas/hub.py,sha256=cuv_vpkO27XNCZzfytnUyi0k0ZA4wf_QRn5B0ZPoK-Y,4116
 mlrun/common/schemas/k8s.py,sha256=nmMnhgjVMLem5jyumoG2eQKioGK9eUVhQnOSb3hG7yw,1395
 mlrun/common/schemas/memory_reports.py,sha256=tpS3fpvxa6VcBpzCRzcZTt0fCF0h6ReUetYs7j6kdps,892
 mlrun/common/schemas/notification.py,sha256=Ge7eWNGf_XUFkjOnUkyUOubdEbmXh9z_OSGcSturt4w,1768
 mlrun/common/schemas/object.py,sha256=VleJSUmDJMl92knLgaDE8SWCi3ky0UaHcwcwOIapPQ8,1980
+mlrun/common/schemas/pagination.py,sha256=q7nk6bipkDiE7HExIVqhy5ANl-zv0x8QC9Kg6AkLtDA,887
 mlrun/common/schemas/pipeline.py,sha256=GhrIsf5tRUQtQYboZ2feXdMjpFelVvduM-SIQoV5TZw,1177
-mlrun/common/schemas/project.py,sha256=TvzqyNtWtSdj373_Wm6gQTIZXMPmBgny0_Wco_wot4g,4340
+mlrun/common/schemas/project.py,sha256=goVEnn2ou24j029JmSyLPV2rakNiyiru1EjjrNpgfNQ,4361
 mlrun/common/schemas/regex.py,sha256=8_vbDeAE0SODJDj7yUFg1FbaB9CNydYQTJ29JxE74Kc,776
 mlrun/common/schemas/runs.py,sha256=H9QhaN83cFUN42eE9TLgi1gs6Xdq11oQSZ96ESM94mI,745
 mlrun/common/schemas/runtime_resource.py,sha256=2rSuYL-9JkESSomlnU91mYDbfV-IkqZeXx6OHuMmDxs,1554
 mlrun/common/schemas/schedule.py,sha256=e9nAeRkZkyk37Ws1cBNseHVKPOQqmWV16rt-zr_eAJU,4287
 mlrun/common/schemas/secret.py,sha256=51tCN1F8DFTq4y_XdHIMDy3I1TnMEBX8kO8BHKavYF4,1484
 mlrun/common/schemas/tag.py,sha256=OAn9Qt6z8ibqw8uU8WQSvuwY8irUv45Dhx2Ko5FzUss,884
 mlrun/common/schemas/workflow.py,sha256=eRoaOBFiWbvP0iwZ6Aof5JmheV81A0-0PGi8L4vuXmI,1823
 mlrun/common/schemas/model_monitoring/__init__.py,sha256=SH3RBljBadT43eEyWttG1-gJCsYMjbfGVno1jYy8UEU,1501
-mlrun/common/schemas/model_monitoring/constants.py,sha256=gJg4SI2R7lHNcKydC6qZua4ktE11X7dCBK3jZ45wJDA,8322
+mlrun/common/schemas/model_monitoring/constants.py,sha256=rZVBCdN9mBPr9FixFc3Zl2j3f-LI6NmdxES4fnV4VIo,8302
 mlrun/common/schemas/model_monitoring/grafana.py,sha256=aiNK8iL_fIzDVO_bj4fted9P6fAwaymcPC2OnRk36po,1431
 mlrun/common/schemas/model_monitoring/model_endpoints.py,sha256=ct8Jd-08KwrFw2uVjdwO_jmNrbhYmQvHBAPLO7AVpn4,12000
 mlrun/data_types/__init__.py,sha256=EkxfkFoHb91zz3Aymq-KZfCHlPMzEc3bBqgzPUwmHWY,1087
 mlrun/data_types/data_types.py,sha256=hWiL5TPOj9EK7_nd1yttLBUhXTmBYLDZzmG-hWzzhHE,4751
 mlrun/data_types/infer.py,sha256=z2EbSpR6xWEE5-HRUtDZkapHQld3xMbzXtTX83K-690,6134
 mlrun/data_types/spark.py,sha256=qKQ2TIAPQWDgmIOmpyV5_uuyUX3AnXWSq6GPpVjVIek,9457
 mlrun/data_types/to_pandas.py,sha256=_8_M9WclYNkPeHLo0eXhrnLE6SiLkvNTreeqfJ9G5yY,9945
-mlrun/datastore/__init__.py,sha256=bsRzu39UOocQAAl_nOKCbhxrZhWUEXrAc8WV3zs0VyI,4118
+mlrun/datastore/__init__.py,sha256=Fqebv0azSui5qj0fPcc9jFjnpUZ_FE27bXI92DOAWtE,4034
 mlrun/datastore/alibaba_oss.py,sha256=OfQ9AbsJNBFF9DFgUdq38TvKw6qwnHmEcnH-nze6ZZg,4827
 mlrun/datastore/azure_blob.py,sha256=NpkEoIie7mH171tOwlrwpEwzRYGoo9SF3FAAegEENhU,9019
 mlrun/datastore/base.py,sha256=QNiYoeyMRnZiyp7HRT68sfjWeSyu0zLLGfzTkTdkyl8,24421
 mlrun/datastore/datastore.py,sha256=GGo8XPnKVWWgY0b-18D93V1g8DJgeBNafa6knnHEabw,9111
-mlrun/datastore/datastore_profile.py,sha256=yRQA7UmiaBvkROOakjlkgMPBzu9WCQMEBuSNYix93UU,16175
+mlrun/datastore/datastore_profile.py,sha256=ttyqRWPGJui-0q_rihGk6H7g7aJFDpPCEdFcJZz7Z60,16549
 mlrun/datastore/dbfs_store.py,sha256=5IkxnFQXkW0fdx-ca5jjQnUdTsTfNdJzMvV31ZpDNrM,6634
 mlrun/datastore/filestore.py,sha256=nS3Ie6jG41NDiW_as9tF8Nu5maaSVEKYKUr1IQtPhuA,3767
 mlrun/datastore/google_cloud_storage.py,sha256=Du5qYYUCSkLt9acQDeQ-PgEjttsE7D2eAoLebO43kiw,6110
 mlrun/datastore/hdfs.py,sha256=jCuuPbnITezNYug9iYNLEJW87GGXSqW6H-UiqAynfdw,1674
 mlrun/datastore/helpers.py,sha256=-bKveE9rteLd0hJd6OSMuMbfz09W_OXyu1G5O2ihZjs,622
 mlrun/datastore/inmem.py,sha256=6PAltUk7uyYlDgnsaJPOkg_P98iku1ys2e2wpAmPRkc,2779
 mlrun/datastore/redis.py,sha256=yJ8xYHAR4DyYzsAMLQmsdzO-VVUTQABkIxcWhVHeUFI,5575
 mlrun/datastore/s3.py,sha256=EIPAXJGZ9kpQVbb_utFFZskDM21fAGz4m6QEAGecABU,8110
-mlrun/datastore/sources.py,sha256=3BgqVgJzdiK7OWbbSJiGBnIY1OnP4W9lLEdk--RGruQ,40125
+mlrun/datastore/snowflake_utils.py,sha256=QFWS6skWnPs_p4ioE9qEyUUettSHVYA4g8e-LnebU8A,1439
+mlrun/datastore/sources.py,sha256=VLmGl12wbuS19bPsUVhNXQKYFCpPqmUnVjj6tA5mdxU,39528
 mlrun/datastore/spark_udf.py,sha256=NnnB3DZxZb-rqpRy7b-NC7QWXuuqFn3XkBDc86tU4mQ,1498
 mlrun/datastore/spark_utils.py,sha256=50rllp6xXpXY__1LbU7aTXUU5ca8dKAfoskPre3npZo,1611
 mlrun/datastore/store_resources.py,sha256=dfMdFy2urilECtlwLJr5CSG12MA645b-NPYDnbr5s1A,6839
-mlrun/datastore/targets.py,sha256=wTnPDuYvWkfz6zqEbJfWYQ9Zzf2NlzSb-SW8P9qfg8k,70949
-mlrun/datastore/utils.py,sha256=YKK9q1C0LmveQFnbh1Dkb8LwA4WbOYFTsNxziC8d0E4,5227
+mlrun/datastore/targets.py,sha256=ab3CX756taKsgAX3hh4_NTAjqxjCuhLurF62KF4aqnk,74690
+mlrun/datastore/utils.py,sha256=ltT_TSj8boH5Q32nz7-RFhge9he8krUx2KdDUlrYiUg,5227
 mlrun/datastore/v3io.py,sha256=oCAMpST6sKnjm5CaNsTrcwqk3bvUFzuKBvNFmUJpPfw,9252
 mlrun/datastore/wasbfs/__init__.py,sha256=s5Ul-0kAhYqFjKDR2X0O2vDGDbLQQduElb32Ev56Te4,1343
 mlrun/datastore/wasbfs/fs.py,sha256=MnSj7Q4OKA2L55ihCmUnj2t3GA3B77oLMdAw-yxvN9w,6151
 mlrun/db/__init__.py,sha256=WqJ4x8lqJ7ZoKbhEyFqkYADd9P6E3citckx9e9ZLcIU,1163
-mlrun/db/base.py,sha256=Qrh0RqYRvmE4ZfmMXCg2xyxFeBQfzpNib7sOWFCQ5uA,19171
+mlrun/db/base.py,sha256=g9BGaa6cqlJyWFCnokRfx56Kwy88sZUxYF2vaw32wHM,20175
 mlrun/db/factory.py,sha256=ibIrE5QkIIyzDU1FXKrfbc31cZiRLYKDZb8dqCpQwyU,2397
-mlrun/db/httpdb.py,sha256=kR8sfnIv9W6S3FrFTPrTmNKIdIQh-Q7n3W6LmT8wxls,158765
-mlrun/db/nopdb.py,sha256=LM7rmx6TnSLFi6ASWs4XUsQhoAVRkIvKRPj85IztNOA,14882
+mlrun/db/httpdb.py,sha256=d5NsPqMti5jGGTikpQ53J2BN7uWymIFtQJHwzBgoCV8,162721
+mlrun/db/nopdb.py,sha256=X062oco3PMXsCGigk9CX_r4h3kGGw2Sr5CMtQP81dHU,17627
 mlrun/feature_store/__init__.py,sha256=n1F5m1svFW2chbE2dJdWzZJJiYS4E-y8PQsG9Q-F0lU,1584
-mlrun/feature_store/api.py,sha256=bO5I_lkIPLv8j3AXYOAseSBI8RrsGwQ9m7isepuADkw,49480
+mlrun/feature_store/api.py,sha256=Z97BHlPA9niGO6h-Hsrtt4i7I3HMgxnW4588_MO-owo,49595
 mlrun/feature_store/common.py,sha256=DKmoRk04NCS1gv7qZuEUa2-g8WsfR6IWjYctcrqKVlg,12853
 mlrun/feature_store/feature_set.py,sha256=iIEFt85Bpc4Q0jNqNXLptVZfULpFBHT5iLSzrZVYvbY,55295
 mlrun/feature_store/feature_vector.py,sha256=2sGbHAXdkm92-R29HXeFxwScvZM4M2gk-t9RteaHc4c,43560
 mlrun/feature_store/ingestion.py,sha256=GZkrke5_JJfA_PGOFc6ekbHKujHgMgqr6t4vop5n_bg,11210
 mlrun/feature_store/steps.py,sha256=bx9pjdiV2teE1wNrigriT2Xp4RQ_TwC46-yboLnpQw0,28882
 mlrun/feature_store/retrieval/__init__.py,sha256=bwA4copPpLQi8fyoUAYtOyrlw0-6f3-Knct8GbJSvRg,1282
 mlrun/feature_store/retrieval/base.py,sha256=XUX4D_0CrgppwdF-Ca4zVf43rjlg4sYPlaNlSaciP7Q,30004
 mlrun/feature_store/retrieval/conversion.py,sha256=y7A5yNAR9CRjsGz7XytJFRt3Ngf6XNRBZys94NzSVE4,11654
 mlrun/feature_store/retrieval/dask_merger.py,sha256=_AiEu0iRPi9nKt97EhlXqXCYfq4LgHsdpG7ZzpycReM,5491
 mlrun/feature_store/retrieval/job.py,sha256=NJ1tx1YdTGGe5AAmsHIBSIwJVnOe_qD5WQcKUHz5HsI,8261
 mlrun/feature_store/retrieval/local_merger.py,sha256=jkzTml_umIU-d6isKFNPtmLZ5K9upqbJLWUde2DdiL8,4429
-mlrun/feature_store/retrieval/spark_merger.py,sha256=cp_tm52VARBjmrH6yDrzj53MiTqCPy73i6MIT9jW8Zs,11165
+mlrun/feature_store/retrieval/spark_merger.py,sha256=oD8pPHFQZJ4d4-ClnqNK-LXt8hE1a0YCjRt2dbEyRL8,11019
 mlrun/feature_store/retrieval/storey_merger.py,sha256=5YM0UPrLjGOobulHkowRO-1LuvFD2cm_0GxcpnTdu0I,6314
 mlrun/frameworks/__init__.py,sha256=qRHe_nUfxpoLaSASAkIxcW6IyunMtxq5LXhjzZMO_1E,743
 mlrun/frameworks/parallel_coordinates.py,sha256=9sjRaRJXKAQASb1cGuoSoGmDenZlDtE9c6ut1iA2hwQ,11487
 mlrun/frameworks/_common/__init__.py,sha256=7afutDCDVp999gyWSWQZMJRKGuW3VP3MFil8cobRsyg,962
 mlrun/frameworks/_common/artifacts_library.py,sha256=f0rtDRQI3BYT2ZvXR4drSXZPYPJG19Sbej-_ru-i0II,8497
 mlrun/frameworks/_common/mlrun_interface.py,sha256=HbnE1jtApNjMog3fhd40Ayq6mos_vFUx5ICGEgFzNEA,20999
 mlrun/frameworks/_common/model_handler.py,sha256=OkC4CZP2F7XME58bO6a0mMvCf1qb8j95JM5Su4YXeeo,55312
@@ -176,29 +178,29 @@
 mlrun/frameworks/sklearn/estimator.py,sha256=T0SltgAqy8NQy7rkdBEItLjMOMjyN2clRfQXhimNx-o,5840
 mlrun/frameworks/sklearn/metric.py,sha256=57UVkkKgUz9xDGWILWfLkBqrLk8WvhsKMgwEflYrM0s,7089
 mlrun/frameworks/sklearn/metrics_library.py,sha256=mGMo_s4d1JpTBVm_6pfqqCRlGbpbMrPsJjyGd0a8nqE,12203
 mlrun/frameworks/sklearn/mlrun_interface.py,sha256=y4RsG_RI4KfPrPADU4Lsr8PF95_VRXJiUX6ez-ljrv0,14054
 mlrun/frameworks/sklearn/model_handler.py,sha256=h2fZGq8y_0okTq9ygsRtVwE3IduNYcUTf8OJyNA2xww,4695
 mlrun/frameworks/sklearn/utils.py,sha256=Cg_pSxUMvKe8vBSLQor6JM8u9_ccKJg4Rk5EPDzTsVo,1209
 mlrun/frameworks/tf_keras/__init__.py,sha256=ZHK6lXdu-DY3yRsP4RPAXlkSbQiDdHHIr3ed6cO0Y7E,10447
-mlrun/frameworks/tf_keras/mlrun_interface.py,sha256=lJsfctAxkdLSiTNzedTdF4KbiPW_nJdnUNUMhk7S2I8,16901
+mlrun/frameworks/tf_keras/mlrun_interface.py,sha256=1xPUv8YAqxrY3CmkMfWMdp2yEAvk5viiMH6qw41ytSk,16617
 mlrun/frameworks/tf_keras/model_handler.py,sha256=2BFrYc7mKLKmEdgPAzBa8c_OnvSHqO9HXv7At3onrlo,28102
 mlrun/frameworks/tf_keras/model_server.py,sha256=64x0nWFGdEONrye5F1socl8KXhMiia_neAoMzXcPF8A,9529
 mlrun/frameworks/tf_keras/utils.py,sha256=_QWk1YmdRybbUB54vsQFE2_WMuAK0g7eR1ozVbMk0Go,4284
 mlrun/frameworks/tf_keras/callbacks/__init__.py,sha256=ufH33gxHF4erP9RCiM8O2YaXLG6btLIU98gCS_MGFjI,844
-mlrun/frameworks/tf_keras/callbacks/logging_callback.py,sha256=_ADceS3uylZQFV0ZwQhA3bnTpCyW3_ayJV_-_8Zaa6c,21993
+mlrun/frameworks/tf_keras/callbacks/logging_callback.py,sha256=bYS4Dhhjv5q3msq97ND7CH5TRYImo6aQOfB41DATGYA,21862
 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py,sha256=RuR4tuPNCAeUC_6z6MEdMc_OzejFs3lEMSxvO5k5mUo,8701
 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py,sha256=bdhMM6ZaCQObhzGry8Sg-uVJ89P7U2nr6RnIQoNDy_Q,28419
 mlrun/frameworks/xgboost/__init__.py,sha256=opkcSxdS4y-FF6EO2KHHmtEqpACk06RU2y6ilnFK-Zc,10276
 mlrun/frameworks/xgboost/mlrun_interface.py,sha256=QcP_mTKBjxvRyWcNnju0BlvXBDOqNH9B1XBoxvEojAk,878
 mlrun/frameworks/xgboost/model_handler.py,sha256=e7IwdrmAaQ5Yy_fqOirN7oi-xEJgg_Gqh83Dw1w-U34,11530
 mlrun/frameworks/xgboost/utils.py,sha256=5zLzHoeI3n2FuA_rdGzi404QCTLfQx1TYEyUWhZogs8,1069
 mlrun/launcher/__init__.py,sha256=JL8qkT1lLr1YvW6iP0hmwDTaSR2RfrMDx0-1gWRhTOE,571
-mlrun/launcher/base.py,sha256=GHEZoxrgW1EIjYu9y6rGKLWwKBxEj6TqZd1ntSJ0CuY,16432
-mlrun/launcher/client.py,sha256=q3bmydSpO2x2Fbgy18W1uvaLbtxzJFlj1Uq6YNVndUU,6048
+mlrun/launcher/base.py,sha256=w7ABf8g-mJVb-zl5Z9mwDxSEvCVqLjqGgpoh2pY8Shg,16425
+mlrun/launcher/client.py,sha256=Vu4JXUtEG9s9B5OH1KkkzCWo3YTG37dRnmSAb2dZ4Ss,6055
 mlrun/launcher/factory.py,sha256=RW7mfzEFi8fR0M-4W1JQg1iq3_muUU6OTqT_3l4Ubrk,2338
 mlrun/launcher/local.py,sha256=6E83lCJ8Ma4WPCQYzo3P6c4tvpIipJsokZ3zMrCORbk,10909
 mlrun/launcher/remote.py,sha256=2DGInyx0um5BRUEA5DYcnLXzVKTIv8JxeXogWdxl48o,7469
 mlrun/model_monitoring/__init__.py,sha256=fS93sGyotiurc2lf1x49JiM3MaN8zm4YxKYN42Ecc4U,859
 mlrun/model_monitoring/api.py,sha256=_prcm5Z3YhENwwFnfTNvWKkLn1eK51jiwyaz687n2z4,29276
 mlrun/model_monitoring/application.py,sha256=w87IuSgkIUXV5T6HpMiWWCsxFoikD6Mk8JpoyoefUCg,12504
 mlrun/model_monitoring/controller.py,sha256=DtrEOHGOlBm2PYPESjo5ea4ubHgUD7eEy0A1YMQPGEY,27745
@@ -246,52 +248,52 @@
 mlrun/package/utils/type_hint_utils.py,sha256=JYrek6vuN3z7e6MGUD3qBLDfQ03C4puZXNTpDSj-VrM,14695
 mlrun/platforms/__init__.py,sha256=ArWn_iZiEE6qz7hvY_1RqMkFnHGuKjP3k5xYKnfKA58,2352
 mlrun/platforms/iguazio.py,sha256=M89zXuCd1bbcIANSy4ec-9evXIs7nPRVo3D0YhKvEtE,19434
 mlrun/platforms/other.py,sha256=T1BibmEBNggM62YJ6oejRmcVv_1besfH5DDHhCaDkRg,11828
 mlrun/projects/__init__.py,sha256=Lv5rfxyXJrw6WGOWJKhBz66M6t3_zsNMCfUD6waPwx4,1153
 mlrun/projects/operations.py,sha256=SiDHd7cqh9u23AVpETbkJE6WmOnB434zBrwM-StZLQY,18538
 mlrun/projects/pipelines.py,sha256=7XsVg13Y2bPK_6SCLC5e22PMnU2DUjscJX2LctSKXN8,40579
-mlrun/projects/project.py,sha256=J9koTyjGvP82xlgXHYJbZnLjtTE9uJElw-8LMQwfujs,166182
-mlrun/runtimes/__init__.py,sha256=tTDfia4cr0gUy2rEtLTj4Nz6M_JJd6utzkFi-ogDvXg,8289
-mlrun/runtimes/base.py,sha256=prqlbGq5fbgQ8atBMjsXhdRY5UqS1egpHtOPaAjhVyI,36683
+mlrun/projects/project.py,sha256=q_YZ4NVCUTB3UsgEf_57kh3_qyc_OSaefO5bfAppcAg,166422
+mlrun/runtimes/__init__.py,sha256=wxt3EZ5ESqld4dF93m-r0E9y0ZeJAn-Y0vppD2lUyqQ,8694
+mlrun/runtimes/base.py,sha256=tM8R7-T-PGvSammpl-nHCVGKW42Vqc8AEmplF4ObHyw,36788
 mlrun/runtimes/constants.py,sha256=oP3OxdYCpbvadJ3zP1JGkqGBKaBheNkCnJISWha9x58,9513
 mlrun/runtimes/daskjob.py,sha256=xvN8ajs3-_voqxrfz6b3rh_idNw4ypRAkPRWGOnDMGA,19149
 mlrun/runtimes/funcdoc.py,sha256=FHwnLfFzoD6yGlsAJXAl_3VTtudgg4fTrsw_XqLOkC0,10508
 mlrun/runtimes/function_reference.py,sha256=iWKRe4r2GTc5S8FOIASYUNLwwne8NqIui51PFr8Q4mg,4918
 mlrun/runtimes/generators.py,sha256=v28HdNgxdHvj888G1dTnUeQZz-D9iTO0hoGeZbCdiuQ,7241
-mlrun/runtimes/kubejob.py,sha256=UfSm7hiPLAtM0TfIE5nbBdSvrbsKWCZfvKP-SZhGyAk,12500
+mlrun/runtimes/kubejob.py,sha256=pqtIkwem7WRrw2DqrOAO8tAmIVJO4-QVof-zmHVt_WA,8641
 mlrun/runtimes/local.py,sha256=u9MhASzF7VRt_yT6_mZPze_hDvAaBxonPk_KafRG3Gg,21783
-mlrun/runtimes/pod.py,sha256=tLnsGln3bmPAK-Mmr4fXfZ4P7IJ9R30Z-zaNhxSk-oE,59908
+mlrun/runtimes/pod.py,sha256=FbqKuAjvOkzFR_ZrsG-SRiQobHmktVUPPPdKzUXw_Kk,65171
 mlrun/runtimes/remotesparkjob.py,sha256=ORkKmZRz_V3YiNE1NF7JIa_hI_LWbKEyI15Qb6R6g5I,7326
-mlrun/runtimes/utils.py,sha256=G4t29elE2PBT7WQZmrEOTIFAJUmeu6zXGEWwgz533vg,16004
+mlrun/runtimes/utils.py,sha256=qvTFIGhn-HQi5uCwhSF5dwYZQ8irPbEJQnPQKpuDt9c,15455
 mlrun/runtimes/databricks_job/__init__.py,sha256=kXGBqhLN0rlAx0kTXhozGzFsIdSqW0uTSKMmsLgq_is,569
 mlrun/runtimes/databricks_job/databricks_cancel_task.py,sha256=sIqIg5DQAf4j0wCPA-G0GoxY6vacRddxCy5KDUZszek,2245
 mlrun/runtimes/databricks_job/databricks_runtime.py,sha256=a9W7A8sboteQov0Z9uVcthEU3FGYFf2cdAsi-vdjH1w,12749
 mlrun/runtimes/databricks_job/databricks_wrapper.py,sha256=-kzz5b3YBit6sGWojjREW_aHHRTx72zzTbxWGxvUplE,8679
 mlrun/runtimes/mpijob/__init__.py,sha256=jZf2uPBv6IB18Jj-dGSQ9NU5_xxni7XS4dnDZGwESFE,1583
 mlrun/runtimes/mpijob/abstract.py,sha256=AqIb-nEKZaRO7x1GxJea6cXg_Tn3Dr4WiWZUz3ywCjU,9161
 mlrun/runtimes/mpijob/v1.py,sha256=_RUlFo_3NcFf7x-QpUNVm8f7qNbRDIdUmPf_ijrv54U,3206
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=w_971wwL03hW_ksgHJXdjTdjhxCs9KJ0zNqHSQ9whIM,1034
 mlrun/runtimes/nuclio/__init__.py,sha256=gx1kizzKv8pGT5TNloN1js1hdbxqDw3rM90sLVYVffY,794
-mlrun/runtimes/nuclio/api_gateway.py,sha256=1fHCHqR5ABlVKJ0al12iIYDSMy2bOTIxnLJPvb4KE9M,15894
-mlrun/runtimes/nuclio/function.py,sha256=7Ax0u760z-ex0yRlztJRrUZcKGXeJNvsXcUAJqjc26w,49044
+mlrun/runtimes/nuclio/api_gateway.py,sha256=3AaKavGqv_Ghj1e8t1RMZDYM92Bqd1C6FO23aSz50Ro,16722
+mlrun/runtimes/nuclio/function.py,sha256=x0ZOeU54tpI8liXDGJP2CMWxMYVmzBiP79TBXWBIpww,49265
 mlrun/runtimes/nuclio/nuclio.py,sha256=sLK8KdGO1LbftlL3HqPZlFOFTAAuxJACZCVl1c0Ha6E,2942
-mlrun/runtimes/nuclio/serving.py,sha256=e0VdJ6zbkurEl9ZlYqGzUaWRUM_US2bE7fpV6RZ83as,29745
+mlrun/runtimes/nuclio/serving.py,sha256=qxMDPYDJ-lkhqWK5dE1EUNhl-fN-pPmuDV9nDnZjD0I,29725
 mlrun/runtimes/nuclio/application/__init__.py,sha256=rRs5vasy_G9IyoTpYIjYDafGoL6ifFBKgBtsXn31Atw,614
-mlrun/runtimes/nuclio/application/application.py,sha256=IxBvE7XcQKgtPWJqib32v6ANigxbK0-yfKC3vq0mjG4,9678
-mlrun/runtimes/nuclio/application/reverse_proxy.go,sha256=RDR2BuO7E87Ek9DYjvEaF5manuxcuVaVY7eZX986GFI,2920
+mlrun/runtimes/nuclio/application/application.py,sha256=c8Z-eFlqcjn9b91xygfwT2ijLvo688p0EaieZlYnzKg,13349
+mlrun/runtimes/nuclio/application/reverse_proxy.go,sha256=JIIYae6bXzCLf3jXuu49KWPQYoXr_FDQ2Rbo1OWKAd0,3150
 mlrun/runtimes/sparkjob/__init__.py,sha256=_KPvk0qefeLtHO6lxQE_AMOGiMTG_OT48eRCE4Z2ldw,709
 mlrun/runtimes/sparkjob/spark3job.py,sha256=yU-PxEI2pDJK5LHXTTcmrdjmO1Jwrj5Zyf8NwPDnZyA,41189
 mlrun/serving/__init__.py,sha256=_6HRAOuS2Ehjo3vwx5h1aI_-JppxEAsl4VfEERAbGFE,1078
 mlrun/serving/merger.py,sha256=PXLn3A21FiLteJHaDSLm5xKNT-80eTTjfHUJnBX1gKY,6116
-mlrun/serving/remote.py,sha256=jLFjMfgPx_PwJkpRHYbKrB9EQZcD4gZ-iczzHl1o0zs,18010
+mlrun/serving/remote.py,sha256=MrFByphQWmIsKXqw-MOwl2Q1hbtWReYVRKvlcKj9pfw,17980
 mlrun/serving/routers.py,sha256=gI4NU41ft16aD8jagI9sUzfHWMknHq8FSt5zxEhAvmQ,55048
-mlrun/serving/server.py,sha256=gs3FATCkCv6Ngke70vNaCWGhONH6IMI4eiuvRwLLMdY,21055
+mlrun/serving/server.py,sha256=p_wYc6KtRF0X-AogrI4R5mGZT9Hy0BBFe2Ulhbi9mw0,21045
 mlrun/serving/serving_wrapper.py,sha256=R670-S6PX_d5ER6jiHtRvacuPyFzQH0mEf2K0sBIIOM,836
-mlrun/serving/states.py,sha256=7_nvFobvT-PIJoegkfXYrMlDD0CC4T66y8TvUytkEGo,56265
+mlrun/serving/states.py,sha256=QHf9YBUlKfqethnHkM3KLmQbYZtFTuL_J3FYg8XOosM,56164
 mlrun/serving/utils.py,sha256=WO0n_YTO0YVPTjp_90zxRl4vey4flDgw5vaOHK5p_qY,3871
 mlrun/serving/v1_serving.py,sha256=by4myxlnwyZ0ijQ5fURilGCK1sUpdQL2Il1VR3Xqpxg,11805
 mlrun/serving/v2_serving.py,sha256=_iFo8uY1n7xZp_YFVgsL6yn9HofY_49A1Bc3cmbL30s,23631
 mlrun/track/__init__.py,sha256=LWRUHJt8JyFW17FyNPOVyWd-NXTf1iptzsK9KFj5fuY,765
 mlrun/track/tracker.py,sha256=y-UdhC2nzM6r-yHCwvrfiHRr93xsr4JRsZTxDrTTRJo,3541
 mlrun/track/tracker_manager.py,sha256=IYBl99I62IC6VCCmG1yt6JoHNOQXa53C4DURJ2sWgio,5726
 mlrun/track/trackers/__init__.py,sha256=9xft8YjJnblwqt8f05htmOt_eDzVBVQN07RfY_SYLCs,569
@@ -316,15 +318,15 @@
 mlrun/utils/notifications/notification/base.py,sha256=gnmhNl59K9h4BGVAk77gVHWw-3kphchRL3Cwm-R0Cp4,2279
 mlrun/utils/notifications/notification/console.py,sha256=leZrjwu3fFA1sCYsTxDXEGZ02SWTUk4GNzp7tT2uaCc,2532
 mlrun/utils/notifications/notification/git.py,sha256=5pJs3LFzuz2h3JO9vAGo3BL00-WZFdUcCaO2XaZh-1I,5221
 mlrun/utils/notifications/notification/ipython.py,sha256=d47s-fW4TgqOJZOSdmzBQvdh2oDHoFw-ENLgNcAQSWU,1955
 mlrun/utils/notifications/notification/slack.py,sha256=5JysqIpUYUZKXPSeeZtbl7qb2L9dj7p2NvnEBcEsZkA,3898
 mlrun/utils/notifications/notification/webhook.py,sha256=QHezCuN5uXkLcroAGxGrhGHaxAdUvkDLIsp27_Yrfd4,2390
 mlrun/utils/version/__init__.py,sha256=7kkrB7hEZ3cLXoWj1kPoDwo4MaswsI2JVOBpbKgPAgc,614
-mlrun/utils/version/version.json,sha256=xDSX9YaznNhRyrGomc1_tfWTpIgN3RYMWgZyvWebdI8,88
+mlrun/utils/version/version.json,sha256=hMZfkBZNV7bXR26LToYw10atC63hcMuPKlpAj3SWzTw,88
 mlrun/utils/version/version.py,sha256=eEW0tqIAkU9Xifxv8Z9_qsYnNhn3YH7NRAfM-pPLt1g,1878
-mlrun-1.7.0rc8.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.7.0rc8.dist-info/METADATA,sha256=5byWUNhTGutxXLa0EZduzJTgQIWsetUN15lEyF57N4E,18799
-mlrun-1.7.0rc8.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-mlrun-1.7.0rc8.dist-info/entry_points.txt,sha256=1Owd16eAclD5pfRCoJpYC2ZJSyGNTtUr0nCELMioMmU,46
-mlrun-1.7.0rc8.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.7.0rc8.dist-info/RECORD,,
+mlrun-1.7.0rc9.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.7.0rc9.dist-info/METADATA,sha256=EhbOULGXLXGV3PkRCbAcsQFEMQkkwLOfyYFYve24Jvs,18799
+mlrun-1.7.0rc9.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+mlrun-1.7.0rc9.dist-info/entry_points.txt,sha256=1Owd16eAclD5pfRCoJpYC2ZJSyGNTtUr0nCELMioMmU,46
+mlrun-1.7.0rc9.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.7.0rc9.dist-info/RECORD,,
```

