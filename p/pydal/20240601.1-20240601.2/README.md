# Comparing `tmp/pydal-20240601.1.tar.gz` & `tmp/pydal-20240601.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pydal-20240601.1.tar", last modified: Sun Jun  2 04:29:57 2024, max compression
+gzip compressed data, was "pydal-20240601.2.tar", last modified: Sun Jun  2 05:50:46 2024, max compression
```

## Comparing `pydal-20240601.1.tar` & `pydal-20240601.2.tar`

### file list

```diff
@@ -1,154 +1,154 @@
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.862163 pydal-20240601.1/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      344 2022-10-17 00:44:46.000000 pydal-20240601.1/AUTHORS
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6546 2022-10-17 00:44:46.000000 pydal-20240601.1/CHANGES
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1555 2022-10-17 00:44:46.000000 pydal-20240601.1/LICENSE.txt
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      170 2022-11-11 06:37:56.000000 pydal-20240601.1/MANIFEST.in
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2903 2024-06-02 04:29:57.862163 pydal-20240601.1/PKG-INFO
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2034 2022-10-17 00:44:46.000000 pydal-20240601.1/README.md
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.828829 pydal-20240601.1/docs/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6758 2022-10-17 00:44:46.000000 pydal-20240601.1/docs/Makefile
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8083 2023-05-07 23:00:04.000000 pydal-20240601.1/docs/conf.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      833 2022-10-17 00:44:46.000000 pydal-20240601.1/docs/index.rst
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2834 2022-10-17 00:44:46.000000 pydal-20240601.1/docs/pydal.adapters.rst
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      664 2022-10-17 00:44:46.000000 pydal-20240601.1/docs/pydal.helpers.rst
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       29 2022-10-17 00:44:46.000000 pydal-20240601.1/docs/requirements.txt
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.832162 pydal-20240601.1/pydal/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      179 2024-06-02 04:29:34.000000 pydal-20240601.1/pydal/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5440 2023-11-15 07:07:33.000000 pydal-20240601.1/pydal/_compat.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      466 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/_gae.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      208 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/_globals.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      396 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/_load.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.838829 pydal-20240601.1/pydal/adapters/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2372 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38911 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/adapters/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5691 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/couchdb.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2000 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/db2.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3145 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/firebird.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    18365 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/google.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2076 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/informix.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1882 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/ingres.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    37772 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/mongo.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6161 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/mssql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3412 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/mysql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9172 2023-11-12 03:29:21.000000 pydal-20240601.1/pydal/adapters/oracle.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9327 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/postgres.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1460 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/sap.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4894 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/snowflake.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4392 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/sqlite.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      799 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/adapters/teradata.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38529 2023-12-28 08:14:12.000000 pydal-20240601.1/pydal/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6427 2023-05-07 22:57:59.000000 pydal-20240601.1/pydal/connection.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.838829 pydal-20240601.1/pydal/contrib/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/contrib/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    44546 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/contrib/imap_adapter.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    79360 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/contrib/ipaddress.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    10686 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/contrib/mockimaplib.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4071 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/contrib/ordereddict.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5584 2023-05-07 22:58:06.000000 pydal-20240601.1/pydal/contrib/portalocker.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    33372 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/contrib/reserved_sql_keywords.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3532 2023-05-07 22:58:07.000000 pydal-20240601.1/pydal/default_validators.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.842163 pydal-20240601.1/pydal/dialects/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3803 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    23464 2023-05-07 22:58:13.000000 pydal-20240601.1/pydal/dialects/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1390 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/couchdb.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3374 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/db2.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4307 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/firebird.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5953 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/google.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3275 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/informix.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3929 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/ingres.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    22110 2023-05-07 22:58:11.000000 pydal-20240601.1/pydal/dialects/mongo.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    15763 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/dialects/mssql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3413 2023-05-07 22:51:50.000000 pydal-20240601.1/pydal/dialects/mysql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8928 2023-05-07 22:58:13.000000 pydal-20240601.1/pydal/dialects/oracle.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14406 2023-11-12 03:31:51.000000 pydal-20240601.1/pydal/dialects/postgre.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3001 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/sap.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12077 2023-05-07 22:58:18.000000 pydal-20240601.1/pydal/dialects/snowflake.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4295 2023-05-07 22:52:12.000000 pydal-20240601.1/pydal/dialects/sqlite.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3400 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/dialects/teradata.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3180 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/drivers.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      347 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/exceptions.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.845496 pydal-20240601.1/pydal/helpers/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      652 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/_internals.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    16544 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/helpers/classes.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      971 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/gae.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14816 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/helpers/methods.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1144 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/regex.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    16447 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/rest.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1839 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/helpers/serializers.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    27287 2023-05-07 22:58:25.000000 pydal-20240601.1/pydal/migrator.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   130609 2024-06-02 02:44:27.000000 pydal-20240601.1/pydal/objects.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.848829 pydal-20240601.1/pydal/parsers/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3394 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4718 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      360 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/google.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1605 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/mongo.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1654 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/oracle.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      815 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/parsers/postgre.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1043 2023-11-15 07:07:34.000000 pydal-20240601.1/pydal/parsers/sqlite.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.848829 pydal-20240601.1/pydal/representers/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8806 2023-11-15 07:07:35.000000 pydal-20240601.1/pydal/representers/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8793 2023-11-15 07:07:35.000000 pydal-20240601.1/pydal/representers/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1210 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/couchdb.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      680 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/db2.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1446 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/google.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      884 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/informix.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1757 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/mongo.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      948 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/mssql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      214 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/mysql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1286 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/oracle.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1643 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/postgre.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      752 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/representers/sqlite.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    22855 2023-11-15 07:07:35.000000 pydal-20240601.1/pydal/restapi.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.852163 pydal-20240601.1/pydal/tools/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/tools/__init__.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    15007 2024-06-02 03:10:30.000000 pydal-20240601.1/pydal/tools/scheduler.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2120 2023-11-15 06:54:34.000000 pydal-20240601.1/pydal/tools/tags.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1904 2022-10-17 00:44:46.000000 pydal-20240601.1/pydal/utils.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   160782 2024-06-02 04:27:43.000000 pydal-20240601.1/pydal/validators.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.835496 pydal-20240601.1/pydal.egg-info/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2903 2024-06-02 04:29:57.000000 pydal-20240601.1/pydal.egg-info/PKG-INFO
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3595 2024-06-02 04:29:57.000000 pydal-20240601.1/pydal.egg-info/SOURCES.txt
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2024-06-02 04:29:57.000000 pydal-20240601.1/pydal.egg-info/dependency_links.txt
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        6 2024-06-02 04:29:57.000000 pydal-20240601.1/pydal.egg-info/top_level.txt
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      905 2024-06-02 04:29:20.000000 pydal-20240601.1/pyproject.toml
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       99 2024-06-02 04:29:57.862163 pydal-20240601.1/setup.cfg
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.855496 pydal-20240601.1/tests/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      380 2024-06-02 04:28:09.000000 pydal-20240601.1/tests/__init__.py
-drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 04:29:57.862163 pydal-20240601.1/tests/__pycache__/
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      662 2024-06-02 04:28:11.000000 pydal-20240601.1/tests/__pycache__/__init__.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1654 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/_adapt.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      305 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/_compat.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2003 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/_helpers.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    17052 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/base.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6523 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/caching.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12218 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/contribs.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5671 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/indexes.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38722 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/is_url_validators.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    10851 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/restapi.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4801 2024-06-02 04:26:22.000000 pydal-20240601.1/tests/__pycache__/scheduler.cpython-311-pytest-8.2.1.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4666 2024-06-02 04:28:11.000000 pydal-20240601.1/tests/__pycache__/scheduler.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     7660 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/smart_query.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   283906 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/sql.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2560 2024-05-30 06:17:49.000000 pydal-20240601.1/tests/__pycache__/tags.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9720 2024-05-30 06:37:38.000000 pydal-20240601.1/tests/__pycache__/validation.cpython-311-pytest-8.2.1.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9585 2024-05-30 06:52:14.000000 pydal-20240601.1/tests/__pycache__/validation.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   108882 2024-06-02 04:26:31.000000 pydal-20240601.1/tests/__pycache__/validators.cpython-311-pytest-8.2.1.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   103228 2024-06-02 04:28:11.000000 pydal-20240601.1/tests/__pycache__/validators.cpython-311.pyc
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      954 2022-10-17 00:44:46.000000 pydal-20240601.1/tests/_adapt.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       95 2022-10-17 00:44:46.000000 pydal-20240601.1/tests/_compat.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      765 2023-05-07 23:00:04.000000 pydal-20240601.1/tests/_helpers.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8103 2023-11-15 07:07:11.000000 pydal-20240601.1/tests/base.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2554 2023-05-07 23:00:03.000000 pydal-20240601.1/tests/caching.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4954 2023-11-15 07:07:11.000000 pydal-20240601.1/tests/contribs.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2279 2023-05-07 23:00:03.000000 pydal-20240601.1/tests/indexes.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    29359 2023-11-15 07:07:11.000000 pydal-20240601.1/tests/is_url_validators.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    99826 2023-11-15 07:07:14.000000 pydal-20240601.1/tests/nosql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14072 2023-11-15 07:07:11.000000 pydal-20240601.1/tests/restapi.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2552 2024-06-02 03:11:01.000000 pydal-20240601.1/tests/scheduler.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2529 2024-06-02 03:06:09.000000 pydal-20240601.1/tests/scheduler.py~
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12552 2023-05-07 23:00:04.000000 pydal-20240601.1/tests/smart_query.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   137750 2023-11-15 07:07:15.000000 pydal-20240601.1/tests/sql.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      990 2023-05-07 23:00:04.000000 pydal-20240601.1/tests/tags.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5270 2024-05-30 06:37:37.000000 pydal-20240601.1/tests/validation.py
--rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    68332 2024-06-02 04:27:52.000000 pydal-20240601.1/tests/validators.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.567199 pydal-20240601.2/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      344 2022-10-17 00:44:46.000000 pydal-20240601.2/AUTHORS
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6546 2022-10-17 00:44:46.000000 pydal-20240601.2/CHANGES
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1555 2022-10-17 00:44:46.000000 pydal-20240601.2/LICENSE.txt
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      170 2022-11-11 06:37:56.000000 pydal-20240601.2/MANIFEST.in
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2903 2024-06-02 05:50:46.567199 pydal-20240601.2/PKG-INFO
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2034 2022-10-17 00:44:46.000000 pydal-20240601.2/README.md
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.530531 pydal-20240601.2/docs/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6758 2022-10-17 00:44:46.000000 pydal-20240601.2/docs/Makefile
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8083 2023-05-07 23:00:04.000000 pydal-20240601.2/docs/conf.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      833 2022-10-17 00:44:46.000000 pydal-20240601.2/docs/index.rst
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2834 2022-10-17 00:44:46.000000 pydal-20240601.2/docs/pydal.adapters.rst
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      664 2022-10-17 00:44:46.000000 pydal-20240601.2/docs/pydal.helpers.rst
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       29 2022-10-17 00:44:46.000000 pydal-20240601.2/docs/requirements.txt
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.537198 pydal-20240601.2/pydal/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      179 2024-06-02 05:50:18.000000 pydal-20240601.2/pydal/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5440 2023-11-15 07:07:33.000000 pydal-20240601.2/pydal/_compat.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      466 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/_gae.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      208 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/_globals.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      396 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/_load.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.540531 pydal-20240601.2/pydal/adapters/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2372 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38911 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/adapters/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5691 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/couchdb.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2000 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/db2.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3145 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/firebird.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    18365 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/google.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2076 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/informix.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1882 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/ingres.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    37772 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/mongo.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6161 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/mssql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3412 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/mysql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9172 2023-11-12 03:29:21.000000 pydal-20240601.2/pydal/adapters/oracle.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9327 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/postgres.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1460 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/sap.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4894 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/snowflake.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4392 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/sqlite.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      799 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/adapters/teradata.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38529 2023-12-28 08:14:12.000000 pydal-20240601.2/pydal/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6427 2023-05-07 22:57:59.000000 pydal-20240601.2/pydal/connection.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.543865 pydal-20240601.2/pydal/contrib/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/contrib/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    44546 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/contrib/imap_adapter.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    79360 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/contrib/ipaddress.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    10686 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/contrib/mockimaplib.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4071 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/contrib/ordereddict.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5584 2023-05-07 22:58:06.000000 pydal-20240601.2/pydal/contrib/portalocker.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    33372 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/contrib/reserved_sql_keywords.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3532 2023-05-07 22:58:07.000000 pydal-20240601.2/pydal/default_validators.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.547198 pydal-20240601.2/pydal/dialects/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3803 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    23464 2023-05-07 22:58:13.000000 pydal-20240601.2/pydal/dialects/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1390 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/couchdb.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3374 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/db2.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4307 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/firebird.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5953 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/google.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3275 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/informix.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3929 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/ingres.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    22110 2023-05-07 22:58:11.000000 pydal-20240601.2/pydal/dialects/mongo.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    15763 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/dialects/mssql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3413 2023-05-07 22:51:50.000000 pydal-20240601.2/pydal/dialects/mysql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8928 2023-05-07 22:58:13.000000 pydal-20240601.2/pydal/dialects/oracle.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14406 2023-11-12 03:31:51.000000 pydal-20240601.2/pydal/dialects/postgre.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3001 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/sap.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12077 2023-05-07 22:58:18.000000 pydal-20240601.2/pydal/dialects/snowflake.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4295 2023-05-07 22:52:12.000000 pydal-20240601.2/pydal/dialects/sqlite.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3400 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/dialects/teradata.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3180 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/drivers.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      347 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/exceptions.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.550531 pydal-20240601.2/pydal/helpers/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      652 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/_internals.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    16544 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/helpers/classes.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      971 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/gae.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14816 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/helpers/methods.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1144 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/regex.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    16447 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/rest.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1839 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/helpers/serializers.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    27287 2023-05-07 22:58:25.000000 pydal-20240601.2/pydal/migrator.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   130609 2024-06-02 02:44:27.000000 pydal-20240601.2/pydal/objects.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.550531 pydal-20240601.2/pydal/parsers/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3394 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4718 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      360 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/google.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1605 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/mongo.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1654 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/oracle.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      815 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/parsers/postgre.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1043 2023-11-15 07:07:34.000000 pydal-20240601.2/pydal/parsers/sqlite.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.553865 pydal-20240601.2/pydal/representers/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8806 2023-11-15 07:07:35.000000 pydal-20240601.2/pydal/representers/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8793 2023-11-15 07:07:35.000000 pydal-20240601.2/pydal/representers/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1210 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/couchdb.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      680 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/db2.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1446 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/google.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      884 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/informix.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1757 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/mongo.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      948 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/mssql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      214 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/mysql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1286 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/oracle.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1643 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/postgre.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      752 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/representers/sqlite.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    22855 2023-11-15 07:07:35.000000 pydal-20240601.2/pydal/restapi.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.557198 pydal-20240601.2/pydal/tools/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/tools/__init__.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    15018 2024-06-02 05:49:16.000000 pydal-20240601.2/pydal/tools/scheduler.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2120 2023-11-15 06:54:34.000000 pydal-20240601.2/pydal/tools/tags.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1904 2022-10-17 00:44:46.000000 pydal-20240601.2/pydal/utils.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   160827 2024-06-02 05:38:39.000000 pydal-20240601.2/pydal/validators.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.537198 pydal-20240601.2/pydal.egg-info/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2903 2024-06-02 05:50:46.000000 pydal-20240601.2/pydal.egg-info/PKG-INFO
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     3595 2024-06-02 05:50:46.000000 pydal-20240601.2/pydal.egg-info/SOURCES.txt
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        1 2024-06-02 05:50:46.000000 pydal-20240601.2/pydal.egg-info/dependency_links.txt
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)        6 2024-06-02 05:50:46.000000 pydal-20240601.2/pydal.egg-info/top_level.txt
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      905 2024-06-02 05:50:07.000000 pydal-20240601.2/pyproject.toml
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       99 2024-06-02 05:50:46.567199 pydal-20240601.2/setup.cfg
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.560532 pydal-20240601.2/tests/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      380 2024-06-02 04:28:09.000000 pydal-20240601.2/tests/__init__.py
+drwxr-xr-x   0 mdipierro  (1000) mdipierro  (1000)        0 2024-06-02 05:50:46.567199 pydal-20240601.2/tests/__pycache__/
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      662 2024-06-02 04:28:11.000000 pydal-20240601.2/tests/__pycache__/__init__.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     1654 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/_adapt.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      305 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/_compat.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2003 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/_helpers.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    17052 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/base.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     6523 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/caching.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12218 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/contribs.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5671 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/indexes.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    38722 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/is_url_validators.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    10851 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/restapi.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4801 2024-06-02 04:26:22.000000 pydal-20240601.2/tests/__pycache__/scheduler.cpython-311-pytest-8.2.1.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4666 2024-06-02 04:28:11.000000 pydal-20240601.2/tests/__pycache__/scheduler.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     7660 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/smart_query.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   283906 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/sql.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2560 2024-05-30 06:17:49.000000 pydal-20240601.2/tests/__pycache__/tags.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9720 2024-05-30 06:37:38.000000 pydal-20240601.2/tests/__pycache__/validation.cpython-311-pytest-8.2.1.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     9585 2024-05-30 06:52:14.000000 pydal-20240601.2/tests/__pycache__/validation.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   108882 2024-06-02 04:26:31.000000 pydal-20240601.2/tests/__pycache__/validators.cpython-311-pytest-8.2.1.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   103228 2024-06-02 04:28:11.000000 pydal-20240601.2/tests/__pycache__/validators.cpython-311.pyc
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      954 2022-10-17 00:44:46.000000 pydal-20240601.2/tests/_adapt.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)       95 2022-10-17 00:44:46.000000 pydal-20240601.2/tests/_compat.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      765 2023-05-07 23:00:04.000000 pydal-20240601.2/tests/_helpers.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     8103 2023-11-15 07:07:11.000000 pydal-20240601.2/tests/base.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2554 2023-05-07 23:00:03.000000 pydal-20240601.2/tests/caching.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     4954 2023-11-15 07:07:11.000000 pydal-20240601.2/tests/contribs.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2279 2023-05-07 23:00:03.000000 pydal-20240601.2/tests/indexes.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    29359 2023-11-15 07:07:11.000000 pydal-20240601.2/tests/is_url_validators.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    99826 2023-11-15 07:07:14.000000 pydal-20240601.2/tests/nosql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    14072 2023-11-15 07:07:11.000000 pydal-20240601.2/tests/restapi.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2552 2024-06-02 03:11:01.000000 pydal-20240601.2/tests/scheduler.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     2529 2024-06-02 03:06:09.000000 pydal-20240601.2/tests/scheduler.py~
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    12552 2023-05-07 23:00:04.000000 pydal-20240601.2/tests/smart_query.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)   137750 2023-11-15 07:07:15.000000 pydal-20240601.2/tests/sql.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)      990 2023-05-07 23:00:04.000000 pydal-20240601.2/tests/tags.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)     5270 2024-05-30 06:37:37.000000 pydal-20240601.2/tests/validation.py
+-rw-r--r--   0 mdipierro  (1000) mdipierro  (1000)    68332 2024-06-02 04:27:52.000000 pydal-20240601.2/tests/validators.py
```

### Comparing `pydal-20240601.1/CHANGES` & `pydal-20240601.2/CHANGES`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/LICENSE.txt` & `pydal-20240601.2/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/PKG-INFO` & `pydal-20240601.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pydal
-Version: 20240601.1
+Version: 20240601.2
 Summary: pyDAL is a Database Abstraction Layer. It generates queries for SQlite, PotsgreSQL, MySQL, and other backends. It was originally part of the web2py frameworks but it is now an independent project. Example: db.define_table("thing",Field("name")) and db.thing.insert(name="Pizza")
 Author-email: Massimo Di Pierro <massimo.dipierro@gmail.com>
 Project-URL: Homepage, https://github.com/web2py/pydal
 Project-URL: Bug Tracker, https://github.com/web2py/pydal/issues
 Project-URL: Documentation, https://py4web.com/_documentation/static/en/chapter-07.html
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: BSD License
```

### Comparing `pydal-20240601.1/README.md` & `pydal-20240601.2/README.md`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/docs/Makefile` & `pydal-20240601.2/docs/Makefile`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/docs/conf.py` & `pydal-20240601.2/docs/conf.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/docs/index.rst` & `pydal-20240601.2/docs/index.rst`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/docs/pydal.adapters.rst` & `pydal-20240601.2/docs/pydal.adapters.rst`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/docs/pydal.helpers.rst` & `pydal-20240601.2/docs/pydal.helpers.rst`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/_compat.py` & `pydal-20240601.2/pydal/_compat.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/__init__.py` & `pydal-20240601.2/pydal/adapters/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/base.py` & `pydal-20240601.2/pydal/adapters/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/couchdb.py` & `pydal-20240601.2/pydal/adapters/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/db2.py` & `pydal-20240601.2/pydal/adapters/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/firebird.py` & `pydal-20240601.2/pydal/adapters/firebird.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/google.py` & `pydal-20240601.2/pydal/adapters/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/informix.py` & `pydal-20240601.2/pydal/adapters/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/ingres.py` & `pydal-20240601.2/pydal/adapters/ingres.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/mongo.py` & `pydal-20240601.2/pydal/adapters/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/mssql.py` & `pydal-20240601.2/pydal/adapters/mssql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/mysql.py` & `pydal-20240601.2/pydal/adapters/mysql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/oracle.py` & `pydal-20240601.2/pydal/adapters/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/postgres.py` & `pydal-20240601.2/pydal/adapters/postgres.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/sap.py` & `pydal-20240601.2/pydal/adapters/sap.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/snowflake.py` & `pydal-20240601.2/pydal/adapters/snowflake.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/sqlite.py` & `pydal-20240601.2/pydal/adapters/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/adapters/teradata.py` & `pydal-20240601.2/pydal/adapters/teradata.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/base.py` & `pydal-20240601.2/pydal/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/connection.py` & `pydal-20240601.2/pydal/connection.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/imap_adapter.py` & `pydal-20240601.2/pydal/contrib/imap_adapter.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/ipaddress.py` & `pydal-20240601.2/pydal/contrib/ipaddress.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/mockimaplib.py` & `pydal-20240601.2/pydal/contrib/mockimaplib.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/ordereddict.py` & `pydal-20240601.2/pydal/contrib/ordereddict.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/portalocker.py` & `pydal-20240601.2/pydal/contrib/portalocker.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/contrib/reserved_sql_keywords.py` & `pydal-20240601.2/pydal/contrib/reserved_sql_keywords.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/default_validators.py` & `pydal-20240601.2/pydal/default_validators.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/__init__.py` & `pydal-20240601.2/pydal/dialects/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/base.py` & `pydal-20240601.2/pydal/dialects/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/couchdb.py` & `pydal-20240601.2/pydal/dialects/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/db2.py` & `pydal-20240601.2/pydal/dialects/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/firebird.py` & `pydal-20240601.2/pydal/dialects/firebird.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/google.py` & `pydal-20240601.2/pydal/dialects/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/informix.py` & `pydal-20240601.2/pydal/dialects/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/ingres.py` & `pydal-20240601.2/pydal/dialects/ingres.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/mongo.py` & `pydal-20240601.2/pydal/dialects/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/mssql.py` & `pydal-20240601.2/pydal/dialects/mssql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/mysql.py` & `pydal-20240601.2/pydal/dialects/mysql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/oracle.py` & `pydal-20240601.2/pydal/dialects/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/postgre.py` & `pydal-20240601.2/pydal/dialects/postgre.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/sap.py` & `pydal-20240601.2/pydal/dialects/sap.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/snowflake.py` & `pydal-20240601.2/pydal/dialects/snowflake.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/sqlite.py` & `pydal-20240601.2/pydal/dialects/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/dialects/teradata.py` & `pydal-20240601.2/pydal/dialects/teradata.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/drivers.py` & `pydal-20240601.2/pydal/drivers.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/_internals.py` & `pydal-20240601.2/pydal/helpers/_internals.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/classes.py` & `pydal-20240601.2/pydal/helpers/classes.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/gae.py` & `pydal-20240601.2/pydal/helpers/gae.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/methods.py` & `pydal-20240601.2/pydal/helpers/methods.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/regex.py` & `pydal-20240601.2/pydal/helpers/regex.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/rest.py` & `pydal-20240601.2/pydal/helpers/rest.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/helpers/serializers.py` & `pydal-20240601.2/pydal/helpers/serializers.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/migrator.py` & `pydal-20240601.2/pydal/migrator.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/objects.py` & `pydal-20240601.2/pydal/objects.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/__init__.py` & `pydal-20240601.2/pydal/parsers/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/base.py` & `pydal-20240601.2/pydal/parsers/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/mongo.py` & `pydal-20240601.2/pydal/parsers/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/oracle.py` & `pydal-20240601.2/pydal/parsers/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/postgre.py` & `pydal-20240601.2/pydal/parsers/postgre.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/parsers/sqlite.py` & `pydal-20240601.2/pydal/parsers/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/__init__.py` & `pydal-20240601.2/pydal/representers/__init__.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/base.py` & `pydal-20240601.2/pydal/representers/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/couchdb.py` & `pydal-20240601.2/pydal/representers/couchdb.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/db2.py` & `pydal-20240601.2/pydal/representers/db2.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/google.py` & `pydal-20240601.2/pydal/representers/google.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/informix.py` & `pydal-20240601.2/pydal/representers/informix.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/mongo.py` & `pydal-20240601.2/pydal/representers/mongo.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/mssql.py` & `pydal-20240601.2/pydal/representers/mssql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/oracle.py` & `pydal-20240601.2/pydal/representers/oracle.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/postgre.py` & `pydal-20240601.2/pydal/representers/postgre.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/representers/sqlite.py` & `pydal-20240601.2/pydal/representers/sqlite.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/restapi.py` & `pydal-20240601.2/pydal/restapi.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/tools/scheduler.py` & `pydal-20240601.2/pydal/tools/scheduler.py`

 * *Files 7% similar despite different names*

```diff
@@ -38,21 +38,21 @@
     os.chdir(cwd)
     # os.setsid()
     os.umask(0)
     # do second fork
     if os.fork():
         sys.exit(0)
     # redirect standard file descriptors
-    sys.stdout.flush()
-    sys.stderr.flush()
+    sys.__stdout__.flush()
+    sys.__stderr__.flush()
     with open(os.devnull, "rb") as stream_in:
-        os.dup2(stream_in.fileno(), sys.stdin.fileno())
+        os.dup2(stream_in.fileno(), sys.__stdin__.fileno())
         with open(filename, "wb") as stream_out:
-            os.dup2(stream_out.fileno(), sys.stdout.fileno())
-            os.dup2(stream_out.fileno(), sys.stderr.fileno())
+            os.dup2(stream_out.fileno(), sys.__stdout__.fileno())
+            os.dup2(stream_out.fileno(), sys.__stderr__.fileno())
             try:
                 func()
             finally:
                 stream_out.flush()
     sys.exit(0)
 
 
@@ -65,15 +65,15 @@
         return False
 
 
 def get_logger(name, log_format="[%(asctime)s]%(levelname)s %(message)s"):
     """Get a default logger"""
     logger = logging.getLogger(name)
     logger.setLevel(logging.INFO)
-    handler = logging.StreamHandler(sys.stdout)
+    handler = logging.StreamHandler(sys.__stdout__)
     handler.setFormatter(logging.Formatter(log_format))
     logger.addHandler(handler)
     return logger
 
 
 class Scheduler:  # pylint: disable=too-many-instance-attributes
     """Makes a scheduler"""
@@ -246,15 +246,15 @@
         return True
 
     def next_run(self):
         """Returns the next run ready to be executed"""
         db = self.db
         # find the next task to execute
         nruns = db(db.task_run.worker == None)(db.task_run.scheduled_for <= now())
-        orderby = ~db.task_run.priority | db.task_run.queued_on
+        orderby = db.task_run.priority | db.task_run.id
         run = nruns.select(orderby=orderby, limitby=(0, 1)).first()
         self.logger.info("run found #%s %s", run and run.id, run and run.name)
         if run:
             # try assign the run to self if no other process stole it
             try:
                 if (
                     nruns(db.task_run.id == run.id).update(
@@ -350,17 +350,17 @@
         """Register a new task, given a name and a function"""
         self.tasks[task_name] = function
 
     def enqueue_run(
         self,
         name,
         description="",
-        inputs=None,
-        timeout=None,
-        priority=None,
+        inputs={},
+        timeout=3600,
+        priority=0,
         period=None,
         scheduled_for=None,
     ):
         """Stores a new db.task_run"""
         db = self.db
         assert name in set(dict(db.task_run.name.requires.options()))
         assert inputs is None or isinstance(inputs, dict)
```

### Comparing `pydal-20240601.1/pydal/tools/tags.py` & `pydal-20240601.2/pydal/tools/tags.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/utils.py` & `pydal-20240601.2/pydal/utils.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pydal/validators.py` & `pydal-20240601.2/pydal/validators.py`

 * *Files 0% similar despite different names*

```diff
@@ -2289,7761 +2289,7764 @@
 00008f00: 653d 2265 7272 6f72 2229 3a0a 2020 2020  e="error"):.    
 00008f10: 2020 2020 7365 6c66 2e73 616e 6974 697a      self.sanitiz
 00008f20: 6572 203d 2073 616e 6974 697a 6572 206f  er = sanitizer o
 00008f30: 7220 4953 5f53 4146 452e 6465 6661 756c  r IS_SAFE.defaul
 00008f40: 745f 7361 6e69 7469 7a65 720a 2020 2020  t_sanitizer.    
 00008f50: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
 00008f60: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
-00008f70: 6573 7361 6765 0a20 2020 2020 2020 2073  essage.        s
-00008f80: 656c 662e 6d6f 6465 203d 206d 6f64 650a  elf.mode = mode.
-00008f90: 0a20 2020 2064 6566 2076 616c 6964 6174  .    def validat
-00008fa0: 6528 7365 6c66 2c20 7661 6c75 652c 2072  e(self, value, r
-00008fb0: 6563 6f72 645f 6964 3d4e 6f6e 6529 3a0a  ecord_id=None):.
-00008fc0: 2020 2020 2020 2020 7361 6e69 7469 7a65          sanitize
-00008fd0: 645f 7661 6c75 6520 3d20 7365 6c66 2e73  d_value = self.s
-00008fe0: 616e 6974 697a 6572 2876 616c 7565 290a  anitizer(value).
-00008ff0: 2020 2020 2020 2020 6966 2073 616e 6974          if sanit
-00009000: 697a 6564 5f76 616c 7565 2021 3d20 7661  ized_value != va
-00009010: 6c75 6520 616e 6420 7365 6c66 2e6d 6f64  lue and self.mod
-00009020: 6520 3d3d 2022 6572 726f 7222 3a0a 2020  e == "error":.  
-00009030: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00009040: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
-00009050: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-00009060: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
-00009070: 6765 2929 0a20 2020 2020 2020 2072 6574  ge)).        ret
-00009080: 7572 6e20 7361 6e69 7469 7a65 645f 7661  urn sanitized_va
-00009090: 6c75 650a 0a20 2020 2064 6566 6175 6c74  lue..    default
-000090a0: 5f72 6567 6578 203d 2072 652e 636f 6d70  _regex = re.comp
-000090b0: 696c 6528 0a20 2020 2020 2020 2072 2228  ile(.        r"(
-000090c0: 3c5c 732a 2f3f 2873 6372 6970 747c 656d  <\s*/?(script|em
-000090d0: 6265 647c 6f62 6a65 6374 7c69 6672 616d  bed|object|ifram
-000090e0: 657c 7465 7874 6172 6561 7c69 6e70 7574  e|textarea|input
-000090f0: 7c62 7574 746f 6e29 2e2a 3e29 7c28 3c5b  |button).*>)|(<[
-00009100: 5e3e 5d2b 206f 6e5c 772b 5b5e 3e5d 2b3e  ^>]+ on\w+[^>]+>
-00009110: 2922 2c0a 2020 2020 2020 2020 7265 2e49  )",.        re.I
-00009120: 474e 4f52 4543 4153 4520 7c20 7265 2e44  GNORECASE | re.D
-00009130: 4f54 414c 4c2c 0a20 2020 2029 0a0a 2020  OTALL,.    )..  
-00009140: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00009150: 2020 2020 6465 6620 6465 6661 756c 745f      def default_
-00009160: 7361 6e69 7469 7a65 7228 7465 7874 293a  sanitizer(text):
-00009170: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009180: 4953 5f53 4146 452e 6465 6661 756c 745f  IS_SAFE.default_
-00009190: 7265 6765 782e 7375 6228 2222 2c20 7465  regex.sub("", te
-000091a0: 7874 290a 0a0a 636c 6173 7320 4953 5f41  xt)...class IS_A
-000091b0: 4c50 4841 4e55 4d45 5249 4328 4953 5f4d  LPHANUMERIC(IS_M
-000091c0: 4154 4348 293a 0a20 2020 2022 2222 0a20  ATCH):.    """. 
-000091d0: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-000091e0: 2020 2020 5573 6564 2061 733a 3a0a 0a20      Used as::.. 
-000091f0: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
-00009200: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
-00009210: 6e61 6d65 3d27 6e61 6d65 272c 2072 6571  name='name', req
-00009220: 7569 7265 733d 4953 5f41 4c50 4841 4e55  uires=IS_ALPHANU
-00009230: 4d45 5249 4328 2929 0a0a 2020 2020 2020  MERIC())..      
-00009240: 2020 2020 2020 3e3e 3e20 4953 5f41 4c50        >>> IS_ALP
-00009250: 4841 4e55 4d45 5249 4328 2928 2731 2729  HANUMERIC()('1')
-00009260: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
-00009270: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00009280: 2020 2020 203e 3e3e 2049 535f 414c 5048       >>> IS_ALPH
-00009290: 414e 554d 4552 4943 2829 2827 2729 0a20  ANUMERIC()(''). 
-000092a0: 2020 2020 2020 2020 2020 2028 2727 2c20             ('', 
-000092b0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-000092c0: 2020 3e3e 3e20 4953 5f41 4c50 4841 4e55    >>> IS_ALPHANU
-000092d0: 4d45 5249 4328 2928 2741 5f61 2729 0a20  MERIC()('A_a'). 
-000092e0: 2020 2020 2020 2020 2020 2028 2741 5f61             ('A_a
-000092f0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00009300: 2020 2020 203e 3e3e 2049 535f 414c 5048       >>> IS_ALPH
-00009310: 414e 554d 4552 4943 2829 2827 2127 290a  ANUMERIC()('!').
-00009320: 2020 2020 2020 2020 2020 2020 2827 2127              ('!'
-00009330: 2c20 2765 6e74 6572 206f 6e6c 7920 6c65  , 'enter only le
-00009340: 7474 6572 732c 206e 756d 6265 7273 2c20  tters, numbers, 
-00009350: 616e 6420 756e 6465 7273 636f 7265 2729  and underscore')
-00009360: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-00009370: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00009380: 2065 7272 6f72 5f6d 6573 7361 6765 3d22   error_message="
-00009390: 456e 7465 7220 6f6e 6c79 206c 6574 7465  Enter only lette
-000093a0: 7273 2c20 6e75 6d62 6572 732c 2061 6e64  rs, numbers, and
-000093b0: 2075 6e64 6572 7363 6f72 6522 293a 0a20   underscore"):. 
-000093c0: 2020 2020 2020 2049 535f 4d41 5443 482e         IS_MATCH.
-000093d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2072  __init__(self, r
-000093e0: 225e 5b5c 775d 2a24 222c 2065 7272 6f72  "^[\w]*$", error
-000093f0: 5f6d 6573 7361 6765 290a 0a0a 636c 6173  _message)...clas
-00009400: 7320 4953 5f45 4d41 494c 2856 616c 6964  s IS_EMAIL(Valid
-00009410: 6174 6f72 293a 0a0a 2020 2020 2222 220a  ator):..    """.
-00009420: 2020 2020 4368 6563 6b73 2069 6620 6669      Checks if fi
-00009430: 656c 6427 7320 7661 6c75 6520 6973 2061  eld's value is a
-00009440: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
-00009450: 7265 7373 2e20 4361 6e20 6265 2073 6574  ress. Can be set
-00009460: 2074 6f20 6469 7361 6c6c 6f77 0a20 2020   to disallow.   
-00009470: 206f 7220 666f 7263 6520 6164 6472 6573   or force addres
-00009480: 7365 7320 6672 6f6d 2063 6572 7461 696e  ses from certain
-00009490: 2064 6f6d 6169 6e28 7329 2e0a 0a20 2020   domain(s)...   
-000094a0: 2045 6d61 696c 2072 6567 6578 2061 6461   Email regex ada
-000094b0: 7074 6564 2066 726f 6d0a 2020 2020 6874  pted from.    ht
-000094c0: 7470 3a2f 2f68 6161 636b 6564 2e63 6f6d  tp://haacked.com
-000094d0: 2f61 7263 6869 7665 2f32 3030 372f 3038  /archive/2007/08
-000094e0: 2f32 312f 692d 6b6e 6577 2d68 6f77 2d74  /21/i-knew-how-t
-000094f0: 6f2d 7661 6c69 6461 7465 2d61 6e2d 656d  o-validate-an-em
-00009500: 6169 6c2d 6164 6472 6573 732d 756e 7469  ail-address-unti
-00009510: 6c2d 692e 6173 7078 2c0a 2020 2020 6765  l-i.aspx,.    ge
-00009520: 6e65 7261 6c6c 7920 666f 6c6c 6f77 696e  nerally followin
-00009530: 6720 7468 6520 5246 4373 2c20 6578 6365  g the RFCs, exce
-00009540: 7074 2074 6861 7420 7765 2064 6973 616c  pt that we disal
-00009550: 6c6f 7720 7175 6f74 6564 2073 7472 696e  low quoted strin
-00009560: 6773 0a20 2020 2061 6e64 2070 6572 6d69  gs.    and permi
-00009570: 7420 756e 6465 7273 636f 7265 7320 616e  t underscores an
-00009580: 6420 6c65 6164 696e 6720 6e75 6d65 7269  d leading numeri
-00009590: 6373 2069 6e20 7375 6264 6f6d 6169 6e20  cs in subdomain 
-000095a0: 6c61 6265 6c73 0a0a 2020 2020 4172 6773  labels..    Args
-000095b0: 3a0a 2020 2020 2020 2020 6261 6e6e 6564  :.        banned
-000095c0: 3a20 7265 6765 7820 7465 7874 2066 6f72  : regex text for
-000095d0: 2064 6973 616c 6c6f 7765 6420 6164 6472   disallowed addr
-000095e0: 6573 7320 646f 6d61 696e 730a 2020 2020  ess domains.    
-000095f0: 2020 2020 666f 7263 6564 3a20 7265 6765      forced: rege
-00009600: 7820 7465 7874 2066 6f72 2072 6571 7569  x text for requi
-00009610: 7265 6420 6164 6472 6573 7320 646f 6d61  red address doma
-00009620: 696e 730a 0a20 2020 2042 6f74 6820 6172  ins..    Both ar
-00009630: 6775 6d65 6e74 7320 6361 6e20 616c 736f  guments can also
-00009640: 2062 6520 6375 7374 6f6d 206f 626a 6563   be custom objec
-00009650: 7473 2077 6974 6820 6120 6d61 7463 6828  ts with a match(
-00009660: 7661 6c75 6529 206d 6574 686f 642e 0a0a  value) method...
-00009670: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-00009680: 2020 2020 2043 6865 636b 2066 6f72 2076       Check for v
-00009690: 616c 6964 2065 6d61 696c 2061 6464 7265  alid email addre
-000096a0: 7373 3a3a 0a0a 2020 2020 2020 2020 2020  ss::..          
-000096b0: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
-000096c0: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
-000096d0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-000096e0: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
-000096f0: 454d 4149 4c28 2929 0a0a 2020 2020 2020  EMAIL())..      
-00009700: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
-00009710: 6420 656d 6169 6c20 6164 6472 6573 7320  d email address 
-00009720: 7468 6174 2063 616e 2774 2062 6520 6672  that can't be fr
-00009730: 6f6d 2061 202e 636f 6d20 646f 6d61 696e  om a .com domain
-00009740: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-00009750: 494e 5055 5428 5f74 7970 653d 2774 6578  INPUT(_type='tex
-00009760: 7427 2c20 5f6e 616d 653d 276e 616d 6527  t', _name='name'
-00009770: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009780: 2020 7265 7175 6972 6573 3d49 535f 454d    requires=IS_EM
-00009790: 4149 4c28 6261 6e6e 6564 3d27 5e2e 2a5c  AIL(banned='^.*\
-000097a0: 5c2e 636f 6d28 7c5c 5c2e 2e2a 2924 2729  \.com(|\\..*)$')
-000097b0: 290a 0a20 2020 2020 2020 2043 6865 636b  )..        Check
-000097c0: 2066 6f72 2076 616c 6964 2065 6d61 696c   for valid email
-000097d0: 2061 6464 7265 7373 2074 6861 7420 6d75   address that mu
-000097e0: 7374 2062 6520 6672 6f6d 2061 202e 6564  st be from a .ed
-000097f0: 7520 646f 6d61 696e 3a3a 0a0a 2020 2020  u domain::..    
-00009800: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
-00009810: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
-00009820: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
-00009830: 2020 2020 2020 2020 2020 7265 7175 6972            requir
-00009840: 6573 3d49 535f 454d 4149 4c28 666f 7263  es=IS_EMAIL(forc
-00009850: 6564 3d27 5e2e 2a5c 5c2e 6564 7528 7c5c  ed='^.*\\.edu(|\
-00009860: 5c2e 2e2a 2924 2729 290a 0a20 2020 2020  \..*)$'))..     
-00009870: 2020 2020 2020 203e 3e3e 2049 535f 454d         >>> IS_EM
-00009880: 4149 4c28 2928 2761 4062 2e63 6f6d 2729  AIL()('a@b.com')
-00009890: 0a20 2020 2020 2020 2020 2020 2028 2761  .            ('a
-000098a0: 4062 2e63 6f6d 272c 204e 6f6e 6529 0a20  @b.com', None). 
-000098b0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-000098c0: 535f 454d 4149 4c28 2928 2761 6263 4064  S_EMAIL()('abc@d
-000098d0: 6566 2e63 6f6d 2729 0a20 2020 2020 2020  ef.com').       
-000098e0: 2020 2020 2028 2761 6263 4064 6566 2e63       ('abc@def.c
-000098f0: 6f6d 272c 204e 6f6e 6529 0a20 2020 2020  om', None).     
-00009900: 2020 2020 2020 203e 3e3e 2049 535f 454d         >>> IS_EM
-00009910: 4149 4c28 2928 2761 6263 4033 6465 662e  AIL()('abc@3def.
-00009920: 636f 6d27 290a 2020 2020 2020 2020 2020  com').          
-00009930: 2020 2827 6162 6340 3364 6566 2e63 6f6d    ('abc@3def.com
-00009940: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00009950: 2020 2020 203e 3e3e 2049 535f 454d 4149       >>> IS_EMAI
-00009960: 4c28 2928 2761 6263 4064 6566 2e75 7327  L()('abc@def.us'
-00009970: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
-00009980: 6162 6340 6465 662e 7573 272c 204e 6f6e  abc@def.us', Non
-00009990: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-000099a0: 3e3e 2049 535f 454d 4149 4c28 2928 2761  >> IS_EMAIL()('a
-000099b0: 6263 4064 5f2d 662e 7573 2729 0a20 2020  bc@d_-f.us').   
-000099c0: 2020 2020 2020 2020 2028 2761 6263 4064           ('abc@d
-000099d0: 5f2d 662e 7573 272c 204e 6f6e 6529 0a20  _-f.us', None). 
-000099e0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-000099f0: 535f 454d 4149 4c28 2928 2740 6465 662e  S_EMAIL()('@def.
-00009a00: 636f 6d27 2920 2020 2020 2020 2020 2020  com')           
-00009a10: 2320 6d69 7373 696e 6720 6e61 6d65 0a20  # missing name. 
-00009a20: 2020 2020 2020 2020 2020 2028 2740 6465             ('@de
-00009a30: 662e 636f 6d27 2c20 2765 6e74 6572 2061  f.com', 'enter a
-00009a40: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
-00009a50: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
-00009a60: 2020 203e 3e3e 2049 535f 454d 4149 4c28     >>> IS_EMAIL(
-00009a70: 2928 2722 6162 6340 6465 6622 2e63 6f6d  )('"abc@def".com
-00009a80: 2729 2020 2020 2020 2320 7175 6f74 6564  ')      # quoted
-00009a90: 206e 616d 650a 2020 2020 2020 2020 2020   name.          
-00009aa0: 2020 2827 2261 6263 4064 6566 222e 636f    ('"abc@def".co
-00009ab0: 6d27 2c20 2765 6e74 6572 2061 2076 616c  m', 'enter a val
-00009ac0: 6964 2065 6d61 696c 2061 6464 7265 7373  id email address
-00009ad0: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
-00009ae0: 3e3e 2049 535f 454d 4149 4c28 2928 2761  >> IS_EMAIL()('a
-00009af0: 6263 2b64 6566 2e63 6f6d 2729 2020 2020  bc+def.com')    
-00009b00: 2020 2020 2320 6e6f 2040 0a20 2020 2020      # no @.     
-00009b10: 2020 2020 2020 2028 2761 6263 2b64 6566         ('abc+def
-00009b20: 2e63 6f6d 272c 2027 656e 7465 7220 6120  .com', 'enter a 
-00009b30: 7661 6c69 6420 656d 6169 6c20 6164 6472  valid email addr
-00009b40: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-00009b50: 2020 3e3e 3e20 4953 5f45 4d41 494c 2829    >>> IS_EMAIL()
-00009b60: 2827 6162 6340 6465 662e 7827 2920 2020  ('abc@def.x')   
-00009b70: 2020 2020 2020 2023 206f 6e65 2d63 6861         # one-cha
-00009b80: 7220 544c 440a 2020 2020 2020 2020 2020  r TLD.          
-00009b90: 2020 2827 6162 6340 6465 662e 7827 2c20    ('abc@def.x', 
-00009ba0: 2765 6e74 6572 2061 2076 616c 6964 2065  'enter a valid e
-00009bb0: 6d61 696c 2061 6464 7265 7373 2729 0a20  mail address'). 
-00009bc0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-00009bd0: 535f 454d 4149 4c28 2928 2761 6263 4064  S_EMAIL()('abc@d
-00009be0: 6566 2e31 3227 2920 2020 2020 2020 2020  ef.12')         
-00009bf0: 2320 6e75 6d65 7269 6320 544c 440a 2020  # numeric TLD.  
-00009c00: 2020 2020 2020 2020 2020 2827 6162 6340            ('abc@
-00009c10: 6465 662e 3132 272c 2027 656e 7465 7220  def.12', 'enter 
-00009c20: 6120 7661 6c69 6420 656d 6169 6c20 6164  a valid email ad
-00009c30: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-00009c40: 2020 2020 3e3e 3e20 4953 5f45 4d41 494c      >>> IS_EMAIL
-00009c50: 2829 2827 6162 6340 6465 662e 2e63 6f6d  ()('abc@def..com
-00009c60: 2729 2020 2020 2020 2023 2064 6f75 626c  ')       # doubl
-00009c70: 652d 646f 7420 696e 2064 6f6d 6169 6e0a  e-dot in domain.
-00009c80: 2020 2020 2020 2020 2020 2020 2827 6162              ('ab
-00009c90: 6340 6465 662e 2e63 6f6d 272c 2027 656e  c@def..com', 'en
-00009ca0: 7465 7220 6120 7661 6c69 6420 656d 6169  ter a valid emai
-00009cb0: 6c20 6164 6472 6573 7327 290a 2020 2020  l address').    
-00009cc0: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
-00009cd0: 4d41 494c 2829 2827 6162 6340 2e64 6566  MAIL()('abc@.def
-00009ce0: 2e63 6f6d 2729 2020 2020 2020 2023 2064  .com')       # d
-00009cf0: 6f74 2073 7461 7274 7320 646f 6d61 696e  ot starts domain
-00009d00: 0a20 2020 2020 2020 2020 2020 2028 2761  .            ('a
-00009d10: 6263 402e 6465 662e 636f 6d27 2c20 2765  bc@.def.com', 'e
-00009d20: 6e74 6572 2061 2076 616c 6964 2065 6d61  nter a valid ema
-00009d30: 696c 2061 6464 7265 7373 2729 0a20 2020  il address').   
-00009d40: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
-00009d50: 454d 4149 4c28 2928 2761 6263 4064 6566  EMAIL()('abc@def
-00009d60: 2e63 5f6d 2729 2020 2020 2020 2020 2320  .c_m')        # 
-00009d70: 756e 6465 7273 636f 7265 2069 6e20 544c  underscore in TL
-00009d80: 440a 2020 2020 2020 2020 2020 2020 2827  D.            ('
-00009d90: 6162 6340 6465 662e 635f 6d27 2c20 2765  abc@def.c_m', 'e
-00009da0: 6e74 6572 2061 2076 616c 6964 2065 6d61  nter a valid ema
-00009db0: 696c 2061 6464 7265 7373 2729 0a20 2020  il address').   
-00009dc0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
-00009dd0: 454d 4149 4c28 2928 274e 6f74 416e 456d  EMAIL()('NotAnEm
-00009de0: 6169 6c27 2920 2020 2020 2020 2020 2320  ail')         # 
-00009df0: 6d69 7373 696e 6720 400a 2020 2020 2020  missing @.      
-00009e00: 2020 2020 2020 2827 4e6f 7441 6e45 6d61        ('NotAnEma
-00009e10: 696c 272c 2027 656e 7465 7220 6120 7661  il', 'enter a va
-00009e20: 6c69 6420 656d 6169 6c20 6164 6472 6573  lid email addres
-00009e30: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
-00009e40: 3e3e 3e20 4953 5f45 4d41 494c 2829 2827  >>> IS_EMAIL()('
-00009e50: 6162 6340 4e6f 7441 6e45 6d61 696c 2729  abc@NotAnEmail')
-00009e60: 2020 2020 2023 206d 6973 7369 6e67 2054       # missing T
-00009e70: 4c44 0a20 2020 2020 2020 2020 2020 2028  LD.            (
-00009e80: 2761 6263 404e 6f74 416e 456d 6169 6c27  'abc@NotAnEmail'
-00009e90: 2c20 2765 6e74 6572 2061 2076 616c 6964  , 'enter a valid
-00009ea0: 2065 6d61 696c 2061 6464 7265 7373 2729   email address')
-00009eb0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00009ec0: 2049 535f 454d 4149 4c28 2928 2763 7573   IS_EMAIL()('cus
-00009ed0: 746f 6d65 722f 6465 7061 7274 6d65 6e74  tomer/department
-00009ee0: 4065 7861 6d70 6c65 2e63 6f6d 2729 0a20  @example.com'). 
-00009ef0: 2020 2020 2020 2020 2020 2028 2763 7573             ('cus
-00009f00: 746f 6d65 722f 6465 7061 7274 6d65 6e74  tomer/department
-00009f10: 4065 7861 6d70 6c65 2e63 6f6d 272c 204e  @example.com', N
-00009f20: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-00009f30: 203e 3e3e 2049 535f 454d 4149 4c28 2928   >>> IS_EMAIL()(
-00009f40: 2724 4131 3233 3435 4065 7861 6d70 6c65  '$A12345@example
-00009f50: 2e63 6f6d 2729 0a20 2020 2020 2020 2020  .com').         
-00009f60: 2020 2028 2724 4131 3233 3435 4065 7861     ('$A12345@exa
-00009f70: 6d70 6c65 2e63 6f6d 272c 204e 6f6e 6529  mple.com', None)
-00009f80: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00009f90: 2049 535f 454d 4149 4c28 2928 2721 6465   IS_EMAIL()('!de
-00009fa0: 6621 7879 7a25 6162 6340 6578 616d 706c  f!xyz%abc@exampl
-00009fb0: 652e 636f 6d27 290a 2020 2020 2020 2020  e.com').        
-00009fc0: 2020 2020 2827 2164 6566 2178 797a 2561      ('!def!xyz%a
-00009fd0: 6263 4065 7861 6d70 6c65 2e63 6f6d 272c  bc@example.com',
-00009fe0: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-00009ff0: 2020 203e 3e3e 2049 535f 454d 4149 4c28     >>> IS_EMAIL(
-0000a000: 2928 275f 596f 7365 6d69 7465 2e53 616d  )('_Yosemite.Sam
-0000a010: 4065 7861 6d70 6c65 2e63 6f6d 2729 0a20  @example.com'). 
-0000a020: 2020 2020 2020 2020 2020 2028 275f 596f             ('_Yo
-0000a030: 7365 6d69 7465 2e53 616d 4065 7861 6d70  semite.Sam@examp
-0000a040: 6c65 2e63 6f6d 272c 204e 6f6e 6529 0a20  le.com', None). 
-0000a050: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-0000a060: 535f 454d 4149 4c28 2928 277e 4065 7861  S_EMAIL()('~@exa
-0000a070: 6d70 6c65 2e63 6f6d 2729 0a20 2020 2020  mple.com').     
-0000a080: 2020 2020 2020 2028 277e 4065 7861 6d70         ('~@examp
-0000a090: 6c65 2e63 6f6d 272c 204e 6f6e 6529 0a20  le.com', None). 
-0000a0a0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-0000a0b0: 535f 454d 4149 4c28 2928 272e 776f 6f6c  S_EMAIL()('.wool
-0000a0c0: 7940 6578 616d 706c 652e 636f 6d27 2920  y@example.com') 
-0000a0d0: 2020 2020 2020 2320 646f 7420 7374 6172        # dot star
-0000a0e0: 7473 206e 616d 650a 2020 2020 2020 2020  ts name.        
-0000a0f0: 2020 2020 2827 2e77 6f6f 6c79 4065 7861      ('.wooly@exa
-0000a100: 6d70 6c65 2e63 6f6d 272c 2027 656e 7465  mple.com', 'ente
-0000a110: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
-0000a120: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-0000a130: 2020 2020 2020 3e3e 3e20 4953 5f45 4d41        >>> IS_EMA
-0000a140: 494c 2829 2827 776f 2e2e 6f6c 7940 6578  IL()('wo..oly@ex
-0000a150: 616d 706c 652e 636f 6d27 2920 2020 2020  ample.com')     
-0000a160: 2023 2061 646a 6163 656e 7420 646f 7473   # adjacent dots
-0000a170: 2069 6e20 6e61 6d65 0a20 2020 2020 2020   in name.       
-0000a180: 2020 2020 2028 2777 6f2e 2e6f 6c79 4065       ('wo..oly@e
-0000a190: 7861 6d70 6c65 2e63 6f6d 272c 2027 656e  xample.com', 'en
-0000a1a0: 7465 7220 6120 7661 6c69 6420 656d 6169  ter a valid emai
-0000a1b0: 6c20 6164 6472 6573 7327 290a 2020 2020  l address').    
-0000a1c0: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
-0000a1d0: 4d41 494c 2829 2827 706f 6f74 6965 7461  MAIL()('pootieta
-0000a1e0: 6e67 2e40 6578 616d 706c 652e 636f 6d27  ng.@example.com'
-0000a1f0: 2920 2023 2064 6f74 2065 6e64 7320 6e61  )  # dot ends na
-0000a200: 6d65 0a20 2020 2020 2020 2020 2020 2028  me.            (
-0000a210: 2770 6f6f 7469 6574 616e 672e 4065 7861  'pootietang.@exa
-0000a220: 6d70 6c65 2e63 6f6d 272c 2027 656e 7465  mple.com', 'ente
-0000a230: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
-0000a240: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-0000a250: 2020 2020 2020 3e3e 3e20 4953 5f45 4d41        >>> IS_EMA
-0000a260: 494c 2829 2827 2e40 6578 616d 706c 652e  IL()('.@example.
-0000a270: 636f 6d27 2920 2020 2020 2020 2020 2020  com')           
-0000a280: 2023 206e 616d 6520 6973 2062 6172 6520   # name is bare 
-0000a290: 646f 740a 2020 2020 2020 2020 2020 2020  dot.            
-0000a2a0: 2827 2e40 6578 616d 706c 652e 636f 6d27  ('.@example.com'
-0000a2b0: 2c20 2765 6e74 6572 2061 2076 616c 6964  , 'enter a valid
-0000a2c0: 2065 6d61 696c 2061 6464 7265 7373 2729   email address')
-0000a2d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-0000a2e0: 2049 535f 454d 4149 4c28 2928 2749 6d61   IS_EMAIL()('Ima
-0000a2f0: 2e46 6f6f 6c40 6578 616d 706c 652e 636f  .Fool@example.co
-0000a300: 6d27 290a 2020 2020 2020 2020 2020 2020  m').            
-0000a310: 2827 496d 612e 466f 6f6c 4065 7861 6d70  ('Ima.Fool@examp
-0000a320: 6c65 2e63 6f6d 272c 204e 6f6e 6529 0a20  le.com', None). 
-0000a330: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-0000a340: 535f 454d 4149 4c28 2928 2749 6d61 2046  S_EMAIL()('Ima F
-0000a350: 6f6f 6c40 6578 616d 706c 652e 636f 6d27  ool@example.com'
-0000a360: 2920 2020 2020 2320 7370 6163 6520 696e  )     # space in
-0000a370: 206e 616d 650a 2020 2020 2020 2020 2020   name.          
-0000a380: 2020 2827 496d 6120 466f 6f6c 4065 7861    ('Ima Fool@exa
-0000a390: 6d70 6c65 2e63 6f6d 272c 2027 656e 7465  mple.com', 'ente
-0000a3a0: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
-0000a3b0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-0000a3c0: 2020 2020 2020 3e3e 3e20 4953 5f45 4d41        >>> IS_EMA
-0000a3d0: 494c 2829 2827 6c6f 6361 6c67 7579 406c  IL()('localguy@l
-0000a3e0: 6f63 616c 686f 7374 2729 2020 2020 2020  ocalhost')      
-0000a3f0: 2023 206c 6f63 616c 686f 7374 2061 7320   # localhost as 
-0000a400: 646f 6d61 696e 0a20 2020 2020 2020 2020  domain.         
-0000a410: 2020 2028 276c 6f63 616c 6775 7940 6c6f     ('localguy@lo
-0000a420: 6361 6c68 6f73 7427 2c20 4e6f 6e65 290a  calhost', None).
-0000a430: 0a20 2020 2022 2222 0a0a 2020 2020 2320  .    """..    # 
-0000a440: 4e4f 5445 3a20 7573 6520 7468 6573 6520  NOTE: use these 
-0000a450: 7769 7468 2066 6c61 6773 203d 2072 652e  with flags = re.
-0000a460: 5645 5242 4f53 4520 7c20 7265 2e49 474e  VERBOSE | re.IGN
-0000a470: 4f52 4543 4153 450a 2020 2020 5245 4745  ORECASE.    REGE
-0000a480: 585f 424f 4459 203d 2072 2222 220a 2020  X_BODY = r""".  
-0000a490: 2020 2020 2020 5e28 3f21 5c2e 2920 2020        ^(?!\.)   
-0000a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a4b0: 2020 2020 2020 2020 2320 6e61 6d65 206d          # name m
-0000a4c0: 6179 206e 6f74 2062 6567 696e 2077 6974  ay not begin wit
-0000a4d0: 6820 6120 646f 740a 2020 2020 2020 2020  h a dot.        
-0000a4e0: 280a 2020 2020 2020 2020 2020 5b2d 612d  (.          [-a-
-0000a4f0: 7a30 2d39 215c 2324 2526 272a 2b2f 3d3f  z0-9!\#$%&'*+/=?
-0000a500: 5e5f 607b 7c7d 7e5d 2020 2020 2320 616c  ^_`{|}~]    # al
-0000a510: 6c20 6c65 6761 6c20 6368 6172 6163 7465  l legal characte
-0000a520: 7273 2065 7863 6570 7420 646f 740a 2020  rs except dot.  
-0000a530: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-0000a540: 2020 2020 283f 3c21 5c2e 295c 2e20 2020      (?<!\.)\.   
-0000a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a560: 2020 2020 2320 7369 6e67 6c65 2064 6f74      # single dot
-0000a570: 7320 6f6e 6c79 0a20 2020 2020 2020 2029  s only.        )
-0000a580: 2b0a 2020 2020 2020 2020 283f 3c21 5c2e  +.        (?<!\.
-0000a590: 2924 2020 2020 2020 2020 2020 2020 2020  )$              
-0000a5a0: 2020 2020 2020 2020 2020 2020 2320 6e61              # na
-0000a5b0: 6d65 206d 6179 206e 6f74 2065 6e64 2077  me may not end w
-0000a5c0: 6974 6820 6120 646f 740a 2020 2020 2222  ith a dot.    ""
-0000a5d0: 220a 2020 2020 5245 4745 585f 444f 4d41  ".    REGEX_DOMA
-0000a5e0: 494e 203d 2072 2222 220a 2020 2020 2020  IN = r""".      
-0000a5f0: 2020 280a 2020 2020 2020 2020 2020 6c6f    (.          lo
-0000a600: 6361 6c68 6f73 740a 2020 2020 2020 2020  calhost.        
-0000a610: 2020 7c0a 2020 2020 2020 2020 2020 280a    |.          (.
-0000a620: 2020 2020 2020 2020 2020 2020 5b61 2d7a              [a-z
-0000a630: 302d 395d 2020 2020 2020 2320 5b73 7562  0-9]      # [sub
-0000a640: 5d64 6f6d 6169 6e20 6265 6769 6e73 2077  ]domain begins w
-0000a650: 6974 6820 616c 7068 616e 756d 6572 6963  ith alphanumeric
-0000a660: 0a20 2020 2020 2020 2020 2020 2028 0a20  .            (. 
-0000a670: 2020 2020 2020 2020 2020 2020 205b 2d5c               [-\
-0000a680: 775d 2a20 2020 2020 2023 2061 6c70 6861  w]*      # alpha
-0000a690: 6e75 6d65 7269 632c 2075 6e64 6572 7363  numeric, undersc
-0000a6a0: 6f72 652c 2064 6f74 2c20 6879 7068 656e  ore, dot, hyphen
-0000a6b0: 0a20 2020 2020 2020 2020 2020 2020 205b  .              [
-0000a6c0: 612d 7a30 2d39 5d20 2020 2023 2065 6e64  a-z0-9]    # end
-0000a6d0: 696e 6720 616c 7068 616e 756d 6572 6963  ing alphanumeric
-0000a6e0: 0a20 2020 2020 2020 2020 2020 2029 3f0a  .            )?.
-0000a6f0: 2020 2020 2020 2020 2020 5c2e 2020 2020            \.    
-0000a700: 2020 2020 2020 2020 2020 2320 656e 6469            # endi
-0000a710: 6e67 2064 6f74 0a20 2020 2020 2020 2020  ng dot.         
-0000a720: 2029 2b0a 2020 2020 2020 2020 2020 5b61   )+.          [a
-0000a730: 2d7a 5d7b 322c 7d20 2020 2020 2020 2320  -z]{2,}       # 
-0000a740: 544c 4420 616c 7068 612d 6f6e 6c79 0a20  TLD alpha-only. 
-0000a750: 2020 2020 2020 2924 0a20 2020 2022 2222        )$.    """
-0000a760: 0a20 2020 2023 2072 6567 6578 5f70 726f  .    # regex_pro
-0000a770: 706f 7365 645f 6275 745f 6661 696c 6564  posed_but_failed
-0000a780: 203d 2072 652e 636f 6d70 696c 6528 7227   = re.compile(r'
-0000a790: 5e28 5b5c 775c 215c 2324 5c25 5c26 5c27  ^([\w\!\#$\%\&\'
-0000a7a0: 5c2a 5c2b 5c2d 5c2f 5c3d 5c3f 5c5e 5c60  \*\+\-\/\=\?\^\`
-0000a7b0: 7b5c 7c5c 7d5c 7e5d 2b5c 2e29 2a5b 5c77  {\|\}\~]+\.)*[\w
-0000a7c0: 5c21 5c23 245c 255c 265c 275c 2a5c 2b5c  \!\#$\%\&\'\*\+\
-0000a7d0: 2d5c 2f5c 3d5c 3f5c 5e5c 607b 5c7c 5c7d  -\/\=\?\^\`{\|\}
-0000a7e0: 5c7e 5d2b 4028 2828 2828 5b61 2d7a 302d  \~]+@((((([a-z0-
-0000a7f0: 395d 7b31 7d5b 612d 7a30 2d39 5c2d 5d7b  9]{1}[a-z0-9\-]{
-0000a800: 302c 3632 7d5b 612d 7a30 2d39 5d7b 317d  0,62}[a-z0-9]{1}
-0000a810: 297c 5b61 2d7a 5d29 5c2e 292b 5b61 2d7a  )|[a-z])\.)+[a-z
-0000a820: 5d7b 322c 367d 297c 285c 647b 312c 337d  ]{2,6})|(\d{1,3}
-0000a830: 5c2e 297b 337d 5c64 7b31 2c33 7d28 5c3a  \.){3}\d{1,3}(\:
-0000a840: 5c64 7b31 2c35 7d29 3f29 2427 2c20 7265  \d{1,5})?)$', re
-0000a850: 2e56 4552 424f 5345 207c 2072 652e 4947  .VERBOSE | re.IG
-0000a860: 4e4f 5245 4341 5345 290a 0a20 2020 2064  NORECASE)..    d
-0000a870: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
-0000a880: 2020 2020 2073 656c 662c 2062 616e 6e65       self, banne
-0000a890: 643d 4e6f 6e65 2c20 666f 7263 6564 3d4e  d=None, forced=N
-0000a8a0: 6f6e 652c 2065 7272 6f72 5f6d 6573 7361  one, error_messa
-0000a8b0: 6765 3d22 456e 7465 7220 6120 7661 6c69  ge="Enter a vali
-0000a8c0: 6420 656d 6169 6c20 6164 6472 6573 7322  d email address"
-0000a8d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000a8e0: 6966 2069 7369 6e73 7461 6e63 6528 6261  if isinstance(ba
-0000a8f0: 6e6e 6564 2c20 7374 7229 3a0a 2020 2020  nned, str):.    
-0000a900: 2020 2020 2020 2020 6261 6e6e 6564 203d          banned =
-0000a910: 2072 652e 636f 6d70 696c 6528 6261 6e6e   re.compile(bann
-0000a920: 6564 290a 2020 2020 2020 2020 6966 2069  ed).        if i
-0000a930: 7369 6e73 7461 6e63 6528 666f 7263 6564  sinstance(forced
-0000a940: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-0000a950: 2020 2020 666f 7263 6564 203d 2072 652e      forced = re.
-0000a960: 636f 6d70 696c 6528 666f 7263 6564 290a  compile(forced).
-0000a970: 2020 2020 2020 2020 7365 6c66 2e62 616e          self.ban
-0000a980: 6e65 6420 3d20 6261 6e6e 6564 0a20 2020  ned = banned.   
-0000a990: 2020 2020 2073 656c 662e 666f 7263 6564       self.forced
-0000a9a0: 203d 2066 6f72 6365 640a 2020 2020 2020   = forced.      
-0000a9b0: 2020 7365 6c66 2e65 7272 6f72 5f6d 6573    self.error_mes
-0000a9c0: 7361 6765 203d 2065 7272 6f72 5f6d 6573  sage = error_mes
-0000a9d0: 7361 6765 0a0a 2020 2020 6465 6620 7661  sage..    def va
-0000a9e0: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-0000a9f0: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-0000aa00: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-0000aa10: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
-0000aa20: 7420 2869 7369 6e73 7461 6e63 6528 7661  t (isinstance(va
-0000aa30: 6c75 652c 2028 6261 7365 7374 7269 6e67  lue, (basestring
-0000aa40: 2c20 756e 6963 6f64 6554 2929 290a 2020  , unicodeT))).  
-0000aa50: 2020 2020 2020 2020 2020 6f72 206e 6f74            or not
-0000aa60: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
-0000aa70: 2020 206f 7220 2240 2220 6e6f 7420 696e     or "@" not in
-0000aa80: 2076 616c 7565 0a20 2020 2020 2020 2029   value.        )
-0000aa90: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000aaa0: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
-0000aab0: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
-0000aac0: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
-0000aad0: 6573 7361 6765 2929 0a0a 2020 2020 2020  essage))..      
-0000aae0: 2020 626f 6479 2c20 646f 6d61 696e 203d    body, domain =
-0000aaf0: 2076 616c 7565 2e72 7370 6c69 7428 2240   value.rsplit("@
-0000ab00: 222c 2031 290a 0a20 2020 2020 2020 2074  ", 1)..        t
-0000ab10: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000ab20: 7265 6765 785f 666c 6167 7320 3d20 7265  regex_flags = re
-0000ab30: 2e56 4552 424f 5345 207c 2072 652e 4947  .VERBOSE | re.IG
-0000ab40: 4e4f 5245 4341 5345 0a20 2020 2020 2020  NORECASE.       
-0000ab50: 2020 2020 206d 6174 6368 5f62 6f64 7920       match_body 
-0000ab60: 3d20 7265 2e6d 6174 6368 2873 656c 662e  = re.match(self.
-0000ab70: 5245 4745 585f 424f 4459 2c20 626f 6479  REGEX_BODY, body
-0000ab80: 2c20 7265 6765 785f 666c 6167 7329 0a20  , regex_flags). 
-0000ab90: 2020 2020 2020 2020 2020 206d 6174 6368             match
-0000aba0: 5f64 6f6d 6169 6e20 3d20 7265 2e6d 6174  _domain = re.mat
-0000abb0: 6368 2873 656c 662e 5245 4745 585f 444f  ch(self.REGEX_DO
-0000abc0: 4d41 494e 2c20 646f 6d61 696e 2c20 7265  MAIN, domain, re
-0000abd0: 6765 785f 666c 6167 7329 0a0a 2020 2020  gex_flags)..    
-0000abe0: 2020 2020 2020 2020 6966 206e 6f74 206d          if not m
-0000abf0: 6174 6368 5f64 6f6d 6169 6e3a 0a20 2020  atch_domain:.   
-0000ac00: 2020 2020 2020 2020 2020 2020 2023 2063               # c
-0000ac10: 6865 636b 2066 6f72 2049 6e74 6572 6e61  heck for Interna
-0000ac20: 7469 6f6e 616c 697a 6564 2044 6f6d 6169  tionalized Domai
-0000ac30: 6e20 4e61 6d65 730a 2020 2020 2020 2020  n Names.        
-0000ac40: 2020 2020 2020 2020 2320 7365 6520 6874          # see ht
-0000ac50: 7470 733a 2f2f 646f 6373 2e70 7974 686f  tps://docs.pytho
-0000ac60: 6e2e 6f72 672f 322f 6c69 6272 6172 792f  n.org/2/library/
-0000ac70: 636f 6465 6373 2e68 746d 6c23 6d6f 6475  codecs.html#modu
-0000ac80: 6c65 2d65 6e63 6f64 696e 6773 2e69 646e  le-encodings.idn
-0000ac90: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
-0000aca0: 2020 646f 6d61 696e 5f65 6e63 6f64 6564    domain_encoded
-0000acb0: 203d 2074 6f5f 756e 6963 6f64 6528 646f   = to_unicode(do
-0000acc0: 6d61 696e 292e 656e 636f 6465 2822 6964  main).encode("id
-0000acd0: 6e61 2229 2e64 6563 6f64 6528 2261 7363  na").decode("asc
-0000ace0: 6969 2229 0a20 2020 2020 2020 2020 2020  ii").           
-0000acf0: 2020 2020 206d 6174 6368 5f64 6f6d 6169       match_domai
-0000ad00: 6e20 3d20 7265 2e6d 6174 6368 2873 656c  n = re.match(sel
-0000ad10: 662e 5245 4745 585f 444f 4d41 494e 2c20  f.REGEX_DOMAIN, 
-0000ad20: 646f 6d61 696e 5f65 6e63 6f64 6564 2c20  domain_encoded, 
-0000ad30: 7265 6765 785f 666c 6167 7329 0a0a 2020  regex_flags)..  
-0000ad40: 2020 2020 2020 2020 2020 6d61 7463 6820            match 
-0000ad50: 3d20 286d 6174 6368 5f62 6f64 7920 6973  = (match_body is
-0000ad60: 206e 6f74 204e 6f6e 6529 2061 6e64 2028   not None) and (
-0000ad70: 6d61 7463 685f 646f 6d61 696e 2069 7320  match_domain is 
-0000ad80: 6e6f 7420 4e6f 6e65 290a 2020 2020 2020  not None).      
-0000ad90: 2020 6578 6365 7074 2028 5479 7065 4572    except (TypeEr
-0000ada0: 726f 722c 2055 6e69 636f 6465 4572 726f  ror, UnicodeErro
-0000adb0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0000adc0: 2320 5661 6c75 6520 6d61 7920 6e6f 7420  # Value may not 
-0000add0: 6265 2061 2073 7472 696e 6720 7768 6572  be a string wher
-0000ade0: 6520 7765 2063 616e 206c 6f6f 6b20 666f  e we can look fo
-0000adf0: 7220 6d61 7463 6865 732e 0a20 2020 2020  r matches..     
-0000ae00: 2020 2020 2020 2023 2045 7861 6d70 6c65         # Example
-0000ae10: 3a20 7765 2772 6520 6361 6c6c 696e 6720  : we're calling 
-0000ae20: 414e 595f 4f46 2066 6f72 6d61 7474 6572  ANY_OF formatter
-0000ae30: 2061 6e64 2049 535f 454d 4149 4c20 6973   and IS_EMAIL is
-0000ae40: 2061 736b 6564 2074 6f20 7661 6c69 6461   asked to valida
-0000ae50: 7465 2061 2064 6174 652e 0a20 2020 2020  te a date..     
-0000ae60: 2020 2020 2020 206d 6174 6368 203d 204e         match = N
-0000ae70: 6f6e 650a 2020 2020 2020 2020 6966 206d  one.        if m
-0000ae80: 6174 6368 3a0a 2020 2020 2020 2020 2020  atch:.          
-0000ae90: 2020 6966 2028 6e6f 7420 7365 6c66 2e62    if (not self.b
-0000aea0: 616e 6e65 6420 6f72 206e 6f74 2073 656c  anned or not sel
-0000aeb0: 662e 6261 6e6e 6564 2e6d 6174 6368 2864  f.banned.match(d
-0000aec0: 6f6d 6169 6e29 2920 616e 6420 280a 2020  omain)) and (.  
-0000aed0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-0000aee0: 7420 7365 6c66 2e66 6f72 6365 6420 6f72  t self.forced or
-0000aef0: 2073 656c 662e 666f 7263 6564 2e6d 6174   self.forced.mat
-0000af00: 6368 2864 6f6d 6169 6e29 0a20 2020 2020  ch(domain).     
-0000af10: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0000af20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000af30: 2076 616c 7565 0a20 2020 2020 2020 2072   value.        r
-0000af40: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-0000af50: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
-0000af60: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
-0000af70: 6d65 7373 6167 6529 290a 0a0a 636c 6173  message))...clas
-0000af80: 7320 4953 5f4c 4953 545f 4f46 5f45 4d41  s IS_LIST_OF_EMA
-0000af90: 494c 5328 5661 6c69 6461 746f 7229 3a0a  ILS(Validator):.
-0000afa0: 2020 2020 2222 220a 2020 2020 4578 616d      """.    Exam
-0000afb0: 706c 653a 0a20 2020 2020 2020 2055 7365  ple:.        Use
-0000afc0: 6420 6173 3a3a 0a0a 2020 2020 2020 2020  d as::..        
-0000afd0: 4669 656c 6428 2765 6d61 696c 7327 2c20  Field('emails', 
-0000afe0: 276c 6973 743a 7374 7269 6e67 272c 0a20  'list:string',. 
-0000aff0: 2020 2020 2020 2020 2020 2020 2077 6964               wid
-0000b000: 6765 743d 5351 4c46 4f52 4d2e 7769 6467  get=SQLFORM.widg
-0000b010: 6574 732e 7465 7874 2e77 6964 6765 742c  ets.text.widget,
-0000b020: 0a20 2020 2020 2020 2020 2020 2020 2072  .              r
-0000b030: 6571 7569 7265 733d 4953 5f4c 4953 545f  equires=IS_LIST_
-0000b040: 4f46 5f45 4d41 494c 5328 292c 0a20 2020  OF_EMAILS(),.   
-0000b050: 2020 2020 2020 2020 2020 2072 6570 7265             repre
-0000b060: 7365 6e74 3d6c 616d 6264 6120 762c 2072  sent=lambda v, r
-0000b070: 3a20 5c0a 2020 2020 2020 2020 2020 2020  : \.            
-0000b080: 2020 2020 584d 4c28 272c 2027 2e6a 6f69      XML(', '.joi
-0000b090: 6e28 5b41 2878 2c20 5f68 7265 663d 276d  n([A(x, _href='m
-0000b0a0: 6169 6c74 6f3a 272b 7829 2e78 6d6c 2829  ailto:'+x).xml()
-0000b0b0: 2066 6f72 2078 2069 6e20 2876 206f 7220   for x in (v or 
-0000b0c0: 5b5d 295d 2929 0a20 2020 2020 2020 2020  [])])).         
-0000b0d0: 2020 2020 290a 2020 2020 2222 220a 0a20      ).    """.. 
-0000b0e0: 2020 2052 4547 4558 5f4e 4f54 5f45 4d41     REGEX_NOT_EMA
-0000b0f0: 494c 5f53 504c 4954 5445 5220 3d20 7222  IL_SPLITTER = r"
-0000b100: 5b5e 2c3b 5c73 5d2b 220a 0a20 2020 2064  [^,;\s]+"..    d
-0000b110: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-0000b120: 2c20 6572 726f 725f 6d65 7373 6167 653d  , error_message=
-0000b130: 2249 6e76 616c 6964 2065 6d61 696c 733a  "Invalid emails:
-0000b140: 2025 7322 293a 0a20 2020 2020 2020 2073   %s"):.        s
-0000b150: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-0000b160: 6520 3d20 6572 726f 725f 6d65 7373 6167  e = error_messag
-0000b170: 650a 0a20 2020 2064 6566 2076 616c 6964  e..    def valid
-0000b180: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
-0000b190: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
-0000b1a0: 3a0a 2020 2020 2020 2020 6261 645f 656d  :.        bad_em
-0000b1b0: 6169 6c73 203d 205b 5d0a 2020 2020 2020  ails = [].      
-0000b1c0: 2020 6620 3d20 4953 5f45 4d41 494c 2829    f = IS_EMAIL()
-0000b1d0: 0a20 2020 2020 2020 2066 6f72 2065 6d61  .        for ema
-0000b1e0: 696c 2069 6e20 7265 2e66 696e 6461 6c6c  il in re.findall
-0000b1f0: 2873 656c 662e 5245 4745 585f 4e4f 545f  (self.REGEX_NOT_
-0000b200: 454d 4149 4c5f 5350 4c49 5454 4552 2c20  EMAIL_SPLITTER, 
-0000b210: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-0000b220: 2020 2020 6572 726f 7220 3d20 6628 656d      error = f(em
-0000b230: 6169 6c29 5b31 5d0a 2020 2020 2020 2020  ail)[1].        
-0000b240: 2020 2020 6966 2065 7272 6f72 2061 6e64      if error and
-0000b250: 2065 6d61 696c 206e 6f74 2069 6e20 6261   email not in ba
-0000b260: 645f 656d 6169 6c73 3a0a 2020 2020 2020  d_emails:.      
-0000b270: 2020 2020 2020 2020 2020 6261 645f 656d            bad_em
-0000b280: 6169 6c73 2e61 7070 656e 6428 656d 6169  ails.append(emai
-0000b290: 6c29 0a20 2020 2020 2020 2069 6620 6261  l).        if ba
-0000b2a0: 645f 656d 6169 6c73 3a0a 2020 2020 2020  d_emails:.      
-0000b2b0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-0000b2c0: 6461 7469 6f6e 4572 726f 7228 0a20 2020  dationError(.   
-0000b2d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000b2e0: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-0000b2f0: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
-0000b300: 2025 2022 2c20 222e 6a6f 696e 2862 6164   % ", ".join(bad
-0000b310: 5f65 6d61 696c 7329 0a20 2020 2020 2020  _emails).       
-0000b320: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000b330: 6574 7572 6e20 7661 6c75 650a 0a20 2020  eturn value..   
-0000b340: 2064 6566 2066 6f72 6d61 7474 6572 2873   def formatter(s
-0000b350: 656c 662c 2076 616c 7565 2c20 726f 773d  elf, value, row=
-0000b360: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-0000b370: 6574 7572 6e20 222c 2022 2e6a 6f69 6e28  eturn ", ".join(
-0000b380: 7661 6c75 6520 6f72 205b 5d29 0a0a 0a23  value or [])...#
-0000b390: 2055 524c 2073 6368 656d 6520 736f 7572   URL scheme sour
-0000b3a0: 6365 3a0a 2320 3c68 7474 703a 2f2f 656e  ce:.# <http://en
-0000b3b0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
-0000b3c0: 696b 692f 5552 495f 7363 6865 6d65 3e20  iki/URI_scheme> 
-0000b3d0: 6f62 7461 696e 6564 206f 6e20 3230 3038  obtained on 2008
-0000b3e0: 2d4e 6f76 2d31 300a 0a6f 6666 6963 6961  -Nov-10..officia
-0000b3f0: 6c5f 7572 6c5f 7363 6865 6d65 7320 3d20  l_url_schemes = 
-0000b400: 5b0a 2020 2020 2261 6161 222c 0a20 2020  [.    "aaa",.   
-0000b410: 2022 6161 6173 222c 0a20 2020 2022 6163   "aaas",.    "ac
-0000b420: 6170 222c 0a20 2020 2022 6361 7022 2c0a  ap",.    "cap",.
-0000b430: 2020 2020 2263 6964 222c 0a20 2020 2022      "cid",.    "
-0000b440: 6372 6964 222c 0a20 2020 2022 6461 7461  crid",.    "data
-0000b450: 222c 0a20 2020 2022 6461 7622 2c0a 2020  ",.    "dav",.  
-0000b460: 2020 2264 6963 7422 2c0a 2020 2020 2264    "dict",.    "d
-0000b470: 6e73 222c 0a20 2020 2022 6661 7822 2c0a  ns",.    "fax",.
-0000b480: 2020 2020 2266 696c 6522 2c0a 2020 2020      "file",.    
-0000b490: 2266 7470 222c 0a20 2020 2022 676f 222c  "ftp",.    "go",
-0000b4a0: 0a20 2020 2022 676f 7068 6572 222c 0a20  .    "gopher",. 
-0000b4b0: 2020 2022 6833 3233 222c 0a20 2020 2022     "h323",.    "
-0000b4c0: 6874 7470 222c 0a20 2020 2022 6874 7470  http",.    "http
-0000b4d0: 7322 2c0a 2020 2020 2269 6361 7022 2c0a  s",.    "icap",.
-0000b4e0: 2020 2020 2269 6d22 2c0a 2020 2020 2269      "im",.    "i
-0000b4f0: 6d61 7022 2c0a 2020 2020 2269 6e66 6f22  map",.    "info"
-0000b500: 2c0a 2020 2020 2269 7070 222c 0a20 2020  ,.    "ipp",.   
-0000b510: 2022 6972 6973 222c 0a20 2020 2022 6972   "iris",.    "ir
-0000b520: 6973 2e62 6565 7022 2c0a 2020 2020 2269  is.beep",.    "i
-0000b530: 7269 732e 7870 6322 2c0a 2020 2020 2269  ris.xpc",.    "i
-0000b540: 7269 732e 7870 6373 222c 0a20 2020 2022  ris.xpcs",.    "
-0000b550: 6972 6973 2e6c 7773 222c 0a20 2020 2022  iris.lws",.    "
-0000b560: 6c64 6170 222c 0a20 2020 2022 6d61 696c  ldap",.    "mail
-0000b570: 746f 222c 0a20 2020 2022 6d69 6422 2c0a  to",.    "mid",.
-0000b580: 2020 2020 226d 6f64 656d 222c 0a20 2020      "modem",.   
-0000b590: 2022 6d73 7270 222c 0a20 2020 2022 6d73   "msrp",.    "ms
-0000b5a0: 7270 7322 2c0a 2020 2020 226d 7471 7022  rps",.    "mtqp"
-0000b5b0: 2c0a 2020 2020 226d 7570 6461 7465 222c  ,.    "mupdate",
-0000b5c0: 0a20 2020 2022 6e65 7773 222c 0a20 2020  .    "news",.   
-0000b5d0: 2022 6e66 7322 2c0a 2020 2020 226e 6e74   "nfs",.    "nnt
-0000b5e0: 7022 2c0a 2020 2020 226f 7061 7175 656c  p",.    "opaquel
-0000b5f0: 6f63 6b74 6f6b 656e 222c 0a20 2020 2022  ocktoken",.    "
-0000b600: 706f 7022 2c0a 2020 2020 2270 7265 7322  pop",.    "pres"
-0000b610: 2c0a 2020 2020 2270 726f 7370 6572 6f22  ,.    "prospero"
-0000b620: 2c0a 2020 2020 2272 7473 7022 2c0a 2020  ,.    "rtsp",.  
-0000b630: 2020 2273 6572 7669 6365 222c 0a20 2020    "service",.   
-0000b640: 2022 7368 7474 7022 2c0a 2020 2020 2273   "shttp",.    "s
-0000b650: 6970 222c 0a20 2020 2022 7369 7073 222c  ip",.    "sips",
-0000b660: 0a20 2020 2022 736e 6d70 222c 0a20 2020  .    "snmp",.   
-0000b670: 2022 736f 6170 2e62 6565 7022 2c0a 2020   "soap.beep",.  
-0000b680: 2020 2273 6f61 702e 6265 6570 7322 2c0a    "soap.beeps",.
-0000b690: 2020 2020 2274 6167 222c 0a20 2020 2022      "tag",.    "
-0000b6a0: 7465 6c22 2c0a 2020 2020 2274 656c 6e65  tel",.    "telne
-0000b6b0: 7422 2c0a 2020 2020 2274 6674 7022 2c0a  t",.    "tftp",.
-0000b6c0: 2020 2020 2274 6869 736d 6573 7361 6765      "thismessage
-0000b6d0: 222c 0a20 2020 2022 7469 7022 2c0a 2020  ",.    "tip",.  
-0000b6e0: 2020 2274 7622 2c0a 2020 2020 2275 726e    "tv",.    "urn
-0000b6f0: 222c 0a20 2020 2022 7665 6d6d 6922 2c0a  ",.    "vemmi",.
-0000b700: 2020 2020 2277 6169 7322 2c0a 2020 2020      "wais",.    
-0000b710: 2278 6d6c 7270 632e 6265 6570 222c 0a20  "xmlrpc.beep",. 
-0000b720: 2020 2022 786d 6c72 7063 2e62 6565 7022     "xmlrpc.beep"
-0000b730: 2c0a 2020 2020 2278 6d70 7022 2c0a 2020  ,.    "xmpp",.  
-0000b740: 2020 227a 3339 2e35 3072 222c 0a20 2020    "z39.50r",.   
-0000b750: 2022 7a33 392e 3530 7322 2c0a 5d0a 756e   "z39.50s",.].un
-0000b760: 6f66 6669 6369 616c 5f75 726c 5f73 6368  official_url_sch
-0000b770: 656d 6573 203d 205b 0a20 2020 2022 6162  emes = [.    "ab
-0000b780: 6f75 7422 2c0a 2020 2020 2261 6469 756d  out",.    "adium
-0000b790: 7874 7261 222c 0a20 2020 2022 6169 6d22  xtra",.    "aim"
-0000b7a0: 2c0a 2020 2020 2261 6670 222c 0a20 2020  ,.    "afp",.   
-0000b7b0: 2022 6177 222c 0a20 2020 2022 6361 6c6c   "aw",.    "call
-0000b7c0: 746f 222c 0a20 2020 2022 6368 726f 6d65  to",.    "chrome
-0000b7d0: 222c 0a20 2020 2022 6376 7322 2c0a 2020  ",.    "cvs",.  
-0000b7e0: 2020 2265 6432 6b22 2c0a 2020 2020 2266    "ed2k",.    "f
-0000b7f0: 6565 6422 2c0a 2020 2020 2266 6973 6822  eed",.    "fish"
-0000b800: 2c0a 2020 2020 2267 6722 2c0a 2020 2020  ,.    "gg",.    
-0000b810: 2267 697a 6d6f 7072 6f6a 6563 7422 2c0a  "gizmoproject",.
-0000b820: 2020 2020 2269 6178 3222 2c0a 2020 2020      "iax2",.    
-0000b830: 2269 7263 222c 0a20 2020 2022 6972 6373  "irc",.    "ircs
-0000b840: 222c 0a20 2020 2022 6974 6d73 222c 0a20  ",.    "itms",. 
-0000b850: 2020 2022 6a61 7222 2c0a 2020 2020 226a     "jar",.    "j
-0000b860: 6176 6173 6372 6970 7422 2c0a 2020 2020  avascript",.    
-0000b870: 226b 6579 7061 7263 222c 0a20 2020 2022  "keyparc",.    "
-0000b880: 6c61 7374 666d 222c 0a20 2020 2022 6c64  lastfm",.    "ld
-0000b890: 6170 7322 2c0a 2020 2020 226d 6167 6e65  aps",.    "magne
-0000b8a0: 7422 2c0a 2020 2020 226d 6d73 222c 0a20  t",.    "mms",. 
-0000b8b0: 2020 2022 6d73 6e69 6d22 2c0a 2020 2020     "msnim",.    
-0000b8c0: 226d 766e 222c 0a20 2020 2022 6e6f 7465  "mvn",.    "note
-0000b8d0: 7322 2c0a 2020 2020 226e 7366 7722 2c0a  s",.    "nsfw",.
-0000b8e0: 2020 2020 2270 7379 6322 2c0a 2020 2020      "psyc",.    
-0000b8f0: 2270 6170 6172 617a 7a69 3a68 7474 7022  "paparazzi:http"
-0000b900: 2c0a 2020 2020 2272 6d69 222c 0a20 2020  ,.    "rmi",.   
-0000b910: 2022 7273 796e 6322 2c0a 2020 2020 2273   "rsync",.    "s
-0000b920: 6563 6f6e 646c 6966 6522 2c0a 2020 2020  econdlife",.    
-0000b930: 2273 676e 222c 0a20 2020 2022 736b 7970  "sgn",.    "skyp
-0000b940: 6522 2c0a 2020 2020 2273 7368 222c 0a20  e",.    "ssh",. 
-0000b950: 2020 2022 7366 7470 222c 0a20 2020 2022     "sftp",.    "
-0000b960: 736d 6222 2c0a 2020 2020 2273 6d73 222c  smb",.    "sms",
-0000b970: 0a20 2020 2022 736f 6c64 6174 222c 0a20  .    "soldat",. 
-0000b980: 2020 2022 7374 6561 6d22 2c0a 2020 2020     "steam",.    
-0000b990: 2273 766e 222c 0a20 2020 2022 7465 616d  "svn",.    "team
-0000b9a0: 7370 6561 6b22 2c0a 2020 2020 2275 6e72  speak",.    "unr
-0000b9b0: 6561 6c22 2c0a 2020 2020 2275 7432 3030  eal",.    "ut200
-0000b9c0: 3422 2c0a 2020 2020 2276 656e 7472 696c  4",.    "ventril
-0000b9d0: 6f22 2c0a 2020 2020 2276 6965 772d 736f  o",.    "view-so
-0000b9e0: 7572 6365 222c 0a20 2020 2022 7765 6263  urce",.    "webc
-0000b9f0: 616c 222c 0a20 2020 2022 7779 6369 7779  al",.    "wyciwy
-0000ba00: 6722 2c0a 2020 2020 2278 6669 7265 222c  g",.    "xfire",
-0000ba10: 0a20 2020 2022 7872 6922 2c0a 2020 2020  .    "xri",.    
-0000ba20: 2279 6d73 6772 222c 0a5d 0a61 6c6c 5f75  "ymsgr",.].all_u
-0000ba30: 726c 5f73 6368 656d 6573 203d 205b 4e6f  rl_schemes = [No
-0000ba40: 6e65 5d20 2b20 6f66 6669 6369 616c 5f75  ne] + official_u
-0000ba50: 726c 5f73 6368 656d 6573 202b 2075 6e6f  rl_schemes + uno
-0000ba60: 6666 6963 6961 6c5f 7572 6c5f 7363 6865  fficial_url_sche
-0000ba70: 6d65 730a 6874 7470 5f73 6368 656d 6573  mes.http_schemes
-0000ba80: 203d 205b 4e6f 6e65 2c20 2268 7474 7022   = [None, "http"
-0000ba90: 2c20 2268 7474 7073 225d 0a0a 2320 4465  , "https"]..# De
-0000baa0: 6669 6e65 6420 696e 2052 4643 2033 3439  fined in RFC 349
-0000bab0: 302c 2053 6563 7469 6f6e 2033 2e31 2c20  0, Section 3.1, 
-0000bac0: 5265 7175 6972 656d 656e 7420 2331 0a23  Requirement #1.#
-0000bad0: 2055 7365 2074 6869 7320 7265 6765 7820   Use this regex 
-0000bae0: 746f 2073 706c 6974 2074 6865 2061 7574  to split the aut
-0000baf0: 686f 7269 7479 2063 6f6d 706f 6e65 6e74  hority component
-0000bb00: 206f 6620 6120 756e 6963 6f64 6520 5552   of a unicode UR
-0000bb10: 4c20 696e 746f 0a23 2069 7473 2063 6f6d  L into.# its com
-0000bb20: 706f 6e65 6e74 206c 6162 656c 730a 5245  ponent labels.RE
-0000bb30: 4745 585f 4155 5448 4f52 4954 595f 5350  GEX_AUTHORITY_SP
-0000bb40: 4c49 5454 4552 203d 2022 5b5c 7530 3032  LITTER = "[\u002
-0000bb50: 655c 7533 3030 325c 7566 6630 655c 7566  e\u3002\uff0e\uf
-0000bb60: 6636 315d 220a 0a0a 6465 6620 6573 6361  f61]"...def esca
-0000bb70: 7065 5f75 6e69 636f 6465 2873 7472 696e  pe_unicode(strin
-0000bb80: 6729 3a0a 2020 2020 2222 220a 2020 2020  g):.    """.    
-0000bb90: 436f 6e76 6572 7473 2061 2075 6e69 636f  Converts a unico
-0000bba0: 6465 2073 7472 696e 6720 696e 746f 2055  de string into U
-0000bbb0: 532d 4153 4349 492c 2075 7369 6e67 2061  S-ASCII, using a
-0000bbc0: 2073 696d 706c 6520 636f 6e76 6572 7369   simple conversi
-0000bbd0: 6f6e 2073 6368 656d 652e 0a20 2020 2045  on scheme..    E
-0000bbe0: 6163 6820 756e 6963 6f64 6520 6368 6172  ach unicode char
-0000bbf0: 6163 7465 7220 7468 6174 2064 6f65 7320  acter that does 
-0000bc00: 6e6f 7420 6861 7665 2061 2055 532d 4153  not have a US-AS
-0000bc10: 4349 4920 6571 7569 7661 6c65 6e74 2069  CII equivalent i
-0000bc20: 730a 2020 2020 636f 6e76 6572 7465 6420  s.    converted 
-0000bc30: 696e 746f 2061 2055 524c 2065 7363 6170  into a URL escap
-0000bc40: 6564 2066 6f72 6d20 6261 7365 6420 6f6e  ed form based on
-0000bc50: 2069 7473 2068 6578 6164 6563 696d 616c   its hexadecimal
-0000bc60: 2076 616c 7565 2e0a 2020 2020 466f 7220   value..    For 
-0000bc70: 6578 616d 706c 652c 2074 6865 2075 6e69  example, the uni
-0000bc80: 636f 6465 2063 6861 7261 6374 6572 2027  code character '
-0000bc90: 5c5c 7534 6538 3627 2077 696c 6c20 6265  \\u4e86' will be
-0000bca0: 636f 6d65 2074 6865 2073 7472 696e 6720  come the string 
-0000bcb0: 2725 3465 2538 3627 0a0a 2020 2020 4172  '%4e%86'..    Ar
-0000bcc0: 6773 3a0a 2020 2020 2020 2020 7374 7269  gs:.        stri
-0000bcd0: 6e67 3a20 756e 6963 6f64 6520 7374 7269  ng: unicode stri
-0000bce0: 6e67 2c20 7468 6520 756e 6963 6f64 6520  ng, the unicode 
-0000bcf0: 7374 7269 6e67 2074 6f20 636f 6e76 6572  string to conver
-0000bd00: 7420 696e 746f 2061 6e0a 2020 2020 2020  t into an.      
-0000bd10: 2020 2020 2020 6573 6361 7065 6420 5553        escaped US
-0000bd20: 2d41 5343 4949 2066 6f72 6d0a 0a20 2020  -ASCII form..   
-0000bd30: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0000bd40: 2020 7374 7269 6e67 3a20 7468 6520 5553    string: the US
-0000bd50: 2d41 5343 4949 2065 7363 6170 6564 2066  -ASCII escaped f
-0000bd60: 6f72 6d20 6f66 2074 6865 2069 6e70 7574  orm of the input
-0000bd70: 7465 6420 7374 7269 6e67 0a0a 2020 2020  ted string..    
-0000bd80: 4061 7574 686f 723a 204a 6f6e 6174 6861  @author: Jonatha
-0000bd90: 6e20 4265 6e6e 0a20 2020 2022 2222 0a20  n Benn.    """. 
-0000bda0: 2020 2072 6574 7572 6e56 616c 7565 203d     returnValue =
-0000bdb0: 2053 7472 696e 6749 4f28 290a 0a20 2020   StringIO()..   
-0000bdc0: 2066 6f72 2063 6861 7261 6374 6572 2069   for character i
-0000bdd0: 6e20 7374 7269 6e67 3a0a 2020 2020 2020  n string:.      
-0000bde0: 2020 636f 6465 203d 206f 7264 2863 6861    code = ord(cha
-0000bdf0: 7261 6374 6572 290a 2020 2020 2020 2020  racter).        
-0000be00: 6966 2063 6f64 6520 3e20 3078 3746 3a0a  if code > 0x7F:.
-0000be10: 2020 2020 2020 2020 2020 2020 6865 7843              hexC
-0000be20: 6f64 6520 3d20 6865 7828 636f 6465 290a  ode = hex(code).
-0000be30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000be40: 726e 5661 6c75 652e 7772 6974 6528 2225  rnValue.write("%
-0000be50: 2220 2b20 6865 7843 6f64 655b 323a 345d  " + hexCode[2:4]
-0000be60: 202b 2022 2522 202b 2068 6578 436f 6465   + "%" + hexCode
-0000be70: 5b34 3a36 5d29 0a20 2020 2020 2020 2065  [4:6]).        e
-0000be80: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000be90: 2072 6574 7572 6e56 616c 7565 2e77 7269   returnValue.wri
-0000bea0: 7465 2863 6861 7261 6374 6572 290a 0a20  te(character).. 
-0000beb0: 2020 2072 6574 7572 6e20 7265 7475 726e     return return
-0000bec0: 5661 6c75 652e 6765 7476 616c 7565 2829  Value.getvalue()
-0000bed0: 0a0a 0a64 6566 2075 6e69 636f 6465 5f74  ...def unicode_t
-0000bee0: 6f5f 6173 6369 695f 6175 7468 6f72 6974  o_ascii_authorit
-0000bef0: 7928 6175 7468 6f72 6974 7929 3a0a 2020  y(authority):.  
-0000bf00: 2020 2222 220a 2020 2020 466f 6c6c 6f77    """.    Follow
-0000bf10: 7320 7468 6520 7374 6570 7320 696e 2052  s the steps in R
-0000bf20: 4643 2033 3439 302c 2053 6563 7469 6f6e  FC 3490, Section
-0000bf30: 2034 2074 6f20 636f 6e76 6572 7420 6120   4 to convert a 
-0000bf40: 756e 6963 6f64 6520 6175 7468 6f72 6974  unicode authorit
-0000bf50: 790a 2020 2020 7374 7269 6e67 2069 6e74  y.    string int
-0000bf60: 6f20 6974 7320 4153 4349 4920 6571 7569  o its ASCII equi
-0000bf70: 7661 6c65 6e74 2e0a 2020 2020 466f 7220  valent..    For 
-0000bf80: 6578 616d 706c 652c 2075 2777 7777 2e41  example, u'www.A
-0000bf90: 6c6c 6961 6e63 6566 7261 6e5c 5c78 6537  lliancefran\\xe7
-0000bfa0: 6169 7365 2e6e 7527 2077 696c 6c20 6265  aise.nu' will be
-0000bfb0: 2063 6f6e 7665 7274 6564 2069 6e74 6f0a   converted into.
-0000bfc0: 2020 2020 2777 7777 2e78 6e2d 2d61 6c6c      'www.xn--all
-0000bfd0: 6961 6e63 6566 7261 6e61 6973 652d 6e70  iancefranaise-np
-0000bfe0: 622e 6e75 270a 0a20 2020 2041 7267 733a  b.nu'..    Args:
-0000bff0: 0a20 2020 2020 2020 2061 7574 686f 7269  .        authori
-0000c000: 7479 3a20 756e 6963 6f64 6520 7374 7269  ty: unicode stri
-0000c010: 6e67 2c20 7468 6520 5552 4c20 6175 7468  ng, the URL auth
-0000c020: 6f72 6974 7920 636f 6d70 6f6e 656e 7420  ority component 
-0000c030: 746f 2063 6f6e 7665 7274 2c0a 2020 2020  to convert,.    
-0000c040: 2020 2020 2020 2020 652e 672e 2075 2777          e.g. u'w
-0000c050: 7777 2e41 6c6c 6961 6e63 6566 7261 6e5c  ww.Alliancefran\
-0000c060: 5c78 6537 6169 7365 2e6e 7527 0a0a 2020  \xe7aise.nu'..  
-0000c070: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-0000c080: 2020 2073 7472 696e 673a 2074 6865 2055     string: the U
-0000c090: 532d 4153 4349 4920 6368 6172 6163 7465  S-ASCII characte
-0000c0a0: 7220 6571 7569 7661 6c65 6e74 2074 6f20  r equivalent to 
-0000c0b0: 7468 6520 696e 7075 7474 6564 2061 7574  the inputted aut
-0000c0c0: 686f 7269 7479 2c0a 2020 2020 2020 2020  hority,.        
-0000c0d0: 2020 2020 2065 2e67 2e20 2777 7777 2e78       e.g. 'www.x
-0000c0e0: 6e2d 2d61 6c6c 6961 6e63 6566 7261 6e61  n--alliancefrana
-0000c0f0: 6973 652d 6e70 622e 6e75 270a 0a20 2020  ise-npb.nu'..   
-0000c100: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
-0000c110: 2045 7863 6570 7469 6f6e 3a20 6966 2074   Exception: if t
-0000c120: 6865 2066 756e 6374 696f 6e20 6973 206e  he function is n
-0000c130: 6f74 2061 626c 6520 746f 2063 6f6e 7665  ot able to conve
-0000c140: 7274 2074 6865 2069 6e70 7574 7465 640a  rt the inputted.
-0000c150: 2020 2020 2020 2020 2020 2020 6175 7468              auth
-0000c160: 6f72 6974 790a 0a20 2020 2040 6175 7468  ority..    @auth
-0000c170: 6f72 3a20 4a6f 6e61 7468 616e 2042 656e  or: Jonathan Ben
-0000c180: 6e0a 2020 2020 2222 220a 2020 2020 2320  n.    """.    # 
-0000c190: 5246 4320 3334 3930 2c20 5365 6374 696f  RFC 3490, Sectio
-0000c1a0: 6e20 342c 2053 7465 7020 310a 2020 2020  n 4, Step 1.    
-0000c1b0: 2320 5468 6520 656e 636f 6469 6e67 732e  # The encodings.
-0000c1c0: 6964 6e61 2050 7974 686f 6e20 6d6f 6475  idna Python modu
-0000c1d0: 6c65 2061 7373 756d 6573 2074 6861 7420  le assumes that 
-0000c1e0: 416c 6c6f 7755 6e61 7373 6967 6e65 6420  AllowUnassigned 
-0000c1f0: 3d3d 2054 7275 650a 0a20 2020 2023 2052  == True..    # R
-0000c200: 4643 2033 3439 302c 2053 6563 7469 6f6e  FC 3490, Section
-0000c210: 2034 2c20 5374 6570 2032 0a20 2020 206c   4, Step 2.    l
-0000c220: 6162 656c 7320 3d20 7265 2e73 706c 6974  abels = re.split
-0000c230: 2852 4547 4558 5f41 5554 484f 5249 5459  (REGEX_AUTHORITY
-0000c240: 5f53 504c 4954 5445 522c 2061 7574 686f  _SPLITTER, autho
-0000c250: 7269 7479 290a 0a20 2020 2023 2052 4643  rity)..    # RFC
-0000c260: 2033 3439 302c 2053 6563 7469 6f6e 2034   3490, Section 4
-0000c270: 2c20 5374 6570 2033 0a20 2020 2023 2054  , Step 3.    # T
-0000c280: 6865 2065 6e63 6f64 696e 6773 2e69 646e  he encodings.idn
-0000c290: 6120 5079 7468 6f6e 206d 6f64 756c 6520  a Python module 
-0000c2a0: 6173 7375 6d65 7320 7468 6174 2055 7365  assumes that Use
-0000c2b0: 5354 4433 4153 4349 4952 756c 6573 203d  STD3ASCIIRules =
-0000c2c0: 3d20 4661 6c73 650a 0a20 2020 2023 2052  = False..    # R
-0000c2d0: 4643 2033 3439 302c 2053 6563 7469 6f6e  FC 3490, Section
-0000c2e0: 2034 2c20 5374 6570 2034 0a20 2020 2023   4, Step 4.    #
-0000c2f0: 2057 6520 7573 6520 7468 6520 546f 4153   We use the ToAS
-0000c300: 4349 4920 6f70 6572 6174 696f 6e20 6265  CII operation be
-0000c310: 6361 7573 6520 7765 2061 7265 2061 626f  cause we are abo
-0000c320: 7574 2074 6f20 7075 7420 7468 6520 6175  ut to put the au
-0000c330: 7468 6f72 6974 790a 2020 2020 2320 696e  thority.    # in
-0000c340: 746f 2061 6e20 4944 4e2d 756e 6177 6172  to an IDN-unawar
-0000c350: 6520 736c 6f74 0a20 2020 2061 7363 6969  e slot.    ascii
-0000c360: 4c61 6265 6c73 203d 205b 5d0a 2020 2020  Labels = [].    
-0000c370: 666f 7220 6c61 6265 6c20 696e 206c 6162  for label in lab
-0000c380: 656c 733a 0a20 2020 2020 2020 2069 6620  els:.        if 
-0000c390: 6c61 6265 6c3a 0a20 2020 2020 2020 2020  label:.         
-0000c3a0: 2020 2061 7363 6969 4c61 6265 6c73 2e61     asciiLabels.a
-0000c3b0: 7070 656e 6428 746f 5f6e 6174 6976 6528  ppend(to_native(
-0000c3c0: 656e 636f 6469 6e67 732e 6964 6e61 2e54  encodings.idna.T
-0000c3d0: 6f41 5343 4949 286c 6162 656c 2929 290a  oASCII(label))).
-0000c3e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000c3f0: 2020 2020 2020 2020 2020 2320 656e 636f            # enco
-0000c400: 6469 6e67 732e 6964 6e61 2e54 6f41 5343  dings.idna.ToASC
-0000c410: 4949 2064 6f65 7320 6e6f 7420 6163 6365  II does not acce
-0000c420: 7074 2061 6e20 656d 7074 7920 7374 7269  pt an empty stri
-0000c430: 6e67 2c20 6275 740a 2020 2020 2020 2020  ng, but.        
-0000c440: 2020 2020 2320 6974 2069 7320 6e65 6365      # it is nece
-0000c450: 7373 6172 7920 666f 7220 7573 2074 6f20  ssary for us to 
-0000c460: 616c 6c6f 7720 666f 7220 656d 7074 7920  allow for empty 
-0000c470: 6c61 6265 6c73 2073 6f20 7468 6174 2077  labels so that w
-0000c480: 650a 2020 2020 2020 2020 2020 2020 2320  e.            # 
-0000c490: 646f 6e27 7420 6d6f 6469 6679 2074 6865  don't modify the
-0000c4a0: 2055 524c 0a20 2020 2020 2020 2020 2020   URL.           
-0000c4b0: 2061 7363 6969 4c61 6265 6c73 2e61 7070   asciiLabels.app
-0000c4c0: 656e 6428 2222 290a 2020 2020 2320 5246  end("").    # RF
-0000c4d0: 4320 3334 3930 2c20 5365 6374 696f 6e20  C 3490, Section 
-0000c4e0: 342c 2053 7465 7020 350a 2020 2020 7265  4, Step 5.    re
-0000c4f0: 7475 726e 2073 7472 2872 6564 7563 6528  turn str(reduce(
-0000c500: 6c61 6d62 6461 2078 2c20 793a 2078 202b  lambda x, y: x +
-0000c510: 2075 6e69 6368 7228 3078 3030 3245 2920   unichr(0x002E) 
-0000c520: 2b20 792c 2061 7363 6969 4c61 6265 6c73  + y, asciiLabels
-0000c530: 2929 0a0a 0a64 6566 2075 6e69 636f 6465  ))...def unicode
-0000c540: 5f74 6f5f 6173 6369 695f 7572 6c28 7572  _to_ascii_url(ur
-0000c550: 6c2c 2070 7265 7065 6e64 5f73 6368 656d  l, prepend_schem
-0000c560: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
-0000c570: 436f 6e76 6572 7473 2074 6865 2069 6e70  Converts the inp
-0000c580: 7574 7465 6420 756e 6963 6f64 6520 7572  utted unicode ur
-0000c590: 6c20 696e 746f 2061 2055 532d 4153 4349  l into a US-ASCI
-0000c5a0: 4920 6571 7569 7661 6c65 6e74 2e20 5468  I equivalent. Th
-0000c5b0: 6973 2066 756e 6374 696f 6e0a 2020 2020  is function.    
-0000c5c0: 676f 6573 2061 206c 6974 746c 6520 6265  goes a little be
-0000c5d0: 796f 6e64 2052 4643 2033 3439 302c 2077  yond RFC 3490, w
-0000c5e0: 6869 6368 2069 7320 6c69 6d69 7465 6420  hich is limited 
-0000c5f0: 696e 2073 636f 7065 2074 6f20 7468 6520  in scope to the 
-0000c600: 646f 6d61 696e 206e 616d 650a 2020 2020  domain name.    
-0000c610: 2861 7574 686f 7269 7479 2920 6f6e 6c79  (authority) only
-0000c620: 2e20 4865 7265 2c20 7468 6520 6675 6e63  . Here, the func
-0000c630: 7469 6f6e 616c 6974 7920 6973 2065 7870  tionality is exp
-0000c640: 616e 6465 6420 746f 2077 6861 7420 7761  anded to what wa
-0000c650: 7320 6f62 7365 7276 6564 0a20 2020 206f  s observed.    o
-0000c660: 6e20 5769 6b69 7065 6469 6120 6f6e 2032  n Wikipedia on 2
-0000c670: 3030 392d 4a61 6e2d 3232 3a0a 0a20 2020  009-Jan-22:..   
-0000c680: 2020 2020 436f 6d70 6f6e 656e 7420 2020      Component   
-0000c690: 2043 616e 2055 7365 2055 6e69 636f 6465   Can Use Unicode
-0000c6a0: 3f0a 2020 2020 2020 202d 2d2d 2d2d 2d2d  ?.       -------
-0000c6b0: 2d2d 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  --    ----------
-0000c6c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 7363  ------.       sc
-0000c6d0: 6865 6d65 2020 2020 2020 204e 6f0a 2020  heme       No.  
-0000c6e0: 2020 2020 2061 7574 686f 7269 7479 2020       authority  
-0000c6f0: 2020 5965 730a 2020 2020 2020 2070 6174    Yes.       pat
-0000c700: 6820 2020 2020 2020 2020 5965 730a 2020  h         Yes.  
-0000c710: 2020 2020 2071 7565 7279 2020 2020 2020       query      
-0000c720: 2020 5965 730a 2020 2020 2020 2066 7261    Yes.       fra
-0000c730: 676d 656e 7420 2020 2020 4e6f 0a0a 2020  gment     No..  
-0000c740: 2020 5468 6520 6175 7468 6f72 6974 7920    The authority 
-0000c750: 636f 6d70 6f6e 656e 7420 6765 7473 2063  component gets c
-0000c760: 6f6e 7665 7274 6564 2074 6f20 7075 6e79  onverted to puny
-0000c770: 636f 6465 2c20 6275 7420 6f63 6375 7272  code, but occurr
-0000c780: 656e 6365 7320 6f66 0a20 2020 2075 6e69  ences of.    uni
-0000c790: 636f 6465 2069 6e20 6f74 6865 7220 636f  code in other co
-0000c7a0: 6d70 6f6e 656e 7473 2067 6574 2063 6f6e  mponents get con
-0000c7b0: 7665 7274 6564 2069 6e74 6f20 6120 7061  verted into a pa
-0000c7c0: 6972 206f 6620 5552 4920 6573 6361 7065  ir of URI escape
-0000c7d0: 7320 2877 650a 2020 2020 6173 7375 6d65  s (we.    assume
-0000c7e0: 2034 2d62 7974 6520 756e 6963 6f64 6529   4-byte unicode)
-0000c7f0: 2e20 452e 672e 2074 6865 2075 6e69 636f  . E.g. the unico
-0000c800: 6465 2063 6861 7261 6374 6572 2055 2b34  de character U+4
-0000c810: 4532 4420 7769 6c6c 2062 650a 2020 2020  E2D will be.    
-0000c820: 636f 6e76 6572 7465 6420 696e 746f 2027  converted into '
-0000c830: 2534 4525 3244 272e 2054 6573 7469 6e67  %4E%2D'. Testing
-0000c840: 2077 6974 6820 4669 7265 666f 7820 7633   with Firefox v3
-0000c850: 2e30 2e35 2068 6173 2073 686f 776e 2074  .0.5 has shown t
-0000c860: 6861 7420 6974 2063 616e 0a20 2020 2075  hat it can.    u
-0000c870: 6e64 6572 7374 616e 6420 7468 6973 206b  nderstand this k
-0000c880: 696e 6420 6f66 2055 5249 2065 6e63 6f64  ind of URI encod
-0000c890: 696e 672e 0a0a 2020 2020 4172 6773 3a0a  ing...    Args:.
-0000c8a0: 2020 2020 2020 2020 7572 6c3a 2075 6e69          url: uni
-0000c8b0: 636f 6465 2073 7472 696e 672c 2074 6865  code string, the
-0000c8c0: 2055 524c 2074 6f20 636f 6e76 6572 7420   URL to convert 
-0000c8d0: 6672 6f6d 2075 6e69 636f 6465 2069 6e74  from unicode int
-0000c8e0: 6f20 5553 2d41 5343 4949 0a20 2020 2020  o US-ASCII.     
-0000c8f0: 2020 2070 7265 7065 6e64 5f73 6368 656d     prepend_schem
-0000c900: 653a 2073 7472 696e 672c 2061 2070 726f  e: string, a pro
-0000c910: 746f 636f 6c20 7363 6865 6d65 2074 6f20  tocol scheme to 
-0000c920: 7072 6570 656e 6420 746f 2074 6865 2055  prepend to the U
-0000c930: 524c 2069 660a 2020 2020 2020 2020 2020  RL if.          
-0000c940: 2020 7765 2772 6520 6861 7669 6e67 2074    we're having t
-0000c950: 726f 7562 6c65 2070 6172 7369 6e67 2069  rouble parsing i
-0000c960: 742e 0a20 2020 2020 2020 2020 2020 2065  t..            e
-0000c970: 2e67 2e20 2268 7474 7022 2e20 496e 7075  .g. "http". Inpu
-0000c980: 7420 4e6f 6e65 2074 6f20 6469 7361 626c  t None to disabl
-0000c990: 6520 7468 6973 2066 756e 6374 696f 6e61  e this functiona
-0000c9a0: 6c69 7479 0a0a 2020 2020 5265 7475 726e  lity..    Return
-0000c9b0: 733a 0a20 2020 2020 2020 2073 7472 696e  s:.        strin
-0000c9c0: 673a 2061 2055 532d 4153 4349 4920 6571  g: a US-ASCII eq
-0000c9d0: 7569 7661 6c65 6e74 206f 6620 7468 6520  uivalent of the 
-0000c9e0: 696e 7075 7474 6564 2075 726c 0a0a 2020  inputted url..  
-0000c9f0: 2020 4061 7574 686f 723a 204a 6f6e 6174    @author: Jonat
-0000ca00: 6861 6e20 4265 6e6e 0a20 2020 2022 2222  han Benn.    """
-0000ca10: 0a20 2020 2023 2063 6f6e 7665 7274 2074  .    # convert t
-0000ca20: 6865 2061 7574 686f 7269 7479 2063 6f6d  he authority com
-0000ca30: 706f 6e65 6e74 206f 6620 7468 6520 5552  ponent of the UR
-0000ca40: 4c20 696e 746f 2061 6e20 4153 4349 4920  L into an ASCII 
-0000ca50: 7075 6e79 636f 6465 2073 7472 696e 672c  punycode string,
-0000ca60: 0a20 2020 2023 2062 7574 2065 6e63 6f64  .    # but encod
-0000ca70: 6520 7468 6520 7265 7374 2075 7369 6e67  e the rest using
-0000ca80: 2074 6865 2072 6567 756c 6172 2055 5249   the regular URI
-0000ca90: 2063 6861 7261 6374 6572 2065 6e63 6f64   character encod
-0000caa0: 696e 670a 2020 2020 636f 6d70 6f6e 656e  ing.    componen
-0000cab0: 7473 203d 2075 726c 7061 7273 652e 7572  ts = urlparse.ur
-0000cac0: 6c70 6172 7365 2875 726c 290a 2020 2020  lparse(url).    
-0000cad0: 7072 6570 656e 6465 6420 3d20 4661 6c73  prepended = Fals
-0000cae0: 650a 2020 2020 2320 4966 206e 6f20 6175  e.    # If no au
-0000caf0: 7468 6f72 6974 7920 7761 7320 666f 756e  thority was foun
-0000cb00: 640a 2020 2020 6966 206e 6f74 2063 6f6d  d.    if not com
-0000cb10: 706f 6e65 6e74 732e 6e65 746c 6f63 3a0a  ponents.netloc:.
-0000cb20: 2020 2020 2020 2020 2320 5472 7920 6170          # Try ap
-0000cb30: 7065 6e64 696e 6720 6120 7363 6865 6d65  pending a scheme
-0000cb40: 2074 6f20 7365 6520 6966 2074 6861 7420   to see if that 
-0000cb50: 6669 7865 7320 7468 6520 7072 6f62 6c65  fixes the proble
-0000cb60: 6d0a 2020 2020 2020 2020 7363 6865 6d65  m.        scheme
-0000cb70: 5f74 6f5f 7072 6570 656e 6420 3d20 7072  _to_prepend = pr
-0000cb80: 6570 656e 645f 7363 6865 6d65 206f 7220  epend_scheme or 
-0000cb90: 2268 7474 7022 0a20 2020 2020 2020 2063  "http".        c
-0000cba0: 6f6d 706f 6e65 6e74 7320 3d20 7572 6c70  omponents = urlp
-0000cbb0: 6172 7365 2e75 726c 7061 7273 6528 746f  arse.urlparse(to
-0000cbc0: 5f75 6e69 636f 6465 2873 6368 656d 655f  _unicode(scheme_
-0000cbd0: 746f 5f70 7265 7065 6e64 2920 2b20 223a  to_prepend) + ":
-0000cbe0: 2f2f 2220 2b20 7572 6c29 0a20 2020 2020  //" + url).     
-0000cbf0: 2020 2070 7265 7065 6e64 6564 203d 2054     prepended = T
-0000cc00: 7275 650a 0a20 2020 2023 2069 6620 7765  rue..    # if we
-0000cc10: 2073 7469 6c6c 2063 616e 2774 2066 696e   still can't fin
-0000cc20: 6420 7468 6520 6175 7468 6f72 6974 790a  d the authority.
-0000cc30: 2020 2020 6966 206e 6f74 2063 6f6d 706f      if not compo
-0000cc40: 6e65 6e74 732e 6e65 746c 6f63 3a0a 2020  nents.netloc:.  
-0000cc50: 2020 2020 2020 2320 416e 6420 6974 2773        # And it's
-0000cc60: 206e 6f74 2062 6563 6175 7365 2074 6865   not because the
-0000cc70: 2075 726c 2069 7320 6120 7265 6c61 7469   url is a relati
-0000cc80: 7665 2075 726c 0a20 2020 2020 2020 2069  ve url.        i
-0000cc90: 6620 6e6f 7420 7572 6c2e 7374 6172 7473  f not url.starts
-0000cca0: 7769 7468 2822 2f22 293a 0a20 2020 2020  with("/"):.     
-0000ccb0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-0000ccc0: 6570 7469 6f6e 280a 2020 2020 2020 2020  eption(.        
-0000ccd0: 2020 2020 2020 2020 224e 6f20 6175 7468          "No auth
-0000cce0: 6f72 6974 7920 636f 6d70 6f6e 656e 7420  ority component 
-0000ccf0: 666f 756e 642c 2022 0a20 2020 2020 2020  found, ".       
-0000cd00: 2020 2020 2020 2020 202b 2022 636f 756c           + "coul
-0000cd10: 6420 6e6f 7420 6465 636f 6465 2075 6e69  d not decode uni
-0000cd20: 636f 6465 2074 6f20 5553 2d41 5343 4949  code to US-ASCII
-0000cd30: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0000cd40: 0a20 2020 2023 2057 6527 7265 2068 6572  .    # We're her
-0000cd50: 6520 6966 2077 6520 666f 756e 6420 616e  e if we found an
-0000cd60: 2061 7574 686f 7269 7479 2c20 6c65 7427   authority, let'
-0000cd70: 7320 7265 6275 696c 6420 7468 6520 5552  s rebuild the UR
-0000cd80: 4c0a 2020 2020 7363 6865 6d65 203d 2063  L.    scheme = c
-0000cd90: 6f6d 706f 6e65 6e74 732e 7363 6865 6d65  omponents.scheme
-0000cda0: 0a20 2020 2061 7574 686f 7269 7479 203d  .    authority =
-0000cdb0: 2063 6f6d 706f 6e65 6e74 732e 6e65 746c   components.netl
-0000cdc0: 6f63 0a20 2020 2070 6174 6820 3d20 636f  oc.    path = co
-0000cdd0: 6d70 6f6e 656e 7473 2e70 6174 680a 2020  mponents.path.  
-0000cde0: 2020 7175 6572 7920 3d20 636f 6d70 6f6e    query = compon
-0000cdf0: 656e 7473 2e71 7565 7279 0a20 2020 2066  ents.query.    f
-0000ce00: 7261 676d 656e 7420 3d20 636f 6d70 6f6e  ragment = compon
-0000ce10: 656e 7473 2e66 7261 676d 656e 740a 0a20  ents.fragment.. 
-0000ce20: 2020 2069 6620 7072 6570 656e 6465 643a     if prepended:
-0000ce30: 0a20 2020 2020 2020 2073 6368 656d 6520  .        scheme 
-0000ce40: 3d20 2222 0a0a 2020 2020 756e 7061 7273  = ""..    unpars
-0000ce50: 6564 203d 2075 726c 7061 7273 652e 7572  ed = urlparse.ur
-0000ce60: 6c75 6e70 6172 7365 280a 2020 2020 2020  lunparse(.      
-0000ce70: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0000ce80: 7363 6865 6d65 2c0a 2020 2020 2020 2020  scheme,.        
-0000ce90: 2020 2020 756e 6963 6f64 655f 746f 5f61      unicode_to_a
-0000cea0: 7363 6969 5f61 7574 686f 7269 7479 2861  scii_authority(a
-0000ceb0: 7574 686f 7269 7479 292c 0a20 2020 2020  uthority),.     
-0000cec0: 2020 2020 2020 2065 7363 6170 655f 756e         escape_un
-0000ced0: 6963 6f64 6528 7061 7468 292c 0a20 2020  icode(path),.   
-0000cee0: 2020 2020 2020 2020 2022 222c 0a20 2020           "",.   
-0000cef0: 2020 2020 2020 2020 2065 7363 6170 655f           escape_
-0000cf00: 756e 6963 6f64 6528 7175 6572 7929 2c0a  unicode(query),.
-0000cf10: 2020 2020 2020 2020 2020 2020 7374 7228              str(
-0000cf20: 6672 6167 6d65 6e74 292c 0a20 2020 2020  fragment),.     
-0000cf30: 2020 2029 0a20 2020 2029 0a20 2020 2069     ).    ).    i
-0000cf40: 6620 756e 7061 7273 6564 2e73 7461 7274  f unparsed.start
-0000cf50: 7377 6974 6828 222f 2f22 293a 0a20 2020  swith("//"):.   
-0000cf60: 2020 2020 2075 6e70 6172 7365 6420 3d20       unparsed = 
-0000cf70: 756e 7061 7273 6564 5b32 3a5d 2020 2320  unparsed[2:]  # 
-0000cf80: 5265 6d6f 7665 2074 6865 202f 2f20 7572  Remove the // ur
-0000cf90: 6c75 6e70 6172 7365 2070 7574 7320 696e  lunparse puts in
-0000cfa0: 2074 6865 2062 6567 696e 6e69 6e67 0a20   the beginning. 
-0000cfb0: 2020 2072 6574 7572 6e20 756e 7061 7273     return unpars
-0000cfc0: 6564 0a0a 0a63 6c61 7373 2049 535f 4745  ed...class IS_GE
-0000cfd0: 4e45 5249 435f 5552 4c28 5661 6c69 6461  NERIC_URL(Valida
-0000cfe0: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
-0000cff0: 2020 5265 6a65 6374 7320 6120 5552 4c20    Rejects a URL 
-0000d000: 7374 7269 6e67 2069 6620 616e 7920 6f66  string if any of
-0000d010: 2074 6865 2066 6f6c 6c6f 7769 6e67 2069   the following i
-0000d020: 7320 7472 7565 3a0a 2020 2020 2020 202a  s true:.       *
-0000d030: 2054 6865 2073 7472 696e 6720 6973 2065   The string is e
-0000d040: 6d70 7479 206f 7220 4e6f 6e65 0a20 2020  mpty or None.   
-0000d050: 2020 2020 2a20 5468 6520 7374 7269 6e67      * The string
-0000d060: 2075 7365 7320 6368 6172 6163 7465 7273   uses characters
-0000d070: 2074 6861 7420 6172 6520 6e6f 7420 616c   that are not al
-0000d080: 6c6f 7765 6420 696e 2061 2055 524c 0a20  lowed in a URL. 
-0000d090: 2020 2020 2020 2a20 5468 6520 5552 4c20        * The URL 
-0000d0a0: 7363 6865 6d65 2073 7065 6369 6669 6564  scheme specified
-0000d0b0: 2028 6966 206f 6e65 2069 7320 7370 6563   (if one is spec
-0000d0c0: 6966 6965 6429 2069 7320 6e6f 7420 7661  ified) is not va
-0000d0d0: 6c69 640a 0a20 2020 2042 6173 6564 206f  lid..    Based o
-0000d0e0: 6e20 5246 4320 3233 3936 3a20 6874 7470  n RFC 2396: http
-0000d0f0: 3a2f 2f77 7777 2e66 6171 732e 6f72 672f  ://www.faqs.org/
-0000d100: 7266 6373 2f72 6663 3233 3936 2e68 746d  rfcs/rfc2396.htm
-0000d110: 6c0a 0a20 2020 2054 6869 7320 6675 6e63  l..    This func
-0000d120: 7469 6f6e 206f 6e6c 7920 6368 6563 6b73  tion only checks
-0000d130: 2074 6865 2055 524c 2773 2073 796e 7461   the URL's synta
-0000d140: 782e 2049 7420 646f 6573 206e 6f74 2063  x. It does not c
-0000d150: 6865 636b 2074 6861 7420 7468 6520 5552  heck that the UR
-0000d160: 4c0a 2020 2020 706f 696e 7473 2074 6f20  L.    points to 
-0000d170: 6120 7265 616c 2064 6f63 756d 656e 742c  a real document,
-0000d180: 2066 6f72 2065 7861 6d70 6c65 2c20 6f72   for example, or
-0000d190: 2074 6861 7420 6974 206f 7468 6572 7769   that it otherwi
-0000d1a0: 7365 206d 616b 6573 2073 656e 7365 0a20  se makes sense. 
-0000d1b0: 2020 2073 656d 616e 7469 6361 6c6c 792e     semantically.
-0000d1c0: 2054 6869 7320 6675 6e63 7469 6f6e 2064   This function d
-0000d1d0: 6f65 7320 6175 746f 6d61 7469 6361 6c6c  oes automaticall
-0000d1e0: 7920 7072 6570 656e 6420 2768 7474 703a  y prepend 'http:
-0000d1f0: 2f2f 2720 696e 2066 726f 6e74 0a20 2020  //' in front.   
-0000d200: 206f 6620 6120 5552 4c20 6966 2061 6e64   of a URL if and
-0000d210: 206f 6e6c 7920 6966 2074 6861 7427 7320   only if that's 
-0000d220: 6e65 6365 7373 6172 7920 746f 2073 7563  necessary to suc
-0000d230: 6365 7373 6675 6c6c 7920 7061 7273 6520  cessfully parse 
-0000d240: 7468 6520 5552 4c2e 0a20 2020 2050 6c65  the URL..    Ple
-0000d250: 6173 6520 6e6f 7465 2074 6861 7420 6120  ase note that a 
-0000d260: 7363 6865 6d65 2077 696c 6c20 6265 2070  scheme will be p
-0000d270: 7265 7065 6e64 6564 206f 6e6c 7920 666f  repended only fo
-0000d280: 7220 7261 7265 2063 6173 6573 0a20 2020  r rare cases.   
-0000d290: 2028 652e 672e 2027 676f 6f67 6c65 2e63   (e.g. 'google.c
-0000d2a0: 613a 3830 2729 0a0a 2020 2020 5468 6520  a:80')..    The 
-0000d2b0: 6c69 7374 206f 6620 616c 6c6f 7765 6420  list of allowed 
-0000d2c0: 7363 6865 6d65 7320 6973 2063 7573 746f  schemes is custo
-0000d2d0: 6d69 7a61 626c 6520 7769 7468 2074 6865  mizable with the
-0000d2e0: 2061 6c6c 6f77 6564 5f73 6368 656d 6573   allowed_schemes
-0000d2f0: 0a20 2020 2070 6172 616d 6574 6572 2e20  .    parameter. 
-0000d300: 4966 2079 6f75 2065 7863 6c75 6465 204e  If you exclude N
-0000d310: 6f6e 6520 6672 6f6d 2074 6865 206c 6973  one from the lis
-0000d320: 742c 2074 6865 6e20 6162 6272 6576 6961  t, then abbrevia
-0000d330: 7465 6420 5552 4c73 0a20 2020 2028 6c61  ted URLs.    (la
-0000d340: 636b 696e 6720 6120 7363 6865 6d65 2073  cking a scheme s
-0000d350: 7563 6820 6173 2027 6874 7470 2729 2077  uch as 'http') w
-0000d360: 696c 6c20 6265 2072 656a 6563 7465 642e  ill be rejected.
-0000d370: 0a0a 2020 2020 5468 6520 6465 6661 756c  ..    The defaul
-0000d380: 7420 7072 6570 656e 6465 6420 7363 6865  t prepended sche
-0000d390: 6d65 2069 7320 6375 7374 6f6d 697a 6162  me is customizab
-0000d3a0: 6c65 2077 6974 6820 7468 6520 7072 6570  le with the prep
-0000d3b0: 656e 645f 7363 6865 6d65 0a20 2020 2070  end_scheme.    p
-0000d3c0: 6172 616d 6574 6572 2e20 4966 2079 6f75  arameter. If you
-0000d3d0: 2073 6574 2070 7265 7065 6e64 5f73 6368   set prepend_sch
-0000d3e0: 656d 6520 746f 204e 6f6e 6520 7468 656e  eme to None then
-0000d3f0: 2070 7265 7065 6e64 696e 6720 7769 6c6c   prepending will
-0000d400: 2062 650a 2020 2020 6469 7361 626c 6564   be.    disabled
-0000d410: 2e20 5552 4c73 2074 6861 7420 7265 7175  . URLs that requ
-0000d420: 6972 6520 7072 6570 656e 6469 6e67 2074  ire prepending t
-0000d430: 6f20 7061 7273 6520 7769 6c6c 2073 7469  o parse will sti
-0000d440: 6c6c 2062 6520 6163 6365 7074 6564 2c0a  ll be accepted,.
-0000d450: 2020 2020 6275 7420 7468 6520 7265 7475      but the retu
-0000d460: 726e 2076 616c 7565 2077 696c 6c20 6e6f  rn value will no
-0000d470: 7420 6265 206d 6f64 6966 6965 642e 0a0a  t be modified...
-0000d480: 2020 2020 4061 7574 686f 723a 204a 6f6e      @author: Jon
-0000d490: 6174 6861 6e20 4265 6e6e 0a0a 2020 2020  athan Benn..    
-0000d4a0: 2020 2020 3e3e 3e20 4953 5f47 454e 4552      >>> IS_GENER
-0000d4b0: 4943 5f55 524c 2829 2827 6874 7470 3a2f  IC_URL()('http:/
-0000d4c0: 2f75 7365 7240 6162 632e 636f 6d27 290a  /user@abc.com').
-0000d4d0: 2020 2020 2020 2020 2827 6874 7470 3a2f          ('http:/
-0000d4e0: 2f75 7365 7240 6162 632e 636f 6d27 2c20  /user@abc.com', 
-0000d4f0: 4e6f 6e65 290a 0a20 2020 2041 7267 733a  None)..    Args:
-0000d500: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000d510: 6573 7361 6765 3a20 6120 7374 7269 6e67  essage: a string
-0000d520: 2c20 7468 6520 6572 726f 7220 6d65 7373  , the error mess
-0000d530: 6167 6520 746f 2067 6976 6520 7468 6520  age to give the 
-0000d540: 656e 6420 7573 6572 0a20 2020 2020 2020  end user.       
-0000d550: 2020 2020 2069 6620 7468 6520 5552 4c20       if the URL 
-0000d560: 646f 6573 206e 6f74 2076 616c 6964 6174  does not validat
-0000d570: 650a 2020 2020 2020 2020 616c 6c6f 7765  e.        allowe
-0000d580: 645f 7363 6865 6d65 733a 2061 206c 6973  d_schemes: a lis
-0000d590: 7420 636f 6e74 6169 6e69 6e67 2073 7472  t containing str
-0000d5a0: 696e 6773 206f 7220 4e6f 6e65 2e20 4561  ings or None. Ea
-0000d5b0: 6368 2065 6c65 6d65 6e74 0a20 2020 2020  ch element.     
-0000d5c0: 2020 2020 2020 2069 7320 6120 7363 6865         is a sche
-0000d5d0: 6d65 2074 6865 2069 6e70 7574 7465 6420  me the inputted 
-0000d5e0: 5552 4c20 6973 2061 6c6c 6f77 6564 2074  URL is allowed t
-0000d5f0: 6f20 7573 650a 2020 2020 2020 2020 7072  o use.        pr
-0000d600: 6570 656e 645f 7363 6865 6d65 3a20 6120  epend_scheme: a 
-0000d610: 7374 7269 6e67 2c20 7468 6973 2073 6368  string, this sch
-0000d620: 656d 6520 6973 2070 7265 7065 6e64 6564  eme is prepended
-0000d630: 2069 6620 6974 2773 0a20 2020 2020 2020   if it's.       
-0000d640: 2020 2020 206e 6563 6573 7361 7279 2074       necessary t
-0000d650: 6f20 6d61 6b65 2074 6865 2055 524c 2076  o make the URL v
-0000d660: 616c 6964 0a0a 2020 2020 2222 220a 0a20  alid..    """.. 
-0000d670: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0000d680: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000d690: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000d6a0: 7361 6765 3d22 456e 7465 7220 6120 7661  sage="Enter a va
-0000d6b0: 6c69 6420 5552 4c22 2c0a 2020 2020 2020  lid URL",.      
-0000d6c0: 2020 616c 6c6f 7765 645f 7363 6865 6d65    allowed_scheme
-0000d6d0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-0000d6e0: 7072 6570 656e 645f 7363 6865 6d65 3d4e  prepend_scheme=N
-0000d6f0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-0000d700: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
-0000d710: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
-0000d720: 6573 7361 6765 0a20 2020 2020 2020 2069  essage.        i
-0000d730: 6620 616c 6c6f 7765 645f 7363 6865 6d65  f allowed_scheme
-0000d740: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0000d750: 2020 2020 2020 2073 656c 662e 616c 6c6f         self.allo
-0000d760: 7765 645f 7363 6865 6d65 7320 3d20 616c  wed_schemes = al
-0000d770: 6c5f 7572 6c5f 7363 6865 6d65 730a 2020  l_url_schemes.  
-0000d780: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000d790: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
-0000d7a0: 6f77 6564 5f73 6368 656d 6573 203d 2061  owed_schemes = a
-0000d7b0: 6c6c 6f77 6564 5f73 6368 656d 6573 0a20  llowed_schemes. 
-0000d7c0: 2020 2020 2020 2073 656c 662e 7072 6570         self.prep
-0000d7d0: 656e 645f 7363 6865 6d65 203d 2070 7265  end_scheme = pre
-0000d7e0: 7065 6e64 5f73 6368 656d 650a 2020 2020  pend_scheme.    
-0000d7f0: 2020 2020 6966 2073 656c 662e 7072 6570      if self.prep
-0000d800: 656e 645f 7363 6865 6d65 206e 6f74 2069  end_scheme not i
-0000d810: 6e20 7365 6c66 2e61 6c6c 6f77 6564 5f73  n self.allowed_s
-0000d820: 6368 656d 6573 3a0a 2020 2020 2020 2020  chemes:.        
-0000d830: 2020 2020 7261 6973 6520 5379 6e74 6178      raise Syntax
-0000d840: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000d850: 2020 2020 2020 2022 7072 6570 656e 645f         "prepend_
-0000d860: 7363 6865 6d65 3d27 2573 2720 6973 206e  scheme='%s' is n
-0000d870: 6f74 2069 6e20 616c 6c6f 7765 645f 7363  ot in allowed_sc
-0000d880: 6865 6d65 733d 2573 220a 2020 2020 2020  hemes=%s".      
-0000d890: 2020 2020 2020 2020 2020 2520 2873 656c            % (sel
-0000d8a0: 662e 7072 6570 656e 645f 7363 6865 6d65  f.prepend_scheme
-0000d8b0: 2c20 7365 6c66 2e61 6c6c 6f77 6564 5f73  , self.allowed_s
-0000d8c0: 6368 656d 6573 290a 2020 2020 2020 2020  chemes).        
-0000d8d0: 2020 2020 290a 0a20 2020 2052 4547 4558      )..    REGEX
-0000d8e0: 5f47 454e 4552 4943 5f55 524c 203d 2072  _GENERIC_URL = r
-0000d8f0: 2225 5b5e 302d 3941 2d46 612d 665d 7b32  "%[^0-9A-Fa-f]{2
-0000d900: 7d7c 255b 5e30 2d39 412d 4661 2d66 5d5b  }|%[^0-9A-Fa-f][
-0000d910: 302d 3941 2d46 612d 665d 7c25 5b30 2d39  0-9A-Fa-f]|%[0-9
-0000d920: 412d 4661 2d66 5d5b 5e30 2d39 412d 4661  A-Fa-f][^0-9A-Fa
-0000d930: 2d66 5d7c 2524 7c25 5b30 2d39 412d 4661  -f]|%$|%[0-9A-Fa
-0000d940: 2d66 5d24 7c25 5b5e 302d 3941 2d46 612d  -f]$|%[^0-9A-Fa-
-0000d950: 665d 2422 0a20 2020 2052 4547 4558 5f47  f]$".    REGEX_G
-0000d960: 454e 4552 4943 5f55 524c 5f56 414c 4944  ENERIC_URL_VALID
-0000d970: 203d 2072 225b 412d 5a61 2d7a 302d 393b   = r"[A-Za-z0-9;
-0000d980: 2f3f 3a40 263d 2b24 2c5c 2d5f 5c2e 217e  /?:@&=+$,\-_\.!~
-0000d990: 2a27 5c28 5c29 255d 2b24 220a 2020 2020  *'\(\)%]+$".    
-0000d9a0: 5245 4745 585f 5552 4c5f 4652 4147 4d45  REGEX_URL_FRAGME
-0000d9b0: 4e54 5f56 414c 4944 203d 2072 225b 7c41  NT_VALID = r"[|A
-0000d9c0: 2d5a 612d 7a30 2d39 3b2f 3f3a 4026 3d2b  -Za-z0-9;/?:@&=+
-0000d9d0: 242c 5c2d 5f5c 2e21 7e2a 275c 285c 2925  $,\-_\.!~*'\(\)%
-0000d9e0: 5d2b 2422 0a0a 2020 2020 6465 6620 7661  ]+$"..    def va
-0000d9f0: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-0000da00: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-0000da10: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0000da20: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-0000da30: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0000da40: 3a20 6120 7374 7269 6e67 2c20 7468 6520  : a string, the 
-0000da50: 5552 4c20 746f 2076 616c 6964 6174 650a  URL to validate.
-0000da60: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000da70: 3a0a 2020 2020 2020 2020 2020 2020 6120  :.            a 
-0000da80: 7475 706c 652c 2077 6865 7265 2074 7570  tuple, where tup
-0000da90: 6c65 5b30 5d20 6973 2074 6865 2069 6e70  le[0] is the inp
-0000daa0: 7574 7465 6420 7661 6c75 6520 2870 6f73  utted value (pos
-0000dab0: 7369 626c 650a 2020 2020 2020 2020 2020  sible.          
-0000dac0: 2020 7072 6570 656e 6465 6420 7769 7468    prepended with
-0000dad0: 2070 7265 7065 6e64 5f73 6368 656d 6529   prepend_scheme)
-0000dae0: 2c20 616e 6420 7475 706c 655b 315d 2069  , and tuple[1] i
-0000daf0: 7320 6569 7468 6572 0a20 2020 2020 2020  s either.       
-0000db00: 2020 2020 204e 6f6e 6520 2873 7563 6365       None (succe
-0000db10: 7373 2129 206f 7220 7468 6520 7374 7269  ss!) or the stri
-0000db20: 6e67 2065 7272 6f72 5f6d 6573 7361 6765  ng error_message
-0000db30: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000db40: 2020 2020 2020 2320 6966 2077 6520 646f        # if we do
-0000db50: 6e74 2068 6176 6520 616e 7974 6869 6e67  nt have anything
-0000db60: 206f 7220 7468 6520 5552 4c20 6d69 7375   or the URL misu
-0000db70: 7365 7320 7468 6520 2725 2720 6368 6172  ses the '%' char
-0000db80: 6163 7465 720a 0a20 2020 2020 2020 2069  acter..        i
-0000db90: 6620 6e6f 7420 7661 6c75 6520 6f72 2072  f not value or r
-0000dba0: 652e 7365 6172 6368 2873 656c 662e 5245  e.search(self.RE
-0000dbb0: 4745 585f 4745 4e45 5249 435f 5552 4c2c  GEX_GENERIC_URL,
-0000dbc0: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
-0000dbd0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-0000dbe0: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-0000dbf0: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-0000dc00: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
-0000dc10: 0a20 2020 2020 2020 2069 6620 2223 2220  .        if "#" 
-0000dc20: 696e 2076 616c 7565 3a0a 2020 2020 2020  in value:.      
-0000dc30: 2020 2020 2020 7572 6c2c 2066 7261 676d        url, fragm
-0000dc40: 656e 745f 7061 7274 203d 2076 616c 7565  ent_part = value
-0000dc50: 2e73 706c 6974 2822 2322 290a 2020 2020  .split("#").    
-0000dc60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000dc70: 2020 2020 2020 7572 6c2c 2066 7261 676d        url, fragm
-0000dc80: 656e 745f 7061 7274 203d 2076 616c 7565  ent_part = value
-0000dc90: 2c20 2222 0a20 2020 2020 2020 2023 2069  , "".        # i
-0000dca0: 6620 7468 6520 5552 4c20 6973 206f 6e6c  f the URL is onl
-0000dcb0: 7920 636f 6d70 6f73 6564 206f 6620 7661  y composed of va
-0000dcc0: 6c69 6420 6368 6172 6163 7465 7273 0a20  lid characters. 
-0000dcd0: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-0000dce0: 2e6d 6174 6368 2873 656c 662e 5245 4745  .match(self.REGE
-0000dcf0: 585f 4745 4e45 5249 435f 5552 4c5f 5641  X_GENERIC_URL_VA
-0000dd00: 4c49 442c 2075 726c 2920 6f72 2028 0a20  LID, url) or (. 
-0000dd10: 2020 2020 2020 2020 2020 2066 7261 676d             fragm
-0000dd20: 656e 745f 7061 7274 2061 6e64 206e 6f74  ent_part and not
-0000dd30: 2072 652e 6d61 7463 6828 7365 6c66 2e52   re.match(self.R
-0000dd40: 4547 4558 5f55 524c 5f46 5241 474d 454e  EGEX_URL_FRAGMEN
-0000dd50: 545f 5641 4c49 442c 2066 7261 676d 656e  T_VALID, fragmen
-0000dd60: 745f 7061 7274 290a 2020 2020 2020 2020  t_part).        
-0000dd70: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000dd80: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-0000dd90: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
-0000dda0: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
-0000ddb0: 6d65 7373 6167 6529 290a 2020 2020 2020  message)).      
-0000ddc0: 2020 2320 5468 656e 2070 6172 7365 2074    # Then parse t
-0000ddd0: 6865 2055 524c 2069 6e74 6f20 6974 7320  he URL into its 
-0000dde0: 636f 6d70 6f6e 656e 7473 2061 6e64 2063  components and c
-0000ddf0: 6865 636b 206f 6e0a 2020 2020 2020 2020  heck on.        
-0000de00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000de10: 2063 6f6d 706f 6e65 6e74 7320 3d20 7572   components = ur
-0000de20: 6c70 6172 7365 2e75 726c 7061 7273 6528  lparse.urlparse(
-0000de30: 7572 6c6c 6962 5f75 6e71 756f 7465 2876  urllib_unquote(v
-0000de40: 616c 7565 2929 2e5f 6173 6469 6374 2829  alue))._asdict()
-0000de50: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000de60: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
-0000de70: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000de80: 6c69 6461 7469 6f6e 4572 726f 7228 7365  lidationError(se
-0000de90: 6c66 2e74 7261 6e73 6c61 746f 7228 7365  lf.translator(se
-0000dea0: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-0000deb0: 2929 0a0a 2020 2020 2020 2020 2320 436c  ))..        # Cl
-0000dec0: 6561 6e20 7570 2074 6865 2073 6368 656d  ean up the schem
-0000ded0: 6520 6265 666f 7265 2077 6520 6368 6563  e before we chec
-0000dee0: 6b20 6974 0a20 2020 2020 2020 2073 6368  k it.        sch
-0000def0: 656d 6520 3d20 636f 6d70 6f6e 656e 7473  eme = components
-0000df00: 5b22 7363 6865 6d65 225d 0a20 2020 2020  ["scheme"].     
-0000df10: 2020 2069 6620 6c65 6e28 7363 6865 6d65     if len(scheme
-0000df20: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-0000df30: 2020 2020 7363 6865 6d65 203d 204e 6f6e      scheme = Non
-0000df40: 650a 2020 2020 2020 2020 656c 7365 3a0a  e.        else:.
-0000df50: 2020 2020 2020 2020 2020 2020 7363 6865              sche
-0000df60: 6d65 203d 2063 6f6d 706f 6e65 6e74 735b  me = components[
-0000df70: 2273 6368 656d 6522 5d2e 6c6f 7765 7228  "scheme"].lower(
-0000df80: 290a 2020 2020 2020 2020 2320 4966 2074  ).        # If t
-0000df90: 6865 2073 6368 656d 6520 646f 6573 6e27  he scheme doesn'
-0000dfa0: 7420 7265 616c 6c79 2065 7869 7374 730a  t really exists.
-0000dfb0: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
-0000dfc0: 2020 2020 2020 2020 2073 6368 656d 6520           scheme 
-0000dfd0: 6e6f 7420 696e 2073 656c 662e 616c 6c6f  not in self.allo
-0000dfe0: 7765 645f 7363 6865 6d65 730a 2020 2020  wed_schemes.    
-0000dff0: 2020 2020 2020 2020 6f72 206e 6f74 2073          or not s
-0000e000: 6368 656d 650a 2020 2020 2020 2020 2020  cheme.          
-0000e010: 2020 616e 6420 223a 2220 696e 2063 6f6d    and ":" in com
-0000e020: 706f 6e65 6e74 735b 2270 6174 6822 5d0a  ponents["path"].
-0000e030: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0000e040: 2020 2020 2020 2023 2066 6f72 2074 6865         # for the
-0000e050: 2070 6f73 7369 626c 6520 6361 7365 206f   possible case o
-0000e060: 6620 6162 6272 6576 6961 7465 6420 5552  f abbreviated UR
-0000e070: 4c73 2077 6974 680a 2020 2020 2020 2020  Ls with.        
-0000e080: 2020 2020 2320 706f 7274 732c 2063 6865      # ports, che
-0000e090: 636b 2074 6f20 7365 6520 6966 2061 6464  ck to see if add
-0000e0a0: 696e 6720 6120 7661 6c69 6420 7363 6865  ing a valid sche
-0000e0b0: 6d65 2066 6978 6573 0a20 2020 2020 2020  me fixes.       
-0000e0c0: 2020 2020 2023 2074 6865 2070 726f 626c       # the probl
-0000e0d0: 656d 2028 6275 7420 6f6e 6c79 2064 6f20  em (but only do 
-0000e0e0: 7468 6973 2069 6620 6974 2064 6f65 736e  this if it doesn
-0000e0f0: 2774 2068 6176 650a 2020 2020 2020 2020  't have.        
-0000e100: 2020 2020 2320 6f6e 6520 616c 7265 6164      # one alread
-0000e110: 7921 290a 2020 2020 2020 2020 2020 2020  y!).            
-0000e120: 6966 2022 3a2f 2f22 206e 6f74 2069 6e20  if "://" not in 
-0000e130: 7661 6c75 6520 616e 6420 4e6f 6e65 2069  value and None i
-0000e140: 6e20 7365 6c66 2e61 6c6c 6f77 6564 5f73  n self.allowed_s
-0000e150: 6368 656d 6573 3a0a 2020 2020 2020 2020  chemes:.        
-0000e160: 2020 2020 2020 2020 7363 6865 6d65 546f          schemeTo
-0000e170: 5573 6520 3d20 7365 6c66 2e70 7265 7065  Use = self.prepe
-0000e180: 6e64 5f73 6368 656d 6520 6f72 2022 6874  nd_scheme or "ht
-0000e190: 7470 220a 2020 2020 2020 2020 2020 2020  tp".            
-0000e1a0: 2020 2020 6e65 775f 7661 6c75 6520 3d20      new_value = 
-0000e1b0: 7365 6c66 2e76 616c 6964 6174 6528 7363  self.validate(sc
-0000e1c0: 6865 6d65 546f 5573 6520 2b20 223a 2f2f  hemeToUse + "://
-0000e1d0: 2220 2b20 7661 6c75 6529 0a20 2020 2020  " + value).     
-0000e1e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000e1f0: 6e20 6e65 775f 7661 6c75 6520 6966 2073  n new_value if s
-0000e200: 656c 662e 7072 6570 656e 645f 7363 6865  elf.prepend_sche
-0000e210: 6d65 2065 6c73 6520 7661 6c75 650a 2020  me else value.  
-0000e220: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e230: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
-0000e240: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-0000e250: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
-0000e260: 6765 2929 0a20 2020 2020 2020 2072 6574  ge)).        ret
-0000e270: 7572 6e20 7661 6c75 650a 0a0a 2320 536f  urn value...# So
-0000e280: 7572 6365 7320 286f 6274 6169 6e65 6420  urces (obtained 
-0000e290: 3230 3137 2d4e 6f76 2d31 3129 3a0a 2320  2017-Nov-11):.# 
-0000e2a0: 2020 2068 7474 703a 2f2f 6461 7461 2e69     http://data.i
-0000e2b0: 616e 612e 6f72 672f 544c 442f 746c 6473  ana.org/TLD/tlds
-0000e2c0: 2d61 6c70 6861 2d62 792d 646f 6d61 696e  -alpha-by-domain
-0000e2d0: 2e74 7874 0a23 2073 6565 2073 6372 6970  .txt.# see scrip
-0000e2e0: 7473 2f70 6172 7365 5f74 6f70 5f6c 6576  ts/parse_top_lev
-0000e2f0: 656c 5f64 6f6d 6169 6e73 2e70 7920 666f  el_domains.py fo
-0000e300: 7220 616e 2065 6173 7920 7570 6461 7465  r an easy update
-0000e310: 0a0a 6f66 6669 6369 616c 5f74 6f70 5f6c  ..official_top_l
-0000e320: 6576 656c 5f64 6f6d 6169 6e73 203d 205b  evel_domains = [
-0000e330: 0a20 2020 2023 2061 0a20 2020 2022 6161  .    # a.    "aa
-0000e340: 6122 2c0a 2020 2020 2261 6172 7022 2c0a  a",.    "aarp",.
-0000e350: 2020 2020 2261 6261 7274 6822 2c0a 2020      "abarth",.  
-0000e360: 2020 2261 6262 222c 0a20 2020 2022 6162    "abb",.    "ab
-0000e370: 626f 7474 222c 0a20 2020 2022 6162 6276  bott",.    "abbv
-0000e380: 6965 222c 0a20 2020 2022 6162 6322 2c0a  ie",.    "abc",.
-0000e390: 2020 2020 2261 626c 6522 2c0a 2020 2020      "able",.    
-0000e3a0: 2261 626f 6761 646f 222c 0a20 2020 2022  "abogado",.    "
-0000e3b0: 6162 7564 6861 6269 222c 0a20 2020 2022  abudhabi",.    "
-0000e3c0: 6163 222c 0a20 2020 2022 6163 6164 656d  ac",.    "academ
-0000e3d0: 7922 2c0a 2020 2020 2261 6363 656e 7475  y",.    "accentu
-0000e3e0: 7265 222c 0a20 2020 2022 6163 636f 756e  re",.    "accoun
-0000e3f0: 7461 6e74 222c 0a20 2020 2022 6163 636f  tant",.    "acco
-0000e400: 756e 7461 6e74 7322 2c0a 2020 2020 2261  untants",.    "a
-0000e410: 636f 222c 0a20 2020 2022 6163 7469 7665  co",.    "active
-0000e420: 222c 0a20 2020 2022 6163 746f 7222 2c0a  ",.    "actor",.
-0000e430: 2020 2020 2261 6422 2c0a 2020 2020 2261      "ad",.    "a
-0000e440: 6461 6322 2c0a 2020 2020 2261 6473 222c  dac",.    "ads",
-0000e450: 0a20 2020 2022 6164 756c 7422 2c0a 2020  .    "adult",.  
-0000e460: 2020 2261 6522 2c0a 2020 2020 2261 6567    "ae",.    "aeg
-0000e470: 222c 0a20 2020 2022 6165 726f 222c 0a20  ",.    "aero",. 
-0000e480: 2020 2022 6165 746e 6122 2c0a 2020 2020     "aetna",.    
-0000e490: 2261 6622 2c0a 2020 2020 2261 6661 6d69  "af",.    "afami
-0000e4a0: 6c79 636f 6d70 616e 7922 2c0a 2020 2020  lycompany",.    
-0000e4b0: 2261 666c 222c 0a20 2020 2022 6166 7269  "afl",.    "afri
-0000e4c0: 6361 222c 0a20 2020 2022 6167 222c 0a20  ca",.    "ag",. 
-0000e4d0: 2020 2022 6167 616b 6861 6e22 2c0a 2020     "agakhan",.  
-0000e4e0: 2020 2261 6765 6e63 7922 2c0a 2020 2020    "agency",.    
-0000e4f0: 2261 6922 2c0a 2020 2020 2261 6967 222c  "ai",.    "aig",
-0000e500: 0a20 2020 2022 6169 676f 222c 0a20 2020  .    "aigo",.   
-0000e510: 2022 6169 7262 7573 222c 0a20 2020 2022   "airbus",.    "
-0000e520: 6169 7266 6f72 6365 222c 0a20 2020 2022  airforce",.    "
-0000e530: 6169 7274 656c 222c 0a20 2020 2022 616b  airtel",.    "ak
-0000e540: 646e 222c 0a20 2020 2022 616c 222c 0a20  dn",.    "al",. 
-0000e550: 2020 2022 616c 6661 726f 6d65 6f22 2c0a     "alfaromeo",.
-0000e560: 2020 2020 2261 6c69 6261 6261 222c 0a20      "alibaba",. 
-0000e570: 2020 2022 616c 6970 6179 222c 0a20 2020     "alipay",.   
-0000e580: 2022 616c 6c66 696e 616e 7a22 2c0a 2020   "allfinanz",.  
-0000e590: 2020 2261 6c6c 7374 6174 6522 2c0a 2020    "allstate",.  
-0000e5a0: 2020 2261 6c6c 7922 2c0a 2020 2020 2261    "ally",.    "a
-0000e5b0: 6c73 6163 6522 2c0a 2020 2020 2261 6c73  lsace",.    "als
-0000e5c0: 746f 6d22 2c0a 2020 2020 2261 6d22 2c0a  tom",.    "am",.
-0000e5d0: 2020 2020 2261 6d65 7269 6361 6e65 7870      "americanexp
-0000e5e0: 7265 7373 222c 0a20 2020 2022 616d 6572  ress",.    "amer
-0000e5f0: 6963 616e 6661 6d69 6c79 222c 0a20 2020  icanfamily",.   
-0000e600: 2022 616d 6578 222c 0a20 2020 2022 616d   "amex",.    "am
-0000e610: 6661 6d22 2c0a 2020 2020 2261 6d69 6361  fam",.    "amica
-0000e620: 222c 0a20 2020 2022 616d 7374 6572 6461  ",.    "amsterda
-0000e630: 6d22 2c0a 2020 2020 2261 6e61 6c79 7469  m",.    "analyti
-0000e640: 6373 222c 0a20 2020 2022 616e 6472 6f69  cs",.    "androi
-0000e650: 6422 2c0a 2020 2020 2261 6e71 7561 6e22  d",.    "anquan"
-0000e660: 2c0a 2020 2020 2261 6e7a 222c 0a20 2020  ,.    "anz",.   
-0000e670: 2022 616f 222c 0a20 2020 2022 616f 6c22   "ao",.    "aol"
-0000e680: 2c0a 2020 2020 2261 7061 7274 6d65 6e74  ,.    "apartment
-0000e690: 7322 2c0a 2020 2020 2261 7070 222c 0a20  s",.    "app",. 
-0000e6a0: 2020 2022 6170 706c 6522 2c0a 2020 2020     "apple",.    
-0000e6b0: 2261 7122 2c0a 2020 2020 2261 7175 6172  "aq",.    "aquar
-0000e6c0: 656c 6c65 222c 0a20 2020 2022 6172 222c  elle",.    "ar",
-0000e6d0: 0a20 2020 2022 6172 6162 222c 0a20 2020  .    "arab",.   
-0000e6e0: 2022 6172 616d 636f 222c 0a20 2020 2022   "aramco",.    "
-0000e6f0: 6172 6368 6922 2c0a 2020 2020 2261 726d  archi",.    "arm
-0000e700: 7922 2c0a 2020 2020 2261 7270 6122 2c0a  y",.    "arpa",.
-0000e710: 2020 2020 2261 7274 222c 0a20 2020 2022      "art",.    "
-0000e720: 6172 7465 222c 0a20 2020 2022 6173 222c  arte",.    "as",
-0000e730: 0a20 2020 2022 6173 6461 222c 0a20 2020  .    "asda",.   
-0000e740: 2022 6173 6961 222c 0a20 2020 2022 6173   "asia",.    "as
-0000e750: 736f 6369 6174 6573 222c 0a20 2020 2022  sociates",.    "
-0000e760: 6174 222c 0a20 2020 2022 6174 686c 6574  at",.    "athlet
-0000e770: 6122 2c0a 2020 2020 2261 7474 6f72 6e65  a",.    "attorne
-0000e780: 7922 2c0a 2020 2020 2261 7522 2c0a 2020  y",.    "au",.  
-0000e790: 2020 2261 7563 7469 6f6e 222c 0a20 2020    "auction",.   
-0000e7a0: 2022 6175 6469 222c 0a20 2020 2022 6175   "audi",.    "au
-0000e7b0: 6469 626c 6522 2c0a 2020 2020 2261 7564  dible",.    "aud
-0000e7c0: 696f 222c 0a20 2020 2022 6175 7370 6f73  io",.    "auspos
-0000e7d0: 7422 2c0a 2020 2020 2261 7574 686f 7222  t",.    "author"
-0000e7e0: 2c0a 2020 2020 2261 7574 6f22 2c0a 2020  ,.    "auto",.  
-0000e7f0: 2020 2261 7574 6f73 222c 0a20 2020 2022    "autos",.    "
-0000e800: 6176 6961 6e63 6122 2c0a 2020 2020 2261  avianca",.    "a
-0000e810: 7722 2c0a 2020 2020 2261 7773 222c 0a20  w",.    "aws",. 
-0000e820: 2020 2022 6178 222c 0a20 2020 2022 6178     "ax",.    "ax
-0000e830: 6122 2c0a 2020 2020 2261 7a22 2c0a 2020  a",.    "az",.  
-0000e840: 2020 2261 7a75 7265 222c 0a20 2020 2023    "azure",.    #
-0000e850: 2062 0a20 2020 2022 6261 222c 0a20 2020   b.    "ba",.   
-0000e860: 2022 6261 6279 222c 0a20 2020 2022 6261   "baby",.    "ba
-0000e870: 6964 7522 2c0a 2020 2020 2262 616e 616d  idu",.    "banam
-0000e880: 6578 222c 0a20 2020 2022 6261 6e61 6e61  ex",.    "banana
-0000e890: 7265 7075 626c 6963 222c 0a20 2020 2022  republic",.    "
-0000e8a0: 6261 6e64 222c 0a20 2020 2022 6261 6e6b  band",.    "bank
-0000e8b0: 222c 0a20 2020 2022 6261 7222 2c0a 2020  ",.    "bar",.  
-0000e8c0: 2020 2262 6172 6365 6c6f 6e61 222c 0a20    "barcelona",. 
-0000e8d0: 2020 2022 6261 7263 6c61 7963 6172 6422     "barclaycard"
-0000e8e0: 2c0a 2020 2020 2262 6172 636c 6179 7322  ,.    "barclays"
-0000e8f0: 2c0a 2020 2020 2262 6172 6566 6f6f 7422  ,.    "barefoot"
-0000e900: 2c0a 2020 2020 2262 6172 6761 696e 7322  ,.    "bargains"
-0000e910: 2c0a 2020 2020 2262 6173 6562 616c 6c22  ,.    "baseball"
-0000e920: 2c0a 2020 2020 2262 6173 6b65 7462 616c  ,.    "basketbal
-0000e930: 6c22 2c0a 2020 2020 2262 6175 6861 7573  l",.    "bauhaus
-0000e940: 222c 0a20 2020 2022 6261 7965 726e 222c  ",.    "bayern",
-0000e950: 0a20 2020 2022 6262 222c 0a20 2020 2022  .    "bb",.    "
-0000e960: 6262 6322 2c0a 2020 2020 2262 6274 222c  bbc",.    "bbt",
-0000e970: 0a20 2020 2022 6262 7661 222c 0a20 2020  .    "bbva",.   
-0000e980: 2022 6263 6722 2c0a 2020 2020 2262 636e   "bcg",.    "bcn
-0000e990: 222c 0a20 2020 2022 6264 222c 0a20 2020  ",.    "bd",.   
-0000e9a0: 2022 6265 222c 0a20 2020 2022 6265 6174   "be",.    "beat
-0000e9b0: 7322 2c0a 2020 2020 2262 6561 7574 7922  s",.    "beauty"
-0000e9c0: 2c0a 2020 2020 2262 6565 7222 2c0a 2020  ,.    "beer",.  
-0000e9d0: 2020 2262 656e 746c 6579 222c 0a20 2020    "bentley",.   
-0000e9e0: 2022 6265 726c 696e 222c 0a20 2020 2022   "berlin",.    "
-0000e9f0: 6265 7374 222c 0a20 2020 2022 6265 7374  best",.    "best
-0000ea00: 6275 7922 2c0a 2020 2020 2262 6574 222c  buy",.    "bet",
-0000ea10: 0a20 2020 2022 6266 222c 0a20 2020 2022  .    "bf",.    "
-0000ea20: 6267 222c 0a20 2020 2022 6268 222c 0a20  bg",.    "bh",. 
-0000ea30: 2020 2022 6268 6172 7469 222c 0a20 2020     "bharti",.   
-0000ea40: 2022 6269 222c 0a20 2020 2022 6269 626c   "bi",.    "bibl
-0000ea50: 6522 2c0a 2020 2020 2262 6964 222c 0a20  e",.    "bid",. 
-0000ea60: 2020 2022 6269 6b65 222c 0a20 2020 2022     "bike",.    "
-0000ea70: 6269 6e67 222c 0a20 2020 2022 6269 6e67  bing",.    "bing
-0000ea80: 6f22 2c0a 2020 2020 2262 696f 222c 0a20  o",.    "bio",. 
-0000ea90: 2020 2022 6269 7a22 2c0a 2020 2020 2262     "biz",.    "b
-0000eaa0: 6a22 2c0a 2020 2020 2262 6c61 636b 222c  j",.    "black",
-0000eab0: 0a20 2020 2022 626c 6163 6b66 7269 6461  .    "blackfrida
-0000eac0: 7922 2c0a 2020 2020 2262 6c61 6e63 6f22  y",.    "blanco"
-0000ead0: 2c0a 2020 2020 2262 6c6f 636b 6275 7374  ,.    "blockbust
-0000eae0: 6572 222c 0a20 2020 2022 626c 6f67 222c  er",.    "blog",
-0000eaf0: 0a20 2020 2022 626c 6f6f 6d62 6572 6722  .    "bloomberg"
-0000eb00: 2c0a 2020 2020 2262 6c75 6522 2c0a 2020  ,.    "blue",.  
-0000eb10: 2020 2262 6d22 2c0a 2020 2020 2262 6d73    "bm",.    "bms
-0000eb20: 222c 0a20 2020 2022 626d 7722 2c0a 2020  ",.    "bmw",.  
-0000eb30: 2020 2262 6e22 2c0a 2020 2020 2262 6e6c    "bn",.    "bnl
-0000eb40: 222c 0a20 2020 2022 626e 7070 6172 6962  ",.    "bnpparib
-0000eb50: 6173 222c 0a20 2020 2022 626f 222c 0a20  as",.    "bo",. 
-0000eb60: 2020 2022 626f 6174 7322 2c0a 2020 2020     "boats",.    
-0000eb70: 2262 6f65 6872 696e 6765 7222 2c0a 2020  "boehringer",.  
-0000eb80: 2020 2262 6f66 6122 2c0a 2020 2020 2262    "bofa",.    "b
-0000eb90: 6f6d 222c 0a20 2020 2022 626f 6e64 222c  om",.    "bond",
-0000eba0: 0a20 2020 2022 626f 6f22 2c0a 2020 2020  .    "boo",.    
-0000ebb0: 2262 6f6f 6b22 2c0a 2020 2020 2262 6f6f  "book",.    "boo
-0000ebc0: 6b69 6e67 222c 0a20 2020 2022 626f 6f74  king",.    "boot
-0000ebd0: 7322 2c0a 2020 2020 2262 6f73 6368 222c  s",.    "bosch",
-0000ebe0: 0a20 2020 2022 626f 7374 696b 222c 0a20  .    "bostik",. 
-0000ebf0: 2020 2022 626f 7374 6f6e 222c 0a20 2020     "boston",.   
-0000ec00: 2022 626f 7422 2c0a 2020 2020 2262 6f75   "bot",.    "bou
-0000ec10: 7469 7175 6522 2c0a 2020 2020 2262 6f78  tique",.    "box
-0000ec20: 222c 0a20 2020 2022 6272 222c 0a20 2020  ",.    "br",.   
-0000ec30: 2022 6272 6164 6573 636f 222c 0a20 2020   "bradesco",.   
-0000ec40: 2022 6272 6964 6765 7374 6f6e 6522 2c0a   "bridgestone",.
-0000ec50: 2020 2020 2262 726f 6164 7761 7922 2c0a      "broadway",.
-0000ec60: 2020 2020 2262 726f 6b65 7222 2c0a 2020      "broker",.  
-0000ec70: 2020 2262 726f 7468 6572 222c 0a20 2020    "brother",.   
-0000ec80: 2022 6272 7573 7365 6c73 222c 0a20 2020   "brussels",.   
-0000ec90: 2022 6273 222c 0a20 2020 2022 6274 222c   "bs",.    "bt",
-0000eca0: 0a20 2020 2022 6275 6461 7065 7374 222c  .    "budapest",
-0000ecb0: 0a20 2020 2022 6275 6761 7474 6922 2c0a  .    "bugatti",.
-0000ecc0: 2020 2020 2262 7569 6c64 222c 0a20 2020      "build",.   
-0000ecd0: 2022 6275 696c 6465 7273 222c 0a20 2020   "builders",.   
-0000ece0: 2022 6275 7369 6e65 7373 222c 0a20 2020   "business",.   
-0000ecf0: 2022 6275 7922 2c0a 2020 2020 2262 757a   "buy",.    "buz
-0000ed00: 7a22 2c0a 2020 2020 2262 7622 2c0a 2020  z",.    "bv",.  
-0000ed10: 2020 2262 7722 2c0a 2020 2020 2262 7922    "bw",.    "by"
-0000ed20: 2c0a 2020 2020 2262 7a22 2c0a 2020 2020  ,.    "bz",.    
-0000ed30: 2262 7a68 222c 0a20 2020 2023 2063 0a20  "bzh",.    # c. 
-0000ed40: 2020 2022 6361 222c 0a20 2020 2022 6361     "ca",.    "ca
-0000ed50: 6222 2c0a 2020 2020 2263 6166 6522 2c0a  b",.    "cafe",.
-0000ed60: 2020 2020 2263 616c 222c 0a20 2020 2022      "cal",.    "
-0000ed70: 6361 6c6c 222c 0a20 2020 2022 6361 6c76  call",.    "calv
-0000ed80: 696e 6b6c 6569 6e22 2c0a 2020 2020 2263  inklein",.    "c
-0000ed90: 616d 222c 0a20 2020 2022 6361 6d65 7261  am",.    "camera
-0000eda0: 222c 0a20 2020 2022 6361 6d70 222c 0a20  ",.    "camp",. 
-0000edb0: 2020 2022 6361 6e63 6572 7265 7365 6172     "cancerresear
-0000edc0: 6368 222c 0a20 2020 2022 6361 6e6f 6e22  ch",.    "canon"
-0000edd0: 2c0a 2020 2020 2263 6170 6574 6f77 6e22  ,.    "capetown"
-0000ede0: 2c0a 2020 2020 2263 6170 6974 616c 222c  ,.    "capital",
-0000edf0: 0a20 2020 2022 6361 7069 7461 6c6f 6e65  .    "capitalone
-0000ee00: 222c 0a20 2020 2022 6361 7222 2c0a 2020  ",.    "car",.  
-0000ee10: 2020 2263 6172 6176 616e 222c 0a20 2020    "caravan",.   
-0000ee20: 2022 6361 7264 7322 2c0a 2020 2020 2263   "cards",.    "c
-0000ee30: 6172 6522 2c0a 2020 2020 2263 6172 6565  are",.    "caree
-0000ee40: 7222 2c0a 2020 2020 2263 6172 6565 7273  r",.    "careers
-0000ee50: 222c 0a20 2020 2022 6361 7273 222c 0a20  ",.    "cars",. 
-0000ee60: 2020 2022 6361 7274 6965 7222 2c0a 2020     "cartier",.  
-0000ee70: 2020 2263 6173 6122 2c0a 2020 2020 2263    "casa",.    "c
-0000ee80: 6173 6522 2c0a 2020 2020 2263 6173 6569  ase",.    "casei
-0000ee90: 6822 2c0a 2020 2020 2263 6173 6822 2c0a  h",.    "cash",.
-0000eea0: 2020 2020 2263 6173 696e 6f22 2c0a 2020      "casino",.  
-0000eeb0: 2020 2263 6174 222c 0a20 2020 2022 6361    "cat",.    "ca
-0000eec0: 7465 7269 6e67 222c 0a20 2020 2022 6361  tering",.    "ca
-0000eed0: 7468 6f6c 6963 222c 0a20 2020 2022 6362  tholic",.    "cb
-0000eee0: 6122 2c0a 2020 2020 2263 626e 222c 0a20  a",.    "cbn",. 
-0000eef0: 2020 2022 6362 7265 222c 0a20 2020 2022     "cbre",.    "
-0000ef00: 6362 7322 2c0a 2020 2020 2263 6322 2c0a  cbs",.    "cc",.
-0000ef10: 2020 2020 2263 6422 2c0a 2020 2020 2263      "cd",.    "c
-0000ef20: 6562 222c 0a20 2020 2022 6365 6e74 6572  eb",.    "center
-0000ef30: 222c 0a20 2020 2022 6365 6f22 2c0a 2020  ",.    "ceo",.  
-0000ef40: 2020 2263 6572 6e22 2c0a 2020 2020 2263    "cern",.    "c
-0000ef50: 6622 2c0a 2020 2020 2263 6661 222c 0a20  f",.    "cfa",. 
-0000ef60: 2020 2022 6366 6422 2c0a 2020 2020 2263     "cfd",.    "c
-0000ef70: 6722 2c0a 2020 2020 2263 6822 2c0a 2020  g",.    "ch",.  
-0000ef80: 2020 2263 6861 6e65 6c22 2c0a 2020 2020    "chanel",.    
-0000ef90: 2263 6861 6e6e 656c 222c 0a20 2020 2022  "channel",.    "
-0000efa0: 6368 6173 6522 2c0a 2020 2020 2263 6861  chase",.    "cha
-0000efb0: 7422 2c0a 2020 2020 2263 6865 6170 222c  t",.    "cheap",
-0000efc0: 0a20 2020 2022 6368 696e 7461 6922 2c0a  .    "chintai",.
-0000efd0: 2020 2020 2263 6872 6973 746d 6173 222c      "christmas",
-0000efe0: 0a20 2020 2022 6368 726f 6d65 222c 0a20  .    "chrome",. 
-0000eff0: 2020 2022 6368 7279 736c 6572 222c 0a20     "chrysler",. 
-0000f000: 2020 2022 6368 7572 6368 222c 0a20 2020     "church",.   
-0000f010: 2022 6369 222c 0a20 2020 2022 6369 7072   "ci",.    "cipr
-0000f020: 6961 6e69 222c 0a20 2020 2022 6369 7263  iani",.    "circ
-0000f030: 6c65 222c 0a20 2020 2022 6369 7363 6f22  le",.    "cisco"
-0000f040: 2c0a 2020 2020 2263 6974 6164 656c 222c  ,.    "citadel",
-0000f050: 0a20 2020 2022 6369 7469 222c 0a20 2020  .    "citi",.   
-0000f060: 2022 6369 7469 6322 2c0a 2020 2020 2263   "citic",.    "c
-0000f070: 6974 7922 2c0a 2020 2020 2263 6974 7965  ity",.    "citye
-0000f080: 6174 7322 2c0a 2020 2020 2263 6b22 2c0a  ats",.    "ck",.
-0000f090: 2020 2020 2263 6c22 2c0a 2020 2020 2263      "cl",.    "c
-0000f0a0: 6c61 696d 7322 2c0a 2020 2020 2263 6c65  laims",.    "cle
-0000f0b0: 616e 696e 6722 2c0a 2020 2020 2263 6c69  aning",.    "cli
-0000f0c0: 636b 222c 0a20 2020 2022 636c 696e 6963  ck",.    "clinic
-0000f0d0: 222c 0a20 2020 2022 636c 696e 6971 7565  ",.    "clinique
-0000f0e0: 222c 0a20 2020 2022 636c 6f74 6869 6e67  ",.    "clothing
-0000f0f0: 222c 0a20 2020 2022 636c 6f75 6422 2c0a  ",.    "cloud",.
-0000f100: 2020 2020 2263 6c75 6222 2c0a 2020 2020      "club",.    
-0000f110: 2263 6c75 626d 6564 222c 0a20 2020 2022  "clubmed",.    "
-0000f120: 636d 222c 0a20 2020 2022 636e 222c 0a20  cm",.    "cn",. 
-0000f130: 2020 2022 636f 222c 0a20 2020 2022 636f     "co",.    "co
-0000f140: 6163 6822 2c0a 2020 2020 2263 6f64 6573  ach",.    "codes
-0000f150: 222c 0a20 2020 2022 636f 6666 6565 222c  ",.    "coffee",
-0000f160: 0a20 2020 2022 636f 6c6c 6567 6522 2c0a  .    "college",.
-0000f170: 2020 2020 2263 6f6c 6f67 6e65 222c 0a20      "cologne",. 
-0000f180: 2020 2022 636f 6d22 2c0a 2020 2020 2263     "com",.    "c
-0000f190: 6f6d 6361 7374 222c 0a20 2020 2022 636f  omcast",.    "co
-0000f1a0: 6d6d 6261 6e6b 222c 0a20 2020 2022 636f  mmbank",.    "co
-0000f1b0: 6d6d 756e 6974 7922 2c0a 2020 2020 2263  mmunity",.    "c
-0000f1c0: 6f6d 7061 6e79 222c 0a20 2020 2022 636f  ompany",.    "co
-0000f1d0: 6d70 6172 6522 2c0a 2020 2020 2263 6f6d  mpare",.    "com
-0000f1e0: 7075 7465 7222 2c0a 2020 2020 2263 6f6d  puter",.    "com
-0000f1f0: 7365 6322 2c0a 2020 2020 2263 6f6e 646f  sec",.    "condo
-0000f200: 7322 2c0a 2020 2020 2263 6f6e 7374 7275  s",.    "constru
-0000f210: 6374 696f 6e22 2c0a 2020 2020 2263 6f6e  ction",.    "con
-0000f220: 7375 6c74 696e 6722 2c0a 2020 2020 2263  sulting",.    "c
-0000f230: 6f6e 7461 6374 222c 0a20 2020 2022 636f  ontact",.    "co
-0000f240: 6e74 7261 6374 6f72 7322 2c0a 2020 2020  ntractors",.    
-0000f250: 2263 6f6f 6b69 6e67 222c 0a20 2020 2022  "cooking",.    "
-0000f260: 636f 6f6b 696e 6763 6861 6e6e 656c 222c  cookingchannel",
-0000f270: 0a20 2020 2022 636f 6f6c 222c 0a20 2020  .    "cool",.   
-0000f280: 2022 636f 6f70 222c 0a20 2020 2022 636f   "coop",.    "co
-0000f290: 7273 6963 6122 2c0a 2020 2020 2263 6f75  rsica",.    "cou
-0000f2a0: 6e74 7279 222c 0a20 2020 2022 636f 7570  ntry",.    "coup
-0000f2b0: 6f6e 222c 0a20 2020 2022 636f 7570 6f6e  on",.    "coupon
-0000f2c0: 7322 2c0a 2020 2020 2263 6f75 7273 6573  s",.    "courses
-0000f2d0: 222c 0a20 2020 2022 6372 222c 0a20 2020  ",.    "cr",.   
-0000f2e0: 2022 6372 6564 6974 222c 0a20 2020 2022   "credit",.    "
-0000f2f0: 6372 6564 6974 6361 7264 222c 0a20 2020  creditcard",.   
-0000f300: 2022 6372 6564 6974 756e 696f 6e22 2c0a   "creditunion",.
-0000f310: 2020 2020 2263 7269 636b 6574 222c 0a20      "cricket",. 
-0000f320: 2020 2022 6372 6f77 6e22 2c0a 2020 2020     "crown",.    
-0000f330: 2263 7273 222c 0a20 2020 2022 6372 7569  "crs",.    "crui
-0000f340: 7365 222c 0a20 2020 2022 6372 7569 7365  se",.    "cruise
-0000f350: 7322 2c0a 2020 2020 2263 7363 222c 0a20  s",.    "csc",. 
-0000f360: 2020 2022 6375 222c 0a20 2020 2022 6375     "cu",.    "cu
-0000f370: 6973 696e 656c 6c61 222c 0a20 2020 2022  isinella",.    "
-0000f380: 6376 222c 0a20 2020 2022 6377 222c 0a20  cv",.    "cw",. 
-0000f390: 2020 2022 6378 222c 0a20 2020 2022 6379     "cx",.    "cy
-0000f3a0: 222c 0a20 2020 2022 6379 6d72 7522 2c0a  ",.    "cymru",.
-0000f3b0: 2020 2020 2263 796f 7522 2c0a 2020 2020      "cyou",.    
-0000f3c0: 2263 7a22 2c0a 2020 2020 2320 640a 2020  "cz",.    # d.  
-0000f3d0: 2020 2264 6162 7572 222c 0a20 2020 2022    "dabur",.    "
-0000f3e0: 6461 6422 2c0a 2020 2020 2264 616e 6365  dad",.    "dance
-0000f3f0: 222c 0a20 2020 2022 6461 7461 222c 0a20  ",.    "data",. 
-0000f400: 2020 2022 6461 7465 222c 0a20 2020 2022     "date",.    "
-0000f410: 6461 7469 6e67 222c 0a20 2020 2022 6461  dating",.    "da
-0000f420: 7473 756e 222c 0a20 2020 2022 6461 7922  tsun",.    "day"
-0000f430: 2c0a 2020 2020 2264 636c 6b22 2c0a 2020  ,.    "dclk",.  
-0000f440: 2020 2264 6473 222c 0a20 2020 2022 6465    "dds",.    "de
-0000f450: 222c 0a20 2020 2022 6465 616c 222c 0a20  ",.    "deal",. 
-0000f460: 2020 2022 6465 616c 6572 222c 0a20 2020     "dealer",.   
-0000f470: 2022 6465 616c 7322 2c0a 2020 2020 2264   "deals",.    "d
-0000f480: 6567 7265 6522 2c0a 2020 2020 2264 656c  egree",.    "del
-0000f490: 6976 6572 7922 2c0a 2020 2020 2264 656c  ivery",.    "del
-0000f4a0: 6c22 2c0a 2020 2020 2264 656c 6f69 7474  l",.    "deloitt
-0000f4b0: 6522 2c0a 2020 2020 2264 656c 7461 222c  e",.    "delta",
-0000f4c0: 0a20 2020 2022 6465 6d6f 6372 6174 222c  .    "democrat",
-0000f4d0: 0a20 2020 2022 6465 6e74 616c 222c 0a20  .    "dental",. 
-0000f4e0: 2020 2022 6465 6e74 6973 7422 2c0a 2020     "dentist",.  
-0000f4f0: 2020 2264 6573 6922 2c0a 2020 2020 2264    "desi",.    "d
-0000f500: 6573 6967 6e22 2c0a 2020 2020 2264 6576  esign",.    "dev
-0000f510: 222c 0a20 2020 2022 6468 6c22 2c0a 2020  ",.    "dhl",.  
-0000f520: 2020 2264 6961 6d6f 6e64 7322 2c0a 2020    "diamonds",.  
-0000f530: 2020 2264 6965 7422 2c0a 2020 2020 2264    "diet",.    "d
-0000f540: 6967 6974 616c 222c 0a20 2020 2022 6469  igital",.    "di
-0000f550: 7265 6374 222c 0a20 2020 2022 6469 7265  rect",.    "dire
-0000f560: 6374 6f72 7922 2c0a 2020 2020 2264 6973  ctory",.    "dis
-0000f570: 636f 756e 7422 2c0a 2020 2020 2264 6973  count",.    "dis
-0000f580: 636f 7665 7222 2c0a 2020 2020 2264 6973  cover",.    "dis
-0000f590: 6822 2c0a 2020 2020 2264 6979 222c 0a20  h",.    "diy",. 
-0000f5a0: 2020 2022 646a 222c 0a20 2020 2022 646b     "dj",.    "dk
-0000f5b0: 222c 0a20 2020 2022 646d 222c 0a20 2020  ",.    "dm",.   
-0000f5c0: 2022 646e 7022 2c0a 2020 2020 2264 6f22   "dnp",.    "do"
-0000f5d0: 2c0a 2020 2020 2264 6f63 7322 2c0a 2020  ,.    "docs",.  
-0000f5e0: 2020 2264 6f63 746f 7222 2c0a 2020 2020    "doctor",.    
-0000f5f0: 2264 6f64 6765 222c 0a20 2020 2022 646f  "dodge",.    "do
-0000f600: 6722 2c0a 2020 2020 2264 6f68 6122 2c0a  g",.    "doha",.
-0000f610: 2020 2020 2264 6f6d 6169 6e73 222c 0a20      "domains",. 
-0000f620: 2020 2022 646f 7422 2c0a 2020 2020 2264     "dot",.    "d
-0000f630: 6f77 6e6c 6f61 6422 2c0a 2020 2020 2264  ownload",.    "d
-0000f640: 7269 7665 222c 0a20 2020 2022 6474 7622  rive",.    "dtv"
-0000f650: 2c0a 2020 2020 2264 7562 6169 222c 0a20  ,.    "dubai",. 
-0000f660: 2020 2022 6475 636b 222c 0a20 2020 2022     "duck",.    "
-0000f670: 6475 6e6c 6f70 222c 0a20 2020 2022 6475  dunlop",.    "du
-0000f680: 6e73 222c 0a20 2020 2022 6475 706f 6e74  ns",.    "dupont
-0000f690: 222c 0a20 2020 2022 6475 7262 616e 222c  ",.    "durban",
-0000f6a0: 0a20 2020 2022 6476 6167 222c 0a20 2020  .    "dvag",.   
-0000f6b0: 2022 6476 7222 2c0a 2020 2020 2264 7a22   "dvr",.    "dz"
-0000f6c0: 2c0a 2020 2020 2320 650a 2020 2020 2265  ,.    # e.    "e
-0000f6d0: 6172 7468 222c 0a20 2020 2022 6561 7422  arth",.    "eat"
-0000f6e0: 2c0a 2020 2020 2265 6322 2c0a 2020 2020  ,.    "ec",.    
-0000f6f0: 2265 636f 222c 0a20 2020 2022 6564 656b  "eco",.    "edek
-0000f700: 6122 2c0a 2020 2020 2265 6475 222c 0a20  a",.    "edu",. 
-0000f710: 2020 2022 6564 7563 6174 696f 6e22 2c0a     "education",.
-0000f720: 2020 2020 2265 6522 2c0a 2020 2020 2265      "ee",.    "e
-0000f730: 6722 2c0a 2020 2020 2265 6d61 696c 222c  g",.    "email",
-0000f740: 0a20 2020 2022 656d 6572 636b 222c 0a20  .    "emerck",. 
-0000f750: 2020 2022 656e 6572 6779 222c 0a20 2020     "energy",.   
-0000f760: 2022 656e 6769 6e65 6572 222c 0a20 2020   "engineer",.   
-0000f770: 2022 656e 6769 6e65 6572 696e 6722 2c0a   "engineering",.
-0000f780: 2020 2020 2265 6e74 6572 7072 6973 6573      "enterprises
-0000f790: 222c 0a20 2020 2022 6570 6f73 7422 2c0a  ",.    "epost",.
-0000f7a0: 2020 2020 2265 7073 6f6e 222c 0a20 2020      "epson",.   
-0000f7b0: 2022 6571 7569 706d 656e 7422 2c0a 2020   "equipment",.  
-0000f7c0: 2020 2265 7222 2c0a 2020 2020 2265 7269    "er",.    "eri
-0000f7d0: 6373 736f 6e22 2c0a 2020 2020 2265 726e  csson",.    "ern
-0000f7e0: 6922 2c0a 2020 2020 2265 7322 2c0a 2020  i",.    "es",.  
-0000f7f0: 2020 2265 7371 222c 0a20 2020 2022 6573    "esq",.    "es
-0000f800: 7461 7465 222c 0a20 2020 2022 6573 7572  tate",.    "esur
-0000f810: 616e 6365 222c 0a20 2020 2022 6574 222c  ance",.    "et",
-0000f820: 0a20 2020 2022 6574 6973 616c 6174 222c  .    "etisalat",
-0000f830: 0a20 2020 2022 6575 222c 0a20 2020 2022  .    "eu",.    "
-0000f840: 6575 726f 7669 7369 6f6e 222c 0a20 2020  eurovision",.   
-0000f850: 2022 6575 7322 2c0a 2020 2020 2265 7665   "eus",.    "eve
-0000f860: 6e74 7322 2c0a 2020 2020 2265 7665 7262  nts",.    "everb
-0000f870: 616e 6b22 2c0a 2020 2020 2265 7863 6861  ank",.    "excha
-0000f880: 6e67 6522 2c0a 2020 2020 2265 7870 6572  nge",.    "exper
-0000f890: 7422 2c0a 2020 2020 2265 7870 6f73 6564  t",.    "exposed
-0000f8a0: 222c 0a20 2020 2022 6578 7072 6573 7322  ",.    "express"
-0000f8b0: 2c0a 2020 2020 2265 7874 7261 7370 6163  ,.    "extraspac
-0000f8c0: 6522 2c0a 2020 2020 2320 660a 2020 2020  e",.    # f.    
-0000f8d0: 2266 6167 6522 2c0a 2020 2020 2266 6169  "fage",.    "fai
-0000f8e0: 6c22 2c0a 2020 2020 2266 6169 7277 696e  l",.    "fairwin
-0000f8f0: 6473 222c 0a20 2020 2022 6661 6974 6822  ds",.    "faith"
-0000f900: 2c0a 2020 2020 2266 616d 696c 7922 2c0a  ,.    "family",.
-0000f910: 2020 2020 2266 616e 222c 0a20 2020 2022      "fan",.    "
-0000f920: 6661 6e73 222c 0a20 2020 2022 6661 726d  fans",.    "farm
-0000f930: 222c 0a20 2020 2022 6661 726d 6572 7322  ",.    "farmers"
-0000f940: 2c0a 2020 2020 2266 6173 6869 6f6e 222c  ,.    "fashion",
-0000f950: 0a20 2020 2022 6661 7374 222c 0a20 2020  .    "fast",.   
-0000f960: 2022 6665 6465 7822 2c0a 2020 2020 2266   "fedex",.    "f
-0000f970: 6565 6462 6163 6b22 2c0a 2020 2020 2266  eedback",.    "f
-0000f980: 6572 7261 7269 222c 0a20 2020 2022 6665  errari",.    "fe
-0000f990: 7272 6572 6f22 2c0a 2020 2020 2266 6922  rrero",.    "fi"
-0000f9a0: 2c0a 2020 2020 2266 6961 7422 2c0a 2020  ,.    "fiat",.  
-0000f9b0: 2020 2266 6964 656c 6974 7922 2c0a 2020    "fidelity",.  
-0000f9c0: 2020 2266 6964 6f22 2c0a 2020 2020 2266    "fido",.    "f
-0000f9d0: 696c 6d22 2c0a 2020 2020 2266 696e 616c  ilm",.    "final
-0000f9e0: 222c 0a20 2020 2022 6669 6e61 6e63 6522  ",.    "finance"
-0000f9f0: 2c0a 2020 2020 2266 696e 616e 6369 616c  ,.    "financial
-0000fa00: 222c 0a20 2020 2022 6669 7265 222c 0a20  ",.    "fire",. 
-0000fa10: 2020 2022 6669 7265 7374 6f6e 6522 2c0a     "firestone",.
-0000fa20: 2020 2020 2266 6972 6d64 616c 6522 2c0a      "firmdale",.
-0000fa30: 2020 2020 2266 6973 6822 2c0a 2020 2020      "fish",.    
-0000fa40: 2266 6973 6869 6e67 222c 0a20 2020 2022  "fishing",.    "
-0000fa50: 6669 7422 2c0a 2020 2020 2266 6974 6e65  fit",.    "fitne
-0000fa60: 7373 222c 0a20 2020 2022 666a 222c 0a20  ss",.    "fj",. 
-0000fa70: 2020 2022 666b 222c 0a20 2020 2022 666c     "fk",.    "fl
-0000fa80: 6963 6b72 222c 0a20 2020 2022 666c 6967  ickr",.    "flig
-0000fa90: 6874 7322 2c0a 2020 2020 2266 6c69 7222  hts",.    "flir"
-0000faa0: 2c0a 2020 2020 2266 6c6f 7269 7374 222c  ,.    "florist",
-0000fab0: 0a20 2020 2022 666c 6f77 6572 7322 2c0a  .    "flowers",.
-0000fac0: 2020 2020 2266 6c79 222c 0a20 2020 2022      "fly",.    "
-0000fad0: 666d 222c 0a20 2020 2022 666f 222c 0a20  fm",.    "fo",. 
-0000fae0: 2020 2022 666f 6f22 2c0a 2020 2020 2266     "foo",.    "f
-0000faf0: 6f6f 6422 2c0a 2020 2020 2266 6f6f 646e  ood",.    "foodn
-0000fb00: 6574 776f 726b 222c 0a20 2020 2022 666f  etwork",.    "fo
-0000fb10: 6f74 6261 6c6c 222c 0a20 2020 2022 666f  otball",.    "fo
-0000fb20: 7264 222c 0a20 2020 2022 666f 7265 7822  rd",.    "forex"
-0000fb30: 2c0a 2020 2020 2266 6f72 7361 6c65 222c  ,.    "forsale",
-0000fb40: 0a20 2020 2022 666f 7275 6d22 2c0a 2020  .    "forum",.  
-0000fb50: 2020 2266 6f75 6e64 6174 696f 6e22 2c0a    "foundation",.
-0000fb60: 2020 2020 2266 6f78 222c 0a20 2020 2022      "fox",.    "
-0000fb70: 6672 222c 0a20 2020 2022 6672 6565 222c  fr",.    "free",
-0000fb80: 0a20 2020 2022 6672 6573 656e 6975 7322  .    "fresenius"
-0000fb90: 2c0a 2020 2020 2266 726c 222c 0a20 2020  ,.    "frl",.   
-0000fba0: 2022 6672 6f67 616e 7322 2c0a 2020 2020   "frogans",.    
-0000fbb0: 2266 726f 6e74 646f 6f72 222c 0a20 2020  "frontdoor",.   
-0000fbc0: 2022 6672 6f6e 7469 6572 222c 0a20 2020   "frontier",.   
-0000fbd0: 2022 6674 7222 2c0a 2020 2020 2266 756a   "ftr",.    "fuj
-0000fbe0: 6974 7375 222c 0a20 2020 2022 6675 6a69  itsu",.    "fuji
-0000fbf0: 7865 726f 7822 2c0a 2020 2020 2266 756e  xerox",.    "fun
-0000fc00: 222c 0a20 2020 2022 6675 6e64 222c 0a20  ",.    "fund",. 
-0000fc10: 2020 2022 6675 726e 6974 7572 6522 2c0a     "furniture",.
-0000fc20: 2020 2020 2266 7574 626f 6c22 2c0a 2020      "futbol",.  
-0000fc30: 2020 2266 7969 222c 0a20 2020 2023 2067    "fyi",.    # g
-0000fc40: 0a20 2020 2022 6761 222c 0a20 2020 2022  .    "ga",.    "
-0000fc50: 6761 6c22 2c0a 2020 2020 2267 616c 6c65  gal",.    "galle
-0000fc60: 7279 222c 0a20 2020 2022 6761 6c6c 6f22  ry",.    "gallo"
-0000fc70: 2c0a 2020 2020 2267 616c 6c75 7022 2c0a  ,.    "gallup",.
-0000fc80: 2020 2020 2267 616d 6522 2c0a 2020 2020      "game",.    
-0000fc90: 2267 616d 6573 222c 0a20 2020 2022 6761  "games",.    "ga
-0000fca0: 7022 2c0a 2020 2020 2267 6172 6465 6e22  p",.    "garden"
-0000fcb0: 2c0a 2020 2020 2267 6222 2c0a 2020 2020  ,.    "gb",.    
-0000fcc0: 2267 6269 7a22 2c0a 2020 2020 2267 6422  "gbiz",.    "gd"
-0000fcd0: 2c0a 2020 2020 2267 646e 222c 0a20 2020  ,.    "gdn",.   
-0000fce0: 2022 6765 222c 0a20 2020 2022 6765 6122   "ge",.    "gea"
-0000fcf0: 2c0a 2020 2020 2267 656e 7422 2c0a 2020  ,.    "gent",.  
-0000fd00: 2020 2267 656e 7469 6e67 222c 0a20 2020    "genting",.   
-0000fd10: 2022 6765 6f72 6765 222c 0a20 2020 2022   "george",.    "
-0000fd20: 6766 222c 0a20 2020 2022 6767 222c 0a20  gf",.    "gg",. 
-0000fd30: 2020 2022 6767 6565 222c 0a20 2020 2022     "ggee",.    "
-0000fd40: 6768 222c 0a20 2020 2022 6769 222c 0a20  gh",.    "gi",. 
-0000fd50: 2020 2022 6769 6674 222c 0a20 2020 2022     "gift",.    "
-0000fd60: 6769 6674 7322 2c0a 2020 2020 2267 6976  gifts",.    "giv
-0000fd70: 6573 222c 0a20 2020 2022 6769 7669 6e67  es",.    "giving
-0000fd80: 222c 0a20 2020 2022 676c 222c 0a20 2020  ",.    "gl",.   
-0000fd90: 2022 676c 6164 6522 2c0a 2020 2020 2267   "glade",.    "g
-0000fda0: 6c61 7373 222c 0a20 2020 2022 676c 6522  lass",.    "gle"
-0000fdb0: 2c0a 2020 2020 2267 6c6f 6261 6c22 2c0a  ,.    "global",.
-0000fdc0: 2020 2020 2267 6c6f 626f 222c 0a20 2020      "globo",.   
-0000fdd0: 2022 676d 222c 0a20 2020 2022 676d 6169   "gm",.    "gmai
-0000fde0: 6c22 2c0a 2020 2020 2267 6d62 6822 2c0a  l",.    "gmbh",.
-0000fdf0: 2020 2020 2267 6d6f 222c 0a20 2020 2022      "gmo",.    "
-0000fe00: 676d 7822 2c0a 2020 2020 2267 6e22 2c0a  gmx",.    "gn",.
-0000fe10: 2020 2020 2267 6f64 6164 6479 222c 0a20      "godaddy",. 
-0000fe20: 2020 2022 676f 6c64 222c 0a20 2020 2022     "gold",.    "
-0000fe30: 676f 6c64 706f 696e 7422 2c0a 2020 2020  goldpoint",.    
-0000fe40: 2267 6f6c 6622 2c0a 2020 2020 2267 6f6f  "golf",.    "goo
-0000fe50: 222c 0a20 2020 2022 676f 6f64 6861 6e64  ",.    "goodhand
-0000fe60: 7322 2c0a 2020 2020 2267 6f6f 6479 6561  s",.    "goodyea
-0000fe70: 7222 2c0a 2020 2020 2267 6f6f 6722 2c0a  r",.    "goog",.
-0000fe80: 2020 2020 2267 6f6f 676c 6522 2c0a 2020      "google",.  
-0000fe90: 2020 2267 6f70 222c 0a20 2020 2022 676f    "gop",.    "go
-0000fea0: 7422 2c0a 2020 2020 2267 6f76 222c 0a20  t",.    "gov",. 
-0000feb0: 2020 2022 6770 222c 0a20 2020 2022 6771     "gp",.    "gq
-0000fec0: 222c 0a20 2020 2022 6772 222c 0a20 2020  ",.    "gr",.   
-0000fed0: 2022 6772 6169 6e67 6572 222c 0a20 2020   "grainger",.   
-0000fee0: 2022 6772 6170 6869 6373 222c 0a20 2020   "graphics",.   
-0000fef0: 2022 6772 6174 6973 222c 0a20 2020 2022   "gratis",.    "
-0000ff00: 6772 6565 6e22 2c0a 2020 2020 2267 7269  green",.    "gri
-0000ff10: 7065 222c 0a20 2020 2022 6772 6f63 6572  pe",.    "grocer
-0000ff20: 7922 2c0a 2020 2020 2267 726f 7570 222c  y",.    "group",
-0000ff30: 0a20 2020 2022 6773 222c 0a20 2020 2022  .    "gs",.    "
-0000ff40: 6774 222c 0a20 2020 2022 6775 222c 0a20  gt",.    "gu",. 
-0000ff50: 2020 2022 6775 6172 6469 616e 222c 0a20     "guardian",. 
-0000ff60: 2020 2022 6775 6363 6922 2c0a 2020 2020     "gucci",.    
-0000ff70: 2267 7567 6522 2c0a 2020 2020 2267 7569  "guge",.    "gui
-0000ff80: 6465 222c 0a20 2020 2022 6775 6974 6172  de",.    "guitar
-0000ff90: 7322 2c0a 2020 2020 2267 7572 7522 2c0a  s",.    "guru",.
-0000ffa0: 2020 2020 2267 7722 2c0a 2020 2020 2267      "gw",.    "g
-0000ffb0: 7922 2c0a 2020 2020 2320 680a 2020 2020  y",.    # h.    
-0000ffc0: 2268 6169 7222 2c0a 2020 2020 2268 616d  "hair",.    "ham
-0000ffd0: 6275 7267 222c 0a20 2020 2022 6861 6e67  burg",.    "hang
-0000ffe0: 6f75 7422 2c0a 2020 2020 2268 6175 7322  out",.    "haus"
-0000fff0: 2c0a 2020 2020 2268 626f 222c 0a20 2020  ,.    "hbo",.   
-00010000: 2022 6864 6663 222c 0a20 2020 2022 6864   "hdfc",.    "hd
-00010010: 6663 6261 6e6b 222c 0a20 2020 2022 6865  fcbank",.    "he
-00010020: 616c 7468 222c 0a20 2020 2022 6865 616c  alth",.    "heal
-00010030: 7468 6361 7265 222c 0a20 2020 2022 6865  thcare",.    "he
-00010040: 6c70 222c 0a20 2020 2022 6865 6c73 696e  lp",.    "helsin
-00010050: 6b69 222c 0a20 2020 2022 6865 7265 222c  ki",.    "here",
-00010060: 0a20 2020 2022 6865 726d 6573 222c 0a20  .    "hermes",. 
-00010070: 2020 2022 6867 7476 222c 0a20 2020 2022     "hgtv",.    "
-00010080: 6869 7068 6f70 222c 0a20 2020 2022 6869  hiphop",.    "hi
-00010090: 7361 6d69 7473 7522 2c0a 2020 2020 2268  samitsu",.    "h
-000100a0: 6974 6163 6869 222c 0a20 2020 2022 6869  itachi",.    "hi
-000100b0: 7622 2c0a 2020 2020 2268 6b22 2c0a 2020  v",.    "hk",.  
-000100c0: 2020 2268 6b74 222c 0a20 2020 2022 686d    "hkt",.    "hm
-000100d0: 222c 0a20 2020 2022 686e 222c 0a20 2020  ",.    "hn",.   
-000100e0: 2022 686f 636b 6579 222c 0a20 2020 2022   "hockey",.    "
-000100f0: 686f 6c64 696e 6773 222c 0a20 2020 2022  holdings",.    "
-00010100: 686f 6c69 6461 7922 2c0a 2020 2020 2268  holiday",.    "h
-00010110: 6f6d 6564 6570 6f74 222c 0a20 2020 2022  omedepot",.    "
-00010120: 686f 6d65 676f 6f64 7322 2c0a 2020 2020  homegoods",.    
-00010130: 2268 6f6d 6573 222c 0a20 2020 2022 686f  "homes",.    "ho
-00010140: 6d65 7365 6e73 6522 2c0a 2020 2020 2268  mesense",.    "h
-00010150: 6f6e 6461 222c 0a20 2020 2022 686f 6e65  onda",.    "hone
-00010160: 7977 656c 6c22 2c0a 2020 2020 2268 6f72  ywell",.    "hor
-00010170: 7365 222c 0a20 2020 2022 686f 7370 6974  se",.    "hospit
-00010180: 616c 222c 0a20 2020 2022 686f 7374 222c  al",.    "host",
-00010190: 0a20 2020 2022 686f 7374 696e 6722 2c0a  .    "hosting",.
-000101a0: 2020 2020 2268 6f74 222c 0a20 2020 2022      "hot",.    "
-000101b0: 686f 7465 6c65 7322 2c0a 2020 2020 2268  hoteles",.    "h
-000101c0: 6f74 656c 7322 2c0a 2020 2020 2268 6f74  otels",.    "hot
-000101d0: 6d61 696c 222c 0a20 2020 2022 686f 7573  mail",.    "hous
-000101e0: 6522 2c0a 2020 2020 2268 6f77 222c 0a20  e",.    "how",. 
-000101f0: 2020 2022 6872 222c 0a20 2020 2022 6873     "hr",.    "hs
-00010200: 6263 222c 0a20 2020 2022 6874 222c 0a20  bc",.    "ht",. 
-00010210: 2020 2022 6875 222c 0a20 2020 2022 6875     "hu",.    "hu
-00010220: 6768 6573 222c 0a20 2020 2022 6879 6174  ghes",.    "hyat
-00010230: 7422 2c0a 2020 2020 2268 7975 6e64 6169  t",.    "hyundai
-00010240: 222c 0a20 2020 2023 2069 0a20 2020 2022  ",.    # i.    "
-00010250: 6962 6d22 2c0a 2020 2020 2269 6362 6322  ibm",.    "icbc"
-00010260: 2c0a 2020 2020 2269 6365 222c 0a20 2020  ,.    "ice",.   
-00010270: 2022 6963 7522 2c0a 2020 2020 2269 6422   "icu",.    "id"
-00010280: 2c0a 2020 2020 2269 6522 2c0a 2020 2020  ,.    "ie",.    
-00010290: 2269 6565 6522 2c0a 2020 2020 2269 666d  "ieee",.    "ifm
-000102a0: 222c 0a20 2020 2022 696b 616e 6f22 2c0a  ",.    "ikano",.
-000102b0: 2020 2020 2269 6c22 2c0a 2020 2020 2269      "il",.    "i
-000102c0: 6d22 2c0a 2020 2020 2269 6d61 6d61 7422  m",.    "imamat"
-000102d0: 2c0a 2020 2020 2269 6d64 6222 2c0a 2020  ,.    "imdb",.  
-000102e0: 2020 2269 6d6d 6f22 2c0a 2020 2020 2269    "immo",.    "i
-000102f0: 6d6d 6f62 696c 6965 6e22 2c0a 2020 2020  mmobilien",.    
-00010300: 2269 6e22 2c0a 2020 2020 2269 6e64 7573  "in",.    "indus
-00010310: 7472 6965 7322 2c0a 2020 2020 2269 6e66  tries",.    "inf
-00010320: 696e 6974 6922 2c0a 2020 2020 2269 6e66  initi",.    "inf
-00010330: 6f22 2c0a 2020 2020 2269 6e67 222c 0a20  o",.    "ing",. 
-00010340: 2020 2022 696e 6b22 2c0a 2020 2020 2269     "ink",.    "i
-00010350: 6e73 7469 7475 7465 222c 0a20 2020 2022  nstitute",.    "
-00010360: 696e 7375 7261 6e63 6522 2c0a 2020 2020  insurance",.    
-00010370: 2269 6e73 7572 6522 2c0a 2020 2020 2269  "insure",.    "i
-00010380: 6e74 222c 0a20 2020 2022 696e 7465 6c22  nt",.    "intel"
-00010390: 2c0a 2020 2020 2269 6e74 6572 6e61 7469  ,.    "internati
-000103a0: 6f6e 616c 222c 0a20 2020 2022 696e 7475  onal",.    "intu
-000103b0: 6974 222c 0a20 2020 2022 696e 7665 7374  it",.    "invest
-000103c0: 6d65 6e74 7322 2c0a 2020 2020 2269 6f22  ments",.    "io"
-000103d0: 2c0a 2020 2020 2269 7069 7261 6e67 6122  ,.    "ipiranga"
-000103e0: 2c0a 2020 2020 2269 7122 2c0a 2020 2020  ,.    "iq",.    
-000103f0: 2269 7222 2c0a 2020 2020 2269 7269 7368  "ir",.    "irish
-00010400: 222c 0a20 2020 2022 6973 222c 0a20 2020  ",.    "is",.   
-00010410: 2022 6973 656c 6563 7422 2c0a 2020 2020   "iselect",.    
-00010420: 2269 736d 6169 6c69 222c 0a20 2020 2022  "ismaili",.    "
-00010430: 6973 7422 2c0a 2020 2020 2269 7374 616e  ist",.    "istan
-00010440: 6275 6c22 2c0a 2020 2020 2269 7422 2c0a  bul",.    "it",.
-00010450: 2020 2020 2269 7461 7522 2c0a 2020 2020      "itau",.    
-00010460: 2269 7476 222c 0a20 2020 2022 6976 6563  "itv",.    "ivec
-00010470: 6f22 2c0a 2020 2020 2269 7763 222c 0a20  o",.    "iwc",. 
-00010480: 2020 2023 206a 0a20 2020 2022 6a61 6775     # j.    "jagu
-00010490: 6172 222c 0a20 2020 2022 6a61 7661 222c  ar",.    "java",
-000104a0: 0a20 2020 2022 6a63 6222 2c0a 2020 2020  .    "jcb",.    
-000104b0: 226a 6370 222c 0a20 2020 2022 6a65 222c  "jcp",.    "je",
-000104c0: 0a20 2020 2022 6a65 6570 222c 0a20 2020  .    "jeep",.   
-000104d0: 2022 6a65 747a 7422 2c0a 2020 2020 226a   "jetzt",.    "j
-000104e0: 6577 656c 7279 222c 0a20 2020 2022 6a69  ewelry",.    "ji
-000104f0: 6f22 2c0a 2020 2020 226a 6c63 222c 0a20  o",.    "jlc",. 
-00010500: 2020 2022 6a6c 6c22 2c0a 2020 2020 226a     "jll",.    "j
-00010510: 6d22 2c0a 2020 2020 226a 6d70 222c 0a20  m",.    "jmp",. 
-00010520: 2020 2022 6a6e 6a22 2c0a 2020 2020 226a     "jnj",.    "j
-00010530: 6f22 2c0a 2020 2020 226a 6f62 7322 2c0a  o",.    "jobs",.
-00010540: 2020 2020 226a 6f62 7572 6722 2c0a 2020      "joburg",.  
-00010550: 2020 226a 6f74 222c 0a20 2020 2022 6a6f    "jot",.    "jo
-00010560: 7922 2c0a 2020 2020 226a 7022 2c0a 2020  y",.    "jp",.  
-00010570: 2020 226a 706d 6f72 6761 6e22 2c0a 2020    "jpmorgan",.  
-00010580: 2020 226a 7072 7322 2c0a 2020 2020 226a    "jprs",.    "j
-00010590: 7565 676f 7322 2c0a 2020 2020 226a 756e  uegos",.    "jun
-000105a0: 6970 6572 222c 0a20 2020 2023 206b 0a20  iper",.    # k. 
-000105b0: 2020 2022 6b61 7566 656e 222c 0a20 2020     "kaufen",.   
-000105c0: 2022 6b64 6469 222c 0a20 2020 2022 6b65   "kddi",.    "ke
-000105d0: 222c 0a20 2020 2022 6b65 7272 7968 6f74  ",.    "kerryhot
-000105e0: 656c 7322 2c0a 2020 2020 226b 6572 7279  els",.    "kerry
-000105f0: 6c6f 6769 7374 6963 7322 2c0a 2020 2020  logistics",.    
-00010600: 226b 6572 7279 7072 6f70 6572 7469 6573  "kerryproperties
-00010610: 222c 0a20 2020 2022 6b66 6822 2c0a 2020  ",.    "kfh",.  
-00010620: 2020 226b 6722 2c0a 2020 2020 226b 6822    "kg",.    "kh"
-00010630: 2c0a 2020 2020 226b 6922 2c0a 2020 2020  ,.    "ki",.    
-00010640: 226b 6961 222c 0a20 2020 2022 6b69 6d22  "kia",.    "kim"
-00010650: 2c0a 2020 2020 226b 696e 6465 7222 2c0a  ,.    "kinder",.
-00010660: 2020 2020 226b 696e 646c 6522 2c0a 2020      "kindle",.  
-00010670: 2020 226b 6974 6368 656e 222c 0a20 2020    "kitchen",.   
-00010680: 2022 6b69 7769 222c 0a20 2020 2022 6b6d   "kiwi",.    "km
-00010690: 222c 0a20 2020 2022 6b6e 222c 0a20 2020  ",.    "kn",.   
-000106a0: 2022 6b6f 656c 6e22 2c0a 2020 2020 226b   "koeln",.    "k
-000106b0: 6f6d 6174 7375 222c 0a20 2020 2022 6b6f  omatsu",.    "ko
-000106c0: 7368 6572 222c 0a20 2020 2022 6b70 222c  sher",.    "kp",
-000106d0: 0a20 2020 2022 6b70 6d67 222c 0a20 2020  .    "kpmg",.   
-000106e0: 2022 6b70 6e22 2c0a 2020 2020 226b 7222   "kpn",.    "kr"
-000106f0: 2c0a 2020 2020 226b 7264 222c 0a20 2020  ,.    "krd",.   
-00010700: 2022 6b72 6564 222c 0a20 2020 2022 6b75   "kred",.    "ku
-00010710: 6f6b 6772 6f75 7022 2c0a 2020 2020 226b  okgroup",.    "k
-00010720: 7722 2c0a 2020 2020 226b 7922 2c0a 2020  w",.    "ky",.  
-00010730: 2020 226b 796f 746f 222c 0a20 2020 2022    "kyoto",.    "
-00010740: 6b7a 222c 0a20 2020 2023 206c 0a20 2020  kz",.    # l.   
-00010750: 2022 6c61 222c 0a20 2020 2022 6c61 6361   "la",.    "laca
-00010760: 6978 6122 2c0a 2020 2020 226c 6164 6272  ixa",.    "ladbr
-00010770: 6f6b 6573 222c 0a20 2020 2022 6c61 6d62  okes",.    "lamb
-00010780: 6f72 6768 696e 6922 2c0a 2020 2020 226c  orghini",.    "l
-00010790: 616d 6572 222c 0a20 2020 2022 6c61 6e63  amer",.    "lanc
-000107a0: 6173 7465 7222 2c0a 2020 2020 226c 616e  aster",.    "lan
-000107b0: 6369 6122 2c0a 2020 2020 226c 616e 636f  cia",.    "lanco
-000107c0: 6d65 222c 0a20 2020 2022 6c61 6e64 222c  me",.    "land",
-000107d0: 0a20 2020 2022 6c61 6e64 726f 7665 7222  .    "landrover"
-000107e0: 2c0a 2020 2020 226c 616e 7865 7373 222c  ,.    "lanxess",
-000107f0: 0a20 2020 2022 6c61 7361 6c6c 6522 2c0a  .    "lasalle",.
-00010800: 2020 2020 226c 6174 222c 0a20 2020 2022      "lat",.    "
-00010810: 6c61 7469 6e6f 222c 0a20 2020 2022 6c61  latino",.    "la
-00010820: 7472 6f62 6522 2c0a 2020 2020 226c 6177  trobe",.    "law
-00010830: 222c 0a20 2020 2022 6c61 7779 6572 222c  ",.    "lawyer",
-00010840: 0a20 2020 2022 6c62 222c 0a20 2020 2022  .    "lb",.    "
-00010850: 6c63 222c 0a20 2020 2022 6c64 7322 2c0a  lc",.    "lds",.
-00010860: 2020 2020 226c 6561 7365 222c 0a20 2020      "lease",.   
-00010870: 2022 6c65 636c 6572 6322 2c0a 2020 2020   "leclerc",.    
-00010880: 226c 6566 7261 6b22 2c0a 2020 2020 226c  "lefrak",.    "l
-00010890: 6567 616c 222c 0a20 2020 2022 6c65 676f  egal",.    "lego
-000108a0: 222c 0a20 2020 2022 6c65 7875 7322 2c0a  ",.    "lexus",.
-000108b0: 2020 2020 226c 6762 7422 2c0a 2020 2020      "lgbt",.    
-000108c0: 226c 6922 2c0a 2020 2020 226c 6961 6973  "li",.    "liais
-000108d0: 6f6e 222c 0a20 2020 2022 6c69 646c 222c  on",.    "lidl",
-000108e0: 0a20 2020 2022 6c69 6665 222c 0a20 2020  .    "life",.   
-000108f0: 2022 6c69 6665 696e 7375 7261 6e63 6522   "lifeinsurance"
-00010900: 2c0a 2020 2020 226c 6966 6573 7479 6c65  ,.    "lifestyle
-00010910: 222c 0a20 2020 2022 6c69 6768 7469 6e67  ",.    "lighting
-00010920: 222c 0a20 2020 2022 6c69 6b65 222c 0a20  ",.    "like",. 
-00010930: 2020 2022 6c69 6c6c 7922 2c0a 2020 2020     "lilly",.    
-00010940: 226c 696d 6974 6564 222c 0a20 2020 2022  "limited",.    "
-00010950: 6c69 6d6f 222c 0a20 2020 2022 6c69 6e63  limo",.    "linc
-00010960: 6f6c 6e22 2c0a 2020 2020 226c 696e 6465  oln",.    "linde
-00010970: 222c 0a20 2020 2022 6c69 6e6b 222c 0a20  ",.    "link",. 
-00010980: 2020 2022 6c69 7073 7922 2c0a 2020 2020     "lipsy",.    
-00010990: 226c 6976 6522 2c0a 2020 2020 226c 6976  "live",.    "liv
-000109a0: 696e 6722 2c0a 2020 2020 226c 6978 696c  ing",.    "lixil
-000109b0: 222c 0a20 2020 2022 6c6b 222c 0a20 2020  ",.    "lk",.   
-000109c0: 2022 6c6f 616e 222c 0a20 2020 2022 6c6f   "loan",.    "lo
-000109d0: 616e 7322 2c0a 2020 2020 226c 6f63 616c  ans",.    "local
-000109e0: 686f 7374 222c 0a20 2020 2022 6c6f 636b  host",.    "lock
-000109f0: 6572 222c 0a20 2020 2022 6c6f 6375 7322  er",.    "locus"
-00010a00: 2c0a 2020 2020 226c 6f66 7422 2c0a 2020  ,.    "loft",.  
-00010a10: 2020 226c 6f6c 222c 0a20 2020 2022 6c6f    "lol",.    "lo
-00010a20: 6e64 6f6e 222c 0a20 2020 2022 6c6f 7474  ndon",.    "lott
-00010a30: 6522 2c0a 2020 2020 226c 6f74 746f 222c  e",.    "lotto",
-00010a40: 0a20 2020 2022 6c6f 7665 222c 0a20 2020  .    "love",.   
-00010a50: 2022 6c70 6c22 2c0a 2020 2020 226c 706c   "lpl",.    "lpl
-00010a60: 6669 6e61 6e63 6961 6c22 2c0a 2020 2020  financial",.    
-00010a70: 226c 7222 2c0a 2020 2020 226c 7322 2c0a  "lr",.    "ls",.
-00010a80: 2020 2020 226c 7422 2c0a 2020 2020 226c      "lt",.    "l
-00010a90: 7464 222c 0a20 2020 2022 6c74 6461 222c  td",.    "ltda",
-00010aa0: 0a20 2020 2022 6c75 222c 0a20 2020 2022  .    "lu",.    "
-00010ab0: 6c75 6e64 6265 636b 222c 0a20 2020 2022  lundbeck",.    "
-00010ac0: 6c75 7069 6e22 2c0a 2020 2020 226c 7578  lupin",.    "lux
-00010ad0: 6522 2c0a 2020 2020 226c 7578 7572 7922  e",.    "luxury"
-00010ae0: 2c0a 2020 2020 226c 7622 2c0a 2020 2020  ,.    "lv",.    
-00010af0: 226c 7922 2c0a 2020 2020 2320 6d0a 2020  "ly",.    # m.  
-00010b00: 2020 226d 6122 2c0a 2020 2020 226d 6163    "ma",.    "mac
-00010b10: 7973 222c 0a20 2020 2022 6d61 6472 6964  ys",.    "madrid
-00010b20: 222c 0a20 2020 2022 6d61 6966 222c 0a20  ",.    "maif",. 
-00010b30: 2020 2022 6d61 6973 6f6e 222c 0a20 2020     "maison",.   
-00010b40: 2022 6d61 6b65 7570 222c 0a20 2020 2022   "makeup",.    "
-00010b50: 6d61 6e22 2c0a 2020 2020 226d 616e 6167  man",.    "manag
-00010b60: 656d 656e 7422 2c0a 2020 2020 226d 616e  ement",.    "man
-00010b70: 676f 222c 0a20 2020 2022 6d61 7022 2c0a  go",.    "map",.
-00010b80: 2020 2020 226d 6172 6b65 7422 2c0a 2020      "market",.  
-00010b90: 2020 226d 6172 6b65 7469 6e67 222c 0a20    "marketing",. 
-00010ba0: 2020 2022 6d61 726b 6574 7322 2c0a 2020     "markets",.  
-00010bb0: 2020 226d 6172 7269 6f74 7422 2c0a 2020    "marriott",.  
-00010bc0: 2020 226d 6172 7368 616c 6c73 222c 0a20    "marshalls",. 
-00010bd0: 2020 2022 6d61 7365 7261 7469 222c 0a20     "maserati",. 
-00010be0: 2020 2022 6d61 7474 656c 222c 0a20 2020     "mattel",.   
-00010bf0: 2022 6d62 6122 2c0a 2020 2020 226d 6322   "mba",.    "mc"
-00010c00: 2c0a 2020 2020 226d 636b 696e 7365 7922  ,.    "mckinsey"
-00010c10: 2c0a 2020 2020 226d 6422 2c0a 2020 2020  ,.    "md",.    
-00010c20: 226d 6522 2c0a 2020 2020 226d 6564 222c  "me",.    "med",
-00010c30: 0a20 2020 2022 6d65 6469 6122 2c0a 2020  .    "media",.  
-00010c40: 2020 226d 6565 7422 2c0a 2020 2020 226d    "meet",.    "m
-00010c50: 656c 626f 7572 6e65 222c 0a20 2020 2022  elbourne",.    "
-00010c60: 6d65 6d65 222c 0a20 2020 2022 6d65 6d6f  meme",.    "memo
-00010c70: 7269 616c 222c 0a20 2020 2022 6d65 6e22  rial",.    "men"
-00010c80: 2c0a 2020 2020 226d 656e 7522 2c0a 2020  ,.    "menu",.  
-00010c90: 2020 226d 656f 222c 0a20 2020 2022 6d65    "meo",.    "me
-00010ca0: 7263 6b6d 7364 222c 0a20 2020 2022 6d65  rckmsd",.    "me
-00010cb0: 746c 6966 6522 2c0a 2020 2020 226d 6722  tlife",.    "mg"
-00010cc0: 2c0a 2020 2020 226d 6822 2c0a 2020 2020  ,.    "mh",.    
-00010cd0: 226d 6961 6d69 222c 0a20 2020 2022 6d69  "miami",.    "mi
-00010ce0: 6372 6f73 6f66 7422 2c0a 2020 2020 226d  crosoft",.    "m
-00010cf0: 696c 222c 0a20 2020 2022 6d69 6e69 222c  il",.    "mini",
-00010d00: 0a20 2020 2022 6d69 6e74 222c 0a20 2020  .    "mint",.   
-00010d10: 2022 6d69 7422 2c0a 2020 2020 226d 6974   "mit",.    "mit
-00010d20: 7375 6269 7368 6922 2c0a 2020 2020 226d  subishi",.    "m
-00010d30: 6b22 2c0a 2020 2020 226d 6c22 2c0a 2020  k",.    "ml",.  
-00010d40: 2020 226d 6c62 222c 0a20 2020 2022 6d6c    "mlb",.    "ml
-00010d50: 7322 2c0a 2020 2020 226d 6d22 2c0a 2020  s",.    "mm",.  
-00010d60: 2020 226d 6d61 222c 0a20 2020 2022 6d6e    "mma",.    "mn
-00010d70: 222c 0a20 2020 2022 6d6f 222c 0a20 2020  ",.    "mo",.   
-00010d80: 2022 6d6f 6269 222c 0a20 2020 2022 6d6f   "mobi",.    "mo
-00010d90: 6269 6c65 222c 0a20 2020 2022 6d6f 6269  bile",.    "mobi
-00010da0: 6c79 222c 0a20 2020 2022 6d6f 6461 222c  ly",.    "moda",
-00010db0: 0a20 2020 2022 6d6f 6522 2c0a 2020 2020  .    "moe",.    
-00010dc0: 226d 6f69 222c 0a20 2020 2022 6d6f 6d22  "moi",.    "mom"
-00010dd0: 2c0a 2020 2020 226d 6f6e 6173 6822 2c0a  ,.    "monash",.
-00010de0: 2020 2020 226d 6f6e 6579 222c 0a20 2020      "money",.   
-00010df0: 2022 6d6f 6e73 7465 7222 2c0a 2020 2020   "monster",.    
-00010e00: 226d 6f70 6172 222c 0a20 2020 2022 6d6f  "mopar",.    "mo
-00010e10: 726d 6f6e 222c 0a20 2020 2022 6d6f 7274  rmon",.    "mort
-00010e20: 6761 6765 222c 0a20 2020 2022 6d6f 7363  gage",.    "mosc
-00010e30: 6f77 222c 0a20 2020 2022 6d6f 746f 222c  ow",.    "moto",
-00010e40: 0a20 2020 2022 6d6f 746f 7263 7963 6c65  .    "motorcycle
-00010e50: 7322 2c0a 2020 2020 226d 6f76 222c 0a20  s",.    "mov",. 
-00010e60: 2020 2022 6d6f 7669 6522 2c0a 2020 2020     "movie",.    
-00010e70: 226d 6f76 6973 7461 7222 2c0a 2020 2020  "movistar",.    
-00010e80: 226d 7022 2c0a 2020 2020 226d 7122 2c0a  "mp",.    "mq",.
-00010e90: 2020 2020 226d 7222 2c0a 2020 2020 226d      "mr",.    "m
-00010ea0: 7322 2c0a 2020 2020 226d 7364 222c 0a20  s",.    "msd",. 
-00010eb0: 2020 2022 6d74 222c 0a20 2020 2022 6d74     "mt",.    "mt
-00010ec0: 6e22 2c0a 2020 2020 226d 7472 222c 0a20  n",.    "mtr",. 
-00010ed0: 2020 2022 6d75 222c 0a20 2020 2022 6d75     "mu",.    "mu
-00010ee0: 7365 756d 222c 0a20 2020 2022 6d75 7475  seum",.    "mutu
-00010ef0: 616c 222c 0a20 2020 2022 6d76 222c 0a20  al",.    "mv",. 
-00010f00: 2020 2022 6d77 222c 0a20 2020 2022 6d78     "mw",.    "mx
-00010f10: 222c 0a20 2020 2022 6d79 222c 0a20 2020  ",.    "my",.   
-00010f20: 2022 6d7a 222c 0a20 2020 2023 206e 0a20   "mz",.    # n. 
-00010f30: 2020 2022 6e61 222c 0a20 2020 2022 6e61     "na",.    "na
-00010f40: 6222 2c0a 2020 2020 226e 6164 6578 222c  b",.    "nadex",
-00010f50: 0a20 2020 2022 6e61 676f 7961 222c 0a20  .    "nagoya",. 
-00010f60: 2020 2022 6e61 6d65 222c 0a20 2020 2022     "name",.    "
-00010f70: 6e61 7469 6f6e 7769 6465 222c 0a20 2020  nationwide",.   
-00010f80: 2022 6e61 7475 7261 222c 0a20 2020 2022   "natura",.    "
-00010f90: 6e61 7679 222c 0a20 2020 2022 6e62 6122  navy",.    "nba"
-00010fa0: 2c0a 2020 2020 226e 6322 2c0a 2020 2020  ,.    "nc",.    
-00010fb0: 226e 6522 2c0a 2020 2020 226e 6563 222c  "ne",.    "nec",
-00010fc0: 0a20 2020 2022 6e65 7422 2c0a 2020 2020  .    "net",.    
-00010fd0: 226e 6574 6261 6e6b 222c 0a20 2020 2022  "netbank",.    "
-00010fe0: 6e65 7466 6c69 7822 2c0a 2020 2020 226e  netflix",.    "n
-00010ff0: 6574 776f 726b 222c 0a20 2020 2022 6e65  etwork",.    "ne
-00011000: 7573 7461 7222 2c0a 2020 2020 226e 6577  ustar",.    "new
-00011010: 222c 0a20 2020 2022 6e65 7768 6f6c 6c61  ",.    "newholla
-00011020: 6e64 222c 0a20 2020 2022 6e65 7773 222c  nd",.    "news",
-00011030: 0a20 2020 2022 6e65 7874 222c 0a20 2020  .    "next",.   
-00011040: 2022 6e65 7874 6469 7265 6374 222c 0a20   "nextdirect",. 
-00011050: 2020 2022 6e65 7875 7322 2c0a 2020 2020     "nexus",.    
-00011060: 226e 6622 2c0a 2020 2020 226e 666c 222c  "nf",.    "nfl",
-00011070: 0a20 2020 2022 6e67 222c 0a20 2020 2022  .    "ng",.    "
-00011080: 6e67 6f22 2c0a 2020 2020 226e 686b 222c  ngo",.    "nhk",
-00011090: 0a20 2020 2022 6e69 222c 0a20 2020 2022  .    "ni",.    "
-000110a0: 6e69 636f 222c 0a20 2020 2022 6e69 6b65  nico",.    "nike
-000110b0: 222c 0a20 2020 2022 6e69 6b6f 6e22 2c0a  ",.    "nikon",.
-000110c0: 2020 2020 226e 696e 6a61 222c 0a20 2020      "ninja",.   
-000110d0: 2022 6e69 7373 616e 222c 0a20 2020 2022   "nissan",.    "
-000110e0: 6e69 7373 6179 222c 0a20 2020 2022 6e6c  nissay",.    "nl
-000110f0: 222c 0a20 2020 2022 6e6f 222c 0a20 2020  ",.    "no",.   
-00011100: 2022 6e6f 6b69 6122 2c0a 2020 2020 226e   "nokia",.    "n
-00011110: 6f72 7468 7765 7374 6572 6e6d 7574 7561  orthwesternmutua
-00011120: 6c22 2c0a 2020 2020 226e 6f72 746f 6e22  l",.    "norton"
-00011130: 2c0a 2020 2020 226e 6f77 222c 0a20 2020  ,.    "now",.   
-00011140: 2022 6e6f 7772 757a 222c 0a20 2020 2022   "nowruz",.    "
-00011150: 6e6f 7774 7622 2c0a 2020 2020 226e 7022  nowtv",.    "np"
-00011160: 2c0a 2020 2020 226e 7222 2c0a 2020 2020  ,.    "nr",.    
-00011170: 226e 7261 222c 0a20 2020 2022 6e72 7722  "nra",.    "nrw"
-00011180: 2c0a 2020 2020 226e 7474 222c 0a20 2020  ,.    "ntt",.   
-00011190: 2022 6e75 222c 0a20 2020 2022 6e79 6322   "nu",.    "nyc"
-000111a0: 2c0a 2020 2020 226e 7a22 2c0a 2020 2020  ,.    "nz",.    
-000111b0: 2320 6f0a 2020 2020 226f 6269 222c 0a20  # o.    "obi",. 
-000111c0: 2020 2022 6f62 7365 7276 6572 222c 0a20     "observer",. 
-000111d0: 2020 2022 6f66 6622 2c0a 2020 2020 226f     "off",.    "o
-000111e0: 6666 6963 6522 2c0a 2020 2020 226f 6b69  ffice",.    "oki
-000111f0: 6e61 7761 222c 0a20 2020 2022 6f6c 6179  nawa",.    "olay
-00011200: 616e 222c 0a20 2020 2022 6f6c 6179 616e  an",.    "olayan
-00011210: 6772 6f75 7022 2c0a 2020 2020 226f 6c64  group",.    "old
-00011220: 6e61 7679 222c 0a20 2020 2022 6f6c 6c6f  navy",.    "ollo
-00011230: 222c 0a20 2020 2022 6f6d 222c 0a20 2020  ",.    "om",.   
-00011240: 2022 6f6d 6567 6122 2c0a 2020 2020 226f   "omega",.    "o
-00011250: 6e65 222c 0a20 2020 2022 6f6e 6722 2c0a  ne",.    "ong",.
-00011260: 2020 2020 226f 6e6c 222c 0a20 2020 2022      "onl",.    "
-00011270: 6f6e 6c69 6e65 222c 0a20 2020 2022 6f6e  online",.    "on
-00011280: 796f 7572 7369 6465 222c 0a20 2020 2022  yourside",.    "
-00011290: 6f6f 6f22 2c0a 2020 2020 226f 7065 6e22  ooo",.    "open"
-000112a0: 2c0a 2020 2020 226f 7261 636c 6522 2c0a  ,.    "oracle",.
-000112b0: 2020 2020 226f 7261 6e67 6522 2c0a 2020      "orange",.  
-000112c0: 2020 226f 7267 222c 0a20 2020 2022 6f72    "org",.    "or
-000112d0: 6761 6e69 6322 2c0a 2020 2020 226f 7269  ganic",.    "ori
-000112e0: 6769 6e73 222c 0a20 2020 2022 6f73 616b  gins",.    "osak
-000112f0: 6122 2c0a 2020 2020 226f 7473 756b 6122  a",.    "otsuka"
-00011300: 2c0a 2020 2020 226f 7474 222c 0a20 2020  ,.    "ott",.   
-00011310: 2022 6f76 6822 2c0a 2020 2020 2320 700a   "ovh",.    # p.
-00011320: 2020 2020 2270 6122 2c0a 2020 2020 2270      "pa",.    "p
-00011330: 6167 6522 2c0a 2020 2020 2270 616e 6173  age",.    "panas
-00011340: 6f6e 6963 222c 0a20 2020 2022 7061 6e65  onic",.    "pane
-00011350: 7261 6922 2c0a 2020 2020 2270 6172 6973  rai",.    "paris
-00011360: 222c 0a20 2020 2022 7061 7273 222c 0a20  ",.    "pars",. 
-00011370: 2020 2022 7061 7274 6e65 7273 222c 0a20     "partners",. 
-00011380: 2020 2022 7061 7274 7322 2c0a 2020 2020     "parts",.    
-00011390: 2270 6172 7479 222c 0a20 2020 2022 7061  "party",.    "pa
-000113a0: 7373 6167 656e 7322 2c0a 2020 2020 2270  ssagens",.    "p
-000113b0: 6179 222c 0a20 2020 2022 7063 6377 222c  ay",.    "pccw",
-000113c0: 0a20 2020 2022 7065 222c 0a20 2020 2022  .    "pe",.    "
-000113d0: 7065 7422 2c0a 2020 2020 2270 6622 2c0a  pet",.    "pf",.
-000113e0: 2020 2020 2270 6669 7a65 7222 2c0a 2020      "pfizer",.  
-000113f0: 2020 2270 6722 2c0a 2020 2020 2270 6822    "pg",.    "ph"
-00011400: 2c0a 2020 2020 2270 6861 726d 6163 7922  ,.    "pharmacy"
-00011410: 2c0a 2020 2020 2270 6864 222c 0a20 2020  ,.    "phd",.   
-00011420: 2022 7068 696c 6970 7322 2c0a 2020 2020   "philips",.    
-00011430: 2270 686f 6e65 222c 0a20 2020 2022 7068  "phone",.    "ph
-00011440: 6f74 6f22 2c0a 2020 2020 2270 686f 746f  oto",.    "photo
-00011450: 6772 6170 6879 222c 0a20 2020 2022 7068  graphy",.    "ph
-00011460: 6f74 6f73 222c 0a20 2020 2022 7068 7973  otos",.    "phys
-00011470: 696f 222c 0a20 2020 2022 7069 6167 6574  io",.    "piaget
-00011480: 222c 0a20 2020 2022 7069 6373 222c 0a20  ",.    "pics",. 
-00011490: 2020 2022 7069 6374 6574 222c 0a20 2020     "pictet",.   
-000114a0: 2022 7069 6374 7572 6573 222c 0a20 2020   "pictures",.   
-000114b0: 2022 7069 6422 2c0a 2020 2020 2270 696e   "pid",.    "pin
-000114c0: 222c 0a20 2020 2022 7069 6e67 222c 0a20  ",.    "ping",. 
-000114d0: 2020 2022 7069 6e6b 222c 0a20 2020 2022     "pink",.    "
-000114e0: 7069 6f6e 6565 7222 2c0a 2020 2020 2270  pioneer",.    "p
-000114f0: 697a 7a61 222c 0a20 2020 2022 706b 222c  izza",.    "pk",
-00011500: 0a20 2020 2022 706c 222c 0a20 2020 2022  .    "pl",.    "
-00011510: 706c 6163 6522 2c0a 2020 2020 2270 6c61  place",.    "pla
-00011520: 7922 2c0a 2020 2020 2270 6c61 7973 7461  y",.    "playsta
-00011530: 7469 6f6e 222c 0a20 2020 2022 706c 756d  tion",.    "plum
-00011540: 6269 6e67 222c 0a20 2020 2022 706c 7573  bing",.    "plus
-00011550: 222c 0a20 2020 2022 706d 222c 0a20 2020  ",.    "pm",.   
-00011560: 2022 706e 222c 0a20 2020 2022 706e 6322   "pn",.    "pnc"
-00011570: 2c0a 2020 2020 2270 6f68 6c22 2c0a 2020  ,.    "pohl",.  
-00011580: 2020 2270 6f6b 6572 222c 0a20 2020 2022    "poker",.    "
-00011590: 706f 6c69 7469 6522 2c0a 2020 2020 2270  politie",.    "p
-000115a0: 6f72 6e22 2c0a 2020 2020 2270 6f73 7422  orn",.    "post"
-000115b0: 2c0a 2020 2020 2270 7222 2c0a 2020 2020  ,.    "pr",.    
-000115c0: 2270 7261 6d65 7269 6361 222c 0a20 2020  "pramerica",.   
-000115d0: 2022 7072 6178 6922 2c0a 2020 2020 2270   "praxi",.    "p
-000115e0: 7265 7373 222c 0a20 2020 2022 7072 696d  ress",.    "prim
-000115f0: 6522 2c0a 2020 2020 2270 726f 222c 0a20  e",.    "pro",. 
-00011600: 2020 2022 7072 6f64 222c 0a20 2020 2022     "prod",.    "
-00011610: 7072 6f64 7563 7469 6f6e 7322 2c0a 2020  productions",.  
-00011620: 2020 2270 726f 6622 2c0a 2020 2020 2270    "prof",.    "p
-00011630: 726f 6772 6573 7369 7665 222c 0a20 2020  rogressive",.   
-00011640: 2022 7072 6f6d 6f22 2c0a 2020 2020 2270   "promo",.    "p
-00011650: 726f 7065 7274 6965 7322 2c0a 2020 2020  roperties",.    
-00011660: 2270 726f 7065 7274 7922 2c0a 2020 2020  "property",.    
-00011670: 2270 726f 7465 6374 696f 6e22 2c0a 2020  "protection",.  
-00011680: 2020 2270 7275 222c 0a20 2020 2022 7072    "pru",.    "pr
-00011690: 7564 656e 7469 616c 222c 0a20 2020 2022  udential",.    "
-000116a0: 7073 222c 0a20 2020 2022 7074 222c 0a20  ps",.    "pt",. 
-000116b0: 2020 2022 7075 6222 2c0a 2020 2020 2270     "pub",.    "p
-000116c0: 7722 2c0a 2020 2020 2270 7763 222c 0a20  w",.    "pwc",. 
-000116d0: 2020 2022 7079 222c 0a20 2020 2023 2071     "py",.    # q
-000116e0: 0a20 2020 2022 7161 222c 0a20 2020 2022  .    "qa",.    "
-000116f0: 7170 6f6e 222c 0a20 2020 2022 7175 6562  qpon",.    "queb
-00011700: 6563 222c 0a20 2020 2022 7175 6573 7422  ec",.    "quest"
-00011710: 2c0a 2020 2020 2271 7663 222c 0a20 2020  ,.    "qvc",.   
-00011720: 2023 2072 0a20 2020 2022 7261 6369 6e67   # r.    "racing
-00011730: 222c 0a20 2020 2022 7261 6469 6f22 2c0a  ",.    "radio",.
-00011740: 2020 2020 2272 6169 6422 2c0a 2020 2020      "raid",.    
-00011750: 2272 6522 2c0a 2020 2020 2272 6561 6422  "re",.    "read"
-00011760: 2c0a 2020 2020 2272 6561 6c65 7374 6174  ,.    "realestat
-00011770: 6522 2c0a 2020 2020 2272 6561 6c74 6f72  e",.    "realtor
-00011780: 222c 0a20 2020 2022 7265 616c 7479 222c  ",.    "realty",
-00011790: 0a20 2020 2022 7265 6369 7065 7322 2c0a  .    "recipes",.
-000117a0: 2020 2020 2272 6564 222c 0a20 2020 2022      "red",.    "
-000117b0: 7265 6473 746f 6e65 222c 0a20 2020 2022  redstone",.    "
-000117c0: 7265 6475 6d62 7265 6c6c 6122 2c0a 2020  redumbrella",.  
-000117d0: 2020 2272 6568 6162 222c 0a20 2020 2022    "rehab",.    "
-000117e0: 7265 6973 6522 2c0a 2020 2020 2272 6569  reise",.    "rei
-000117f0: 7365 6e22 2c0a 2020 2020 2272 6569 7422  sen",.    "reit"
-00011800: 2c0a 2020 2020 2272 656c 6961 6e63 6522  ,.    "reliance"
-00011810: 2c0a 2020 2020 2272 656e 222c 0a20 2020  ,.    "ren",.   
-00011820: 2022 7265 6e74 222c 0a20 2020 2022 7265   "rent",.    "re
-00011830: 6e74 616c 7322 2c0a 2020 2020 2272 6570  ntals",.    "rep
-00011840: 6169 7222 2c0a 2020 2020 2272 6570 6f72  air",.    "repor
-00011850: 7422 2c0a 2020 2020 2272 6570 7562 6c69  t",.    "republi
-00011860: 6361 6e22 2c0a 2020 2020 2272 6573 7422  can",.    "rest"
-00011870: 2c0a 2020 2020 2272 6573 7461 7572 616e  ,.    "restauran
-00011880: 7422 2c0a 2020 2020 2272 6576 6965 7722  t",.    "review"
-00011890: 2c0a 2020 2020 2272 6576 6965 7773 222c  ,.    "reviews",
-000118a0: 0a20 2020 2022 7265 7872 6f74 6822 2c0a  .    "rexroth",.
-000118b0: 2020 2020 2272 6963 6822 2c0a 2020 2020      "rich",.    
-000118c0: 2272 6963 6861 7264 6c69 222c 0a20 2020  "richardli",.   
-000118d0: 2022 7269 636f 6822 2c0a 2020 2020 2272   "ricoh",.    "r
-000118e0: 6967 6874 6174 686f 6d65 222c 0a20 2020  ightathome",.   
-000118f0: 2022 7269 6c22 2c0a 2020 2020 2272 696f   "ril",.    "rio
-00011900: 222c 0a20 2020 2022 7269 7022 2c0a 2020  ",.    "rip",.  
-00011910: 2020 2272 6d69 7422 2c0a 2020 2020 2272    "rmit",.    "r
-00011920: 6f22 2c0a 2020 2020 2272 6f63 6865 7222  o",.    "rocher"
-00011930: 2c0a 2020 2020 2272 6f63 6b73 222c 0a20  ,.    "rocks",. 
-00011940: 2020 2022 726f 6465 6f22 2c0a 2020 2020     "rodeo",.    
-00011950: 2272 6f67 6572 7322 2c0a 2020 2020 2272  "rogers",.    "r
-00011960: 6f6f 6d22 2c0a 2020 2020 2272 7322 2c0a  oom",.    "rs",.
-00011970: 2020 2020 2272 7376 7022 2c0a 2020 2020      "rsvp",.    
-00011980: 2272 7522 2c0a 2020 2020 2272 7567 6279  "ru",.    "rugby
-00011990: 222c 0a20 2020 2022 7275 6872 222c 0a20  ",.    "ruhr",. 
-000119a0: 2020 2022 7275 6e22 2c0a 2020 2020 2272     "run",.    "r
-000119b0: 7722 2c0a 2020 2020 2272 7765 222c 0a20  w",.    "rwe",. 
-000119c0: 2020 2022 7279 756b 7975 222c 0a20 2020     "ryukyu",.   
-000119d0: 2023 2073 0a20 2020 2022 7361 222c 0a20   # s.    "sa",. 
-000119e0: 2020 2022 7361 6172 6c61 6e64 222c 0a20     "saarland",. 
-000119f0: 2020 2022 7361 6665 222c 0a20 2020 2022     "safe",.    "
-00011a00: 7361 6665 7479 222c 0a20 2020 2022 7361  safety",.    "sa
-00011a10: 6b75 7261 222c 0a20 2020 2022 7361 6c65  kura",.    "sale
-00011a20: 222c 0a20 2020 2022 7361 6c6f 6e22 2c0a  ",.    "salon",.
-00011a30: 2020 2020 2273 616d 7363 6c75 6222 2c0a      "samsclub",.
-00011a40: 2020 2020 2273 616d 7375 6e67 222c 0a20      "samsung",. 
-00011a50: 2020 2022 7361 6e64 7669 6b22 2c0a 2020     "sandvik",.  
-00011a60: 2020 2273 616e 6476 696b 636f 726f 6d61    "sandvikcoroma
-00011a70: 6e74 222c 0a20 2020 2022 7361 6e6f 6669  nt",.    "sanofi
-00011a80: 222c 0a20 2020 2022 7361 7022 2c0a 2020  ",.    "sap",.  
-00011a90: 2020 2273 6170 6f22 2c0a 2020 2020 2273    "sapo",.    "s
-00011aa0: 6172 6c22 2c0a 2020 2020 2273 6173 222c  arl",.    "sas",
-00011ab0: 0a20 2020 2022 7361 7665 222c 0a20 2020  .    "save",.   
-00011ac0: 2022 7361 786f 222c 0a20 2020 2022 7362   "saxo",.    "sb
-00011ad0: 222c 0a20 2020 2022 7362 6922 2c0a 2020  ",.    "sbi",.  
-00011ae0: 2020 2273 6273 222c 0a20 2020 2022 7363    "sbs",.    "sc
-00011af0: 222c 0a20 2020 2022 7363 6122 2c0a 2020  ",.    "sca",.  
-00011b00: 2020 2273 6362 222c 0a20 2020 2022 7363    "scb",.    "sc
-00011b10: 6861 6566 666c 6572 222c 0a20 2020 2022  haeffler",.    "
-00011b20: 7363 686d 6964 7422 2c0a 2020 2020 2273  schmidt",.    "s
-00011b30: 6368 6f6c 6172 7368 6970 7322 2c0a 2020  cholarships",.  
-00011b40: 2020 2273 6368 6f6f 6c22 2c0a 2020 2020    "school",.    
-00011b50: 2273 6368 756c 6522 2c0a 2020 2020 2273  "schule",.    "s
-00011b60: 6368 7761 727a 222c 0a20 2020 2022 7363  chwarz",.    "sc
-00011b70: 6965 6e63 6522 2c0a 2020 2020 2273 636a  ience",.    "scj
-00011b80: 6f68 6e73 6f6e 222c 0a20 2020 2022 7363  ohnson",.    "sc
-00011b90: 6f72 222c 0a20 2020 2022 7363 6f74 222c  or",.    "scot",
-00011ba0: 0a20 2020 2022 7364 222c 0a20 2020 2022  .    "sd",.    "
-00011bb0: 7365 222c 0a20 2020 2022 7365 6172 6368  se",.    "search
-00011bc0: 222c 0a20 2020 2022 7365 6174 222c 0a20  ",.    "seat",. 
-00011bd0: 2020 2022 7365 6375 7265 222c 0a20 2020     "secure",.   
-00011be0: 2022 7365 6375 7269 7479 222c 0a20 2020   "security",.   
-00011bf0: 2022 7365 656b 222c 0a20 2020 2022 7365   "seek",.    "se
-00011c00: 6c65 6374 222c 0a20 2020 2022 7365 6e65  lect",.    "sene
-00011c10: 7222 2c0a 2020 2020 2273 6572 7669 6365  r",.    "service
-00011c20: 7322 2c0a 2020 2020 2273 6573 222c 0a20  s",.    "ses",. 
-00011c30: 2020 2022 7365 7665 6e22 2c0a 2020 2020     "seven",.    
-00011c40: 2273 6577 222c 0a20 2020 2022 7365 7822  "sew",.    "sex"
-00011c50: 2c0a 2020 2020 2273 6578 7922 2c0a 2020  ,.    "sexy",.  
-00011c60: 2020 2273 6672 222c 0a20 2020 2022 7367    "sfr",.    "sg
-00011c70: 222c 0a20 2020 2022 7368 222c 0a20 2020  ",.    "sh",.   
-00011c80: 2022 7368 616e 6772 696c 6122 2c0a 2020   "shangrila",.  
-00011c90: 2020 2273 6861 7270 222c 0a20 2020 2022    "sharp",.    "
-00011ca0: 7368 6177 222c 0a20 2020 2022 7368 656c  shaw",.    "shel
-00011cb0: 6c22 2c0a 2020 2020 2273 6869 6122 2c0a  l",.    "shia",.
-00011cc0: 2020 2020 2273 6869 6b73 6861 222c 0a20      "shiksha",. 
-00011cd0: 2020 2022 7368 6f65 7322 2c0a 2020 2020     "shoes",.    
-00011ce0: 2273 686f 7022 2c0a 2020 2020 2273 686f  "shop",.    "sho
-00011cf0: 7070 696e 6722 2c0a 2020 2020 2273 686f  pping",.    "sho
-00011d00: 756a 6922 2c0a 2020 2020 2273 686f 7722  uji",.    "show"
-00011d10: 2c0a 2020 2020 2273 686f 7774 696d 6522  ,.    "showtime"
-00011d20: 2c0a 2020 2020 2273 6872 6972 616d 222c  ,.    "shriram",
-00011d30: 0a20 2020 2022 7369 222c 0a20 2020 2022  .    "si",.    "
-00011d40: 7369 6c6b 222c 0a20 2020 2022 7369 6e61  silk",.    "sina
-00011d50: 222c 0a20 2020 2022 7369 6e67 6c65 7322  ",.    "singles"
-00011d60: 2c0a 2020 2020 2273 6974 6522 2c0a 2020  ,.    "site",.  
-00011d70: 2020 2273 6a22 2c0a 2020 2020 2273 6b22    "sj",.    "sk"
-00011d80: 2c0a 2020 2020 2273 6b69 222c 0a20 2020  ,.    "ski",.   
-00011d90: 2022 736b 696e 222c 0a20 2020 2022 736b   "skin",.    "sk
-00011da0: 7922 2c0a 2020 2020 2273 6b79 7065 222c  y",.    "skype",
-00011db0: 0a20 2020 2022 736c 222c 0a20 2020 2022  .    "sl",.    "
-00011dc0: 736c 696e 6722 2c0a 2020 2020 2273 6d22  sling",.    "sm"
-00011dd0: 2c0a 2020 2020 2273 6d61 7274 222c 0a20  ,.    "smart",. 
-00011de0: 2020 2022 736d 696c 6522 2c0a 2020 2020     "smile",.    
-00011df0: 2273 6e22 2c0a 2020 2020 2273 6e63 6622  "sn",.    "sncf"
-00011e00: 2c0a 2020 2020 2273 6f22 2c0a 2020 2020  ,.    "so",.    
-00011e10: 2273 6f63 6365 7222 2c0a 2020 2020 2273  "soccer",.    "s
-00011e20: 6f63 6961 6c22 2c0a 2020 2020 2273 6f66  ocial",.    "sof
-00011e30: 7462 616e 6b22 2c0a 2020 2020 2273 6f66  tbank",.    "sof
-00011e40: 7477 6172 6522 2c0a 2020 2020 2273 6f68  tware",.    "soh
-00011e50: 7522 2c0a 2020 2020 2273 6f6c 6172 222c  u",.    "solar",
-00011e60: 0a20 2020 2022 736f 6c75 7469 6f6e 7322  .    "solutions"
-00011e70: 2c0a 2020 2020 2273 6f6e 6722 2c0a 2020  ,.    "song",.  
-00011e80: 2020 2273 6f6e 7922 2c0a 2020 2020 2273    "sony",.    "s
-00011e90: 6f79 222c 0a20 2020 2022 7370 6163 6522  oy",.    "space"
-00011ea0: 2c0a 2020 2020 2273 7069 6567 656c 222c  ,.    "spiegel",
-00011eb0: 0a20 2020 2022 7370 6f74 222c 0a20 2020  .    "spot",.   
-00011ec0: 2022 7370 7265 6164 6265 7474 696e 6722   "spreadbetting"
-00011ed0: 2c0a 2020 2020 2273 7222 2c0a 2020 2020  ,.    "sr",.    
-00011ee0: 2273 726c 222c 0a20 2020 2022 7372 7422  "srl",.    "srt"
-00011ef0: 2c0a 2020 2020 2273 7422 2c0a 2020 2020  ,.    "st",.    
-00011f00: 2273 7461 6461 222c 0a20 2020 2022 7374  "stada",.    "st
-00011f10: 6170 6c65 7322 2c0a 2020 2020 2273 7461  aples",.    "sta
-00011f20: 7222 2c0a 2020 2020 2273 7461 7268 7562  r",.    "starhub
-00011f30: 222c 0a20 2020 2022 7374 6174 6562 616e  ",.    "stateban
-00011f40: 6b22 2c0a 2020 2020 2273 7461 7465 6661  k",.    "statefa
-00011f50: 726d 222c 0a20 2020 2022 7374 6174 6f69  rm",.    "statoi
-00011f60: 6c22 2c0a 2020 2020 2273 7463 222c 0a20  l",.    "stc",. 
-00011f70: 2020 2022 7374 6367 726f 7570 222c 0a20     "stcgroup",. 
-00011f80: 2020 2022 7374 6f63 6b68 6f6c 6d22 2c0a     "stockholm",.
-00011f90: 2020 2020 2273 746f 7261 6765 222c 0a20      "storage",. 
-00011fa0: 2020 2022 7374 6f72 6522 2c0a 2020 2020     "store",.    
-00011fb0: 2273 7472 6561 6d22 2c0a 2020 2020 2273  "stream",.    "s
-00011fc0: 7475 6469 6f22 2c0a 2020 2020 2273 7475  tudio",.    "stu
-00011fd0: 6479 222c 0a20 2020 2022 7374 796c 6522  dy",.    "style"
-00011fe0: 2c0a 2020 2020 2273 7522 2c0a 2020 2020  ,.    "su",.    
-00011ff0: 2273 7563 6b73 222c 0a20 2020 2022 7375  "sucks",.    "su
-00012000: 7070 6c69 6573 222c 0a20 2020 2022 7375  pplies",.    "su
-00012010: 7070 6c79 222c 0a20 2020 2022 7375 7070  pply",.    "supp
-00012020: 6f72 7422 2c0a 2020 2020 2273 7572 6622  ort",.    "surf"
-00012030: 2c0a 2020 2020 2273 7572 6765 7279 222c  ,.    "surgery",
-00012040: 0a20 2020 2022 7375 7a75 6b69 222c 0a20  .    "suzuki",. 
-00012050: 2020 2022 7376 222c 0a20 2020 2022 7377     "sv",.    "sw
-00012060: 6174 6368 222c 0a20 2020 2022 7377 6966  atch",.    "swif
-00012070: 7463 6f76 6572 222c 0a20 2020 2022 7377  tcover",.    "sw
-00012080: 6973 7322 2c0a 2020 2020 2273 7822 2c0a  iss",.    "sx",.
-00012090: 2020 2020 2273 7922 2c0a 2020 2020 2273      "sy",.    "s
-000120a0: 7964 6e65 7922 2c0a 2020 2020 2273 796d  ydney",.    "sym
-000120b0: 616e 7465 6322 2c0a 2020 2020 2273 7973  antec",.    "sys
-000120c0: 7465 6d73 222c 0a20 2020 2022 737a 222c  tems",.    "sz",
-000120d0: 0a20 2020 2023 2074 0a20 2020 2022 7461  .    # t.    "ta
-000120e0: 6222 2c0a 2020 2020 2274 6169 7065 6922  b",.    "taipei"
-000120f0: 2c0a 2020 2020 2274 616c 6b22 2c0a 2020  ,.    "talk",.  
-00012100: 2020 2274 616f 6261 6f22 2c0a 2020 2020    "taobao",.    
-00012110: 2274 6172 6765 7422 2c0a 2020 2020 2274  "target",.    "t
-00012120: 6174 616d 6f74 6f72 7322 2c0a 2020 2020  atamotors",.    
-00012130: 2274 6174 6172 222c 0a20 2020 2022 7461  "tatar",.    "ta
-00012140: 7474 6f6f 222c 0a20 2020 2022 7461 7822  ttoo",.    "tax"
-00012150: 2c0a 2020 2020 2274 6178 6922 2c0a 2020  ,.    "taxi",.  
-00012160: 2020 2274 6322 2c0a 2020 2020 2274 6369    "tc",.    "tci
-00012170: 222c 0a20 2020 2022 7464 222c 0a20 2020  ",.    "td",.   
-00012180: 2022 7464 6b22 2c0a 2020 2020 2274 6561   "tdk",.    "tea
-00012190: 6d22 2c0a 2020 2020 2274 6563 6822 2c0a  m",.    "tech",.
-000121a0: 2020 2020 2274 6563 686e 6f6c 6f67 7922      "technology"
-000121b0: 2c0a 2020 2020 2274 656c 222c 0a20 2020  ,.    "tel",.   
-000121c0: 2022 7465 6c65 6369 7479 222c 0a20 2020   "telecity",.   
-000121d0: 2022 7465 6c65 666f 6e69 6361 222c 0a20   "telefonica",. 
-000121e0: 2020 2022 7465 6d61 7365 6b22 2c0a 2020     "temasek",.  
-000121f0: 2020 2274 656e 6e69 7322 2c0a 2020 2020    "tennis",.    
-00012200: 2274 6576 6122 2c0a 2020 2020 2274 6622  "teva",.    "tf"
-00012210: 2c0a 2020 2020 2274 6722 2c0a 2020 2020  ,.    "tg",.    
-00012220: 2274 6822 2c0a 2020 2020 2274 6864 222c  "th",.    "thd",
-00012230: 0a20 2020 2022 7468 6561 7465 7222 2c0a  .    "theater",.
-00012240: 2020 2020 2274 6865 6174 7265 222c 0a20      "theatre",. 
-00012250: 2020 2022 7469 6161 222c 0a20 2020 2022     "tiaa",.    "
-00012260: 7469 636b 6574 7322 2c0a 2020 2020 2274  tickets",.    "t
-00012270: 6965 6e64 6122 2c0a 2020 2020 2274 6966  ienda",.    "tif
-00012280: 6661 6e79 222c 0a20 2020 2022 7469 7073  fany",.    "tips
-00012290: 222c 0a20 2020 2022 7469 7265 7322 2c0a  ",.    "tires",.
-000122a0: 2020 2020 2274 6972 6f6c 222c 0a20 2020      "tirol",.   
-000122b0: 2022 746a 222c 0a20 2020 2022 746a 6d61   "tj",.    "tjma
-000122c0: 7878 222c 0a20 2020 2022 746a 7822 2c0a  xx",.    "tjx",.
-000122d0: 2020 2020 2274 6b22 2c0a 2020 2020 2274      "tk",.    "t
-000122e0: 6b6d 6178 7822 2c0a 2020 2020 2274 6c22  kmaxx",.    "tl"
-000122f0: 2c0a 2020 2020 2274 6d22 2c0a 2020 2020  ,.    "tm",.    
-00012300: 2274 6d61 6c6c 222c 0a20 2020 2022 746e  "tmall",.    "tn
-00012310: 222c 0a20 2020 2022 746f 222c 0a20 2020  ",.    "to",.   
-00012320: 2022 746f 6461 7922 2c0a 2020 2020 2274   "today",.    "t
-00012330: 6f6b 796f 222c 0a20 2020 2022 746f 6f6c  okyo",.    "tool
-00012340: 7322 2c0a 2020 2020 2274 6f70 222c 0a20  s",.    "top",. 
-00012350: 2020 2022 746f 7261 7922 2c0a 2020 2020     "toray",.    
-00012360: 2274 6f73 6869 6261 222c 0a20 2020 2022  "toshiba",.    "
-00012370: 746f 7461 6c22 2c0a 2020 2020 2274 6f75  total",.    "tou
-00012380: 7273 222c 0a20 2020 2022 746f 776e 222c  rs",.    "town",
-00012390: 0a20 2020 2022 746f 796f 7461 222c 0a20  .    "toyota",. 
-000123a0: 2020 2022 746f 7973 222c 0a20 2020 2022     "toys",.    "
-000123b0: 7472 222c 0a20 2020 2022 7472 6164 6522  tr",.    "trade"
-000123c0: 2c0a 2020 2020 2274 7261 6469 6e67 222c  ,.    "trading",
-000123d0: 0a20 2020 2022 7472 6169 6e69 6e67 222c  .    "training",
-000123e0: 0a20 2020 2022 7472 6176 656c 222c 0a20  .    "travel",. 
-000123f0: 2020 2022 7472 6176 656c 6368 616e 6e65     "travelchanne
-00012400: 6c22 2c0a 2020 2020 2274 7261 7665 6c65  l",.    "travele
-00012410: 7273 222c 0a20 2020 2022 7472 6176 656c  rs",.    "travel
-00012420: 6572 7369 6e73 7572 616e 6365 222c 0a20  ersinsurance",. 
-00012430: 2020 2022 7472 7573 7422 2c0a 2020 2020     "trust",.    
-00012440: 2274 7276 222c 0a20 2020 2022 7474 222c  "trv",.    "tt",
-00012450: 0a20 2020 2022 7475 6265 222c 0a20 2020  .    "tube",.   
-00012460: 2022 7475 6922 2c0a 2020 2020 2274 756e   "tui",.    "tun
-00012470: 6573 222c 0a20 2020 2022 7475 7368 7522  es",.    "tushu"
-00012480: 2c0a 2020 2020 2274 7622 2c0a 2020 2020  ,.    "tv",.    
-00012490: 2274 7673 222c 0a20 2020 2022 7477 222c  "tvs",.    "tw",
-000124a0: 0a20 2020 2022 747a 222c 0a20 2020 2023  .    "tz",.    #
-000124b0: 2075 0a20 2020 2022 7561 222c 0a20 2020   u.    "ua",.   
-000124c0: 2022 7562 616e 6b22 2c0a 2020 2020 2275   "ubank",.    "u
-000124d0: 6273 222c 0a20 2020 2022 7563 6f6e 6e65  bs",.    "uconne
-000124e0: 6374 222c 0a20 2020 2022 7567 222c 0a20  ct",.    "ug",. 
-000124f0: 2020 2022 756b 222c 0a20 2020 2022 756e     "uk",.    "un
-00012500: 6963 6f6d 222c 0a20 2020 2022 756e 6976  icom",.    "univ
-00012510: 6572 7369 7479 222c 0a20 2020 2022 756e  ersity",.    "un
-00012520: 6f22 2c0a 2020 2020 2275 6f6c 222c 0a20  o",.    "uol",. 
-00012530: 2020 2022 7570 7322 2c0a 2020 2020 2275     "ups",.    "u
-00012540: 7322 2c0a 2020 2020 2275 7922 2c0a 2020  s",.    "uy",.  
-00012550: 2020 2275 7a22 2c0a 2020 2020 2320 760a    "uz",.    # v.
-00012560: 2020 2020 2276 6122 2c0a 2020 2020 2276      "va",.    "v
-00012570: 6163 6174 696f 6e73 222c 0a20 2020 2022  acations",.    "
-00012580: 7661 6e61 222c 0a20 2020 2022 7661 6e67  vana",.    "vang
-00012590: 7561 7264 222c 0a20 2020 2022 7663 222c  uard",.    "vc",
-000125a0: 0a20 2020 2022 7665 222c 0a20 2020 2022  .    "ve",.    "
-000125b0: 7665 6761 7322 2c0a 2020 2020 2276 656e  vegas",.    "ven
-000125c0: 7475 7265 7322 2c0a 2020 2020 2276 6572  tures",.    "ver
-000125d0: 6973 6967 6e22 2c0a 2020 2020 2276 6572  isign",.    "ver
-000125e0: 7369 6368 6572 756e 6722 2c0a 2020 2020  sicherung",.    
-000125f0: 2276 6574 222c 0a20 2020 2022 7667 222c  "vet",.    "vg",
-00012600: 0a20 2020 2022 7669 222c 0a20 2020 2022  .    "vi",.    "
-00012610: 7669 616a 6573 222c 0a20 2020 2022 7669  viajes",.    "vi
-00012620: 6465 6f22 2c0a 2020 2020 2276 6967 222c  deo",.    "vig",
-00012630: 0a20 2020 2022 7669 6b69 6e67 222c 0a20  .    "viking",. 
-00012640: 2020 2022 7669 6c6c 6173 222c 0a20 2020     "villas",.   
-00012650: 2022 7669 6e22 2c0a 2020 2020 2276 6970   "vin",.    "vip
-00012660: 222c 0a20 2020 2022 7669 7267 696e 222c  ",.    "virgin",
-00012670: 0a20 2020 2022 7669 7361 222c 0a20 2020  .    "visa",.   
-00012680: 2022 7669 7369 6f6e 222c 0a20 2020 2022   "vision",.    "
-00012690: 7669 7374 6122 2c0a 2020 2020 2276 6973  vista",.    "vis
-000126a0: 7461 7072 696e 7422 2c0a 2020 2020 2276  taprint",.    "v
-000126b0: 6976 6122 2c0a 2020 2020 2276 6976 6f22  iva",.    "vivo"
-000126c0: 2c0a 2020 2020 2276 6c61 616e 6465 7265  ,.    "vlaandere
-000126d0: 6e22 2c0a 2020 2020 2276 6e22 2c0a 2020  n",.    "vn",.  
-000126e0: 2020 2276 6f64 6b61 222c 0a20 2020 2022    "vodka",.    "
-000126f0: 766f 6c6b 7377 6167 656e 222c 0a20 2020  volkswagen",.   
-00012700: 2022 766f 6c76 6f22 2c0a 2020 2020 2276   "volvo",.    "v
-00012710: 6f74 6522 2c0a 2020 2020 2276 6f74 696e  ote",.    "votin
-00012720: 6722 2c0a 2020 2020 2276 6f74 6f22 2c0a  g",.    "voto",.
-00012730: 2020 2020 2276 6f79 6167 6522 2c0a 2020      "voyage",.  
-00012740: 2020 2276 7522 2c0a 2020 2020 2276 7565    "vu",.    "vue
-00012750: 6c6f 7322 2c0a 2020 2020 2320 770a 2020  los",.    # w.  
-00012760: 2020 2277 616c 6573 222c 0a20 2020 2022    "wales",.    "
-00012770: 7761 6c6d 6172 7422 2c0a 2020 2020 2277  walmart",.    "w
-00012780: 616c 7465 7222 2c0a 2020 2020 2277 616e  alter",.    "wan
-00012790: 6722 2c0a 2020 2020 2277 616e 6767 6f75  g",.    "wanggou
-000127a0: 222c 0a20 2020 2022 7761 726d 616e 222c  ",.    "warman",
-000127b0: 0a20 2020 2022 7761 7463 6822 2c0a 2020  .    "watch",.  
-000127c0: 2020 2277 6174 6368 6573 222c 0a20 2020    "watches",.   
-000127d0: 2022 7765 6174 6865 7222 2c0a 2020 2020   "weather",.    
-000127e0: 2277 6561 7468 6572 6368 616e 6e65 6c22  "weatherchannel"
-000127f0: 2c0a 2020 2020 2277 6562 6361 6d22 2c0a  ,.    "webcam",.
-00012800: 2020 2020 2277 6562 6572 222c 0a20 2020      "weber",.   
-00012810: 2022 7765 6273 6974 6522 2c0a 2020 2020   "website",.    
-00012820: 2277 6564 222c 0a20 2020 2022 7765 6464  "wed",.    "wedd
-00012830: 696e 6722 2c0a 2020 2020 2277 6569 626f  ing",.    "weibo
-00012840: 222c 0a20 2020 2022 7765 6972 222c 0a20  ",.    "weir",. 
-00012850: 2020 2022 7766 222c 0a20 2020 2022 7768     "wf",.    "wh
-00012860: 6f73 7768 6f22 2c0a 2020 2020 2277 6965  oswho",.    "wie
-00012870: 6e22 2c0a 2020 2020 2277 696b 6922 2c0a  n",.    "wiki",.
-00012880: 2020 2020 2277 696c 6c69 616d 6869 6c6c      "williamhill
-00012890: 222c 0a20 2020 2022 7769 6e22 2c0a 2020  ",.    "win",.  
-000128a0: 2020 2277 696e 646f 7773 222c 0a20 2020    "windows",.   
-000128b0: 2022 7769 6e65 222c 0a20 2020 2022 7769   "wine",.    "wi
-000128c0: 6e6e 6572 7322 2c0a 2020 2020 2277 6d65  nners",.    "wme
-000128d0: 222c 0a20 2020 2022 776f 6c74 6572 736b  ",.    "woltersk
-000128e0: 6c75 7765 7222 2c0a 2020 2020 2277 6f6f  luwer",.    "woo
-000128f0: 6473 6964 6522 2c0a 2020 2020 2277 6f72  dside",.    "wor
-00012900: 6b22 2c0a 2020 2020 2277 6f72 6b73 222c  k",.    "works",
-00012910: 0a20 2020 2022 776f 726c 6422 2c0a 2020  .    "world",.  
-00012920: 2020 2277 6f77 222c 0a20 2020 2022 7773    "wow",.    "ws
-00012930: 222c 0a20 2020 2022 7774 6322 2c0a 2020  ",.    "wtc",.  
-00012940: 2020 2277 7466 222c 0a20 2020 2023 2078    "wtf",.    # x
-00012950: 0a20 2020 2022 7862 6f78 222c 0a20 2020  .    "xbox",.   
-00012960: 2022 7865 726f 7822 2c0a 2020 2020 2278   "xerox",.    "x
-00012970: 6669 6e69 7479 222c 0a20 2020 2022 7869  finity",.    "xi
-00012980: 6875 616e 222c 0a20 2020 2022 7869 6e22  huan",.    "xin"
-00012990: 2c0a 2020 2020 2278 6e2d 2d31 3162 3463  ,.    "xn--11b4c
-000129a0: 3364 222c 0a20 2020 2022 786e 2d2d 3163  3d",.    "xn--1c
-000129b0: 6b32 6531 6222 2c0a 2020 2020 2278 6e2d  k2e1b",.    "xn-
-000129c0: 2d31 7171 7732 3361 222c 0a20 2020 2022  -1qqw23a",.    "
-000129d0: 786e 2d2d 3273 6372 6a39 6322 2c0a 2020  xn--2scrj9c",.  
-000129e0: 2020 2278 6e2d 2d33 3072 7237 7922 2c0a    "xn--30rr7y",.
-000129f0: 2020 2020 2278 6e2d 2d33 6273 7430 306d      "xn--3bst00m
-00012a00: 222c 0a20 2020 2022 786e 2d2d 3364 7334  ",.    "xn--3ds4
-00012a10: 3433 6722 2c0a 2020 2020 2278 6e2d 2d33  43g",.    "xn--3
-00012a20: 6530 6237 3037 6522 2c0a 2020 2020 2278  e0b707e",.    "x
-00012a30: 6e2d 2d33 6863 726a 3963 222c 0a20 2020  n--3hcrj9c",.   
-00012a40: 2022 786e 2d2d 336f 7131 3876 6c38 706e   "xn--3oq18vl8pn
-00012a50: 3336 6122 2c0a 2020 2020 2278 6e2d 2d33  36a",.    "xn--3
-00012a60: 7078 7538 6b22 2c0a 2020 2020 2278 6e2d  pxu8k",.    "xn-
-00012a70: 2d34 3263 3264 3961 222c 0a20 2020 2022  -42c2d9a",.    "
-00012a80: 786e 2d2d 3435 6272 3563 796c 222c 0a20  xn--45br5cyl",. 
-00012a90: 2020 2022 786e 2d2d 3435 6272 6a39 6322     "xn--45brj9c"
-00012aa0: 2c0a 2020 2020 2278 6e2d 2d34 3571 3131  ,.    "xn--45q11
-00012ab0: 6322 2c0a 2020 2020 2278 6e2d 2d34 6762  c",.    "xn--4gb
-00012ac0: 7269 6d22 2c0a 2020 2020 2278 6e2d 2d35  rim",.    "xn--5
-00012ad0: 3462 3766 7461 3063 6322 2c0a 2020 2020  4b7fta0cc",.    
-00012ae0: 2278 6e2d 2d35 3571 7734 3267 222c 0a20  "xn--55qw42g",. 
-00012af0: 2020 2022 786e 2d2d 3535 7178 3564 222c     "xn--55qx5d",
-00012b00: 0a20 2020 2022 786e 2d2d 3573 7533 346a  .    "xn--5su34j
-00012b10: 3933 3662 6773 6722 2c0a 2020 2020 2278  936bgsg",.    "x
-00012b20: 6e2d 2d35 747a 6d35 6722 2c0a 2020 2020  n--5tzm5g",.    
-00012b30: 2278 6e2d 2d36 6672 7a38 3267 222c 0a20  "xn--6frz82g",. 
-00012b40: 2020 2022 786e 2d2d 3671 7139 3836 6233     "xn--6qq986b3
-00012b50: 786c 222c 0a20 2020 2022 786e 2d2d 3830  xl",.    "xn--80
-00012b60: 6164 7868 6b73 222c 0a20 2020 2022 786e  adxhks",.    "xn
-00012b70: 2d2d 3830 616f 3231 6122 2c0a 2020 2020  --80ao21a",.    
-00012b80: 2278 6e2d 2d38 3061 7165 6364 7231 6122  "xn--80aqecdr1a"
-00012b90: 2c0a 2020 2020 2278 6e2d 2d38 3061 7365  ,.    "xn--80ase
-00012ba0: 6864 6222 2c0a 2020 2020 2278 6e2d 2d38  hdb",.    "xn--8
-00012bb0: 3061 7377 6722 2c0a 2020 2020 2278 6e2d  0aswg",.    "xn-
-00012bc0: 2d38 7930 6130 3633 6122 2c0a 2020 2020  -8y0a063a",.    
-00012bd0: 2278 6e2d 2d39 3061 3361 6322 2c0a 2020  "xn--90a3ac",.  
-00012be0: 2020 2278 6e2d 2d39 3061 6522 2c0a 2020    "xn--90ae",.  
-00012bf0: 2020 2278 6e2d 2d39 3061 6973 222c 0a20    "xn--90ais",. 
-00012c00: 2020 2022 786e 2d2d 3964 6271 3261 222c     "xn--9dbq2a",
-00012c10: 0a20 2020 2022 786e 2d2d 3965 7435 3275  .    "xn--9et52u
-00012c20: 222c 0a20 2020 2022 786e 2d2d 396b 7274  ",.    "xn--9krt
-00012c30: 3030 6122 2c0a 2020 2020 2278 6e2d 2d62  00a",.    "xn--b
-00012c40: 3477 3630 3566 6572 6422 2c0a 2020 2020  4w605ferd",.    
-00012c50: 2278 6e2d 2d62 636b 3162 3961 3564 7265  "xn--bck1b9a5dre
-00012c60: 3463 222c 0a20 2020 2022 786e 2d2d 6331  4c",.    "xn--c1
-00012c70: 6176 6722 2c0a 2020 2020 2278 6e2d 2d63  avg",.    "xn--c
-00012c80: 3262 7237 6722 2c0a 2020 2020 2278 6e2d  2br7g",.    "xn-
-00012c90: 2d63 636b 3262 3362 222c 0a20 2020 2022  -cck2b3b",.    "
-00012ca0: 786e 2d2d 6367 3462 6b69 222c 0a20 2020  xn--cg4bki",.   
-00012cb0: 2022 786e 2d2d 636c 6368 6330 6561 3062   "xn--clchc0ea0b
-00012cc0: 3267 3261 3967 6364 222c 0a20 2020 2022  2g2a9gcd",.    "
-00012cd0: 786e 2d2d 637a 7236 3934 6222 2c0a 2020  xn--czr694b",.  
-00012ce0: 2020 2278 6e2d 2d63 7a72 7330 7422 2c0a    "xn--czrs0t",.
-00012cf0: 2020 2020 2278 6e2d 2d63 7a72 7532 6422      "xn--czru2d"
-00012d00: 2c0a 2020 2020 2278 6e2d 2d64 3161 636a  ,.    "xn--d1acj
-00012d10: 3362 222c 0a20 2020 2022 786e 2d2d 6431  3b",.    "xn--d1
-00012d20: 616c 6622 2c0a 2020 2020 2278 6e2d 2d65  alf",.    "xn--e
-00012d30: 3161 3463 222c 0a20 2020 2022 786e 2d2d  1a4c",.    "xn--
-00012d40: 6563 6b76 6474 6339 6422 2c0a 2020 2020  eckvdtc9d",.    
-00012d50: 2278 6e2d 2d65 6676 7938 3868 222c 0a20  "xn--efvy88h",. 
-00012d60: 2020 2022 786e 2d2d 6573 7476 3735 6722     "xn--estv75g"
-00012d70: 2c0a 2020 2020 2278 6e2d 2d66 6374 3432  ,.    "xn--fct42
-00012d80: 396b 222c 0a20 2020 2022 786e 2d2d 6668  9k",.    "xn--fh
-00012d90: 6265 6922 2c0a 2020 2020 2278 6e2d 2d66  bei",.    "xn--f
-00012da0: 6971 3232 3863 3568 7322 2c0a 2020 2020  iq228c5hs",.    
-00012db0: 2278 6e2d 2d66 6971 3634 6222 2c0a 2020  "xn--fiq64b",.  
-00012dc0: 2020 2278 6e2d 2d66 6971 7338 7322 2c0a    "xn--fiqs8s",.
-00012dd0: 2020 2020 2278 6e2d 2d66 6971 7a39 7322      "xn--fiqz9s"
-00012de0: 2c0a 2020 2020 2278 6e2d 2d66 6a71 3732  ,.    "xn--fjq72
-00012df0: 3061 222c 0a20 2020 2022 786e 2d2d 666c  0a",.    "xn--fl
-00012e00: 7733 3531 6522 2c0a 2020 2020 2278 6e2d  w351e",.    "xn-
-00012e10: 2d66 7063 726a 3963 3364 222c 0a20 2020  -fpcrj9c3d",.   
-00012e20: 2022 786e 2d2d 667a 6332 6339 6532 6322   "xn--fzc2c9e2c"
-00012e30: 2c0a 2020 2020 2278 6e2d 2d66 7a79 7338  ,.    "xn--fzys8
-00012e40: 6436 3975 7667 6d22 2c0a 2020 2020 2278  d69uvgm",.    "x
-00012e50: 6e2d 2d67 3278 7834 3863 222c 0a20 2020  n--g2xx48c",.   
-00012e60: 2022 786e 2d2d 6763 6b72 3366 3066 222c   "xn--gckr3f0f",
-00012e70: 0a20 2020 2022 786e 2d2d 6765 6372 6a39  .    "xn--gecrj9
-00012e80: 6322 2c0a 2020 2020 2278 6e2d 2d67 6b33  c",.    "xn--gk3
-00012e90: 6174 3165 222c 0a20 2020 2022 786e 2d2d  at1e",.    "xn--
-00012ea0: 6832 6272 6567 3365 7665 222c 0a20 2020  h2breg3eve",.   
-00012eb0: 2022 786e 2d2d 6832 6272 6a39 6322 2c0a   "xn--h2brj9c",.
-00012ec0: 2020 2020 2278 6e2d 2d68 3262 726a 3963      "xn--h2brj9c
-00012ed0: 3863 222c 0a20 2020 2022 786e 2d2d 6878  8c",.    "xn--hx
-00012ee0: 7438 3134 6522 2c0a 2020 2020 2278 6e2d  t814e",.    "xn-
-00012ef0: 2d69 3162 3662 3161 3661 3265 222c 0a20  -i1b6b1a6a2e",. 
-00012f00: 2020 2022 786e 2d2d 696d 7235 3133 6e22     "xn--imr513n"
-00012f10: 2c0a 2020 2020 2278 6e2d 2d69 6f30 6137  ,.    "xn--io0a7
-00012f20: 6922 2c0a 2020 2020 2278 6e2d 2d6a 3161  i",.    "xn--j1a
-00012f30: 6566 222c 0a20 2020 2022 786e 2d2d 6a31  ef",.    "xn--j1
-00012f40: 616d 6822 2c0a 2020 2020 2278 6e2d 2d6a  amh",.    "xn--j
-00012f50: 3677 3139 3367 222c 0a20 2020 2022 786e  6w193g",.    "xn
-00012f60: 2d2d 6a6c 7136 3175 3977 3762 222c 0a20  --jlq61u9w7b",. 
-00012f70: 2020 2022 786e 2d2d 6a76 7231 3839 6d22     "xn--jvr189m"
-00012f80: 2c0a 2020 2020 2278 6e2d 2d6b 6372 7837  ,.    "xn--kcrx7
-00012f90: 3764 3178 3461 222c 0a20 2020 2022 786e  7d1x4a",.    "xn
-00012fa0: 2d2d 6b70 7277 3133 6422 2c0a 2020 2020  --kprw13d",.    
-00012fb0: 2278 6e2d 2d6b 7072 7935 3764 222c 0a20  "xn--kpry57d",. 
-00012fc0: 2020 2022 786e 2d2d 6b70 7537 3136 6622     "xn--kpu716f"
-00012fd0: 2c0a 2020 2020 2278 6e2d 2d6b 7075 7433  ,.    "xn--kput3
-00012fe0: 6922 2c0a 2020 2020 2278 6e2d 2d6c 3161  i",.    "xn--l1a
-00012ff0: 6363 222c 0a20 2020 2022 786e 2d2d 6c67  cc",.    "xn--lg
-00013000: 6262 6174 3161 6438 6a22 2c0a 2020 2020  bbat1ad8j",.    
-00013010: 2278 6e2d 2d6d 6762 3961 7762 6622 2c0a  "xn--mgb9awbf",.
-00013020: 2020 2020 2278 6e2d 2d6d 6762 6133 6133      "xn--mgba3a3
-00013030: 656a 7422 2c0a 2020 2020 2278 6e2d 2d6d  ejt",.    "xn--m
-00013040: 6762 6133 6134 6631 3661 222c 0a20 2020  gba3a4f16a",.   
-00013050: 2022 786e 2d2d 6d67 6261 3763 3062 626e   "xn--mgba7c0bbn
-00013060: 3061 222c 0a20 2020 2022 786e 2d2d 6d67  0a",.    "xn--mg
-00013070: 6261 616b 6337 6476 6622 2c0a 2020 2020  baakc7dvf",.    
-00013080: 2278 6e2d 2d6d 6762 6161 6d37 6138 6822  "xn--mgbaam7a8h"
-00013090: 2c0a 2020 2020 2278 6e2d 2d6d 6762 6162  ,.    "xn--mgbab
-000130a0: 3262 6422 2c0a 2020 2020 2278 6e2d 2d6d  2bd",.    "xn--m
-000130b0: 6762 6169 3961 7a67 7170 366a 222c 0a20  gbai9azgqp6j",. 
-000130c0: 2020 2022 786e 2d2d 6d67 6261 7968 3767     "xn--mgbayh7g
-000130d0: 7061 222c 0a20 2020 2022 786e 2d2d 6d67  pa",.    "xn--mg
-000130e0: 6262 3966 6270 6f62 222c 0a20 2020 2022  bb9fbpob",.    "
-000130f0: 786e 2d2d 6d67 6262 6831 6122 2c0a 2020  xn--mgbbh1a",.  
-00013100: 2020 2278 6e2d 2d6d 6762 6268 3161 3731    "xn--mgbbh1a71
-00013110: 6522 2c0a 2020 2020 2278 6e2d 2d6d 6762  e",.    "xn--mgb
-00013120: 6330 6139 617a 6367 222c 0a20 2020 2022  c0a9azcg",.    "
-00013130: 786e 2d2d 6d67 6263 6137 647a 646f 222c  xn--mgbca7dzdo",
-00013140: 0a20 2020 2022 786e 2d2d 6d67 6265 7270  .    "xn--mgberp
-00013150: 3461 3564 3461 7222 2c0a 2020 2020 2278  4a5d4ar",.    "x
-00013160: 6e2d 2d6d 6762 6775 3832 6122 2c0a 2020  n--mgbgu82a",.  
-00013170: 2020 2278 6e2d 2d6d 6762 6934 6563 6578    "xn--mgbi4ecex
-00013180: 7022 2c0a 2020 2020 2278 6e2d 2d6d 6762  p",.    "xn--mgb
-00013190: 706c 3266 6822 2c0a 2020 2020 2278 6e2d  pl2fh",.    "xn-
-000131a0: 2d6d 6762 7433 6468 6422 2c0a 2020 2020  -mgbt3dhd",.    
-000131b0: 2278 6e2d 2d6d 6762 7478 3262 222c 0a20  "xn--mgbtx2b",. 
-000131c0: 2020 2022 786e 2d2d 6d67 6278 3463 6430     "xn--mgbx4cd0
-000131d0: 6162 222c 0a20 2020 2022 786e 2d2d 6d69  ab",.    "xn--mi
-000131e0: 7838 3931 6622 2c0a 2020 2020 2278 6e2d  x891f",.    "xn-
-000131f0: 2d6d 6b31 6275 3434 6322 2c0a 2020 2020  -mk1bu44c",.    
-00013200: 2278 6e2d 2d6d 7874 7131 6d22 2c0a 2020  "xn--mxtq1m",.  
-00013210: 2020 2278 6e2d 2d6e 6762 6335 617a 6422    "xn--ngbc5azd"
-00013220: 2c0a 2020 2020 2278 6e2d 2d6e 6762 6539  ,.    "xn--ngbe9
-00013230: 6530 6122 2c0a 2020 2020 2278 6e2d 2d6e  e0a",.    "xn--n
-00013240: 6762 7278 222c 0a20 2020 2022 786e 2d2d  gbrx",.    "xn--
-00013250: 6e6f 6465 222c 0a20 2020 2022 786e 2d2d  node",.    "xn--
-00013260: 6e71 7637 6622 2c0a 2020 2020 2278 6e2d  nqv7f",.    "xn-
-00013270: 2d6e 7176 3766 7330 3065 6d61 222c 0a20  -nqv7fs00ema",. 
-00013280: 2020 2022 786e 2d2d 6e79 7179 3236 6122     "xn--nyqy26a"
-00013290: 2c0a 2020 2020 2278 6e2d 2d6f 3363 7734  ,.    "xn--o3cw4
-000132a0: 6822 2c0a 2020 2020 2278 6e2d 2d6f 6762  h",.    "xn--ogb
-000132b0: 7066 3866 6c22 2c0a 2020 2020 2278 6e2d  pf8fl",.    "xn-
-000132c0: 2d70 3161 6366 222c 0a20 2020 2022 786e  -p1acf",.    "xn
-000132d0: 2d2d 7031 6169 222c 0a20 2020 2022 786e  --p1ai",.    "xn
-000132e0: 2d2d 7062 7439 3737 6322 2c0a 2020 2020  --pbt977c",.    
-000132f0: 2278 6e2d 2d70 6762 7330 6468 222c 0a20  "xn--pgbs0dh",. 
-00013300: 2020 2022 786e 2d2d 7073 7379 3275 222c     "xn--pssy2u",
-00013310: 0a20 2020 2022 786e 2d2d 7139 6a79 6234  .    "xn--q9jyb4
-00013320: 6322 2c0a 2020 2020 2278 6e2d 2d71 636b  c",.    "xn--qck
-00013330: 6131 706d 6322 2c0a 2020 2020 2278 6e2d  a1pmc",.    "xn-
-00013340: 2d71 7861 6d22 2c0a 2020 2020 2278 6e2d  -qxam",.    "xn-
-00013350: 2d72 6871 7639 3667 222c 0a20 2020 2022  -rhqv96g",.    "
-00013360: 786e 2d2d 726f 7675 3838 6222 2c0a 2020  xn--rovu88b",.  
-00013370: 2020 2278 6e2d 2d72 7663 3165 3061 6d33    "xn--rvc1e0am3
-00013380: 6522 2c0a 2020 2020 2278 6e2d 2d73 3962  e",.    "xn--s9b
-00013390: 726a 3963 222c 0a20 2020 2022 786e 2d2d  rj9c",.    "xn--
-000133a0: 7365 7335 3534 6722 2c0a 2020 2020 2278  ses554g",.    "x
-000133b0: 6e2d 2d74 3630 6235 3661 222c 0a20 2020  n--t60b56a",.   
-000133c0: 2022 786e 2d2d 7463 6b77 6522 2c0a 2020   "xn--tckwe",.  
-000133d0: 2020 2278 6e2d 2d74 6971 3439 7871 796a    "xn--tiq49xqyj
-000133e0: 222c 0a20 2020 2022 786e 2d2d 756e 7570  ",.    "xn--unup
-000133f0: 3479 222c 0a20 2020 2022 786e 2d2d 7665  4y",.    "xn--ve
-00013400: 726d 6765 6e73 6265 7261 7465 722d 6374  rmgensberater-ct
-00013410: 6222 2c0a 2020 2020 2278 6e2d 2d76 6572  b",.    "xn--ver
-00013420: 6d67 656e 7362 6572 6174 756e 672d 7077  mgensberatung-pw
-00013430: 6222 2c0a 2020 2020 2278 6e2d 2d76 6871  b",.    "xn--vhq
-00013440: 7576 222c 0a20 2020 2022 786e 2d2d 7675  uv",.    "xn--vu
-00013450: 7138 3631 6222 2c0a 2020 2020 2278 6e2d  q861b",.    "xn-
-00013460: 2d77 3472 3835 656c 3866 6875 3564 6e72  -w4r85el8fhu5dnr
-00013470: 6122 2c0a 2020 2020 2278 6e2d 2d77 3472  a",.    "xn--w4r
-00013480: 7334 306c 222c 0a20 2020 2022 786e 2d2d  s40l",.    "xn--
-00013490: 7767 6268 3163 222c 0a20 2020 2022 786e  wgbh1c",.    "xn
-000134a0: 2d2d 7767 626c 3661 222c 0a20 2020 2022  --wgbl6a",.    "
-000134b0: 786e 2d2d 7868 7135 3231 6222 2c0a 2020  xn--xhq521b",.  
-000134c0: 2020 2278 6e2d 2d78 6b63 3261 6c33 6879    "xn--xkc2al3hy
-000134d0: 6532 6122 2c0a 2020 2020 2278 6e2d 2d78  e2a",.    "xn--x
-000134e0: 6b63 3264 6c33 6135 6565 3068 222c 0a20  kc2dl3a5ee0h",. 
-000134f0: 2020 2022 786e 2d2d 7939 6133 6171 222c     "xn--y9a3aq",
-00013500: 0a20 2020 2022 786e 2d2d 7966 726f 3469  .    "xn--yfro4i
-00013510: 3637 6f22 2c0a 2020 2020 2278 6e2d 2d79  67o",.    "xn--y
-00013520: 6762 6932 616d 6d78 222c 0a20 2020 2022  gbi2ammx",.    "
-00013530: 786e 2d2d 7a66 7231 3634 6222 2c0a 2020  xn--zfr164b",.  
-00013540: 2020 2278 7065 7269 6122 2c0a 2020 2020    "xperia",.    
-00013550: 2278 7878 222c 0a20 2020 2022 7879 7a22  "xxx",.    "xyz"
-00013560: 2c0a 2020 2020 2320 790a 2020 2020 2279  ,.    # y.    "y
-00013570: 6163 6874 7322 2c0a 2020 2020 2279 6168  achts",.    "yah
-00013580: 6f6f 222c 0a20 2020 2022 7961 6d61 7875  oo",.    "yamaxu
-00013590: 6e22 2c0a 2020 2020 2279 616e 6465 7822  n",.    "yandex"
-000135a0: 2c0a 2020 2020 2279 6522 2c0a 2020 2020  ,.    "ye",.    
-000135b0: 2279 6f64 6f62 6173 6869 222c 0a20 2020  "yodobashi",.   
-000135c0: 2022 796f 6761 222c 0a20 2020 2022 796f   "yoga",.    "yo
-000135d0: 6b6f 6861 6d61 222c 0a20 2020 2022 796f  kohama",.    "yo
-000135e0: 7522 2c0a 2020 2020 2279 6f75 7475 6265  u",.    "youtube
-000135f0: 222c 0a20 2020 2022 7974 222c 0a20 2020  ",.    "yt",.   
-00013600: 2022 7975 6e22 2c0a 2020 2020 2320 7a0a   "yun",.    # z.
-00013610: 2020 2020 227a 6122 2c0a 2020 2020 227a      "za",.    "z
-00013620: 6170 706f 7322 2c0a 2020 2020 227a 6172  appos",.    "zar
-00013630: 6122 2c0a 2020 2020 227a 6572 6f22 2c0a  a",.    "zero",.
-00013640: 2020 2020 227a 6970 222c 0a20 2020 2022      "zip",.    "
-00013650: 7a69 7070 6f22 2c0a 2020 2020 227a 6d22  zippo",.    "zm"
-00013660: 2c0a 2020 2020 227a 6f6e 6522 2c0a 2020  ,.    "zone",.  
-00013670: 2020 227a 7565 7269 6368 222c 0a20 2020    "zuerich",.   
-00013680: 2022 7a77 222c 0a5d 0a0a 0a63 6c61 7373   "zw",.]...class
-00013690: 2049 535f 4854 5450 5f55 524c 2856 616c   IS_HTTP_URL(Val
-000136a0: 6964 6174 6f72 293a 0a20 2020 2022 2222  idator):.    """
-000136b0: 0a20 2020 2052 656a 6563 7473 2061 2055  .    Rejects a U
-000136c0: 524c 2073 7472 696e 6720 6966 2061 6e79  RL string if any
-000136d0: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-000136e0: 6720 6973 2074 7275 653a 0a20 2020 2020  g is true:.     
-000136f0: 2020 2a20 5468 6520 7374 7269 6e67 2069    * The string i
-00013700: 7320 656d 7074 7920 6f72 204e 6f6e 650a  s empty or None.
-00013710: 2020 2020 2020 202a 2054 6865 2073 7472         * The str
-00013720: 696e 6720 7573 6573 2063 6861 7261 6374  ing uses charact
-00013730: 6572 7320 7468 6174 2061 7265 206e 6f74  ers that are not
-00013740: 2061 6c6c 6f77 6564 2069 6e20 6120 5552   allowed in a UR
-00013750: 4c0a 2020 2020 2020 202a 2054 6865 2073  L.       * The s
-00013760: 7472 696e 6720 6272 6561 6b73 2061 6e79  tring breaks any
-00013770: 206f 6620 7468 6520 4854 5450 2073 796e   of the HTTP syn
-00013780: 7461 6374 6963 2072 756c 6573 0a20 2020  tactic rules.   
-00013790: 2020 2020 2a20 5468 6520 5552 4c20 7363      * The URL sc
-000137a0: 6865 6d65 2073 7065 6369 6669 6564 2028  heme specified (
-000137b0: 6966 206f 6e65 2069 7320 7370 6563 6966  if one is specif
-000137c0: 6965 6429 2069 7320 6e6f 7420 2768 7474  ied) is not 'htt
-000137d0: 7027 206f 7220 2768 7474 7073 270a 2020  p' or 'https'.  
-000137e0: 2020 2020 202a 2054 6865 2074 6f70 2d6c       * The top-l
-000137f0: 6576 656c 2064 6f6d 6169 6e20 2869 6620  evel domain (if 
-00013800: 6120 686f 7374 206e 616d 6520 6973 2073  a host name is s
-00013810: 7065 6369 6669 6564 2920 646f 6573 206e  pecified) does n
-00013820: 6f74 2065 7869 7374 0a0a 2020 2020 4261  ot exist..    Ba
-00013830: 7365 6420 6f6e 2052 4643 2032 3631 363a  sed on RFC 2616:
-00013840: 2068 7474 703a 2f2f 7777 772e 6661 7173   http://www.faqs
-00013850: 2e6f 7267 2f72 6663 732f 7266 6332 3631  .org/rfcs/rfc261
-00013860: 362e 6874 6d6c 0a0a 2020 2020 5468 6973  6.html..    This
-00013870: 2066 756e 6374 696f 6e20 6f6e 6c79 2063   function only c
-00013880: 6865 636b 7320 7468 6520 5552 4c27 7320  hecks the URL's 
-00013890: 7379 6e74 6178 2e20 4974 2064 6f65 7320  syntax. It does 
-000138a0: 6e6f 7420 6368 6563 6b20 7468 6174 2074  not check that t
-000138b0: 6865 2055 524c 0a20 2020 2070 6f69 6e74  he URL.    point
-000138c0: 7320 746f 2061 2072 6561 6c20 646f 6375  s to a real docu
-000138d0: 6d65 6e74 2c20 666f 7220 6578 616d 706c  ment, for exampl
-000138e0: 652c 206f 7220 7468 6174 2069 7420 6f74  e, or that it ot
-000138f0: 6865 7277 6973 6520 6d61 6b65 7320 7365  herwise makes se
-00013900: 6e73 650a 2020 2020 7365 6d61 6e74 6963  nse.    semantic
-00013910: 616c 6c79 2e20 5468 6973 2066 756e 6374  ally. This funct
-00013920: 696f 6e20 646f 6573 2061 7574 6f6d 6174  ion does automat
-00013930: 6963 616c 6c79 2070 7265 7065 6e64 2027  ically prepend '
-00013940: 6874 7470 3a2f 2f27 2069 6e20 6672 6f6e  http://' in fron
-00013950: 740a 2020 2020 6f66 2061 2055 524c 2069  t.    of a URL i
-00013960: 6e20 7468 6520 6361 7365 206f 6620 616e  n the case of an
-00013970: 2061 6262 7265 7669 6174 6564 2055 524c   abbreviated URL
-00013980: 2028 652e 672e 2027 676f 6f67 6c65 2e63   (e.g. 'google.c
-00013990: 6127 292e 0a0a 2020 2020 5468 6520 6c69  a')...    The li
-000139a0: 7374 206f 6620 616c 6c6f 7765 6420 7363  st of allowed sc
-000139b0: 6865 6d65 7320 6973 2063 7573 746f 6d69  hemes is customi
-000139c0: 7a61 626c 6520 7769 7468 2074 6865 2061  zable with the a
-000139d0: 6c6c 6f77 6564 5f73 6368 656d 6573 0a20  llowed_schemes. 
-000139e0: 2020 2070 6172 616d 6574 6572 2e20 4966     parameter. If
-000139f0: 2079 6f75 2065 7863 6c75 6465 204e 6f6e   you exclude Non
-00013a00: 6520 6672 6f6d 2074 6865 206c 6973 742c  e from the list,
-00013a10: 2074 6865 6e20 6162 6272 6576 6961 7465   then abbreviate
-00013a20: 6420 5552 4c73 0a20 2020 2028 6c61 636b  d URLs.    (lack
-00013a30: 696e 6720 6120 7363 6865 6d65 2073 7563  ing a scheme suc
-00013a40: 6820 6173 2027 6874 7470 2729 2077 696c  h as 'http') wil
-00013a50: 6c20 6265 2072 656a 6563 7465 642e 0a0a  l be rejected...
-00013a60: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
-00013a70: 7072 6570 656e 6465 6420 7363 6865 6d65  prepended scheme
-00013a80: 2069 7320 6375 7374 6f6d 697a 6162 6c65   is customizable
-00013a90: 2077 6974 6820 7468 6520 7072 6570 656e   with the prepen
-00013aa0: 645f 7363 6865 6d65 0a20 2020 2070 6172  d_scheme.    par
-00013ab0: 616d 6574 6572 2e20 4966 2079 6f75 2073  ameter. If you s
-00013ac0: 6574 2070 7265 7065 6e64 5f73 6368 656d  et prepend_schem
-00013ad0: 6520 746f 204e 6f6e 6520 7468 656e 2070  e to None then p
-00013ae0: 7265 7065 6e64 696e 6720 7769 6c6c 2062  repending will b
-00013af0: 650a 2020 2020 6469 7361 626c 6564 2e20  e.    disabled. 
-00013b00: 5552 4c73 2074 6861 7420 7265 7175 6972  URLs that requir
-00013b10: 6520 7072 6570 656e 6469 6e67 2074 6f20  e prepending to 
-00013b20: 7061 7273 6520 7769 6c6c 2073 7469 6c6c  parse will still
-00013b30: 2062 6520 6163 6365 7074 6564 2c0a 2020   be accepted,.  
-00013b40: 2020 6275 7420 7468 6520 7265 7475 726e    but the return
-00013b50: 2076 616c 7565 2077 696c 6c20 6e6f 7420   value will not 
-00013b60: 6265 206d 6f64 6966 6965 642e 0a0a 2020  be modified...  
-00013b70: 2020 4061 7574 686f 723a 204a 6f6e 6174    @author: Jonat
-00013b80: 6861 6e20 4265 6e6e 0a0a 2020 2020 2020  han Benn..      
-00013b90: 2020 3e3e 3e20 4953 5f48 5454 505f 5552    >>> IS_HTTP_UR
-00013ba0: 4c28 2928 2768 7474 703a 2f2f 312e 322e  L()('http://1.2.
-00013bb0: 332e 3427 290a 2020 2020 2020 2020 2827  3.4').        ('
-00013bc0: 6874 7470 3a2f 2f31 2e32 2e33 2e34 272c  http://1.2.3.4',
-00013bd0: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
-00013be0: 3e3e 2049 535f 4854 5450 5f55 524c 2829  >> IS_HTTP_URL()
-00013bf0: 2827 6874 7470 3a2f 2f61 6263 2e63 6f6d  ('http://abc.com
-00013c00: 2729 0a20 2020 2020 2020 2028 2768 7474  ').        ('htt
-00013c10: 703a 2f2f 6162 632e 636f 6d27 2c20 4e6f  p://abc.com', No
-00013c20: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-00013c30: 4953 5f48 5454 505f 5552 4c28 2928 2768  IS_HTTP_URL()('h
-00013c40: 7474 7073 3a2f 2f61 6263 2e63 6f6d 2729  ttps://abc.com')
-00013c50: 0a20 2020 2020 2020 2028 2768 7474 7073  .        ('https
-00013c60: 3a2f 2f61 6263 2e63 6f6d 272c 204e 6f6e  ://abc.com', Non
-00013c70: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-00013c80: 535f 4854 5450 5f55 524c 2829 2827 6874  S_HTTP_URL()('ht
-00013c90: 7470 783a 2f2f 6162 632e 636f 6d27 290a  tpx://abc.com').
-00013ca0: 2020 2020 2020 2020 2827 6874 7470 783a          ('httpx:
-00013cb0: 2f2f 6162 632e 636f 6d27 2c20 2765 6e74  //abc.com', 'ent
-00013cc0: 6572 2061 2076 616c 6964 2055 524c 2729  er a valid URL')
-00013cd0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00013ce0: 4854 5450 5f55 524c 2829 2827 6874 7470  HTTP_URL()('http
-00013cf0: 3a2f 2f61 6263 2e63 6f6d 3a38 3027 290a  ://abc.com:80').
-00013d00: 2020 2020 2020 2020 2827 6874 7470 3a2f          ('http:/
-00013d10: 2f61 6263 2e63 6f6d 3a38 3027 2c20 4e6f  /abc.com:80', No
-00013d20: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-00013d30: 4953 5f48 5454 505f 5552 4c28 2928 2768  IS_HTTP_URL()('h
-00013d40: 7474 703a 2f2f 7573 6572 4061 6263 2e63  ttp://user@abc.c
-00013d50: 6f6d 2729 0a20 2020 2020 2020 2028 2768  om').        ('h
-00013d60: 7474 703a 2f2f 7573 6572 4061 6263 2e63  ttp://user@abc.c
-00013d70: 6f6d 272c 204e 6f6e 6529 0a20 2020 2020  om', None).     
-00013d80: 2020 203e 3e3e 2049 535f 4854 5450 5f55     >>> IS_HTTP_U
-00013d90: 524c 2829 2827 6874 7470 3a2f 2f75 7365  RL()('http://use
-00013da0: 7240 312e 322e 332e 3427 290a 2020 2020  r@1.2.3.4').    
-00013db0: 2020 2020 2827 6874 7470 3a2f 2f75 7365      ('http://use
-00013dc0: 7240 312e 322e 332e 3427 2c20 4e6f 6e65  r@1.2.3.4', None
-00013dd0: 290a 0a20 2020 2041 7267 733a 0a20 2020  )..    Args:.   
-00013de0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00013df0: 6765 3a20 6120 7374 7269 6e67 2c20 7468  ge: a string, th
-00013e00: 6520 6572 726f 7220 6d65 7373 6167 6520  e error message 
-00013e10: 746f 2067 6976 6520 7468 6520 656e 6420  to give the end 
-00013e20: 7573 6572 0a20 2020 2020 2020 2020 2020  user.           
-00013e30: 2069 6620 7468 6520 5552 4c20 646f 6573   if the URL does
-00013e40: 206e 6f74 2076 616c 6964 6174 650a 2020   not validate.  
-00013e50: 2020 2020 2020 616c 6c6f 7765 645f 7363        allowed_sc
-00013e60: 6865 6d65 733a 2061 206c 6973 7420 636f  hemes: a list co
-00013e70: 6e74 6169 6e69 6e67 2073 7472 696e 6773  ntaining strings
-00013e80: 206f 7220 4e6f 6e65 2e20 4561 6368 2065   or None. Each e
-00013e90: 6c65 6d65 6e74 0a20 2020 2020 2020 2020  lement.         
-00013ea0: 2020 2069 7320 6120 7363 6865 6d65 2074     is a scheme t
-00013eb0: 6865 2069 6e70 7574 7465 6420 5552 4c20  he inputted URL 
-00013ec0: 6973 2061 6c6c 6f77 6564 2074 6f20 7573  is allowed to us
-00013ed0: 650a 2020 2020 2020 2020 7072 6570 656e  e.        prepen
-00013ee0: 645f 7363 6865 6d65 3a20 6120 7374 7269  d_scheme: a stri
-00013ef0: 6e67 2c20 7468 6973 2073 6368 656d 6520  ng, this scheme 
-00013f00: 6973 2070 7265 7065 6e64 6564 2069 6620  is prepended if 
-00013f10: 6974 2773 0a20 2020 2020 2020 2020 2020  it's.           
-00013f20: 206e 6563 6573 7361 7279 2074 6f20 6d61   necessary to ma
-00013f30: 6b65 2074 6865 2055 524c 2076 616c 6964  ke the URL valid
-00013f40: 0a20 2020 2022 2222 0a0a 2020 2020 5245  .    """..    RE
-00013f50: 4745 585f 4745 4e45 5249 435f 5641 4c49  GEX_GENERIC_VALI
-00013f60: 445f 4950 203d 2072 2228 5b5c 772e 217e  D_IP = r"([\w.!~
-00013f70: 2a27 7c3b 3a26 3d2b 242c 2d5d 2b40 293f  *'|;:&=+$,-]+@)?
-00013f80: 5c64 2b5c 2e5c 642b 5c2e 5c64 2b5c 2e5c  \d+\.\d+\.\d+\.\
-00013f90: 642b 283a 5c64 2a29 2a24 220a 2020 2020  d+(:\d*)*$".    
-00013fa0: 5245 4745 585f 4745 4e45 5249 435f 5641  REGEX_GENERIC_VA
-00013fb0: 4c49 445f 444f 4d41 494e 203d 2072 2228  LID_DOMAIN = r"(
-00013fc0: 5b5c 772e 217e 2a27 7c3b 3a26 3d2b 242c  [\w.!~*'|;:&=+$,
-00013fd0: 2d5d 2b40 293f 2828 5b41 2d5a 612d 7a30  -]+@)?(([A-Za-z0
-00013fe0: 2d39 5d2b 5b41 2d5a 612d 7a30 2d39 5c2d  -9]+[A-Za-z0-9\-
-00013ff0: 5d2a 5b41 2d5a 612d 7a30 2d39 5d2b 5c2e  ]*[A-Za-z0-9]+\.
-00014000: 292a 285b 412d 5a61 2d7a 302d 395d 2b5c  )*([A-Za-z0-9]+\
-00014010: 2e29 2a29 2a28 5b41 2d5a 612d 7a5d 2b5b  .)*)*([A-Za-z]+[
-00014020: 412d 5a61 2d7a 302d 395c 2d5d 2a5b 412d  A-Za-z0-9\-]*[A-
-00014030: 5a61 2d7a 302d 395d 2b29 5c2e 3f28 3a5c  Za-z0-9]+)\.?(:\
-00014040: 642a 292a 2422 0a0a 2020 2020 6465 6620  d*)*$"..    def 
-00014050: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-00014060: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00014070: 6572 726f 725f 6d65 7373 6167 653d 2245  error_message="E
-00014080: 6e74 6572 2061 2076 616c 6964 2055 524c  nter a valid URL
-00014090: 222c 0a20 2020 2020 2020 2061 6c6c 6f77  ",.        allow
-000140a0: 6564 5f73 6368 656d 6573 3d4e 6f6e 652c  ed_schemes=None,
-000140b0: 0a20 2020 2020 2020 2070 7265 7065 6e64  .        prepend
-000140c0: 5f73 6368 656d 653d 2268 7474 7022 2c0a  _scheme="http",.
-000140d0: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
-000140e0: 746c 6473 3d4e 6f6e 652c 0a20 2020 2029  tlds=None,.    )
-000140f0: 3a0a 2020 2020 2020 2020 7365 6c66 2e65  :.        self.e
-00014100: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
-00014110: 7272 6f72 5f6d 6573 7361 6765 0a20 2020  rror_message.   
-00014120: 2020 2020 2069 6620 616c 6c6f 7765 645f       if allowed_
-00014130: 7363 6865 6d65 7320 6973 204e 6f6e 653a  schemes is None:
-00014140: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00014150: 662e 616c 6c6f 7765 645f 7363 6865 6d65  f.allowed_scheme
-00014160: 7320 3d20 6874 7470 5f73 6368 656d 6573  s = http_schemes
-00014170: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00014180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00014190: 616c 6c6f 7765 645f 7363 6865 6d65 7320  allowed_schemes 
-000141a0: 3d20 616c 6c6f 7765 645f 7363 6865 6d65  = allowed_scheme
-000141b0: 730a 2020 2020 2020 2020 6966 2061 6c6c  s.        if all
-000141c0: 6f77 6564 5f74 6c64 7320 6973 204e 6f6e  owed_tlds is Non
-000141d0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000141e0: 656c 662e 616c 6c6f 7765 645f 746c 6473  elf.allowed_tlds
-000141f0: 203d 206f 6666 6963 6961 6c5f 746f 705f   = official_top_
-00014200: 6c65 7665 6c5f 646f 6d61 696e 730a 2020  level_domains.  
-00014210: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014220: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
-00014230: 6f77 6564 5f74 6c64 7320 3d20 616c 6c6f  owed_tlds = allo
-00014240: 7765 645f 746c 6473 0a20 2020 2020 2020  wed_tlds.       
-00014250: 2073 656c 662e 7072 6570 656e 645f 7363   self.prepend_sc
-00014260: 6865 6d65 203d 2070 7265 7065 6e64 5f73  heme = prepend_s
-00014270: 6368 656d 650a 0a20 2020 2020 2020 2066  cheme..        f
-00014280: 6f72 2069 2069 6e20 7365 6c66 2e61 6c6c  or i in self.all
-00014290: 6f77 6564 5f73 6368 656d 6573 3a0a 2020  owed_schemes:.  
-000142a0: 2020 2020 2020 2020 2020 6966 2069 206e            if i n
-000142b0: 6f74 2069 6e20 6874 7470 5f73 6368 656d  ot in http_schem
-000142c0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000142d0: 2020 2020 7261 6973 6520 5379 6e74 6178      raise Syntax
-000142e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000142f0: 2020 2020 2020 2020 2020 2022 616c 6c6f             "allo
-00014300: 7765 645f 7363 6865 6d65 2076 616c 7565  wed_scheme value
-00014310: 2027 2573 2720 6973 206e 6f74 2069 6e20   '%s' is not in 
-00014320: 2573 2220 2520 2869 2c20 6874 7470 5f73  %s" % (i, http_s
-00014330: 6368 656d 6573 290a 2020 2020 2020 2020  chemes).        
-00014340: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00014350: 2020 2069 6620 7365 6c66 2e70 7265 7065     if self.prepe
-00014360: 6e64 5f73 6368 656d 6520 6e6f 7420 696e  nd_scheme not in
-00014370: 2073 656c 662e 616c 6c6f 7765 645f 7363   self.allowed_sc
-00014380: 6865 6d65 733a 0a20 2020 2020 2020 2020  hemes:.         
-00014390: 2020 2072 6169 7365 2053 796e 7461 7845     raise SyntaxE
-000143a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-000143b0: 2020 2020 2020 2270 7265 7065 6e64 5f73        "prepend_s
-000143c0: 6368 656d 653d 2725 7327 2069 7320 6e6f  cheme='%s' is no
-000143d0: 7420 696e 2061 6c6c 6f77 6564 5f73 6368  t in allowed_sch
-000143e0: 656d 6573 3d25 7322 0a20 2020 2020 2020  emes=%s".       
-000143f0: 2020 2020 2020 2020 2025 2028 7365 6c66           % (self
-00014400: 2e70 7265 7065 6e64 5f73 6368 656d 652c  .prepend_scheme,
-00014410: 2073 656c 662e 616c 6c6f 7765 645f 7363   self.allowed_sc
-00014420: 6865 6d65 7329 0a20 2020 2020 2020 2020  hemes).         
-00014430: 2020 2029 0a0a 2020 2020 6465 6620 7661     )..    def va
-00014440: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-00014450: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-00014460: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-00014470: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00014480: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00014490: 3a20 6120 7374 7269 6e67 2c20 7468 6520  : a string, the 
-000144a0: 5552 4c20 746f 2076 616c 6964 6174 650a  URL to validate.
-000144b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000144c0: 3a0a 2020 2020 2020 2020 2020 2020 6120  :.            a 
-000144d0: 7475 706c 652c 2077 6865 7265 2074 7570  tuple, where tup
-000144e0: 6c65 5b30 5d20 6973 2074 6865 2069 6e70  le[0] is the inp
-000144f0: 7574 7465 6420 7661 6c75 650a 2020 2020  utted value.    
-00014500: 2020 2020 2020 2020 2870 6f73 7369 626c          (possibl
-00014510: 6520 7072 6570 656e 6465 6420 7769 7468  e prepended with
-00014520: 2070 7265 7065 6e64 5f73 6368 656d 6529   prepend_scheme)
-00014530: 2c20 616e 6420 7475 706c 655b 315d 2069  , and tuple[1] i
-00014540: 7320 6569 7468 6572 0a20 2020 2020 2020  s either.       
-00014550: 2020 2020 204e 6f6e 6520 2873 7563 6365       None (succe
-00014560: 7373 2129 206f 7220 7468 6520 7374 7269  ss!) or the stri
-00014570: 6e67 2065 7272 6f72 5f6d 6573 7361 6765  ng error_message
-00014580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00014590: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-000145a0: 2020 2020 2020 2320 6966 2074 6865 2055        # if the U
-000145b0: 524c 2070 6173 7365 7320 6765 6e65 7269  RL passes generi
-000145c0: 6320 7661 6c69 6461 7469 6f6e 0a20 2020  c validation.   
-000145d0: 2020 2020 2020 2020 2078 203d 2049 535f           x = IS_
-000145e0: 4745 4e45 5249 435f 5552 4c28 0a20 2020  GENERIC_URL(.   
-000145f0: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00014600: 6f72 5f6d 6573 7361 6765 3d73 656c 662e  or_message=self.
-00014610: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-00014620: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00014630: 6c6c 6f77 6564 5f73 6368 656d 6573 3d73  llowed_schemes=s
-00014640: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
-00014650: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
-00014660: 2020 2020 2070 7265 7065 6e64 5f73 6368       prepend_sch
-00014670: 656d 653d 7365 6c66 2e70 7265 7065 6e64  eme=self.prepend
-00014680: 5f73 6368 656d 652c 0a20 2020 2020 2020  _scheme,.       
-00014690: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000146a0: 2020 2069 6620 7828 7661 6c75 6529 5b31     if x(value)[1
-000146b0: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
-000146c0: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-000146d0: 6e65 6e74 7320 3d20 7572 6c70 6172 7365  nents = urlparse
-000146e0: 2e75 726c 7061 7273 6528 7661 6c75 6529  .urlparse(value)
-000146f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014700: 2061 7574 686f 7269 7479 203d 2063 6f6d   authority = com
-00014710: 706f 6e65 6e74 732e 6e65 746c 6f63 0a20  ponents.netloc. 
-00014720: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00014730: 2069 6620 7468 6572 6520 6973 2061 6e20   if there is an 
-00014740: 6175 7468 6f72 6974 7920 636f 6d70 6f6e  authority compon
-00014750: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-00014760: 2020 2020 6966 2061 7574 686f 7269 7479      if authority
-00014770: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014780: 2020 2020 2020 2320 6966 2061 7574 686f        # if autho
-00014790: 7269 7479 2069 7320 6120 7661 6c69 6420  rity is a valid 
-000147a0: 4950 2061 6464 7265 7373 0a20 2020 2020  IP address.     
-000147b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000147c0: 6620 7265 2e6d 6174 6368 2873 656c 662e  f re.match(self.
-000147d0: 5245 4745 585f 4745 4e45 5249 435f 5641  REGEX_GENERIC_VA
-000147e0: 4c49 445f 4950 2c20 6175 7468 6f72 6974  LID_IP, authorit
-000147f0: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
-00014800: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-00014810: 656e 2074 6869 7320 4854 5450 2055 524c  en this HTTP URL
-00014820: 2069 7320 7661 6c69 640a 2020 2020 2020   is valid.      
-00014830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014840: 2020 7265 7475 726e 2076 616c 7565 0a20    return value. 
-00014850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014860: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00014870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014880: 2023 2065 6c73 6520 6966 2061 7574 686f   # else if autho
-00014890: 7269 7479 2069 7320 6120 7661 6c69 6420  rity is a valid 
-000148a0: 646f 6d61 696e 206e 616d 650a 2020 2020  domain name.    
-000148b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148c0: 2020 2020 646f 6d61 696e 4d61 7463 6820      domainMatch 
-000148d0: 3d20 7265 2e6d 6174 6368 280a 2020 2020  = re.match(.    
+00008f70: 6573 7361 6765 0a20 2020 2020 2020 2061  essage.        a
+00008f80: 7373 6572 7420 6d6f 6465 2069 6e20 2822  ssert mode in ("
+00008f90: 6572 726f 7222 2c20 2273 616e 6974 697a  error", "sanitiz
+00008fa0: 6522 290a 2020 2020 2020 2020 7365 6c66  e").        self
+00008fb0: 2e6d 6f64 6520 3d20 6d6f 6465 0a0a 2020  .mode = mode..  
+00008fc0: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
+00008fd0: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
+00008fe0: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
+00008ff0: 2020 2020 2073 616e 6974 697a 6564 5f76       sanitized_v
+00009000: 616c 7565 203d 2073 656c 662e 7361 6e69  alue = self.sani
+00009010: 7469 7a65 7228 7661 6c75 6529 0a20 2020  tizer(value).   
+00009020: 2020 2020 2069 6620 7361 6e69 7469 7a65       if sanitize
+00009030: 645f 7661 6c75 6520 213d 2076 616c 7565  d_value != value
+00009040: 2061 6e64 2073 656c 662e 6d6f 6465 203d   and self.mode =
+00009050: 3d20 2265 7272 6f72 223a 0a20 2020 2020  = "error":.     
+00009060: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00009070: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
+00009080: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+00009090: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
+000090a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000090b0: 2073 616e 6974 697a 6564 5f76 616c 7565   sanitized_value
+000090c0: 0a0a 2020 2020 6465 6661 756c 745f 7265  ..    default_re
+000090d0: 6765 7820 3d20 7265 2e63 6f6d 7069 6c65  gex = re.compile
+000090e0: 280a 2020 2020 2020 2020 7222 283c 5c73  (.        r"(<\s
+000090f0: 2a2f 3f28 7363 7269 7074 7c65 6d62 6564  */?(script|embed
+00009100: 7c6f 626a 6563 747c 6966 7261 6d65 7c74  |object|iframe|t
+00009110: 6578 7461 7265 617c 696e 7075 747c 6275  extarea|input|bu
+00009120: 7474 6f6e 292e 2a3e 297c 283c 5b5e 3e5d  tton).*>)|(<[^>]
+00009130: 2b20 6f6e 5c77 2b5b 5e3e 5d2b 3e29 222c  + on\w+[^>]+>)",
+00009140: 0a20 2020 2020 2020 2072 652e 4947 4e4f  .        re.IGNO
+00009150: 5245 4341 5345 207c 2072 652e 444f 5441  RECASE | re.DOTA
+00009160: 4c4c 2c0a 2020 2020 290a 0a20 2020 2040  LL,.    )..    @
+00009170: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00009180: 2064 6566 2064 6566 6175 6c74 5f73 616e   def default_san
+00009190: 6974 697a 6572 2874 6578 7429 3a0a 2020  itizer(text):.  
+000091a0: 2020 2020 2020 7265 7475 726e 2049 535f        return IS_
+000091b0: 5341 4645 2e64 6566 6175 6c74 5f72 6567  SAFE.default_reg
+000091c0: 6578 2e73 7562 2822 222c 2074 6578 7429  ex.sub("", text)
+000091d0: 0a0a 0a63 6c61 7373 2049 535f 414c 5048  ...class IS_ALPH
+000091e0: 414e 554d 4552 4943 2849 535f 4d41 5443  ANUMERIC(IS_MATC
+000091f0: 4829 3a0a 2020 2020 2222 220a 2020 2020  H):.    """.    
+00009200: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+00009210: 2055 7365 6420 6173 3a3a 0a0a 2020 2020   Used as::..    
+00009220: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+00009230: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
+00009240: 653d 276e 616d 6527 2c20 7265 7175 6972  e='name', requir
+00009250: 6573 3d49 535f 414c 5048 414e 554d 4552  es=IS_ALPHANUMER
+00009260: 4943 2829 290a 0a20 2020 2020 2020 2020  IC())..         
+00009270: 2020 203e 3e3e 2049 535f 414c 5048 414e     >>> IS_ALPHAN
+00009280: 554d 4552 4943 2829 2827 3127 290a 2020  UMERIC()('1').  
+00009290: 2020 2020 2020 2020 2020 2827 3127 2c20            ('1', 
+000092a0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+000092b0: 2020 3e3e 3e20 4953 5f41 4c50 4841 4e55    >>> IS_ALPHANU
+000092c0: 4d45 5249 4328 2928 2727 290a 2020 2020  MERIC()('').    
+000092d0: 2020 2020 2020 2020 2827 272c 204e 6f6e          ('', Non
+000092e0: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
+000092f0: 3e3e 2049 535f 414c 5048 414e 554d 4552  >> IS_ALPHANUMER
+00009300: 4943 2829 2827 415f 6127 290a 2020 2020  IC()('A_a').    
+00009310: 2020 2020 2020 2020 2827 415f 6127 2c20          ('A_a', 
+00009320: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+00009330: 2020 3e3e 3e20 4953 5f41 4c50 4841 4e55    >>> IS_ALPHANU
+00009340: 4d45 5249 4328 2928 2721 2729 0a20 2020  MERIC()('!').   
+00009350: 2020 2020 2020 2020 2028 2721 272c 2027           ('!', '
+00009360: 656e 7465 7220 6f6e 6c79 206c 6574 7465  enter only lette
+00009370: 7273 2c20 6e75 6d62 6572 732c 2061 6e64  rs, numbers, and
+00009380: 2075 6e64 6572 7363 6f72 6527 290a 2020   underscore').  
+00009390: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
+000093a0: 5f69 6e69 745f 5f28 7365 6c66 2c20 6572  _init__(self, er
+000093b0: 726f 725f 6d65 7373 6167 653d 2245 6e74  ror_message="Ent
+000093c0: 6572 206f 6e6c 7920 6c65 7474 6572 732c  er only letters,
+000093d0: 206e 756d 6265 7273 2c20 616e 6420 756e   numbers, and un
+000093e0: 6465 7273 636f 7265 2229 3a0a 2020 2020  derscore"):.    
+000093f0: 2020 2020 4953 5f4d 4154 4348 2e5f 5f69      IS_MATCH.__i
+00009400: 6e69 745f 5f28 7365 6c66 2c20 7222 5e5b  nit__(self, r"^[
+00009410: 5c77 5d2a 2422 2c20 6572 726f 725f 6d65  \w]*$", error_me
+00009420: 7373 6167 6529 0a0a 0a63 6c61 7373 2049  ssage)...class I
+00009430: 535f 454d 4149 4c28 5661 6c69 6461 746f  S_EMAIL(Validato
+00009440: 7229 3a0a 0a20 2020 2022 2222 0a20 2020  r):..    """.   
+00009450: 2043 6865 636b 7320 6966 2066 6965 6c64   Checks if field
+00009460: 2773 2076 616c 7565 2069 7320 6120 7661  's value is a va
+00009470: 6c69 6420 656d 6169 6c20 6164 6472 6573  lid email addres
+00009480: 732e 2043 616e 2062 6520 7365 7420 746f  s. Can be set to
+00009490: 2064 6973 616c 6c6f 770a 2020 2020 6f72   disallow.    or
+000094a0: 2066 6f72 6365 2061 6464 7265 7373 6573   force addresses
+000094b0: 2066 726f 6d20 6365 7274 6169 6e20 646f   from certain do
+000094c0: 6d61 696e 2873 292e 0a0a 2020 2020 456d  main(s)...    Em
+000094d0: 6169 6c20 7265 6765 7820 6164 6170 7465  ail regex adapte
+000094e0: 6420 6672 6f6d 0a20 2020 2068 7474 703a  d from.    http:
+000094f0: 2f2f 6861 6163 6b65 642e 636f 6d2f 6172  //haacked.com/ar
+00009500: 6368 6976 652f 3230 3037 2f30 382f 3231  chive/2007/08/21
+00009510: 2f69 2d6b 6e65 772d 686f 772d 746f 2d76  /i-knew-how-to-v
+00009520: 616c 6964 6174 652d 616e 2d65 6d61 696c  alidate-an-email
+00009530: 2d61 6464 7265 7373 2d75 6e74 696c 2d69  -address-until-i
+00009540: 2e61 7370 782c 0a20 2020 2067 656e 6572  .aspx,.    gener
+00009550: 616c 6c79 2066 6f6c 6c6f 7769 6e67 2074  ally following t
+00009560: 6865 2052 4643 732c 2065 7863 6570 7420  he RFCs, except 
+00009570: 7468 6174 2077 6520 6469 7361 6c6c 6f77  that we disallow
+00009580: 2071 756f 7465 6420 7374 7269 6e67 730a   quoted strings.
+00009590: 2020 2020 616e 6420 7065 726d 6974 2075      and permit u
+000095a0: 6e64 6572 7363 6f72 6573 2061 6e64 206c  nderscores and l
+000095b0: 6561 6469 6e67 206e 756d 6572 6963 7320  eading numerics 
+000095c0: 696e 2073 7562 646f 6d61 696e 206c 6162  in subdomain lab
+000095d0: 656c 730a 0a20 2020 2041 7267 733a 0a20  els..    Args:. 
+000095e0: 2020 2020 2020 2062 616e 6e65 643a 2072         banned: r
+000095f0: 6567 6578 2074 6578 7420 666f 7220 6469  egex text for di
+00009600: 7361 6c6c 6f77 6564 2061 6464 7265 7373  sallowed address
+00009610: 2064 6f6d 6169 6e73 0a20 2020 2020 2020   domains.       
+00009620: 2066 6f72 6365 643a 2072 6567 6578 2074   forced: regex t
+00009630: 6578 7420 666f 7220 7265 7175 6972 6564  ext for required
+00009640: 2061 6464 7265 7373 2064 6f6d 6169 6e73   address domains
+00009650: 0a0a 2020 2020 426f 7468 2061 7267 756d  ..    Both argum
+00009660: 656e 7473 2063 616e 2061 6c73 6f20 6265  ents can also be
+00009670: 2063 7573 746f 6d20 6f62 6a65 6374 7320   custom objects 
+00009680: 7769 7468 2061 206d 6174 6368 2876 616c  with a match(val
+00009690: 7565 2920 6d65 7468 6f64 2e0a 0a20 2020  ue) method...   
+000096a0: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+000096b0: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
+000096c0: 6420 656d 6169 6c20 6164 6472 6573 733a  d email address:
+000096d0: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
+000096e0: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
+000096f0: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
+00009700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009710: 2072 6571 7569 7265 733d 4953 5f45 4d41   requires=IS_EMA
+00009720: 494c 2829 290a 0a20 2020 2020 2020 2043  IL())..        C
+00009730: 6865 636b 2066 6f72 2076 616c 6964 2065  heck for valid e
+00009740: 6d61 696c 2061 6464 7265 7373 2074 6861  mail address tha
+00009750: 7420 6361 6e27 7420 6265 2066 726f 6d20  t can't be from 
+00009760: 6120 2e63 6f6d 2064 6f6d 6169 6e3a 3a0a  a .com domain::.
+00009770: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
+00009780: 5554 285f 7479 7065 3d27 7465 7874 272c  UT(_type='text',
+00009790: 205f 6e61 6d65 3d27 6e61 6d65 272c 0a20   _name='name',. 
+000097a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000097b0: 6571 7569 7265 733d 4953 5f45 4d41 494c  equires=IS_EMAIL
+000097c0: 2862 616e 6e65 643d 275e 2e2a 5c5c 2e63  (banned='^.*\\.c
+000097d0: 6f6d 287c 5c5c 2e2e 2a29 2427 2929 0a0a  om(|\\..*)$'))..
+000097e0: 2020 2020 2020 2020 4368 6563 6b20 666f          Check fo
+000097f0: 7220 7661 6c69 6420 656d 6169 6c20 6164  r valid email ad
+00009800: 6472 6573 7320 7468 6174 206d 7573 7420  dress that must 
+00009810: 6265 2066 726f 6d20 6120 2e65 6475 2064  be from a .edu d
+00009820: 6f6d 6169 6e3a 3a0a 0a20 2020 2020 2020  omain::..       
+00009830: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
+00009840: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
+00009850: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
+00009860: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
+00009870: 4953 5f45 4d41 494c 2866 6f72 6365 643d  IS_EMAIL(forced=
+00009880: 275e 2e2a 5c5c 2e65 6475 287c 5c5c 2e2e  '^.*\\.edu(|\\..
+00009890: 2a29 2427 2929 0a0a 2020 2020 2020 2020  *)$'))..        
+000098a0: 2020 2020 3e3e 3e20 4953 5f45 4d41 494c      >>> IS_EMAIL
+000098b0: 2829 2827 6140 622e 636f 6d27 290a 2020  ()('a@b.com').  
+000098c0: 2020 2020 2020 2020 2020 2827 6140 622e            ('a@b.
+000098d0: 636f 6d27 2c20 4e6f 6e65 290a 2020 2020  com', None).    
+000098e0: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+000098f0: 4d41 494c 2829 2827 6162 6340 6465 662e  MAIL()('abc@def.
+00009900: 636f 6d27 290a 2020 2020 2020 2020 2020  com').          
+00009910: 2020 2827 6162 6340 6465 662e 636f 6d27    ('abc@def.com'
+00009920: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00009930: 2020 2020 3e3e 3e20 4953 5f45 4d41 494c      >>> IS_EMAIL
+00009940: 2829 2827 6162 6340 3364 6566 2e63 6f6d  ()('abc@3def.com
+00009950: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00009960: 2761 6263 4033 6465 662e 636f 6d27 2c20  'abc@3def.com', 
+00009970: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+00009980: 2020 3e3e 3e20 4953 5f45 4d41 494c 2829    >>> IS_EMAIL()
+00009990: 2827 6162 6340 6465 662e 7573 2729 0a20  ('abc@def.us'). 
+000099a0: 2020 2020 2020 2020 2020 2028 2761 6263             ('abc
+000099b0: 4064 6566 2e75 7327 2c20 4e6f 6e65 290a  @def.us', None).
+000099c0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000099d0: 4953 5f45 4d41 494c 2829 2827 6162 6340  IS_EMAIL()('abc@
+000099e0: 645f 2d66 2e75 7327 290a 2020 2020 2020  d_-f.us').      
+000099f0: 2020 2020 2020 2827 6162 6340 645f 2d66        ('abc@d_-f
+00009a00: 2e75 7327 2c20 4e6f 6e65 290a 2020 2020  .us', None).    
+00009a10: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+00009a20: 4d41 494c 2829 2827 4064 6566 2e63 6f6d  MAIL()('@def.com
+00009a30: 2729 2020 2020 2020 2020 2020 2023 206d  ')           # m
+00009a40: 6973 7369 6e67 206e 616d 650a 2020 2020  issing name.    
+00009a50: 2020 2020 2020 2020 2827 4064 6566 2e63          ('@def.c
+00009a60: 6f6d 272c 2027 656e 7465 7220 6120 7661  om', 'enter a va
+00009a70: 6c69 6420 656d 6169 6c20 6164 6472 6573  lid email addres
+00009a80: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
+00009a90: 3e3e 3e20 4953 5f45 4d41 494c 2829 2827  >>> IS_EMAIL()('
+00009aa0: 2261 6263 4064 6566 222e 636f 6d27 2920  "abc@def".com') 
+00009ab0: 2020 2020 2023 2071 756f 7465 6420 6e61       # quoted na
+00009ac0: 6d65 0a20 2020 2020 2020 2020 2020 2028  me.            (
+00009ad0: 2722 6162 6340 6465 6622 2e63 6f6d 272c  '"abc@def".com',
+00009ae0: 2027 656e 7465 7220 6120 7661 6c69 6420   'enter a valid 
+00009af0: 656d 6169 6c20 6164 6472 6573 7327 290a  email address').
+00009b00: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00009b10: 4953 5f45 4d41 494c 2829 2827 6162 632b  IS_EMAIL()('abc+
+00009b20: 6465 662e 636f 6d27 2920 2020 2020 2020  def.com')       
+00009b30: 2023 206e 6f20 400a 2020 2020 2020 2020   # no @.        
+00009b40: 2020 2020 2827 6162 632b 6465 662e 636f      ('abc+def.co
+00009b50: 6d27 2c20 2765 6e74 6572 2061 2076 616c  m', 'enter a val
+00009b60: 6964 2065 6d61 696c 2061 6464 7265 7373  id email address
+00009b70: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
+00009b80: 3e3e 2049 535f 454d 4149 4c28 2928 2761  >> IS_EMAIL()('a
+00009b90: 6263 4064 6566 2e78 2729 2020 2020 2020  bc@def.x')      
+00009ba0: 2020 2020 2320 6f6e 652d 6368 6172 2054      # one-char T
+00009bb0: 4c44 0a20 2020 2020 2020 2020 2020 2028  LD.            (
+00009bc0: 2761 6263 4064 6566 2e78 272c 2027 656e  'abc@def.x', 'en
+00009bd0: 7465 7220 6120 7661 6c69 6420 656d 6169  ter a valid emai
+00009be0: 6c20 6164 6472 6573 7327 290a 2020 2020  l address').    
+00009bf0: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+00009c00: 4d41 494c 2829 2827 6162 6340 6465 662e  MAIL()('abc@def.
+00009c10: 3132 2729 2020 2020 2020 2020 2023 206e  12')         # n
+00009c20: 756d 6572 6963 2054 4c44 0a20 2020 2020  umeric TLD.     
+00009c30: 2020 2020 2020 2028 2761 6263 4064 6566         ('abc@def
+00009c40: 2e31 3227 2c20 2765 6e74 6572 2061 2076  .12', 'enter a v
+00009c50: 616c 6964 2065 6d61 696c 2061 6464 7265  alid email addre
+00009c60: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
+00009c70: 203e 3e3e 2049 535f 454d 4149 4c28 2928   >>> IS_EMAIL()(
+00009c80: 2761 6263 4064 6566 2e2e 636f 6d27 2920  'abc@def..com') 
+00009c90: 2020 2020 2020 2320 646f 7562 6c65 2d64        # double-d
+00009ca0: 6f74 2069 6e20 646f 6d61 696e 0a20 2020  ot in domain.   
+00009cb0: 2020 2020 2020 2020 2028 2761 6263 4064           ('abc@d
+00009cc0: 6566 2e2e 636f 6d27 2c20 2765 6e74 6572  ef..com', 'enter
+00009cd0: 2061 2076 616c 6964 2065 6d61 696c 2061   a valid email a
+00009ce0: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
+00009cf0: 2020 2020 203e 3e3e 2049 535f 454d 4149       >>> IS_EMAI
+00009d00: 4c28 2928 2761 6263 402e 6465 662e 636f  L()('abc@.def.co
+00009d10: 6d27 2920 2020 2020 2020 2320 646f 7420  m')       # dot 
+00009d20: 7374 6172 7473 2064 6f6d 6169 6e0a 2020  starts domain.  
+00009d30: 2020 2020 2020 2020 2020 2827 6162 6340            ('abc@
+00009d40: 2e64 6566 2e63 6f6d 272c 2027 656e 7465  .def.com', 'ente
+00009d50: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
+00009d60: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00009d70: 2020 2020 2020 3e3e 3e20 4953 5f45 4d41        >>> IS_EMA
+00009d80: 494c 2829 2827 6162 6340 6465 662e 635f  IL()('abc@def.c_
+00009d90: 6d27 2920 2020 2020 2020 2023 2075 6e64  m')        # und
+00009da0: 6572 7363 6f72 6520 696e 2054 4c44 0a20  erscore in TLD. 
+00009db0: 2020 2020 2020 2020 2020 2028 2761 6263             ('abc
+00009dc0: 4064 6566 2e63 5f6d 272c 2027 656e 7465  @def.c_m', 'ente
+00009dd0: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
+00009de0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00009df0: 2020 2020 2020 3e3e 3e20 4953 5f45 4d41        >>> IS_EMA
+00009e00: 494c 2829 2827 4e6f 7441 6e45 6d61 696c  IL()('NotAnEmail
+00009e10: 2729 2020 2020 2020 2020 2023 206d 6973  ')         # mis
+00009e20: 7369 6e67 2040 0a20 2020 2020 2020 2020  sing @.         
+00009e30: 2020 2028 274e 6f74 416e 456d 6169 6c27     ('NotAnEmail'
+00009e40: 2c20 2765 6e74 6572 2061 2076 616c 6964  , 'enter a valid
+00009e50: 2065 6d61 696c 2061 6464 7265 7373 2729   email address')
+00009e60: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00009e70: 2049 535f 454d 4149 4c28 2928 2761 6263   IS_EMAIL()('abc
+00009e80: 404e 6f74 416e 456d 6169 6c27 2920 2020  @NotAnEmail')   
+00009e90: 2020 2320 6d69 7373 696e 6720 544c 440a    # missing TLD.
+00009ea0: 2020 2020 2020 2020 2020 2020 2827 6162              ('ab
+00009eb0: 6340 4e6f 7441 6e45 6d61 696c 272c 2027  c@NotAnEmail', '
+00009ec0: 656e 7465 7220 6120 7661 6c69 6420 656d  enter a valid em
+00009ed0: 6169 6c20 6164 6472 6573 7327 290a 2020  ail address').  
+00009ee0: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+00009ef0: 5f45 4d41 494c 2829 2827 6375 7374 6f6d  _EMAIL()('custom
+00009f00: 6572 2f64 6570 6172 746d 656e 7440 6578  er/department@ex
+00009f10: 616d 706c 652e 636f 6d27 290a 2020 2020  ample.com').    
+00009f20: 2020 2020 2020 2020 2827 6375 7374 6f6d          ('custom
+00009f30: 6572 2f64 6570 6172 746d 656e 7440 6578  er/department@ex
+00009f40: 616d 706c 652e 636f 6d27 2c20 4e6f 6e65  ample.com', None
+00009f50: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00009f60: 3e20 4953 5f45 4d41 494c 2829 2827 2441  > IS_EMAIL()('$A
+00009f70: 3132 3334 3540 6578 616d 706c 652e 636f  12345@example.co
+00009f80: 6d27 290a 2020 2020 2020 2020 2020 2020  m').            
+00009f90: 2827 2441 3132 3334 3540 6578 616d 706c  ('$A12345@exampl
+00009fa0: 652e 636f 6d27 2c20 4e6f 6e65 290a 2020  e.com', None).  
+00009fb0: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+00009fc0: 5f45 4d41 494c 2829 2827 2164 6566 2178  _EMAIL()('!def!x
+00009fd0: 797a 2561 6263 4065 7861 6d70 6c65 2e63  yz%abc@example.c
+00009fe0: 6f6d 2729 0a20 2020 2020 2020 2020 2020  om').           
+00009ff0: 2028 2721 6465 6621 7879 7a25 6162 6340   ('!def!xyz%abc@
+0000a000: 6578 616d 706c 652e 636f 6d27 2c20 4e6f  example.com', No
+0000a010: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+0000a020: 3e3e 3e20 4953 5f45 4d41 494c 2829 2827  >>> IS_EMAIL()('
+0000a030: 5f59 6f73 656d 6974 652e 5361 6d40 6578  _Yosemite.Sam@ex
+0000a040: 616d 706c 652e 636f 6d27 290a 2020 2020  ample.com').    
+0000a050: 2020 2020 2020 2020 2827 5f59 6f73 656d          ('_Yosem
+0000a060: 6974 652e 5361 6d40 6578 616d 706c 652e  ite.Sam@example.
+0000a070: 636f 6d27 2c20 4e6f 6e65 290a 2020 2020  com', None).    
+0000a080: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+0000a090: 4d41 494c 2829 2827 7e40 6578 616d 706c  MAIL()('~@exampl
+0000a0a0: 652e 636f 6d27 290a 2020 2020 2020 2020  e.com').        
+0000a0b0: 2020 2020 2827 7e40 6578 616d 706c 652e      ('~@example.
+0000a0c0: 636f 6d27 2c20 4e6f 6e65 290a 2020 2020  com', None).    
+0000a0d0: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+0000a0e0: 4d41 494c 2829 2827 2e77 6f6f 6c79 4065  MAIL()('.wooly@e
+0000a0f0: 7861 6d70 6c65 2e63 6f6d 2729 2020 2020  xample.com')    
+0000a100: 2020 2023 2064 6f74 2073 7461 7274 7320     # dot starts 
+0000a110: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+0000a120: 2028 272e 776f 6f6c 7940 6578 616d 706c   ('.wooly@exampl
+0000a130: 652e 636f 6d27 2c20 2765 6e74 6572 2061  e.com', 'enter a
+0000a140: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
+0000a150: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
+0000a160: 2020 203e 3e3e 2049 535f 454d 4149 4c28     >>> IS_EMAIL(
+0000a170: 2928 2777 6f2e 2e6f 6c79 4065 7861 6d70  )('wo..oly@examp
+0000a180: 6c65 2e63 6f6d 2729 2020 2020 2020 2320  le.com')      # 
+0000a190: 6164 6a61 6365 6e74 2064 6f74 7320 696e  adjacent dots in
+0000a1a0: 206e 616d 650a 2020 2020 2020 2020 2020   name.          
+0000a1b0: 2020 2827 776f 2e2e 6f6c 7940 6578 616d    ('wo..oly@exam
+0000a1c0: 706c 652e 636f 6d27 2c20 2765 6e74 6572  ple.com', 'enter
+0000a1d0: 2061 2076 616c 6964 2065 6d61 696c 2061   a valid email a
+0000a1e0: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
+0000a1f0: 2020 2020 203e 3e3e 2049 535f 454d 4149       >>> IS_EMAI
+0000a200: 4c28 2928 2770 6f6f 7469 6574 616e 672e  L()('pootietang.
+0000a210: 4065 7861 6d70 6c65 2e63 6f6d 2729 2020  @example.com')  
+0000a220: 2320 646f 7420 656e 6473 206e 616d 650a  # dot ends name.
+0000a230: 2020 2020 2020 2020 2020 2020 2827 706f              ('po
+0000a240: 6f74 6965 7461 6e67 2e40 6578 616d 706c  otietang.@exampl
+0000a250: 652e 636f 6d27 2c20 2765 6e74 6572 2061  e.com', 'enter a
+0000a260: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
+0000a270: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
+0000a280: 2020 203e 3e3e 2049 535f 454d 4149 4c28     >>> IS_EMAIL(
+0000a290: 2928 272e 4065 7861 6d70 6c65 2e63 6f6d  )('.@example.com
+0000a2a0: 2729 2020 2020 2020 2020 2020 2020 2320  ')            # 
+0000a2b0: 6e61 6d65 2069 7320 6261 7265 2064 6f74  name is bare dot
+0000a2c0: 0a20 2020 2020 2020 2020 2020 2028 272e  .            ('.
+0000a2d0: 4065 7861 6d70 6c65 2e63 6f6d 272c 2027  @example.com', '
+0000a2e0: 656e 7465 7220 6120 7661 6c69 6420 656d  enter a valid em
+0000a2f0: 6169 6c20 6164 6472 6573 7327 290a 2020  ail address').  
+0000a300: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+0000a310: 5f45 4d41 494c 2829 2827 496d 612e 466f  _EMAIL()('Ima.Fo
+0000a320: 6f6c 4065 7861 6d70 6c65 2e63 6f6d 2729  ol@example.com')
+0000a330: 0a20 2020 2020 2020 2020 2020 2028 2749  .            ('I
+0000a340: 6d61 2e46 6f6f 6c40 6578 616d 706c 652e  ma.Fool@example.
+0000a350: 636f 6d27 2c20 4e6f 6e65 290a 2020 2020  com', None).    
+0000a360: 2020 2020 2020 2020 3e3e 3e20 4953 5f45          >>> IS_E
+0000a370: 4d41 494c 2829 2827 496d 6120 466f 6f6c  MAIL()('Ima Fool
+0000a380: 4065 7861 6d70 6c65 2e63 6f6d 2729 2020  @example.com')  
+0000a390: 2020 2023 2073 7061 6365 2069 6e20 6e61     # space in na
+0000a3a0: 6d65 0a20 2020 2020 2020 2020 2020 2028  me.            (
+0000a3b0: 2749 6d61 2046 6f6f 6c40 6578 616d 706c  'Ima Fool@exampl
+0000a3c0: 652e 636f 6d27 2c20 2765 6e74 6572 2061  e.com', 'enter a
+0000a3d0: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
+0000a3e0: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
+0000a3f0: 2020 203e 3e3e 2049 535f 454d 4149 4c28     >>> IS_EMAIL(
+0000a400: 2928 276c 6f63 616c 6775 7940 6c6f 6361  )('localguy@loca
+0000a410: 6c68 6f73 7427 2920 2020 2020 2020 2320  lhost')       # 
+0000a420: 6c6f 6361 6c68 6f73 7420 6173 2064 6f6d  localhost as dom
+0000a430: 6169 6e0a 2020 2020 2020 2020 2020 2020  ain.            
+0000a440: 2827 6c6f 6361 6c67 7579 406c 6f63 616c  ('localguy@local
+0000a450: 686f 7374 272c 204e 6f6e 6529 0a0a 2020  host', None)..  
+0000a460: 2020 2222 220a 0a20 2020 2023 204e 4f54    """..    # NOT
+0000a470: 453a 2075 7365 2074 6865 7365 2077 6974  E: use these wit
+0000a480: 6820 666c 6167 7320 3d20 7265 2e56 4552  h flags = re.VER
+0000a490: 424f 5345 207c 2072 652e 4947 4e4f 5245  BOSE | re.IGNORE
+0000a4a0: 4341 5345 0a20 2020 2052 4547 4558 5f42  CASE.    REGEX_B
+0000a4b0: 4f44 5920 3d20 7222 2222 0a20 2020 2020  ODY = r""".     
+0000a4c0: 2020 205e 283f 215c 2e29 2020 2020 2020     ^(?!\.)      
+0000a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a4e0: 2020 2020 2023 206e 616d 6520 6d61 7920       # name may 
+0000a4f0: 6e6f 7420 6265 6769 6e20 7769 7468 2061  not begin with a
+0000a500: 2064 6f74 0a20 2020 2020 2020 2028 0a20   dot.        (. 
+0000a510: 2020 2020 2020 2020 205b 2d61 2d7a 302d           [-a-z0-
+0000a520: 3921 5c23 2425 2627 2a2b 2f3d 3f5e 5f60  9!\#$%&'*+/=?^_`
+0000a530: 7b7c 7d7e 5d20 2020 2023 2061 6c6c 206c  {|}~]    # all l
+0000a540: 6567 616c 2063 6861 7261 6374 6572 7320  egal characters 
+0000a550: 6578 6365 7074 2064 6f74 0a20 2020 2020  except dot.     
+0000a560: 2020 2020 207c 0a20 2020 2020 2020 2020       |.         
+0000a570: 2028 3f3c 215c 2e29 5c2e 2020 2020 2020   (?<!\.)\.      
+0000a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a590: 2023 2073 696e 676c 6520 646f 7473 206f   # single dots o
+0000a5a0: 6e6c 790a 2020 2020 2020 2020 292b 0a20  nly.        )+. 
+0000a5b0: 2020 2020 2020 2028 3f3c 215c 2e29 2420         (?<!\.)$ 
+0000a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5d0: 2020 2020 2020 2020 2023 206e 616d 6520           # name 
+0000a5e0: 6d61 7920 6e6f 7420 656e 6420 7769 7468  may not end with
+0000a5f0: 2061 2064 6f74 0a20 2020 2022 2222 0a20   a dot.    """. 
+0000a600: 2020 2052 4547 4558 5f44 4f4d 4149 4e20     REGEX_DOMAIN 
+0000a610: 3d20 7222 2222 0a20 2020 2020 2020 2028  = r""".        (
+0000a620: 0a20 2020 2020 2020 2020 206c 6f63 616c  .          local
+0000a630: 686f 7374 0a20 2020 2020 2020 2020 207c  host.          |
+0000a640: 0a20 2020 2020 2020 2020 2028 0a20 2020  .          (.   
+0000a650: 2020 2020 2020 2020 205b 612d 7a30 2d39           [a-z0-9
+0000a660: 5d20 2020 2020 2023 205b 7375 625d 646f  ]      # [sub]do
+0000a670: 6d61 696e 2062 6567 696e 7320 7769 7468  main begins with
+0000a680: 2061 6c70 6861 6e75 6d65 7269 630a 2020   alphanumeric.  
+0000a690: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
+0000a6a0: 2020 2020 2020 2020 2020 5b2d 5c77 5d2a            [-\w]*
+0000a6b0: 2020 2020 2020 2320 616c 7068 616e 756d        # alphanum
+0000a6c0: 6572 6963 2c20 756e 6465 7273 636f 7265  eric, underscore
+0000a6d0: 2c20 646f 742c 2068 7970 6865 6e0a 2020  , dot, hyphen.  
+0000a6e0: 2020 2020 2020 2020 2020 2020 5b61 2d7a              [a-z
+0000a6f0: 302d 395d 2020 2020 2320 656e 6469 6e67  0-9]    # ending
+0000a700: 2061 6c70 6861 6e75 6d65 7269 630a 2020   alphanumeric.  
+0000a710: 2020 2020 2020 2020 2020 293f 0a20 2020            )?.   
+0000a720: 2020 2020 2020 205c 2e20 2020 2020 2020         \.       
+0000a730: 2020 2020 2020 2023 2065 6e64 696e 6720         # ending 
+0000a740: 646f 740a 2020 2020 2020 2020 2020 292b  dot.          )+
+0000a750: 0a20 2020 2020 2020 2020 205b 612d 7a5d  .          [a-z]
+0000a760: 7b32 2c7d 2020 2020 2020 2023 2054 4c44  {2,}       # TLD
+0000a770: 2061 6c70 6861 2d6f 6e6c 790a 2020 2020   alpha-only.    
+0000a780: 2020 2029 240a 2020 2020 2222 220a 2020     )$.    """.  
+0000a790: 2020 2320 7265 6765 785f 7072 6f70 6f73    # regex_propos
+0000a7a0: 6564 5f62 7574 5f66 6169 6c65 6420 3d20  ed_but_failed = 
+0000a7b0: 7265 2e63 6f6d 7069 6c65 2872 275e 285b  re.compile(r'^([
+0000a7c0: 5c77 5c21 5c23 245c 255c 265c 275c 2a5c  \w\!\#$\%\&\'\*\
+0000a7d0: 2b5c 2d5c 2f5c 3d5c 3f5c 5e5c 607b 5c7c  +\-\/\=\?\^\`{\|
+0000a7e0: 5c7d 5c7e 5d2b 5c2e 292a 5b5c 775c 215c  \}\~]+\.)*[\w\!\
+0000a7f0: 2324 5c25 5c26 5c27 5c2a 5c2b 5c2d 5c2f  #$\%\&\'\*\+\-\/
+0000a800: 5c3d 5c3f 5c5e 5c60 7b5c 7c5c 7d5c 7e5d  \=\?\^\`{\|\}\~]
+0000a810: 2b40 2828 2828 285b 612d 7a30 2d39 5d7b  +@((((([a-z0-9]{
+0000a820: 317d 5b61 2d7a 302d 395c 2d5d 7b30 2c36  1}[a-z0-9\-]{0,6
+0000a830: 327d 5b61 2d7a 302d 395d 7b31 7d29 7c5b  2}[a-z0-9]{1})|[
+0000a840: 612d 7a5d 295c 2e29 2b5b 612d 7a5d 7b32  a-z])\.)+[a-z]{2
+0000a850: 2c36 7d29 7c28 5c64 7b31 2c33 7d5c 2e29  ,6})|(\d{1,3}\.)
+0000a860: 7b33 7d5c 647b 312c 337d 285c 3a5c 647b  {3}\d{1,3}(\:\d{
+0000a870: 312c 357d 293f 2924 272c 2072 652e 5645  1,5})?)$', re.VE
+0000a880: 5242 4f53 4520 7c20 7265 2e49 474e 4f52  RBOSE | re.IGNOR
+0000a890: 4543 4153 4529 0a0a 2020 2020 6465 6620  ECASE)..    def 
+0000a8a0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
+0000a8b0: 2020 7365 6c66 2c20 6261 6e6e 6564 3d4e    self, banned=N
+0000a8c0: 6f6e 652c 2066 6f72 6365 643d 4e6f 6e65  one, forced=None
+0000a8d0: 2c20 6572 726f 725f 6d65 7373 6167 653d  , error_message=
+0000a8e0: 2245 6e74 6572 2061 2076 616c 6964 2065  "Enter a valid e
+0000a8f0: 6d61 696c 2061 6464 7265 7373 220a 2020  mail address".  
+0000a900: 2020 293a 0a20 2020 2020 2020 2069 6620    ):.        if 
+0000a910: 6973 696e 7374 616e 6365 2862 616e 6e65  isinstance(banne
+0000a920: 642c 2073 7472 293a 0a20 2020 2020 2020  d, str):.       
+0000a930: 2020 2020 2062 616e 6e65 6420 3d20 7265       banned = re
+0000a940: 2e63 6f6d 7069 6c65 2862 616e 6e65 6429  .compile(banned)
+0000a950: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0000a960: 7374 616e 6365 2866 6f72 6365 642c 2073  stance(forced, s
+0000a970: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+0000a980: 2066 6f72 6365 6420 3d20 7265 2e63 6f6d   forced = re.com
+0000a990: 7069 6c65 2866 6f72 6365 6429 0a20 2020  pile(forced).   
+0000a9a0: 2020 2020 2073 656c 662e 6261 6e6e 6564       self.banned
+0000a9b0: 203d 2062 616e 6e65 640a 2020 2020 2020   = banned.      
+0000a9c0: 2020 7365 6c66 2e66 6f72 6365 6420 3d20    self.forced = 
+0000a9d0: 666f 7263 6564 0a20 2020 2020 2020 2073  forced.        s
+0000a9e0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
+0000a9f0: 6520 3d20 6572 726f 725f 6d65 7373 6167  e = error_messag
+0000aa00: 650a 0a20 2020 2064 6566 2076 616c 6964  e..    def valid
+0000aa10: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+0000aa20: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+0000aa30: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
+0000aa40: 2020 2020 2020 2020 2020 206e 6f74 2028             not (
+0000aa50: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0000aa60: 2c20 2862 6173 6573 7472 696e 672c 2075  , (basestring, u
+0000aa70: 6e69 636f 6465 5429 2929 0a20 2020 2020  nicodeT))).     
+0000aa80: 2020 2020 2020 206f 7220 6e6f 7420 7661         or not va
+0000aa90: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+0000aaa0: 6f72 2022 4022 206e 6f74 2069 6e20 7661  or "@" not in va
+0000aab0: 6c75 650a 2020 2020 2020 2020 293a 0a20  lue.        ):. 
+0000aac0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000aad0: 2056 616c 6964 6174 696f 6e45 7272 6f72   ValidationError
+0000aae0: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
+0000aaf0: 2873 656c 662e 6572 726f 725f 6d65 7373  (self.error_mess
+0000ab00: 6167 6529 290a 0a20 2020 2020 2020 2062  age))..        b
+0000ab10: 6f64 792c 2064 6f6d 6169 6e20 3d20 7661  ody, domain = va
+0000ab20: 6c75 652e 7273 706c 6974 2822 4022 2c20  lue.rsplit("@", 
+0000ab30: 3129 0a0a 2020 2020 2020 2020 7472 793a  1)..        try:
+0000ab40: 0a20 2020 2020 2020 2020 2020 2072 6567  .            reg
+0000ab50: 6578 5f66 6c61 6773 203d 2072 652e 5645  ex_flags = re.VE
+0000ab60: 5242 4f53 4520 7c20 7265 2e49 474e 4f52  RBOSE | re.IGNOR
+0000ab70: 4543 4153 450a 2020 2020 2020 2020 2020  ECASE.          
+0000ab80: 2020 6d61 7463 685f 626f 6479 203d 2072    match_body = r
+0000ab90: 652e 6d61 7463 6828 7365 6c66 2e52 4547  e.match(self.REG
+0000aba0: 4558 5f42 4f44 592c 2062 6f64 792c 2072  EX_BODY, body, r
+0000abb0: 6567 6578 5f66 6c61 6773 290a 2020 2020  egex_flags).    
+0000abc0: 2020 2020 2020 2020 6d61 7463 685f 646f          match_do
+0000abd0: 6d61 696e 203d 2072 652e 6d61 7463 6828  main = re.match(
+0000abe0: 7365 6c66 2e52 4547 4558 5f44 4f4d 4149  self.REGEX_DOMAI
+0000abf0: 4e2c 2064 6f6d 6169 6e2c 2072 6567 6578  N, domain, regex
+0000ac00: 5f66 6c61 6773 290a 0a20 2020 2020 2020  _flags)..       
+0000ac10: 2020 2020 2069 6620 6e6f 7420 6d61 7463       if not matc
+0000ac20: 685f 646f 6d61 696e 3a0a 2020 2020 2020  h_domain:.      
+0000ac30: 2020 2020 2020 2020 2020 2320 6368 6563            # chec
+0000ac40: 6b20 666f 7220 496e 7465 726e 6174 696f  k for Internatio
+0000ac50: 6e61 6c69 7a65 6420 446f 6d61 696e 204e  nalized Domain N
+0000ac60: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
+0000ac70: 2020 2020 2023 2073 6565 2068 7474 7073       # see https
+0000ac80: 3a2f 2f64 6f63 732e 7079 7468 6f6e 2e6f  ://docs.python.o
+0000ac90: 7267 2f32 2f6c 6962 7261 7279 2f63 6f64  rg/2/library/cod
+0000aca0: 6563 732e 6874 6d6c 236d 6f64 756c 652d  ecs.html#module-
+0000acb0: 656e 636f 6469 6e67 732e 6964 6e61 0a20  encodings.idna. 
+0000acc0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000acd0: 6f6d 6169 6e5f 656e 636f 6465 6420 3d20  omain_encoded = 
+0000ace0: 746f 5f75 6e69 636f 6465 2864 6f6d 6169  to_unicode(domai
+0000acf0: 6e29 2e65 6e63 6f64 6528 2269 646e 6122  n).encode("idna"
+0000ad00: 292e 6465 636f 6465 2822 6173 6369 6922  ).decode("ascii"
+0000ad10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000ad20: 2020 6d61 7463 685f 646f 6d61 696e 203d    match_domain =
+0000ad30: 2072 652e 6d61 7463 6828 7365 6c66 2e52   re.match(self.R
+0000ad40: 4547 4558 5f44 4f4d 4149 4e2c 2064 6f6d  EGEX_DOMAIN, dom
+0000ad50: 6169 6e5f 656e 636f 6465 642c 2072 6567  ain_encoded, reg
+0000ad60: 6578 5f66 6c61 6773 290a 0a20 2020 2020  ex_flags)..     
+0000ad70: 2020 2020 2020 206d 6174 6368 203d 2028         match = (
+0000ad80: 6d61 7463 685f 626f 6479 2069 7320 6e6f  match_body is no
+0000ad90: 7420 4e6f 6e65 2920 616e 6420 286d 6174  t None) and (mat
+0000ada0: 6368 5f64 6f6d 6169 6e20 6973 206e 6f74  ch_domain is not
+0000adb0: 204e 6f6e 6529 0a20 2020 2020 2020 2065   None).        e
+0000adc0: 7863 6570 7420 2854 7970 6545 7272 6f72  xcept (TypeError
+0000add0: 2c20 556e 6963 6f64 6545 7272 6f72 293a  , UnicodeError):
+0000ade0: 0a20 2020 2020 2020 2020 2020 2023 2056  .            # V
+0000adf0: 616c 7565 206d 6179 206e 6f74 2062 6520  alue may not be 
+0000ae00: 6120 7374 7269 6e67 2077 6865 7265 2077  a string where w
+0000ae10: 6520 6361 6e20 6c6f 6f6b 2066 6f72 206d  e can look for m
+0000ae20: 6174 6368 6573 2e0a 2020 2020 2020 2020  atches..        
+0000ae30: 2020 2020 2320 4578 616d 706c 653a 2077      # Example: w
+0000ae40: 6527 7265 2063 616c 6c69 6e67 2041 4e59  e're calling ANY
+0000ae50: 5f4f 4620 666f 726d 6174 7465 7220 616e  _OF formatter an
+0000ae60: 6420 4953 5f45 4d41 494c 2069 7320 6173  d IS_EMAIL is as
+0000ae70: 6b65 6420 746f 2076 616c 6964 6174 6520  ked to validate 
+0000ae80: 6120 6461 7465 2e0a 2020 2020 2020 2020  a date..        
+0000ae90: 2020 2020 6d61 7463 6820 3d20 4e6f 6e65      match = None
+0000aea0: 0a20 2020 2020 2020 2069 6620 6d61 7463  .        if matc
+0000aeb0: 683a 0a20 2020 2020 2020 2020 2020 2069  h:.            i
+0000aec0: 6620 286e 6f74 2073 656c 662e 6261 6e6e  f (not self.bann
+0000aed0: 6564 206f 7220 6e6f 7420 7365 6c66 2e62  ed or not self.b
+0000aee0: 616e 6e65 642e 6d61 7463 6828 646f 6d61  anned.match(doma
+0000aef0: 696e 2929 2061 6e64 2028 0a20 2020 2020  in)) and (.     
+0000af00: 2020 2020 2020 2020 2020 206e 6f74 2073             not s
+0000af10: 656c 662e 666f 7263 6564 206f 7220 7365  elf.forced or se
+0000af20: 6c66 2e66 6f72 6365 642e 6d61 7463 6828  lf.forced.match(
+0000af30: 646f 6d61 696e 290a 2020 2020 2020 2020  domain).        
+0000af40: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0000af50: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+0000af60: 6c75 650a 2020 2020 2020 2020 7261 6973  lue.        rais
+0000af70: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+0000af80: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
+0000af90: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
+0000afa0: 7361 6765 2929 0a0a 0a63 6c61 7373 2049  sage))...class I
+0000afb0: 535f 4c49 5354 5f4f 465f 454d 4149 4c53  S_LIST_OF_EMAILS
+0000afc0: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
+0000afd0: 2022 2222 0a20 2020 2045 7861 6d70 6c65   """.    Example
+0000afe0: 3a0a 2020 2020 2020 2020 5573 6564 2061  :.        Used a
+0000aff0: 733a 3a0a 0a20 2020 2020 2020 2046 6965  s::..        Fie
+0000b000: 6c64 2827 656d 6169 6c73 272c 2027 6c69  ld('emails', 'li
+0000b010: 7374 3a73 7472 696e 6727 2c0a 2020 2020  st:string',.    
+0000b020: 2020 2020 2020 2020 2020 7769 6467 6574            widget
+0000b030: 3d53 514c 464f 524d 2e77 6964 6765 7473  =SQLFORM.widgets
+0000b040: 2e74 6578 742e 7769 6467 6574 2c0a 2020  .text.widget,.  
+0000b050: 2020 2020 2020 2020 2020 2020 7265 7175              requ
+0000b060: 6972 6573 3d49 535f 4c49 5354 5f4f 465f  ires=IS_LIST_OF_
+0000b070: 454d 4149 4c53 2829 2c0a 2020 2020 2020  EMAILS(),.      
+0000b080: 2020 2020 2020 2020 7265 7072 6573 656e          represen
+0000b090: 743d 6c61 6d62 6461 2076 2c20 723a 205c  t=lambda v, r: \
+0000b0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b0b0: 2058 4d4c 2827 2c20 272e 6a6f 696e 285b   XML(', '.join([
+0000b0c0: 4128 782c 205f 6872 6566 3d27 6d61 696c  A(x, _href='mail
+0000b0d0: 746f 3a27 2b78 292e 786d 6c28 2920 666f  to:'+x).xml() fo
+0000b0e0: 7220 7820 696e 2028 7620 6f72 205b 5d29  r x in (v or [])
+0000b0f0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+0000b100: 2029 0a20 2020 2022 2222 0a0a 2020 2020   ).    """..    
+0000b110: 5245 4745 585f 4e4f 545f 454d 4149 4c5f  REGEX_NOT_EMAIL_
+0000b120: 5350 4c49 5454 4552 203d 2072 225b 5e2c  SPLITTER = r"[^,
+0000b130: 3b5c 735d 2b22 0a0a 2020 2020 6465 6620  ;\s]+"..    def 
+0000b140: 5f5f 696e 6974 5f5f 2873 656c 662c 2065  __init__(self, e
+0000b150: 7272 6f72 5f6d 6573 7361 6765 3d22 496e  rror_message="In
+0000b160: 7661 6c69 6420 656d 6169 6c73 3a20 2573  valid emails: %s
+0000b170: 2229 3a0a 2020 2020 2020 2020 7365 6c66  "):.        self
+0000b180: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
+0000b190: 2065 7272 6f72 5f6d 6573 7361 6765 0a0a   error_message..
+0000b1a0: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+0000b1b0: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+0000b1c0: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
+0000b1d0: 2020 2020 2020 2062 6164 5f65 6d61 696c         bad_email
+0000b1e0: 7320 3d20 5b5d 0a20 2020 2020 2020 2066  s = [].        f
+0000b1f0: 203d 2049 535f 454d 4149 4c28 290a 2020   = IS_EMAIL().  
+0000b200: 2020 2020 2020 666f 7220 656d 6169 6c20        for email 
+0000b210: 696e 2072 652e 6669 6e64 616c 6c28 7365  in re.findall(se
+0000b220: 6c66 2e52 4547 4558 5f4e 4f54 5f45 4d41  lf.REGEX_NOT_EMA
+0000b230: 494c 5f53 504c 4954 5445 522c 2076 616c  IL_SPLITTER, val
+0000b240: 7565 293a 0a20 2020 2020 2020 2020 2020  ue):.           
+0000b250: 2065 7272 6f72 203d 2066 2865 6d61 696c   error = f(email
+0000b260: 295b 315d 0a20 2020 2020 2020 2020 2020  )[1].           
+0000b270: 2069 6620 6572 726f 7220 616e 6420 656d   if error and em
+0000b280: 6169 6c20 6e6f 7420 696e 2062 6164 5f65  ail not in bad_e
+0000b290: 6d61 696c 733a 0a20 2020 2020 2020 2020  mails:.         
+0000b2a0: 2020 2020 2020 2062 6164 5f65 6d61 696c         bad_email
+0000b2b0: 732e 6170 7065 6e64 2865 6d61 696c 290a  s.append(email).
+0000b2c0: 2020 2020 2020 2020 6966 2062 6164 5f65          if bad_e
+0000b2d0: 6d61 696c 733a 0a20 2020 2020 2020 2020  mails:.         
+0000b2e0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+0000b2f0: 696f 6e45 7272 6f72 280a 2020 2020 2020  ionError(.      
+0000b300: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+0000b310: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+0000b320: 7272 6f72 5f6d 6573 7361 6765 2920 2520  rror_message) % 
+0000b330: 222c 2022 2e6a 6f69 6e28 6261 645f 656d  ", ".join(bad_em
+0000b340: 6169 6c73 290a 2020 2020 2020 2020 2020  ails).          
+0000b350: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+0000b360: 726e 2076 616c 7565 0a0a 2020 2020 6465  rn value..    de
+0000b370: 6620 666f 726d 6174 7465 7228 7365 6c66  f formatter(self
+0000b380: 2c20 7661 6c75 652c 2072 6f77 3d4e 6f6e  , value, row=Non
+0000b390: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+0000b3a0: 726e 2022 2c20 222e 6a6f 696e 2876 616c  rn ", ".join(val
+0000b3b0: 7565 206f 7220 5b5d 290a 0a0a 2320 5552  ue or [])...# UR
+0000b3c0: 4c20 7363 6865 6d65 2073 6f75 7263 653a  L scheme source:
+0000b3d0: 0a23 203c 6874 7470 3a2f 2f65 6e2e 7769  .# <http://en.wi
+0000b3e0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+0000b3f0: 2f55 5249 5f73 6368 656d 653e 206f 6274  /URI_scheme> obt
+0000b400: 6169 6e65 6420 6f6e 2032 3030 382d 4e6f  ained on 2008-No
+0000b410: 762d 3130 0a0a 6f66 6669 6369 616c 5f75  v-10..official_u
+0000b420: 726c 5f73 6368 656d 6573 203d 205b 0a20  rl_schemes = [. 
+0000b430: 2020 2022 6161 6122 2c0a 2020 2020 2261     "aaa",.    "a
+0000b440: 6161 7322 2c0a 2020 2020 2261 6361 7022  aas",.    "acap"
+0000b450: 2c0a 2020 2020 2263 6170 222c 0a20 2020  ,.    "cap",.   
+0000b460: 2022 6369 6422 2c0a 2020 2020 2263 7269   "cid",.    "cri
+0000b470: 6422 2c0a 2020 2020 2264 6174 6122 2c0a  d",.    "data",.
+0000b480: 2020 2020 2264 6176 222c 0a20 2020 2022      "dav",.    "
+0000b490: 6469 6374 222c 0a20 2020 2022 646e 7322  dict",.    "dns"
+0000b4a0: 2c0a 2020 2020 2266 6178 222c 0a20 2020  ,.    "fax",.   
+0000b4b0: 2022 6669 6c65 222c 0a20 2020 2022 6674   "file",.    "ft
+0000b4c0: 7022 2c0a 2020 2020 2267 6f22 2c0a 2020  p",.    "go",.  
+0000b4d0: 2020 2267 6f70 6865 7222 2c0a 2020 2020    "gopher",.    
+0000b4e0: 2268 3332 3322 2c0a 2020 2020 2268 7474  "h323",.    "htt
+0000b4f0: 7022 2c0a 2020 2020 2268 7474 7073 222c  p",.    "https",
+0000b500: 0a20 2020 2022 6963 6170 222c 0a20 2020  .    "icap",.   
+0000b510: 2022 696d 222c 0a20 2020 2022 696d 6170   "im",.    "imap
+0000b520: 222c 0a20 2020 2022 696e 666f 222c 0a20  ",.    "info",. 
+0000b530: 2020 2022 6970 7022 2c0a 2020 2020 2269     "ipp",.    "i
+0000b540: 7269 7322 2c0a 2020 2020 2269 7269 732e  ris",.    "iris.
+0000b550: 6265 6570 222c 0a20 2020 2022 6972 6973  beep",.    "iris
+0000b560: 2e78 7063 222c 0a20 2020 2022 6972 6973  .xpc",.    "iris
+0000b570: 2e78 7063 7322 2c0a 2020 2020 2269 7269  .xpcs",.    "iri
+0000b580: 732e 6c77 7322 2c0a 2020 2020 226c 6461  s.lws",.    "lda
+0000b590: 7022 2c0a 2020 2020 226d 6169 6c74 6f22  p",.    "mailto"
+0000b5a0: 2c0a 2020 2020 226d 6964 222c 0a20 2020  ,.    "mid",.   
+0000b5b0: 2022 6d6f 6465 6d22 2c0a 2020 2020 226d   "modem",.    "m
+0000b5c0: 7372 7022 2c0a 2020 2020 226d 7372 7073  srp",.    "msrps
+0000b5d0: 222c 0a20 2020 2022 6d74 7170 222c 0a20  ",.    "mtqp",. 
+0000b5e0: 2020 2022 6d75 7064 6174 6522 2c0a 2020     "mupdate",.  
+0000b5f0: 2020 226e 6577 7322 2c0a 2020 2020 226e    "news",.    "n
+0000b600: 6673 222c 0a20 2020 2022 6e6e 7470 222c  fs",.    "nntp",
+0000b610: 0a20 2020 2022 6f70 6171 7565 6c6f 636b  .    "opaquelock
+0000b620: 746f 6b65 6e22 2c0a 2020 2020 2270 6f70  token",.    "pop
+0000b630: 222c 0a20 2020 2022 7072 6573 222c 0a20  ",.    "pres",. 
+0000b640: 2020 2022 7072 6f73 7065 726f 222c 0a20     "prospero",. 
+0000b650: 2020 2022 7274 7370 222c 0a20 2020 2022     "rtsp",.    "
+0000b660: 7365 7276 6963 6522 2c0a 2020 2020 2273  service",.    "s
+0000b670: 6874 7470 222c 0a20 2020 2022 7369 7022  http",.    "sip"
+0000b680: 2c0a 2020 2020 2273 6970 7322 2c0a 2020  ,.    "sips",.  
+0000b690: 2020 2273 6e6d 7022 2c0a 2020 2020 2273    "snmp",.    "s
+0000b6a0: 6f61 702e 6265 6570 222c 0a20 2020 2022  oap.beep",.    "
+0000b6b0: 736f 6170 2e62 6565 7073 222c 0a20 2020  soap.beeps",.   
+0000b6c0: 2022 7461 6722 2c0a 2020 2020 2274 656c   "tag",.    "tel
+0000b6d0: 222c 0a20 2020 2022 7465 6c6e 6574 222c  ",.    "telnet",
+0000b6e0: 0a20 2020 2022 7466 7470 222c 0a20 2020  .    "tftp",.   
+0000b6f0: 2022 7468 6973 6d65 7373 6167 6522 2c0a   "thismessage",.
+0000b700: 2020 2020 2274 6970 222c 0a20 2020 2022      "tip",.    "
+0000b710: 7476 222c 0a20 2020 2022 7572 6e22 2c0a  tv",.    "urn",.
+0000b720: 2020 2020 2276 656d 6d69 222c 0a20 2020      "vemmi",.   
+0000b730: 2022 7761 6973 222c 0a20 2020 2022 786d   "wais",.    "xm
+0000b740: 6c72 7063 2e62 6565 7022 2c0a 2020 2020  lrpc.beep",.    
+0000b750: 2278 6d6c 7270 632e 6265 6570 222c 0a20  "xmlrpc.beep",. 
+0000b760: 2020 2022 786d 7070 222c 0a20 2020 2022     "xmpp",.    "
+0000b770: 7a33 392e 3530 7222 2c0a 2020 2020 227a  z39.50r",.    "z
+0000b780: 3339 2e35 3073 222c 0a5d 0a75 6e6f 6666  39.50s",.].unoff
+0000b790: 6963 6961 6c5f 7572 6c5f 7363 6865 6d65  icial_url_scheme
+0000b7a0: 7320 3d20 5b0a 2020 2020 2261 626f 7574  s = [.    "about
+0000b7b0: 222c 0a20 2020 2022 6164 6975 6d78 7472  ",.    "adiumxtr
+0000b7c0: 6122 2c0a 2020 2020 2261 696d 222c 0a20  a",.    "aim",. 
+0000b7d0: 2020 2022 6166 7022 2c0a 2020 2020 2261     "afp",.    "a
+0000b7e0: 7722 2c0a 2020 2020 2263 616c 6c74 6f22  w",.    "callto"
+0000b7f0: 2c0a 2020 2020 2263 6872 6f6d 6522 2c0a  ,.    "chrome",.
+0000b800: 2020 2020 2263 7673 222c 0a20 2020 2022      "cvs",.    "
+0000b810: 6564 326b 222c 0a20 2020 2022 6665 6564  ed2k",.    "feed
+0000b820: 222c 0a20 2020 2022 6669 7368 222c 0a20  ",.    "fish",. 
+0000b830: 2020 2022 6767 222c 0a20 2020 2022 6769     "gg",.    "gi
+0000b840: 7a6d 6f70 726f 6a65 6374 222c 0a20 2020  zmoproject",.   
+0000b850: 2022 6961 7832 222c 0a20 2020 2022 6972   "iax2",.    "ir
+0000b860: 6322 2c0a 2020 2020 2269 7263 7322 2c0a  c",.    "ircs",.
+0000b870: 2020 2020 2269 746d 7322 2c0a 2020 2020      "itms",.    
+0000b880: 226a 6172 222c 0a20 2020 2022 6a61 7661  "jar",.    "java
+0000b890: 7363 7269 7074 222c 0a20 2020 2022 6b65  script",.    "ke
+0000b8a0: 7970 6172 6322 2c0a 2020 2020 226c 6173  yparc",.    "las
+0000b8b0: 7466 6d22 2c0a 2020 2020 226c 6461 7073  tfm",.    "ldaps
+0000b8c0: 222c 0a20 2020 2022 6d61 676e 6574 222c  ",.    "magnet",
+0000b8d0: 0a20 2020 2022 6d6d 7322 2c0a 2020 2020  .    "mms",.    
+0000b8e0: 226d 736e 696d 222c 0a20 2020 2022 6d76  "msnim",.    "mv
+0000b8f0: 6e22 2c0a 2020 2020 226e 6f74 6573 222c  n",.    "notes",
+0000b900: 0a20 2020 2022 6e73 6677 222c 0a20 2020  .    "nsfw",.   
+0000b910: 2022 7073 7963 222c 0a20 2020 2022 7061   "psyc",.    "pa
+0000b920: 7061 7261 7a7a 693a 6874 7470 222c 0a20  parazzi:http",. 
+0000b930: 2020 2022 726d 6922 2c0a 2020 2020 2272     "rmi",.    "r
+0000b940: 7379 6e63 222c 0a20 2020 2022 7365 636f  sync",.    "seco
+0000b950: 6e64 6c69 6665 222c 0a20 2020 2022 7367  ndlife",.    "sg
+0000b960: 6e22 2c0a 2020 2020 2273 6b79 7065 222c  n",.    "skype",
+0000b970: 0a20 2020 2022 7373 6822 2c0a 2020 2020  .    "ssh",.    
+0000b980: 2273 6674 7022 2c0a 2020 2020 2273 6d62  "sftp",.    "smb
+0000b990: 222c 0a20 2020 2022 736d 7322 2c0a 2020  ",.    "sms",.  
+0000b9a0: 2020 2273 6f6c 6461 7422 2c0a 2020 2020    "soldat",.    
+0000b9b0: 2273 7465 616d 222c 0a20 2020 2022 7376  "steam",.    "sv
+0000b9c0: 6e22 2c0a 2020 2020 2274 6561 6d73 7065  n",.    "teamspe
+0000b9d0: 616b 222c 0a20 2020 2022 756e 7265 616c  ak",.    "unreal
+0000b9e0: 222c 0a20 2020 2022 7574 3230 3034 222c  ",.    "ut2004",
+0000b9f0: 0a20 2020 2022 7665 6e74 7269 6c6f 222c  .    "ventrilo",
+0000ba00: 0a20 2020 2022 7669 6577 2d73 6f75 7263  .    "view-sourc
+0000ba10: 6522 2c0a 2020 2020 2277 6562 6361 6c22  e",.    "webcal"
+0000ba20: 2c0a 2020 2020 2277 7963 6977 7967 222c  ,.    "wyciwyg",
+0000ba30: 0a20 2020 2022 7866 6972 6522 2c0a 2020  .    "xfire",.  
+0000ba40: 2020 2278 7269 222c 0a20 2020 2022 796d    "xri",.    "ym
+0000ba50: 7367 7222 2c0a 5d0a 616c 6c5f 7572 6c5f  sgr",.].all_url_
+0000ba60: 7363 6865 6d65 7320 3d20 5b4e 6f6e 655d  schemes = [None]
+0000ba70: 202b 206f 6666 6963 6961 6c5f 7572 6c5f   + official_url_
+0000ba80: 7363 6865 6d65 7320 2b20 756e 6f66 6669  schemes + unoffi
+0000ba90: 6369 616c 5f75 726c 5f73 6368 656d 6573  cial_url_schemes
+0000baa0: 0a68 7474 705f 7363 6865 6d65 7320 3d20  .http_schemes = 
+0000bab0: 5b4e 6f6e 652c 2022 6874 7470 222c 2022  [None, "http", "
+0000bac0: 6874 7470 7322 5d0a 0a23 2044 6566 696e  https"]..# Defin
+0000bad0: 6564 2069 6e20 5246 4320 3334 3930 2c20  ed in RFC 3490, 
+0000bae0: 5365 6374 696f 6e20 332e 312c 2052 6571  Section 3.1, Req
+0000baf0: 7569 7265 6d65 6e74 2023 310a 2320 5573  uirement #1.# Us
+0000bb00: 6520 7468 6973 2072 6567 6578 2074 6f20  e this regex to 
+0000bb10: 7370 6c69 7420 7468 6520 6175 7468 6f72  split the author
+0000bb20: 6974 7920 636f 6d70 6f6e 656e 7420 6f66  ity component of
+0000bb30: 2061 2075 6e69 636f 6465 2055 524c 2069   a unicode URL i
+0000bb40: 6e74 6f0a 2320 6974 7320 636f 6d70 6f6e  nto.# its compon
+0000bb50: 656e 7420 6c61 6265 6c73 0a52 4547 4558  ent labels.REGEX
+0000bb60: 5f41 5554 484f 5249 5459 5f53 504c 4954  _AUTHORITY_SPLIT
+0000bb70: 5445 5220 3d20 225b 5c75 3030 3265 5c75  TER = "[\u002e\u
+0000bb80: 3330 3032 5c75 6666 3065 5c75 6666 3631  3002\uff0e\uff61
+0000bb90: 5d22 0a0a 0a64 6566 2065 7363 6170 655f  ]"...def escape_
+0000bba0: 756e 6963 6f64 6528 7374 7269 6e67 293a  unicode(string):
+0000bbb0: 0a20 2020 2022 2222 0a20 2020 2043 6f6e  .    """.    Con
+0000bbc0: 7665 7274 7320 6120 756e 6963 6f64 6520  verts a unicode 
+0000bbd0: 7374 7269 6e67 2069 6e74 6f20 5553 2d41  string into US-A
+0000bbe0: 5343 4949 2c20 7573 696e 6720 6120 7369  SCII, using a si
+0000bbf0: 6d70 6c65 2063 6f6e 7665 7273 696f 6e20  mple conversion 
+0000bc00: 7363 6865 6d65 2e0a 2020 2020 4561 6368  scheme..    Each
+0000bc10: 2075 6e69 636f 6465 2063 6861 7261 6374   unicode charact
+0000bc20: 6572 2074 6861 7420 646f 6573 206e 6f74  er that does not
+0000bc30: 2068 6176 6520 6120 5553 2d41 5343 4949   have a US-ASCII
+0000bc40: 2065 7175 6976 616c 656e 7420 6973 0a20   equivalent is. 
+0000bc50: 2020 2063 6f6e 7665 7274 6564 2069 6e74     converted int
+0000bc60: 6f20 6120 5552 4c20 6573 6361 7065 6420  o a URL escaped 
+0000bc70: 666f 726d 2062 6173 6564 206f 6e20 6974  form based on it
+0000bc80: 7320 6865 7861 6465 6369 6d61 6c20 7661  s hexadecimal va
+0000bc90: 6c75 652e 0a20 2020 2046 6f72 2065 7861  lue..    For exa
+0000bca0: 6d70 6c65 2c20 7468 6520 756e 6963 6f64  mple, the unicod
+0000bcb0: 6520 6368 6172 6163 7465 7220 275c 5c75  e character '\\u
+0000bcc0: 3465 3836 2720 7769 6c6c 2062 6563 6f6d  4e86' will becom
+0000bcd0: 6520 7468 6520 7374 7269 6e67 2027 2534  e the string '%4
+0000bce0: 6525 3836 270a 0a20 2020 2041 7267 733a  e%86'..    Args:
+0000bcf0: 0a20 2020 2020 2020 2073 7472 696e 673a  .        string:
+0000bd00: 2075 6e69 636f 6465 2073 7472 696e 672c   unicode string,
+0000bd10: 2074 6865 2075 6e69 636f 6465 2073 7472   the unicode str
+0000bd20: 696e 6720 746f 2063 6f6e 7665 7274 2069  ing to convert i
+0000bd30: 6e74 6f20 616e 0a20 2020 2020 2020 2020  nto an.         
+0000bd40: 2020 2065 7363 6170 6564 2055 532d 4153     escaped US-AS
+0000bd50: 4349 4920 666f 726d 0a0a 2020 2020 5265  CII form..    Re
+0000bd60: 7475 726e 733a 0a20 2020 2020 2020 2073  turns:.        s
+0000bd70: 7472 696e 673a 2074 6865 2055 532d 4153  tring: the US-AS
+0000bd80: 4349 4920 6573 6361 7065 6420 666f 726d  CII escaped form
+0000bd90: 206f 6620 7468 6520 696e 7075 7474 6564   of the inputted
+0000bda0: 2073 7472 696e 670a 0a20 2020 2040 6175   string..    @au
+0000bdb0: 7468 6f72 3a20 4a6f 6e61 7468 616e 2042  thor: Jonathan B
+0000bdc0: 656e 6e0a 2020 2020 2222 220a 2020 2020  enn.    """.    
+0000bdd0: 7265 7475 726e 5661 6c75 6520 3d20 5374  returnValue = St
+0000bde0: 7269 6e67 494f 2829 0a0a 2020 2020 666f  ringIO()..    fo
+0000bdf0: 7220 6368 6172 6163 7465 7220 696e 2073  r character in s
+0000be00: 7472 696e 673a 0a20 2020 2020 2020 2063  tring:.        c
+0000be10: 6f64 6520 3d20 6f72 6428 6368 6172 6163  ode = ord(charac
+0000be20: 7465 7229 0a20 2020 2020 2020 2069 6620  ter).        if 
+0000be30: 636f 6465 203e 2030 7837 463a 0a20 2020  code > 0x7F:.   
+0000be40: 2020 2020 2020 2020 2068 6578 436f 6465           hexCode
+0000be50: 203d 2068 6578 2863 6f64 6529 0a20 2020   = hex(code).   
+0000be60: 2020 2020 2020 2020 2072 6574 7572 6e56           returnV
+0000be70: 616c 7565 2e77 7269 7465 2822 2522 202b  alue.write("%" +
+0000be80: 2068 6578 436f 6465 5b32 3a34 5d20 2b20   hexCode[2:4] + 
+0000be90: 2225 2220 2b20 6865 7843 6f64 655b 343a  "%" + hexCode[4:
+0000bea0: 365d 290a 2020 2020 2020 2020 656c 7365  6]).        else
+0000beb0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000bec0: 7475 726e 5661 6c75 652e 7772 6974 6528  turnValue.write(
+0000bed0: 6368 6172 6163 7465 7229 0a0a 2020 2020  character)..    
+0000bee0: 7265 7475 726e 2072 6574 7572 6e56 616c  return returnVal
+0000bef0: 7565 2e67 6574 7661 6c75 6528 290a 0a0a  ue.getvalue()...
+0000bf00: 6465 6620 756e 6963 6f64 655f 746f 5f61  def unicode_to_a
+0000bf10: 7363 6969 5f61 7574 686f 7269 7479 2861  scii_authority(a
+0000bf20: 7574 686f 7269 7479 293a 0a20 2020 2022  uthority):.    "
+0000bf30: 2222 0a20 2020 2046 6f6c 6c6f 7773 2074  "".    Follows t
+0000bf40: 6865 2073 7465 7073 2069 6e20 5246 4320  he steps in RFC 
+0000bf50: 3334 3930 2c20 5365 6374 696f 6e20 3420  3490, Section 4 
+0000bf60: 746f 2063 6f6e 7665 7274 2061 2075 6e69  to convert a uni
+0000bf70: 636f 6465 2061 7574 686f 7269 7479 0a20  code authority. 
+0000bf80: 2020 2073 7472 696e 6720 696e 746f 2069     string into i
+0000bf90: 7473 2041 5343 4949 2065 7175 6976 616c  ts ASCII equival
+0000bfa0: 656e 742e 0a20 2020 2046 6f72 2065 7861  ent..    For exa
+0000bfb0: 6d70 6c65 2c20 7527 7777 772e 416c 6c69  mple, u'www.Alli
+0000bfc0: 616e 6365 6672 616e 5c5c 7865 3761 6973  ancefran\\xe7ais
+0000bfd0: 652e 6e75 2720 7769 6c6c 2062 6520 636f  e.nu' will be co
+0000bfe0: 6e76 6572 7465 6420 696e 746f 0a20 2020  nverted into.   
+0000bff0: 2027 7777 772e 786e 2d2d 616c 6c69 616e   'www.xn--allian
+0000c000: 6365 6672 616e 6169 7365 2d6e 7062 2e6e  cefranaise-npb.n
+0000c010: 7527 0a0a 2020 2020 4172 6773 3a0a 2020  u'..    Args:.  
+0000c020: 2020 2020 2020 6175 7468 6f72 6974 793a        authority:
+0000c030: 2075 6e69 636f 6465 2073 7472 696e 672c   unicode string,
+0000c040: 2074 6865 2055 524c 2061 7574 686f 7269   the URL authori
+0000c050: 7479 2063 6f6d 706f 6e65 6e74 2074 6f20  ty component to 
+0000c060: 636f 6e76 6572 742c 0a20 2020 2020 2020  convert,.       
+0000c070: 2020 2020 2065 2e67 2e20 7527 7777 772e       e.g. u'www.
+0000c080: 416c 6c69 616e 6365 6672 616e 5c5c 7865  Alliancefran\\xe
+0000c090: 3761 6973 652e 6e75 270a 0a20 2020 2052  7aise.nu'..    R
+0000c0a0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0000c0b0: 7374 7269 6e67 3a20 7468 6520 5553 2d41  string: the US-A
+0000c0c0: 5343 4949 2063 6861 7261 6374 6572 2065  SCII character e
+0000c0d0: 7175 6976 616c 656e 7420 746f 2074 6865  quivalent to the
+0000c0e0: 2069 6e70 7574 7465 6420 6175 7468 6f72   inputted author
+0000c0f0: 6974 792c 0a20 2020 2020 2020 2020 2020  ity,.           
+0000c100: 2020 652e 672e 2027 7777 772e 786e 2d2d    e.g. 'www.xn--
+0000c110: 616c 6c69 616e 6365 6672 616e 6169 7365  alliancefranaise
+0000c120: 2d6e 7062 2e6e 7527 0a0a 2020 2020 5261  -npb.nu'..    Ra
+0000c130: 6973 6573 3a0a 2020 2020 2020 2020 4578  ises:.        Ex
+0000c140: 6365 7074 696f 6e3a 2069 6620 7468 6520  ception: if the 
+0000c150: 6675 6e63 7469 6f6e 2069 7320 6e6f 7420  function is not 
+0000c160: 6162 6c65 2074 6f20 636f 6e76 6572 7420  able to convert 
+0000c170: 7468 6520 696e 7075 7474 6564 0a20 2020  the inputted.   
+0000c180: 2020 2020 2020 2020 2061 7574 686f 7269           authori
+0000c190: 7479 0a0a 2020 2020 4061 7574 686f 723a  ty..    @author:
+0000c1a0: 204a 6f6e 6174 6861 6e20 4265 6e6e 0a20   Jonathan Benn. 
+0000c1b0: 2020 2022 2222 0a20 2020 2023 2052 4643     """.    # RFC
+0000c1c0: 2033 3439 302c 2053 6563 7469 6f6e 2034   3490, Section 4
+0000c1d0: 2c20 5374 6570 2031 0a20 2020 2023 2054  , Step 1.    # T
+0000c1e0: 6865 2065 6e63 6f64 696e 6773 2e69 646e  he encodings.idn
+0000c1f0: 6120 5079 7468 6f6e 206d 6f64 756c 6520  a Python module 
+0000c200: 6173 7375 6d65 7320 7468 6174 2041 6c6c  assumes that All
+0000c210: 6f77 556e 6173 7369 676e 6564 203d 3d20  owUnassigned == 
+0000c220: 5472 7565 0a0a 2020 2020 2320 5246 4320  True..    # RFC 
+0000c230: 3334 3930 2c20 5365 6374 696f 6e20 342c  3490, Section 4,
+0000c240: 2053 7465 7020 320a 2020 2020 6c61 6265   Step 2.    labe
+0000c250: 6c73 203d 2072 652e 7370 6c69 7428 5245  ls = re.split(RE
+0000c260: 4745 585f 4155 5448 4f52 4954 595f 5350  GEX_AUTHORITY_SP
+0000c270: 4c49 5454 4552 2c20 6175 7468 6f72 6974  LITTER, authorit
+0000c280: 7929 0a0a 2020 2020 2320 5246 4320 3334  y)..    # RFC 34
+0000c290: 3930 2c20 5365 6374 696f 6e20 342c 2053  90, Section 4, S
+0000c2a0: 7465 7020 330a 2020 2020 2320 5468 6520  tep 3.    # The 
+0000c2b0: 656e 636f 6469 6e67 732e 6964 6e61 2050  encodings.idna P
+0000c2c0: 7974 686f 6e20 6d6f 6475 6c65 2061 7373  ython module ass
+0000c2d0: 756d 6573 2074 6861 7420 5573 6553 5444  umes that UseSTD
+0000c2e0: 3341 5343 4949 5275 6c65 7320 3d3d 2046  3ASCIIRules == F
+0000c2f0: 616c 7365 0a0a 2020 2020 2320 5246 4320  alse..    # RFC 
+0000c300: 3334 3930 2c20 5365 6374 696f 6e20 342c  3490, Section 4,
+0000c310: 2053 7465 7020 340a 2020 2020 2320 5765   Step 4.    # We
+0000c320: 2075 7365 2074 6865 2054 6f41 5343 4949   use the ToASCII
+0000c330: 206f 7065 7261 7469 6f6e 2062 6563 6175   operation becau
+0000c340: 7365 2077 6520 6172 6520 6162 6f75 7420  se we are about 
+0000c350: 746f 2070 7574 2074 6865 2061 7574 686f  to put the autho
+0000c360: 7269 7479 0a20 2020 2023 2069 6e74 6f20  rity.    # into 
+0000c370: 616e 2049 444e 2d75 6e61 7761 7265 2073  an IDN-unaware s
+0000c380: 6c6f 740a 2020 2020 6173 6369 694c 6162  lot.    asciiLab
+0000c390: 656c 7320 3d20 5b5d 0a20 2020 2066 6f72  els = [].    for
+0000c3a0: 206c 6162 656c 2069 6e20 6c61 6265 6c73   label in labels
+0000c3b0: 3a0a 2020 2020 2020 2020 6966 206c 6162  :.        if lab
+0000c3c0: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
+0000c3d0: 6173 6369 694c 6162 656c 732e 6170 7065  asciiLabels.appe
+0000c3e0: 6e64 2874 6f5f 6e61 7469 7665 2865 6e63  nd(to_native(enc
+0000c3f0: 6f64 696e 6773 2e69 646e 612e 546f 4153  odings.idna.ToAS
+0000c400: 4349 4928 6c61 6265 6c29 2929 0a20 2020  CII(label))).   
+0000c410: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000c420: 2020 2020 2020 2023 2065 6e63 6f64 696e         # encodin
+0000c430: 6773 2e69 646e 612e 546f 4153 4349 4920  gs.idna.ToASCII 
+0000c440: 646f 6573 206e 6f74 2061 6363 6570 7420  does not accept 
+0000c450: 616e 2065 6d70 7479 2073 7472 696e 672c  an empty string,
+0000c460: 2062 7574 0a20 2020 2020 2020 2020 2020   but.           
+0000c470: 2023 2069 7420 6973 206e 6563 6573 7361   # it is necessa
+0000c480: 7279 2066 6f72 2075 7320 746f 2061 6c6c  ry for us to all
+0000c490: 6f77 2066 6f72 2065 6d70 7479 206c 6162  ow for empty lab
+0000c4a0: 656c 7320 736f 2074 6861 7420 7765 0a20  els so that we. 
+0000c4b0: 2020 2020 2020 2020 2020 2023 2064 6f6e             # don
+0000c4c0: 2774 206d 6f64 6966 7920 7468 6520 5552  't modify the UR
+0000c4d0: 4c0a 2020 2020 2020 2020 2020 2020 6173  L.            as
+0000c4e0: 6369 694c 6162 656c 732e 6170 7065 6e64  ciiLabels.append
+0000c4f0: 2822 2229 0a20 2020 2023 2052 4643 2033  ("").    # RFC 3
+0000c500: 3439 302c 2053 6563 7469 6f6e 2034 2c20  490, Section 4, 
+0000c510: 5374 6570 2035 0a20 2020 2072 6574 7572  Step 5.    retur
+0000c520: 6e20 7374 7228 7265 6475 6365 286c 616d  n str(reduce(lam
+0000c530: 6264 6120 782c 2079 3a20 7820 2b20 756e  bda x, y: x + un
+0000c540: 6963 6872 2830 7830 3032 4529 202b 2079  ichr(0x002E) + y
+0000c550: 2c20 6173 6369 694c 6162 656c 7329 290a  , asciiLabels)).
+0000c560: 0a0a 6465 6620 756e 6963 6f64 655f 746f  ..def unicode_to
+0000c570: 5f61 7363 6969 5f75 726c 2875 726c 2c20  _ascii_url(url, 
+0000c580: 7072 6570 656e 645f 7363 6865 6d65 293a  prepend_scheme):
+0000c590: 0a20 2020 2022 2222 0a20 2020 2043 6f6e  .    """.    Con
+0000c5a0: 7665 7274 7320 7468 6520 696e 7075 7474  verts the inputt
+0000c5b0: 6564 2075 6e69 636f 6465 2075 726c 2069  ed unicode url i
+0000c5c0: 6e74 6f20 6120 5553 2d41 5343 4949 2065  nto a US-ASCII e
+0000c5d0: 7175 6976 616c 656e 742e 2054 6869 7320  quivalent. This 
+0000c5e0: 6675 6e63 7469 6f6e 0a20 2020 2067 6f65  function.    goe
+0000c5f0: 7320 6120 6c69 7474 6c65 2062 6579 6f6e  s a little beyon
+0000c600: 6420 5246 4320 3334 3930 2c20 7768 6963  d RFC 3490, whic
+0000c610: 6820 6973 206c 696d 6974 6564 2069 6e20  h is limited in 
+0000c620: 7363 6f70 6520 746f 2074 6865 2064 6f6d  scope to the dom
+0000c630: 6169 6e20 6e61 6d65 0a20 2020 2028 6175  ain name.    (au
+0000c640: 7468 6f72 6974 7929 206f 6e6c 792e 2048  thority) only. H
+0000c650: 6572 652c 2074 6865 2066 756e 6374 696f  ere, the functio
+0000c660: 6e61 6c69 7479 2069 7320 6578 7061 6e64  nality is expand
+0000c670: 6564 2074 6f20 7768 6174 2077 6173 206f  ed to what was o
+0000c680: 6273 6572 7665 640a 2020 2020 6f6e 2057  bserved.    on W
+0000c690: 696b 6970 6564 6961 206f 6e20 3230 3039  ikipedia on 2009
+0000c6a0: 2d4a 616e 2d32 323a 0a0a 2020 2020 2020  -Jan-22:..      
+0000c6b0: 2043 6f6d 706f 6e65 6e74 2020 2020 4361   Component    Ca
+0000c6c0: 6e20 5573 6520 556e 6963 6f64 653f 0a20  n Use Unicode?. 
+0000c6d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d20        --------- 
+0000c6e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d     -------------
+0000c6f0: 2d2d 2d0a 2020 2020 2020 2073 6368 656d  ---.       schem
+0000c700: 6520 2020 2020 2020 4e6f 0a20 2020 2020  e       No.     
+0000c710: 2020 6175 7468 6f72 6974 7920 2020 2059    authority    Y
+0000c720: 6573 0a20 2020 2020 2020 7061 7468 2020  es.       path  
+0000c730: 2020 2020 2020 2059 6573 0a20 2020 2020         Yes.     
+0000c740: 2020 7175 6572 7920 2020 2020 2020 2059    query        Y
+0000c750: 6573 0a20 2020 2020 2020 6672 6167 6d65  es.       fragme
+0000c760: 6e74 2020 2020 204e 6f0a 0a20 2020 2054  nt     No..    T
+0000c770: 6865 2061 7574 686f 7269 7479 2063 6f6d  he authority com
+0000c780: 706f 6e65 6e74 2067 6574 7320 636f 6e76  ponent gets conv
+0000c790: 6572 7465 6420 746f 2070 756e 7963 6f64  erted to punycod
+0000c7a0: 652c 2062 7574 206f 6363 7572 7265 6e63  e, but occurrenc
+0000c7b0: 6573 206f 660a 2020 2020 756e 6963 6f64  es of.    unicod
+0000c7c0: 6520 696e 206f 7468 6572 2063 6f6d 706f  e in other compo
+0000c7d0: 6e65 6e74 7320 6765 7420 636f 6e76 6572  nents get conver
+0000c7e0: 7465 6420 696e 746f 2061 2070 6169 7220  ted into a pair 
+0000c7f0: 6f66 2055 5249 2065 7363 6170 6573 2028  of URI escapes (
+0000c800: 7765 0a20 2020 2061 7373 756d 6520 342d  we.    assume 4-
+0000c810: 6279 7465 2075 6e69 636f 6465 292e 2045  byte unicode). E
+0000c820: 2e67 2e20 7468 6520 756e 6963 6f64 6520  .g. the unicode 
+0000c830: 6368 6172 6163 7465 7220 552b 3445 3244  character U+4E2D
+0000c840: 2077 696c 6c20 6265 0a20 2020 2063 6f6e   will be.    con
+0000c850: 7665 7274 6564 2069 6e74 6f20 2725 3445  verted into '%4E
+0000c860: 2532 4427 2e20 5465 7374 696e 6720 7769  %2D'. Testing wi
+0000c870: 7468 2046 6972 6566 6f78 2076 332e 302e  th Firefox v3.0.
+0000c880: 3520 6861 7320 7368 6f77 6e20 7468 6174  5 has shown that
+0000c890: 2069 7420 6361 6e0a 2020 2020 756e 6465   it can.    unde
+0000c8a0: 7273 7461 6e64 2074 6869 7320 6b69 6e64  rstand this kind
+0000c8b0: 206f 6620 5552 4920 656e 636f 6469 6e67   of URI encoding
+0000c8c0: 2e0a 0a20 2020 2041 7267 733a 0a20 2020  ...    Args:.   
+0000c8d0: 2020 2020 2075 726c 3a20 756e 6963 6f64       url: unicod
+0000c8e0: 6520 7374 7269 6e67 2c20 7468 6520 5552  e string, the UR
+0000c8f0: 4c20 746f 2063 6f6e 7665 7274 2066 726f  L to convert fro
+0000c900: 6d20 756e 6963 6f64 6520 696e 746f 2055  m unicode into U
+0000c910: 532d 4153 4349 490a 2020 2020 2020 2020  S-ASCII.        
+0000c920: 7072 6570 656e 645f 7363 6865 6d65 3a20  prepend_scheme: 
+0000c930: 7374 7269 6e67 2c20 6120 7072 6f74 6f63  string, a protoc
+0000c940: 6f6c 2073 6368 656d 6520 746f 2070 7265  ol scheme to pre
+0000c950: 7065 6e64 2074 6f20 7468 6520 5552 4c20  pend to the URL 
+0000c960: 6966 0a20 2020 2020 2020 2020 2020 2077  if.            w
+0000c970: 6527 7265 2068 6176 696e 6720 7472 6f75  e're having trou
+0000c980: 626c 6520 7061 7273 696e 6720 6974 2e0a  ble parsing it..
+0000c990: 2020 2020 2020 2020 2020 2020 652e 672e              e.g.
+0000c9a0: 2022 6874 7470 222e 2049 6e70 7574 204e   "http". Input N
+0000c9b0: 6f6e 6520 746f 2064 6973 6162 6c65 2074  one to disable t
+0000c9c0: 6869 7320 6675 6e63 7469 6f6e 616c 6974  his functionalit
+0000c9d0: 790a 0a20 2020 2052 6574 7572 6e73 3a0a  y..    Returns:.
+0000c9e0: 2020 2020 2020 2020 7374 7269 6e67 3a20          string: 
+0000c9f0: 6120 5553 2d41 5343 4949 2065 7175 6976  a US-ASCII equiv
+0000ca00: 616c 656e 7420 6f66 2074 6865 2069 6e70  alent of the inp
+0000ca10: 7574 7465 6420 7572 6c0a 0a20 2020 2040  utted url..    @
+0000ca20: 6175 7468 6f72 3a20 4a6f 6e61 7468 616e  author: Jonathan
+0000ca30: 2042 656e 6e0a 2020 2020 2222 220a 2020   Benn.    """.  
+0000ca40: 2020 2320 636f 6e76 6572 7420 7468 6520    # convert the 
+0000ca50: 6175 7468 6f72 6974 7920 636f 6d70 6f6e  authority compon
+0000ca60: 656e 7420 6f66 2074 6865 2055 524c 2069  ent of the URL i
+0000ca70: 6e74 6f20 616e 2041 5343 4949 2070 756e  nto an ASCII pun
+0000ca80: 7963 6f64 6520 7374 7269 6e67 2c0a 2020  ycode string,.  
+0000ca90: 2020 2320 6275 7420 656e 636f 6465 2074    # but encode t
+0000caa0: 6865 2072 6573 7420 7573 696e 6720 7468  he rest using th
+0000cab0: 6520 7265 6775 6c61 7220 5552 4920 6368  e regular URI ch
+0000cac0: 6172 6163 7465 7220 656e 636f 6469 6e67  aracter encoding
+0000cad0: 0a20 2020 2063 6f6d 706f 6e65 6e74 7320  .    components 
+0000cae0: 3d20 7572 6c70 6172 7365 2e75 726c 7061  = urlparse.urlpa
+0000caf0: 7273 6528 7572 6c29 0a20 2020 2070 7265  rse(url).    pre
+0000cb00: 7065 6e64 6564 203d 2046 616c 7365 0a20  pended = False. 
+0000cb10: 2020 2023 2049 6620 6e6f 2061 7574 686f     # If no autho
+0000cb20: 7269 7479 2077 6173 2066 6f75 6e64 0a20  rity was found. 
+0000cb30: 2020 2069 6620 6e6f 7420 636f 6d70 6f6e     if not compon
+0000cb40: 656e 7473 2e6e 6574 6c6f 633a 0a20 2020  ents.netloc:.   
+0000cb50: 2020 2020 2023 2054 7279 2061 7070 656e       # Try appen
+0000cb60: 6469 6e67 2061 2073 6368 656d 6520 746f  ding a scheme to
+0000cb70: 2073 6565 2069 6620 7468 6174 2066 6978   see if that fix
+0000cb80: 6573 2074 6865 2070 726f 626c 656d 0a20  es the problem. 
+0000cb90: 2020 2020 2020 2073 6368 656d 655f 746f         scheme_to
+0000cba0: 5f70 7265 7065 6e64 203d 2070 7265 7065  _prepend = prepe
+0000cbb0: 6e64 5f73 6368 656d 6520 6f72 2022 6874  nd_scheme or "ht
+0000cbc0: 7470 220a 2020 2020 2020 2020 636f 6d70  tp".        comp
+0000cbd0: 6f6e 656e 7473 203d 2075 726c 7061 7273  onents = urlpars
+0000cbe0: 652e 7572 6c70 6172 7365 2874 6f5f 756e  e.urlparse(to_un
+0000cbf0: 6963 6f64 6528 7363 6865 6d65 5f74 6f5f  icode(scheme_to_
+0000cc00: 7072 6570 656e 6429 202b 2022 3a2f 2f22  prepend) + "://"
+0000cc10: 202b 2075 726c 290a 2020 2020 2020 2020   + url).        
+0000cc20: 7072 6570 656e 6465 6420 3d20 5472 7565  prepended = True
+0000cc30: 0a0a 2020 2020 2320 6966 2077 6520 7374  ..    # if we st
+0000cc40: 696c 6c20 6361 6e27 7420 6669 6e64 2074  ill can't find t
+0000cc50: 6865 2061 7574 686f 7269 7479 0a20 2020  he authority.   
+0000cc60: 2069 6620 6e6f 7420 636f 6d70 6f6e 656e   if not componen
+0000cc70: 7473 2e6e 6574 6c6f 633a 0a20 2020 2020  ts.netloc:.     
+0000cc80: 2020 2023 2041 6e64 2069 7427 7320 6e6f     # And it's no
+0000cc90: 7420 6265 6361 7573 6520 7468 6520 7572  t because the ur
+0000cca0: 6c20 6973 2061 2072 656c 6174 6976 6520  l is a relative 
+0000ccb0: 7572 6c0a 2020 2020 2020 2020 6966 206e  url.        if n
+0000ccc0: 6f74 2075 726c 2e73 7461 7274 7377 6974  ot url.startswit
+0000ccd0: 6828 222f 2229 3a0a 2020 2020 2020 2020  h("/"):.        
+0000cce0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0000ccf0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0000cd00: 2020 2020 2022 4e6f 2061 7574 686f 7269       "No authori
+0000cd10: 7479 2063 6f6d 706f 6e65 6e74 2066 6f75  ty component fou
+0000cd20: 6e64 2c20 220a 2020 2020 2020 2020 2020  nd, ".          
+0000cd30: 2020 2020 2020 2b20 2263 6f75 6c64 206e        + "could n
+0000cd40: 6f74 2064 6563 6f64 6520 756e 6963 6f64  ot decode unicod
+0000cd50: 6520 746f 2055 532d 4153 4349 4922 0a20  e to US-ASCII". 
+0000cd60: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000cd70: 2020 2320 5765 2772 6520 6865 7265 2069    # We're here i
+0000cd80: 6620 7765 2066 6f75 6e64 2061 6e20 6175  f we found an au
+0000cd90: 7468 6f72 6974 792c 206c 6574 2773 2072  thority, let's r
+0000cda0: 6562 7569 6c64 2074 6865 2055 524c 0a20  ebuild the URL. 
+0000cdb0: 2020 2073 6368 656d 6520 3d20 636f 6d70     scheme = comp
+0000cdc0: 6f6e 656e 7473 2e73 6368 656d 650a 2020  onents.scheme.  
+0000cdd0: 2020 6175 7468 6f72 6974 7920 3d20 636f    authority = co
+0000cde0: 6d70 6f6e 656e 7473 2e6e 6574 6c6f 630a  mponents.netloc.
+0000cdf0: 2020 2020 7061 7468 203d 2063 6f6d 706f      path = compo
+0000ce00: 6e65 6e74 732e 7061 7468 0a20 2020 2071  nents.path.    q
+0000ce10: 7565 7279 203d 2063 6f6d 706f 6e65 6e74  uery = component
+0000ce20: 732e 7175 6572 790a 2020 2020 6672 6167  s.query.    frag
+0000ce30: 6d65 6e74 203d 2063 6f6d 706f 6e65 6e74  ment = component
+0000ce40: 732e 6672 6167 6d65 6e74 0a0a 2020 2020  s.fragment..    
+0000ce50: 6966 2070 7265 7065 6e64 6564 3a0a 2020  if prepended:.  
+0000ce60: 2020 2020 2020 7363 6865 6d65 203d 2022        scheme = "
+0000ce70: 220a 0a20 2020 2075 6e70 6172 7365 6420  "..    unparsed 
+0000ce80: 3d20 7572 6c70 6172 7365 2e75 726c 756e  = urlparse.urlun
+0000ce90: 7061 7273 6528 0a20 2020 2020 2020 2028  parse(.        (
+0000cea0: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
+0000ceb0: 656d 652c 0a20 2020 2020 2020 2020 2020  eme,.           
+0000cec0: 2075 6e69 636f 6465 5f74 6f5f 6173 6369   unicode_to_asci
+0000ced0: 695f 6175 7468 6f72 6974 7928 6175 7468  i_authority(auth
+0000cee0: 6f72 6974 7929 2c0a 2020 2020 2020 2020  ority),.        
+0000cef0: 2020 2020 6573 6361 7065 5f75 6e69 636f      escape_unico
+0000cf00: 6465 2870 6174 6829 2c0a 2020 2020 2020  de(path),.      
+0000cf10: 2020 2020 2020 2222 2c0a 2020 2020 2020        "",.      
+0000cf20: 2020 2020 2020 6573 6361 7065 5f75 6e69        escape_uni
+0000cf30: 636f 6465 2871 7565 7279 292c 0a20 2020  code(query),.   
+0000cf40: 2020 2020 2020 2020 2073 7472 2866 7261           str(fra
+0000cf50: 676d 656e 7429 2c0a 2020 2020 2020 2020  gment),.        
+0000cf60: 290a 2020 2020 290a 2020 2020 6966 2075  ).    ).    if u
+0000cf70: 6e70 6172 7365 642e 7374 6172 7473 7769  nparsed.startswi
+0000cf80: 7468 2822 2f2f 2229 3a0a 2020 2020 2020  th("//"):.      
+0000cf90: 2020 756e 7061 7273 6564 203d 2075 6e70    unparsed = unp
+0000cfa0: 6172 7365 645b 323a 5d20 2023 2052 656d  arsed[2:]  # Rem
+0000cfb0: 6f76 6520 7468 6520 2f2f 2075 726c 756e  ove the // urlun
+0000cfc0: 7061 7273 6520 7075 7473 2069 6e20 7468  parse puts in th
+0000cfd0: 6520 6265 6769 6e6e 696e 670a 2020 2020  e beginning.    
+0000cfe0: 7265 7475 726e 2075 6e70 6172 7365 640a  return unparsed.
+0000cff0: 0a0a 636c 6173 7320 4953 5f47 454e 4552  ..class IS_GENER
+0000d000: 4943 5f55 524c 2856 616c 6964 6174 6f72  IC_URL(Validator
+0000d010: 293a 0a20 2020 2022 2222 0a20 2020 2052  ):.    """.    R
+0000d020: 656a 6563 7473 2061 2055 524c 2073 7472  ejects a URL str
+0000d030: 696e 6720 6966 2061 6e79 206f 6620 7468  ing if any of th
+0000d040: 6520 666f 6c6c 6f77 696e 6720 6973 2074  e following is t
+0000d050: 7275 653a 0a20 2020 2020 2020 2a20 5468  rue:.       * Th
+0000d060: 6520 7374 7269 6e67 2069 7320 656d 7074  e string is empt
+0000d070: 7920 6f72 204e 6f6e 650a 2020 2020 2020  y or None.      
+0000d080: 202a 2054 6865 2073 7472 696e 6720 7573   * The string us
+0000d090: 6573 2063 6861 7261 6374 6572 7320 7468  es characters th
+0000d0a0: 6174 2061 7265 206e 6f74 2061 6c6c 6f77  at are not allow
+0000d0b0: 6564 2069 6e20 6120 5552 4c0a 2020 2020  ed in a URL.    
+0000d0c0: 2020 202a 2054 6865 2055 524c 2073 6368     * The URL sch
+0000d0d0: 656d 6520 7370 6563 6966 6965 6420 2869  eme specified (i
+0000d0e0: 6620 6f6e 6520 6973 2073 7065 6369 6669  f one is specifi
+0000d0f0: 6564 2920 6973 206e 6f74 2076 616c 6964  ed) is not valid
+0000d100: 0a0a 2020 2020 4261 7365 6420 6f6e 2052  ..    Based on R
+0000d110: 4643 2032 3339 363a 2068 7474 703a 2f2f  FC 2396: http://
+0000d120: 7777 772e 6661 7173 2e6f 7267 2f72 6663  www.faqs.org/rfc
+0000d130: 732f 7266 6332 3339 362e 6874 6d6c 0a0a  s/rfc2396.html..
+0000d140: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+0000d150: 6e20 6f6e 6c79 2063 6865 636b 7320 7468  n only checks th
+0000d160: 6520 5552 4c27 7320 7379 6e74 6178 2e20  e URL's syntax. 
+0000d170: 4974 2064 6f65 7320 6e6f 7420 6368 6563  It does not chec
+0000d180: 6b20 7468 6174 2074 6865 2055 524c 0a20  k that the URL. 
+0000d190: 2020 2070 6f69 6e74 7320 746f 2061 2072     points to a r
+0000d1a0: 6561 6c20 646f 6375 6d65 6e74 2c20 666f  eal document, fo
+0000d1b0: 7220 6578 616d 706c 652c 206f 7220 7468  r example, or th
+0000d1c0: 6174 2069 7420 6f74 6865 7277 6973 6520  at it otherwise 
+0000d1d0: 6d61 6b65 7320 7365 6e73 650a 2020 2020  makes sense.    
+0000d1e0: 7365 6d61 6e74 6963 616c 6c79 2e20 5468  semantically. Th
+0000d1f0: 6973 2066 756e 6374 696f 6e20 646f 6573  is function does
+0000d200: 2061 7574 6f6d 6174 6963 616c 6c79 2070   automatically p
+0000d210: 7265 7065 6e64 2027 6874 7470 3a2f 2f27  repend 'http://'
+0000d220: 2069 6e20 6672 6f6e 740a 2020 2020 6f66   in front.    of
+0000d230: 2061 2055 524c 2069 6620 616e 6420 6f6e   a URL if and on
+0000d240: 6c79 2069 6620 7468 6174 2773 206e 6563  ly if that's nec
+0000d250: 6573 7361 7279 2074 6f20 7375 6363 6573  essary to succes
+0000d260: 7366 756c 6c79 2070 6172 7365 2074 6865  sfully parse the
+0000d270: 2055 524c 2e0a 2020 2020 506c 6561 7365   URL..    Please
+0000d280: 206e 6f74 6520 7468 6174 2061 2073 6368   note that a sch
+0000d290: 656d 6520 7769 6c6c 2062 6520 7072 6570  eme will be prep
+0000d2a0: 656e 6465 6420 6f6e 6c79 2066 6f72 2072  ended only for r
+0000d2b0: 6172 6520 6361 7365 730a 2020 2020 2865  are cases.    (e
+0000d2c0: 2e67 2e20 2767 6f6f 676c 652e 6361 3a38  .g. 'google.ca:8
+0000d2d0: 3027 290a 0a20 2020 2054 6865 206c 6973  0')..    The lis
+0000d2e0: 7420 6f66 2061 6c6c 6f77 6564 2073 6368  t of allowed sch
+0000d2f0: 656d 6573 2069 7320 6375 7374 6f6d 697a  emes is customiz
+0000d300: 6162 6c65 2077 6974 6820 7468 6520 616c  able with the al
+0000d310: 6c6f 7765 645f 7363 6865 6d65 730a 2020  lowed_schemes.  
+0000d320: 2020 7061 7261 6d65 7465 722e 2049 6620    parameter. If 
+0000d330: 796f 7520 6578 636c 7564 6520 4e6f 6e65  you exclude None
+0000d340: 2066 726f 6d20 7468 6520 6c69 7374 2c20   from the list, 
+0000d350: 7468 656e 2061 6262 7265 7669 6174 6564  then abbreviated
+0000d360: 2055 524c 730a 2020 2020 286c 6163 6b69   URLs.    (lacki
+0000d370: 6e67 2061 2073 6368 656d 6520 7375 6368  ng a scheme such
+0000d380: 2061 7320 2768 7474 7027 2920 7769 6c6c   as 'http') will
+0000d390: 2062 6520 7265 6a65 6374 6564 2e0a 0a20   be rejected... 
+0000d3a0: 2020 2054 6865 2064 6566 6175 6c74 2070     The default p
+0000d3b0: 7265 7065 6e64 6564 2073 6368 656d 6520  repended scheme 
+0000d3c0: 6973 2063 7573 746f 6d69 7a61 626c 6520  is customizable 
+0000d3d0: 7769 7468 2074 6865 2070 7265 7065 6e64  with the prepend
+0000d3e0: 5f73 6368 656d 650a 2020 2020 7061 7261  _scheme.    para
+0000d3f0: 6d65 7465 722e 2049 6620 796f 7520 7365  meter. If you se
+0000d400: 7420 7072 6570 656e 645f 7363 6865 6d65  t prepend_scheme
+0000d410: 2074 6f20 4e6f 6e65 2074 6865 6e20 7072   to None then pr
+0000d420: 6570 656e 6469 6e67 2077 696c 6c20 6265  epending will be
+0000d430: 0a20 2020 2064 6973 6162 6c65 642e 2055  .    disabled. U
+0000d440: 524c 7320 7468 6174 2072 6571 7569 7265  RLs that require
+0000d450: 2070 7265 7065 6e64 696e 6720 746f 2070   prepending to p
+0000d460: 6172 7365 2077 696c 6c20 7374 696c 6c20  arse will still 
+0000d470: 6265 2061 6363 6570 7465 642c 0a20 2020  be accepted,.   
+0000d480: 2062 7574 2074 6865 2072 6574 7572 6e20   but the return 
+0000d490: 7661 6c75 6520 7769 6c6c 206e 6f74 2062  value will not b
+0000d4a0: 6520 6d6f 6469 6669 6564 2e0a 0a20 2020  e modified...   
+0000d4b0: 2040 6175 7468 6f72 3a20 4a6f 6e61 7468   @author: Jonath
+0000d4c0: 616e 2042 656e 6e0a 0a20 2020 2020 2020  an Benn..       
+0000d4d0: 203e 3e3e 2049 535f 4745 4e45 5249 435f   >>> IS_GENERIC_
+0000d4e0: 5552 4c28 2928 2768 7474 703a 2f2f 7573  URL()('http://us
+0000d4f0: 6572 4061 6263 2e63 6f6d 2729 0a20 2020  er@abc.com').   
+0000d500: 2020 2020 2028 2768 7474 703a 2f2f 7573       ('http://us
+0000d510: 6572 4061 6263 2e63 6f6d 272c 204e 6f6e  er@abc.com', Non
+0000d520: 6529 0a0a 2020 2020 4172 6773 3a0a 2020  e)..    Args:.  
+0000d530: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0000d540: 6167 653a 2061 2073 7472 696e 672c 2074  age: a string, t
+0000d550: 6865 2065 7272 6f72 206d 6573 7361 6765  he error message
+0000d560: 2074 6f20 6769 7665 2074 6865 2065 6e64   to give the end
+0000d570: 2075 7365 720a 2020 2020 2020 2020 2020   user.          
+0000d580: 2020 6966 2074 6865 2055 524c 2064 6f65    if the URL doe
+0000d590: 7320 6e6f 7420 7661 6c69 6461 7465 0a20  s not validate. 
+0000d5a0: 2020 2020 2020 2061 6c6c 6f77 6564 5f73         allowed_s
+0000d5b0: 6368 656d 6573 3a20 6120 6c69 7374 2063  chemes: a list c
+0000d5c0: 6f6e 7461 696e 696e 6720 7374 7269 6e67  ontaining string
+0000d5d0: 7320 6f72 204e 6f6e 652e 2045 6163 6820  s or None. Each 
+0000d5e0: 656c 656d 656e 740a 2020 2020 2020 2020  element.        
+0000d5f0: 2020 2020 6973 2061 2073 6368 656d 6520      is a scheme 
+0000d600: 7468 6520 696e 7075 7474 6564 2055 524c  the inputted URL
+0000d610: 2069 7320 616c 6c6f 7765 6420 746f 2075   is allowed to u
+0000d620: 7365 0a20 2020 2020 2020 2070 7265 7065  se.        prepe
+0000d630: 6e64 5f73 6368 656d 653a 2061 2073 7472  nd_scheme: a str
+0000d640: 696e 672c 2074 6869 7320 7363 6865 6d65  ing, this scheme
+0000d650: 2069 7320 7072 6570 656e 6465 6420 6966   is prepended if
+0000d660: 2069 7427 730a 2020 2020 2020 2020 2020   it's.          
+0000d670: 2020 6e65 6365 7373 6172 7920 746f 206d    necessary to m
+0000d680: 616b 6520 7468 6520 5552 4c20 7661 6c69  ake the URL vali
+0000d690: 640a 0a20 2020 2022 2222 0a0a 2020 2020  d..    """..    
+0000d6a0: 6465 6620 5f5f 696e 6974 5f5f 280a 2020  def __init__(.  
+0000d6b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000d6c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0000d6d0: 653d 2245 6e74 6572 2061 2076 616c 6964  e="Enter a valid
+0000d6e0: 2055 524c 222c 0a20 2020 2020 2020 2061   URL",.        a
+0000d6f0: 6c6c 6f77 6564 5f73 6368 656d 6573 3d4e  llowed_schemes=N
+0000d700: 6f6e 652c 0a20 2020 2020 2020 2070 7265  one,.        pre
+0000d710: 7065 6e64 5f73 6368 656d 653d 4e6f 6e65  pend_scheme=None
+0000d720: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000d730: 2073 656c 662e 6572 726f 725f 6d65 7373   self.error_mess
+0000d740: 6167 6520 3d20 6572 726f 725f 6d65 7373  age = error_mess
+0000d750: 6167 650a 2020 2020 2020 2020 6966 2061  age.        if a
+0000d760: 6c6c 6f77 6564 5f73 6368 656d 6573 2069  llowed_schemes i
+0000d770: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000d780: 2020 2020 7365 6c66 2e61 6c6c 6f77 6564      self.allowed
+0000d790: 5f73 6368 656d 6573 203d 2061 6c6c 5f75  _schemes = all_u
+0000d7a0: 726c 5f73 6368 656d 6573 0a20 2020 2020  rl_schemes.     
+0000d7b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000d7c0: 2020 2020 2073 656c 662e 616c 6c6f 7765       self.allowe
+0000d7d0: 645f 7363 6865 6d65 7320 3d20 616c 6c6f  d_schemes = allo
+0000d7e0: 7765 645f 7363 6865 6d65 730a 2020 2020  wed_schemes.    
+0000d7f0: 2020 2020 7365 6c66 2e70 7265 7065 6e64      self.prepend
+0000d800: 5f73 6368 656d 6520 3d20 7072 6570 656e  _scheme = prepen
+0000d810: 645f 7363 6865 6d65 0a20 2020 2020 2020  d_scheme.       
+0000d820: 2069 6620 7365 6c66 2e70 7265 7065 6e64   if self.prepend
+0000d830: 5f73 6368 656d 6520 6e6f 7420 696e 2073  _scheme not in s
+0000d840: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
+0000d850: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
+0000d860: 2072 6169 7365 2053 796e 7461 7845 7272   raise SyntaxErr
+0000d870: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000d880: 2020 2020 2270 7265 7065 6e64 5f73 6368      "prepend_sch
+0000d890: 656d 653d 2725 7327 2069 7320 6e6f 7420  eme='%s' is not 
+0000d8a0: 696e 2061 6c6c 6f77 6564 5f73 6368 656d  in allowed_schem
+0000d8b0: 6573 3d25 7322 0a20 2020 2020 2020 2020  es=%s".         
+0000d8c0: 2020 2020 2020 2025 2028 7365 6c66 2e70         % (self.p
+0000d8d0: 7265 7065 6e64 5f73 6368 656d 652c 2073  repend_scheme, s
+0000d8e0: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
+0000d8f0: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
+0000d900: 2029 0a0a 2020 2020 5245 4745 585f 4745   )..    REGEX_GE
+0000d910: 4e45 5249 435f 5552 4c20 3d20 7222 255b  NERIC_URL = r"%[
+0000d920: 5e30 2d39 412d 4661 2d66 5d7b 327d 7c25  ^0-9A-Fa-f]{2}|%
+0000d930: 5b5e 302d 3941 2d46 612d 665d 5b30 2d39  [^0-9A-Fa-f][0-9
+0000d940: 412d 4661 2d66 5d7c 255b 302d 3941 2d46  A-Fa-f]|%[0-9A-F
+0000d950: 612d 665d 5b5e 302d 3941 2d46 612d 665d  a-f][^0-9A-Fa-f]
+0000d960: 7c25 247c 255b 302d 3941 2d46 612d 665d  |%$|%[0-9A-Fa-f]
+0000d970: 247c 255b 5e30 2d39 412d 4661 2d66 5d24  $|%[^0-9A-Fa-f]$
+0000d980: 220a 2020 2020 5245 4745 585f 4745 4e45  ".    REGEX_GENE
+0000d990: 5249 435f 5552 4c5f 5641 4c49 4420 3d20  RIC_URL_VALID = 
+0000d9a0: 7222 5b41 2d5a 612d 7a30 2d39 3b2f 3f3a  r"[A-Za-z0-9;/?:
+0000d9b0: 4026 3d2b 242c 5c2d 5f5c 2e21 7e2a 275c  @&=+$,\-_\.!~*'\
+0000d9c0: 285c 2925 5d2b 2422 0a20 2020 2052 4547  (\)%]+$".    REG
+0000d9d0: 4558 5f55 524c 5f46 5241 474d 454e 545f  EX_URL_FRAGMENT_
+0000d9e0: 5641 4c49 4420 3d20 7222 5b7c 412d 5a61  VALID = r"[|A-Za
+0000d9f0: 2d7a 302d 393b 2f3f 3a40 263d 2b24 2c5c  -z0-9;/?:@&=+$,\
+0000da00: 2d5f 5c2e 217e 2a27 5c28 5c29 255d 2b24  -_\.!~*'\(\)%]+$
+0000da10: 220a 0a20 2020 2064 6566 2076 616c 6964  "..    def valid
+0000da20: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+0000da30: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+0000da40: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000da50: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+0000da60: 2020 2020 2020 2020 7661 6c75 653a 2061          value: a
+0000da70: 2073 7472 696e 672c 2074 6865 2055 524c   string, the URL
+0000da80: 2074 6f20 7661 6c69 6461 7465 0a0a 2020   to validate..  
+0000da90: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000daa0: 2020 2020 2020 2020 2020 2061 2074 7570             a tup
+0000dab0: 6c65 2c20 7768 6572 6520 7475 706c 655b  le, where tuple[
+0000dac0: 305d 2069 7320 7468 6520 696e 7075 7474  0] is the inputt
+0000dad0: 6564 2076 616c 7565 2028 706f 7373 6962  ed value (possib
+0000dae0: 6c65 0a20 2020 2020 2020 2020 2020 2070  le.            p
+0000daf0: 7265 7065 6e64 6564 2077 6974 6820 7072  repended with pr
+0000db00: 6570 656e 645f 7363 6865 6d65 292c 2061  epend_scheme), a
+0000db10: 6e64 2074 7570 6c65 5b31 5d20 6973 2065  nd tuple[1] is e
+0000db20: 6974 6865 720a 2020 2020 2020 2020 2020  ither.          
+0000db30: 2020 4e6f 6e65 2028 7375 6363 6573 7321    None (success!
+0000db40: 2920 6f72 2074 6865 2073 7472 696e 6720  ) or the string 
+0000db50: 6572 726f 725f 6d65 7373 6167 650a 2020  error_message.  
+0000db60: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000db70: 2020 2023 2069 6620 7765 2064 6f6e 7420     # if we dont 
+0000db80: 6861 7665 2061 6e79 7468 696e 6720 6f72  have anything or
+0000db90: 2074 6865 2055 524c 206d 6973 7573 6573   the URL misuses
+0000dba0: 2074 6865 2027 2527 2063 6861 7261 6374   the '%' charact
+0000dbb0: 6572 0a0a 2020 2020 2020 2020 6966 206e  er..        if n
+0000dbc0: 6f74 2076 616c 7565 206f 7220 7265 2e73  ot value or re.s
+0000dbd0: 6561 7263 6828 7365 6c66 2e52 4547 4558  earch(self.REGEX
+0000dbe0: 5f47 454e 4552 4943 5f55 524c 2c20 7661  _GENERIC_URL, va
+0000dbf0: 6c75 6529 3a0a 2020 2020 2020 2020 2020  lue):.          
+0000dc00: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
+0000dc10: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
+0000dc20: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
+0000dc30: 6f72 5f6d 6573 7361 6765 2929 0a0a 2020  or_message))..  
+0000dc40: 2020 2020 2020 6966 2022 2322 2069 6e20        if "#" in 
+0000dc50: 7661 6c75 653a 0a20 2020 2020 2020 2020  value:.         
+0000dc60: 2020 2075 726c 2c20 6672 6167 6d65 6e74     url, fragment
+0000dc70: 5f70 6172 7420 3d20 7661 6c75 652e 7370  _part = value.sp
+0000dc80: 6c69 7428 2223 2229 0a20 2020 2020 2020  lit("#").       
+0000dc90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000dca0: 2020 2075 726c 2c20 6672 6167 6d65 6e74     url, fragment
+0000dcb0: 5f70 6172 7420 3d20 7661 6c75 652c 2022  _part = value, "
+0000dcc0: 220a 2020 2020 2020 2020 2320 6966 2074  ".        # if t
+0000dcd0: 6865 2055 524c 2069 7320 6f6e 6c79 2063  he URL is only c
+0000dce0: 6f6d 706f 7365 6420 6f66 2076 616c 6964  omposed of valid
+0000dcf0: 2063 6861 7261 6374 6572 730a 2020 2020   characters.    
+0000dd00: 2020 2020 6966 206e 6f74 2072 652e 6d61      if not re.ma
+0000dd10: 7463 6828 7365 6c66 2e52 4547 4558 5f47  tch(self.REGEX_G
+0000dd20: 454e 4552 4943 5f55 524c 5f56 414c 4944  ENERIC_URL_VALID
+0000dd30: 2c20 7572 6c29 206f 7220 280a 2020 2020  , url) or (.    
+0000dd40: 2020 2020 2020 2020 6672 6167 6d65 6e74          fragment
+0000dd50: 5f70 6172 7420 616e 6420 6e6f 7420 7265  _part and not re
+0000dd60: 2e6d 6174 6368 2873 656c 662e 5245 4745  .match(self.REGE
+0000dd70: 585f 5552 4c5f 4652 4147 4d45 4e54 5f56  X_URL_FRAGMENT_V
+0000dd80: 414c 4944 2c20 6672 6167 6d65 6e74 5f70  ALID, fragment_p
+0000dd90: 6172 7429 0a20 2020 2020 2020 2029 3a0a  art).        ):.
+0000dda0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ddb0: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+0000ddc0: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
+0000ddd0: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
+0000dde0: 7361 6765 2929 0a20 2020 2020 2020 2023  sage)).        #
+0000ddf0: 2054 6865 6e20 7061 7273 6520 7468 6520   Then parse the 
+0000de00: 5552 4c20 696e 746f 2069 7473 2063 6f6d  URL into its com
+0000de10: 706f 6e65 6e74 7320 616e 6420 6368 6563  ponents and chec
+0000de20: 6b20 6f6e 0a20 2020 2020 2020 2074 7279  k on.        try
+0000de30: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0000de40: 6d70 6f6e 656e 7473 203d 2075 726c 7061  mponents = urlpa
+0000de50: 7273 652e 7572 6c70 6172 7365 2875 726c  rse.urlparse(url
+0000de60: 6c69 625f 756e 7175 6f74 6528 7661 6c75  lib_unquote(valu
+0000de70: 6529 292e 5f61 7364 6963 7428 290a 2020  e))._asdict().  
+0000de80: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+0000de90: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+0000dea0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
+0000deb0: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
+0000dec0: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
+0000ded0: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
+0000dee0: 0a20 2020 2020 2020 2023 2043 6c65 616e  .        # Clean
+0000def0: 2075 7020 7468 6520 7363 6865 6d65 2062   up the scheme b
+0000df00: 6566 6f72 6520 7765 2063 6865 636b 2069  efore we check i
+0000df10: 740a 2020 2020 2020 2020 7363 6865 6d65  t.        scheme
+0000df20: 203d 2063 6f6d 706f 6e65 6e74 735b 2273   = components["s
+0000df30: 6368 656d 6522 5d0a 2020 2020 2020 2020  cheme"].        
+0000df40: 6966 206c 656e 2873 6368 656d 6529 203d  if len(scheme) =
+0000df50: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0000df60: 2073 6368 656d 6520 3d20 4e6f 6e65 0a20   scheme = None. 
+0000df70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000df80: 2020 2020 2020 2020 2073 6368 656d 6520           scheme 
+0000df90: 3d20 636f 6d70 6f6e 656e 7473 5b22 7363  = components["sc
+0000dfa0: 6865 6d65 225d 2e6c 6f77 6572 2829 0a20  heme"].lower(). 
+0000dfb0: 2020 2020 2020 2023 2049 6620 7468 6520         # If the 
+0000dfc0: 7363 6865 6d65 2064 6f65 736e 2774 2072  scheme doesn't r
+0000dfd0: 6561 6c6c 7920 6578 6973 7473 0a20 2020  eally exists.   
+0000dfe0: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+0000dff0: 2020 2020 2020 7363 6865 6d65 206e 6f74        scheme not
+0000e000: 2069 6e20 7365 6c66 2e61 6c6c 6f77 6564   in self.allowed
+0000e010: 5f73 6368 656d 6573 0a20 2020 2020 2020  _schemes.       
+0000e020: 2020 2020 206f 7220 6e6f 7420 7363 6865       or not sche
+0000e030: 6d65 0a20 2020 2020 2020 2020 2020 2061  me.            a
+0000e040: 6e64 2022 3a22 2069 6e20 636f 6d70 6f6e  nd ":" in compon
+0000e050: 656e 7473 5b22 7061 7468 225d 0a20 2020  ents["path"].   
+0000e060: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0000e070: 2020 2020 2320 666f 7220 7468 6520 706f      # for the po
+0000e080: 7373 6962 6c65 2063 6173 6520 6f66 2061  ssible case of a
+0000e090: 6262 7265 7669 6174 6564 2055 524c 7320  bbreviated URLs 
+0000e0a0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+0000e0b0: 2023 2070 6f72 7473 2c20 6368 6563 6b20   # ports, check 
+0000e0c0: 746f 2073 6565 2069 6620 6164 6469 6e67  to see if adding
+0000e0d0: 2061 2076 616c 6964 2073 6368 656d 6520   a valid scheme 
+0000e0e0: 6669 7865 730a 2020 2020 2020 2020 2020  fixes.          
+0000e0f0: 2020 2320 7468 6520 7072 6f62 6c65 6d20    # the problem 
+0000e100: 2862 7574 206f 6e6c 7920 646f 2074 6869  (but only do thi
+0000e110: 7320 6966 2069 7420 646f 6573 6e27 7420  s if it doesn't 
+0000e120: 6861 7665 0a20 2020 2020 2020 2020 2020  have.           
+0000e130: 2023 206f 6e65 2061 6c72 6561 6479 2129   # one already!)
+0000e140: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000e150: 223a 2f2f 2220 6e6f 7420 696e 2076 616c  "://" not in val
+0000e160: 7565 2061 6e64 204e 6f6e 6520 696e 2073  ue and None in s
+0000e170: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
+0000e180: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
+0000e190: 2020 2020 2073 6368 656d 6554 6f55 7365       schemeToUse
+0000e1a0: 203d 2073 656c 662e 7072 6570 656e 645f   = self.prepend_
+0000e1b0: 7363 6865 6d65 206f 7220 2268 7474 7022  scheme or "http"
+0000e1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e1d0: 206e 6577 5f76 616c 7565 203d 2073 656c   new_value = sel
+0000e1e0: 662e 7661 6c69 6461 7465 2873 6368 656d  f.validate(schem
+0000e1f0: 6554 6f55 7365 202b 2022 3a2f 2f22 202b  eToUse + "://" +
+0000e200: 2076 616c 7565 290a 2020 2020 2020 2020   value).        
+0000e210: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000e220: 6577 5f76 616c 7565 2069 6620 7365 6c66  ew_value if self
+0000e230: 2e70 7265 7065 6e64 5f73 6368 656d 6520  .prepend_scheme 
+0000e240: 656c 7365 2076 616c 7565 0a20 2020 2020  else value.     
+0000e250: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000e260: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
+0000e270: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+0000e280: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
+0000e290: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000e2a0: 2076 616c 7565 0a0a 0a23 2053 6f75 7263   value...# Sourc
+0000e2b0: 6573 2028 6f62 7461 696e 6564 2032 3031  es (obtained 201
+0000e2c0: 372d 4e6f 762d 3131 293a 0a23 2020 2020  7-Nov-11):.#    
+0000e2d0: 6874 7470 3a2f 2f64 6174 612e 6961 6e61  http://data.iana
+0000e2e0: 2e6f 7267 2f54 4c44 2f74 6c64 732d 616c  .org/TLD/tlds-al
+0000e2f0: 7068 612d 6279 2d64 6f6d 6169 6e2e 7478  pha-by-domain.tx
+0000e300: 740a 2320 7365 6520 7363 7269 7074 732f  t.# see scripts/
+0000e310: 7061 7273 655f 746f 705f 6c65 7665 6c5f  parse_top_level_
+0000e320: 646f 6d61 696e 732e 7079 2066 6f72 2061  domains.py for a
+0000e330: 6e20 6561 7379 2075 7064 6174 650a 0a6f  n easy update..o
+0000e340: 6666 6963 6961 6c5f 746f 705f 6c65 7665  fficial_top_leve
+0000e350: 6c5f 646f 6d61 696e 7320 3d20 5b0a 2020  l_domains = [.  
+0000e360: 2020 2320 610a 2020 2020 2261 6161 222c    # a.    "aaa",
+0000e370: 0a20 2020 2022 6161 7270 222c 0a20 2020  .    "aarp",.   
+0000e380: 2022 6162 6172 7468 222c 0a20 2020 2022   "abarth",.    "
+0000e390: 6162 6222 2c0a 2020 2020 2261 6262 6f74  abb",.    "abbot
+0000e3a0: 7422 2c0a 2020 2020 2261 6262 7669 6522  t",.    "abbvie"
+0000e3b0: 2c0a 2020 2020 2261 6263 222c 0a20 2020  ,.    "abc",.   
+0000e3c0: 2022 6162 6c65 222c 0a20 2020 2022 6162   "able",.    "ab
+0000e3d0: 6f67 6164 6f22 2c0a 2020 2020 2261 6275  ogado",.    "abu
+0000e3e0: 6468 6162 6922 2c0a 2020 2020 2261 6322  dhabi",.    "ac"
+0000e3f0: 2c0a 2020 2020 2261 6361 6465 6d79 222c  ,.    "academy",
+0000e400: 0a20 2020 2022 6163 6365 6e74 7572 6522  .    "accenture"
+0000e410: 2c0a 2020 2020 2261 6363 6f75 6e74 616e  ,.    "accountan
+0000e420: 7422 2c0a 2020 2020 2261 6363 6f75 6e74  t",.    "account
+0000e430: 616e 7473 222c 0a20 2020 2022 6163 6f22  ants",.    "aco"
+0000e440: 2c0a 2020 2020 2261 6374 6976 6522 2c0a  ,.    "active",.
+0000e450: 2020 2020 2261 6374 6f72 222c 0a20 2020      "actor",.   
+0000e460: 2022 6164 222c 0a20 2020 2022 6164 6163   "ad",.    "adac
+0000e470: 222c 0a20 2020 2022 6164 7322 2c0a 2020  ",.    "ads",.  
+0000e480: 2020 2261 6475 6c74 222c 0a20 2020 2022    "adult",.    "
+0000e490: 6165 222c 0a20 2020 2022 6165 6722 2c0a  ae",.    "aeg",.
+0000e4a0: 2020 2020 2261 6572 6f22 2c0a 2020 2020      "aero",.    
+0000e4b0: 2261 6574 6e61 222c 0a20 2020 2022 6166  "aetna",.    "af
+0000e4c0: 222c 0a20 2020 2022 6166 616d 696c 7963  ",.    "afamilyc
+0000e4d0: 6f6d 7061 6e79 222c 0a20 2020 2022 6166  ompany",.    "af
+0000e4e0: 6c22 2c0a 2020 2020 2261 6672 6963 6122  l",.    "africa"
+0000e4f0: 2c0a 2020 2020 2261 6722 2c0a 2020 2020  ,.    "ag",.    
+0000e500: 2261 6761 6b68 616e 222c 0a20 2020 2022  "agakhan",.    "
+0000e510: 6167 656e 6379 222c 0a20 2020 2022 6169  agency",.    "ai
+0000e520: 222c 0a20 2020 2022 6169 6722 2c0a 2020  ",.    "aig",.  
+0000e530: 2020 2261 6967 6f22 2c0a 2020 2020 2261    "aigo",.    "a
+0000e540: 6972 6275 7322 2c0a 2020 2020 2261 6972  irbus",.    "air
+0000e550: 666f 7263 6522 2c0a 2020 2020 2261 6972  force",.    "air
+0000e560: 7465 6c22 2c0a 2020 2020 2261 6b64 6e22  tel",.    "akdn"
+0000e570: 2c0a 2020 2020 2261 6c22 2c0a 2020 2020  ,.    "al",.    
+0000e580: 2261 6c66 6172 6f6d 656f 222c 0a20 2020  "alfaromeo",.   
+0000e590: 2022 616c 6962 6162 6122 2c0a 2020 2020   "alibaba",.    
+0000e5a0: 2261 6c69 7061 7922 2c0a 2020 2020 2261  "alipay",.    "a
+0000e5b0: 6c6c 6669 6e61 6e7a 222c 0a20 2020 2022  llfinanz",.    "
+0000e5c0: 616c 6c73 7461 7465 222c 0a20 2020 2022  allstate",.    "
+0000e5d0: 616c 6c79 222c 0a20 2020 2022 616c 7361  ally",.    "alsa
+0000e5e0: 6365 222c 0a20 2020 2022 616c 7374 6f6d  ce",.    "alstom
+0000e5f0: 222c 0a20 2020 2022 616d 222c 0a20 2020  ",.    "am",.   
+0000e600: 2022 616d 6572 6963 616e 6578 7072 6573   "americanexpres
+0000e610: 7322 2c0a 2020 2020 2261 6d65 7269 6361  s",.    "america
+0000e620: 6e66 616d 696c 7922 2c0a 2020 2020 2261  nfamily",.    "a
+0000e630: 6d65 7822 2c0a 2020 2020 2261 6d66 616d  mex",.    "amfam
+0000e640: 222c 0a20 2020 2022 616d 6963 6122 2c0a  ",.    "amica",.
+0000e650: 2020 2020 2261 6d73 7465 7264 616d 222c      "amsterdam",
+0000e660: 0a20 2020 2022 616e 616c 7974 6963 7322  .    "analytics"
+0000e670: 2c0a 2020 2020 2261 6e64 726f 6964 222c  ,.    "android",
+0000e680: 0a20 2020 2022 616e 7175 616e 222c 0a20  .    "anquan",. 
+0000e690: 2020 2022 616e 7a22 2c0a 2020 2020 2261     "anz",.    "a
+0000e6a0: 6f22 2c0a 2020 2020 2261 6f6c 222c 0a20  o",.    "aol",. 
+0000e6b0: 2020 2022 6170 6172 746d 656e 7473 222c     "apartments",
+0000e6c0: 0a20 2020 2022 6170 7022 2c0a 2020 2020  .    "app",.    
+0000e6d0: 2261 7070 6c65 222c 0a20 2020 2022 6171  "apple",.    "aq
+0000e6e0: 222c 0a20 2020 2022 6171 7561 7265 6c6c  ",.    "aquarell
+0000e6f0: 6522 2c0a 2020 2020 2261 7222 2c0a 2020  e",.    "ar",.  
+0000e700: 2020 2261 7261 6222 2c0a 2020 2020 2261    "arab",.    "a
+0000e710: 7261 6d63 6f22 2c0a 2020 2020 2261 7263  ramco",.    "arc
+0000e720: 6869 222c 0a20 2020 2022 6172 6d79 222c  hi",.    "army",
+0000e730: 0a20 2020 2022 6172 7061 222c 0a20 2020  .    "arpa",.   
+0000e740: 2022 6172 7422 2c0a 2020 2020 2261 7274   "art",.    "art
+0000e750: 6522 2c0a 2020 2020 2261 7322 2c0a 2020  e",.    "as",.  
+0000e760: 2020 2261 7364 6122 2c0a 2020 2020 2261    "asda",.    "a
+0000e770: 7369 6122 2c0a 2020 2020 2261 7373 6f63  sia",.    "assoc
+0000e780: 6961 7465 7322 2c0a 2020 2020 2261 7422  iates",.    "at"
+0000e790: 2c0a 2020 2020 2261 7468 6c65 7461 222c  ,.    "athleta",
+0000e7a0: 0a20 2020 2022 6174 746f 726e 6579 222c  .    "attorney",
+0000e7b0: 0a20 2020 2022 6175 222c 0a20 2020 2022  .    "au",.    "
+0000e7c0: 6175 6374 696f 6e22 2c0a 2020 2020 2261  auction",.    "a
+0000e7d0: 7564 6922 2c0a 2020 2020 2261 7564 6962  udi",.    "audib
+0000e7e0: 6c65 222c 0a20 2020 2022 6175 6469 6f22  le",.    "audio"
+0000e7f0: 2c0a 2020 2020 2261 7573 706f 7374 222c  ,.    "auspost",
+0000e800: 0a20 2020 2022 6175 7468 6f72 222c 0a20  .    "author",. 
+0000e810: 2020 2022 6175 746f 222c 0a20 2020 2022     "auto",.    "
+0000e820: 6175 746f 7322 2c0a 2020 2020 2261 7669  autos",.    "avi
+0000e830: 616e 6361 222c 0a20 2020 2022 6177 222c  anca",.    "aw",
+0000e840: 0a20 2020 2022 6177 7322 2c0a 2020 2020  .    "aws",.    
+0000e850: 2261 7822 2c0a 2020 2020 2261 7861 222c  "ax",.    "axa",
+0000e860: 0a20 2020 2022 617a 222c 0a20 2020 2022  .    "az",.    "
+0000e870: 617a 7572 6522 2c0a 2020 2020 2320 620a  azure",.    # b.
+0000e880: 2020 2020 2262 6122 2c0a 2020 2020 2262      "ba",.    "b
+0000e890: 6162 7922 2c0a 2020 2020 2262 6169 6475  aby",.    "baidu
+0000e8a0: 222c 0a20 2020 2022 6261 6e61 6d65 7822  ",.    "banamex"
+0000e8b0: 2c0a 2020 2020 2262 616e 616e 6172 6570  ,.    "bananarep
+0000e8c0: 7562 6c69 6322 2c0a 2020 2020 2262 616e  ublic",.    "ban
+0000e8d0: 6422 2c0a 2020 2020 2262 616e 6b22 2c0a  d",.    "bank",.
+0000e8e0: 2020 2020 2262 6172 222c 0a20 2020 2022      "bar",.    "
+0000e8f0: 6261 7263 656c 6f6e 6122 2c0a 2020 2020  barcelona",.    
+0000e900: 2262 6172 636c 6179 6361 7264 222c 0a20  "barclaycard",. 
+0000e910: 2020 2022 6261 7263 6c61 7973 222c 0a20     "barclays",. 
+0000e920: 2020 2022 6261 7265 666f 6f74 222c 0a20     "barefoot",. 
+0000e930: 2020 2022 6261 7267 6169 6e73 222c 0a20     "bargains",. 
+0000e940: 2020 2022 6261 7365 6261 6c6c 222c 0a20     "baseball",. 
+0000e950: 2020 2022 6261 736b 6574 6261 6c6c 222c     "basketball",
+0000e960: 0a20 2020 2022 6261 7568 6175 7322 2c0a  .    "bauhaus",.
+0000e970: 2020 2020 2262 6179 6572 6e22 2c0a 2020      "bayern",.  
+0000e980: 2020 2262 6222 2c0a 2020 2020 2262 6263    "bb",.    "bbc
+0000e990: 222c 0a20 2020 2022 6262 7422 2c0a 2020  ",.    "bbt",.  
+0000e9a0: 2020 2262 6276 6122 2c0a 2020 2020 2262    "bbva",.    "b
+0000e9b0: 6367 222c 0a20 2020 2022 6263 6e22 2c0a  cg",.    "bcn",.
+0000e9c0: 2020 2020 2262 6422 2c0a 2020 2020 2262      "bd",.    "b
+0000e9d0: 6522 2c0a 2020 2020 2262 6561 7473 222c  e",.    "beats",
+0000e9e0: 0a20 2020 2022 6265 6175 7479 222c 0a20  .    "beauty",. 
+0000e9f0: 2020 2022 6265 6572 222c 0a20 2020 2022     "beer",.    "
+0000ea00: 6265 6e74 6c65 7922 2c0a 2020 2020 2262  bentley",.    "b
+0000ea10: 6572 6c69 6e22 2c0a 2020 2020 2262 6573  erlin",.    "bes
+0000ea20: 7422 2c0a 2020 2020 2262 6573 7462 7579  t",.    "bestbuy
+0000ea30: 222c 0a20 2020 2022 6265 7422 2c0a 2020  ",.    "bet",.  
+0000ea40: 2020 2262 6622 2c0a 2020 2020 2262 6722    "bf",.    "bg"
+0000ea50: 2c0a 2020 2020 2262 6822 2c0a 2020 2020  ,.    "bh",.    
+0000ea60: 2262 6861 7274 6922 2c0a 2020 2020 2262  "bharti",.    "b
+0000ea70: 6922 2c0a 2020 2020 2262 6962 6c65 222c  i",.    "bible",
+0000ea80: 0a20 2020 2022 6269 6422 2c0a 2020 2020  .    "bid",.    
+0000ea90: 2262 696b 6522 2c0a 2020 2020 2262 696e  "bike",.    "bin
+0000eaa0: 6722 2c0a 2020 2020 2262 696e 676f 222c  g",.    "bingo",
+0000eab0: 0a20 2020 2022 6269 6f22 2c0a 2020 2020  .    "bio",.    
+0000eac0: 2262 697a 222c 0a20 2020 2022 626a 222c  "biz",.    "bj",
+0000ead0: 0a20 2020 2022 626c 6163 6b22 2c0a 2020  .    "black",.  
+0000eae0: 2020 2262 6c61 636b 6672 6964 6179 222c    "blackfriday",
+0000eaf0: 0a20 2020 2022 626c 616e 636f 222c 0a20  .    "blanco",. 
+0000eb00: 2020 2022 626c 6f63 6b62 7573 7465 7222     "blockbuster"
+0000eb10: 2c0a 2020 2020 2262 6c6f 6722 2c0a 2020  ,.    "blog",.  
+0000eb20: 2020 2262 6c6f 6f6d 6265 7267 222c 0a20    "bloomberg",. 
+0000eb30: 2020 2022 626c 7565 222c 0a20 2020 2022     "blue",.    "
+0000eb40: 626d 222c 0a20 2020 2022 626d 7322 2c0a  bm",.    "bms",.
+0000eb50: 2020 2020 2262 6d77 222c 0a20 2020 2022      "bmw",.    "
+0000eb60: 626e 222c 0a20 2020 2022 626e 6c22 2c0a  bn",.    "bnl",.
+0000eb70: 2020 2020 2262 6e70 7061 7269 6261 7322      "bnpparibas"
+0000eb80: 2c0a 2020 2020 2262 6f22 2c0a 2020 2020  ,.    "bo",.    
+0000eb90: 2262 6f61 7473 222c 0a20 2020 2022 626f  "boats",.    "bo
+0000eba0: 6568 7269 6e67 6572 222c 0a20 2020 2022  ehringer",.    "
+0000ebb0: 626f 6661 222c 0a20 2020 2022 626f 6d22  bofa",.    "bom"
+0000ebc0: 2c0a 2020 2020 2262 6f6e 6422 2c0a 2020  ,.    "bond",.  
+0000ebd0: 2020 2262 6f6f 222c 0a20 2020 2022 626f    "boo",.    "bo
+0000ebe0: 6f6b 222c 0a20 2020 2022 626f 6f6b 696e  ok",.    "bookin
+0000ebf0: 6722 2c0a 2020 2020 2262 6f6f 7473 222c  g",.    "boots",
+0000ec00: 0a20 2020 2022 626f 7363 6822 2c0a 2020  .    "bosch",.  
+0000ec10: 2020 2262 6f73 7469 6b22 2c0a 2020 2020    "bostik",.    
+0000ec20: 2262 6f73 746f 6e22 2c0a 2020 2020 2262  "boston",.    "b
+0000ec30: 6f74 222c 0a20 2020 2022 626f 7574 6971  ot",.    "boutiq
+0000ec40: 7565 222c 0a20 2020 2022 626f 7822 2c0a  ue",.    "box",.
+0000ec50: 2020 2020 2262 7222 2c0a 2020 2020 2262      "br",.    "b
+0000ec60: 7261 6465 7363 6f22 2c0a 2020 2020 2262  radesco",.    "b
+0000ec70: 7269 6467 6573 746f 6e65 222c 0a20 2020  ridgestone",.   
+0000ec80: 2022 6272 6f61 6477 6179 222c 0a20 2020   "broadway",.   
+0000ec90: 2022 6272 6f6b 6572 222c 0a20 2020 2022   "broker",.    "
+0000eca0: 6272 6f74 6865 7222 2c0a 2020 2020 2262  brother",.    "b
+0000ecb0: 7275 7373 656c 7322 2c0a 2020 2020 2262  russels",.    "b
+0000ecc0: 7322 2c0a 2020 2020 2262 7422 2c0a 2020  s",.    "bt",.  
+0000ecd0: 2020 2262 7564 6170 6573 7422 2c0a 2020    "budapest",.  
+0000ece0: 2020 2262 7567 6174 7469 222c 0a20 2020    "bugatti",.   
+0000ecf0: 2022 6275 696c 6422 2c0a 2020 2020 2262   "build",.    "b
+0000ed00: 7569 6c64 6572 7322 2c0a 2020 2020 2262  uilders",.    "b
+0000ed10: 7573 696e 6573 7322 2c0a 2020 2020 2262  usiness",.    "b
+0000ed20: 7579 222c 0a20 2020 2022 6275 7a7a 222c  uy",.    "buzz",
+0000ed30: 0a20 2020 2022 6276 222c 0a20 2020 2022  .    "bv",.    "
+0000ed40: 6277 222c 0a20 2020 2022 6279 222c 0a20  bw",.    "by",. 
+0000ed50: 2020 2022 627a 222c 0a20 2020 2022 627a     "bz",.    "bz
+0000ed60: 6822 2c0a 2020 2020 2320 630a 2020 2020  h",.    # c.    
+0000ed70: 2263 6122 2c0a 2020 2020 2263 6162 222c  "ca",.    "cab",
+0000ed80: 0a20 2020 2022 6361 6665 222c 0a20 2020  .    "cafe",.   
+0000ed90: 2022 6361 6c22 2c0a 2020 2020 2263 616c   "cal",.    "cal
+0000eda0: 6c22 2c0a 2020 2020 2263 616c 7669 6e6b  l",.    "calvink
+0000edb0: 6c65 696e 222c 0a20 2020 2022 6361 6d22  lein",.    "cam"
+0000edc0: 2c0a 2020 2020 2263 616d 6572 6122 2c0a  ,.    "camera",.
+0000edd0: 2020 2020 2263 616d 7022 2c0a 2020 2020      "camp",.    
+0000ede0: 2263 616e 6365 7272 6573 6561 7263 6822  "cancerresearch"
+0000edf0: 2c0a 2020 2020 2263 616e 6f6e 222c 0a20  ,.    "canon",. 
+0000ee00: 2020 2022 6361 7065 746f 776e 222c 0a20     "capetown",. 
+0000ee10: 2020 2022 6361 7069 7461 6c22 2c0a 2020     "capital",.  
+0000ee20: 2020 2263 6170 6974 616c 6f6e 6522 2c0a    "capitalone",.
+0000ee30: 2020 2020 2263 6172 222c 0a20 2020 2022      "car",.    "
+0000ee40: 6361 7261 7661 6e22 2c0a 2020 2020 2263  caravan",.    "c
+0000ee50: 6172 6473 222c 0a20 2020 2022 6361 7265  ards",.    "care
+0000ee60: 222c 0a20 2020 2022 6361 7265 6572 222c  ",.    "career",
+0000ee70: 0a20 2020 2022 6361 7265 6572 7322 2c0a  .    "careers",.
+0000ee80: 2020 2020 2263 6172 7322 2c0a 2020 2020      "cars",.    
+0000ee90: 2263 6172 7469 6572 222c 0a20 2020 2022  "cartier",.    "
+0000eea0: 6361 7361 222c 0a20 2020 2022 6361 7365  casa",.    "case
+0000eeb0: 222c 0a20 2020 2022 6361 7365 6968 222c  ",.    "caseih",
+0000eec0: 0a20 2020 2022 6361 7368 222c 0a20 2020  .    "cash",.   
+0000eed0: 2022 6361 7369 6e6f 222c 0a20 2020 2022   "casino",.    "
+0000eee0: 6361 7422 2c0a 2020 2020 2263 6174 6572  cat",.    "cater
+0000eef0: 696e 6722 2c0a 2020 2020 2263 6174 686f  ing",.    "catho
+0000ef00: 6c69 6322 2c0a 2020 2020 2263 6261 222c  lic",.    "cba",
+0000ef10: 0a20 2020 2022 6362 6e22 2c0a 2020 2020  .    "cbn",.    
+0000ef20: 2263 6272 6522 2c0a 2020 2020 2263 6273  "cbre",.    "cbs
+0000ef30: 222c 0a20 2020 2022 6363 222c 0a20 2020  ",.    "cc",.   
+0000ef40: 2022 6364 222c 0a20 2020 2022 6365 6222   "cd",.    "ceb"
+0000ef50: 2c0a 2020 2020 2263 656e 7465 7222 2c0a  ,.    "center",.
+0000ef60: 2020 2020 2263 656f 222c 0a20 2020 2022      "ceo",.    "
+0000ef70: 6365 726e 222c 0a20 2020 2022 6366 222c  cern",.    "cf",
+0000ef80: 0a20 2020 2022 6366 6122 2c0a 2020 2020  .    "cfa",.    
+0000ef90: 2263 6664 222c 0a20 2020 2022 6367 222c  "cfd",.    "cg",
+0000efa0: 0a20 2020 2022 6368 222c 0a20 2020 2022  .    "ch",.    "
+0000efb0: 6368 616e 656c 222c 0a20 2020 2022 6368  chanel",.    "ch
+0000efc0: 616e 6e65 6c22 2c0a 2020 2020 2263 6861  annel",.    "cha
+0000efd0: 7365 222c 0a20 2020 2022 6368 6174 222c  se",.    "chat",
+0000efe0: 0a20 2020 2022 6368 6561 7022 2c0a 2020  .    "cheap",.  
+0000eff0: 2020 2263 6869 6e74 6169 222c 0a20 2020    "chintai",.   
+0000f000: 2022 6368 7269 7374 6d61 7322 2c0a 2020   "christmas",.  
+0000f010: 2020 2263 6872 6f6d 6522 2c0a 2020 2020    "chrome",.    
+0000f020: 2263 6872 7973 6c65 7222 2c0a 2020 2020  "chrysler",.    
+0000f030: 2263 6875 7263 6822 2c0a 2020 2020 2263  "church",.    "c
+0000f040: 6922 2c0a 2020 2020 2263 6970 7269 616e  i",.    "ciprian
+0000f050: 6922 2c0a 2020 2020 2263 6972 636c 6522  i",.    "circle"
+0000f060: 2c0a 2020 2020 2263 6973 636f 222c 0a20  ,.    "cisco",. 
+0000f070: 2020 2022 6369 7461 6465 6c22 2c0a 2020     "citadel",.  
+0000f080: 2020 2263 6974 6922 2c0a 2020 2020 2263    "citi",.    "c
+0000f090: 6974 6963 222c 0a20 2020 2022 6369 7479  itic",.    "city
+0000f0a0: 222c 0a20 2020 2022 6369 7479 6561 7473  ",.    "cityeats
+0000f0b0: 222c 0a20 2020 2022 636b 222c 0a20 2020  ",.    "ck",.   
+0000f0c0: 2022 636c 222c 0a20 2020 2022 636c 6169   "cl",.    "clai
+0000f0d0: 6d73 222c 0a20 2020 2022 636c 6561 6e69  ms",.    "cleani
+0000f0e0: 6e67 222c 0a20 2020 2022 636c 6963 6b22  ng",.    "click"
+0000f0f0: 2c0a 2020 2020 2263 6c69 6e69 6322 2c0a  ,.    "clinic",.
+0000f100: 2020 2020 2263 6c69 6e69 7175 6522 2c0a      "clinique",.
+0000f110: 2020 2020 2263 6c6f 7468 696e 6722 2c0a      "clothing",.
+0000f120: 2020 2020 2263 6c6f 7564 222c 0a20 2020      "cloud",.   
+0000f130: 2022 636c 7562 222c 0a20 2020 2022 636c   "club",.    "cl
+0000f140: 7562 6d65 6422 2c0a 2020 2020 2263 6d22  ubmed",.    "cm"
+0000f150: 2c0a 2020 2020 2263 6e22 2c0a 2020 2020  ,.    "cn",.    
+0000f160: 2263 6f22 2c0a 2020 2020 2263 6f61 6368  "co",.    "coach
+0000f170: 222c 0a20 2020 2022 636f 6465 7322 2c0a  ",.    "codes",.
+0000f180: 2020 2020 2263 6f66 6665 6522 2c0a 2020      "coffee",.  
+0000f190: 2020 2263 6f6c 6c65 6765 222c 0a20 2020    "college",.   
+0000f1a0: 2022 636f 6c6f 676e 6522 2c0a 2020 2020   "cologne",.    
+0000f1b0: 2263 6f6d 222c 0a20 2020 2022 636f 6d63  "com",.    "comc
+0000f1c0: 6173 7422 2c0a 2020 2020 2263 6f6d 6d62  ast",.    "commb
+0000f1d0: 616e 6b22 2c0a 2020 2020 2263 6f6d 6d75  ank",.    "commu
+0000f1e0: 6e69 7479 222c 0a20 2020 2022 636f 6d70  nity",.    "comp
+0000f1f0: 616e 7922 2c0a 2020 2020 2263 6f6d 7061  any",.    "compa
+0000f200: 7265 222c 0a20 2020 2022 636f 6d70 7574  re",.    "comput
+0000f210: 6572 222c 0a20 2020 2022 636f 6d73 6563  er",.    "comsec
+0000f220: 222c 0a20 2020 2022 636f 6e64 6f73 222c  ",.    "condos",
+0000f230: 0a20 2020 2022 636f 6e73 7472 7563 7469  .    "constructi
+0000f240: 6f6e 222c 0a20 2020 2022 636f 6e73 756c  on",.    "consul
+0000f250: 7469 6e67 222c 0a20 2020 2022 636f 6e74  ting",.    "cont
+0000f260: 6163 7422 2c0a 2020 2020 2263 6f6e 7472  act",.    "contr
+0000f270: 6163 746f 7273 222c 0a20 2020 2022 636f  actors",.    "co
+0000f280: 6f6b 696e 6722 2c0a 2020 2020 2263 6f6f  oking",.    "coo
+0000f290: 6b69 6e67 6368 616e 6e65 6c22 2c0a 2020  kingchannel",.  
+0000f2a0: 2020 2263 6f6f 6c22 2c0a 2020 2020 2263    "cool",.    "c
+0000f2b0: 6f6f 7022 2c0a 2020 2020 2263 6f72 7369  oop",.    "corsi
+0000f2c0: 6361 222c 0a20 2020 2022 636f 756e 7472  ca",.    "countr
+0000f2d0: 7922 2c0a 2020 2020 2263 6f75 706f 6e22  y",.    "coupon"
+0000f2e0: 2c0a 2020 2020 2263 6f75 706f 6e73 222c  ,.    "coupons",
+0000f2f0: 0a20 2020 2022 636f 7572 7365 7322 2c0a  .    "courses",.
+0000f300: 2020 2020 2263 7222 2c0a 2020 2020 2263      "cr",.    "c
+0000f310: 7265 6469 7422 2c0a 2020 2020 2263 7265  redit",.    "cre
+0000f320: 6469 7463 6172 6422 2c0a 2020 2020 2263  ditcard",.    "c
+0000f330: 7265 6469 7475 6e69 6f6e 222c 0a20 2020  reditunion",.   
+0000f340: 2022 6372 6963 6b65 7422 2c0a 2020 2020   "cricket",.    
+0000f350: 2263 726f 776e 222c 0a20 2020 2022 6372  "crown",.    "cr
+0000f360: 7322 2c0a 2020 2020 2263 7275 6973 6522  s",.    "cruise"
+0000f370: 2c0a 2020 2020 2263 7275 6973 6573 222c  ,.    "cruises",
+0000f380: 0a20 2020 2022 6373 6322 2c0a 2020 2020  .    "csc",.    
+0000f390: 2263 7522 2c0a 2020 2020 2263 7569 7369  "cu",.    "cuisi
+0000f3a0: 6e65 6c6c 6122 2c0a 2020 2020 2263 7622  nella",.    "cv"
+0000f3b0: 2c0a 2020 2020 2263 7722 2c0a 2020 2020  ,.    "cw",.    
+0000f3c0: 2263 7822 2c0a 2020 2020 2263 7922 2c0a  "cx",.    "cy",.
+0000f3d0: 2020 2020 2263 796d 7275 222c 0a20 2020      "cymru",.   
+0000f3e0: 2022 6379 6f75 222c 0a20 2020 2022 637a   "cyou",.    "cz
+0000f3f0: 222c 0a20 2020 2023 2064 0a20 2020 2022  ",.    # d.    "
+0000f400: 6461 6275 7222 2c0a 2020 2020 2264 6164  dabur",.    "dad
+0000f410: 222c 0a20 2020 2022 6461 6e63 6522 2c0a  ",.    "dance",.
+0000f420: 2020 2020 2264 6174 6122 2c0a 2020 2020      "data",.    
+0000f430: 2264 6174 6522 2c0a 2020 2020 2264 6174  "date",.    "dat
+0000f440: 696e 6722 2c0a 2020 2020 2264 6174 7375  ing",.    "datsu
+0000f450: 6e22 2c0a 2020 2020 2264 6179 222c 0a20  n",.    "day",. 
+0000f460: 2020 2022 6463 6c6b 222c 0a20 2020 2022     "dclk",.    "
+0000f470: 6464 7322 2c0a 2020 2020 2264 6522 2c0a  dds",.    "de",.
+0000f480: 2020 2020 2264 6561 6c22 2c0a 2020 2020      "deal",.    
+0000f490: 2264 6561 6c65 7222 2c0a 2020 2020 2264  "dealer",.    "d
+0000f4a0: 6561 6c73 222c 0a20 2020 2022 6465 6772  eals",.    "degr
+0000f4b0: 6565 222c 0a20 2020 2022 6465 6c69 7665  ee",.    "delive
+0000f4c0: 7279 222c 0a20 2020 2022 6465 6c6c 222c  ry",.    "dell",
+0000f4d0: 0a20 2020 2022 6465 6c6f 6974 7465 222c  .    "deloitte",
+0000f4e0: 0a20 2020 2022 6465 6c74 6122 2c0a 2020  .    "delta",.  
+0000f4f0: 2020 2264 656d 6f63 7261 7422 2c0a 2020    "democrat",.  
+0000f500: 2020 2264 656e 7461 6c22 2c0a 2020 2020    "dental",.    
+0000f510: 2264 656e 7469 7374 222c 0a20 2020 2022  "dentist",.    "
+0000f520: 6465 7369 222c 0a20 2020 2022 6465 7369  desi",.    "desi
+0000f530: 676e 222c 0a20 2020 2022 6465 7622 2c0a  gn",.    "dev",.
+0000f540: 2020 2020 2264 686c 222c 0a20 2020 2022      "dhl",.    "
+0000f550: 6469 616d 6f6e 6473 222c 0a20 2020 2022  diamonds",.    "
+0000f560: 6469 6574 222c 0a20 2020 2022 6469 6769  diet",.    "digi
+0000f570: 7461 6c22 2c0a 2020 2020 2264 6972 6563  tal",.    "direc
+0000f580: 7422 2c0a 2020 2020 2264 6972 6563 746f  t",.    "directo
+0000f590: 7279 222c 0a20 2020 2022 6469 7363 6f75  ry",.    "discou
+0000f5a0: 6e74 222c 0a20 2020 2022 6469 7363 6f76  nt",.    "discov
+0000f5b0: 6572 222c 0a20 2020 2022 6469 7368 222c  er",.    "dish",
+0000f5c0: 0a20 2020 2022 6469 7922 2c0a 2020 2020  .    "diy",.    
+0000f5d0: 2264 6a22 2c0a 2020 2020 2264 6b22 2c0a  "dj",.    "dk",.
+0000f5e0: 2020 2020 2264 6d22 2c0a 2020 2020 2264      "dm",.    "d
+0000f5f0: 6e70 222c 0a20 2020 2022 646f 222c 0a20  np",.    "do",. 
+0000f600: 2020 2022 646f 6373 222c 0a20 2020 2022     "docs",.    "
+0000f610: 646f 6374 6f72 222c 0a20 2020 2022 646f  doctor",.    "do
+0000f620: 6467 6522 2c0a 2020 2020 2264 6f67 222c  dge",.    "dog",
+0000f630: 0a20 2020 2022 646f 6861 222c 0a20 2020  .    "doha",.   
+0000f640: 2022 646f 6d61 696e 7322 2c0a 2020 2020   "domains",.    
+0000f650: 2264 6f74 222c 0a20 2020 2022 646f 776e  "dot",.    "down
+0000f660: 6c6f 6164 222c 0a20 2020 2022 6472 6976  load",.    "driv
+0000f670: 6522 2c0a 2020 2020 2264 7476 222c 0a20  e",.    "dtv",. 
+0000f680: 2020 2022 6475 6261 6922 2c0a 2020 2020     "dubai",.    
+0000f690: 2264 7563 6b22 2c0a 2020 2020 2264 756e  "duck",.    "dun
+0000f6a0: 6c6f 7022 2c0a 2020 2020 2264 756e 7322  lop",.    "duns"
+0000f6b0: 2c0a 2020 2020 2264 7570 6f6e 7422 2c0a  ,.    "dupont",.
+0000f6c0: 2020 2020 2264 7572 6261 6e22 2c0a 2020      "durban",.  
+0000f6d0: 2020 2264 7661 6722 2c0a 2020 2020 2264    "dvag",.    "d
+0000f6e0: 7672 222c 0a20 2020 2022 647a 222c 0a20  vr",.    "dz",. 
+0000f6f0: 2020 2023 2065 0a20 2020 2022 6561 7274     # e.    "eart
+0000f700: 6822 2c0a 2020 2020 2265 6174 222c 0a20  h",.    "eat",. 
+0000f710: 2020 2022 6563 222c 0a20 2020 2022 6563     "ec",.    "ec
+0000f720: 6f22 2c0a 2020 2020 2265 6465 6b61 222c  o",.    "edeka",
+0000f730: 0a20 2020 2022 6564 7522 2c0a 2020 2020  .    "edu",.    
+0000f740: 2265 6475 6361 7469 6f6e 222c 0a20 2020  "education",.   
+0000f750: 2022 6565 222c 0a20 2020 2022 6567 222c   "ee",.    "eg",
+0000f760: 0a20 2020 2022 656d 6169 6c22 2c0a 2020  .    "email",.  
+0000f770: 2020 2265 6d65 7263 6b22 2c0a 2020 2020    "emerck",.    
+0000f780: 2265 6e65 7267 7922 2c0a 2020 2020 2265  "energy",.    "e
+0000f790: 6e67 696e 6565 7222 2c0a 2020 2020 2265  ngineer",.    "e
+0000f7a0: 6e67 696e 6565 7269 6e67 222c 0a20 2020  ngineering",.   
+0000f7b0: 2022 656e 7465 7270 7269 7365 7322 2c0a   "enterprises",.
+0000f7c0: 2020 2020 2265 706f 7374 222c 0a20 2020      "epost",.   
+0000f7d0: 2022 6570 736f 6e22 2c0a 2020 2020 2265   "epson",.    "e
+0000f7e0: 7175 6970 6d65 6e74 222c 0a20 2020 2022  quipment",.    "
+0000f7f0: 6572 222c 0a20 2020 2022 6572 6963 7373  er",.    "ericss
+0000f800: 6f6e 222c 0a20 2020 2022 6572 6e69 222c  on",.    "erni",
+0000f810: 0a20 2020 2022 6573 222c 0a20 2020 2022  .    "es",.    "
+0000f820: 6573 7122 2c0a 2020 2020 2265 7374 6174  esq",.    "estat
+0000f830: 6522 2c0a 2020 2020 2265 7375 7261 6e63  e",.    "esuranc
+0000f840: 6522 2c0a 2020 2020 2265 7422 2c0a 2020  e",.    "et",.  
+0000f850: 2020 2265 7469 7361 6c61 7422 2c0a 2020    "etisalat",.  
+0000f860: 2020 2265 7522 2c0a 2020 2020 2265 7572    "eu",.    "eur
+0000f870: 6f76 6973 696f 6e22 2c0a 2020 2020 2265  ovision",.    "e
+0000f880: 7573 222c 0a20 2020 2022 6576 656e 7473  us",.    "events
+0000f890: 222c 0a20 2020 2022 6576 6572 6261 6e6b  ",.    "everbank
+0000f8a0: 222c 0a20 2020 2022 6578 6368 616e 6765  ",.    "exchange
+0000f8b0: 222c 0a20 2020 2022 6578 7065 7274 222c  ",.    "expert",
+0000f8c0: 0a20 2020 2022 6578 706f 7365 6422 2c0a  .    "exposed",.
+0000f8d0: 2020 2020 2265 7870 7265 7373 222c 0a20      "express",. 
+0000f8e0: 2020 2022 6578 7472 6173 7061 6365 222c     "extraspace",
+0000f8f0: 0a20 2020 2023 2066 0a20 2020 2022 6661  .    # f.    "fa
+0000f900: 6765 222c 0a20 2020 2022 6661 696c 222c  ge",.    "fail",
+0000f910: 0a20 2020 2022 6661 6972 7769 6e64 7322  .    "fairwinds"
+0000f920: 2c0a 2020 2020 2266 6169 7468 222c 0a20  ,.    "faith",. 
+0000f930: 2020 2022 6661 6d69 6c79 222c 0a20 2020     "family",.   
+0000f940: 2022 6661 6e22 2c0a 2020 2020 2266 616e   "fan",.    "fan
+0000f950: 7322 2c0a 2020 2020 2266 6172 6d22 2c0a  s",.    "farm",.
+0000f960: 2020 2020 2266 6172 6d65 7273 222c 0a20      "farmers",. 
+0000f970: 2020 2022 6661 7368 696f 6e22 2c0a 2020     "fashion",.  
+0000f980: 2020 2266 6173 7422 2c0a 2020 2020 2266    "fast",.    "f
+0000f990: 6564 6578 222c 0a20 2020 2022 6665 6564  edex",.    "feed
+0000f9a0: 6261 636b 222c 0a20 2020 2022 6665 7272  back",.    "ferr
+0000f9b0: 6172 6922 2c0a 2020 2020 2266 6572 7265  ari",.    "ferre
+0000f9c0: 726f 222c 0a20 2020 2022 6669 222c 0a20  ro",.    "fi",. 
+0000f9d0: 2020 2022 6669 6174 222c 0a20 2020 2022     "fiat",.    "
+0000f9e0: 6669 6465 6c69 7479 222c 0a20 2020 2022  fidelity",.    "
+0000f9f0: 6669 646f 222c 0a20 2020 2022 6669 6c6d  fido",.    "film
+0000fa00: 222c 0a20 2020 2022 6669 6e61 6c22 2c0a  ",.    "final",.
+0000fa10: 2020 2020 2266 696e 616e 6365 222c 0a20      "finance",. 
+0000fa20: 2020 2022 6669 6e61 6e63 6961 6c22 2c0a     "financial",.
+0000fa30: 2020 2020 2266 6972 6522 2c0a 2020 2020      "fire",.    
+0000fa40: 2266 6972 6573 746f 6e65 222c 0a20 2020  "firestone",.   
+0000fa50: 2022 6669 726d 6461 6c65 222c 0a20 2020   "firmdale",.   
+0000fa60: 2022 6669 7368 222c 0a20 2020 2022 6669   "fish",.    "fi
+0000fa70: 7368 696e 6722 2c0a 2020 2020 2266 6974  shing",.    "fit
+0000fa80: 222c 0a20 2020 2022 6669 746e 6573 7322  ",.    "fitness"
+0000fa90: 2c0a 2020 2020 2266 6a22 2c0a 2020 2020  ,.    "fj",.    
+0000faa0: 2266 6b22 2c0a 2020 2020 2266 6c69 636b  "fk",.    "flick
+0000fab0: 7222 2c0a 2020 2020 2266 6c69 6768 7473  r",.    "flights
+0000fac0: 222c 0a20 2020 2022 666c 6972 222c 0a20  ",.    "flir",. 
+0000fad0: 2020 2022 666c 6f72 6973 7422 2c0a 2020     "florist",.  
+0000fae0: 2020 2266 6c6f 7765 7273 222c 0a20 2020    "flowers",.   
+0000faf0: 2022 666c 7922 2c0a 2020 2020 2266 6d22   "fly",.    "fm"
+0000fb00: 2c0a 2020 2020 2266 6f22 2c0a 2020 2020  ,.    "fo",.    
+0000fb10: 2266 6f6f 222c 0a20 2020 2022 666f 6f64  "foo",.    "food
+0000fb20: 222c 0a20 2020 2022 666f 6f64 6e65 7477  ",.    "foodnetw
+0000fb30: 6f72 6b22 2c0a 2020 2020 2266 6f6f 7462  ork",.    "footb
+0000fb40: 616c 6c22 2c0a 2020 2020 2266 6f72 6422  all",.    "ford"
+0000fb50: 2c0a 2020 2020 2266 6f72 6578 222c 0a20  ,.    "forex",. 
+0000fb60: 2020 2022 666f 7273 616c 6522 2c0a 2020     "forsale",.  
+0000fb70: 2020 2266 6f72 756d 222c 0a20 2020 2022    "forum",.    "
+0000fb80: 666f 756e 6461 7469 6f6e 222c 0a20 2020  foundation",.   
+0000fb90: 2022 666f 7822 2c0a 2020 2020 2266 7222   "fox",.    "fr"
+0000fba0: 2c0a 2020 2020 2266 7265 6522 2c0a 2020  ,.    "free",.  
+0000fbb0: 2020 2266 7265 7365 6e69 7573 222c 0a20    "fresenius",. 
+0000fbc0: 2020 2022 6672 6c22 2c0a 2020 2020 2266     "frl",.    "f
+0000fbd0: 726f 6761 6e73 222c 0a20 2020 2022 6672  rogans",.    "fr
+0000fbe0: 6f6e 7464 6f6f 7222 2c0a 2020 2020 2266  ontdoor",.    "f
+0000fbf0: 726f 6e74 6965 7222 2c0a 2020 2020 2266  rontier",.    "f
+0000fc00: 7472 222c 0a20 2020 2022 6675 6a69 7473  tr",.    "fujits
+0000fc10: 7522 2c0a 2020 2020 2266 756a 6978 6572  u",.    "fujixer
+0000fc20: 6f78 222c 0a20 2020 2022 6675 6e22 2c0a  ox",.    "fun",.
+0000fc30: 2020 2020 2266 756e 6422 2c0a 2020 2020      "fund",.    
+0000fc40: 2266 7572 6e69 7475 7265 222c 0a20 2020  "furniture",.   
+0000fc50: 2022 6675 7462 6f6c 222c 0a20 2020 2022   "futbol",.    "
+0000fc60: 6679 6922 2c0a 2020 2020 2320 670a 2020  fyi",.    # g.  
+0000fc70: 2020 2267 6122 2c0a 2020 2020 2267 616c    "ga",.    "gal
+0000fc80: 222c 0a20 2020 2022 6761 6c6c 6572 7922  ",.    "gallery"
+0000fc90: 2c0a 2020 2020 2267 616c 6c6f 222c 0a20  ,.    "gallo",. 
+0000fca0: 2020 2022 6761 6c6c 7570 222c 0a20 2020     "gallup",.   
+0000fcb0: 2022 6761 6d65 222c 0a20 2020 2022 6761   "game",.    "ga
+0000fcc0: 6d65 7322 2c0a 2020 2020 2267 6170 222c  mes",.    "gap",
+0000fcd0: 0a20 2020 2022 6761 7264 656e 222c 0a20  .    "garden",. 
+0000fce0: 2020 2022 6762 222c 0a20 2020 2022 6762     "gb",.    "gb
+0000fcf0: 697a 222c 0a20 2020 2022 6764 222c 0a20  iz",.    "gd",. 
+0000fd00: 2020 2022 6764 6e22 2c0a 2020 2020 2267     "gdn",.    "g
+0000fd10: 6522 2c0a 2020 2020 2267 6561 222c 0a20  e",.    "gea",. 
+0000fd20: 2020 2022 6765 6e74 222c 0a20 2020 2022     "gent",.    "
+0000fd30: 6765 6e74 696e 6722 2c0a 2020 2020 2267  genting",.    "g
+0000fd40: 656f 7267 6522 2c0a 2020 2020 2267 6622  eorge",.    "gf"
+0000fd50: 2c0a 2020 2020 2267 6722 2c0a 2020 2020  ,.    "gg",.    
+0000fd60: 2267 6765 6522 2c0a 2020 2020 2267 6822  "ggee",.    "gh"
+0000fd70: 2c0a 2020 2020 2267 6922 2c0a 2020 2020  ,.    "gi",.    
+0000fd80: 2267 6966 7422 2c0a 2020 2020 2267 6966  "gift",.    "gif
+0000fd90: 7473 222c 0a20 2020 2022 6769 7665 7322  ts",.    "gives"
+0000fda0: 2c0a 2020 2020 2267 6976 696e 6722 2c0a  ,.    "giving",.
+0000fdb0: 2020 2020 2267 6c22 2c0a 2020 2020 2267      "gl",.    "g
+0000fdc0: 6c61 6465 222c 0a20 2020 2022 676c 6173  lade",.    "glas
+0000fdd0: 7322 2c0a 2020 2020 2267 6c65 222c 0a20  s",.    "gle",. 
+0000fde0: 2020 2022 676c 6f62 616c 222c 0a20 2020     "global",.   
+0000fdf0: 2022 676c 6f62 6f22 2c0a 2020 2020 2267   "globo",.    "g
+0000fe00: 6d22 2c0a 2020 2020 2267 6d61 696c 222c  m",.    "gmail",
+0000fe10: 0a20 2020 2022 676d 6268 222c 0a20 2020  .    "gmbh",.   
+0000fe20: 2022 676d 6f22 2c0a 2020 2020 2267 6d78   "gmo",.    "gmx
+0000fe30: 222c 0a20 2020 2022 676e 222c 0a20 2020  ",.    "gn",.   
+0000fe40: 2022 676f 6461 6464 7922 2c0a 2020 2020   "godaddy",.    
+0000fe50: 2267 6f6c 6422 2c0a 2020 2020 2267 6f6c  "gold",.    "gol
+0000fe60: 6470 6f69 6e74 222c 0a20 2020 2022 676f  dpoint",.    "go
+0000fe70: 6c66 222c 0a20 2020 2022 676f 6f22 2c0a  lf",.    "goo",.
+0000fe80: 2020 2020 2267 6f6f 6468 616e 6473 222c      "goodhands",
+0000fe90: 0a20 2020 2022 676f 6f64 7965 6172 222c  .    "goodyear",
+0000fea0: 0a20 2020 2022 676f 6f67 222c 0a20 2020  .    "goog",.   
+0000feb0: 2022 676f 6f67 6c65 222c 0a20 2020 2022   "google",.    "
+0000fec0: 676f 7022 2c0a 2020 2020 2267 6f74 222c  gop",.    "got",
+0000fed0: 0a20 2020 2022 676f 7622 2c0a 2020 2020  .    "gov",.    
+0000fee0: 2267 7022 2c0a 2020 2020 2267 7122 2c0a  "gp",.    "gq",.
+0000fef0: 2020 2020 2267 7222 2c0a 2020 2020 2267      "gr",.    "g
+0000ff00: 7261 696e 6765 7222 2c0a 2020 2020 2267  rainger",.    "g
+0000ff10: 7261 7068 6963 7322 2c0a 2020 2020 2267  raphics",.    "g
+0000ff20: 7261 7469 7322 2c0a 2020 2020 2267 7265  ratis",.    "gre
+0000ff30: 656e 222c 0a20 2020 2022 6772 6970 6522  en",.    "gripe"
+0000ff40: 2c0a 2020 2020 2267 726f 6365 7279 222c  ,.    "grocery",
+0000ff50: 0a20 2020 2022 6772 6f75 7022 2c0a 2020  .    "group",.  
+0000ff60: 2020 2267 7322 2c0a 2020 2020 2267 7422    "gs",.    "gt"
+0000ff70: 2c0a 2020 2020 2267 7522 2c0a 2020 2020  ,.    "gu",.    
+0000ff80: 2267 7561 7264 6961 6e22 2c0a 2020 2020  "guardian",.    
+0000ff90: 2267 7563 6369 222c 0a20 2020 2022 6775  "gucci",.    "gu
+0000ffa0: 6765 222c 0a20 2020 2022 6775 6964 6522  ge",.    "guide"
+0000ffb0: 2c0a 2020 2020 2267 7569 7461 7273 222c  ,.    "guitars",
+0000ffc0: 0a20 2020 2022 6775 7275 222c 0a20 2020  .    "guru",.   
+0000ffd0: 2022 6777 222c 0a20 2020 2022 6779 222c   "gw",.    "gy",
+0000ffe0: 0a20 2020 2023 2068 0a20 2020 2022 6861  .    # h.    "ha
+0000fff0: 6972 222c 0a20 2020 2022 6861 6d62 7572  ir",.    "hambur
+00010000: 6722 2c0a 2020 2020 2268 616e 676f 7574  g",.    "hangout
+00010010: 222c 0a20 2020 2022 6861 7573 222c 0a20  ",.    "haus",. 
+00010020: 2020 2022 6862 6f22 2c0a 2020 2020 2268     "hbo",.    "h
+00010030: 6466 6322 2c0a 2020 2020 2268 6466 6362  dfc",.    "hdfcb
+00010040: 616e 6b22 2c0a 2020 2020 2268 6561 6c74  ank",.    "healt
+00010050: 6822 2c0a 2020 2020 2268 6561 6c74 6863  h",.    "healthc
+00010060: 6172 6522 2c0a 2020 2020 2268 656c 7022  are",.    "help"
+00010070: 2c0a 2020 2020 2268 656c 7369 6e6b 6922  ,.    "helsinki"
+00010080: 2c0a 2020 2020 2268 6572 6522 2c0a 2020  ,.    "here",.  
+00010090: 2020 2268 6572 6d65 7322 2c0a 2020 2020    "hermes",.    
+000100a0: 2268 6774 7622 2c0a 2020 2020 2268 6970  "hgtv",.    "hip
+000100b0: 686f 7022 2c0a 2020 2020 2268 6973 616d  hop",.    "hisam
+000100c0: 6974 7375 222c 0a20 2020 2022 6869 7461  itsu",.    "hita
+000100d0: 6368 6922 2c0a 2020 2020 2268 6976 222c  chi",.    "hiv",
+000100e0: 0a20 2020 2022 686b 222c 0a20 2020 2022  .    "hk",.    "
+000100f0: 686b 7422 2c0a 2020 2020 2268 6d22 2c0a  hkt",.    "hm",.
+00010100: 2020 2020 2268 6e22 2c0a 2020 2020 2268      "hn",.    "h
+00010110: 6f63 6b65 7922 2c0a 2020 2020 2268 6f6c  ockey",.    "hol
+00010120: 6469 6e67 7322 2c0a 2020 2020 2268 6f6c  dings",.    "hol
+00010130: 6964 6179 222c 0a20 2020 2022 686f 6d65  iday",.    "home
+00010140: 6465 706f 7422 2c0a 2020 2020 2268 6f6d  depot",.    "hom
+00010150: 6567 6f6f 6473 222c 0a20 2020 2022 686f  egoods",.    "ho
+00010160: 6d65 7322 2c0a 2020 2020 2268 6f6d 6573  mes",.    "homes
+00010170: 656e 7365 222c 0a20 2020 2022 686f 6e64  ense",.    "hond
+00010180: 6122 2c0a 2020 2020 2268 6f6e 6579 7765  a",.    "honeywe
+00010190: 6c6c 222c 0a20 2020 2022 686f 7273 6522  ll",.    "horse"
+000101a0: 2c0a 2020 2020 2268 6f73 7069 7461 6c22  ,.    "hospital"
+000101b0: 2c0a 2020 2020 2268 6f73 7422 2c0a 2020  ,.    "host",.  
+000101c0: 2020 2268 6f73 7469 6e67 222c 0a20 2020    "hosting",.   
+000101d0: 2022 686f 7422 2c0a 2020 2020 2268 6f74   "hot",.    "hot
+000101e0: 656c 6573 222c 0a20 2020 2022 686f 7465  eles",.    "hote
+000101f0: 6c73 222c 0a20 2020 2022 686f 746d 6169  ls",.    "hotmai
+00010200: 6c22 2c0a 2020 2020 2268 6f75 7365 222c  l",.    "house",
+00010210: 0a20 2020 2022 686f 7722 2c0a 2020 2020  .    "how",.    
+00010220: 2268 7222 2c0a 2020 2020 2268 7362 6322  "hr",.    "hsbc"
+00010230: 2c0a 2020 2020 2268 7422 2c0a 2020 2020  ,.    "ht",.    
+00010240: 2268 7522 2c0a 2020 2020 2268 7567 6865  "hu",.    "hughe
+00010250: 7322 2c0a 2020 2020 2268 7961 7474 222c  s",.    "hyatt",
+00010260: 0a20 2020 2022 6879 756e 6461 6922 2c0a  .    "hyundai",.
+00010270: 2020 2020 2320 690a 2020 2020 2269 626d      # i.    "ibm
+00010280: 222c 0a20 2020 2022 6963 6263 222c 0a20  ",.    "icbc",. 
+00010290: 2020 2022 6963 6522 2c0a 2020 2020 2269     "ice",.    "i
+000102a0: 6375 222c 0a20 2020 2022 6964 222c 0a20  cu",.    "id",. 
+000102b0: 2020 2022 6965 222c 0a20 2020 2022 6965     "ie",.    "ie
+000102c0: 6565 222c 0a20 2020 2022 6966 6d22 2c0a  ee",.    "ifm",.
+000102d0: 2020 2020 2269 6b61 6e6f 222c 0a20 2020      "ikano",.   
+000102e0: 2022 696c 222c 0a20 2020 2022 696d 222c   "il",.    "im",
+000102f0: 0a20 2020 2022 696d 616d 6174 222c 0a20  .    "imamat",. 
+00010300: 2020 2022 696d 6462 222c 0a20 2020 2022     "imdb",.    "
+00010310: 696d 6d6f 222c 0a20 2020 2022 696d 6d6f  immo",.    "immo
+00010320: 6269 6c69 656e 222c 0a20 2020 2022 696e  bilien",.    "in
+00010330: 222c 0a20 2020 2022 696e 6475 7374 7269  ",.    "industri
+00010340: 6573 222c 0a20 2020 2022 696e 6669 6e69  es",.    "infini
+00010350: 7469 222c 0a20 2020 2022 696e 666f 222c  ti",.    "info",
+00010360: 0a20 2020 2022 696e 6722 2c0a 2020 2020  .    "ing",.    
+00010370: 2269 6e6b 222c 0a20 2020 2022 696e 7374  "ink",.    "inst
+00010380: 6974 7574 6522 2c0a 2020 2020 2269 6e73  itute",.    "ins
+00010390: 7572 616e 6365 222c 0a20 2020 2022 696e  urance",.    "in
+000103a0: 7375 7265 222c 0a20 2020 2022 696e 7422  sure",.    "int"
+000103b0: 2c0a 2020 2020 2269 6e74 656c 222c 0a20  ,.    "intel",. 
+000103c0: 2020 2022 696e 7465 726e 6174 696f 6e61     "internationa
+000103d0: 6c22 2c0a 2020 2020 2269 6e74 7569 7422  l",.    "intuit"
+000103e0: 2c0a 2020 2020 2269 6e76 6573 746d 656e  ,.    "investmen
+000103f0: 7473 222c 0a20 2020 2022 696f 222c 0a20  ts",.    "io",. 
+00010400: 2020 2022 6970 6972 616e 6761 222c 0a20     "ipiranga",. 
+00010410: 2020 2022 6971 222c 0a20 2020 2022 6972     "iq",.    "ir
+00010420: 222c 0a20 2020 2022 6972 6973 6822 2c0a  ",.    "irish",.
+00010430: 2020 2020 2269 7322 2c0a 2020 2020 2269      "is",.    "i
+00010440: 7365 6c65 6374 222c 0a20 2020 2022 6973  select",.    "is
+00010450: 6d61 696c 6922 2c0a 2020 2020 2269 7374  maili",.    "ist
+00010460: 222c 0a20 2020 2022 6973 7461 6e62 756c  ",.    "istanbul
+00010470: 222c 0a20 2020 2022 6974 222c 0a20 2020  ",.    "it",.   
+00010480: 2022 6974 6175 222c 0a20 2020 2022 6974   "itau",.    "it
+00010490: 7622 2c0a 2020 2020 2269 7665 636f 222c  v",.    "iveco",
+000104a0: 0a20 2020 2022 6977 6322 2c0a 2020 2020  .    "iwc",.    
+000104b0: 2320 6a0a 2020 2020 226a 6167 7561 7222  # j.    "jaguar"
+000104c0: 2c0a 2020 2020 226a 6176 6122 2c0a 2020  ,.    "java",.  
+000104d0: 2020 226a 6362 222c 0a20 2020 2022 6a63    "jcb",.    "jc
+000104e0: 7022 2c0a 2020 2020 226a 6522 2c0a 2020  p",.    "je",.  
+000104f0: 2020 226a 6565 7022 2c0a 2020 2020 226a    "jeep",.    "j
+00010500: 6574 7a74 222c 0a20 2020 2022 6a65 7765  etzt",.    "jewe
+00010510: 6c72 7922 2c0a 2020 2020 226a 696f 222c  lry",.    "jio",
+00010520: 0a20 2020 2022 6a6c 6322 2c0a 2020 2020  .    "jlc",.    
+00010530: 226a 6c6c 222c 0a20 2020 2022 6a6d 222c  "jll",.    "jm",
+00010540: 0a20 2020 2022 6a6d 7022 2c0a 2020 2020  .    "jmp",.    
+00010550: 226a 6e6a 222c 0a20 2020 2022 6a6f 222c  "jnj",.    "jo",
+00010560: 0a20 2020 2022 6a6f 6273 222c 0a20 2020  .    "jobs",.   
+00010570: 2022 6a6f 6275 7267 222c 0a20 2020 2022   "joburg",.    "
+00010580: 6a6f 7422 2c0a 2020 2020 226a 6f79 222c  jot",.    "joy",
+00010590: 0a20 2020 2022 6a70 222c 0a20 2020 2022  .    "jp",.    "
+000105a0: 6a70 6d6f 7267 616e 222c 0a20 2020 2022  jpmorgan",.    "
+000105b0: 6a70 7273 222c 0a20 2020 2022 6a75 6567  jprs",.    "jueg
+000105c0: 6f73 222c 0a20 2020 2022 6a75 6e69 7065  os",.    "junipe
+000105d0: 7222 2c0a 2020 2020 2320 6b0a 2020 2020  r",.    # k.    
+000105e0: 226b 6175 6665 6e22 2c0a 2020 2020 226b  "kaufen",.    "k
+000105f0: 6464 6922 2c0a 2020 2020 226b 6522 2c0a  ddi",.    "ke",.
+00010600: 2020 2020 226b 6572 7279 686f 7465 6c73      "kerryhotels
+00010610: 222c 0a20 2020 2022 6b65 7272 796c 6f67  ",.    "kerrylog
+00010620: 6973 7469 6373 222c 0a20 2020 2022 6b65  istics",.    "ke
+00010630: 7272 7970 726f 7065 7274 6965 7322 2c0a  rryproperties",.
+00010640: 2020 2020 226b 6668 222c 0a20 2020 2022      "kfh",.    "
+00010650: 6b67 222c 0a20 2020 2022 6b68 222c 0a20  kg",.    "kh",. 
+00010660: 2020 2022 6b69 222c 0a20 2020 2022 6b69     "ki",.    "ki
+00010670: 6122 2c0a 2020 2020 226b 696d 222c 0a20  a",.    "kim",. 
+00010680: 2020 2022 6b69 6e64 6572 222c 0a20 2020     "kinder",.   
+00010690: 2022 6b69 6e64 6c65 222c 0a20 2020 2022   "kindle",.    "
+000106a0: 6b69 7463 6865 6e22 2c0a 2020 2020 226b  kitchen",.    "k
+000106b0: 6977 6922 2c0a 2020 2020 226b 6d22 2c0a  iwi",.    "km",.
+000106c0: 2020 2020 226b 6e22 2c0a 2020 2020 226b      "kn",.    "k
+000106d0: 6f65 6c6e 222c 0a20 2020 2022 6b6f 6d61  oeln",.    "koma
+000106e0: 7473 7522 2c0a 2020 2020 226b 6f73 6865  tsu",.    "koshe
+000106f0: 7222 2c0a 2020 2020 226b 7022 2c0a 2020  r",.    "kp",.  
+00010700: 2020 226b 706d 6722 2c0a 2020 2020 226b    "kpmg",.    "k
+00010710: 706e 222c 0a20 2020 2022 6b72 222c 0a20  pn",.    "kr",. 
+00010720: 2020 2022 6b72 6422 2c0a 2020 2020 226b     "krd",.    "k
+00010730: 7265 6422 2c0a 2020 2020 226b 756f 6b67  red",.    "kuokg
+00010740: 726f 7570 222c 0a20 2020 2022 6b77 222c  roup",.    "kw",
+00010750: 0a20 2020 2022 6b79 222c 0a20 2020 2022  .    "ky",.    "
+00010760: 6b79 6f74 6f22 2c0a 2020 2020 226b 7a22  kyoto",.    "kz"
+00010770: 2c0a 2020 2020 2320 6c0a 2020 2020 226c  ,.    # l.    "l
+00010780: 6122 2c0a 2020 2020 226c 6163 6169 7861  a",.    "lacaixa
+00010790: 222c 0a20 2020 2022 6c61 6462 726f 6b65  ",.    "ladbroke
+000107a0: 7322 2c0a 2020 2020 226c 616d 626f 7267  s",.    "lamborg
+000107b0: 6869 6e69 222c 0a20 2020 2022 6c61 6d65  hini",.    "lame
+000107c0: 7222 2c0a 2020 2020 226c 616e 6361 7374  r",.    "lancast
+000107d0: 6572 222c 0a20 2020 2022 6c61 6e63 6961  er",.    "lancia
+000107e0: 222c 0a20 2020 2022 6c61 6e63 6f6d 6522  ",.    "lancome"
+000107f0: 2c0a 2020 2020 226c 616e 6422 2c0a 2020  ,.    "land",.  
+00010800: 2020 226c 616e 6472 6f76 6572 222c 0a20    "landrover",. 
+00010810: 2020 2022 6c61 6e78 6573 7322 2c0a 2020     "lanxess",.  
+00010820: 2020 226c 6173 616c 6c65 222c 0a20 2020    "lasalle",.   
+00010830: 2022 6c61 7422 2c0a 2020 2020 226c 6174   "lat",.    "lat
+00010840: 696e 6f22 2c0a 2020 2020 226c 6174 726f  ino",.    "latro
+00010850: 6265 222c 0a20 2020 2022 6c61 7722 2c0a  be",.    "law",.
+00010860: 2020 2020 226c 6177 7965 7222 2c0a 2020      "lawyer",.  
+00010870: 2020 226c 6222 2c0a 2020 2020 226c 6322    "lb",.    "lc"
+00010880: 2c0a 2020 2020 226c 6473 222c 0a20 2020  ,.    "lds",.   
+00010890: 2022 6c65 6173 6522 2c0a 2020 2020 226c   "lease",.    "l
+000108a0: 6563 6c65 7263 222c 0a20 2020 2022 6c65  eclerc",.    "le
+000108b0: 6672 616b 222c 0a20 2020 2022 6c65 6761  frak",.    "lega
+000108c0: 6c22 2c0a 2020 2020 226c 6567 6f22 2c0a  l",.    "lego",.
+000108d0: 2020 2020 226c 6578 7573 222c 0a20 2020      "lexus",.   
+000108e0: 2022 6c67 6274 222c 0a20 2020 2022 6c69   "lgbt",.    "li
+000108f0: 222c 0a20 2020 2022 6c69 6169 736f 6e22  ",.    "liaison"
+00010900: 2c0a 2020 2020 226c 6964 6c22 2c0a 2020  ,.    "lidl",.  
+00010910: 2020 226c 6966 6522 2c0a 2020 2020 226c    "life",.    "l
+00010920: 6966 6569 6e73 7572 616e 6365 222c 0a20  ifeinsurance",. 
+00010930: 2020 2022 6c69 6665 7374 796c 6522 2c0a     "lifestyle",.
+00010940: 2020 2020 226c 6967 6874 696e 6722 2c0a      "lighting",.
+00010950: 2020 2020 226c 696b 6522 2c0a 2020 2020      "like",.    
+00010960: 226c 696c 6c79 222c 0a20 2020 2022 6c69  "lilly",.    "li
+00010970: 6d69 7465 6422 2c0a 2020 2020 226c 696d  mited",.    "lim
+00010980: 6f22 2c0a 2020 2020 226c 696e 636f 6c6e  o",.    "lincoln
+00010990: 222c 0a20 2020 2022 6c69 6e64 6522 2c0a  ",.    "linde",.
+000109a0: 2020 2020 226c 696e 6b22 2c0a 2020 2020      "link",.    
+000109b0: 226c 6970 7379 222c 0a20 2020 2022 6c69  "lipsy",.    "li
+000109c0: 7665 222c 0a20 2020 2022 6c69 7669 6e67  ve",.    "living
+000109d0: 222c 0a20 2020 2022 6c69 7869 6c22 2c0a  ",.    "lixil",.
+000109e0: 2020 2020 226c 6b22 2c0a 2020 2020 226c      "lk",.    "l
+000109f0: 6f61 6e22 2c0a 2020 2020 226c 6f61 6e73  oan",.    "loans
+00010a00: 222c 0a20 2020 2022 6c6f 6361 6c68 6f73  ",.    "localhos
+00010a10: 7422 2c0a 2020 2020 226c 6f63 6b65 7222  t",.    "locker"
+00010a20: 2c0a 2020 2020 226c 6f63 7573 222c 0a20  ,.    "locus",. 
+00010a30: 2020 2022 6c6f 6674 222c 0a20 2020 2022     "loft",.    "
+00010a40: 6c6f 6c22 2c0a 2020 2020 226c 6f6e 646f  lol",.    "londo
+00010a50: 6e22 2c0a 2020 2020 226c 6f74 7465 222c  n",.    "lotte",
+00010a60: 0a20 2020 2022 6c6f 7474 6f22 2c0a 2020  .    "lotto",.  
+00010a70: 2020 226c 6f76 6522 2c0a 2020 2020 226c    "love",.    "l
+00010a80: 706c 222c 0a20 2020 2022 6c70 6c66 696e  pl",.    "lplfin
+00010a90: 616e 6369 616c 222c 0a20 2020 2022 6c72  ancial",.    "lr
+00010aa0: 222c 0a20 2020 2022 6c73 222c 0a20 2020  ",.    "ls",.   
+00010ab0: 2022 6c74 222c 0a20 2020 2022 6c74 6422   "lt",.    "ltd"
+00010ac0: 2c0a 2020 2020 226c 7464 6122 2c0a 2020  ,.    "ltda",.  
+00010ad0: 2020 226c 7522 2c0a 2020 2020 226c 756e    "lu",.    "lun
+00010ae0: 6462 6563 6b22 2c0a 2020 2020 226c 7570  dbeck",.    "lup
+00010af0: 696e 222c 0a20 2020 2022 6c75 7865 222c  in",.    "luxe",
+00010b00: 0a20 2020 2022 6c75 7875 7279 222c 0a20  .    "luxury",. 
+00010b10: 2020 2022 6c76 222c 0a20 2020 2022 6c79     "lv",.    "ly
+00010b20: 222c 0a20 2020 2023 206d 0a20 2020 2022  ",.    # m.    "
+00010b30: 6d61 222c 0a20 2020 2022 6d61 6379 7322  ma",.    "macys"
+00010b40: 2c0a 2020 2020 226d 6164 7269 6422 2c0a  ,.    "madrid",.
+00010b50: 2020 2020 226d 6169 6622 2c0a 2020 2020      "maif",.    
+00010b60: 226d 6169 736f 6e22 2c0a 2020 2020 226d  "maison",.    "m
+00010b70: 616b 6575 7022 2c0a 2020 2020 226d 616e  akeup",.    "man
+00010b80: 222c 0a20 2020 2022 6d61 6e61 6765 6d65  ",.    "manageme
+00010b90: 6e74 222c 0a20 2020 2022 6d61 6e67 6f22  nt",.    "mango"
+00010ba0: 2c0a 2020 2020 226d 6170 222c 0a20 2020  ,.    "map",.   
+00010bb0: 2022 6d61 726b 6574 222c 0a20 2020 2022   "market",.    "
+00010bc0: 6d61 726b 6574 696e 6722 2c0a 2020 2020  marketing",.    
+00010bd0: 226d 6172 6b65 7473 222c 0a20 2020 2022  "markets",.    "
+00010be0: 6d61 7272 696f 7474 222c 0a20 2020 2022  marriott",.    "
+00010bf0: 6d61 7273 6861 6c6c 7322 2c0a 2020 2020  marshalls",.    
+00010c00: 226d 6173 6572 6174 6922 2c0a 2020 2020  "maserati",.    
+00010c10: 226d 6174 7465 6c22 2c0a 2020 2020 226d  "mattel",.    "m
+00010c20: 6261 222c 0a20 2020 2022 6d63 222c 0a20  ba",.    "mc",. 
+00010c30: 2020 2022 6d63 6b69 6e73 6579 222c 0a20     "mckinsey",. 
+00010c40: 2020 2022 6d64 222c 0a20 2020 2022 6d65     "md",.    "me
+00010c50: 222c 0a20 2020 2022 6d65 6422 2c0a 2020  ",.    "med",.  
+00010c60: 2020 226d 6564 6961 222c 0a20 2020 2022    "media",.    "
+00010c70: 6d65 6574 222c 0a20 2020 2022 6d65 6c62  meet",.    "melb
+00010c80: 6f75 726e 6522 2c0a 2020 2020 226d 656d  ourne",.    "mem
+00010c90: 6522 2c0a 2020 2020 226d 656d 6f72 6961  e",.    "memoria
+00010ca0: 6c22 2c0a 2020 2020 226d 656e 222c 0a20  l",.    "men",. 
+00010cb0: 2020 2022 6d65 6e75 222c 0a20 2020 2022     "menu",.    "
+00010cc0: 6d65 6f22 2c0a 2020 2020 226d 6572 636b  meo",.    "merck
+00010cd0: 6d73 6422 2c0a 2020 2020 226d 6574 6c69  msd",.    "metli
+00010ce0: 6665 222c 0a20 2020 2022 6d67 222c 0a20  fe",.    "mg",. 
+00010cf0: 2020 2022 6d68 222c 0a20 2020 2022 6d69     "mh",.    "mi
+00010d00: 616d 6922 2c0a 2020 2020 226d 6963 726f  ami",.    "micro
+00010d10: 736f 6674 222c 0a20 2020 2022 6d69 6c22  soft",.    "mil"
+00010d20: 2c0a 2020 2020 226d 696e 6922 2c0a 2020  ,.    "mini",.  
+00010d30: 2020 226d 696e 7422 2c0a 2020 2020 226d    "mint",.    "m
+00010d40: 6974 222c 0a20 2020 2022 6d69 7473 7562  it",.    "mitsub
+00010d50: 6973 6869 222c 0a20 2020 2022 6d6b 222c  ishi",.    "mk",
+00010d60: 0a20 2020 2022 6d6c 222c 0a20 2020 2022  .    "ml",.    "
+00010d70: 6d6c 6222 2c0a 2020 2020 226d 6c73 222c  mlb",.    "mls",
+00010d80: 0a20 2020 2022 6d6d 222c 0a20 2020 2022  .    "mm",.    "
+00010d90: 6d6d 6122 2c0a 2020 2020 226d 6e22 2c0a  mma",.    "mn",.
+00010da0: 2020 2020 226d 6f22 2c0a 2020 2020 226d      "mo",.    "m
+00010db0: 6f62 6922 2c0a 2020 2020 226d 6f62 696c  obi",.    "mobil
+00010dc0: 6522 2c0a 2020 2020 226d 6f62 696c 7922  e",.    "mobily"
+00010dd0: 2c0a 2020 2020 226d 6f64 6122 2c0a 2020  ,.    "moda",.  
+00010de0: 2020 226d 6f65 222c 0a20 2020 2022 6d6f    "moe",.    "mo
+00010df0: 6922 2c0a 2020 2020 226d 6f6d 222c 0a20  i",.    "mom",. 
+00010e00: 2020 2022 6d6f 6e61 7368 222c 0a20 2020     "monash",.   
+00010e10: 2022 6d6f 6e65 7922 2c0a 2020 2020 226d   "money",.    "m
+00010e20: 6f6e 7374 6572 222c 0a20 2020 2022 6d6f  onster",.    "mo
+00010e30: 7061 7222 2c0a 2020 2020 226d 6f72 6d6f  par",.    "mormo
+00010e40: 6e22 2c0a 2020 2020 226d 6f72 7467 6167  n",.    "mortgag
+00010e50: 6522 2c0a 2020 2020 226d 6f73 636f 7722  e",.    "moscow"
+00010e60: 2c0a 2020 2020 226d 6f74 6f22 2c0a 2020  ,.    "moto",.  
+00010e70: 2020 226d 6f74 6f72 6379 636c 6573 222c    "motorcycles",
+00010e80: 0a20 2020 2022 6d6f 7622 2c0a 2020 2020  .    "mov",.    
+00010e90: 226d 6f76 6965 222c 0a20 2020 2022 6d6f  "movie",.    "mo
+00010ea0: 7669 7374 6172 222c 0a20 2020 2022 6d70  vistar",.    "mp
+00010eb0: 222c 0a20 2020 2022 6d71 222c 0a20 2020  ",.    "mq",.   
+00010ec0: 2022 6d72 222c 0a20 2020 2022 6d73 222c   "mr",.    "ms",
+00010ed0: 0a20 2020 2022 6d73 6422 2c0a 2020 2020  .    "msd",.    
+00010ee0: 226d 7422 2c0a 2020 2020 226d 746e 222c  "mt",.    "mtn",
+00010ef0: 0a20 2020 2022 6d74 7222 2c0a 2020 2020  .    "mtr",.    
+00010f00: 226d 7522 2c0a 2020 2020 226d 7573 6575  "mu",.    "museu
+00010f10: 6d22 2c0a 2020 2020 226d 7574 7561 6c22  m",.    "mutual"
+00010f20: 2c0a 2020 2020 226d 7622 2c0a 2020 2020  ,.    "mv",.    
+00010f30: 226d 7722 2c0a 2020 2020 226d 7822 2c0a  "mw",.    "mx",.
+00010f40: 2020 2020 226d 7922 2c0a 2020 2020 226d      "my",.    "m
+00010f50: 7a22 2c0a 2020 2020 2320 6e0a 2020 2020  z",.    # n.    
+00010f60: 226e 6122 2c0a 2020 2020 226e 6162 222c  "na",.    "nab",
+00010f70: 0a20 2020 2022 6e61 6465 7822 2c0a 2020  .    "nadex",.  
+00010f80: 2020 226e 6167 6f79 6122 2c0a 2020 2020    "nagoya",.    
+00010f90: 226e 616d 6522 2c0a 2020 2020 226e 6174  "name",.    "nat
+00010fa0: 696f 6e77 6964 6522 2c0a 2020 2020 226e  ionwide",.    "n
+00010fb0: 6174 7572 6122 2c0a 2020 2020 226e 6176  atura",.    "nav
+00010fc0: 7922 2c0a 2020 2020 226e 6261 222c 0a20  y",.    "nba",. 
+00010fd0: 2020 2022 6e63 222c 0a20 2020 2022 6e65     "nc",.    "ne
+00010fe0: 222c 0a20 2020 2022 6e65 6322 2c0a 2020  ",.    "nec",.  
+00010ff0: 2020 226e 6574 222c 0a20 2020 2022 6e65    "net",.    "ne
+00011000: 7462 616e 6b22 2c0a 2020 2020 226e 6574  tbank",.    "net
+00011010: 666c 6978 222c 0a20 2020 2022 6e65 7477  flix",.    "netw
+00011020: 6f72 6b22 2c0a 2020 2020 226e 6575 7374  ork",.    "neust
+00011030: 6172 222c 0a20 2020 2022 6e65 7722 2c0a  ar",.    "new",.
+00011040: 2020 2020 226e 6577 686f 6c6c 616e 6422      "newholland"
+00011050: 2c0a 2020 2020 226e 6577 7322 2c0a 2020  ,.    "news",.  
+00011060: 2020 226e 6578 7422 2c0a 2020 2020 226e    "next",.    "n
+00011070: 6578 7464 6972 6563 7422 2c0a 2020 2020  extdirect",.    
+00011080: 226e 6578 7573 222c 0a20 2020 2022 6e66  "nexus",.    "nf
+00011090: 222c 0a20 2020 2022 6e66 6c22 2c0a 2020  ",.    "nfl",.  
+000110a0: 2020 226e 6722 2c0a 2020 2020 226e 676f    "ng",.    "ngo
+000110b0: 222c 0a20 2020 2022 6e68 6b22 2c0a 2020  ",.    "nhk",.  
+000110c0: 2020 226e 6922 2c0a 2020 2020 226e 6963    "ni",.    "nic
+000110d0: 6f22 2c0a 2020 2020 226e 696b 6522 2c0a  o",.    "nike",.
+000110e0: 2020 2020 226e 696b 6f6e 222c 0a20 2020      "nikon",.   
+000110f0: 2022 6e69 6e6a 6122 2c0a 2020 2020 226e   "ninja",.    "n
+00011100: 6973 7361 6e22 2c0a 2020 2020 226e 6973  issan",.    "nis
+00011110: 7361 7922 2c0a 2020 2020 226e 6c22 2c0a  say",.    "nl",.
+00011120: 2020 2020 226e 6f22 2c0a 2020 2020 226e      "no",.    "n
+00011130: 6f6b 6961 222c 0a20 2020 2022 6e6f 7274  okia",.    "nort
+00011140: 6877 6573 7465 726e 6d75 7475 616c 222c  hwesternmutual",
+00011150: 0a20 2020 2022 6e6f 7274 6f6e 222c 0a20  .    "norton",. 
+00011160: 2020 2022 6e6f 7722 2c0a 2020 2020 226e     "now",.    "n
+00011170: 6f77 7275 7a22 2c0a 2020 2020 226e 6f77  owruz",.    "now
+00011180: 7476 222c 0a20 2020 2022 6e70 222c 0a20  tv",.    "np",. 
+00011190: 2020 2022 6e72 222c 0a20 2020 2022 6e72     "nr",.    "nr
+000111a0: 6122 2c0a 2020 2020 226e 7277 222c 0a20  a",.    "nrw",. 
+000111b0: 2020 2022 6e74 7422 2c0a 2020 2020 226e     "ntt",.    "n
+000111c0: 7522 2c0a 2020 2020 226e 7963 222c 0a20  u",.    "nyc",. 
+000111d0: 2020 2022 6e7a 222c 0a20 2020 2023 206f     "nz",.    # o
+000111e0: 0a20 2020 2022 6f62 6922 2c0a 2020 2020  .    "obi",.    
+000111f0: 226f 6273 6572 7665 7222 2c0a 2020 2020  "observer",.    
+00011200: 226f 6666 222c 0a20 2020 2022 6f66 6669  "off",.    "offi
+00011210: 6365 222c 0a20 2020 2022 6f6b 696e 6177  ce",.    "okinaw
+00011220: 6122 2c0a 2020 2020 226f 6c61 7961 6e22  a",.    "olayan"
+00011230: 2c0a 2020 2020 226f 6c61 7961 6e67 726f  ,.    "olayangro
+00011240: 7570 222c 0a20 2020 2022 6f6c 646e 6176  up",.    "oldnav
+00011250: 7922 2c0a 2020 2020 226f 6c6c 6f22 2c0a  y",.    "ollo",.
+00011260: 2020 2020 226f 6d22 2c0a 2020 2020 226f      "om",.    "o
+00011270: 6d65 6761 222c 0a20 2020 2022 6f6e 6522  mega",.    "one"
+00011280: 2c0a 2020 2020 226f 6e67 222c 0a20 2020  ,.    "ong",.   
+00011290: 2022 6f6e 6c22 2c0a 2020 2020 226f 6e6c   "onl",.    "onl
+000112a0: 696e 6522 2c0a 2020 2020 226f 6e79 6f75  ine",.    "onyou
+000112b0: 7273 6964 6522 2c0a 2020 2020 226f 6f6f  rside",.    "ooo
+000112c0: 222c 0a20 2020 2022 6f70 656e 222c 0a20  ",.    "open",. 
+000112d0: 2020 2022 6f72 6163 6c65 222c 0a20 2020     "oracle",.   
+000112e0: 2022 6f72 616e 6765 222c 0a20 2020 2022   "orange",.    "
+000112f0: 6f72 6722 2c0a 2020 2020 226f 7267 616e  org",.    "organ
+00011300: 6963 222c 0a20 2020 2022 6f72 6967 696e  ic",.    "origin
+00011310: 7322 2c0a 2020 2020 226f 7361 6b61 222c  s",.    "osaka",
+00011320: 0a20 2020 2022 6f74 7375 6b61 222c 0a20  .    "otsuka",. 
+00011330: 2020 2022 6f74 7422 2c0a 2020 2020 226f     "ott",.    "o
+00011340: 7668 222c 0a20 2020 2023 2070 0a20 2020  vh",.    # p.   
+00011350: 2022 7061 222c 0a20 2020 2022 7061 6765   "pa",.    "page
+00011360: 222c 0a20 2020 2022 7061 6e61 736f 6e69  ",.    "panasoni
+00011370: 6322 2c0a 2020 2020 2270 616e 6572 6169  c",.    "panerai
+00011380: 222c 0a20 2020 2022 7061 7269 7322 2c0a  ",.    "paris",.
+00011390: 2020 2020 2270 6172 7322 2c0a 2020 2020      "pars",.    
+000113a0: 2270 6172 746e 6572 7322 2c0a 2020 2020  "partners",.    
+000113b0: 2270 6172 7473 222c 0a20 2020 2022 7061  "parts",.    "pa
+000113c0: 7274 7922 2c0a 2020 2020 2270 6173 7361  rty",.    "passa
+000113d0: 6765 6e73 222c 0a20 2020 2022 7061 7922  gens",.    "pay"
+000113e0: 2c0a 2020 2020 2270 6363 7722 2c0a 2020  ,.    "pccw",.  
+000113f0: 2020 2270 6522 2c0a 2020 2020 2270 6574    "pe",.    "pet
+00011400: 222c 0a20 2020 2022 7066 222c 0a20 2020  ",.    "pf",.   
+00011410: 2022 7066 697a 6572 222c 0a20 2020 2022   "pfizer",.    "
+00011420: 7067 222c 0a20 2020 2022 7068 222c 0a20  pg",.    "ph",. 
+00011430: 2020 2022 7068 6172 6d61 6379 222c 0a20     "pharmacy",. 
+00011440: 2020 2022 7068 6422 2c0a 2020 2020 2270     "phd",.    "p
+00011450: 6869 6c69 7073 222c 0a20 2020 2022 7068  hilips",.    "ph
+00011460: 6f6e 6522 2c0a 2020 2020 2270 686f 746f  one",.    "photo
+00011470: 222c 0a20 2020 2022 7068 6f74 6f67 7261  ",.    "photogra
+00011480: 7068 7922 2c0a 2020 2020 2270 686f 746f  phy",.    "photo
+00011490: 7322 2c0a 2020 2020 2270 6879 7369 6f22  s",.    "physio"
+000114a0: 2c0a 2020 2020 2270 6961 6765 7422 2c0a  ,.    "piaget",.
+000114b0: 2020 2020 2270 6963 7322 2c0a 2020 2020      "pics",.    
+000114c0: 2270 6963 7465 7422 2c0a 2020 2020 2270  "pictet",.    "p
+000114d0: 6963 7475 7265 7322 2c0a 2020 2020 2270  ictures",.    "p
+000114e0: 6964 222c 0a20 2020 2022 7069 6e22 2c0a  id",.    "pin",.
+000114f0: 2020 2020 2270 696e 6722 2c0a 2020 2020      "ping",.    
+00011500: 2270 696e 6b22 2c0a 2020 2020 2270 696f  "pink",.    "pio
+00011510: 6e65 6572 222c 0a20 2020 2022 7069 7a7a  neer",.    "pizz
+00011520: 6122 2c0a 2020 2020 2270 6b22 2c0a 2020  a",.    "pk",.  
+00011530: 2020 2270 6c22 2c0a 2020 2020 2270 6c61    "pl",.    "pla
+00011540: 6365 222c 0a20 2020 2022 706c 6179 222c  ce",.    "play",
+00011550: 0a20 2020 2022 706c 6179 7374 6174 696f  .    "playstatio
+00011560: 6e22 2c0a 2020 2020 2270 6c75 6d62 696e  n",.    "plumbin
+00011570: 6722 2c0a 2020 2020 2270 6c75 7322 2c0a  g",.    "plus",.
+00011580: 2020 2020 2270 6d22 2c0a 2020 2020 2270      "pm",.    "p
+00011590: 6e22 2c0a 2020 2020 2270 6e63 222c 0a20  n",.    "pnc",. 
+000115a0: 2020 2022 706f 686c 222c 0a20 2020 2022     "pohl",.    "
+000115b0: 706f 6b65 7222 2c0a 2020 2020 2270 6f6c  poker",.    "pol
+000115c0: 6974 6965 222c 0a20 2020 2022 706f 726e  itie",.    "porn
+000115d0: 222c 0a20 2020 2022 706f 7374 222c 0a20  ",.    "post",. 
+000115e0: 2020 2022 7072 222c 0a20 2020 2022 7072     "pr",.    "pr
+000115f0: 616d 6572 6963 6122 2c0a 2020 2020 2270  america",.    "p
+00011600: 7261 7869 222c 0a20 2020 2022 7072 6573  raxi",.    "pres
+00011610: 7322 2c0a 2020 2020 2270 7269 6d65 222c  s",.    "prime",
+00011620: 0a20 2020 2022 7072 6f22 2c0a 2020 2020  .    "pro",.    
+00011630: 2270 726f 6422 2c0a 2020 2020 2270 726f  "prod",.    "pro
+00011640: 6475 6374 696f 6e73 222c 0a20 2020 2022  ductions",.    "
+00011650: 7072 6f66 222c 0a20 2020 2022 7072 6f67  prof",.    "prog
+00011660: 7265 7373 6976 6522 2c0a 2020 2020 2270  ressive",.    "p
+00011670: 726f 6d6f 222c 0a20 2020 2022 7072 6f70  romo",.    "prop
+00011680: 6572 7469 6573 222c 0a20 2020 2022 7072  erties",.    "pr
+00011690: 6f70 6572 7479 222c 0a20 2020 2022 7072  operty",.    "pr
+000116a0: 6f74 6563 7469 6f6e 222c 0a20 2020 2022  otection",.    "
+000116b0: 7072 7522 2c0a 2020 2020 2270 7275 6465  pru",.    "prude
+000116c0: 6e74 6961 6c22 2c0a 2020 2020 2270 7322  ntial",.    "ps"
+000116d0: 2c0a 2020 2020 2270 7422 2c0a 2020 2020  ,.    "pt",.    
+000116e0: 2270 7562 222c 0a20 2020 2022 7077 222c  "pub",.    "pw",
+000116f0: 0a20 2020 2022 7077 6322 2c0a 2020 2020  .    "pwc",.    
+00011700: 2270 7922 2c0a 2020 2020 2320 710a 2020  "py",.    # q.  
+00011710: 2020 2271 6122 2c0a 2020 2020 2271 706f    "qa",.    "qpo
+00011720: 6e22 2c0a 2020 2020 2271 7565 6265 6322  n",.    "quebec"
+00011730: 2c0a 2020 2020 2271 7565 7374 222c 0a20  ,.    "quest",. 
+00011740: 2020 2022 7176 6322 2c0a 2020 2020 2320     "qvc",.    # 
+00011750: 720a 2020 2020 2272 6163 696e 6722 2c0a  r.    "racing",.
+00011760: 2020 2020 2272 6164 696f 222c 0a20 2020      "radio",.   
+00011770: 2022 7261 6964 222c 0a20 2020 2022 7265   "raid",.    "re
+00011780: 222c 0a20 2020 2022 7265 6164 222c 0a20  ",.    "read",. 
+00011790: 2020 2022 7265 616c 6573 7461 7465 222c     "realestate",
+000117a0: 0a20 2020 2022 7265 616c 746f 7222 2c0a  .    "realtor",.
+000117b0: 2020 2020 2272 6561 6c74 7922 2c0a 2020      "realty",.  
+000117c0: 2020 2272 6563 6970 6573 222c 0a20 2020    "recipes",.   
+000117d0: 2022 7265 6422 2c0a 2020 2020 2272 6564   "red",.    "red
+000117e0: 7374 6f6e 6522 2c0a 2020 2020 2272 6564  stone",.    "red
+000117f0: 756d 6272 656c 6c61 222c 0a20 2020 2022  umbrella",.    "
+00011800: 7265 6861 6222 2c0a 2020 2020 2272 6569  rehab",.    "rei
+00011810: 7365 222c 0a20 2020 2022 7265 6973 656e  se",.    "reisen
+00011820: 222c 0a20 2020 2022 7265 6974 222c 0a20  ",.    "reit",. 
+00011830: 2020 2022 7265 6c69 616e 6365 222c 0a20     "reliance",. 
+00011840: 2020 2022 7265 6e22 2c0a 2020 2020 2272     "ren",.    "r
+00011850: 656e 7422 2c0a 2020 2020 2272 656e 7461  ent",.    "renta
+00011860: 6c73 222c 0a20 2020 2022 7265 7061 6972  ls",.    "repair
+00011870: 222c 0a20 2020 2022 7265 706f 7274 222c  ",.    "report",
+00011880: 0a20 2020 2022 7265 7075 626c 6963 616e  .    "republican
+00011890: 222c 0a20 2020 2022 7265 7374 222c 0a20  ",.    "rest",. 
+000118a0: 2020 2022 7265 7374 6175 7261 6e74 222c     "restaurant",
+000118b0: 0a20 2020 2022 7265 7669 6577 222c 0a20  .    "review",. 
+000118c0: 2020 2022 7265 7669 6577 7322 2c0a 2020     "reviews",.  
+000118d0: 2020 2272 6578 726f 7468 222c 0a20 2020    "rexroth",.   
+000118e0: 2022 7269 6368 222c 0a20 2020 2022 7269   "rich",.    "ri
+000118f0: 6368 6172 646c 6922 2c0a 2020 2020 2272  chardli",.    "r
+00011900: 6963 6f68 222c 0a20 2020 2022 7269 6768  icoh",.    "righ
+00011910: 7461 7468 6f6d 6522 2c0a 2020 2020 2272  tathome",.    "r
+00011920: 696c 222c 0a20 2020 2022 7269 6f22 2c0a  il",.    "rio",.
+00011930: 2020 2020 2272 6970 222c 0a20 2020 2022      "rip",.    "
+00011940: 726d 6974 222c 0a20 2020 2022 726f 222c  rmit",.    "ro",
+00011950: 0a20 2020 2022 726f 6368 6572 222c 0a20  .    "rocher",. 
+00011960: 2020 2022 726f 636b 7322 2c0a 2020 2020     "rocks",.    
+00011970: 2272 6f64 656f 222c 0a20 2020 2022 726f  "rodeo",.    "ro
+00011980: 6765 7273 222c 0a20 2020 2022 726f 6f6d  gers",.    "room
+00011990: 222c 0a20 2020 2022 7273 222c 0a20 2020  ",.    "rs",.   
+000119a0: 2022 7273 7670 222c 0a20 2020 2022 7275   "rsvp",.    "ru
+000119b0: 222c 0a20 2020 2022 7275 6762 7922 2c0a  ",.    "rugby",.
+000119c0: 2020 2020 2272 7568 7222 2c0a 2020 2020      "ruhr",.    
+000119d0: 2272 756e 222c 0a20 2020 2022 7277 222c  "run",.    "rw",
+000119e0: 0a20 2020 2022 7277 6522 2c0a 2020 2020  .    "rwe",.    
+000119f0: 2272 7975 6b79 7522 2c0a 2020 2020 2320  "ryukyu",.    # 
+00011a00: 730a 2020 2020 2273 6122 2c0a 2020 2020  s.    "sa",.    
+00011a10: 2273 6161 726c 616e 6422 2c0a 2020 2020  "saarland",.    
+00011a20: 2273 6166 6522 2c0a 2020 2020 2273 6166  "safe",.    "saf
+00011a30: 6574 7922 2c0a 2020 2020 2273 616b 7572  ety",.    "sakur
+00011a40: 6122 2c0a 2020 2020 2273 616c 6522 2c0a  a",.    "sale",.
+00011a50: 2020 2020 2273 616c 6f6e 222c 0a20 2020      "salon",.   
+00011a60: 2022 7361 6d73 636c 7562 222c 0a20 2020   "samsclub",.   
+00011a70: 2022 7361 6d73 756e 6722 2c0a 2020 2020   "samsung",.    
+00011a80: 2273 616e 6476 696b 222c 0a20 2020 2022  "sandvik",.    "
+00011a90: 7361 6e64 7669 6b63 6f72 6f6d 616e 7422  sandvikcoromant"
+00011aa0: 2c0a 2020 2020 2273 616e 6f66 6922 2c0a  ,.    "sanofi",.
+00011ab0: 2020 2020 2273 6170 222c 0a20 2020 2022      "sap",.    "
+00011ac0: 7361 706f 222c 0a20 2020 2022 7361 726c  sapo",.    "sarl
+00011ad0: 222c 0a20 2020 2022 7361 7322 2c0a 2020  ",.    "sas",.  
+00011ae0: 2020 2273 6176 6522 2c0a 2020 2020 2273    "save",.    "s
+00011af0: 6178 6f22 2c0a 2020 2020 2273 6222 2c0a  axo",.    "sb",.
+00011b00: 2020 2020 2273 6269 222c 0a20 2020 2022      "sbi",.    "
+00011b10: 7362 7322 2c0a 2020 2020 2273 6322 2c0a  sbs",.    "sc",.
+00011b20: 2020 2020 2273 6361 222c 0a20 2020 2022      "sca",.    "
+00011b30: 7363 6222 2c0a 2020 2020 2273 6368 6165  scb",.    "schae
+00011b40: 6666 6c65 7222 2c0a 2020 2020 2273 6368  ffler",.    "sch
+00011b50: 6d69 6474 222c 0a20 2020 2022 7363 686f  midt",.    "scho
+00011b60: 6c61 7273 6869 7073 222c 0a20 2020 2022  larships",.    "
+00011b70: 7363 686f 6f6c 222c 0a20 2020 2022 7363  school",.    "sc
+00011b80: 6875 6c65 222c 0a20 2020 2022 7363 6877  hule",.    "schw
+00011b90: 6172 7a22 2c0a 2020 2020 2273 6369 656e  arz",.    "scien
+00011ba0: 6365 222c 0a20 2020 2022 7363 6a6f 686e  ce",.    "scjohn
+00011bb0: 736f 6e22 2c0a 2020 2020 2273 636f 7222  son",.    "scor"
+00011bc0: 2c0a 2020 2020 2273 636f 7422 2c0a 2020  ,.    "scot",.  
+00011bd0: 2020 2273 6422 2c0a 2020 2020 2273 6522    "sd",.    "se"
+00011be0: 2c0a 2020 2020 2273 6561 7263 6822 2c0a  ,.    "search",.
+00011bf0: 2020 2020 2273 6561 7422 2c0a 2020 2020      "seat",.    
+00011c00: 2273 6563 7572 6522 2c0a 2020 2020 2273  "secure",.    "s
+00011c10: 6563 7572 6974 7922 2c0a 2020 2020 2273  ecurity",.    "s
+00011c20: 6565 6b22 2c0a 2020 2020 2273 656c 6563  eek",.    "selec
+00011c30: 7422 2c0a 2020 2020 2273 656e 6572 222c  t",.    "sener",
+00011c40: 0a20 2020 2022 7365 7276 6963 6573 222c  .    "services",
+00011c50: 0a20 2020 2022 7365 7322 2c0a 2020 2020  .    "ses",.    
+00011c60: 2273 6576 656e 222c 0a20 2020 2022 7365  "seven",.    "se
+00011c70: 7722 2c0a 2020 2020 2273 6578 222c 0a20  w",.    "sex",. 
+00011c80: 2020 2022 7365 7879 222c 0a20 2020 2022     "sexy",.    "
+00011c90: 7366 7222 2c0a 2020 2020 2273 6722 2c0a  sfr",.    "sg",.
+00011ca0: 2020 2020 2273 6822 2c0a 2020 2020 2273      "sh",.    "s
+00011cb0: 6861 6e67 7269 6c61 222c 0a20 2020 2022  hangrila",.    "
+00011cc0: 7368 6172 7022 2c0a 2020 2020 2273 6861  sharp",.    "sha
+00011cd0: 7722 2c0a 2020 2020 2273 6865 6c6c 222c  w",.    "shell",
+00011ce0: 0a20 2020 2022 7368 6961 222c 0a20 2020  .    "shia",.   
+00011cf0: 2022 7368 696b 7368 6122 2c0a 2020 2020   "shiksha",.    
+00011d00: 2273 686f 6573 222c 0a20 2020 2022 7368  "shoes",.    "sh
+00011d10: 6f70 222c 0a20 2020 2022 7368 6f70 7069  op",.    "shoppi
+00011d20: 6e67 222c 0a20 2020 2022 7368 6f75 6a69  ng",.    "shouji
+00011d30: 222c 0a20 2020 2022 7368 6f77 222c 0a20  ",.    "show",. 
+00011d40: 2020 2022 7368 6f77 7469 6d65 222c 0a20     "showtime",. 
+00011d50: 2020 2022 7368 7269 7261 6d22 2c0a 2020     "shriram",.  
+00011d60: 2020 2273 6922 2c0a 2020 2020 2273 696c    "si",.    "sil
+00011d70: 6b22 2c0a 2020 2020 2273 696e 6122 2c0a  k",.    "sina",.
+00011d80: 2020 2020 2273 696e 676c 6573 222c 0a20      "singles",. 
+00011d90: 2020 2022 7369 7465 222c 0a20 2020 2022     "site",.    "
+00011da0: 736a 222c 0a20 2020 2022 736b 222c 0a20  sj",.    "sk",. 
+00011db0: 2020 2022 736b 6922 2c0a 2020 2020 2273     "ski",.    "s
+00011dc0: 6b69 6e22 2c0a 2020 2020 2273 6b79 222c  kin",.    "sky",
+00011dd0: 0a20 2020 2022 736b 7970 6522 2c0a 2020  .    "skype",.  
+00011de0: 2020 2273 6c22 2c0a 2020 2020 2273 6c69    "sl",.    "sli
+00011df0: 6e67 222c 0a20 2020 2022 736d 222c 0a20  ng",.    "sm",. 
+00011e00: 2020 2022 736d 6172 7422 2c0a 2020 2020     "smart",.    
+00011e10: 2273 6d69 6c65 222c 0a20 2020 2022 736e  "smile",.    "sn
+00011e20: 222c 0a20 2020 2022 736e 6366 222c 0a20  ",.    "sncf",. 
+00011e30: 2020 2022 736f 222c 0a20 2020 2022 736f     "so",.    "so
+00011e40: 6363 6572 222c 0a20 2020 2022 736f 6369  ccer",.    "soci
+00011e50: 616c 222c 0a20 2020 2022 736f 6674 6261  al",.    "softba
+00011e60: 6e6b 222c 0a20 2020 2022 736f 6674 7761  nk",.    "softwa
+00011e70: 7265 222c 0a20 2020 2022 736f 6875 222c  re",.    "sohu",
+00011e80: 0a20 2020 2022 736f 6c61 7222 2c0a 2020  .    "solar",.  
+00011e90: 2020 2273 6f6c 7574 696f 6e73 222c 0a20    "solutions",. 
+00011ea0: 2020 2022 736f 6e67 222c 0a20 2020 2022     "song",.    "
+00011eb0: 736f 6e79 222c 0a20 2020 2022 736f 7922  sony",.    "soy"
+00011ec0: 2c0a 2020 2020 2273 7061 6365 222c 0a20  ,.    "space",. 
+00011ed0: 2020 2022 7370 6965 6765 6c22 2c0a 2020     "spiegel",.  
+00011ee0: 2020 2273 706f 7422 2c0a 2020 2020 2273    "spot",.    "s
+00011ef0: 7072 6561 6462 6574 7469 6e67 222c 0a20  preadbetting",. 
+00011f00: 2020 2022 7372 222c 0a20 2020 2022 7372     "sr",.    "sr
+00011f10: 6c22 2c0a 2020 2020 2273 7274 222c 0a20  l",.    "srt",. 
+00011f20: 2020 2022 7374 222c 0a20 2020 2022 7374     "st",.    "st
+00011f30: 6164 6122 2c0a 2020 2020 2273 7461 706c  ada",.    "stapl
+00011f40: 6573 222c 0a20 2020 2022 7374 6172 222c  es",.    "star",
+00011f50: 0a20 2020 2022 7374 6172 6875 6222 2c0a  .    "starhub",.
+00011f60: 2020 2020 2273 7461 7465 6261 6e6b 222c      "statebank",
+00011f70: 0a20 2020 2022 7374 6174 6566 6172 6d22  .    "statefarm"
+00011f80: 2c0a 2020 2020 2273 7461 746f 696c 222c  ,.    "statoil",
+00011f90: 0a20 2020 2022 7374 6322 2c0a 2020 2020  .    "stc",.    
+00011fa0: 2273 7463 6772 6f75 7022 2c0a 2020 2020  "stcgroup",.    
+00011fb0: 2273 746f 636b 686f 6c6d 222c 0a20 2020  "stockholm",.   
+00011fc0: 2022 7374 6f72 6167 6522 2c0a 2020 2020   "storage",.    
+00011fd0: 2273 746f 7265 222c 0a20 2020 2022 7374  "store",.    "st
+00011fe0: 7265 616d 222c 0a20 2020 2022 7374 7564  ream",.    "stud
+00011ff0: 696f 222c 0a20 2020 2022 7374 7564 7922  io",.    "study"
+00012000: 2c0a 2020 2020 2273 7479 6c65 222c 0a20  ,.    "style",. 
+00012010: 2020 2022 7375 222c 0a20 2020 2022 7375     "su",.    "su
+00012020: 636b 7322 2c0a 2020 2020 2273 7570 706c  cks",.    "suppl
+00012030: 6965 7322 2c0a 2020 2020 2273 7570 706c  ies",.    "suppl
+00012040: 7922 2c0a 2020 2020 2273 7570 706f 7274  y",.    "support
+00012050: 222c 0a20 2020 2022 7375 7266 222c 0a20  ",.    "surf",. 
+00012060: 2020 2022 7375 7267 6572 7922 2c0a 2020     "surgery",.  
+00012070: 2020 2273 757a 756b 6922 2c0a 2020 2020    "suzuki",.    
+00012080: 2273 7622 2c0a 2020 2020 2273 7761 7463  "sv",.    "swatc
+00012090: 6822 2c0a 2020 2020 2273 7769 6674 636f  h",.    "swiftco
+000120a0: 7665 7222 2c0a 2020 2020 2273 7769 7373  ver",.    "swiss
+000120b0: 222c 0a20 2020 2022 7378 222c 0a20 2020  ",.    "sx",.   
+000120c0: 2022 7379 222c 0a20 2020 2022 7379 646e   "sy",.    "sydn
+000120d0: 6579 222c 0a20 2020 2022 7379 6d61 6e74  ey",.    "symant
+000120e0: 6563 222c 0a20 2020 2022 7379 7374 656d  ec",.    "system
+000120f0: 7322 2c0a 2020 2020 2273 7a22 2c0a 2020  s",.    "sz",.  
+00012100: 2020 2320 740a 2020 2020 2274 6162 222c    # t.    "tab",
+00012110: 0a20 2020 2022 7461 6970 6569 222c 0a20  .    "taipei",. 
+00012120: 2020 2022 7461 6c6b 222c 0a20 2020 2022     "talk",.    "
+00012130: 7461 6f62 616f 222c 0a20 2020 2022 7461  taobao",.    "ta
+00012140: 7267 6574 222c 0a20 2020 2022 7461 7461  rget",.    "tata
+00012150: 6d6f 746f 7273 222c 0a20 2020 2022 7461  motors",.    "ta
+00012160: 7461 7222 2c0a 2020 2020 2274 6174 746f  tar",.    "tatto
+00012170: 6f22 2c0a 2020 2020 2274 6178 222c 0a20  o",.    "tax",. 
+00012180: 2020 2022 7461 7869 222c 0a20 2020 2022     "taxi",.    "
+00012190: 7463 222c 0a20 2020 2022 7463 6922 2c0a  tc",.    "tci",.
+000121a0: 2020 2020 2274 6422 2c0a 2020 2020 2274      "td",.    "t
+000121b0: 646b 222c 0a20 2020 2022 7465 616d 222c  dk",.    "team",
+000121c0: 0a20 2020 2022 7465 6368 222c 0a20 2020  .    "tech",.   
+000121d0: 2022 7465 6368 6e6f 6c6f 6779 222c 0a20   "technology",. 
+000121e0: 2020 2022 7465 6c22 2c0a 2020 2020 2274     "tel",.    "t
+000121f0: 656c 6563 6974 7922 2c0a 2020 2020 2274  elecity",.    "t
+00012200: 656c 6566 6f6e 6963 6122 2c0a 2020 2020  elefonica",.    
+00012210: 2274 656d 6173 656b 222c 0a20 2020 2022  "temasek",.    "
+00012220: 7465 6e6e 6973 222c 0a20 2020 2022 7465  tennis",.    "te
+00012230: 7661 222c 0a20 2020 2022 7466 222c 0a20  va",.    "tf",. 
+00012240: 2020 2022 7467 222c 0a20 2020 2022 7468     "tg",.    "th
+00012250: 222c 0a20 2020 2022 7468 6422 2c0a 2020  ",.    "thd",.  
+00012260: 2020 2274 6865 6174 6572 222c 0a20 2020    "theater",.   
+00012270: 2022 7468 6561 7472 6522 2c0a 2020 2020   "theatre",.    
+00012280: 2274 6961 6122 2c0a 2020 2020 2274 6963  "tiaa",.    "tic
+00012290: 6b65 7473 222c 0a20 2020 2022 7469 656e  kets",.    "tien
+000122a0: 6461 222c 0a20 2020 2022 7469 6666 616e  da",.    "tiffan
+000122b0: 7922 2c0a 2020 2020 2274 6970 7322 2c0a  y",.    "tips",.
+000122c0: 2020 2020 2274 6972 6573 222c 0a20 2020      "tires",.   
+000122d0: 2022 7469 726f 6c22 2c0a 2020 2020 2274   "tirol",.    "t
+000122e0: 6a22 2c0a 2020 2020 2274 6a6d 6178 7822  j",.    "tjmaxx"
+000122f0: 2c0a 2020 2020 2274 6a78 222c 0a20 2020  ,.    "tjx",.   
+00012300: 2022 746b 222c 0a20 2020 2022 746b 6d61   "tk",.    "tkma
+00012310: 7878 222c 0a20 2020 2022 746c 222c 0a20  xx",.    "tl",. 
+00012320: 2020 2022 746d 222c 0a20 2020 2022 746d     "tm",.    "tm
+00012330: 616c 6c22 2c0a 2020 2020 2274 6e22 2c0a  all",.    "tn",.
+00012340: 2020 2020 2274 6f22 2c0a 2020 2020 2274      "to",.    "t
+00012350: 6f64 6179 222c 0a20 2020 2022 746f 6b79  oday",.    "toky
+00012360: 6f22 2c0a 2020 2020 2274 6f6f 6c73 222c  o",.    "tools",
+00012370: 0a20 2020 2022 746f 7022 2c0a 2020 2020  .    "top",.    
+00012380: 2274 6f72 6179 222c 0a20 2020 2022 746f  "toray",.    "to
+00012390: 7368 6962 6122 2c0a 2020 2020 2274 6f74  shiba",.    "tot
+000123a0: 616c 222c 0a20 2020 2022 746f 7572 7322  al",.    "tours"
+000123b0: 2c0a 2020 2020 2274 6f77 6e22 2c0a 2020  ,.    "town",.  
+000123c0: 2020 2274 6f79 6f74 6122 2c0a 2020 2020    "toyota",.    
+000123d0: 2274 6f79 7322 2c0a 2020 2020 2274 7222  "toys",.    "tr"
+000123e0: 2c0a 2020 2020 2274 7261 6465 222c 0a20  ,.    "trade",. 
+000123f0: 2020 2022 7472 6164 696e 6722 2c0a 2020     "trading",.  
+00012400: 2020 2274 7261 696e 696e 6722 2c0a 2020    "training",.  
+00012410: 2020 2274 7261 7665 6c22 2c0a 2020 2020    "travel",.    
+00012420: 2274 7261 7665 6c63 6861 6e6e 656c 222c  "travelchannel",
+00012430: 0a20 2020 2022 7472 6176 656c 6572 7322  .    "travelers"
+00012440: 2c0a 2020 2020 2274 7261 7665 6c65 7273  ,.    "travelers
+00012450: 696e 7375 7261 6e63 6522 2c0a 2020 2020  insurance",.    
+00012460: 2274 7275 7374 222c 0a20 2020 2022 7472  "trust",.    "tr
+00012470: 7622 2c0a 2020 2020 2274 7422 2c0a 2020  v",.    "tt",.  
+00012480: 2020 2274 7562 6522 2c0a 2020 2020 2274    "tube",.    "t
+00012490: 7569 222c 0a20 2020 2022 7475 6e65 7322  ui",.    "tunes"
+000124a0: 2c0a 2020 2020 2274 7573 6875 222c 0a20  ,.    "tushu",. 
+000124b0: 2020 2022 7476 222c 0a20 2020 2022 7476     "tv",.    "tv
+000124c0: 7322 2c0a 2020 2020 2274 7722 2c0a 2020  s",.    "tw",.  
+000124d0: 2020 2274 7a22 2c0a 2020 2020 2320 750a    "tz",.    # u.
+000124e0: 2020 2020 2275 6122 2c0a 2020 2020 2275      "ua",.    "u
+000124f0: 6261 6e6b 222c 0a20 2020 2022 7562 7322  bank",.    "ubs"
+00012500: 2c0a 2020 2020 2275 636f 6e6e 6563 7422  ,.    "uconnect"
+00012510: 2c0a 2020 2020 2275 6722 2c0a 2020 2020  ,.    "ug",.    
+00012520: 2275 6b22 2c0a 2020 2020 2275 6e69 636f  "uk",.    "unico
+00012530: 6d22 2c0a 2020 2020 2275 6e69 7665 7273  m",.    "univers
+00012540: 6974 7922 2c0a 2020 2020 2275 6e6f 222c  ity",.    "uno",
+00012550: 0a20 2020 2022 756f 6c22 2c0a 2020 2020  .    "uol",.    
+00012560: 2275 7073 222c 0a20 2020 2022 7573 222c  "ups",.    "us",
+00012570: 0a20 2020 2022 7579 222c 0a20 2020 2022  .    "uy",.    "
+00012580: 757a 222c 0a20 2020 2023 2076 0a20 2020  uz",.    # v.   
+00012590: 2022 7661 222c 0a20 2020 2022 7661 6361   "va",.    "vaca
+000125a0: 7469 6f6e 7322 2c0a 2020 2020 2276 616e  tions",.    "van
+000125b0: 6122 2c0a 2020 2020 2276 616e 6775 6172  a",.    "vanguar
+000125c0: 6422 2c0a 2020 2020 2276 6322 2c0a 2020  d",.    "vc",.  
+000125d0: 2020 2276 6522 2c0a 2020 2020 2276 6567    "ve",.    "veg
+000125e0: 6173 222c 0a20 2020 2022 7665 6e74 7572  as",.    "ventur
+000125f0: 6573 222c 0a20 2020 2022 7665 7269 7369  es",.    "verisi
+00012600: 676e 222c 0a20 2020 2022 7665 7273 6963  gn",.    "versic
+00012610: 6865 7275 6e67 222c 0a20 2020 2022 7665  herung",.    "ve
+00012620: 7422 2c0a 2020 2020 2276 6722 2c0a 2020  t",.    "vg",.  
+00012630: 2020 2276 6922 2c0a 2020 2020 2276 6961    "vi",.    "via
+00012640: 6a65 7322 2c0a 2020 2020 2276 6964 656f  jes",.    "video
+00012650: 222c 0a20 2020 2022 7669 6722 2c0a 2020  ",.    "vig",.  
+00012660: 2020 2276 696b 696e 6722 2c0a 2020 2020    "viking",.    
+00012670: 2276 696c 6c61 7322 2c0a 2020 2020 2276  "villas",.    "v
+00012680: 696e 222c 0a20 2020 2022 7669 7022 2c0a  in",.    "vip",.
+00012690: 2020 2020 2276 6972 6769 6e22 2c0a 2020      "virgin",.  
+000126a0: 2020 2276 6973 6122 2c0a 2020 2020 2276    "visa",.    "v
+000126b0: 6973 696f 6e22 2c0a 2020 2020 2276 6973  ision",.    "vis
+000126c0: 7461 222c 0a20 2020 2022 7669 7374 6170  ta",.    "vistap
+000126d0: 7269 6e74 222c 0a20 2020 2022 7669 7661  rint",.    "viva
+000126e0: 222c 0a20 2020 2022 7669 766f 222c 0a20  ",.    "vivo",. 
+000126f0: 2020 2022 766c 6161 6e64 6572 656e 222c     "vlaanderen",
+00012700: 0a20 2020 2022 766e 222c 0a20 2020 2022  .    "vn",.    "
+00012710: 766f 646b 6122 2c0a 2020 2020 2276 6f6c  vodka",.    "vol
+00012720: 6b73 7761 6765 6e22 2c0a 2020 2020 2276  kswagen",.    "v
+00012730: 6f6c 766f 222c 0a20 2020 2022 766f 7465  olvo",.    "vote
+00012740: 222c 0a20 2020 2022 766f 7469 6e67 222c  ",.    "voting",
+00012750: 0a20 2020 2022 766f 746f 222c 0a20 2020  .    "voto",.   
+00012760: 2022 766f 7961 6765 222c 0a20 2020 2022   "voyage",.    "
+00012770: 7675 222c 0a20 2020 2022 7675 656c 6f73  vu",.    "vuelos
+00012780: 222c 0a20 2020 2023 2077 0a20 2020 2022  ",.    # w.    "
+00012790: 7761 6c65 7322 2c0a 2020 2020 2277 616c  wales",.    "wal
+000127a0: 6d61 7274 222c 0a20 2020 2022 7761 6c74  mart",.    "walt
+000127b0: 6572 222c 0a20 2020 2022 7761 6e67 222c  er",.    "wang",
+000127c0: 0a20 2020 2022 7761 6e67 676f 7522 2c0a  .    "wanggou",.
+000127d0: 2020 2020 2277 6172 6d61 6e22 2c0a 2020      "warman",.  
+000127e0: 2020 2277 6174 6368 222c 0a20 2020 2022    "watch",.    "
+000127f0: 7761 7463 6865 7322 2c0a 2020 2020 2277  watches",.    "w
+00012800: 6561 7468 6572 222c 0a20 2020 2022 7765  eather",.    "we
+00012810: 6174 6865 7263 6861 6e6e 656c 222c 0a20  atherchannel",. 
+00012820: 2020 2022 7765 6263 616d 222c 0a20 2020     "webcam",.   
+00012830: 2022 7765 6265 7222 2c0a 2020 2020 2277   "weber",.    "w
+00012840: 6562 7369 7465 222c 0a20 2020 2022 7765  ebsite",.    "we
+00012850: 6422 2c0a 2020 2020 2277 6564 6469 6e67  d",.    "wedding
+00012860: 222c 0a20 2020 2022 7765 6962 6f22 2c0a  ",.    "weibo",.
+00012870: 2020 2020 2277 6569 7222 2c0a 2020 2020      "weir",.    
+00012880: 2277 6622 2c0a 2020 2020 2277 686f 7377  "wf",.    "whosw
+00012890: 686f 222c 0a20 2020 2022 7769 656e 222c  ho",.    "wien",
+000128a0: 0a20 2020 2022 7769 6b69 222c 0a20 2020  .    "wiki",.   
+000128b0: 2022 7769 6c6c 6961 6d68 696c 6c22 2c0a   "williamhill",.
+000128c0: 2020 2020 2277 696e 222c 0a20 2020 2022      "win",.    "
+000128d0: 7769 6e64 6f77 7322 2c0a 2020 2020 2277  windows",.    "w
+000128e0: 696e 6522 2c0a 2020 2020 2277 696e 6e65  ine",.    "winne
+000128f0: 7273 222c 0a20 2020 2022 776d 6522 2c0a  rs",.    "wme",.
+00012900: 2020 2020 2277 6f6c 7465 7273 6b6c 7577      "wolterskluw
+00012910: 6572 222c 0a20 2020 2022 776f 6f64 7369  er",.    "woodsi
+00012920: 6465 222c 0a20 2020 2022 776f 726b 222c  de",.    "work",
+00012930: 0a20 2020 2022 776f 726b 7322 2c0a 2020  .    "works",.  
+00012940: 2020 2277 6f72 6c64 222c 0a20 2020 2022    "world",.    "
+00012950: 776f 7722 2c0a 2020 2020 2277 7322 2c0a  wow",.    "ws",.
+00012960: 2020 2020 2277 7463 222c 0a20 2020 2022      "wtc",.    "
+00012970: 7774 6622 2c0a 2020 2020 2320 780a 2020  wtf",.    # x.  
+00012980: 2020 2278 626f 7822 2c0a 2020 2020 2278    "xbox",.    "x
+00012990: 6572 6f78 222c 0a20 2020 2022 7866 696e  erox",.    "xfin
+000129a0: 6974 7922 2c0a 2020 2020 2278 6968 7561  ity",.    "xihua
+000129b0: 6e22 2c0a 2020 2020 2278 696e 222c 0a20  n",.    "xin",. 
+000129c0: 2020 2022 786e 2d2d 3131 6234 6333 6422     "xn--11b4c3d"
+000129d0: 2c0a 2020 2020 2278 6e2d 2d31 636b 3265  ,.    "xn--1ck2e
+000129e0: 3162 222c 0a20 2020 2022 786e 2d2d 3171  1b",.    "xn--1q
+000129f0: 7177 3233 6122 2c0a 2020 2020 2278 6e2d  qw23a",.    "xn-
+00012a00: 2d32 7363 726a 3963 222c 0a20 2020 2022  -2scrj9c",.    "
+00012a10: 786e 2d2d 3330 7272 3779 222c 0a20 2020  xn--30rr7y",.   
+00012a20: 2022 786e 2d2d 3362 7374 3030 6d22 2c0a   "xn--3bst00m",.
+00012a30: 2020 2020 2278 6e2d 2d33 6473 3434 3367      "xn--3ds443g
+00012a40: 222c 0a20 2020 2022 786e 2d2d 3365 3062  ",.    "xn--3e0b
+00012a50: 3730 3765 222c 0a20 2020 2022 786e 2d2d  707e",.    "xn--
+00012a60: 3368 6372 6a39 6322 2c0a 2020 2020 2278  3hcrj9c",.    "x
+00012a70: 6e2d 2d33 6f71 3138 766c 3870 6e33 3661  n--3oq18vl8pn36a
+00012a80: 222c 0a20 2020 2022 786e 2d2d 3370 7875  ",.    "xn--3pxu
+00012a90: 386b 222c 0a20 2020 2022 786e 2d2d 3432  8k",.    "xn--42
+00012aa0: 6332 6439 6122 2c0a 2020 2020 2278 6e2d  c2d9a",.    "xn-
+00012ab0: 2d34 3562 7235 6379 6c22 2c0a 2020 2020  -45br5cyl",.    
+00012ac0: 2278 6e2d 2d34 3562 726a 3963 222c 0a20  "xn--45brj9c",. 
+00012ad0: 2020 2022 786e 2d2d 3435 7131 3163 222c     "xn--45q11c",
+00012ae0: 0a20 2020 2022 786e 2d2d 3467 6272 696d  .    "xn--4gbrim
+00012af0: 222c 0a20 2020 2022 786e 2d2d 3534 6237  ",.    "xn--54b7
+00012b00: 6674 6130 6363 222c 0a20 2020 2022 786e  fta0cc",.    "xn
+00012b10: 2d2d 3535 7177 3432 6722 2c0a 2020 2020  --55qw42g",.    
+00012b20: 2278 6e2d 2d35 3571 7835 6422 2c0a 2020  "xn--55qx5d",.  
+00012b30: 2020 2278 6e2d 2d35 7375 3334 6a39 3336    "xn--5su34j936
+00012b40: 6267 7367 222c 0a20 2020 2022 786e 2d2d  bgsg",.    "xn--
+00012b50: 3574 7a6d 3567 222c 0a20 2020 2022 786e  5tzm5g",.    "xn
+00012b60: 2d2d 3666 727a 3832 6722 2c0a 2020 2020  --6frz82g",.    
+00012b70: 2278 6e2d 2d36 7171 3938 3662 3378 6c22  "xn--6qq986b3xl"
+00012b80: 2c0a 2020 2020 2278 6e2d 2d38 3061 6478  ,.    "xn--80adx
+00012b90: 686b 7322 2c0a 2020 2020 2278 6e2d 2d38  hks",.    "xn--8
+00012ba0: 3061 6f32 3161 222c 0a20 2020 2022 786e  0ao21a",.    "xn
+00012bb0: 2d2d 3830 6171 6563 6472 3161 222c 0a20  --80aqecdr1a",. 
+00012bc0: 2020 2022 786e 2d2d 3830 6173 6568 6462     "xn--80asehdb
+00012bd0: 222c 0a20 2020 2022 786e 2d2d 3830 6173  ",.    "xn--80as
+00012be0: 7767 222c 0a20 2020 2022 786e 2d2d 3879  wg",.    "xn--8y
+00012bf0: 3061 3036 3361 222c 0a20 2020 2022 786e  0a063a",.    "xn
+00012c00: 2d2d 3930 6133 6163 222c 0a20 2020 2022  --90a3ac",.    "
+00012c10: 786e 2d2d 3930 6165 222c 0a20 2020 2022  xn--90ae",.    "
+00012c20: 786e 2d2d 3930 6169 7322 2c0a 2020 2020  xn--90ais",.    
+00012c30: 2278 6e2d 2d39 6462 7132 6122 2c0a 2020  "xn--9dbq2a",.  
+00012c40: 2020 2278 6e2d 2d39 6574 3532 7522 2c0a    "xn--9et52u",.
+00012c50: 2020 2020 2278 6e2d 2d39 6b72 7430 3061      "xn--9krt00a
+00012c60: 222c 0a20 2020 2022 786e 2d2d 6234 7736  ",.    "xn--b4w6
+00012c70: 3035 6665 7264 222c 0a20 2020 2022 786e  05ferd",.    "xn
+00012c80: 2d2d 6263 6b31 6239 6135 6472 6534 6322  --bck1b9a5dre4c"
+00012c90: 2c0a 2020 2020 2278 6e2d 2d63 3161 7667  ,.    "xn--c1avg
+00012ca0: 222c 0a20 2020 2022 786e 2d2d 6332 6272  ",.    "xn--c2br
+00012cb0: 3767 222c 0a20 2020 2022 786e 2d2d 6363  7g",.    "xn--cc
+00012cc0: 6b32 6233 6222 2c0a 2020 2020 2278 6e2d  k2b3b",.    "xn-
+00012cd0: 2d63 6734 626b 6922 2c0a 2020 2020 2278  -cg4bki",.    "x
+00012ce0: 6e2d 2d63 6c63 6863 3065 6130 6232 6732  n--clchc0ea0b2g2
+00012cf0: 6139 6763 6422 2c0a 2020 2020 2278 6e2d  a9gcd",.    "xn-
+00012d00: 2d63 7a72 3639 3462 222c 0a20 2020 2022  -czr694b",.    "
+00012d10: 786e 2d2d 637a 7273 3074 222c 0a20 2020  xn--czrs0t",.   
+00012d20: 2022 786e 2d2d 637a 7275 3264 222c 0a20   "xn--czru2d",. 
+00012d30: 2020 2022 786e 2d2d 6431 6163 6a33 6222     "xn--d1acj3b"
+00012d40: 2c0a 2020 2020 2278 6e2d 2d64 3161 6c66  ,.    "xn--d1alf
+00012d50: 222c 0a20 2020 2022 786e 2d2d 6531 6134  ",.    "xn--e1a4
+00012d60: 6322 2c0a 2020 2020 2278 6e2d 2d65 636b  c",.    "xn--eck
+00012d70: 7664 7463 3964 222c 0a20 2020 2022 786e  vdtc9d",.    "xn
+00012d80: 2d2d 6566 7679 3838 6822 2c0a 2020 2020  --efvy88h",.    
+00012d90: 2278 6e2d 2d65 7374 7637 3567 222c 0a20  "xn--estv75g",. 
+00012da0: 2020 2022 786e 2d2d 6663 7434 3239 6b22     "xn--fct429k"
+00012db0: 2c0a 2020 2020 2278 6e2d 2d66 6862 6569  ,.    "xn--fhbei
+00012dc0: 222c 0a20 2020 2022 786e 2d2d 6669 7132  ",.    "xn--fiq2
+00012dd0: 3238 6335 6873 222c 0a20 2020 2022 786e  28c5hs",.    "xn
+00012de0: 2d2d 6669 7136 3462 222c 0a20 2020 2022  --fiq64b",.    "
+00012df0: 786e 2d2d 6669 7173 3873 222c 0a20 2020  xn--fiqs8s",.   
+00012e00: 2022 786e 2d2d 6669 717a 3973 222c 0a20   "xn--fiqz9s",. 
+00012e10: 2020 2022 786e 2d2d 666a 7137 3230 6122     "xn--fjq720a"
+00012e20: 2c0a 2020 2020 2278 6e2d 2d66 6c77 3335  ,.    "xn--flw35
+00012e30: 3165 222c 0a20 2020 2022 786e 2d2d 6670  1e",.    "xn--fp
+00012e40: 6372 6a39 6333 6422 2c0a 2020 2020 2278  crj9c3d",.    "x
+00012e50: 6e2d 2d66 7a63 3263 3965 3263 222c 0a20  n--fzc2c9e2c",. 
+00012e60: 2020 2022 786e 2d2d 667a 7973 3864 3639     "xn--fzys8d69
+00012e70: 7576 676d 222c 0a20 2020 2022 786e 2d2d  uvgm",.    "xn--
+00012e80: 6732 7878 3438 6322 2c0a 2020 2020 2278  g2xx48c",.    "x
+00012e90: 6e2d 2d67 636b 7233 6630 6622 2c0a 2020  n--gckr3f0f",.  
+00012ea0: 2020 2278 6e2d 2d67 6563 726a 3963 222c    "xn--gecrj9c",
+00012eb0: 0a20 2020 2022 786e 2d2d 676b 3361 7431  .    "xn--gk3at1
+00012ec0: 6522 2c0a 2020 2020 2278 6e2d 2d68 3262  e",.    "xn--h2b
+00012ed0: 7265 6733 6576 6522 2c0a 2020 2020 2278  reg3eve",.    "x
+00012ee0: 6e2d 2d68 3262 726a 3963 222c 0a20 2020  n--h2brj9c",.   
+00012ef0: 2022 786e 2d2d 6832 6272 6a39 6338 6322   "xn--h2brj9c8c"
+00012f00: 2c0a 2020 2020 2278 6e2d 2d68 7874 3831  ,.    "xn--hxt81
+00012f10: 3465 222c 0a20 2020 2022 786e 2d2d 6931  4e",.    "xn--i1
+00012f20: 6236 6231 6136 6132 6522 2c0a 2020 2020  b6b1a6a2e",.    
+00012f30: 2278 6e2d 2d69 6d72 3531 336e 222c 0a20  "xn--imr513n",. 
+00012f40: 2020 2022 786e 2d2d 696f 3061 3769 222c     "xn--io0a7i",
+00012f50: 0a20 2020 2022 786e 2d2d 6a31 6165 6622  .    "xn--j1aef"
+00012f60: 2c0a 2020 2020 2278 6e2d 2d6a 3161 6d68  ,.    "xn--j1amh
+00012f70: 222c 0a20 2020 2022 786e 2d2d 6a36 7731  ",.    "xn--j6w1
+00012f80: 3933 6722 2c0a 2020 2020 2278 6e2d 2d6a  93g",.    "xn--j
+00012f90: 6c71 3631 7539 7737 6222 2c0a 2020 2020  lq61u9w7b",.    
+00012fa0: 2278 6e2d 2d6a 7672 3138 396d 222c 0a20  "xn--jvr189m",. 
+00012fb0: 2020 2022 786e 2d2d 6b63 7278 3737 6431     "xn--kcrx77d1
+00012fc0: 7834 6122 2c0a 2020 2020 2278 6e2d 2d6b  x4a",.    "xn--k
+00012fd0: 7072 7731 3364 222c 0a20 2020 2022 786e  prw13d",.    "xn
+00012fe0: 2d2d 6b70 7279 3537 6422 2c0a 2020 2020  --kpry57d",.    
+00012ff0: 2278 6e2d 2d6b 7075 3731 3666 222c 0a20  "xn--kpu716f",. 
+00013000: 2020 2022 786e 2d2d 6b70 7574 3369 222c     "xn--kput3i",
+00013010: 0a20 2020 2022 786e 2d2d 6c31 6163 6322  .    "xn--l1acc"
+00013020: 2c0a 2020 2020 2278 6e2d 2d6c 6762 6261  ,.    "xn--lgbba
+00013030: 7431 6164 386a 222c 0a20 2020 2022 786e  t1ad8j",.    "xn
+00013040: 2d2d 6d67 6239 6177 6266 222c 0a20 2020  --mgb9awbf",.   
+00013050: 2022 786e 2d2d 6d67 6261 3361 3365 6a74   "xn--mgba3a3ejt
+00013060: 222c 0a20 2020 2022 786e 2d2d 6d67 6261  ",.    "xn--mgba
+00013070: 3361 3466 3136 6122 2c0a 2020 2020 2278  3a4f16a",.    "x
+00013080: 6e2d 2d6d 6762 6137 6330 6262 6e30 6122  n--mgba7c0bbn0a"
+00013090: 2c0a 2020 2020 2278 6e2d 2d6d 6762 6161  ,.    "xn--mgbaa
+000130a0: 6b63 3764 7666 222c 0a20 2020 2022 786e  kc7dvf",.    "xn
+000130b0: 2d2d 6d67 6261 616d 3761 3868 222c 0a20  --mgbaam7a8h",. 
+000130c0: 2020 2022 786e 2d2d 6d67 6261 6232 6264     "xn--mgbab2bd
+000130d0: 222c 0a20 2020 2022 786e 2d2d 6d67 6261  ",.    "xn--mgba
+000130e0: 6939 617a 6771 7036 6a22 2c0a 2020 2020  i9azgqp6j",.    
+000130f0: 2278 6e2d 2d6d 6762 6179 6837 6770 6122  "xn--mgbayh7gpa"
+00013100: 2c0a 2020 2020 2278 6e2d 2d6d 6762 6239  ,.    "xn--mgbb9
+00013110: 6662 706f 6222 2c0a 2020 2020 2278 6e2d  fbpob",.    "xn-
+00013120: 2d6d 6762 6268 3161 222c 0a20 2020 2022  -mgbbh1a",.    "
+00013130: 786e 2d2d 6d67 6262 6831 6137 3165 222c  xn--mgbbh1a71e",
+00013140: 0a20 2020 2022 786e 2d2d 6d67 6263 3061  .    "xn--mgbc0a
+00013150: 3961 7a63 6722 2c0a 2020 2020 2278 6e2d  9azcg",.    "xn-
+00013160: 2d6d 6762 6361 3764 7a64 6f22 2c0a 2020  -mgbca7dzdo",.  
+00013170: 2020 2278 6e2d 2d6d 6762 6572 7034 6135    "xn--mgberp4a5
+00013180: 6434 6172 222c 0a20 2020 2022 786e 2d2d  d4ar",.    "xn--
+00013190: 6d67 6267 7538 3261 222c 0a20 2020 2022  mgbgu82a",.    "
+000131a0: 786e 2d2d 6d67 6269 3465 6365 7870 222c  xn--mgbi4ecexp",
+000131b0: 0a20 2020 2022 786e 2d2d 6d67 6270 6c32  .    "xn--mgbpl2
+000131c0: 6668 222c 0a20 2020 2022 786e 2d2d 6d67  fh",.    "xn--mg
+000131d0: 6274 3364 6864 222c 0a20 2020 2022 786e  bt3dhd",.    "xn
+000131e0: 2d2d 6d67 6274 7832 6222 2c0a 2020 2020  --mgbtx2b",.    
+000131f0: 2278 6e2d 2d6d 6762 7834 6364 3061 6222  "xn--mgbx4cd0ab"
+00013200: 2c0a 2020 2020 2278 6e2d 2d6d 6978 3839  ,.    "xn--mix89
+00013210: 3166 222c 0a20 2020 2022 786e 2d2d 6d6b  1f",.    "xn--mk
+00013220: 3162 7534 3463 222c 0a20 2020 2022 786e  1bu44c",.    "xn
+00013230: 2d2d 6d78 7471 316d 222c 0a20 2020 2022  --mxtq1m",.    "
+00013240: 786e 2d2d 6e67 6263 3561 7a64 222c 0a20  xn--ngbc5azd",. 
+00013250: 2020 2022 786e 2d2d 6e67 6265 3965 3061     "xn--ngbe9e0a
+00013260: 222c 0a20 2020 2022 786e 2d2d 6e67 6272  ",.    "xn--ngbr
+00013270: 7822 2c0a 2020 2020 2278 6e2d 2d6e 6f64  x",.    "xn--nod
+00013280: 6522 2c0a 2020 2020 2278 6e2d 2d6e 7176  e",.    "xn--nqv
+00013290: 3766 222c 0a20 2020 2022 786e 2d2d 6e71  7f",.    "xn--nq
+000132a0: 7637 6673 3030 656d 6122 2c0a 2020 2020  v7fs00ema",.    
+000132b0: 2278 6e2d 2d6e 7971 7932 3661 222c 0a20  "xn--nyqy26a",. 
+000132c0: 2020 2022 786e 2d2d 6f33 6377 3468 222c     "xn--o3cw4h",
+000132d0: 0a20 2020 2022 786e 2d2d 6f67 6270 6638  .    "xn--ogbpf8
+000132e0: 666c 222c 0a20 2020 2022 786e 2d2d 7031  fl",.    "xn--p1
+000132f0: 6163 6622 2c0a 2020 2020 2278 6e2d 2d70  acf",.    "xn--p
+00013300: 3161 6922 2c0a 2020 2020 2278 6e2d 2d70  1ai",.    "xn--p
+00013310: 6274 3937 3763 222c 0a20 2020 2022 786e  bt977c",.    "xn
+00013320: 2d2d 7067 6273 3064 6822 2c0a 2020 2020  --pgbs0dh",.    
+00013330: 2278 6e2d 2d70 7373 7932 7522 2c0a 2020  "xn--pssy2u",.  
+00013340: 2020 2278 6e2d 2d71 396a 7962 3463 222c    "xn--q9jyb4c",
+00013350: 0a20 2020 2022 786e 2d2d 7163 6b61 3170  .    "xn--qcka1p
+00013360: 6d63 222c 0a20 2020 2022 786e 2d2d 7178  mc",.    "xn--qx
+00013370: 616d 222c 0a20 2020 2022 786e 2d2d 7268  am",.    "xn--rh
+00013380: 7176 3936 6722 2c0a 2020 2020 2278 6e2d  qv96g",.    "xn-
+00013390: 2d72 6f76 7538 3862 222c 0a20 2020 2022  -rovu88b",.    "
+000133a0: 786e 2d2d 7276 6331 6530 616d 3365 222c  xn--rvc1e0am3e",
+000133b0: 0a20 2020 2022 786e 2d2d 7339 6272 6a39  .    "xn--s9brj9
+000133c0: 6322 2c0a 2020 2020 2278 6e2d 2d73 6573  c",.    "xn--ses
+000133d0: 3535 3467 222c 0a20 2020 2022 786e 2d2d  554g",.    "xn--
+000133e0: 7436 3062 3536 6122 2c0a 2020 2020 2278  t60b56a",.    "x
+000133f0: 6e2d 2d74 636b 7765 222c 0a20 2020 2022  n--tckwe",.    "
+00013400: 786e 2d2d 7469 7134 3978 7179 6a22 2c0a  xn--tiq49xqyj",.
+00013410: 2020 2020 2278 6e2d 2d75 6e75 7034 7922      "xn--unup4y"
+00013420: 2c0a 2020 2020 2278 6e2d 2d76 6572 6d67  ,.    "xn--vermg
+00013430: 656e 7362 6572 6174 6572 2d63 7462 222c  ensberater-ctb",
+00013440: 0a20 2020 2022 786e 2d2d 7665 726d 6765  .    "xn--vermge
+00013450: 6e73 6265 7261 7475 6e67 2d70 7762 222c  nsberatung-pwb",
+00013460: 0a20 2020 2022 786e 2d2d 7668 7175 7622  .    "xn--vhquv"
+00013470: 2c0a 2020 2020 2278 6e2d 2d76 7571 3836  ,.    "xn--vuq86
+00013480: 3162 222c 0a20 2020 2022 786e 2d2d 7734  1b",.    "xn--w4
+00013490: 7238 3565 6c38 6668 7535 646e 7261 222c  r85el8fhu5dnra",
+000134a0: 0a20 2020 2022 786e 2d2d 7734 7273 3430  .    "xn--w4rs40
+000134b0: 6c22 2c0a 2020 2020 2278 6e2d 2d77 6762  l",.    "xn--wgb
+000134c0: 6831 6322 2c0a 2020 2020 2278 6e2d 2d77  h1c",.    "xn--w
+000134d0: 6762 6c36 6122 2c0a 2020 2020 2278 6e2d  gbl6a",.    "xn-
+000134e0: 2d78 6871 3532 3162 222c 0a20 2020 2022  -xhq521b",.    "
+000134f0: 786e 2d2d 786b 6332 616c 3368 7965 3261  xn--xkc2al3hye2a
+00013500: 222c 0a20 2020 2022 786e 2d2d 786b 6332  ",.    "xn--xkc2
+00013510: 646c 3361 3565 6530 6822 2c0a 2020 2020  dl3a5ee0h",.    
+00013520: 2278 6e2d 2d79 3961 3361 7122 2c0a 2020  "xn--y9a3aq",.  
+00013530: 2020 2278 6e2d 2d79 6672 6f34 6936 376f    "xn--yfro4i67o
+00013540: 222c 0a20 2020 2022 786e 2d2d 7967 6269  ",.    "xn--ygbi
+00013550: 3261 6d6d 7822 2c0a 2020 2020 2278 6e2d  2ammx",.    "xn-
+00013560: 2d7a 6672 3136 3462 222c 0a20 2020 2022  -zfr164b",.    "
+00013570: 7870 6572 6961 222c 0a20 2020 2022 7878  xperia",.    "xx
+00013580: 7822 2c0a 2020 2020 2278 797a 222c 0a20  x",.    "xyz",. 
+00013590: 2020 2023 2079 0a20 2020 2022 7961 6368     # y.    "yach
+000135a0: 7473 222c 0a20 2020 2022 7961 686f 6f22  ts",.    "yahoo"
+000135b0: 2c0a 2020 2020 2279 616d 6178 756e 222c  ,.    "yamaxun",
+000135c0: 0a20 2020 2022 7961 6e64 6578 222c 0a20  .    "yandex",. 
+000135d0: 2020 2022 7965 222c 0a20 2020 2022 796f     "ye",.    "yo
+000135e0: 646f 6261 7368 6922 2c0a 2020 2020 2279  dobashi",.    "y
+000135f0: 6f67 6122 2c0a 2020 2020 2279 6f6b 6f68  oga",.    "yokoh
+00013600: 616d 6122 2c0a 2020 2020 2279 6f75 222c  ama",.    "you",
+00013610: 0a20 2020 2022 796f 7574 7562 6522 2c0a  .    "youtube",.
+00013620: 2020 2020 2279 7422 2c0a 2020 2020 2279      "yt",.    "y
+00013630: 756e 222c 0a20 2020 2023 207a 0a20 2020  un",.    # z.   
+00013640: 2022 7a61 222c 0a20 2020 2022 7a61 7070   "za",.    "zapp
+00013650: 6f73 222c 0a20 2020 2022 7a61 7261 222c  os",.    "zara",
+00013660: 0a20 2020 2022 7a65 726f 222c 0a20 2020  .    "zero",.   
+00013670: 2022 7a69 7022 2c0a 2020 2020 227a 6970   "zip",.    "zip
+00013680: 706f 222c 0a20 2020 2022 7a6d 222c 0a20  po",.    "zm",. 
+00013690: 2020 2022 7a6f 6e65 222c 0a20 2020 2022     "zone",.    "
+000136a0: 7a75 6572 6963 6822 2c0a 2020 2020 227a  zuerich",.    "z
+000136b0: 7722 2c0a 5d0a 0a0a 636c 6173 7320 4953  w",.]...class IS
+000136c0: 5f48 5454 505f 5552 4c28 5661 6c69 6461  _HTTP_URL(Valida
+000136d0: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
+000136e0: 2020 5265 6a65 6374 7320 6120 5552 4c20    Rejects a URL 
+000136f0: 7374 7269 6e67 2069 6620 616e 7920 6f66  string if any of
+00013700: 2074 6865 2066 6f6c 6c6f 7769 6e67 2069   the following i
+00013710: 7320 7472 7565 3a0a 2020 2020 2020 202a  s true:.       *
+00013720: 2054 6865 2073 7472 696e 6720 6973 2065   The string is e
+00013730: 6d70 7479 206f 7220 4e6f 6e65 0a20 2020  mpty or None.   
+00013740: 2020 2020 2a20 5468 6520 7374 7269 6e67      * The string
+00013750: 2075 7365 7320 6368 6172 6163 7465 7273   uses characters
+00013760: 2074 6861 7420 6172 6520 6e6f 7420 616c   that are not al
+00013770: 6c6f 7765 6420 696e 2061 2055 524c 0a20  lowed in a URL. 
+00013780: 2020 2020 2020 2a20 5468 6520 7374 7269        * The stri
+00013790: 6e67 2062 7265 616b 7320 616e 7920 6f66  ng breaks any of
+000137a0: 2074 6865 2048 5454 5020 7379 6e74 6163   the HTTP syntac
+000137b0: 7469 6320 7275 6c65 730a 2020 2020 2020  tic rules.      
+000137c0: 202a 2054 6865 2055 524c 2073 6368 656d   * The URL schem
+000137d0: 6520 7370 6563 6966 6965 6420 2869 6620  e specified (if 
+000137e0: 6f6e 6520 6973 2073 7065 6369 6669 6564  one is specified
+000137f0: 2920 6973 206e 6f74 2027 6874 7470 2720  ) is not 'http' 
+00013800: 6f72 2027 6874 7470 7327 0a20 2020 2020  or 'https'.     
+00013810: 2020 2a20 5468 6520 746f 702d 6c65 7665    * The top-leve
+00013820: 6c20 646f 6d61 696e 2028 6966 2061 2068  l domain (if a h
+00013830: 6f73 7420 6e61 6d65 2069 7320 7370 6563  ost name is spec
+00013840: 6966 6965 6429 2064 6f65 7320 6e6f 7420  ified) does not 
+00013850: 6578 6973 740a 0a20 2020 2042 6173 6564  exist..    Based
+00013860: 206f 6e20 5246 4320 3236 3136 3a20 6874   on RFC 2616: ht
+00013870: 7470 3a2f 2f77 7777 2e66 6171 732e 6f72  tp://www.faqs.or
+00013880: 672f 7266 6373 2f72 6663 3236 3136 2e68  g/rfcs/rfc2616.h
+00013890: 746d 6c0a 0a20 2020 2054 6869 7320 6675  tml..    This fu
+000138a0: 6e63 7469 6f6e 206f 6e6c 7920 6368 6563  nction only chec
+000138b0: 6b73 2074 6865 2055 524c 2773 2073 796e  ks the URL's syn
+000138c0: 7461 782e 2049 7420 646f 6573 206e 6f74  tax. It does not
+000138d0: 2063 6865 636b 2074 6861 7420 7468 6520   check that the 
+000138e0: 5552 4c0a 2020 2020 706f 696e 7473 2074  URL.    points t
+000138f0: 6f20 6120 7265 616c 2064 6f63 756d 656e  o a real documen
+00013900: 742c 2066 6f72 2065 7861 6d70 6c65 2c20  t, for example, 
+00013910: 6f72 2074 6861 7420 6974 206f 7468 6572  or that it other
+00013920: 7769 7365 206d 616b 6573 2073 656e 7365  wise makes sense
+00013930: 0a20 2020 2073 656d 616e 7469 6361 6c6c  .    semanticall
+00013940: 792e 2054 6869 7320 6675 6e63 7469 6f6e  y. This function
+00013950: 2064 6f65 7320 6175 746f 6d61 7469 6361   does automatica
+00013960: 6c6c 7920 7072 6570 656e 6420 2768 7474  lly prepend 'htt
+00013970: 703a 2f2f 2720 696e 2066 726f 6e74 0a20  p://' in front. 
+00013980: 2020 206f 6620 6120 5552 4c20 696e 2074     of a URL in t
+00013990: 6865 2063 6173 6520 6f66 2061 6e20 6162  he case of an ab
+000139a0: 6272 6576 6961 7465 6420 5552 4c20 2865  breviated URL (e
+000139b0: 2e67 2e20 2767 6f6f 676c 652e 6361 2729  .g. 'google.ca')
+000139c0: 2e0a 0a20 2020 2054 6865 206c 6973 7420  ...    The list 
+000139d0: 6f66 2061 6c6c 6f77 6564 2073 6368 656d  of allowed schem
+000139e0: 6573 2069 7320 6375 7374 6f6d 697a 6162  es is customizab
+000139f0: 6c65 2077 6974 6820 7468 6520 616c 6c6f  le with the allo
+00013a00: 7765 645f 7363 6865 6d65 730a 2020 2020  wed_schemes.    
+00013a10: 7061 7261 6d65 7465 722e 2049 6620 796f  parameter. If yo
+00013a20: 7520 6578 636c 7564 6520 4e6f 6e65 2066  u exclude None f
+00013a30: 726f 6d20 7468 6520 6c69 7374 2c20 7468  rom the list, th
+00013a40: 656e 2061 6262 7265 7669 6174 6564 2055  en abbreviated U
+00013a50: 524c 730a 2020 2020 286c 6163 6b69 6e67  RLs.    (lacking
+00013a60: 2061 2073 6368 656d 6520 7375 6368 2061   a scheme such a
+00013a70: 7320 2768 7474 7027 2920 7769 6c6c 2062  s 'http') will b
+00013a80: 6520 7265 6a65 6374 6564 2e0a 0a20 2020  e rejected...   
+00013a90: 2054 6865 2064 6566 6175 6c74 2070 7265   The default pre
+00013aa0: 7065 6e64 6564 2073 6368 656d 6520 6973  pended scheme is
+00013ab0: 2063 7573 746f 6d69 7a61 626c 6520 7769   customizable wi
+00013ac0: 7468 2074 6865 2070 7265 7065 6e64 5f73  th the prepend_s
+00013ad0: 6368 656d 650a 2020 2020 7061 7261 6d65  cheme.    parame
+00013ae0: 7465 722e 2049 6620 796f 7520 7365 7420  ter. If you set 
+00013af0: 7072 6570 656e 645f 7363 6865 6d65 2074  prepend_scheme t
+00013b00: 6f20 4e6f 6e65 2074 6865 6e20 7072 6570  o None then prep
+00013b10: 656e 6469 6e67 2077 696c 6c20 6265 0a20  ending will be. 
+00013b20: 2020 2064 6973 6162 6c65 642e 2055 524c     disabled. URL
+00013b30: 7320 7468 6174 2072 6571 7569 7265 2070  s that require p
+00013b40: 7265 7065 6e64 696e 6720 746f 2070 6172  repending to par
+00013b50: 7365 2077 696c 6c20 7374 696c 6c20 6265  se will still be
+00013b60: 2061 6363 6570 7465 642c 0a20 2020 2062   accepted,.    b
+00013b70: 7574 2074 6865 2072 6574 7572 6e20 7661  ut the return va
+00013b80: 6c75 6520 7769 6c6c 206e 6f74 2062 6520  lue will not be 
+00013b90: 6d6f 6469 6669 6564 2e0a 0a20 2020 2040  modified...    @
+00013ba0: 6175 7468 6f72 3a20 4a6f 6e61 7468 616e  author: Jonathan
+00013bb0: 2042 656e 6e0a 0a20 2020 2020 2020 203e   Benn..        >
+00013bc0: 3e3e 2049 535f 4854 5450 5f55 524c 2829  >> IS_HTTP_URL()
+00013bd0: 2827 6874 7470 3a2f 2f31 2e32 2e33 2e34  ('http://1.2.3.4
+00013be0: 2729 0a20 2020 2020 2020 2028 2768 7474  ').        ('htt
+00013bf0: 703a 2f2f 312e 322e 332e 3427 2c20 4e6f  p://1.2.3.4', No
+00013c00: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+00013c10: 4953 5f48 5454 505f 5552 4c28 2928 2768  IS_HTTP_URL()('h
+00013c20: 7474 703a 2f2f 6162 632e 636f 6d27 290a  ttp://abc.com').
+00013c30: 2020 2020 2020 2020 2827 6874 7470 3a2f          ('http:/
+00013c40: 2f61 6263 2e63 6f6d 272c 204e 6f6e 6529  /abc.com', None)
+00013c50: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+00013c60: 4854 5450 5f55 524c 2829 2827 6874 7470  HTTP_URL()('http
+00013c70: 733a 2f2f 6162 632e 636f 6d27 290a 2020  s://abc.com').  
+00013c80: 2020 2020 2020 2827 6874 7470 733a 2f2f        ('https://
+00013c90: 6162 632e 636f 6d27 2c20 4e6f 6e65 290a  abc.com', None).
+00013ca0: 2020 2020 2020 2020 3e3e 3e20 4953 5f48          >>> IS_H
+00013cb0: 5454 505f 5552 4c28 2928 2768 7474 7078  TTP_URL()('httpx
+00013cc0: 3a2f 2f61 6263 2e63 6f6d 2729 0a20 2020  ://abc.com').   
+00013cd0: 2020 2020 2028 2768 7474 7078 3a2f 2f61       ('httpx://a
+00013ce0: 6263 2e63 6f6d 272c 2027 656e 7465 7220  bc.com', 'enter 
+00013cf0: 6120 7661 6c69 6420 5552 4c27 290a 2020  a valid URL').  
+00013d00: 2020 2020 2020 3e3e 3e20 4953 5f48 5454        >>> IS_HTT
+00013d10: 505f 5552 4c28 2928 2768 7474 703a 2f2f  P_URL()('http://
+00013d20: 6162 632e 636f 6d3a 3830 2729 0a20 2020  abc.com:80').   
+00013d30: 2020 2020 2028 2768 7474 703a 2f2f 6162       ('http://ab
+00013d40: 632e 636f 6d3a 3830 272c 204e 6f6e 6529  c.com:80', None)
+00013d50: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+00013d60: 4854 5450 5f55 524c 2829 2827 6874 7470  HTTP_URL()('http
+00013d70: 3a2f 2f75 7365 7240 6162 632e 636f 6d27  ://user@abc.com'
+00013d80: 290a 2020 2020 2020 2020 2827 6874 7470  ).        ('http
+00013d90: 3a2f 2f75 7365 7240 6162 632e 636f 6d27  ://user@abc.com'
+00013da0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00013db0: 3e3e 3e20 4953 5f48 5454 505f 5552 4c28  >>> IS_HTTP_URL(
+00013dc0: 2928 2768 7474 703a 2f2f 7573 6572 4031  )('http://user@1
+00013dd0: 2e32 2e33 2e34 2729 0a20 2020 2020 2020  .2.3.4').       
+00013de0: 2028 2768 7474 703a 2f2f 7573 6572 4031   ('http://user@1
+00013df0: 2e32 2e33 2e34 272c 204e 6f6e 6529 0a0a  .2.3.4', None)..
+00013e00: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00013e10: 2020 6572 726f 725f 6d65 7373 6167 653a    error_message:
+00013e20: 2061 2073 7472 696e 672c 2074 6865 2065   a string, the e
+00013e30: 7272 6f72 206d 6573 7361 6765 2074 6f20  rror message to 
+00013e40: 6769 7665 2074 6865 2065 6e64 2075 7365  give the end use
+00013e50: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
+00013e60: 2074 6865 2055 524c 2064 6f65 7320 6e6f   the URL does no
+00013e70: 7420 7661 6c69 6461 7465 0a20 2020 2020  t validate.     
+00013e80: 2020 2061 6c6c 6f77 6564 5f73 6368 656d     allowed_schem
+00013e90: 6573 3a20 6120 6c69 7374 2063 6f6e 7461  es: a list conta
+00013ea0: 696e 696e 6720 7374 7269 6e67 7320 6f72  ining strings or
+00013eb0: 204e 6f6e 652e 2045 6163 6820 656c 656d   None. Each elem
+00013ec0: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+00013ed0: 6973 2061 2073 6368 656d 6520 7468 6520  is a scheme the 
+00013ee0: 696e 7075 7474 6564 2055 524c 2069 7320  inputted URL is 
+00013ef0: 616c 6c6f 7765 6420 746f 2075 7365 0a20  allowed to use. 
+00013f00: 2020 2020 2020 2070 7265 7065 6e64 5f73         prepend_s
+00013f10: 6368 656d 653a 2061 2073 7472 696e 672c  cheme: a string,
+00013f20: 2074 6869 7320 7363 6865 6d65 2069 7320   this scheme is 
+00013f30: 7072 6570 656e 6465 6420 6966 2069 7427  prepended if it'
+00013f40: 730a 2020 2020 2020 2020 2020 2020 6e65  s.            ne
+00013f50: 6365 7373 6172 7920 746f 206d 616b 6520  cessary to make 
+00013f60: 7468 6520 5552 4c20 7661 6c69 640a 2020  the URL valid.  
+00013f70: 2020 2222 220a 0a20 2020 2052 4547 4558    """..    REGEX
+00013f80: 5f47 454e 4552 4943 5f56 414c 4944 5f49  _GENERIC_VALID_I
+00013f90: 5020 3d20 7222 285b 5c77 2e21 7e2a 277c  P = r"([\w.!~*'|
+00013fa0: 3b3a 263d 2b24 2c2d 5d2b 4029 3f5c 642b  ;:&=+$,-]+@)?\d+
+00013fb0: 5c2e 5c64 2b5c 2e5c 642b 5c2e 5c64 2b28  \.\d+\.\d+\.\d+(
+00013fc0: 3a5c 642a 292a 2422 0a20 2020 2052 4547  :\d*)*$".    REG
+00013fd0: 4558 5f47 454e 4552 4943 5f56 414c 4944  EX_GENERIC_VALID
+00013fe0: 5f44 4f4d 4149 4e20 3d20 7222 285b 5c77  _DOMAIN = r"([\w
+00013ff0: 2e21 7e2a 277c 3b3a 263d 2b24 2c2d 5d2b  .!~*'|;:&=+$,-]+
+00014000: 4029 3f28 285b 412d 5a61 2d7a 302d 395d  @)?(([A-Za-z0-9]
+00014010: 2b5b 412d 5a61 2d7a 302d 395c 2d5d 2a5b  +[A-Za-z0-9\-]*[
+00014020: 412d 5a61 2d7a 302d 395d 2b5c 2e29 2a28  A-Za-z0-9]+\.)*(
+00014030: 5b41 2d5a 612d 7a30 2d39 5d2b 5c2e 292a  [A-Za-z0-9]+\.)*
+00014040: 292a 285b 412d 5a61 2d7a 5d2b 5b41 2d5a  )*([A-Za-z]+[A-Z
+00014050: 612d 7a30 2d39 5c2d 5d2a 5b41 2d5a 612d  a-z0-9\-]*[A-Za-
+00014060: 7a30 2d39 5d2b 295c 2e3f 283a 5c64 2a29  z0-9]+)\.?(:\d*)
+00014070: 2a24 220a 0a20 2020 2064 6566 205f 5f69  *$"..    def __i
+00014080: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
+00014090: 656c 662c 0a20 2020 2020 2020 2065 7272  elf,.        err
+000140a0: 6f72 5f6d 6573 7361 6765 3d22 456e 7465  or_message="Ente
+000140b0: 7220 6120 7661 6c69 6420 5552 4c22 2c0a  r a valid URL",.
+000140c0: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
+000140d0: 7363 6865 6d65 733d 4e6f 6e65 2c0a 2020  schemes=None,.  
+000140e0: 2020 2020 2020 7072 6570 656e 645f 7363        prepend_sc
+000140f0: 6865 6d65 3d22 6874 7470 222c 0a20 2020  heme="http",.   
+00014100: 2020 2020 2061 6c6c 6f77 6564 5f74 6c64       allowed_tld
+00014110: 733d 4e6f 6e65 2c0a 2020 2020 293a 0a20  s=None,.    ):. 
+00014120: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
+00014130: 725f 6d65 7373 6167 6520 3d20 6572 726f  r_message = erro
+00014140: 725f 6d65 7373 6167 650a 2020 2020 2020  r_message.      
+00014150: 2020 6966 2061 6c6c 6f77 6564 5f73 6368    if allowed_sch
+00014160: 656d 6573 2069 7320 4e6f 6e65 3a0a 2020  emes is None:.  
+00014170: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014180: 6c6c 6f77 6564 5f73 6368 656d 6573 203d  llowed_schemes =
+00014190: 2068 7474 705f 7363 6865 6d65 730a 2020   http_schemes.  
+000141a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000141b0: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
+000141c0: 6f77 6564 5f73 6368 656d 6573 203d 2061  owed_schemes = a
+000141d0: 6c6c 6f77 6564 5f73 6368 656d 6573 0a20  llowed_schemes. 
+000141e0: 2020 2020 2020 2069 6620 616c 6c6f 7765         if allowe
+000141f0: 645f 746c 6473 2069 7320 4e6f 6e65 3a0a  d_tlds is None:.
+00014200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014210: 2e61 6c6c 6f77 6564 5f74 6c64 7320 3d20  .allowed_tlds = 
+00014220: 6f66 6669 6369 616c 5f74 6f70 5f6c 6576  official_top_lev
+00014230: 656c 5f64 6f6d 6169 6e73 0a20 2020 2020  el_domains.     
+00014240: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00014250: 2020 2020 2073 656c 662e 616c 6c6f 7765       self.allowe
+00014260: 645f 746c 6473 203d 2061 6c6c 6f77 6564  d_tlds = allowed
+00014270: 5f74 6c64 730a 2020 2020 2020 2020 7365  _tlds.        se
+00014280: 6c66 2e70 7265 7065 6e64 5f73 6368 656d  lf.prepend_schem
+00014290: 6520 3d20 7072 6570 656e 645f 7363 6865  e = prepend_sche
+000142a0: 6d65 0a0a 2020 2020 2020 2020 666f 7220  me..        for 
+000142b0: 6920 696e 2073 656c 662e 616c 6c6f 7765  i in self.allowe
+000142c0: 645f 7363 6865 6d65 733a 0a20 2020 2020  d_schemes:.     
+000142d0: 2020 2020 2020 2069 6620 6920 6e6f 7420         if i not 
+000142e0: 696e 2068 7474 705f 7363 6865 6d65 733a  in http_schemes:
+000142f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014300: 2072 6169 7365 2053 796e 7461 7845 7272   raise SyntaxErr
+00014310: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00014320: 2020 2020 2020 2020 2261 6c6c 6f77 6564          "allowed
+00014330: 5f73 6368 656d 6520 7661 6c75 6520 2725  _scheme value '%
+00014340: 7327 2069 7320 6e6f 7420 696e 2025 7322  s' is not in %s"
+00014350: 2025 2028 692c 2068 7474 705f 7363 6865   % (i, http_sche
+00014360: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
+00014370: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00014380: 6966 2073 656c 662e 7072 6570 656e 645f  if self.prepend_
+00014390: 7363 6865 6d65 206e 6f74 2069 6e20 7365  scheme not in se
+000143a0: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
+000143b0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000143c0: 7261 6973 6520 5379 6e74 6178 4572 726f  raise SyntaxErro
+000143d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+000143e0: 2020 2022 7072 6570 656e 645f 7363 6865     "prepend_sche
+000143f0: 6d65 3d27 2573 2720 6973 206e 6f74 2069  me='%s' is not i
+00014400: 6e20 616c 6c6f 7765 645f 7363 6865 6d65  n allowed_scheme
+00014410: 733d 2573 220a 2020 2020 2020 2020 2020  s=%s".          
+00014420: 2020 2020 2020 2520 2873 656c 662e 7072        % (self.pr
+00014430: 6570 656e 645f 7363 6865 6d65 2c20 7365  epend_scheme, se
+00014440: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
+00014450: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00014460: 290a 0a20 2020 2064 6566 2076 616c 6964  )..    def valid
+00014470: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+00014480: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+00014490: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000144a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000144b0: 2020 2020 2020 2020 7661 6c75 653a 2061          value: a
+000144c0: 2073 7472 696e 672c 2074 6865 2055 524c   string, the URL
+000144d0: 2074 6f20 7661 6c69 6461 7465 0a0a 2020   to validate..  
+000144e0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+000144f0: 2020 2020 2020 2020 2020 2061 2074 7570             a tup
+00014500: 6c65 2c20 7768 6572 6520 7475 706c 655b  le, where tuple[
+00014510: 305d 2069 7320 7468 6520 696e 7075 7474  0] is the inputt
+00014520: 6564 2076 616c 7565 0a20 2020 2020 2020  ed value.       
+00014530: 2020 2020 2028 706f 7373 6962 6c65 2070       (possible p
+00014540: 7265 7065 6e64 6564 2077 6974 6820 7072  repended with pr
+00014550: 6570 656e 645f 7363 6865 6d65 292c 2061  epend_scheme), a
+00014560: 6e64 2074 7570 6c65 5b31 5d20 6973 2065  nd tuple[1] is e
+00014570: 6974 6865 720a 2020 2020 2020 2020 2020  ither.          
+00014580: 2020 4e6f 6e65 2028 7375 6363 6573 7321    None (success!
+00014590: 2920 6f72 2074 6865 2073 7472 696e 6720  ) or the string 
+000145a0: 6572 726f 725f 6d65 7373 6167 650a 2020  error_message.  
+000145b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000145c0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000145d0: 2020 2023 2069 6620 7468 6520 5552 4c20     # if the URL 
+000145e0: 7061 7373 6573 2067 656e 6572 6963 2076  passes generic v
+000145f0: 616c 6964 6174 696f 6e0a 2020 2020 2020  alidation.      
+00014600: 2020 2020 2020 7820 3d20 4953 5f47 454e        x = IS_GEN
+00014610: 4552 4943 5f55 524c 280a 2020 2020 2020  ERIC_URL(.      
+00014620: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00014630: 6d65 7373 6167 653d 7365 6c66 2e65 7272  message=self.err
+00014640: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+00014650: 2020 2020 2020 2020 2020 2020 616c 6c6f              allo
+00014660: 7765 645f 7363 6865 6d65 733d 7365 6c66  wed_schemes=self
+00014670: 2e61 6c6c 6f77 6564 5f73 6368 656d 6573  .allowed_schemes
+00014680: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014690: 2020 7072 6570 656e 645f 7363 6865 6d65    prepend_scheme
+000146a0: 3d73 656c 662e 7072 6570 656e 645f 7363  =self.prepend_sc
+000146b0: 6865 6d65 2c0a 2020 2020 2020 2020 2020  heme,.          
+000146c0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000146d0: 6966 2078 2876 616c 7565 295b 315d 2069  if x(value)[1] i
+000146e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000146f0: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+00014700: 7473 203d 2075 726c 7061 7273 652e 7572  ts = urlparse.ur
+00014710: 6c70 6172 7365 2876 616c 7565 290a 2020  lparse(value).  
+00014720: 2020 2020 2020 2020 2020 2020 2020 6175                au
+00014730: 7468 6f72 6974 7920 3d20 636f 6d70 6f6e  thority = compon
+00014740: 656e 7473 2e6e 6574 6c6f 630a 2020 2020  ents.netloc.    
+00014750: 2020 2020 2020 2020 2020 2020 2320 6966              # if
+00014760: 2074 6865 7265 2069 7320 616e 2061 7574   there is an aut
+00014770: 686f 7269 7479 2063 6f6d 706f 6e65 6e74  hority component
+00014780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014790: 2069 6620 6175 7468 6f72 6974 793a 0a20   if authority:. 
+000147a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147b0: 2020 2023 2069 6620 6175 7468 6f72 6974     # if authorit
+000147c0: 7920 6973 2061 2076 616c 6964 2049 5020  y is a valid IP 
+000147d0: 6164 6472 6573 730a 2020 2020 2020 2020  address.        
+000147e0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+000147f0: 652e 6d61 7463 6828 7365 6c66 2e52 4547  e.match(self.REG
+00014800: 4558 5f47 454e 4552 4943 5f56 414c 4944  EX_GENERIC_VALID
+00014810: 5f49 502c 2061 7574 686f 7269 7479 293a  _IP, authority):
+00014820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014830: 2020 2020 2020 2020 2023 2054 6865 6e20           # Then 
+00014840: 7468 6973 2048 5454 5020 5552 4c20 6973  this HTTP URL is
+00014850: 2076 616c 6964 0a20 2020 2020 2020 2020   valid.         
+00014860: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00014870: 6574 7572 6e20 7661 6c75 650a 2020 2020  eturn value.    
+00014880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014890: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000148a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000148b0: 656c 7365 2069 6620 6175 7468 6f72 6974  else if authorit
+000148c0: 7920 6973 2061 2076 616c 6964 2064 6f6d  y is a valid dom
+000148d0: 6169 6e20 6e61 6d65 0a20 2020 2020 2020  ain name.       
 000148e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148f0: 2020 2020 2020 2020 7365 6c66 2e52 4547          self.REG
-00014900: 4558 5f47 454e 4552 4943 5f56 414c 4944  EX_GENERIC_VALID
-00014910: 5f44 4f4d 4149 4e2c 2061 7574 686f 7269  _DOMAIN, authori
-00014920: 7479 0a20 2020 2020 2020 2020 2020 2020  ty.             
-00014930: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00014940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014950: 2020 2020 2069 6620 646f 6d61 696e 4d61       if domainMa
-00014960: 7463 683a 0a20 2020 2020 2020 2020 2020  tch:.           
+000148f0: 2064 6f6d 6169 6e4d 6174 6368 203d 2072   domainMatch = r
+00014900: 652e 6d61 7463 6828 0a20 2020 2020 2020  e.match(.       
+00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014920: 2020 2020 2073 656c 662e 5245 4745 585f       self.REGEX_
+00014930: 4745 4e45 5249 435f 5641 4c49 445f 444f  GENERIC_VALID_DO
+00014940: 4d41 494e 2c20 6175 7468 6f72 6974 790a  MAIN, authority.
+00014950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014960: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
 00014970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014980: 2023 2069 6620 7468 6520 746f 702d 6c65   # if the top-le
-00014990: 7665 6c20 646f 6d61 696e 2072 6561 6c6c  vel domain reall
-000149a0: 7920 6578 6973 7473 0a20 2020 2020 2020  y exists.       
-000149b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000149c0: 2020 2020 2069 6620 646f 6d61 696e 4d61       if domainMa
-000149d0: 7463 682e 6772 6f75 7028 3529 2e6c 6f77  tch.group(5).low
-000149e0: 6572 2829 2069 6e20 7365 6c66 2e61 6c6c  er() in self.all
-000149f0: 6f77 6564 5f74 6c64 733a 0a20 2020 2020  owed_tlds:.     
-00014a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a10: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-00014a20: 6e20 7468 6973 2048 5454 5020 5552 4c20  n this HTTP URL 
-00014a30: 6973 2076 616c 6964 0a20 2020 2020 2020  is valid.       
-00014a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00014a60: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00014a70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a90: 2320 656c 7365 2074 6869 7320 6973 2061  # else this is a
-00014aa0: 2072 656c 6174 6976 652f 6162 6272 6576   relative/abbrev
-00014ab0: 6961 7465 6420 5552 4c2c 2077 6869 6368  iated URL, which
-00014ac0: 2077 696c 6c20 7061 7273 650a 2020 2020   will parse.    
-00014ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ae0: 2320 696e 746f 2074 6865 2055 524c 2773  # into the URL's
-00014af0: 2070 6174 6820 636f 6d70 6f6e 656e 740a   path component.
-00014b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b10: 2020 2020 7061 7468 203d 2063 6f6d 706f      path = compo
-00014b20: 6e65 6e74 732e 7061 7468 0a20 2020 2020  nents.path.     
-00014b30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00014b40: 2072 656c 6174 6976 6520 6361 7365 3a20   relative case: 
-00014b50: 6966 2074 6869 7320 6973 2061 2076 616c  if this is a val
-00014b60: 6964 2070 6174 6820 2869 6620 6974 2073  id path (if it s
-00014b70: 7461 7274 7320 7769 7468 0a20 2020 2020  tarts with.     
-00014b80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00014b90: 2061 2073 6c61 7368 290a 2020 2020 2020   a slash).      
-00014ba0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00014bb0: 206e 6f74 2070 6174 682e 7374 6172 7473   not path.starts
-00014bc0: 7769 7468 2822 2f22 293a 0a20 2020 2020  with("/"):.     
-00014bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014be0: 2020 2023 2061 6262 7265 7669 6174 6564     # abbreviated
-00014bf0: 2063 6173 653a 2069 6620 7765 2068 6176   case: if we hav
-00014c00: 656e 2774 2061 6c72 6561 6479 2c20 7072  en't already, pr
-00014c10: 6570 656e 6420 610a 2020 2020 2020 2020  epend a.        
-00014c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c30: 2320 7363 6865 6d65 2061 6e64 2073 6565  # scheme and see
-00014c40: 2069 6620 6974 2066 6978 6573 2074 6865   if it fixes the
-00014c50: 2070 726f 626c 656d 0a20 2020 2020 2020   problem.       
-00014c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c70: 2069 6620 223a 2f2f 2220 6e6f 7420 696e   if "://" not in
-00014c80: 2076 616c 7565 2061 6e64 204e 6f6e 6520   value and None 
-00014c90: 696e 2073 656c 662e 616c 6c6f 7765 645f  in self.allowed_
-00014ca0: 7363 6865 6d65 733a 0a20 2020 2020 2020  schemes:.       
-00014cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cc0: 2020 2020 2073 6368 656d 6554 6f55 7365       schemeToUse
-00014cd0: 203d 2073 656c 662e 7072 6570 656e 645f   = self.prepend_
-00014ce0: 7363 6865 6d65 206f 7220 2268 7474 7022  scheme or "http"
-00014cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d00: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00014d10: 5f76 616c 7565 203d 2073 656c 662e 7661  _value = self.va
-00014d20: 6c69 6461 7465 2873 6368 656d 6554 6f55  lidate(schemeToU
-00014d30: 7365 202b 2022 3a2f 2f22 202b 2076 616c  se + "://" + val
-00014d40: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d60: 7265 7475 726e 206e 6577 5f76 616c 7565  return new_value
-00014d70: 2069 6620 7365 6c66 2e70 7265 7065 6e64   if self.prepend
-00014d80: 5f73 6368 656d 6520 656c 7365 2076 616c  _scheme else val
-00014d90: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00014da0: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00014db0: 6c75 650a 2020 2020 2020 2020 6578 6365  lue.        exce
-00014dc0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-00014dd0: 7061 7373 0a20 2020 2020 2020 2072 6169  pass.        rai
-00014de0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-00014df0: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-00014e00: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
-00014e10: 7373 6167 6529 290a 0a0a 636c 6173 7320  ssage))...class 
-00014e20: 4953 5f55 524c 2856 616c 6964 6174 6f72  IS_URL(Validator
-00014e30: 293a 0a20 2020 2022 2222 0a20 2020 2052  ):.    """.    R
-00014e40: 656a 6563 7473 2061 2055 524c 2073 7472  ejects a URL str
-00014e50: 696e 6720 6966 2061 6e79 206f 6620 7468  ing if any of th
-00014e60: 6520 666f 6c6c 6f77 696e 6720 6973 2074  e following is t
-00014e70: 7275 653a 0a0a 2020 2020 2020 202a 2054  rue:..       * T
-00014e80: 6865 2073 7472 696e 6720 6973 2065 6d70  he string is emp
-00014e90: 7479 206f 7220 4e6f 6e65 0a20 2020 2020  ty or None.     
-00014ea0: 2020 2a20 5468 6520 7374 7269 6e67 2075    * The string u
-00014eb0: 7365 7320 6368 6172 6163 7465 7273 2074  ses characters t
-00014ec0: 6861 7420 6172 6520 6e6f 7420 616c 6c6f  hat are not allo
-00014ed0: 7765 6420 696e 2061 2055 524c 0a20 2020  wed in a URL.   
-00014ee0: 2020 2020 2a20 5468 6520 7374 7269 6e67      * The string
-00014ef0: 2062 7265 616b 7320 616e 7920 6f66 2074   breaks any of t
-00014f00: 6865 2048 5454 5020 7379 6e74 6163 7469  he HTTP syntacti
-00014f10: 6320 7275 6c65 730a 2020 2020 2020 202a  c rules.       *
-00014f20: 2054 6865 2055 524c 2073 6368 656d 6520   The URL scheme 
-00014f30: 7370 6563 6966 6965 6420 2869 6620 6f6e  specified (if on
-00014f40: 6520 6973 2073 7065 6369 6669 6564 2920  e is specified) 
-00014f50: 6973 206e 6f74 2027 6874 7470 2720 6f72  is not 'http' or
-00014f60: 2027 6874 7470 7327 0a20 2020 2020 2020   'https'.       
-00014f70: 2a20 5468 6520 746f 702d 6c65 7665 6c20  * The top-level 
-00014f80: 646f 6d61 696e 2028 6966 2061 2068 6f73  domain (if a hos
-00014f90: 7420 6e61 6d65 2069 7320 7370 6563 6966  t name is specif
-00014fa0: 6965 6429 2064 6f65 7320 6e6f 7420 6578  ied) does not ex
-00014fb0: 6973 740a 0a20 2020 2028 5468 6573 6520  ist..    (These 
-00014fc0: 7275 6c65 7320 6172 6520 6261 7365 6420  rules are based 
-00014fd0: 6f6e 2052 4643 2032 3631 363a 2068 7474  on RFC 2616: htt
-00014fe0: 703a 2f2f 7777 772e 6661 7173 2e6f 7267  p://www.faqs.org
-00014ff0: 2f72 6663 732f 7266 6332 3631 362e 6874  /rfcs/rfc2616.ht
-00015000: 6d6c 290a 0a20 2020 2054 6869 7320 6675  ml)..    This fu
-00015010: 6e63 7469 6f6e 206f 6e6c 7920 6368 6563  nction only chec
-00015020: 6b73 2074 6865 2055 524c 2773 2073 796e  ks the URL's syn
-00015030: 7461 782e 2049 7420 646f 6573 206e 6f74  tax. It does not
-00015040: 2063 6865 636b 2074 6861 7420 7468 6520   check that the 
-00015050: 5552 4c0a 2020 2020 706f 696e 7473 2074  URL.    points t
-00015060: 6f20 6120 7265 616c 2064 6f63 756d 656e  o a real documen
-00015070: 742c 2066 6f72 2065 7861 6d70 6c65 2c20  t, for example, 
-00015080: 6f72 2074 6861 7420 6974 206f 7468 6572  or that it other
-00015090: 7769 7365 206d 616b 6573 2073 656e 7365  wise makes sense
-000150a0: 0a20 2020 2073 656d 616e 7469 6361 6c6c  .    semanticall
-000150b0: 792e 2054 6869 7320 6675 6e63 7469 6f6e  y. This function
-000150c0: 2064 6f65 7320 6175 746f 6d61 7469 6361   does automatica
-000150d0: 6c6c 7920 7072 6570 656e 6420 2768 7474  lly prepend 'htt
-000150e0: 703a 2f2f 2720 696e 2066 726f 6e74 0a20  p://' in front. 
-000150f0: 2020 206f 6620 6120 5552 4c20 696e 2074     of a URL in t
-00015100: 6865 2063 6173 6520 6f66 2061 6e20 6162  he case of an ab
-00015110: 6272 6576 6961 7465 6420 5552 4c20 2865  breviated URL (e
-00015120: 2e67 2e20 2767 6f6f 676c 652e 6361 2729  .g. 'google.ca')
-00015130: 2e0a 0a20 2020 2049 6620 7468 6520 7061  ...    If the pa
-00015140: 7261 6d65 7465 7220 6d6f 6465 3d27 6765  rameter mode='ge
-00015150: 6e65 7269 6327 2069 7320 7573 6564 2c20  neric' is used, 
-00015160: 7468 656e 2074 6869 7320 6675 6e63 7469  then this functi
-00015170: 6f6e 2773 2062 6568 6176 696f 720a 2020  on's behavior.  
-00015180: 2020 6368 616e 6765 732e 2049 7420 7468    changes. It th
-00015190: 656e 2072 656a 6563 7473 2061 2055 524c  en rejects a URL
-000151a0: 2073 7472 696e 6720 6966 2061 6e79 206f   string if any o
-000151b0: 6620 7468 6520 666f 6c6c 6f77 696e 6720  f the following 
-000151c0: 6973 2074 7275 653a 0a0a 2020 2020 2020  is true:..      
-000151d0: 202a 2054 6865 2073 7472 696e 6720 6973   * The string is
-000151e0: 2065 6d70 7479 206f 7220 4e6f 6e65 0a20   empty or None. 
-000151f0: 2020 2020 2020 2a20 5468 6520 7374 7269        * The stri
-00015200: 6e67 2075 7365 7320 6368 6172 6163 7465  ng uses characte
-00015210: 7273 2074 6861 7420 6172 6520 6e6f 7420  rs that are not 
-00015220: 616c 6c6f 7765 6420 696e 2061 2055 524c  allowed in a URL
-00015230: 0a20 2020 2020 2020 2a20 5468 6520 5552  .       * The UR
-00015240: 4c20 7363 6865 6d65 2073 7065 6369 6669  L scheme specifi
-00015250: 6564 2028 6966 206f 6e65 2069 7320 7370  ed (if one is sp
-00015260: 6563 6966 6965 6429 2069 7320 6e6f 7420  ecified) is not 
-00015270: 7661 6c69 640a 0a20 2020 2028 5468 6573  valid..    (Thes
-00015280: 6520 7275 6c65 7320 6172 6520 6261 7365  e rules are base
-00015290: 6420 6f6e 2052 4643 2032 3339 363a 2068  d on RFC 2396: h
-000152a0: 7474 703a 2f2f 7777 772e 6661 7173 2e6f  ttp://www.faqs.o
-000152b0: 7267 2f72 6663 732f 7266 6332 3339 362e  rg/rfcs/rfc2396.
-000152c0: 6874 6d6c 290a 0a20 2020 2054 6865 206c  html)..    The l
-000152d0: 6973 7420 6f66 2061 6c6c 6f77 6564 2073  ist of allowed s
-000152e0: 6368 656d 6573 2069 7320 6375 7374 6f6d  chemes is custom
-000152f0: 697a 6162 6c65 2077 6974 6820 7468 6520  izable with the 
-00015300: 616c 6c6f 7765 645f 7363 6865 6d65 730a  allowed_schemes.
-00015310: 2020 2020 7061 7261 6d65 7465 722e 2049      parameter. I
-00015320: 6620 796f 7520 6578 636c 7564 6520 4e6f  f you exclude No
-00015330: 6e65 2066 726f 6d20 7468 6520 6c69 7374  ne from the list
-00015340: 2c20 7468 656e 2061 6262 7265 7669 6174  , then abbreviat
-00015350: 6564 2055 524c 730a 2020 2020 286c 6163  ed URLs.    (lac
-00015360: 6b69 6e67 2061 2073 6368 656d 6520 7375  king a scheme su
-00015370: 6368 2061 7320 2768 7474 7027 2920 7769  ch as 'http') wi
-00015380: 6c6c 2062 6520 7265 6a65 6374 6564 2e0a  ll be rejected..
-00015390: 0a20 2020 2054 6865 2064 6566 6175 6c74  .    The default
-000153a0: 2070 7265 7065 6e64 6564 2073 6368 656d   prepended schem
-000153b0: 6520 6973 2063 7573 746f 6d69 7a61 626c  e is customizabl
-000153c0: 6520 7769 7468 2074 6865 2070 7265 7065  e with the prepe
-000153d0: 6e64 5f73 6368 656d 650a 2020 2020 7061  nd_scheme.    pa
-000153e0: 7261 6d65 7465 722e 2049 6620 796f 7520  rameter. If you 
-000153f0: 7365 7420 7072 6570 656e 645f 7363 6865  set prepend_sche
-00015400: 6d65 2074 6f20 4e6f 6e65 2074 6865 6e20  me to None then 
-00015410: 7072 6570 656e 6469 6e67 2077 696c 6c20  prepending will 
-00015420: 6265 0a20 2020 2064 6973 6162 6c65 642e  be.    disabled.
-00015430: 2055 524c 7320 7468 6174 2072 6571 7569   URLs that requi
-00015440: 7265 2070 7265 7065 6e64 696e 6720 746f  re prepending to
-00015450: 2070 6172 7365 2077 696c 6c20 7374 696c   parse will stil
-00015460: 6c20 6265 2061 6363 6570 7465 642c 0a20  l be accepted,. 
-00015470: 2020 2062 7574 2074 6865 2072 6574 7572     but the retur
-00015480: 6e20 7661 6c75 6520 7769 6c6c 206e 6f74  n value will not
-00015490: 2062 6520 6d6f 6469 6669 6564 2e0a 0a20   be modified... 
-000154a0: 2020 2049 535f 5552 4c20 6973 2063 6f6d     IS_URL is com
-000154b0: 7061 7469 626c 6520 7769 7468 2074 6865  patible with the
-000154c0: 2049 6e74 6572 6e61 7469 6f6e 616c 697a   Internationaliz
-000154d0: 6564 2044 6f6d 6169 6e20 4e61 6d65 2028  ed Domain Name (
-000154e0: 4944 4e29 2073 7461 6e64 6172 640a 2020  IDN) standard.  
-000154f0: 2020 7370 6563 6966 6965 6420 696e 2052    specified in R
-00015500: 4643 2033 3439 3020 2868 7474 703a 2f2f  FC 3490 (http://
-00015510: 746f 6f6c 732e 6965 7466 2e6f 7267 2f68  tools.ietf.org/h
-00015520: 746d 6c2f 7266 6333 3439 3029 2e20 4173  tml/rfc3490). As
-00015530: 2061 2072 6573 756c 742c 0a20 2020 2055   a result,.    U
-00015540: 524c 7320 6361 6e20 6265 2072 6567 756c  RLs can be regul
-00015550: 6172 2073 7472 696e 6773 206f 7220 756e  ar strings or un
-00015560: 6963 6f64 6520 7374 7269 6e67 732e 0a20  icode strings.. 
-00015570: 2020 2049 6620 7468 6520 5552 4c27 7320     If the URL's 
-00015580: 646f 6d61 696e 2063 6f6d 706f 6e65 6e74  domain component
-00015590: 2028 652e 672e 2067 6f6f 676c 652e 6361   (e.g. google.ca
-000155a0: 2920 636f 6e74 6169 6e73 206e 6f6e 2d55  ) contains non-U
-000155b0: 532d 4153 4349 490a 2020 2020 6c65 7474  S-ASCII.    lett
-000155c0: 6572 732c 2074 6865 6e20 7468 6520 646f  ers, then the do
-000155d0: 6d61 696e 2077 696c 6c20 6265 2063 6f6e  main will be con
-000155e0: 7665 7274 6564 2069 6e74 6f20 5075 6e79  verted into Puny
-000155f0: 636f 6465 2028 6465 6669 6e65 6420 696e  code (defined in
-00015600: 0a20 2020 2052 4643 2033 3439 322c 2068  .    RFC 3492, h
-00015610: 7474 703a 2f2f 746f 6f6c 732e 6965 7466  ttp://tools.ietf
-00015620: 2e6f 7267 2f68 746d 6c2f 7266 6333 3439  .org/html/rfc349
-00015630: 3229 2e20 4953 5f55 524c 2067 6f65 7320  2). IS_URL goes 
-00015640: 6120 6269 7420 6265 796f 6e64 0a20 2020  a bit beyond.   
-00015650: 2074 6865 2073 7461 6e64 6172 6473 2c20   the standards, 
-00015660: 616e 6420 616c 6c6f 7773 206e 6f6e 2d55  and allows non-U
-00015670: 532d 4153 4349 4920 6368 6172 6163 7465  S-ASCII characte
-00015680: 7273 2074 6f20 6265 2070 7265 7365 6e74  rs to be present
-00015690: 2069 6e20 7468 6520 7061 7468 0a20 2020   in the path.   
-000156a0: 2061 6e64 2071 7565 7279 2063 6f6d 706f   and query compo
-000156b0: 6e65 6e74 7320 6f66 2074 6865 2055 524c  nents of the URL
-000156c0: 2061 7320 7765 6c6c 2e20 5468 6573 6520   as well. These 
-000156d0: 6e6f 6e2d 5553 2d41 5343 4949 2063 6861  non-US-ASCII cha
-000156e0: 7261 6374 6572 7320 7769 6c6c 0a20 2020  racters will.   
-000156f0: 2062 6520 6573 6361 7065 6420 7573 696e   be escaped usin
-00015700: 6720 7468 6520 7374 616e 6461 7264 2027  g the standard '
-00015710: 2532 3027 2074 7970 6520 7379 6e74 6178  %20' type syntax
-00015720: 2e20 652e 672e 2074 6865 2075 6e69 636f  . e.g. the unico
-00015730: 6465 0a20 2020 2063 6861 7261 6374 6572  de.    character
-00015740: 2077 6974 6820 6865 7820 636f 6465 2030   with hex code 0
-00015750: 7834 6538 3620 7769 6c6c 2062 6563 6f6d  x4e86 will becom
-00015760: 6520 2725 3465 2538 3627 0a0a 2020 2020  e '%4e%86'..    
-00015770: 4172 6773 3a0a 2020 2020 2020 2020 6572  Args:.        er
-00015780: 726f 725f 6d65 7373 6167 653a 2061 2073  ror_message: a s
-00015790: 7472 696e 672c 2074 6865 2065 7272 6f72  tring, the error
-000157a0: 206d 6573 7361 6765 2074 6f20 6769 7665   message to give
-000157b0: 2074 6865 2065 6e64 2075 7365 720a 2020   the end user.  
-000157c0: 2020 2020 2020 2020 2020 6966 2074 6865            if the
-000157d0: 2055 524c 2064 6f65 7320 6e6f 7420 7661   URL does not va
-000157e0: 6c69 6461 7465 0a20 2020 2020 2020 2061  lidate.        a
-000157f0: 6c6c 6f77 6564 5f73 6368 656d 6573 3a20  llowed_schemes: 
-00015800: 6120 6c69 7374 2063 6f6e 7461 696e 696e  a list containin
-00015810: 6720 7374 7269 6e67 7320 6f72 204e 6f6e  g strings or Non
-00015820: 652e 2045 6163 6820 656c 656d 656e 740a  e. Each element.
-00015830: 2020 2020 2020 2020 2020 2020 6973 2061              is a
-00015840: 2073 6368 656d 6520 7468 6520 696e 7075   scheme the inpu
-00015850: 7474 6564 2055 524c 2069 7320 616c 6c6f  tted URL is allo
-00015860: 7765 6420 746f 2075 7365 0a20 2020 2020  wed to use.     
-00015870: 2020 2070 7265 7065 6e64 5f73 6368 656d     prepend_schem
-00015880: 653a 2061 2073 7472 696e 672c 2074 6869  e: a string, thi
-00015890: 7320 7363 6865 6d65 2069 7320 7072 6570  s scheme is prep
-000158a0: 656e 6465 6420 6966 2069 7427 730a 2020  ended if it's.  
-000158b0: 2020 2020 2020 2020 2020 6e65 6365 7373            necess
-000158c0: 6172 7920 746f 206d 616b 6520 7468 6520  ary to make the 
-000158d0: 5552 4c20 7661 6c69 640a 0a20 2020 2043  URL valid..    C
-000158e0: 6f64 6520 4578 616d 706c 6573 3a3a 0a0a  ode Examples::..
-000158f0: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
-00015900: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
-00015910: 653d 276e 616d 6527 2c20 7265 7175 6972  e='name', requir
-00015920: 6573 3d49 535f 5552 4c28 2929 0a20 2020  es=IS_URL()).   
-00015930: 2020 2020 203e 3e3e 2049 535f 5552 4c28       >>> IS_URL(
-00015940: 2928 2761 6263 2e63 6f6d 2729 0a20 2020  )('abc.com').   
-00015950: 2020 2020 2028 2768 7474 703a 2f2f 6162       ('http://ab
-00015960: 632e 636f 6d27 2c20 4e6f 6e65 290a 0a20  c.com', None).. 
-00015970: 2020 2020 2020 2049 4e50 5554 285f 7479         INPUT(_ty
-00015980: 7065 3d27 7465 7874 272c 205f 6e61 6d65  pe='text', _name
-00015990: 3d27 6e61 6d65 272c 2072 6571 7569 7265  ='name', require
-000159a0: 733d 4953 5f55 524c 286d 6f64 653d 2767  s=IS_URL(mode='g
-000159b0: 656e 6572 6963 2729 290a 2020 2020 2020  eneric')).      
-000159c0: 2020 3e3e 3e20 4953 5f55 524c 286d 6f64    >>> IS_URL(mod
-000159d0: 653d 2767 656e 6572 6963 2729 2827 6162  e='generic')('ab
-000159e0: 632e 636f 6d27 290a 2020 2020 2020 2020  c.com').        
-000159f0: 2827 6162 632e 636f 6d27 2c20 4e6f 6e65  ('abc.com', None
-00015a00: 290a 0a20 2020 2020 2020 2049 4e50 5554  )..        INPUT
-00015a10: 285f 7479 7065 3d27 7465 7874 272c 205f  (_type='text', _
-00015a20: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
-00015a30: 2020 2020 2020 2020 2072 6571 7569 7265           require
-00015a40: 733d 4953 5f55 524c 2861 6c6c 6f77 6564  s=IS_URL(allowed
-00015a50: 5f73 6368 656d 6573 3d5b 2768 7474 7073  _schemes=['https
-00015a60: 275d 2c20 7072 6570 656e 645f 7363 6865  '], prepend_sche
-00015a70: 6d65 3d27 6874 7470 7327 2929 0a20 2020  me='https')).   
-00015a80: 2020 2020 203e 3e3e 2049 535f 5552 4c28       >>> IS_URL(
-00015a90: 616c 6c6f 7765 645f 7363 6865 6d65 733d  allowed_schemes=
-00015aa0: 5b27 6874 7470 7327 5d2c 2070 7265 7065  ['https'], prepe
-00015ab0: 6e64 5f73 6368 656d 653d 2768 7474 7073  nd_scheme='https
-00015ac0: 2729 2827 6874 7470 733a 2f2f 6162 632e  ')('https://abc.
-00015ad0: 636f 6d27 290a 2020 2020 2020 2020 2827  com').        ('
-00015ae0: 6874 7470 733a 2f2f 6162 632e 636f 6d27  https://abc.com'
-00015af0: 2c20 4e6f 6e65 290a 0a20 2020 2020 2020  , None)..       
-00015b00: 2049 4e50 5554 285f 7479 7065 3d27 7465   INPUT(_type='te
-00015b10: 7874 272c 205f 6e61 6d65 3d27 6e61 6d65  xt', _name='name
-00015b20: 272c 0a20 2020 2020 2020 2020 2020 2072  ',.            r
-00015b30: 6571 7569 7265 733d 4953 5f55 524c 2870  equires=IS_URL(p
-00015b40: 7265 7065 6e64 5f73 6368 656d 653d 2768  repend_scheme='h
-00015b50: 7474 7073 2729 290a 2020 2020 2020 2020  ttps')).        
-00015b60: 3e3e 3e20 4953 5f55 524c 2870 7265 7065  >>> IS_URL(prepe
-00015b70: 6e64 5f73 6368 656d 653d 2768 7474 7073  nd_scheme='https
-00015b80: 2729 2827 6162 632e 636f 6d27 290a 2020  ')('abc.com').  
-00015b90: 2020 2020 2020 2827 6874 7470 733a 2f2f        ('https://
-00015ba0: 6162 632e 636f 6d27 2c20 4e6f 6e65 290a  abc.com', None).
-00015bb0: 0a20 2020 2020 2020 2049 4e50 5554 285f  .        INPUT(_
-00015bc0: 7479 7065 3d27 7465 7874 272c 205f 6e61  type='text', _na
-00015bd0: 6d65 3d27 6e61 6d65 272c 0a20 2020 2020  me='name',.     
-00015be0: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
-00015bf0: 4953 5f55 524c 286d 6f64 653d 2767 656e  IS_URL(mode='gen
-00015c00: 6572 6963 272c 2061 6c6c 6f77 6564 5f73  eric', allowed_s
-00015c10: 6368 656d 6573 3d5b 2766 7470 7327 2c20  chemes=['ftps', 
-00015c20: 2768 7474 7073 275d 2c0a 2020 2020 2020  'https'],.      
-00015c30: 2020 2020 2020 2020 2020 7072 6570 656e            prepen
-00015c40: 645f 7363 6865 6d65 3d27 6874 7470 7327  d_scheme='https'
-00015c50: 2929 0a20 2020 2020 2020 203e 3e3e 2049  )).        >>> I
-00015c60: 535f 5552 4c28 6d6f 6465 3d27 6765 6e65  S_URL(mode='gene
-00015c70: 7269 6327 2c20 616c 6c6f 7765 645f 7363  ric', allowed_sc
-00015c80: 6865 6d65 733d 5b27 6674 7073 272c 2027  hemes=['ftps', '
-00015c90: 6874 7470 7327 5d2c 2070 7265 7065 6e64  https'], prepend
-00015ca0: 5f73 6368 656d 653d 2768 7474 7073 2729  _scheme='https')
-00015cb0: 2827 6874 7470 733a 2f2f 6162 632e 636f  ('https://abc.co
-00015cc0: 6d27 290a 2020 2020 2020 2020 2827 6874  m').        ('ht
-00015cd0: 7470 733a 2f2f 6162 632e 636f 6d27 2c20  tps://abc.com', 
-00015ce0: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-00015cf0: 3e20 4953 5f55 524c 286d 6f64 653d 2767  > IS_URL(mode='g
-00015d00: 656e 6572 6963 272c 2061 6c6c 6f77 6564  eneric', allowed
-00015d10: 5f73 6368 656d 6573 3d5b 2766 7470 7327  _schemes=['ftps'
-00015d20: 2c20 2768 7474 7073 272c 204e 6f6e 655d  , 'https', None]
-00015d30: 2c20 7072 6570 656e 645f 7363 6865 6d65  , prepend_scheme
-00015d40: 3d27 6874 7470 7327 2928 2761 6263 2e63  ='https')('abc.c
-00015d50: 6f6d 2729 0a20 2020 2020 2020 2028 2761  om').        ('a
-00015d60: 6263 2e63 6f6d 272c 204e 6f6e 6529 0a0a  bc.com', None)..
-00015d70: 2020 2020 4061 7574 686f 723a 204a 6f6e      @author: Jon
-00015d80: 6174 6861 6e20 4265 6e6e 0a20 2020 2022  athan Benn.    "
-00015d90: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-00015da0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
-00015db0: 6c66 2c0a 2020 2020 2020 2020 6572 726f  lf,.        erro
-00015dc0: 725f 6d65 7373 6167 653d 2245 6e74 6572  r_message="Enter
-00015dd0: 2061 2076 616c 6964 2055 524c 222c 0a20   a valid URL",. 
-00015de0: 2020 2020 2020 206d 6f64 653d 2268 7474         mode="htt
-00015df0: 7022 2c0a 2020 2020 2020 2020 616c 6c6f  p",.        allo
-00015e00: 7765 645f 7363 6865 6d65 733d 4e6f 6e65  wed_schemes=None
-00015e10: 2c0a 2020 2020 2020 2020 7072 6570 656e  ,.        prepen
-00015e20: 645f 7363 6865 6d65 3d22 6874 7470 222c  d_scheme="http",
-00015e30: 0a20 2020 2020 2020 2061 6c6c 6f77 6564  .        allowed
-00015e40: 5f74 6c64 733d 4e6f 6e65 2c0a 2020 2020  _tlds=None,.    
-00015e50: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00015e60: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00015e70: 6572 726f 725f 6d65 7373 6167 650a 2020  error_message.  
-00015e80: 2020 2020 2020 7365 6c66 2e6d 6f64 6520        self.mode 
-00015e90: 3d20 6d6f 6465 2e6c 6f77 6572 2829 0a20  = mode.lower(). 
-00015ea0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-00015eb0: 6f64 6520 6e6f 7420 696e 205b 2267 656e  ode not in ["gen
-00015ec0: 6572 6963 222c 2022 6874 7470 225d 3a0a  eric", "http"]:.
-00015ed0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00015ee0: 6520 5379 6e74 6178 4572 726f 7228 2269  e SyntaxError("i
-00015ef0: 6e76 616c 6964 206d 6f64 6520 2725 7327  nvalid mode '%s'
-00015f00: 2069 6e20 4953 5f55 524c 2220 2520 7365   in IS_URL" % se
-00015f10: 6c66 2e6d 6f64 6529 0a20 2020 2020 2020  lf.mode).       
-00015f20: 2073 656c 662e 616c 6c6f 7765 645f 7363   self.allowed_sc
-00015f30: 6865 6d65 7320 3d20 616c 6c6f 7765 645f  hemes = allowed_
-00015f40: 7363 6865 6d65 730a 2020 2020 2020 2020  schemes.        
-00015f50: 6966 2061 6c6c 6f77 6564 5f74 6c64 7320  if allowed_tlds 
-00015f60: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00015f70: 2020 2020 2073 656c 662e 616c 6c6f 7765       self.allowe
-00015f80: 645f 746c 6473 203d 206f 6666 6963 6961  d_tlds = officia
-00015f90: 6c5f 746f 705f 6c65 7665 6c5f 646f 6d61  l_top_level_doma
-00015fa0: 696e 730a 2020 2020 2020 2020 656c 7365  ins.        else
-00015fb0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00015fc0: 6c66 2e61 6c6c 6f77 6564 5f74 6c64 7320  lf.allowed_tlds 
-00015fd0: 3d20 616c 6c6f 7765 645f 746c 6473 0a0a  = allowed_tlds..
-00015fe0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00015ff0: 616c 6c6f 7765 645f 7363 6865 6d65 733a  allowed_schemes:
-00016000: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016010: 7072 6570 656e 645f 7363 6865 6d65 206e  prepend_scheme n
-00016020: 6f74 2069 6e20 7365 6c66 2e61 6c6c 6f77  ot in self.allow
-00016030: 6564 5f73 6368 656d 6573 3a0a 2020 2020  ed_schemes:.    
-00016040: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00016050: 6520 5379 6e74 6178 4572 726f 7228 0a20  e SyntaxError(. 
-00016060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016070: 2020 2022 7072 6570 656e 645f 7363 6865     "prepend_sche
-00016080: 6d65 3d27 2573 2720 6973 206e 6f74 2069  me='%s' is not i
-00016090: 6e20 616c 6c6f 7765 645f 7363 6865 6d65  n allowed_scheme
-000160a0: 733d 2573 220a 2020 2020 2020 2020 2020  s=%s".          
-000160b0: 2020 2020 2020 2020 2020 2520 2870 7265            % (pre
-000160c0: 7065 6e64 5f73 6368 656d 652c 2073 656c  pend_scheme, sel
-000160d0: 662e 616c 6c6f 7765 645f 7363 6865 6d65  f.allowed_scheme
-000160e0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000160f0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00016100: 6966 2061 6c6c 6f77 6564 5f73 6368 656d  if allowed_schem
-00016110: 6573 2069 7320 4e6f 6e65 2c20 7468 656e  es is None, then
-00016120: 2077 6520 7769 6c6c 2064 6566 6572 2074   we will defer t
-00016130: 6573 7469 6e67 0a20 2020 2020 2020 2023  esting.        #
-00016140: 2070 7265 7065 6e64 5f73 6368 656d 6527   prepend_scheme'
-00016150: 7320 7661 6c69 6469 7479 2074 6f20 6120  s validity to a 
-00016160: 7375 622d 6d65 7468 6f64 0a0a 2020 2020  sub-method..    
-00016170: 2020 2020 7365 6c66 2e70 7265 7065 6e64      self.prepend
-00016180: 5f73 6368 656d 6520 3d20 7072 6570 656e  _scheme = prepen
-00016190: 645f 7363 6865 6d65 0a0a 2020 2020 6465  d_scheme..    de
-000161a0: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
-000161b0: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
-000161c0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
-000161d0: 2022 2222 0a20 2020 2020 2020 2041 7267   """.        Arg
-000161e0: 733a 0a20 2020 2020 2020 2020 2020 2076  s:.            v
-000161f0: 616c 7565 3a20 6120 756e 6963 6f64 6520  alue: a unicode 
-00016200: 6f72 2072 6567 756c 6172 2073 7472 696e  or regular strin
-00016210: 672c 2074 6865 2055 524c 2074 6f20 7661  g, the URL to va
-00016220: 6c69 6461 7465 0a0a 2020 2020 2020 2020  lidate..        
-00016230: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00016240: 2020 2020 2061 2028 7374 7269 6e67 2c20       a (string, 
-00016250: 7374 7269 6e67 2920 7475 706c 652c 2077  string) tuple, w
-00016260: 6865 7265 2074 7570 6c65 5b30 5d20 6973  here tuple[0] is
-00016270: 2074 6865 206d 6f64 6966 6965 640a 2020   the modified.  
-00016280: 2020 2020 2020 2020 2020 696e 7075 7420            input 
-00016290: 7661 6c75 6520 616e 6420 7475 706c 655b  value and tuple[
-000162a0: 315d 2069 7320 6569 7468 6572 204e 6f6e  1] is either Non
-000162b0: 6520 2873 7563 6365 7373 2129 206f 7220  e (success!) or 
-000162c0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-000162d0: 7374 7269 6e67 2065 7272 6f72 5f6d 6573  string error_mes
-000162e0: 7361 6765 2e20 5468 6520 696e 7075 7420  sage. The input 
-000162f0: 7661 6c75 6520 7769 6c6c 206e 6576 6572  value will never
-00016300: 2062 6520 6d6f 6469 6669 6564 2069 6e20   be modified in 
-00016310: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00016320: 6361 7365 206f 6620 616e 2065 7272 6f72  case of an error
-00016330: 2e20 486f 7765 7665 722c 2069 6620 7468  . However, if th
-00016340: 6572 6520 6973 2073 7563 6365 7373 2074  ere is success t
-00016350: 6865 6e20 7468 6520 696e 7075 7420 5552  hen the input UR
-00016360: 4c0a 2020 2020 2020 2020 2020 2020 6d61  L.            ma
-00016370: 7920 6265 206d 6f64 6966 6965 6420 746f  y be modified to
-00016380: 2028 3129 2070 7265 7065 6e64 2061 2073   (1) prepend a s
-00016390: 6368 656d 652c 2061 6e64 2f6f 7220 2832  cheme, and/or (2
-000163a0: 2920 636f 6e76 6572 7420 610a 2020 2020  ) convert a.    
-000163b0: 2020 2020 2020 2020 6e6f 6e2d 636f 6d70          non-comp
-000163c0: 6c69 616e 7420 756e 6963 6f64 6520 5552  liant unicode UR
-000163d0: 4c20 696e 746f 2061 2063 6f6d 706c 6961  L into a complia
-000163e0: 6e74 2055 532d 4153 4349 4920 7665 7273  nt US-ASCII vers
-000163f0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
-00016400: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00016410: 2e6d 6f64 6520 3d3d 2022 6765 6e65 7269  .mode == "generi
-00016420: 6322 3a0a 2020 2020 2020 2020 2020 2020  c":.            
-00016430: 7375 624d 6574 686f 6420 3d20 4953 5f47  subMethod = IS_G
-00016440: 454e 4552 4943 5f55 524c 280a 2020 2020  ENERIC_URL(.    
-00016450: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00016460: 725f 6d65 7373 6167 653d 7365 6c66 2e65  r_message=self.e
-00016470: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
-00016480: 2020 2020 2020 2020 2020 2020 2020 616c                al
-00016490: 6c6f 7765 645f 7363 6865 6d65 733d 7365  lowed_schemes=se
-000164a0: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
-000164b0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000164c0: 2020 2020 7072 6570 656e 645f 7363 6865      prepend_sche
-000164d0: 6d65 3d73 656c 662e 7072 6570 656e 645f  me=self.prepend_
-000164e0: 7363 6865 6d65 2c0a 2020 2020 2020 2020  scheme,.        
-000164f0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00016500: 6966 2073 656c 662e 6d6f 6465 203d 3d20  if self.mode == 
-00016510: 2268 7474 7022 3a0a 2020 2020 2020 2020  "http":.        
-00016520: 2020 2020 7375 624d 6574 686f 6420 3d20      subMethod = 
-00016530: 4953 5f48 5454 505f 5552 4c28 0a20 2020  IS_HTTP_URL(.   
-00016540: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00016550: 6f72 5f6d 6573 7361 6765 3d73 656c 662e  or_message=self.
-00016560: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-00016570: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00016580: 6c6c 6f77 6564 5f73 6368 656d 6573 3d73  llowed_schemes=s
-00016590: 656c 662e 616c 6c6f 7765 645f 7363 6865  elf.allowed_sche
-000165a0: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
-000165b0: 2020 2020 2070 7265 7065 6e64 5f73 6368       prepend_sch
-000165c0: 656d 653d 7365 6c66 2e70 7265 7065 6e64  eme=self.prepend
-000165d0: 5f73 6368 656d 652c 0a20 2020 2020 2020  _scheme,.       
-000165e0: 2020 2020 2020 2020 2061 6c6c 6f77 6564           allowed
-000165f0: 5f74 6c64 733d 7365 6c66 2e61 6c6c 6f77  _tlds=self.allow
-00016600: 6564 5f74 6c64 732c 0a20 2020 2020 2020  ed_tlds,.       
-00016610: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00016620: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016630: 2072 6169 7365 2053 796e 7461 7845 7272   raise SyntaxErr
-00016640: 6f72 2822 696e 7661 6c69 6420 6d6f 6465  or("invalid mode
-00016650: 2027 2573 2720 696e 2049 535f 5552 4c22   '%s' in IS_URL"
-00016660: 2025 2073 656c 662e 6d6f 6465 290a 0a20   % self.mode).. 
-00016670: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00016680: 616e 6365 2876 616c 7565 2c20 756e 6963  ance(value, unic
-00016690: 6f64 6554 293a 0a20 2020 2020 2020 2020  odeT):.         
-000166a0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-000166b0: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-000166c0: 756e 6963 6f64 655f 746f 5f61 7363 6969  unicode_to_ascii
-000166d0: 5f75 726c 2876 616c 7565 2c20 7365 6c66  _url(value, self
-000166e0: 2e70 7265 7065 6e64 5f73 6368 656d 6529  .prepend_scheme)
-000166f0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-00016700: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
-00016710: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
-00016720: 2020 2020 2320 4966 2077 6520 6172 6520      # If we are 
-00016730: 6e6f 7420 6162 6c65 2074 6f20 636f 6e76  not able to conv
-00016740: 6572 7420 7468 6520 756e 6963 6f64 6520  ert the unicode 
-00016750: 7572 6c20 696e 746f 2061 0a20 2020 2020  url into a.     
-00016760: 2020 2020 2020 2020 2020 2023 2055 532d             # US-
-00016770: 4153 4349 4920 5552 4c2c 2074 6865 6e20  ASCII URL, then 
-00016780: 7468 6520 5552 4c20 6973 206e 6f74 2076  the URL is not v
-00016790: 616c 6964 0a20 2020 2020 2020 2020 2020  alid.           
-000167a0: 2020 2020 2072 6169 7365 2056 616c 6964       raise Valid
-000167b0: 6174 696f 6e45 7272 6f72 2873 656c 662e  ationError(self.
-000167c0: 7472 616e 736c 6174 6f72 2873 656c 662e  translator(self.
-000167d0: 6572 726f 725f 6d65 7373 6167 6529 290a  error_message)).
-000167e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000167f0: 7562 4d65 7468 6f64 2e76 616c 6964 6174  ubMethod.validat
-00016800: 6528 7661 6c75 652c 2072 6563 6f72 645f  e(value, record_
-00016810: 6964 290a 0a0a 636c 6173 7320 4953 5f54  id)...class IS_T
-00016820: 494d 4528 5661 6c69 6461 746f 7229 3a0a  IME(Validator):.
-00016830: 2020 2020 2222 220a 2020 2020 4578 616d      """.    Exam
-00016840: 706c 653a 0a20 2020 2020 2020 2055 7365  ple:.        Use
-00016850: 2061 733a 3a0a 0a20 2020 2020 2020 2020   as::..         
-00016860: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
-00016870: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
-00016880: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
-00016890: 5f54 494d 4528 2929 0a0a 2020 2020 756e  _TIME())..    un
-000168a0: 6465 7273 7461 6e64 7320 7468 6520 666f  derstands the fo
-000168b0: 6c6c 6f77 696e 6720 666f 726d 6174 730a  llowing formats.
-000168c0: 2020 2020 6868 3a6d 6d3a 7373 205b 616d      hh:mm:ss [am
-000168d0: 2f70 6d5d 0a20 2020 2068 683a 6d6d 205b  /pm].    hh:mm [
-000168e0: 616d 2f70 6d5d 0a20 2020 2068 6820 5b61  am/pm].    hh [a
-000168f0: 6d2f 706d 5d0a 0a20 2020 205b 616d 2f70  m/pm]..    [am/p
-00016900: 6d5d 2069 7320 6f70 7469 6f6e 616c 2c20  m] is optional, 
-00016910: 273a 2720 6361 6e20 6265 2072 6570 6c61  ':' can be repla
-00016920: 6365 6420 6279 2061 6e79 206f 7468 6572  ced by any other
-00016930: 206e 6f6e 2d73 7061 6365 206e 6f6e 2d64   non-space non-d
-00016940: 6967 6974 3a3a 0a0a 2020 2020 2020 2020  igit::..        
-00016950: 3e3e 3e20 4953 5f54 494d 4528 2928 2732  >>> IS_TIME()('2
-00016960: 313a 3330 2729 0a20 2020 2020 2020 2028  1:30').        (
-00016970: 6461 7465 7469 6d65 2e74 696d 6528 3231  datetime.time(21
-00016980: 2c20 3330 292c 204e 6f6e 6529 0a20 2020  , 30), None).   
-00016990: 2020 2020 203e 3e3e 2049 535f 5449 4d45       >>> IS_TIME
-000169a0: 2829 2827 3231 2d33 3027 290a 2020 2020  ()('21-30').    
-000169b0: 2020 2020 2864 6174 6574 696d 652e 7469      (datetime.ti
-000169c0: 6d65 2832 312c 2033 3029 2c20 4e6f 6e65  me(21, 30), None
-000169d0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-000169e0: 5f54 494d 4528 2928 2732 312e 3330 2729  _TIME()('21.30')
-000169f0: 0a20 2020 2020 2020 2028 6461 7465 7469  .        (dateti
-00016a00: 6d65 2e74 696d 6528 3231 2c20 3330 292c  me.time(21, 30),
-00016a10: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
-00016a20: 3e3e 2049 535f 5449 4d45 2829 2827 3231  >> IS_TIME()('21
-00016a30: 3a33 303a 3539 2729 0a20 2020 2020 2020  :30:59').       
-00016a40: 2028 6461 7465 7469 6d65 2e74 696d 6528   (datetime.time(
-00016a50: 3231 2c20 3330 2c20 3539 292c 204e 6f6e  21, 30, 59), Non
-00016a60: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-00016a70: 535f 5449 4d45 2829 2827 353a 3330 2729  S_TIME()('5:30')
-00016a80: 0a20 2020 2020 2020 2028 6461 7465 7469  .        (dateti
-00016a90: 6d65 2e74 696d 6528 352c 2033 3029 2c20  me.time(5, 30), 
-00016aa0: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
-00016ab0: 3e20 4953 5f54 494d 4528 2928 2735 3a33  > IS_TIME()('5:3
-00016ac0: 3020 616d 2729 0a20 2020 2020 2020 2028  0 am').        (
-00016ad0: 6461 7465 7469 6d65 2e74 696d 6528 352c  datetime.time(5,
-00016ae0: 2033 3029 2c20 4e6f 6e65 290a 2020 2020   30), None).    
-00016af0: 2020 2020 3e3e 3e20 4953 5f54 494d 4528      >>> IS_TIME(
-00016b00: 2928 2735 3a33 3020 706d 2729 0a20 2020  )('5:30 pm').   
-00016b10: 2020 2020 2028 6461 7465 7469 6d65 2e74       (datetime.t
-00016b20: 696d 6528 3137 2c20 3330 292c 204e 6f6e  ime(17, 30), Non
-00016b30: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-00016b40: 535f 5449 4d45 2829 2827 353a 3330 2077  S_TIME()('5:30 w
-00016b50: 6861 7465 7665 7227 290a 2020 2020 2020  hatever').      
-00016b60: 2020 2827 353a 3330 2077 6861 7465 7665    ('5:30 whateve
-00016b70: 7227 2c20 2765 6e74 6572 2074 696d 6520  r', 'enter time 
-00016b80: 6173 2068 683a 6d6d 3a73 7320 2873 6563  as hh:mm:ss (sec
-00016b90: 6f6e 6473 2c20 616d 2c20 706d 206f 7074  onds, am, pm opt
-00016ba0: 696f 6e61 6c29 2729 0a20 2020 2020 2020  ional)').       
-00016bb0: 203e 3e3e 2049 535f 5449 4d45 2829 2827   >>> IS_TIME()('
-00016bc0: 353a 3330 2032 3027 290a 2020 2020 2020  5:30 20').      
-00016bd0: 2020 2827 353a 3330 2032 3027 2c20 2765    ('5:30 20', 'e
-00016be0: 6e74 6572 2074 696d 6520 6173 2068 683a  nter time as hh:
-00016bf0: 6d6d 3a73 7320 2873 6563 6f6e 6473 2c20  mm:ss (seconds, 
-00016c00: 616d 2c20 706d 206f 7074 696f 6e61 6c29  am, pm optional)
-00016c10: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
-00016c20: 535f 5449 4d45 2829 2827 3234 3a33 3027  S_TIME()('24:30'
-00016c30: 290a 2020 2020 2020 2020 2827 3234 3a33  ).        ('24:3
-00016c40: 3027 2c20 2765 6e74 6572 2074 696d 6520  0', 'enter time 
-00016c50: 6173 2068 683a 6d6d 3a73 7320 2873 6563  as hh:mm:ss (sec
-00016c60: 6f6e 6473 2c20 616d 2c20 706d 206f 7074  onds, am, pm opt
-00016c70: 696f 6e61 6c29 2729 0a20 2020 2020 2020  ional)').       
-00016c80: 203e 3e3e 2049 535f 5449 4d45 2829 2827   >>> IS_TIME()('
-00016c90: 3231 3a36 3027 290a 2020 2020 2020 2020  21:60').        
-00016ca0: 2827 3231 3a36 3027 2c20 2765 6e74 6572  ('21:60', 'enter
-00016cb0: 2074 696d 6520 6173 2068 683a 6d6d 3a73   time as hh:mm:s
-00016cc0: 7320 2873 6563 6f6e 6473 2c20 616d 2c20  s (seconds, am, 
-00016cd0: 706d 206f 7074 696f 6e61 6c29 2729 0a20  pm optional)'). 
-00016ce0: 2020 2020 2020 203e 3e3e 2049 535f 5449         >>> IS_TI
-00016cf0: 4d45 2829 2827 3231 3a33 303a 3a27 290a  ME()('21:30::').
-00016d00: 2020 2020 2020 2020 2827 3231 3a33 303a          ('21:30:
-00016d10: 3a27 2c20 2765 6e74 6572 2074 696d 6520  :', 'enter time 
-00016d20: 6173 2068 683a 6d6d 3a73 7320 2873 6563  as hh:mm:ss (sec
-00016d30: 6f6e 6473 2c20 616d 2c20 706d 206f 7074  onds, am, pm opt
-00016d40: 696f 6e61 6c29 2729 0a20 2020 2020 2020  ional)').       
-00016d50: 203e 3e3e 2049 535f 5449 4d45 2829 2827   >>> IS_TIME()('
-00016d60: 2729 0a20 2020 2020 2020 2028 2727 2c20  ').        ('', 
-00016d70: 2765 6e74 6572 2074 696d 6520 6173 2068  'enter time as h
-00016d80: 683a 6d6d 3a73 7320 2873 6563 6f6e 6473  h:mm:ss (seconds
-00016d90: 2c20 616d 2c20 706d 206f 7074 696f 6e61  , am, pm optiona
-00016da0: 6c29 2729 c3b9 0a0a 2020 2020 2222 220a  l)')....    """.
-00016db0: 0a20 2020 2052 4547 4558 5f54 494d 4520  .    REGEX_TIME 
-00016dc0: 3d20 2228 283f 503c 683e 5b30 2d39 5d2b  = "((?P<h>[0-9]+
-00016dd0: 2929 285b 5e30 2d39 205d 2b28 3f50 3c6d  ))([^0-9 ]+(?P<m
-00016de0: 3e5b 302d 3920 5d2b 2929 3f28 5b5e 302d  >[0-9 ]+))?([^0-
-00016df0: 3961 7020 5d2b 283f 503c 733e 5b30 2d39  9ap ]+(?P<s>[0-9
-00016e00: 5d2a 2929 3f28 283f 503c 643e 5b61 705d  ]*))?((?P<d>[ap]
-00016e10: 6d29 293f 220a 0a20 2020 2064 6566 205f  m))?"..    def _
-00016e20: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-00016e30: 2073 656c 662c 2065 7272 6f72 5f6d 6573   self, error_mes
-00016e40: 7361 6765 3d22 456e 7465 7220 7469 6d65  sage="Enter time
-00016e50: 2061 7320 6868 3a6d 6d3a 7373 2028 7365   as hh:mm:ss (se
-00016e60: 636f 6e64 732c 2061 6d2c 2070 6d20 6f70  conds, am, pm op
-00016e70: 7469 6f6e 616c 2922 0a20 2020 2029 3a0a  tional)".    ):.
-00016e80: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00016e90: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
-00016ea0: 6f72 5f6d 6573 7361 6765 0a0a 2020 2020  or_message..    
-00016eb0: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
-00016ec0: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
-00016ed0: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
-00016ee0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00016ef0: 2020 2020 6976 616c 7565 203d 2076 616c      ivalue = val
-00016f00: 7565 0a20 2020 2020 2020 2020 2020 2076  ue.            v
-00016f10: 616c 7565 203d 2072 652e 6d61 7463 6828  alue = re.match(
-00016f20: 7365 6c66 2e52 4547 4558 5f54 494d 452c  self.REGEX_TIME,
-00016f30: 2076 616c 7565 2e6c 6f77 6572 2829 290a   value.lower()).
-00016f40: 2020 2020 2020 2020 2020 2020 2868 2c20              (h, 
-00016f50: 6d2c 2073 2920 3d20 2869 6e74 2876 616c  m, s) = (int(val
-00016f60: 7565 2e67 726f 7570 2822 6822 2929 2c20  ue.group("h")), 
-00016f70: 302c 2030 290a 2020 2020 2020 2020 2020  0, 0).          
-00016f80: 2020 6966 206e 6f74 2076 616c 7565 2e67    if not value.g
-00016f90: 726f 7570 2822 6d22 2920 6973 204e 6f6e  roup("m") is Non
-00016fa0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00016fb0: 2020 206d 203d 2069 6e74 2876 616c 7565     m = int(value
-00016fc0: 2e67 726f 7570 2822 6d22 2929 0a20 2020  .group("m")).   
-00016fd0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00016fe0: 7661 6c75 652e 6772 6f75 7028 2273 2229  value.group("s")
-00016ff0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00017000: 2020 2020 2020 2020 2020 7320 3d20 696e            s = in
-00017010: 7428 7661 6c75 652e 6772 6f75 7028 2273  t(value.group("s
-00017020: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-00017030: 6966 2076 616c 7565 2e67 726f 7570 2822  if value.group("
-00017040: 6422 2920 3d3d 2022 706d 2220 616e 6420  d") == "pm" and 
-00017050: 3020 3c20 6820 3c20 3132 3a0a 2020 2020  0 < h < 12:.    
-00017060: 2020 2020 2020 2020 2020 2020 6820 2b3d              h +=
-00017070: 2031 320a 2020 2020 2020 2020 2020 2020   12.            
-00017080: 6966 2076 616c 7565 2e67 726f 7570 2822  if value.group("
-00017090: 6422 2920 3d3d 2022 616d 2220 616e 6420  d") == "am" and 
-000170a0: 6820 3d3d 2031 323a 0a20 2020 2020 2020  h == 12:.       
-000170b0: 2020 2020 2020 2020 2068 203d 2030 0a20           h = 0. 
-000170c0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-000170d0: 7420 2868 2069 6e20 7261 6e67 6528 3234  t (h in range(24
-000170e0: 2920 616e 6420 6d20 696e 2072 616e 6765  ) and m in range
-000170f0: 2836 3029 2061 6e64 2073 2069 6e20 7261  (60) and s in ra
-00017100: 6e67 6528 3630 2929 3a0a 2020 2020 2020  nge(60)):.      
-00017110: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00017120: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00017130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017140: 2248 6f75 7273 206f 7220 6d69 6e75 7465  "Hours or minute
-00017150: 7320 6f72 2073 6563 6f6e 6473 2061 7265  s or seconds are
-00017160: 206f 7574 7369 6465 206f 6620 616c 6c6f   outside of allo
-00017170: 7765 6420 7261 6e67 6522 0a20 2020 2020  wed range".     
-00017180: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00017190: 2020 2020 2020 2020 2076 616c 7565 203d           value =
-000171a0: 2064 6174 6574 696d 652e 7469 6d65 2868   datetime.time(h
-000171b0: 2c20 6d2c 2073 290a 2020 2020 2020 2020  , m, s).        
-000171c0: 2020 2020 7265 7475 726e 2076 616c 7565      return value
-000171d0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-000171e0: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
-000171f0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00017200: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
-00017210: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-00017220: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
-00017230: 290a 0a0a 2320 4120 5554 4320 636c 6173  )...# A UTC clas
-00017240: 732e 0a63 6c61 7373 2055 5443 2864 6174  s..class UTC(dat
-00017250: 6574 696d 652e 747a 696e 666f 293a 0a20  etime.tzinfo):. 
-00017260: 2020 2022 2222 5554 4322 2222 0a0a 2020     """UTC"""..  
-00017270: 2020 5a45 524f 203d 2064 6174 6574 696d    ZERO = datetim
-00017280: 652e 7469 6d65 6465 6c74 6128 3029 0a0a  e.timedelta(0)..
-00017290: 2020 2020 6465 6620 7574 636f 6666 7365      def utcoffse
-000172a0: 7428 7365 6c66 2c20 6474 293a 0a20 2020  t(self, dt):.   
-000172b0: 2020 2020 2072 6574 7572 6e20 5554 432e       return UTC.
-000172c0: 5a45 524f 0a0a 2020 2020 6465 6620 747a  ZERO..    def tz
-000172d0: 6e61 6d65 2873 656c 662c 2064 7429 3a0a  name(self, dt):.
-000172e0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-000172f0: 5554 4322 0a0a 2020 2020 6465 6620 6473  UTC"..    def ds
-00017300: 7428 7365 6c66 2c20 6474 293a 0a20 2020  t(self, dt):.   
-00017310: 2020 2020 2072 6574 7572 6e20 5554 432e       return UTC.
-00017320: 5a45 524f 0a0a 0a75 7463 203d 2055 5443  ZERO...utc = UTC
-00017330: 2829 0a0a 0a63 6c61 7373 2049 535f 4441  ()...class IS_DA
-00017340: 5445 2856 616c 6964 6174 6f72 293a 0a20  TE(Validator):. 
-00017350: 2020 2022 2222 0a20 2020 2045 7861 6d70     """.    Examp
-00017360: 6c65 733a 0a20 2020 2020 2020 2055 7365  les:.        Use
-00017370: 2061 733a 3a0a 0a20 2020 2020 2020 2020   as::..         
-00017380: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
-00017390: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
-000173a0: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
-000173b0: 5f44 4154 4528 2929 0a0a 2020 2020 6461  _DATE())..    da
-000173c0: 7465 2068 6173 2074 6f20 6265 2069 6e20  te has to be in 
-000173d0: 7468 6520 4953 4f38 3936 3020 666f 726d  the ISO8960 form
-000173e0: 6174 2059 5959 592d 4d4d 2d44 440a 2020  at YYYY-MM-DD.  
-000173f0: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-00017400: 5f69 6e69 745f 5f28 7365 6c66 2c20 666f  _init__(self, fo
-00017410: 726d 6174 3d22 2559 2d25 6d2d 2564 222c  rmat="%Y-%m-%d",
-00017420: 2065 7272 6f72 5f6d 6573 7361 6765 3d22   error_message="
-00017430: 456e 7465 7220 6461 7465 2061 7320 2528  Enter date as %(
-00017440: 666f 726d 6174 2973 2229 3a0a 2020 2020  format)s"):.    
-00017450: 2020 2020 7365 6c66 2e66 6f72 6d61 7420      self.format 
-00017460: 3d20 7365 6c66 2e74 7261 6e73 6c61 746f  = self.translato
-00017470: 7228 666f 726d 6174 290a 2020 2020 2020  r(format).      
-00017480: 2020 7365 6c66 2e65 7272 6f72 5f6d 6573    self.error_mes
-00017490: 7361 6765 203d 2073 7472 2865 7272 6f72  sage = str(error
-000174a0: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
-000174b0: 2020 7365 6c66 2e65 7874 7265 6d65 7320    self.extremes 
-000174c0: 3d20 7b7d 0a0a 2020 2020 6465 6620 7661  = {}..    def va
-000174d0: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-000174e0: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-000174f0: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-00017500: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-00017510: 2c20 6461 7465 7469 6d65 2e64 6174 6529  , datetime.date)
-00017520: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00017530: 7475 726e 2076 616c 7565 0a20 2020 2020  turn value.     
-00017540: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00017550: 2020 2020 2879 2c20 6d2c 2064 2c20 6868      (y, m, d, hh
-00017560: 2c20 6d6d 2c20 7373 2c20 7430 2c20 7431  , mm, ss, t0, t1
-00017570: 2c20 7432 2920 3d20 7469 6d65 2e73 7472  , t2) = time.str
-00017580: 7074 696d 6528 7661 6c75 652c 2073 7472  ptime(value, str
-00017590: 2873 656c 662e 666f 726d 6174 2929 0a20  (self.format)). 
-000175a0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-000175b0: 203d 2064 6174 6574 696d 652e 6461 7465   = datetime.date
-000175c0: 2879 2c20 6d2c 2064 290a 2020 2020 2020  (y, m, d).      
-000175d0: 2020 2020 2020 7265 7475 726e 2076 616c        return val
-000175e0: 7565 0a20 2020 2020 2020 2065 7863 6570  ue.        excep
-000175f0: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-00017600: 656c 662e 6578 7472 656d 6573 2e75 7064  elf.extremes.upd
-00017610: 6174 6528 4953 5f44 4154 4554 494d 452e  ate(IS_DATETIME.
-00017620: 6e69 6365 2873 656c 662e 666f 726d 6174  nice(self.format
-00017630: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-00017640: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-00017650: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
-00017660: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
-00017670: 6d65 7373 6167 6529 2025 2073 656c 662e  message) % self.
-00017680: 6578 7472 656d 6573 290a 0a20 2020 2064  extremes)..    d
-00017690: 6566 2066 6f72 6d61 7474 6572 2873 656c  ef formatter(sel
-000176a0: 662c 2076 616c 7565 293a 0a20 2020 2020  f, value):.     
-000176b0: 2020 2069 6620 7661 6c75 6520 6973 204e     if value is N
-000176c0: 6f6e 6520 6f72 2076 616c 7565 203d 3d20  one or value == 
-000176d0: 2222 3a0a 2020 2020 2020 2020 2020 2020  "":.            
-000176e0: 7265 7475 726e 204e 6f6e 650a 2020 2020  return None.    
-000176f0: 2020 2020 666f 726d 6174 203d 2073 656c      format = sel
-00017700: 662e 666f 726d 6174 0a20 2020 2020 2020  f.format.       
-00017710: 2079 6561 7220 3d20 7661 6c75 652e 7965   year = value.ye
-00017720: 6172 0a20 2020 2020 2020 2079 203d 2022  ar.        y = "
-00017730: 252e 3469 2220 2520 7965 6172 0a20 2020  %.4i" % year.   
-00017740: 2020 2020 2066 6f72 6d61 7420 3d20 666f       format = fo
-00017750: 726d 6174 2e72 6570 6c61 6365 2822 2579  rmat.replace("%y
-00017760: 222c 2079 5b2d 323a 5d29 0a20 2020 2020  ", y[-2:]).     
-00017770: 2020 2066 6f72 6d61 7420 3d20 666f 726d     format = form
-00017780: 6174 2e72 6570 6c61 6365 2822 2559 222c  at.replace("%Y",
-00017790: 2079 290a 2020 2020 2020 2020 6966 2079   y).        if y
-000177a0: 6561 7220 3c20 3139 3030 3a0a 2020 2020  ear < 1900:.    
-000177b0: 2020 2020 2020 2020 7965 6172 203d 2032          year = 2
-000177c0: 3030 300a 2020 2020 2020 2020 6420 3d20  000.        d = 
-000177d0: 6461 7465 7469 6d65 2e64 6174 6528 7965  datetime.date(ye
-000177e0: 6172 2c20 7661 6c75 652e 6d6f 6e74 682c  ar, value.month,
-000177f0: 2076 616c 7565 2e64 6179 290a 2020 2020   value.day).    
-00017800: 2020 2020 7265 7475 726e 2064 2e73 7472      return d.str
-00017810: 6674 696d 6528 666f 726d 6174 290a 0a0a  ftime(format)...
-00017820: 636c 6173 7320 4953 5f44 4154 4554 494d  class IS_DATETIM
-00017830: 4528 5661 6c69 6461 746f 7229 3a0a 2020  E(Validator):.  
-00017840: 2020 2222 220a 2020 2020 4578 616d 706c    """.    Exampl
-00017850: 6573 3a0a 2020 2020 2020 2020 5573 6520  es:.        Use 
-00017860: 6173 3a3a 0a0a 2020 2020 2020 2020 2020  as::..          
-00017870: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
-00017880: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
-00017890: 6527 2c20 7265 7175 6972 6573 3d49 535f  e', requires=IS_
-000178a0: 4441 5445 5449 4d45 2829 290a 0a20 2020  DATETIME())..   
-000178b0: 2064 6174 6574 696d 6520 6861 7320 746f   datetime has to
-000178c0: 2062 6520 696e 2074 6865 2049 534f 3839   be in the ISO89
-000178d0: 3630 2066 6f72 6d61 7420 5959 5959 2d4d  60 format YYYY-M
-000178e0: 4d2d 4444 2068 683a 6d6d 3a73 730a 2020  M-DD hh:mm:ss.  
-000178f0: 2020 7469 6d65 7a6f 6d65 206d 7573 7420    timezome must 
-00017900: 6265 204e 6f6e 6520 6f72 2061 2070 7974  be None or a pyt
-00017910: 7a2e 7469 6d65 7a6f 6e65 2822 416d 6572  z.timezone("Amer
-00017920: 6963 612f 4368 6963 6167 6f22 2920 6f62  ica/Chicago") ob
-00017930: 6a65 6374 0a20 2020 2022 2222 0a0a 2020  ject.    """..  
-00017940: 2020 6973 6f64 6174 6574 696d 6520 3d20    isodatetime = 
-00017950: 2225 592d 256d 2d25 6420 2548 3a25 4d3a  "%Y-%m-%d %H:%M:
-00017960: 2553 220a 0a20 2020 2040 7374 6174 6963  %S"..    @static
-00017970: 6d65 7468 6f64 0a20 2020 2064 6566 206e  method.    def n
-00017980: 6963 6528 666f 726d 6174 293a 0a20 2020  ice(format):.   
-00017990: 2020 2020 2063 6f64 6520 3d20 280a 2020       code = (.  
-000179a0: 2020 2020 2020 2020 2020 2822 2559 222c            ("%Y",
-000179b0: 2022 3139 3633 2229 2c0a 2020 2020 2020   "1963"),.      
-000179c0: 2020 2020 2020 2822 2579 222c 2022 3633        ("%y", "63
-000179d0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-000179e0: 2822 2564 222c 2022 3238 2229 2c0a 2020  ("%d", "28"),.  
-000179f0: 2020 2020 2020 2020 2020 2822 256d 222c            ("%m",
-00017a00: 2022 3038 2229 2c0a 2020 2020 2020 2020   "08"),.        
-00017a10: 2020 2020 2822 2562 222c 2022 4175 6722      ("%b", "Aug"
-00017a20: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-00017a30: 2225 4222 2c20 2241 7567 7573 7422 292c  "%B", "August"),
-00017a40: 0a20 2020 2020 2020 2020 2020 2028 2225  .            ("%
-00017a50: 4822 2c20 2231 3422 292c 0a20 2020 2020  H", "14"),.     
-00017a60: 2020 2020 2020 2028 2225 4922 2c20 2230         ("%I", "0
-00017a70: 3222 292c 0a20 2020 2020 2020 2020 2020  2"),.           
-00017a80: 2028 2225 7022 2c20 2250 4d22 292c 0a20   ("%p", "PM"),. 
-00017a90: 2020 2020 2020 2020 2020 2028 2225 4d22             ("%M"
-00017aa0: 2c20 2233 3022 292c 0a20 2020 2020 2020  , "30"),.       
-00017ab0: 2020 2020 2028 2225 5322 2c20 2235 3922       ("%S", "59"
-00017ac0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-00017ad0: 2020 2020 2066 6f72 2061 2c20 6220 696e       for a, b in
-00017ae0: 2063 6f64 653a 0a20 2020 2020 2020 2020   code:.         
-00017af0: 2020 2066 6f72 6d61 7420 3d20 666f 726d     format = form
-00017b00: 6174 2e72 6570 6c61 6365 2861 2c20 6229  at.replace(a, b)
-00017b10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00017b20: 6469 6374 2866 6f72 6d61 743d 666f 726d  dict(format=form
-00017b30: 6174 290a 0a20 2020 2064 6566 205f 5f69  at)..    def __i
-00017b40: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-00017b50: 656c 662c 0a20 2020 2020 2020 2066 6f72  elf,.        for
-00017b60: 6d61 743d 2225 592d 256d 2d25 6420 2548  mat="%Y-%m-%d %H
-00017b70: 3a25 4d3a 2553 222c 0a20 2020 2020 2020  :%M:%S",.       
-00017b80: 2065 7272 6f72 5f6d 6573 7361 6765 3d22   error_message="
-00017b90: 456e 7465 7220 6461 7465 2061 6e64 2074  Enter date and t
-00017ba0: 696d 6520 6173 2025 2866 6f72 6d61 7429  ime as %(format)
-00017bb0: 7322 2c0a 2020 2020 2020 2020 7469 6d65  s",.        time
-00017bc0: 7a6f 6e65 3d4e 6f6e 652c 0a20 2020 2029  zone=None,.    )
-00017bd0: 3a0a 2020 2020 2020 2020 7365 6c66 2e66  :.        self.f
-00017be0: 6f72 6d61 7420 3d20 7365 6c66 2e74 7261  ormat = self.tra
-00017bf0: 6e73 6c61 746f 7228 666f 726d 6174 290a  nslator(format).
-00017c00: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00017c10: 6f72 5f6d 6573 7361 6765 203d 2073 7472  or_message = str
-00017c20: 2865 7272 6f72 5f6d 6573 7361 6765 290a  (error_message).
-00017c30: 2020 2020 2020 2020 7365 6c66 2e65 7874          self.ext
-00017c40: 7265 6d65 7320 3d20 7b7d 0a20 2020 2020  remes = {}.     
-00017c50: 2020 2073 656c 662e 7469 6d65 7a6f 6e65     self.timezone
-00017c60: 203d 2074 696d 657a 6f6e 650a 0a20 2020   = timezone..   
-00017c70: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
-00017c80: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
-00017c90: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
-00017ca0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00017cb0: 6528 7661 6c75 652c 2064 6174 6574 696d  e(value, datetim
-00017cc0: 652e 6461 7465 7469 6d65 293a 0a20 2020  e.datetime):.   
-00017cd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00017ce0: 7661 6c75 650a 2020 2020 2020 2020 7472  value.        tr
-00017cf0: 793a 0a20 2020 2020 2020 2020 2020 2069  y:.            i
-00017d00: 6620 7365 6c66 2e66 6f72 6d61 7420 3d3d  f self.format ==
-00017d10: 2073 656c 662e 6973 6f64 6174 6574 696d   self.isodatetim
-00017d20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00017d30: 2020 2076 616c 7565 203d 2076 616c 7565     value = value
-00017d40: 2e72 6570 6c61 6365 2822 5422 2c20 2220  .replace("T", " 
-00017d50: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00017d60: 2020 2069 6620 6c65 6e28 7661 6c75 6529     if len(value)
-00017d70: 203d 3d20 3136 3a0a 2020 2020 2020 2020   == 16:.        
-00017d80: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00017d90: 6520 2b3d 2022 3a30 3022 0a20 2020 2020  e += ":00".     
-00017da0: 2020 2020 2020 2028 792c 206d 2c20 642c         (y, m, d,
-00017db0: 2068 682c 206d 6d2c 2073 732c 2074 302c   hh, mm, ss, t0,
-00017dc0: 2074 312c 2074 3229 203d 2074 696d 652e   t1, t2) = time.
-00017dd0: 7374 7270 7469 6d65 2876 616c 7565 2c20  strptime(value, 
-00017de0: 7374 7228 7365 6c66 2e66 6f72 6d61 7429  str(self.format)
-00017df0: 290a 2020 2020 2020 2020 2020 2020 7661  ).            va
-00017e00: 6c75 6520 3d20 6461 7465 7469 6d65 2e64  lue = datetime.d
-00017e10: 6174 6574 696d 6528 792c 206d 2c20 642c  atetime(y, m, d,
-00017e20: 2068 682c 206d 6d2c 2073 7329 0a20 2020   hh, mm, ss).   
-00017e30: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00017e40: 2e74 696d 657a 6f6e 6520 6973 206e 6f74  .timezone is not
-00017e50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00017e60: 2020 2020 2020 2023 2054 4f44 4f3a 2068         # TODO: h
-00017e70: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00017e80: 6d2f 7765 6232 7079 2f77 6562 3270 792f  m/web2py/web2py/
-00017e90: 6973 7375 6573 2f31 3039 3420 2874 656d  issues/1094 (tem
-00017ea0: 706f 7261 7279 2073 6f6c 7574 696f 6e29  porary solution)
-00017eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017ec0: 2076 616c 7565 203d 2028 0a20 2020 2020   value = (.     
-00017ed0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00017ee0: 656c 662e 7469 6d65 7a6f 6e65 2e6c 6f63  elf.timezone.loc
-00017ef0: 616c 697a 6528 7661 6c75 6529 2e61 7374  alize(value).ast
-00017f00: 696d 657a 6f6e 6528 7574 6329 2e72 6570  imezone(utc).rep
-00017f10: 6c61 6365 2874 7a69 6e66 6f3d 4e6f 6e65  lace(tzinfo=None
-00017f20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00017f30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00017f40: 7265 7475 726e 2076 616c 7565 0a20 2020  return value.   
-00017f50: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00017f60: 2020 2020 2020 2020 2073 656c 662e 6578           self.ex
-00017f70: 7472 656d 6573 2e75 7064 6174 6528 4953  tremes.update(IS
-00017f80: 5f44 4154 4554 494d 452e 6e69 6365 2873  _DATETIME.nice(s
-00017f90: 656c 662e 666f 726d 6174 2929 0a20 2020  elf.format)).   
-00017fa0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00017fb0: 616c 6964 6174 696f 6e45 7272 6f72 2873  alidationError(s
-00017fc0: 656c 662e 7472 616e 736c 6174 6f72 2873  elf.translator(s
-00017fd0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-00017fe0: 6529 2025 2073 656c 662e 6578 7472 656d  e) % self.extrem
-00017ff0: 6573 290a 0a20 2020 2064 6566 2066 6f72  es)..    def for
-00018000: 6d61 7474 6572 2873 656c 662c 2076 616c  matter(self, val
-00018010: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
-00018020: 7661 6c75 6520 6973 204e 6f6e 6520 6f72  value is None or
-00018030: 2076 616c 7565 203d 3d20 2222 3a0a 2020   value == "":.  
-00018040: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018050: 204e 6f6e 650a 2020 2020 2020 2020 666f   None.        fo
-00018060: 726d 6174 203d 2073 656c 662e 666f 726d  rmat = self.form
-00018070: 6174 0a20 2020 2020 2020 2079 6561 7220  at.        year 
-00018080: 3d20 7661 6c75 652e 7965 6172 0a20 2020  = value.year.   
-00018090: 2020 2020 2079 203d 2022 252e 3469 2220       y = "%.4i" 
-000180a0: 2520 7965 6172 0a20 2020 2020 2020 2066  % year.        f
-000180b0: 6f72 6d61 7420 3d20 666f 726d 6174 2e72  ormat = format.r
-000180c0: 6570 6c61 6365 2822 2579 222c 2079 5b2d  eplace("%y", y[-
-000180d0: 323a 5d29 0a20 2020 2020 2020 2066 6f72  2:]).        for
-000180e0: 6d61 7420 3d20 666f 726d 6174 2e72 6570  mat = format.rep
-000180f0: 6c61 6365 2822 2559 222c 2079 290a 2020  lace("%Y", y).  
-00018100: 2020 2020 2020 6966 2079 6561 7220 3c20        if year < 
-00018110: 3139 3030 3a0a 2020 2020 2020 2020 2020  1900:.          
-00018120: 2020 7965 6172 203d 2032 3030 300a 2020    year = 2000.  
-00018130: 2020 2020 2020 6420 3d20 6461 7465 7469        d = dateti
-00018140: 6d65 2e64 6174 6574 696d 6528 0a20 2020  me.datetime(.   
-00018150: 2020 2020 2020 2020 2079 6561 722c 2076           year, v
-00018160: 616c 7565 2e6d 6f6e 7468 2c20 7661 6c75  alue.month, valu
-00018170: 652e 6461 792c 2076 616c 7565 2e68 6f75  e.day, value.hou
-00018180: 722c 2076 616c 7565 2e6d 696e 7574 652c  r, value.minute,
-00018190: 2076 616c 7565 2e73 6563 6f6e 640a 2020   value.second.  
-000181a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000181b0: 6966 2073 656c 662e 7469 6d65 7a6f 6e65  if self.timezone
-000181c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000181d0: 2020 2020 2020 2020 2020 6420 3d20 642e            d = d.
-000181e0: 7265 706c 6163 6528 747a 696e 666f 3d75  replace(tzinfo=u
-000181f0: 7463 292e 6173 7469 6d65 7a6f 6e65 2873  tc).astimezone(s
-00018200: 656c 662e 7469 6d65 7a6f 6e65 290a 2020  elf.timezone).  
-00018210: 2020 2020 2020 7265 7475 726e 2064 2e73        return d.s
-00018220: 7472 6674 696d 6528 666f 726d 6174 290a  trftime(format).
-00018230: 0a0a 636c 6173 7320 4953 5f44 4154 455f  ..class IS_DATE_
-00018240: 494e 5f52 414e 4745 2849 535f 4441 5445  IN_RANGE(IS_DATE
-00018250: 293a 0a20 2020 2022 2222 0a20 2020 2045  ):.    """.    E
-00018260: 7861 6d70 6c65 733a 0a20 2020 2020 2020  xamples:.       
-00018270: 2055 7365 2061 733a 3a0a 0a20 2020 2020   Use as::..     
-00018280: 2020 2020 2020 203e 3e3e 2076 203d 2049         >>> v = I
-00018290: 535f 4441 5445 5f49 4e5f 5241 4e47 4528  S_DATE_IN_RANGE(
-000182a0: 6d69 6e69 6d75 6d3d 6461 7465 7469 6d65  minimum=datetime
-000182b0: 2e64 6174 6528 3230 3038 2c31 2c31 292c  .date(2008,1,1),
-000182c0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182e0: 2020 2020 2020 2020 6d61 7869 6d75 6d3d          maximum=
-000182f0: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00018300: 3039 2c31 322c 3331 292c 205c 0a20 2020  09,12,31), \.   
-00018310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018330: 2020 666f 726d 6174 3d22 256d 2f25 642f    format="%m/%d/
-00018340: 2559 222c 6572 726f 725f 6d65 7373 6167  %Y",error_messag
-00018350: 653d 224f 6f70 7322 290a 0a20 2020 2020  e="Oops")..     
-00018360: 2020 2020 2020 203e 3e3e 2076 2827 3033         >>> v('03
-00018370: 2f30 332f 3230 3038 2729 0a20 2020 2020  /03/2008').     
-00018380: 2020 2020 2020 2028 6461 7465 7469 6d65         (datetime
-00018390: 2e64 6174 6528 3230 3038 2c20 332c 2033  .date(2008, 3, 3
-000183a0: 292c 204e 6f6e 6529 0a0a 2020 2020 2020  ), None)..      
-000183b0: 2020 2020 2020 3e3e 3e20 7628 2730 332f        >>> v('03/
-000183c0: 3033 2f32 3031 3027 290a 2020 2020 2020  03/2010').      
-000183d0: 2020 2020 2020 2827 3033 2f30 332f 3230        ('03/03/20
-000183e0: 3130 272c 2027 6f6f 7073 2729 0a0a 2020  10', 'oops')..  
-000183f0: 2020 2020 2020 2020 2020 3e3e 3e20 7628            >>> v(
-00018400: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00018410: 3038 2c33 2c33 2929 0a20 2020 2020 2020  08,3,3)).       
-00018420: 2020 2020 2028 6461 7465 7469 6d65 2e64       (datetime.d
-00018430: 6174 6528 3230 3038 2c20 332c 2033 292c  ate(2008, 3, 3),
-00018440: 204e 6f6e 6529 0a0a 2020 2020 2020 2020   None)..        
-00018450: 2020 2020 3e3e 3e20 7628 6461 7465 7469      >>> v(dateti
-00018460: 6d65 2e64 6174 6528 3230 3130 2c33 2c33  me.date(2010,3,3
-00018470: 2929 0a20 2020 2020 2020 2020 2020 2028  )).            (
-00018480: 6461 7465 7469 6d65 2e64 6174 6528 3230  datetime.date(20
-00018490: 3130 2c20 332c 2033 292c 2027 6f6f 7073  10, 3, 3), 'oops
-000184a0: 2729 0a0a 2020 2020 2222 220a 0a20 2020  ')..    """..   
-000184b0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
-000184c0: 2020 2020 2020 2073 656c 662c 206d 696e         self, min
-000184d0: 696d 756d 3d4e 6f6e 652c 206d 6178 696d  imum=None, maxim
-000184e0: 756d 3d4e 6f6e 652c 2066 6f72 6d61 743d  um=None, format=
-000184f0: 2225 592d 256d 2d25 6422 2c20 6572 726f  "%Y-%m-%d", erro
-00018500: 725f 6d65 7373 6167 653d 4e6f 6e65 0a20  r_message=None. 
-00018510: 2020 2029 3a0a 2020 2020 2020 2020 7365     ):.        se
-00018520: 6c66 2e6d 696e 696d 756d 203d 206d 696e  lf.minimum = min
-00018530: 696d 756d 0a20 2020 2020 2020 2073 656c  imum.        sel
-00018540: 662e 6d61 7869 6d75 6d20 3d20 6d61 7869  f.maximum = maxi
-00018550: 6d75 6d0a 2020 2020 2020 2020 6966 2065  mum.        if e
-00018560: 7272 6f72 5f6d 6573 7361 6765 2069 7320  rror_message is 
-00018570: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00018580: 2020 6966 206d 696e 696d 756d 2069 7320    if minimum is 
-00018590: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000185a0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000185b0: 6167 6520 3d20 2245 6e74 6572 2064 6174  age = "Enter dat
-000185c0: 6520 6f6e 206f 7220 6265 666f 7265 2025  e on or before %
-000185d0: 286d 6178 2973 220a 2020 2020 2020 2020  (max)s".        
-000185e0: 2020 2020 656c 6966 206d 6178 696d 756d      elif maximum
-000185f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00018600: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-00018610: 6d65 7373 6167 6520 3d20 2245 6e74 6572  message = "Enter
-00018620: 2064 6174 6520 6f6e 206f 7220 6166 7465   date on or afte
-00018630: 7220 2528 6d69 6e29 7322 0a20 2020 2020  r %(min)s".     
-00018640: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00018650: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00018660: 6f72 5f6d 6573 7361 6765 203d 2022 456e  or_message = "En
-00018670: 7465 7220 6461 7465 2069 6e20 7261 6e67  ter date in rang
-00018680: 6520 2528 6d69 6e29 7320 2528 6d61 7829  e %(min)s %(max)
-00018690: 7322 0a20 2020 2020 2020 2049 535f 4441  s".        IS_DA
-000186a0: 5445 2e5f 5f69 6e69 745f 5f28 7365 6c66  TE.__init__(self
-000186b0: 2c20 666f 726d 6174 3d66 6f72 6d61 742c  , format=format,
-000186c0: 2065 7272 6f72 5f6d 6573 7361 6765 3d65   error_message=e
-000186d0: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
-000186e0: 2020 2020 2020 7365 6c66 2e65 7874 7265        self.extre
-000186f0: 6d65 7320 3d20 6469 6374 286d 696e 3d73  mes = dict(min=s
-00018700: 656c 662e 666f 726d 6174 7465 7228 6d69  elf.formatter(mi
-00018710: 6e69 6d75 6d29 2c20 6d61 783d 7365 6c66  nimum), max=self
-00018720: 2e66 6f72 6d61 7474 6572 286d 6178 696d  .formatter(maxim
-00018730: 756d 2929 0a0a 2020 2020 6465 6620 7661  um))..    def va
-00018740: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-00018750: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-00018760: 6e65 293a 0a20 2020 2020 2020 2076 616c  ne):.        val
-00018770: 7565 203d 2049 535f 4441 5445 2e76 616c  ue = IS_DATE.val
-00018780: 6964 6174 6528 7365 6c66 2c20 7661 6c75  idate(self, valu
-00018790: 652c 2072 6563 6f72 645f 6964 3d4e 6f6e  e, record_id=Non
-000187a0: 6529 0a20 2020 2020 2020 2069 6620 7365  e).        if se
-000187b0: 6c66 2e6d 696e 696d 756d 2061 6e64 2073  lf.minimum and s
-000187c0: 656c 662e 6d69 6e69 6d75 6d20 3e20 7661  elf.minimum > va
-000187d0: 6c75 653a 0a20 2020 2020 2020 2020 2020  lue:.           
-000187e0: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
-000187f0: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
-00018800: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
-00018810: 725f 6d65 7373 6167 6529 2025 2073 656c  r_message) % sel
-00018820: 662e 6578 7472 656d 6573 290a 2020 2020  f.extremes).    
-00018830: 2020 2020 6966 2073 656c 662e 6d61 7869      if self.maxi
-00018840: 6d75 6d20 616e 6420 7661 6c75 6520 3e20  mum and value > 
-00018850: 7365 6c66 2e6d 6178 696d 756d 3a0a 2020  self.maximum:.  
-00018860: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00018870: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
-00018880: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-00018890: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
-000188a0: 6765 2920 2520 7365 6c66 2e65 7874 7265  ge) % self.extre
-000188b0: 6d65 7329 0a20 2020 2020 2020 2072 6574  mes).        ret
-000188c0: 7572 6e20 7661 6c75 650a 0a0a 636c 6173  urn value...clas
-000188d0: 7320 4953 5f44 4154 4554 494d 455f 494e  s IS_DATETIME_IN
-000188e0: 5f52 414e 4745 2849 535f 4441 5445 5449  _RANGE(IS_DATETI
-000188f0: 4d45 293a 0a20 2020 2022 2222 0a20 2020  ME):.    """.   
-00018900: 2045 7861 6d70 6c65 733a 0a20 2020 2020   Examples:.     
-00018910: 2020 2055 7365 2061 733a 3a0a 2020 2020     Use as::.    
-00018920: 2020 2020 2020 2020 3e3e 3e20 7620 3d20          >>> v = 
-00018930: 4953 5f44 4154 4554 494d 455f 494e 5f52  IS_DATETIME_IN_R
-00018940: 414e 4745 285c 0a20 2020 2020 2020 2020  ANGE(\.         
-00018950: 2020 2020 2020 2020 2020 206d 696e 696d             minim
-00018960: 756d 3d64 6174 6574 696d 652e 6461 7465  um=datetime.date
-00018970: 7469 6d65 2832 3030 382c 312c 312c 3132  time(2008,1,1,12
-00018980: 2c32 3029 2c20 5c0a 2020 2020 2020 2020  ,20), \.        
-00018990: 2020 2020 2020 2020 2020 2020 6d61 7869              maxi
-000189a0: 6d75 6d3d 6461 7465 7469 6d65 2e64 6174  mum=datetime.dat
-000189b0: 6574 696d 6528 3230 3039 2c31 322c 3331  etime(2009,12,31
-000189c0: 2c31 322c 3230 292c 205c 0a20 2020 2020  ,12,20), \.     
-000189d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000189e0: 6f72 6d61 743d 2225 6d2f 2564 2f25 5920  ormat="%m/%d/%Y 
-000189f0: 2548 3a25 4d22 2c65 7272 6f72 5f6d 6573  %H:%M",error_mes
-00018a00: 7361 6765 3d22 4f6f 7073 2229 0a20 2020  sage="Oops").   
-00018a10: 2020 2020 2020 2020 203e 3e3e 2076 2827           >>> v('
-00018a20: 3033 2f30 332f 3230 3038 2031 323a 3430  03/03/2008 12:40
-00018a30: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
-00018a40: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00018a50: 6528 3230 3038 2c20 332c 2033 2c20 3132  e(2008, 3, 3, 12
-00018a60: 2c20 3430 292c 204e 6f6e 6529 0a0a 2020  , 40), None)..  
-00018a70: 2020 2020 2020 2020 2020 3e3e 3e20 7628            >>> v(
-00018a80: 2730 332f 3033 2f32 3031 3020 3130 3a33  '03/03/2010 10:3
-00018a90: 3427 290a 2020 2020 2020 2020 2020 2020  4').            
-00018aa0: 2827 3033 2f30 332f 3230 3130 2031 303a  ('03/03/2010 10:
-00018ab0: 3334 272c 2027 6f6f 7073 2729 0a0a 2020  34', 'oops')..  
-00018ac0: 2020 2020 2020 2020 2020 3e3e 3e20 7628            >>> v(
-00018ad0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00018ae0: 6528 3230 3038 2c33 2c33 2c30 2c30 2929  e(2008,3,3,0,0))
-00018af0: 0a20 2020 2020 2020 2020 2020 2028 6461  .            (da
-00018b00: 7465 7469 6d65 2e64 6174 6574 696d 6528  tetime.datetime(
-00018b10: 3230 3038 2c20 332c 2033 2c20 302c 2030  2008, 3, 3, 0, 0
-00018b20: 292c 204e 6f6e 6529 0a0a 2020 2020 2020  ), None)..      
-00018b30: 2020 2020 2020 3e3e 3e20 7628 6461 7465        >>> v(date
-00018b40: 7469 6d65 2e64 6174 6574 696d 6528 3230  time.datetime(20
-00018b50: 3130 2c33 2c33 2c30 2c30 2929 0a20 2020  10,3,3,0,0)).   
-00018b60: 2020 2020 2020 2020 2028 6461 7465 7469           (dateti
-00018b70: 6d65 2e64 6174 6574 696d 6528 3230 3130  me.datetime(2010
-00018b80: 2c20 332c 2033 2c20 302c 2030 292c 2027  , 3, 3, 0, 0), '
-00018b90: 6f6f 7073 2729 0a0a 2020 2020 2222 220a  oops')..    """.
-00018ba0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00018bb0: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
-00018bc0: 0a20 2020 2020 2020 206d 696e 696d 756d  .        minimum
-00018bd0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206d  =None,.        m
-00018be0: 6178 696d 756d 3d4e 6f6e 652c 0a20 2020  aximum=None,.   
-00018bf0: 2020 2020 2066 6f72 6d61 743d 2225 592d       format="%Y-
-00018c00: 256d 2d25 6420 2548 3a25 4d3a 2553 222c  %m-%d %H:%M:%S",
-00018c10: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00018c20: 6573 7361 6765 3d4e 6f6e 652c 0a20 2020  essage=None,.   
-00018c30: 2020 2020 2074 696d 657a 6f6e 653d 4e6f       timezone=No
-00018c40: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00018c50: 2020 2073 656c 662e 6d69 6e69 6d75 6d20     self.minimum 
-00018c60: 3d20 6d69 6e69 6d75 6d0a 2020 2020 2020  = minimum.      
-00018c70: 2020 7365 6c66 2e6d 6178 696d 756d 203d    self.maximum =
-00018c80: 206d 6178 696d 756d 0a20 2020 2020 2020   maximum.       
-00018c90: 2069 6620 6572 726f 725f 6d65 7373 6167   if error_messag
-00018ca0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00018cb0: 2020 2020 2020 2069 6620 6d69 6e69 6d75         if minimu
-00018cc0: 6d20 6973 204e 6f6e 653a 0a20 2020 2020  m is None:.     
-00018cd0: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-00018ce0: 5f6d 6573 7361 6765 203d 2022 456e 7465  _message = "Ente
-00018cf0: 7220 6461 7465 2061 6e64 2074 696d 6520  r date and time 
-00018d00: 6f6e 206f 7220 6265 666f 7265 2025 286d  on or before %(m
-00018d10: 6178 2973 220a 2020 2020 2020 2020 2020  ax)s".          
-00018d20: 2020 656c 6966 206d 6178 696d 756d 2069    elif maximum i
-00018d30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00018d40: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00018d50: 7373 6167 6520 3d20 2245 6e74 6572 2064  ssage = "Enter d
-00018d60: 6174 6520 616e 6420 7469 6d65 206f 6e20  ate and time on 
-00018d70: 6f72 2061 6674 6572 2025 286d 696e 2973  or after %(min)s
-00018d80: 220a 2020 2020 2020 2020 2020 2020 656c  ".            el
-00018d90: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00018da0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00018db0: 6520 3d20 2245 6e74 6572 2064 6174 6520  e = "Enter date 
-00018dc0: 616e 6420 7469 6d65 2069 6e20 7261 6e67  and time in rang
-00018dd0: 6520 2528 6d69 6e29 7320 2528 6d61 7829  e %(min)s %(max)
-00018de0: 7322 0a20 2020 2020 2020 2049 535f 4441  s".        IS_DA
-00018df0: 5445 5449 4d45 2e5f 5f69 6e69 745f 5f28  TETIME.__init__(
-00018e00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00018e10: 662c 2066 6f72 6d61 743d 666f 726d 6174  f, format=format
-00018e20: 2c20 6572 726f 725f 6d65 7373 6167 653d  , error_message=
-00018e30: 6572 726f 725f 6d65 7373 6167 652c 2074  error_message, t
-00018e40: 696d 657a 6f6e 653d 7469 6d65 7a6f 6e65  imezone=timezone
-00018e50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00018e60: 2020 2073 656c 662e 6578 7472 656d 6573     self.extremes
-00018e70: 203d 2064 6963 7428 6d69 6e3d 7365 6c66   = dict(min=self
-00018e80: 2e66 6f72 6d61 7474 6572 286d 696e 696d  .formatter(minim
-00018e90: 756d 292c 206d 6178 3d73 656c 662e 666f  um), max=self.fo
-00018ea0: 726d 6174 7465 7228 6d61 7869 6d75 6d29  rmatter(maximum)
-00018eb0: 290a 0a20 2020 2064 6566 2076 616c 6964  )..    def valid
-00018ec0: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
-00018ed0: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
-00018ee0: 3a0a 2020 2020 2020 2020 7661 6c75 6520  :.        value 
-00018ef0: 3d20 4953 5f44 4154 4554 494d 452e 7661  = IS_DATETIME.va
-00018f00: 6c69 6461 7465 2873 656c 662c 2076 616c  lidate(self, val
-00018f10: 7565 2c20 7265 636f 7264 5f69 643d 4e6f  ue, record_id=No
-00018f20: 6e65 290a 2020 2020 2020 2020 6966 2073  ne).        if s
-00018f30: 656c 662e 6d69 6e69 6d75 6d20 616e 6420  elf.minimum and 
-00018f40: 7365 6c66 2e6d 696e 696d 756d 203e 2076  self.minimum > v
-00018f50: 616c 7565 3a0a 2020 2020 2020 2020 2020  alue:.          
-00018f60: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-00018f70: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-00018f80: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-00018f90: 6f72 5f6d 6573 7361 6765 2920 2520 7365  or_message) % se
-00018fa0: 6c66 2e65 7874 7265 6d65 7329 0a20 2020  lf.extremes).   
-00018fb0: 2020 2020 2069 6620 7365 6c66 2e6d 6178       if self.max
-00018fc0: 696d 756d 2061 6e64 2076 616c 7565 203e  imum and value >
-00018fd0: 2073 656c 662e 6d61 7869 6d75 6d3a 0a20   self.maximum:. 
-00018fe0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018ff0: 2056 616c 6964 6174 696f 6e45 7272 6f72   ValidationError
-00019000: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
-00019010: 2873 656c 662e 6572 726f 725f 6d65 7373  (self.error_mess
-00019020: 6167 6529 2025 2073 656c 662e 6578 7472  age) % self.extr
-00019030: 656d 6573 290a 2020 2020 2020 2020 7265  emes).        re
-00019040: 7475 726e 2076 616c 7565 0a0a 0a63 6c61  turn value...cla
-00019050: 7373 2049 535f 4c49 5354 5f4f 4628 5661  ss IS_LIST_OF(Va
-00019060: 6c69 6461 746f 7229 3a0a 2020 2020 6465  lidator):.    de
-00019070: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00019080: 206f 7468 6572 3d4e 6f6e 652c 206d 696e   other=None, min
-00019090: 696d 756d 3d4e 6f6e 652c 206d 6178 696d  imum=None, maxim
-000190a0: 756d 3d4e 6f6e 652c 2065 7272 6f72 5f6d  um=None, error_m
-000190b0: 6573 7361 6765 3d4e 6f6e 6529 3a0a 2020  essage=None):.  
-000190c0: 2020 2020 2020 7365 6c66 2e6f 7468 6572        self.other
-000190d0: 203d 206f 7468 6572 0a20 2020 2020 2020   = other.       
-000190e0: 2073 656c 662e 6d69 6e69 6d75 6d20 3d20   self.minimum = 
-000190f0: 6d69 6e69 6d75 6d0a 2020 2020 2020 2020  minimum.        
-00019100: 7365 6c66 2e6d 6178 696d 756d 203d 206d  self.maximum = m
-00019110: 6178 696d 756d 0a20 2020 2020 2020 2073  aximum.        s
-00019120: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-00019130: 6520 3d20 6572 726f 725f 6d65 7373 6167  e = error_messag
-00019140: 650a 0a20 2020 2064 6566 2076 616c 6964  e..    def valid
-00019150: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
-00019160: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
-00019170: 3a0a 2020 2020 2020 2020 6976 616c 7565  :.        ivalue
-00019180: 203d 2076 616c 7565 0a20 2020 2020 2020   = value.       
-00019190: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-000191a0: 6365 2876 616c 7565 2c20 6c69 7374 293a  ce(value, list):
-000191b0: 0a20 2020 2020 2020 2020 2020 2069 7661  .            iva
-000191c0: 6c75 6520 3d20 5b69 7661 6c75 655d 0a20  lue = [ivalue]. 
-000191d0: 2020 2020 2020 2069 7661 6c75 6520 3d20         ivalue = 
-000191e0: 5b69 2066 6f72 2069 2069 6e20 6976 616c  [i for i in ival
-000191f0: 7565 2069 6620 7374 7228 6929 2e73 7472  ue if str(i).str
-00019200: 6970 2829 5d0a 2020 2020 2020 2020 6966  ip()].        if
-00019210: 2073 656c 662e 6d69 6e69 6d75 6d20 6973   self.minimum is
-00019220: 206e 6f74 204e 6f6e 6520 616e 6420 6c65   not None and le
-00019230: 6e28 6976 616c 7565 2920 3c20 7365 6c66  n(ivalue) < self
-00019240: 2e6d 696e 696d 756d 3a0a 2020 2020 2020  .minimum:.      
-00019250: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-00019260: 6461 7469 6f6e 4572 726f 7228 0a20 2020  dationError(.   
-00019270: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00019280: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-00019290: 662e 6572 726f 725f 6d65 7373 6167 6520  f.error_message 
-000192a0: 6f72 2022 4d69 6e69 6d75 6d20 6c65 6e67  or "Minimum leng
-000192b0: 7468 2069 7320 2528 6d69 6e29 7322 290a  th is %(min)s").
-000192c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192d0: 2520 6469 6374 286d 696e 3d73 656c 662e  % dict(min=self.
-000192e0: 6d69 6e69 6d75 6d2c 206d 6178 3d73 656c  minimum, max=sel
-000192f0: 662e 6d61 7869 6d75 6d29 0a20 2020 2020  f.maximum).     
-00019300: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019310: 2069 6620 7365 6c66 2e6d 6178 696d 756d   if self.maximum
-00019320: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-00019330: 206c 656e 2869 7661 6c75 6529 203e 2073   len(ivalue) > s
-00019340: 656c 662e 6d61 7869 6d75 6d3a 0a20 2020  elf.maximum:.   
-00019350: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00019360: 616c 6964 6174 696f 6e45 7272 6f72 280a  alidationError(.
-00019370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019380: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-00019390: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
-000193a0: 6765 206f 7220 224d 6178 696d 756d 206c  ge or "Maximum l
-000193b0: 656e 6774 6820 6973 2025 286d 6178 2973  ength is %(max)s
-000193c0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000193d0: 2020 2025 2064 6963 7428 6d69 6e3d 7365     % dict(min=se
-000193e0: 6c66 2e6d 696e 696d 756d 2c20 6d61 783d  lf.minimum, max=
-000193f0: 7365 6c66 2e6d 6178 696d 756d 290a 2020  self.maximum).  
-00019400: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00019410: 2020 2020 6e65 775f 7661 6c75 6520 3d20      new_value = 
-00019420: 5b5d 0a20 2020 2020 2020 206f 7468 6572  [].        other
-00019430: 203d 2073 656c 662e 6f74 6865 720a 2020   = self.other.  
-00019440: 2020 2020 2020 6966 2073 656c 662e 6f74        if self.ot
-00019450: 6865 723a 0a20 2020 2020 2020 2020 2020  her:.           
-00019460: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-00019470: 6365 286f 7468 6572 2c20 286c 6973 742c  ce(other, (list,
-00019480: 2074 7570 6c65 2929 3a0a 2020 2020 2020   tuple)):.      
-00019490: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
-000194a0: 3d20 5b6f 7468 6572 5d0a 2020 2020 2020  = [other].      
-000194b0: 2020 2020 2020 666f 7220 6974 656d 2069        for item i
-000194c0: 6e20 6976 616c 7565 3a0a 2020 2020 2020  n ivalue:.      
-000194d0: 2020 2020 2020 2020 2020 7620 3d20 6974            v = it
-000194e0: 656d 0a20 2020 2020 2020 2020 2020 2020  em.             
-000194f0: 2020 2066 6f72 2076 616c 6964 6174 6f72     for validator
-00019500: 2069 6e20 6f74 6865 723a 0a20 2020 2020   in other:.     
-00019510: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00019520: 203d 2076 616c 6964 6174 6f72 5f63 616c   = validator_cal
-00019530: 6c65 7228 7661 6c69 6461 746f 722c 2076  ler(validator, v
-00019540: 2c20 7265 636f 7264 5f69 6429 0a20 2020  , record_id).   
-00019550: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00019560: 5f76 616c 7565 2e61 7070 656e 6428 7629  _value.append(v)
-00019570: 0a20 2020 2020 2020 2020 2020 2069 7661  .            iva
-00019580: 6c75 6520 3d20 6e65 775f 7661 6c75 650a  lue = new_value.
-00019590: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-000195a0: 7661 6c75 650a 0a0a 636c 6173 7320 4953  value...class IS
-000195b0: 5f4c 4f57 4552 2856 616c 6964 6174 6f72  _LOWER(Validator
-000195c0: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-000195d0: 6f6e 7665 7274 7320 746f 206c 6f77 6572  onverts to lower
-000195e0: 6361 7365 3a3a 0a0a 2020 2020 2020 2020  case::..        
-000195f0: 3e3e 3e20 4953 5f4c 4f57 4552 2829 2827  >>> IS_LOWER()('
-00019600: 4142 4327 290a 2020 2020 2020 2020 2827  ABC').        ('
-00019610: 6162 6327 2c20 4e6f 6e65 290a 2020 2020  abc', None).    
-00019620: 2020 2020 3e3e 3e20 4953 5f4c 4f57 4552      >>> IS_LOWER
-00019630: 2829 2827 c391 2729 0a20 2020 2020 2020  ()('..').       
-00019640: 2028 275c 5c78 6333 5c5c 7862 3127 2c20   ('\\xc3\\xb1', 
-00019650: 4e6f 6e65 290a 0a20 2020 2022 2222 0a0a  None)..    """..
-00019660: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-00019670: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
-00019680: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
-00019690: 2020 2020 2020 2063 6173 745f 6261 636b         cast_back
-000196a0: 203d 206c 616d 6264 6120 783a 2078 0a20   = lambda x: x. 
-000196b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000196c0: 616e 6365 2876 616c 7565 2c20 7374 7229  ance(value, str)
-000196d0: 3a0a 2020 2020 2020 2020 2020 2020 6361  :.            ca
-000196e0: 7374 5f62 6163 6b20 3d20 746f 5f6e 6174  st_back = to_nat
-000196f0: 6976 650a 2020 2020 2020 2020 656c 6966  ive.        elif
-00019700: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-00019710: 652c 2062 7974 6573 293a 0a20 2020 2020  e, bytes):.     
-00019720: 2020 2020 2020 2063 6173 745f 6261 636b         cast_back
-00019730: 203d 2074 6f5f 6279 7465 730a 2020 2020   = to_bytes.    
-00019740: 2020 2020 7661 6c75 6520 3d20 746f 5f75      value = to_u
-00019750: 6e69 636f 6465 2876 616c 7565 292e 6c6f  nicode(value).lo
-00019760: 7765 7228 290a 2020 2020 2020 2020 7265  wer().        re
-00019770: 7475 726e 2063 6173 745f 6261 636b 2876  turn cast_back(v
-00019780: 616c 7565 290a 0a0a 636c 6173 7320 4953  alue)...class IS
-00019790: 5f55 5050 4552 2856 616c 6964 6174 6f72  _UPPER(Validator
-000197a0: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
-000197b0: 6f6e 7665 7274 7320 746f 2075 7070 6572  onverts to upper
-000197c0: 6361 7365 3a3a 0a0a 2020 2020 2020 2020  case::..        
-000197d0: 3e3e 3e20 4953 5f55 5050 4552 2829 2827  >>> IS_UPPER()('
-000197e0: 6162 6327 290a 2020 2020 2020 2020 2827  abc').        ('
-000197f0: 4142 4327 2c20 4e6f 6e65 290a 2020 2020  ABC', None).    
-00019800: 2020 2020 3e3e 3e20 4953 5f55 5050 4552      >>> IS_UPPER
-00019810: 2829 2827 c3b1 2729 0a20 2020 2020 2020  ()('..').       
-00019820: 2028 275c 5c78 6333 5c5c 7839 3127 2c20   ('\\xc3\\x91', 
-00019830: 4e6f 6e65 290a 0a20 2020 2022 2222 0a0a  None)..    """..
-00019840: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-00019850: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
-00019860: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
-00019870: 2020 2020 2020 2063 6173 745f 6261 636b         cast_back
-00019880: 203d 206c 616d 6264 6120 783a 2078 0a20   = lambda x: x. 
-00019890: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000198a0: 616e 6365 2876 616c 7565 2c20 7374 7229  ance(value, str)
-000198b0: 3a0a 2020 2020 2020 2020 2020 2020 6361  :.            ca
-000198c0: 7374 5f62 6163 6b20 3d20 746f 5f6e 6174  st_back = to_nat
-000198d0: 6976 650a 2020 2020 2020 2020 656c 6966  ive.        elif
-000198e0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-000198f0: 652c 2062 7974 6573 293a 0a20 2020 2020  e, bytes):.     
-00019900: 2020 2020 2020 2063 6173 745f 6261 636b         cast_back
-00019910: 203d 2074 6f5f 6279 7465 730a 2020 2020   = to_bytes.    
-00019920: 2020 2020 7661 6c75 6520 3d20 746f 5f75      value = to_u
-00019930: 6e69 636f 6465 2876 616c 7565 292e 7570  nicode(value).up
-00019940: 7065 7228 290a 2020 2020 2020 2020 7265  per().        re
-00019950: 7475 726e 2063 6173 745f 6261 636b 2876  turn cast_back(v
-00019960: 616c 7565 290a 0a0a 6465 6620 7572 6c69  alue)...def urli
-00019970: 6679 2873 2c20 6d61 786c 656e 3d38 302c  fy(s, maxlen=80,
-00019980: 206b 6565 705f 756e 6465 7273 636f 7265   keep_underscore
-00019990: 733d 4661 6c73 6529 3a0a 2020 2020 2222  s=False):.    ""
-000199a0: 220a 2020 2020 436f 6e76 6572 7473 2069  ".    Converts i
-000199b0: 6e63 6f6d 696e 6720 7374 7269 6e67 2074  ncoming string t
-000199c0: 6f20 6120 7369 6d70 6c69 6669 6564 2041  o a simplified A
-000199d0: 5343 4949 2073 7562 7365 742e 0a20 2020  SCII subset..   
-000199e0: 2069 6620 286b 6565 705f 756e 6465 7273   if (keep_unders
-000199f0: 636f 7265 7329 3a20 756e 6465 7273 636f  cores): undersco
-00019a00: 7265 7320 6172 6520 7265 7461 696e 6564  res are retained
-00019a10: 2069 6e20 7468 6520 7374 7269 6e67 0a20   in the string. 
-00019a20: 2020 2065 6c73 653a 2075 6e64 6572 7363     else: undersc
-00019a30: 6f72 6573 2061 7265 2074 7261 6e73 6c61  ores are transla
-00019a40: 7465 6420 746f 2068 7970 6865 6e73 2028  ted to hyphens (
-00019a50: 6465 6661 756c 7429 0a20 2020 2022 2222  default).    """
-00019a60: 0a20 2020 2073 203d 2074 6f5f 756e 6963  .    s = to_unic
-00019a70: 6f64 6528 7329 2020 2320 746f 2075 6e69  ode(s)  # to uni
-00019a80: 636f 6465 0a20 2020 2073 203d 2073 2e6c  code.    s = s.l
-00019a90: 6f77 6572 2829 2020 2320 746f 206c 6f77  ower()  # to low
-00019aa0: 6572 6361 7365 0a20 2020 2073 203d 2075  ercase.    s = u
-00019ab0: 6e69 636f 6465 6461 7461 2e6e 6f72 6d61  nicodedata.norma
-00019ac0: 6c69 7a65 2822 4e46 4b44 222c 2073 2920  lize("NFKD", s) 
-00019ad0: 2023 2072 6570 6c61 6365 2073 7065 6369   # replace speci
-00019ae0: 616c 2063 6861 7261 6374 6572 730a 2020  al characters.  
-00019af0: 2020 7320 3d20 746f 5f6e 6174 6976 6528    s = to_native(
-00019b00: 732c 2063 6861 7273 6574 3d22 6173 6369  s, charset="asci
-00019b10: 6922 2c20 6572 726f 7273 3d22 6967 6e6f  i", errors="igno
-00019b20: 7265 2229 2020 2320 656e 636f 6465 2061  re")  # encode a
-00019b30: 7320 4153 4349 490a 2020 2020 7320 3d20  s ASCII.    s = 
-00019b40: 7265 2e73 7562 2872 2226 5c77 2b3f 3b22  re.sub(r"&\w+?;"
-00019b50: 2c20 2222 2c20 7329 2020 2320 7374 7269  , "", s)  # stri
-00019b60: 7020 6874 6d6c 2065 6e74 6974 6965 730a  p html entities.
-00019b70: 2020 2020 6966 206b 6565 705f 756e 6465      if keep_unde
-00019b80: 7273 636f 7265 733a 0a20 2020 2020 2020  rscores:.       
-00019b90: 2073 203d 2072 652e 7375 6228 7222 5c73   s = re.sub(r"\s
-00019ba0: 2b22 2c20 222d 222c 2073 2920 2023 2077  +", "-", s)  # w
-00019bb0: 6869 7465 7370 6163 6520 746f 2068 7970  hitespace to hyp
-00019bc0: 6865 6e73 0a20 2020 2020 2020 2073 203d  hens.        s =
-00019bd0: 2072 652e 7375 6228 7222 5b5e 5c77 5c2d   re.sub(r"[^\w\-
-00019be0: 5d22 2c20 2222 2c20 7329 0a20 2020 2020  ]", "", s).     
-00019bf0: 2020 2023 2073 7472 6970 2061 6c6c 2062     # strip all b
-00019c00: 7574 2061 6c70 6861 6e75 6d65 7269 632f  ut alphanumeric/
-00019c10: 756e 6465 7273 636f 7265 2f68 7970 6865  underscore/hyphe
-00019c20: 6e0a 2020 2020 656c 7365 3a0a 2020 2020  n.    else:.    
-00019c30: 2020 2020 7320 3d20 7265 2e73 7562 2872      s = re.sub(r
-00019c40: 225b 5c73 5f5d 2b22 2c20 222d 222c 2073  "[\s_]+", "-", s
-00019c50: 2920 2023 2077 6869 7465 7370 6163 6520  )  # whitespace 
-00019c60: 2620 756e 6465 7273 636f 7265 7320 746f  & underscores to
-00019c70: 2068 7970 6865 6e73 0a20 2020 2020 2020   hyphens.       
-00019c80: 2073 203d 2072 652e 7375 6228 7222 5b5e   s = re.sub(r"[^
-00019c90: 612d 7a30 2d39 5c2d 5d22 2c20 2222 2c20  a-z0-9\-]", "", 
-00019ca0: 7329 2020 2320 7374 7269 7020 616c 6c20  s)  # strip all 
-00019cb0: 6275 7420 616c 7068 616e 756d 6572 6963  but alphanumeric
-00019cc0: 2f68 7970 6865 6e0a 2020 2020 7320 3d20  /hyphen.    s = 
-00019cd0: 7265 2e73 7562 2872 225b 2d5f 5d5b 2d5f  re.sub(r"[-_][-_
-00019ce0: 5d2b 222c 2022 2d22 2c20 7329 2020 2320  ]+", "-", s)  # 
-00019cf0: 636f 6c6c 6170 7365 2073 7472 696e 6773  collapse strings
-00019d00: 206f 6620 6879 7068 656e 730a 2020 2020   of hyphens.    
-00019d10: 7320 3d20 732e 7374 7269 7028 222d 2229  s = s.strip("-")
-00019d20: 2020 2320 7265 6d6f 7665 206c 6561 6469    # remove leadi
-00019d30: 6e67 2061 6e64 2074 7261 696c 696e 6720  ng and trailing 
-00019d40: 6879 7068 656e 730a 2020 2020 7265 7475  hyphens.    retu
-00019d50: 726e 2073 5b3a 6d61 786c 656e 5d20 2023  rn s[:maxlen]  #
-00019d60: 2065 6e66 6f72 6365 206d 6178 696d 756d   enforce maximum
-00019d70: 206c 656e 6774 680a 0a0a 636c 6173 7320   length...class 
-00019d80: 4953 5f53 4c55 4728 5661 6c69 6461 746f  IS_SLUG(Validato
-00019d90: 7229 3a0a 2020 2020 2222 220a 2020 2020  r):.    """.    
-00019da0: 636f 6e76 6572 7473 2061 7262 6974 7261  converts arbitra
-00019db0: 7279 2074 6578 7420 7374 7269 6e67 2074  ry text string t
-00019dc0: 6f20 6120 736c 7567 3a3a 0a0a 2020 2020  o a slug::..    
-00019dd0: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
-00019de0: 2928 2761 6263 3132 3327 290a 2020 2020  )('abc123').    
-00019df0: 2020 2020 2827 6162 6331 3233 272c 204e      ('abc123', N
-00019e00: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-00019e10: 2049 535f 534c 5547 2829 2827 4142 4331   IS_SLUG()('ABC1
-00019e20: 3233 2729 0a20 2020 2020 2020 2028 2761  23').        ('a
-00019e30: 6263 3132 3327 2c20 4e6f 6e65 290a 2020  bc123', None).  
-00019e40: 2020 2020 2020 3e3e 3e20 4953 5f53 4c55        >>> IS_SLU
-00019e50: 4728 2928 2761 6263 2d31 3233 2729 0a20  G()('abc-123'). 
-00019e60: 2020 2020 2020 2028 2761 6263 2d31 3233         ('abc-123
-00019e70: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00019e80: 203e 3e3e 2049 535f 534c 5547 2829 2827   >>> IS_SLUG()('
-00019e90: 6162 632d 2d31 3233 2729 0a20 2020 2020  abc--123').     
-00019ea0: 2020 2028 2761 6263 2d31 3233 272c 204e     ('abc-123', N
-00019eb0: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-00019ec0: 2049 535f 534c 5547 2829 2827 6162 6320   IS_SLUG()('abc 
-00019ed0: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
-00019ee0: 6162 632d 3132 3327 2c20 4e6f 6e65 290a  abc-123', None).
-00019ef0: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-00019f00: 4c55 4728 2928 2761 6263 5c74 5f31 3233  LUG()('abc\t_123
-00019f10: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
-00019f20: 2d31 3233 272c 204e 6f6e 6529 0a20 2020  -123', None).   
-00019f30: 2020 2020 203e 3e3e 2049 535f 534c 5547       >>> IS_SLUG
-00019f40: 2829 2827 2d61 6263 2d27 290a 2020 2020  ()('-abc-').    
-00019f50: 2020 2020 2827 6162 6327 2c20 4e6f 6e65      ('abc', None
-00019f60: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-00019f70: 5f53 4c55 4728 2928 272d 2d61 2d2d 622d  _SLUG()('--a--b-
-00019f80: 2d5f 202d 632d 2d27 290a 2020 2020 2020  -_ -c--').      
-00019f90: 2020 2827 612d 622d 6327 2c20 4e6f 6e65    ('a-b-c', None
-00019fa0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-00019fb0: 5f53 4c55 4728 2928 2761 6263 2661 6d70  _SLUG()('abc&amp
-00019fc0: 3b31 3233 2729 0a20 2020 2020 2020 2028  ;123').        (
-00019fd0: 2761 6263 3132 3327 2c20 4e6f 6e65 290a  'abc123', None).
-00019fe0: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-00019ff0: 4c55 4728 2928 2761 6263 2661 6d70 3b31  LUG()('abc&amp;1
-0001a000: 3233 2661 6d70 3b64 6566 2729 0a20 2020  23&amp;def').   
-0001a010: 2020 2020 2028 2761 6263 3132 3364 6566       ('abc123def
-0001a020: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-0001a030: 203e 3e3e 2049 535f 534c 5547 2829 2827   >>> IS_SLUG()('
-0001a040: c3b1 2729 0a20 2020 2020 2020 2028 276e  ..').        ('n
-0001a050: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-0001a060: 203e 3e3e 2049 535f 534c 5547 286d 6178   >>> IS_SLUG(max
-0001a070: 6c65 6e3d 3429 2827 6162 6331 3233 2729  len=4)('abc123')
-0001a080: 0a20 2020 2020 2020 2028 2761 6263 3127  .        ('abc1'
-0001a090: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-0001a0a0: 3e3e 3e20 4953 5f53 4c55 4728 2928 2761  >>> IS_SLUG()('a
-0001a0b0: 6263 5f31 3233 2729 0a20 2020 2020 2020  bc_123').       
-0001a0c0: 2028 2761 6263 2d31 3233 272c 204e 6f6e   ('abc-123', Non
-0001a0d0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-0001a0e0: 535f 534c 5547 286b 6565 705f 756e 6465  S_SLUG(keep_unde
-0001a0f0: 7273 636f 7265 733d 4661 6c73 6529 2827  rscores=False)('
-0001a100: 6162 635f 3132 3327 290a 2020 2020 2020  abc_123').      
-0001a110: 2020 2827 6162 632d 3132 3327 2c20 4e6f    ('abc-123', No
-0001a120: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-0001a130: 4953 5f53 4c55 4728 6b65 6570 5f75 6e64  IS_SLUG(keep_und
-0001a140: 6572 7363 6f72 6573 3d54 7275 6529 2827  erscores=True)('
-0001a150: 6162 635f 3132 3327 290a 2020 2020 2020  abc_123').      
-0001a160: 2020 2827 6162 635f 3132 3327 2c20 4e6f    ('abc_123', No
-0001a170: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-0001a180: 4953 5f53 4c55 4728 6368 6563 6b3d 4661  IS_SLUG(check=Fa
-0001a190: 6c73 6529 2827 6162 6327 290a 2020 2020  lse)('abc').    
-0001a1a0: 2020 2020 2827 6162 6327 2c20 4e6f 6e65      ('abc', None
-0001a1b0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-0001a1c0: 5f53 4c55 4728 6368 6563 6b3d 5472 7565  _SLUG(check=True
-0001a1d0: 2928 2761 6263 2729 0a20 2020 2020 2020  )('abc').       
-0001a1e0: 2028 2761 6263 272c 204e 6f6e 6529 0a20   ('abc', None). 
-0001a1f0: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
-0001a200: 5547 2863 6865 636b 3d46 616c 7365 2928  UG(check=False)(
-0001a210: 2761 2062 6327 290a 2020 2020 2020 2020  'a bc').        
-0001a220: 2827 612d 6263 272c 204e 6f6e 6529 0a20  ('a-bc', None). 
-0001a230: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
-0001a240: 5547 2863 6865 636b 3d54 7275 6529 2827  UG(check=True)('
-0001a250: 6120 6263 2729 0a20 2020 2020 2020 2028  a bc').        (
-0001a260: 2761 2062 6327 2c20 276d 7573 7420 6265  'a bc', 'must be
-0001a270: 2073 6c75 6727 290a 2020 2020 2222 220a   slug').    """.
-0001a280: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0001a290: 6f64 0a20 2020 2064 6566 2075 726c 6966  od.    def urlif
-0001a2a0: 7928 7661 6c75 652c 206d 6178 6c65 6e3d  y(value, maxlen=
-0001a2b0: 3830 2c20 6b65 6570 5f75 6e64 6572 7363  80, keep_undersc
-0001a2c0: 6f72 6573 3d46 616c 7365 293a 0a20 2020  ores=False):.   
-0001a2d0: 2020 2020 2072 6574 7572 6e20 7572 6c69       return urli
-0001a2e0: 6679 2876 616c 7565 2c20 6d61 786c 656e  fy(value, maxlen
-0001a2f0: 2c20 6b65 6570 5f75 6e64 6572 7363 6f72  , keep_underscor
-0001a300: 6573 290a 0a20 2020 2064 6566 205f 5f69  es)..    def __i
-0001a310: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
-0001a320: 656c 662c 0a20 2020 2020 2020 206d 6178  elf,.        max
-0001a330: 6c65 6e3d 3830 2c0a 2020 2020 2020 2020  len=80,.        
-0001a340: 6368 6563 6b3d 4661 6c73 652c 0a20 2020  check=False,.   
-0001a350: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0001a360: 6765 3d22 4d75 7374 2062 6520 736c 7567  ge="Must be slug
-0001a370: 222c 0a20 2020 2020 2020 206b 6565 705f  ",.        keep_
-0001a380: 756e 6465 7273 636f 7265 733d 4661 6c73  underscores=Fals
-0001a390: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0001a3a0: 2020 7365 6c66 2e6d 6178 6c65 6e20 3d20    self.maxlen = 
-0001a3b0: 6d61 786c 656e 0a20 2020 2020 2020 2073  maxlen.        s
-0001a3c0: 656c 662e 6368 6563 6b20 3d20 6368 6563  elf.check = chec
-0001a3d0: 6b0a 2020 2020 2020 2020 7365 6c66 2e65  k.        self.e
-0001a3e0: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
-0001a3f0: 7272 6f72 5f6d 6573 7361 6765 0a20 2020  rror_message.   
-0001a400: 2020 2020 2073 656c 662e 6b65 6570 5f75       self.keep_u
-0001a410: 6e64 6572 7363 6f72 6573 203d 206b 6565  nderscores = kee
-0001a420: 705f 756e 6465 7273 636f 7265 730a 0a20  p_underscores.. 
-0001a430: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-0001a440: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-0001a450: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-0001a460: 2020 2020 2020 6966 2073 656c 662e 6368        if self.ch
-0001a470: 6563 6b20 616e 6420 7661 6c75 6520 213d  eck and value !=
-0001a480: 2075 726c 6966 7928 7661 6c75 652c 2073   urlify(value, s
-0001a490: 656c 662e 6d61 786c 656e 2c20 7365 6c66  elf.maxlen, self
-0001a4a0: 2e6b 6565 705f 756e 6465 7273 636f 7265  .keep_underscore
-0001a4b0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0001a4c0: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
-0001a4d0: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
-0001a4e0: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
-0001a4f0: 5f6d 6573 7361 6765 2929 0a20 2020 2020  _message)).     
-0001a500: 2020 2072 6574 7572 6e20 7572 6c69 6679     return urlify
-0001a510: 2876 616c 7565 2c20 7365 6c66 2e6d 6178  (value, self.max
-0001a520: 6c65 6e2c 2073 656c 662e 6b65 6570 5f75  len, self.keep_u
-0001a530: 6e64 6572 7363 6f72 6573 290a 0a0a 636c  nderscores)...cl
-0001a540: 6173 7320 414e 595f 4f46 2856 616c 6964  ass ANY_OF(Valid
-0001a550: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
-0001a560: 2020 2054 6573 7473 2069 6620 616e 7920     Tests if any 
-0001a570: 6f66 2074 6865 2076 616c 6964 6174 6f72  of the validator
-0001a580: 7320 696e 2061 206c 6973 7420 7265 7475  s in a list retu
-0001a590: 726e 7320 7375 6363 6573 7366 756c 6c79  rns successfully
-0001a5a0: 3a3a 0a0a 2020 2020 2020 2020 3e3e 3e20  ::..        >>> 
-0001a5b0: 414e 595f 4f46 285b 4953 5f45 4d41 494c  ANY_OF([IS_EMAIL
-0001a5c0: 2829 2c49 535f 414c 5048 414e 554d 4552  (),IS_ALPHANUMER
-0001a5d0: 4943 2829 5d29 2827 6140 622e 636f 2729  IC()])('a@b.co')
-0001a5e0: 0a20 2020 2020 2020 2028 2761 4062 2e63  .        ('a@b.c
-0001a5f0: 6f27 2c20 4e6f 6e65 290a 2020 2020 2020  o', None).      
-0001a600: 2020 3e3e 3e20 414e 595f 4f46 285b 4953    >>> ANY_OF([IS
-0001a610: 5f45 4d41 494c 2829 2c49 535f 414c 5048  _EMAIL(),IS_ALPH
-0001a620: 414e 554d 4552 4943 2829 5d29 2827 6162  ANUMERIC()])('ab
-0001a630: 636f 2729 0a20 2020 2020 2020 2028 2761  co').        ('a
-0001a640: 6263 6f27 2c20 4e6f 6e65 290a 2020 2020  bco', None).    
-0001a650: 2020 2020 3e3e 3e20 414e 595f 4f46 285b      >>> ANY_OF([
-0001a660: 4953 5f45 4d41 494c 2829 2c49 535f 414c  IS_EMAIL(),IS_AL
-0001a670: 5048 414e 554d 4552 4943 2829 5d29 2827  PHANUMERIC()])('
-0001a680: 4061 622e 636f 2729 0a20 2020 2020 2020  @ab.co').       
-0001a690: 2028 2740 6162 2e63 6f27 2c20 2765 6e74   ('@ab.co', 'ent
-0001a6a0: 6572 206f 6e6c 7920 6c65 7474 6572 732c  er only letters,
-0001a6b0: 206e 756d 6265 7273 2c20 616e 6420 756e   numbers, and un
-0001a6c0: 6465 7273 636f 7265 2729 0a20 2020 2020  derscore').     
-0001a6d0: 2020 203e 3e3e 2041 4e59 5f4f 4628 5b49     >>> ANY_OF([I
-0001a6e0: 535f 414c 5048 414e 554d 4552 4943 2829  S_ALPHANUMERIC()
-0001a6f0: 2c49 535f 454d 4149 4c28 295d 2928 2740  ,IS_EMAIL()])('@
-0001a700: 6162 2e63 6f27 290a 2020 2020 2020 2020  ab.co').        
-0001a710: 2827 4061 622e 636f 272c 2027 656e 7465  ('@ab.co', 'ente
-0001a720: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
-0001a730: 6164 6472 6573 7327 290a 0a20 2020 2022  address')..    "
-0001a740: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-0001a750: 6974 5f5f 2873 656c 662c 2073 7562 732c  it__(self, subs,
-0001a760: 2065 7272 6f72 5f6d 6573 7361 6765 3d4e   error_message=N
-0001a770: 6f6e 6529 3a0a 2020 2020 2020 2020 7365  one):.        se
-0001a780: 6c66 2e73 7562 7320 3d20 7375 6273 0a20  lf.subs = subs. 
-0001a790: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
-0001a7a0: 725f 6d65 7373 6167 6520 3d20 6572 726f  r_message = erro
-0001a7b0: 725f 6d65 7373 6167 650a 0a20 2020 2064  r_message..    d
-0001a7c0: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
-0001a7d0: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
-0001a7e0: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
-0001a7f0: 2020 666f 7220 7661 6c69 6461 746f 7220    for validator 
-0001a800: 696e 2073 656c 662e 7375 6273 3a0a 2020  in self.subs:.  
-0001a810: 2020 2020 2020 2020 2020 762c 2065 203d            v, e =
-0001a820: 2076 616c 6964 6174 6f72 2876 616c 7565   validator(value
-0001a830: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0001a840: 206e 6f74 2065 3a0a 2020 2020 2020 2020   not e:.        
-0001a850: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0001a860: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0001a870: 616c 6964 6174 696f 6e45 7272 6f72 2865  alidationError(e
-0001a880: 290a 0a20 2020 2064 6566 2066 6f72 6d61  )..    def forma
-0001a890: 7474 6572 2873 656c 662c 2076 616c 7565  tter(self, value
-0001a8a0: 293a 0a20 2020 2020 2020 2023 2055 7365  ):.        # Use
-0001a8b0: 2074 6865 2066 6f72 6d61 7474 6572 206f   the formatter o
-0001a8c0: 6620 7468 6520 6669 7273 7420 7375 6276  f the first subv
-0001a8d0: 616c 6964 6174 6f72 0a20 2020 2020 2020  alidator.       
-0001a8e0: 2023 2074 6861 7420 7661 6c69 6461 7465   # that validate
-0001a8f0: 7320 7468 6520 7661 6c75 6520 616e 6420  s the value and 
-0001a900: 6861 7320 6120 666f 726d 6174 7465 720a  has a formatter.
-0001a910: 2020 2020 2020 2020 666f 7220 7661 6c69          for vali
-0001a920: 6461 746f 7220 696e 2073 656c 662e 7375  dator in self.su
-0001a930: 6273 3a0a 2020 2020 2020 2020 2020 2020  bs:.            
-0001a940: 6966 2068 6173 6174 7472 2876 616c 6964  if hasattr(valid
-0001a950: 6174 6f72 2c20 2266 6f72 6d61 7474 6572  ator, "formatter
-0001a960: 2229 2061 6e64 2076 616c 6964 6174 6f72  ") and validator
-0001a970: 2876 616c 7565 295b 315d 2069 7320 4e6f  (value)[1] is No
-0001a980: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001a990: 2020 2020 7265 7475 726e 2076 616c 6964      return valid
-0001a9a0: 6174 6f72 2e66 6f72 6d61 7474 6572 2876  ator.formatter(v
-0001a9b0: 616c 7565 290a 0a0a 636c 6173 7320 4953  alue)...class IS
-0001a9c0: 5f45 4d50 5459 5f4f 5228 5661 6c69 6461  _EMPTY_OR(Valida
-0001a9d0: 746f 7229 3a0a 2020 2020 2222 220a 2020  tor):.    """.  
-0001a9e0: 2020 4475 6d6d 7920 636c 6173 7320 666f    Dummy class fo
-0001a9f0: 7220 7465 7374 696e 6720 4953 5f45 4d50  r testing IS_EMP
-0001aa00: 5459 5f4f 523a 3a0a 0a20 2020 2020 2020  TY_OR::..       
-0001aa10: 203e 3e3e 2049 535f 454d 5054 595f 4f52   >>> IS_EMPTY_OR
-0001aa20: 2849 535f 454d 4149 4c28 2929 2827 6162  (IS_EMAIL())('ab
-0001aa30: 6340 6465 662e 636f 6d27 290a 2020 2020  c@def.com').    
-0001aa40: 2020 2020 2827 6162 6340 6465 662e 636f      ('abc@def.co
-0001aa50: 6d27 2c20 4e6f 6e65 290a 2020 2020 2020  m', None).      
-0001aa60: 2020 3e3e 3e20 4953 5f45 4d50 5459 5f4f    >>> IS_EMPTY_O
-0001aa70: 5228 4953 5f45 4d41 494c 2829 2928 2720  R(IS_EMAIL())(' 
-0001aa80: 2020 2729 0a20 2020 2020 2020 2028 4e6f    ').        (No
-0001aa90: 6e65 2c20 4e6f 6e65 290a 2020 2020 2020  ne, None).      
-0001aaa0: 2020 3e3e 3e20 4953 5f45 4d50 5459 5f4f    >>> IS_EMPTY_O
-0001aab0: 5228 4953 5f45 4d41 494c 2829 2c20 6e75  R(IS_EMAIL(), nu
-0001aac0: 6c6c 3d27 6162 6327 2928 2720 2020 2729  ll='abc')('   ')
-0001aad0: 0a20 2020 2020 2020 2028 2761 6263 272c  .        ('abc',
-0001aae0: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
-0001aaf0: 3e3e 2049 535f 454d 5054 595f 4f52 2849  >> IS_EMPTY_OR(I
-0001ab00: 535f 454d 4149 4c28 292c 206e 756c 6c3d  S_EMAIL(), null=
-0001ab10: 2761 6263 272c 2065 6d70 7479 5f72 6567  'abc', empty_reg
-0001ab20: 6578 3d27 6465 6627 2928 2764 6566 2729  ex='def')('def')
-0001ab30: 0a20 2020 2020 2020 2028 2761 6263 272c  .        ('abc',
-0001ab40: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
-0001ab50: 3e3e 2049 535f 454d 5054 595f 4f52 2849  >> IS_EMPTY_OR(I
-0001ab60: 535f 454d 4149 4c28 2929 2827 6162 6327  S_EMAIL())('abc'
-0001ab70: 290a 2020 2020 2020 2020 2827 6162 6327  ).        ('abc'
-0001ab80: 2c20 2765 6e74 6572 2061 2076 616c 6964  , 'enter a valid
-0001ab90: 2065 6d61 696c 2061 6464 7265 7373 2729   email address')
-0001aba0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-0001abb0: 454d 5054 595f 4f52 2849 535f 454d 4149  EMPTY_OR(IS_EMAI
-0001abc0: 4c28 2929 2827 2061 6263 2027 290a 2020  L())(' abc ').  
-0001abd0: 2020 2020 2020 2827 6162 6327 2c20 2765        ('abc', 'e
-0001abe0: 6e74 6572 2061 2076 616c 6964 2065 6d61  nter a valid ema
-0001abf0: 696c 2061 6464 7265 7373 2729 0a20 2020  il address').   
-0001ac00: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-0001ac10: 696e 6974 5f5f 2873 656c 662c 206f 7468  init__(self, oth
-0001ac20: 6572 2c20 6e75 6c6c 3d4e 6f6e 652c 2065  er, null=None, e
-0001ac30: 6d70 7479 5f72 6567 6578 3d4e 6f6e 6529  mpty_regex=None)
-0001ac40: 3a0a 2020 2020 2020 2020 2873 656c 662e  :.        (self.
-0001ac50: 6f74 6865 722c 2073 656c 662e 6e75 6c6c  other, self.null
-0001ac60: 2920 3d20 286f 7468 6572 2c20 6e75 6c6c  ) = (other, null
-0001ac70: 290a 2020 2020 2020 2020 6966 2065 6d70  ).        if emp
-0001ac80: 7479 5f72 6567 6578 2069 7320 6e6f 7420  ty_regex is not 
-0001ac90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001aca0: 2020 7365 6c66 2e65 6d70 7479 5f72 6567    self.empty_reg
-0001acb0: 6578 203d 2072 652e 636f 6d70 696c 6528  ex = re.compile(
-0001acc0: 656d 7074 795f 7265 6765 7829 0a20 2020  empty_regex).   
-0001acd0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001ace0: 2020 2020 2020 2073 656c 662e 656d 7074         self.empt
-0001acf0: 795f 7265 6765 7820 3d20 4e6f 6e65 0a20  y_regex = None. 
-0001ad00: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-0001ad10: 7228 6f74 6865 722c 2022 6d75 6c74 6970  r(other, "multip
-0001ad20: 6c65 2229 3a0a 2020 2020 2020 2020 2020  le"):.          
-0001ad30: 2020 7365 6c66 2e6d 756c 7469 706c 6520    self.multiple 
-0001ad40: 3d20 6f74 6865 722e 6d75 6c74 6970 6c65  = other.multiple
-0001ad50: 0a20 2020 2020 2020 2069 6620 6861 7361  .        if hasa
-0001ad60: 7474 7228 6f74 6865 722c 2022 6f70 7469  ttr(other, "opti
-0001ad70: 6f6e 7322 293a 0a20 2020 2020 2020 2020  ons"):.         
-0001ad80: 2020 2073 656c 662e 6f70 7469 6f6e 7320     self.options 
-0001ad90: 3d20 7365 6c66 2e5f 6f70 7469 6f6e 730a  = self._options.
-0001ada0: 0a20 2020 2064 6566 205f 6f70 7469 6f6e  .    def _option
-0001adb0: 7328 7365 6c66 2c20 2a61 7267 732c 202a  s(self, *args, *
-0001adc0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-0001add0: 2020 6f70 7469 6f6e 7320 3d20 7365 6c66    options = self
-0001ade0: 2e6f 7468 6572 2e6f 7074 696f 6e73 282a  .other.options(*
-0001adf0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-0001ae00: 2020 2020 2020 2020 6966 2028 6e6f 7420          if (not 
-0001ae10: 6f70 7469 6f6e 7320 6f72 206f 7074 696f  options or optio
-0001ae20: 6e73 5b30 5d5b 305d 2021 3d20 2222 2920  ns[0][0] != "") 
-0001ae30: 616e 6420 6e6f 7420 7365 6c66 2e6d 756c  and not self.mul
-0001ae40: 7469 706c 653a 0a20 2020 2020 2020 2020  tiple:.         
-0001ae50: 2020 206f 7074 696f 6e73 2e69 6e73 6572     options.inser
-0001ae60: 7428 302c 2028 2222 2c20 2222 2929 0a20  t(0, ("", "")). 
-0001ae70: 2020 2020 2020 2072 6574 7572 6e20 6f70         return op
-0001ae80: 7469 6f6e 730a 0a20 2020 2064 6566 2073  tions..    def s
-0001ae90: 6574 5f73 656c 665f 6964 2873 656c 662c  et_self_id(self,
-0001aea0: 2069 6429 3a0a 2020 2020 2020 2020 6966   id):.        if
-0001aeb0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-0001aec0: 2e6f 7468 6572 2c20 286c 6973 742c 2074  .other, (list, t
-0001aed0: 7570 6c65 2929 3a0a 2020 2020 2020 2020  uple)):.        
-0001aee0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
-0001aef0: 7365 6c66 2e6f 7468 6572 3a0a 2020 2020  self.other:.    
-0001af00: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-0001af10: 6173 6174 7472 2869 7465 6d2c 2022 7365  asattr(item, "se
-0001af20: 745f 7365 6c66 5f69 6422 293a 0a20 2020  t_self_id"):.   
-0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af40: 2069 7465 6d2e 7365 745f 7365 6c66 5f69   item.set_self_i
-0001af50: 6428 6964 290a 2020 2020 2020 2020 656c  d(id).        el
-0001af60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001af70: 6966 2068 6173 6174 7472 2873 656c 662e  if hasattr(self.
-0001af80: 6f74 6865 722c 2022 7365 745f 7365 6c66  other, "set_self
-0001af90: 5f69 6422 293a 0a20 2020 2020 2020 2020  _id"):.         
-0001afa0: 2020 2020 2020 2073 656c 662e 6f74 6865         self.othe
-0001afb0: 722e 7365 745f 7365 6c66 5f69 6428 6964  r.set_self_id(id
-0001afc0: 290a 0a20 2020 2064 6566 2076 616c 6964  )..    def valid
-0001afd0: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
-0001afe0: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
-0001aff0: 3a0a 2020 2020 2020 2020 7661 6c75 652c  :.        value,
-0001b000: 2065 6d70 7479 203d 2069 735f 656d 7074   empty = is_empt
-0001b010: 7928 7661 6c75 652c 2065 6d70 7479 5f72  y(value, empty_r
-0001b020: 6567 6578 3d73 656c 662e 656d 7074 795f  egex=self.empty_
-0001b030: 7265 6765 7829 0a20 2020 2020 2020 2069  regex).        i
-0001b040: 6620 656d 7074 793a 0a20 2020 2020 2020  f empty:.       
-0001b050: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001b060: 2e6e 756c 6c0a 2020 2020 2020 2020 6966  .null.        if
-0001b070: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-0001b080: 2e6f 7468 6572 2c20 286c 6973 742c 2074  .other, (list, t
-0001b090: 7570 6c65 2929 3a0a 2020 2020 2020 2020  uple)):.        
-0001b0a0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
-0001b0b0: 7365 6c66 2e6f 7468 6572 3a0a 2020 2020  self.other:.    
-0001b0c0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0001b0d0: 6520 3d20 7661 6c69 6461 746f 725f 6361  e = validator_ca
-0001b0e0: 6c6c 6572 2869 7465 6d2c 2076 616c 7565  ller(item, value
-0001b0f0: 2c20 7265 636f 7264 5f69 6429 0a20 2020  , record_id).   
-0001b100: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001b110: 7661 6c75 650a 2020 2020 2020 2020 7265  value.        re
-0001b120: 7475 726e 2076 616c 6964 6174 6f72 5f63  turn validator_c
-0001b130: 616c 6c65 7228 7365 6c66 2e6f 7468 6572  aller(self.other
-0001b140: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
-0001b150: 6964 290a 0a20 2020 2064 6566 2066 6f72  id)..    def for
-0001b160: 6d61 7474 6572 2873 656c 662c 2076 616c  matter(self, val
-0001b170: 7565 293a 0a20 2020 2020 2020 2069 6620  ue):.        if 
-0001b180: 6861 7361 7474 7228 7365 6c66 2e6f 7468  hasattr(self.oth
-0001b190: 6572 2c20 2266 6f72 6d61 7474 6572 2229  er, "formatter")
-0001b1a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001b1b0: 7475 726e 2073 656c 662e 6f74 6865 722e  turn self.other.
-0001b1c0: 666f 726d 6174 7465 7228 7661 6c75 6529  formatter(value)
-0001b1d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001b1e0: 7661 6c75 650a 0a0a 4953 5f4e 554c 4c5f  value...IS_NULL_
-0001b1f0: 4f52 203d 2049 535f 454d 5054 595f 4f52  OR = IS_EMPTY_OR
-0001b200: 2020 2320 666f 7220 6261 636b 7761 7264    # for backward
-0001b210: 2063 6f6d 7061 7469 6269 6c69 7479 0a0a   compatibility..
-0001b220: 0a63 6c61 7373 2043 4c45 414e 5550 2856  .class CLEANUP(V
-0001b230: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
-0001b240: 2222 0a20 2020 2045 7861 6d70 6c65 733a  "".    Examples:
-0001b250: 0a20 2020 2020 2020 2055 7365 2061 733a  .        Use as:
-0001b260: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
-0001b270: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
-0001b280: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
-0001b290: 2072 6571 7569 7265 733d 434c 4541 4e55   requires=CLEANU
-0001b2a0: 5028 2929 0a0a 2020 2020 7265 6d6f 7665  P())..    remove
-0001b2b0: 7320 7370 6563 6961 6c20 6368 6172 6163  s special charac
-0001b2c0: 7465 7273 206f 6e20 7661 6c69 6461 7469  ters on validati
-0001b2d0: 6f6e 0a20 2020 2022 2222 0a0a 2020 2020  on.    """..    
-0001b2e0: 5245 4745 585f 434c 4541 4e55 5020 3d20  REGEX_CLEANUP = 
-0001b2f0: 225b 5e5c 7830 395c 7830 615c 7830 645c  "[^\x09\x0a\x0d\
-0001b300: 7832 302d 5c78 3765 5d22 0a0a 2020 2020  x20-\x7e]"..    
-0001b310: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-0001b320: 662c 2072 6567 6578 3d4e 6f6e 6529 3a0a  f, regex=None):.
-0001b330: 2020 2020 2020 2020 7365 6c66 2e72 6567          self.reg
-0001b340: 6578 203d 2028 0a20 2020 2020 2020 2020  ex = (.         
-0001b350: 2020 2072 652e 636f 6d70 696c 6528 7365     re.compile(se
-0001b360: 6c66 2e52 4547 4558 5f43 4c45 414e 5550  lf.REGEX_CLEANUP
-0001b370: 2920 6966 2072 6567 6578 2069 7320 4e6f  ) if regex is No
-0001b380: 6e65 2065 6c73 6520 7265 2e63 6f6d 7069  ne else re.compi
-0001b390: 6c65 2872 6567 6578 290a 2020 2020 2020  le(regex).      
-0001b3a0: 2020 290a 0a20 2020 2064 6566 2076 616c    )..    def val
-0001b3b0: 6964 6174 6528 7365 6c66 2c20 7661 6c75  idate(self, valu
-0001b3c0: 652c 2072 6563 6f72 645f 6964 3d4e 6f6e  e, record_id=Non
-0001b3d0: 6529 3a0a 2020 2020 2020 2020 7620 3d20  e):.        v = 
-0001b3e0: 7365 6c66 2e72 6567 6578 2e73 7562 2822  self.regex.sub("
-0001b3f0: 222c 2073 7472 2876 616c 7565 292e 7374  ", str(value).st
-0001b400: 7269 7028 2929 0a20 2020 2020 2020 2072  rip()).        r
-0001b410: 6574 7572 6e20 760a 0a0a 6465 6620 7062  eturn v...def pb
-0001b420: 6b64 6632 5f68 6578 2864 6174 612c 2073  kdf2_hex(data, s
-0001b430: 616c 742c 2069 7465 7261 7469 6f6e 733d  alt, iterations=
-0001b440: 3130 3030 2c20 6b65 796c 656e 3d32 342c  1000, keylen=24,
-0001b450: 2068 6173 6866 756e 633d 4e6f 6e65 293a   hashfunc=None):
-0001b460: 0a20 2020 2068 6173 6866 756e 6320 3d20  .    hashfunc = 
-0001b470: 6861 7368 6675 6e63 206f 7220 6861 7368  hashfunc or hash
-0001b480: 6c69 622e 7368 6131 0a20 2020 2068 6d61  lib.sha1.    hma
-0001b490: 6320 3d20 6861 7368 6c69 622e 7062 6b64  c = hashlib.pbkd
-0001b4a0: 6632 5f68 6d61 6328 0a20 2020 2020 2020  f2_hmac(.       
-0001b4b0: 2068 6173 6866 756e 6328 292e 6e61 6d65   hashfunc().name
-0001b4c0: 2c20 746f 5f62 7974 6573 2864 6174 6129  , to_bytes(data)
-0001b4d0: 2c20 746f 5f62 7974 6573 2873 616c 7429  , to_bytes(salt)
-0001b4e0: 2c20 6974 6572 6174 696f 6e73 2c20 6b65  , iterations, ke
-0001b4f0: 796c 656e 0a20 2020 2029 0a20 2020 2072  ylen.    ).    r
-0001b500: 6574 7572 6e20 6269 6e61 7363 6969 2e68  eturn binascii.h
-0001b510: 6578 6c69 6679 2868 6d61 6329 0a0a 0a64  exlify(hmac)...d
-0001b520: 6566 2073 696d 706c 655f 6861 7368 2874  ef simple_hash(t
-0001b530: 6578 742c 206b 6579 3d22 222c 2073 616c  ext, key="", sal
-0001b540: 743d 2222 2c20 6469 6765 7374 5f61 6c67  t="", digest_alg
-0001b550: 3d22 6d64 3522 293a 0a20 2020 2022 2222  ="md5"):.    """
-0001b560: 4765 6e65 7261 7465 2068 6173 6820 7769  Generate hash wi
-0001b570: 7468 2074 6865 2067 6976 656e 2074 6578  th the given tex
-0001b580: 7420 7573 696e 6720 7468 6520 7370 6563  t using the spec
-0001b590: 6966 6965 6420 6469 6765 7374 2061 6c67  ified digest alg
-0001b5a0: 6f72 6974 686d 2e22 2222 0a20 2020 2074  orithm.""".    t
-0001b5b0: 6578 7420 3d20 746f 5f62 7974 6573 2874  ext = to_bytes(t
-0001b5c0: 6578 7429 0a20 2020 206b 6579 203d 2074  ext).    key = t
-0001b5d0: 6f5f 6279 7465 7328 6b65 7929 0a20 2020  o_bytes(key).   
-0001b5e0: 2073 616c 7420 3d20 746f 5f62 7974 6573   salt = to_bytes
-0001b5f0: 2873 616c 7429 0a20 2020 2069 6620 6e6f  (salt).    if no
-0001b600: 7420 6469 6765 7374 5f61 6c67 3a0a 2020  t digest_alg:.  
-0001b610: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-0001b620: 696d 6545 7272 6f72 2822 7369 6d70 6c65  imeError("simple
-0001b630: 5f68 6173 6820 7769 7468 2064 6967 6573  _hash with diges
-0001b640: 745f 616c 673d 4e6f 6e65 2229 0a20 2020  t_alg=None").   
-0001b650: 2065 6c69 6620 6e6f 7420 6973 696e 7374   elif not isinst
-0001b660: 616e 6365 2864 6967 6573 745f 616c 672c  ance(digest_alg,
-0001b670: 2073 7472 293a 2020 2320 6d61 6e75 616c   str):  # manual
-0001b680: 2061 7070 726f 6163 680a 2020 2020 2020   approach.      
-0001b690: 2020 6820 3d20 6469 6765 7374 5f61 6c67    h = digest_alg
-0001b6a0: 2874 6578 7420 2b20 6b65 7920 2b20 7361  (text + key + sa
-0001b6b0: 6c74 290a 2020 2020 656c 6966 2064 6967  lt).    elif dig
-0001b6c0: 6573 745f 616c 672e 7374 6172 7473 7769  est_alg.startswi
-0001b6d0: 7468 2822 7062 6b64 6632 2229 3a20 2023  th("pbkdf2"):  #
-0001b6e0: 206c 6174 6573 7420 616e 6420 636f 6f6c   latest and cool
-0001b6f0: 6573 7421 0a20 2020 2020 2020 2069 7465  est!.        ite
-0001b700: 7261 7469 6f6e 732c 206b 6579 6c65 6e2c  rations, keylen,
-0001b710: 2061 6c67 203d 2064 6967 6573 745f 616c   alg = digest_al
-0001b720: 675b 373a 2d31 5d2e 7370 6c69 7428 222c  g[7:-1].split(",
-0001b730: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-0001b740: 6e20 746f 5f6e 6174 6976 6528 0a20 2020  n to_native(.   
-0001b750: 2020 2020 2020 2020 2070 626b 6466 325f           pbkdf2_
-0001b760: 6865 7828 7465 7874 2c20 7361 6c74 2c20  hex(text, salt, 
-0001b770: 696e 7428 6974 6572 6174 696f 6e73 292c  int(iterations),
-0001b780: 2069 6e74 286b 6579 6c65 6e29 2c20 6765   int(keylen), ge
-0001b790: 745f 6469 6765 7374 2861 6c67 2929 0a20  t_digest(alg)). 
-0001b7a0: 2020 2020 2020 2029 0a20 2020 2065 6c69         ).    eli
-0001b7b0: 6620 6b65 793a 2020 2320 7573 6520 686d  f key:  # use hm
-0001b7c0: 6163 0a20 2020 2020 2020 2064 6967 6573  ac.        diges
-0001b7d0: 745f 616c 6720 3d20 6765 745f 6469 6765  t_alg = get_dige
-0001b7e0: 7374 2864 6967 6573 745f 616c 6729 0a20  st(digest_alg). 
-0001b7f0: 2020 2020 2020 2068 203d 2068 6d61 632e         h = hmac.
-0001b800: 6e65 7728 6b65 7920 2b20 7361 6c74 2c20  new(key + salt, 
-0001b810: 7465 7874 2c20 6469 6765 7374 5f61 6c67  text, digest_alg
-0001b820: 290a 2020 2020 656c 7365 3a20 2023 2063  ).    else:  # c
-0001b830: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-0001b840: 6869 7264 2070 6172 7479 2073 7973 7465  hird party syste
-0001b850: 6d73 0a20 2020 2020 2020 2068 203d 2067  ms.        h = g
-0001b860: 6574 5f64 6967 6573 7428 6469 6765 7374  et_digest(digest
-0001b870: 5f61 6c67 2928 290a 2020 2020 2020 2020  _alg)().        
-0001b880: 682e 7570 6461 7465 2874 6578 7420 2b20  h.update(text + 
-0001b890: 7361 6c74 290a 2020 2020 7265 7475 726e  salt).    return
-0001b8a0: 2068 2e68 6578 6469 6765 7374 2829 0a0a   h.hexdigest()..
-0001b8b0: 0a64 6566 2067 6574 5f64 6967 6573 7428  .def get_digest(
-0001b8c0: 7661 6c75 6529 3a0a 2020 2020 2222 2252  value):.    """R
-0001b8d0: 6574 7572 6e20 6120 6861 7368 6c69 6220  eturn a hashlib 
-0001b8e0: 6469 6765 7374 2061 6c67 6f72 6974 686d  digest algorithm
-0001b8f0: 2066 726f 6d20 6120 7374 7269 6e67 2e22   from a string."
-0001b900: 2222 0a20 2020 2069 6620 6973 696e 7374  "".    if isinst
-0001b910: 616e 6365 2876 616c 7565 2c20 7374 7229  ance(value, str)
-0001b920: 3a0a 2020 2020 2020 2020 7661 6c75 6520  :.        value 
-0001b930: 3d20 7661 6c75 652e 6c6f 7765 7228 290a  = value.lower().
-0001b940: 2020 2020 2020 2020 6966 2076 616c 7565          if value
-0001b950: 206e 6f74 2069 6e20 2822 6d64 3522 2c20   not in ("md5", 
-0001b960: 2273 6861 3122 2c20 2273 6861 3232 3422  "sha1", "sha224"
-0001b970: 2c20 2273 6861 3235 3622 2c20 2273 6861  , "sha256", "sha
-0001b980: 3338 3422 2c20 2273 6861 3531 3222 293a  384", "sha512"):
-0001b990: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001b9a0: 7365 2056 616c 7565 4572 726f 7228 2249  se ValueError("I
-0001b9b0: 6e76 616c 6964 2064 6967 6573 7420 616c  nvalid digest al
-0001b9c0: 676f 7269 7468 6d3a 2025 7322 2025 2076  gorithm: %s" % v
-0001b9d0: 616c 7565 290a 2020 2020 2020 2020 7661  alue).        va
-0001b9e0: 6c75 6520 3d20 6765 7461 7474 7228 6861  lue = getattr(ha
-0001b9f0: 7368 6c69 622c 2076 616c 7565 290a 2020  shlib, value).  
-0001ba00: 2020 7265 7475 726e 2076 616c 7565 0a0a    return value..
-0001ba10: 0a44 4947 4553 545f 414c 475f 4259 5f53  .DIGEST_ALG_BY_S
-0001ba20: 495a 4520 3d20 7b0a 2020 2020 3132 3820  IZE = {.    128 
-0001ba30: 2f2f 2034 3a20 226d 6435 222c 0a20 2020  // 4: "md5",.   
-0001ba40: 2031 3630 202f 2f20 343a 2022 7368 6131   160 // 4: "sha1
-0001ba50: 222c 0a20 2020 2032 3234 202f 2f20 343a  ",.    224 // 4:
-0001ba60: 2022 7368 6132 3234 222c 0a20 2020 2032   "sha224",.    2
-0001ba70: 3536 202f 2f20 343a 2022 7368 6132 3536  56 // 4: "sha256
-0001ba80: 222c 0a20 2020 2033 3834 202f 2f20 343a  ",.    384 // 4:
-0001ba90: 2022 7368 6133 3834 222c 0a20 2020 2035   "sha384",.    5
-0001baa0: 3132 202f 2f20 343a 2022 7368 6135 3132  12 // 4: "sha512
-0001bab0: 222c 0a7d 0a0a 0a63 6c61 7373 204c 617a  ",.}...class Laz
-0001bac0: 7943 7279 7074 286f 626a 6563 7429 3a0a  yCrypt(object):.
-0001bad0: 2020 2020 2222 220a 2020 2020 5374 6f72      """.    Stor
-0001bae0: 6573 2061 206c 617a 7920 7061 7373 776f  es a lazy passwo
-0001baf0: 7264 2068 6173 680a 2020 2020 2222 220a  rd hash.    """.
-0001bb00: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-0001bb10: 5f28 7365 6c66 2c20 6372 7970 742c 2070  _(self, crypt, p
-0001bb20: 6173 7377 6f72 6429 3a0a 2020 2020 2020  assword):.      
-0001bb30: 2020 2222 220a 2020 2020 2020 2020 6372    """.        cr
-0001bb40: 7970 7420 6973 2061 6e20 696e 7374 616e  ypt is an instan
-0001bb50: 6365 206f 6620 7468 6520 4352 5950 5420  ce of the CRYPT 
-0001bb60: 7661 6c69 6461 746f 722c 0a20 2020 2020  validator,.     
-0001bb70: 2020 2070 6173 7377 6f72 6420 6973 2074     password is t
-0001bb80: 6865 2070 6173 7377 6f72 6420 6173 2069  he password as i
-0001bb90: 6e73 6572 7465 6420 6279 2074 6865 2075  nserted by the u
-0001bba0: 7365 720a 2020 2020 2020 2020 2222 220a  ser.        """.
-0001bbb0: 2020 2020 2020 2020 7365 6c66 2e63 7279          self.cry
-0001bbc0: 7074 203d 2063 7279 7074 0a20 2020 2020  pt = crypt.     
-0001bbd0: 2020 2073 656c 662e 7061 7373 776f 7264     self.password
-0001bbe0: 203d 2070 6173 7377 6f72 640a 2020 2020   = password.    
-0001bbf0: 2020 2020 7365 6c66 2e63 7279 7074 6564      self.crypted
-0001bc00: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
-0001bc10: 205f 5f73 7472 5f5f 2873 656c 6629 3a0a   __str__(self):.
-0001bc20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001bc30: 2020 2020 456e 6372 7970 7465 6420 7365      Encrypted se
-0001bc40: 6c66 2e70 6173 7377 6f72 6420 616e 6420  lf.password and 
-0001bc50: 6361 6368 6573 2069 7420 696e 2073 656c  caches it in sel
-0001bc60: 662e 6372 7970 7465 642e 0a20 2020 2020  f.crypted..     
-0001bc70: 2020 2049 6620 7365 6c66 2e63 7279 7074     If self.crypt
-0001bc80: 2e73 616c 7420 7468 6520 6f75 7470 7574  .salt the output
-0001bc90: 2069 7320 696e 2074 6865 2066 6f72 6d61   is in the forma
-0001bca0: 7420 3c61 6c67 6f72 6974 686d 3e24 3c73  t <algorithm>$<s
-0001bcb0: 616c 743e 243c 6861 7368 3e0a 0a20 2020  alt>$<hash>..   
-0001bcc0: 2020 2020 2054 7279 2067 6574 2074 6865       Try get the
-0001bcd0: 2064 6967 6573 745f 616c 6720 6672 6f6d   digest_alg from
-0001bce0: 2074 6865 206b 6579 2028 6966 2069 7420   the key (if it 
-0001bcf0: 6578 6973 7473 290a 2020 2020 2020 2020  exists).        
-0001bd00: 656c 7365 2061 7373 756d 6520 7468 6520  else assume the 
-0001bd10: 6465 6661 756c 7420 6469 6765 7374 5f61  default digest_a
-0001bd20: 6c67 2e20 4966 206e 6f74 206b 6579 2061  lg. If not key a
-0001bd30: 7420 616c 6c2c 2073 6574 206b 6579 3d27  t all, set key='
-0001bd40: 270a 0a20 2020 2020 2020 2049 6620 6120  '..        If a 
-0001bd50: 7361 6c74 2069 7320 7370 6563 6966 6965  salt is specifie
-0001bd60: 6420 7573 6520 6974 2c20 6966 2073 616c  d use it, if sal
-0001bd70: 7420 6973 2054 7275 652c 2073 6574 2073  t is True, set s
-0001bd80: 616c 7420 746f 2075 7569 640a 2020 2020  alt to uuid.    
-0001bd90: 2020 2020 2874 6869 7320 7368 6f75 6c64      (this should
-0001bda0: 2061 6c6c 2062 6520 6261 636b 7761 7264   all be backward
-0001bdb0: 2063 6f6d 7061 7469 626c 6529 0a0a 2020   compatible)..  
-0001bdc0: 2020 2020 2020 4f70 7469 6f6e 733a 0a20        Options:. 
-0001bdd0: 2020 2020 2020 206b 6579 203d 2027 7575         key = 'uu
-0001bde0: 6964 270a 2020 2020 2020 2020 6b65 7920  id'.        key 
-0001bdf0: 3d20 276d 6435 3a75 7569 6427 0a20 2020  = 'md5:uuid'.   
-0001be00: 2020 2020 206b 6579 203d 2027 7368 6135       key = 'sha5
-0001be10: 3132 3a75 7569 6427 0a20 2020 2020 2020  12:uuid'.       
-0001be20: 202e 2e2e 0a20 2020 2020 2020 206b 6579   ....        key
-0001be30: 203d 2027 7062 6b64 6632 2831 3030 302c   = 'pbkdf2(1000,
-0001be40: 3634 2c73 6861 3531 3229 3a75 7569 6427  64,sha512):uuid'
-0001be50: 2031 3030 3020 6974 6572 6174 696f 6e73   1000 iterations
-0001be60: 2061 6e64 2036 3420 6368 6172 7320 6c65   and 64 chars le
-0001be70: 6e67 7468 0a20 2020 2020 2020 2022 2222  ngth.        """
-0001be80: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001be90: 2e63 7279 7074 6564 3a0a 2020 2020 2020  .crypted:.      
-0001bea0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001beb0: 662e 6372 7970 7465 640a 2020 2020 2020  f.crypted.      
-0001bec0: 2020 6966 2073 656c 662e 6372 7970 742e    if self.crypt.
-0001bed0: 6b65 793a 0a20 2020 2020 2020 2020 2020  key:.           
-0001bee0: 2069 6620 223a 2220 696e 2073 656c 662e   if ":" in self.
-0001bef0: 6372 7970 742e 6b65 793a 0a20 2020 2020  crypt.key:.     
-0001bf00: 2020 2020 2020 2020 2020 2064 6967 6573             diges
-0001bf10: 745f 616c 672c 206b 6579 203d 2073 656c  t_alg, key = sel
-0001bf20: 662e 6372 7970 742e 6b65 792e 7370 6c69  f.crypt.key.spli
-0001bf30: 7428 223a 222c 2031 290a 2020 2020 2020  t(":", 1).      
-0001bf40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001bf50: 2020 2020 2020 2020 2020 2020 6469 6765              dige
-0001bf60: 7374 5f61 6c67 2c20 6b65 7920 3d20 7365  st_alg, key = se
-0001bf70: 6c66 2e63 7279 7074 2e64 6967 6573 745f  lf.crypt.digest_
-0001bf80: 616c 672c 2073 656c 662e 6372 7970 742e  alg, self.crypt.
-0001bf90: 6b65 790a 2020 2020 2020 2020 656c 7365  key.        else
-0001bfa0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0001bfb0: 6765 7374 5f61 6c67 2c20 6b65 7920 3d20  gest_alg, key = 
-0001bfc0: 7365 6c66 2e63 7279 7074 2e64 6967 6573  self.crypt.diges
-0001bfd0: 745f 616c 672c 2022 220a 2020 2020 2020  t_alg, "".      
-0001bfe0: 2020 6966 2073 656c 662e 6372 7970 742e    if self.crypt.
-0001bff0: 7361 6c74 3a0a 2020 2020 2020 2020 2020  salt:.          
-0001c000: 2020 6966 2073 656c 662e 6372 7970 742e    if self.crypt.
-0001c010: 7361 6c74 2069 7320 5472 7565 3a0a 2020  salt is True:.  
-0001c020: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0001c030: 6c74 203d 2073 7472 2875 7569 642e 7575  lt = str(uuid.uu
-0001c040: 6964 3428 2929 2e72 6570 6c61 6365 2822  id4()).replace("
-0001c050: 2d22 2c20 2222 295b 2d31 363a 5d0a 2020  -", "")[-16:].  
-0001c060: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c080: 7361 6c74 203d 2073 656c 662e 6372 7970  salt = self.cryp
-0001c090: 742e 7361 6c74 0a20 2020 2020 2020 2065  t.salt.        e
-0001c0a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c0b0: 2073 616c 7420 3d20 2222 0a20 2020 2020   salt = "".     
-0001c0c0: 2020 2068 6173 6865 6420 3d20 7369 6d70     hashed = simp
-0001c0d0: 6c65 5f68 6173 6828 7365 6c66 2e70 6173  le_hash(self.pas
-0001c0e0: 7377 6f72 642c 206b 6579 2c20 7361 6c74  sword, key, salt
-0001c0f0: 2c20 6469 6765 7374 5f61 6c67 290a 2020  , digest_alg).  
-0001c100: 2020 2020 2020 7365 6c66 2e63 7279 7074        self.crypt
-0001c110: 6564 203d 2022 2573 2425 7324 2573 2220  ed = "%s$%s$%s" 
-0001c120: 2520 2864 6967 6573 745f 616c 672c 2073  % (digest_alg, s
-0001c130: 616c 742c 2068 6173 6865 6429 0a20 2020  alt, hashed).   
-0001c140: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001c150: 2e63 7279 7074 6564 0a0a 2020 2020 6465  .crypted..    de
-0001c160: 6620 5f5f 6571 5f5f 2873 656c 662c 2073  f __eq__(self, s
-0001c170: 746f 7265 645f 7061 7373 776f 7264 293a  tored_password):
-0001c180: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001c190: 2020 2020 2063 6f6d 7061 7265 7320 7468       compares th
-0001c1a0: 6520 6375 7272 656e 7420 6c61 7a79 2063  e current lazy c
-0001c1b0: 7279 7074 6564 2070 6173 7377 6f72 6420  rypted password 
-0001c1c0: 7769 7468 2061 2073 746f 7265 6420 7061  with a stored pa
-0001c1d0: 7373 776f 7264 0a20 2020 2020 2020 2022  ssword.        "
-0001c1e0: 2222 0a0a 2020 2020 2020 2020 2320 4c61  ""..        # La
-0001c1f0: 7a79 4372 7970 7420 6f62 6a65 6374 7320  zyCrypt objects 
-0001c200: 636f 6d70 6172 6973 6f6e 0a20 2020 2020  comparison.     
-0001c210: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001c220: 2873 746f 7265 645f 7061 7373 776f 7264  (stored_password
-0001c230: 2c20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  , self.__class__
-0001c240: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0001c250: 6574 7572 6e20 2873 656c 6620 6973 2073  eturn (self is s
-0001c260: 746f 7265 645f 7061 7373 776f 7264 2920  tored_password) 
-0001c270: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
-0001c280: 2020 2020 2028 7365 6c66 2e63 7279 7074       (self.crypt
-0001c290: 2e6b 6579 203d 3d20 7374 6f72 6564 5f70  .key == stored_p
-0001c2a0: 6173 7377 6f72 642e 6372 7970 742e 6b65  assword.crypt.ke
-0001c2b0: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
-0001c2c0: 2020 2061 6e64 2028 7365 6c66 2e70 6173     and (self.pas
-0001c2d0: 7377 6f72 6420 3d3d 2073 746f 7265 645f  sword == stored_
-0001c2e0: 7061 7373 776f 7264 2e70 6173 7377 6f72  password.passwor
-0001c2f0: 6429 0a20 2020 2020 2020 2020 2020 2029  d).            )
-0001c300: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0001c310: 662e 6372 7970 742e 6b65 793a 0a20 2020  f.crypt.key:.   
-0001c320: 2020 2020 2020 2020 2069 6620 223a 2220           if ":" 
-0001c330: 696e 2073 656c 662e 6372 7970 742e 6b65  in self.crypt.ke
-0001c340: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0001c350: 2020 206b 6579 203d 2073 656c 662e 6372     key = self.cr
-0001c360: 7970 742e 6b65 792e 7370 6c69 7428 223a  ypt.key.split(":
-0001c370: 2229 5b31 5d0a 2020 2020 2020 2020 2020  ")[1].          
-0001c380: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001c390: 2020 2020 2020 2020 6b65 7920 3d20 7365          key = se
-0001c3a0: 6c66 2e63 7279 7074 2e6b 6579 0a20 2020  lf.crypt.key.   
-0001c3b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001c3c0: 2020 2020 2020 206b 6579 203d 2022 220a         key = "".
-0001c3d0: 2020 2020 2020 2020 6966 2073 746f 7265          if store
-0001c3e0: 645f 7061 7373 776f 7264 2069 7320 4e6f  d_password is No
-0001c3f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001c400: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
-0001c410: 2020 2020 2065 6c69 6620 7374 6f72 6564       elif stored
-0001c420: 5f70 6173 7377 6f72 642e 636f 756e 7428  _password.count(
-0001c430: 2224 2229 203d 3d20 323a 0a20 2020 2020  "$") == 2:.     
-0001c440: 2020 2020 2020 2028 6469 6765 7374 5f61         (digest_a
-0001c450: 6c67 2c20 7361 6c74 2c20 6861 7368 2920  lg, salt, hash) 
-0001c460: 3d20 7374 6f72 6564 5f70 6173 7377 6f72  = stored_passwor
-0001c470: 642e 7370 6c69 7428 2224 2229 0a20 2020  d.split("$").   
-0001c480: 2020 2020 2020 2020 2068 203d 2073 696d           h = sim
-0001c490: 706c 655f 6861 7368 2873 656c 662e 7061  ple_hash(self.pa
-0001c4a0: 7373 776f 7264 2c20 6b65 792c 2073 616c  ssword, key, sal
-0001c4b0: 742c 2064 6967 6573 745f 616c 6729 0a20  t, digest_alg). 
-0001c4c0: 2020 2020 2020 2020 2020 2074 656d 705f             temp_
-0001c4d0: 7061 7373 203d 2022 2573 2425 7324 2573  pass = "%s$%s$%s
-0001c4e0: 2220 2520 2864 6967 6573 745f 616c 672c  " % (digest_alg,
-0001c4f0: 2073 616c 742c 2068 290a 2020 2020 2020   salt, h).      
-0001c500: 2020 656c 7365 3a20 2023 206e 6f20 7361    else:  # no sa
-0001c510: 6c74 696e 670a 2020 2020 2020 2020 2020  lting.          
-0001c520: 2020 2320 6775 6573 7320 6469 6765 7374    # guess digest
-0001c530: 5f61 6c67 0a20 2020 2020 2020 2020 2020  _alg.           
-0001c540: 2064 6967 6573 745f 616c 6720 3d20 4449   digest_alg = DI
-0001c550: 4745 5354 5f41 4c47 5f42 595f 5349 5a45  GEST_ALG_BY_SIZE
-0001c560: 2e67 6574 286c 656e 2873 746f 7265 645f  .get(len(stored_
-0001c570: 7061 7373 776f 7264 292c 204e 6f6e 6529  password), None)
-0001c580: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001c590: 6e6f 7420 6469 6765 7374 5f61 6c67 3a0a  not digest_alg:.
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
-0001c5c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001c5d0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001c5e0: 656d 705f 7061 7373 203d 2073 696d 706c  emp_pass = simpl
-0001c5f0: 655f 6861 7368 2873 656c 662e 7061 7373  e_hash(self.pass
-0001c600: 776f 7264 2c20 6b65 792c 2022 222c 2064  word, key, "", d
-0001c610: 6967 6573 745f 616c 6729 0a20 2020 2020  igest_alg).     
-0001c620: 2020 2072 6574 7572 6e20 7465 6d70 5f70     return temp_p
-0001c630: 6173 7320 3d3d 2073 746f 7265 645f 7061  ass == stored_pa
-0001c640: 7373 776f 7264 0a0a 2020 2020 6465 6620  ssword..    def 
-0001c650: 5f5f 6e65 5f5f 2873 656c 662c 206f 7468  __ne__(self, oth
-0001c660: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-0001c670: 7572 6e20 6e6f 7420 7365 6c66 2e5f 5f65  urn not self.__e
-0001c680: 715f 5f28 6f74 6865 7229 0a0a 0a63 6c61  q__(other)...cla
-0001c690: 7373 2043 5259 5054 2856 616c 6964 6174  ss CRYPT(Validat
-0001c6a0: 6f72 293a 0a20 2020 2022 2222 0a20 2020  or):.    """.   
-0001c6b0: 2045 7861 6d70 6c65 733a 0a20 2020 2020   Examples:.     
-0001c6c0: 2020 2055 7365 2061 733a 3a0a 0a20 2020     Use as::..   
-0001c6d0: 2020 2020 2020 2020 2049 4e50 5554 285f           INPUT(_
-0001c6e0: 7479 7065 3d27 7465 7874 272c 205f 6e61  type='text', _na
-0001c6f0: 6d65 3d27 6e61 6d65 272c 2072 6571 7569  me='name', requi
-0001c700: 7265 733d 4352 5950 5428 2929 0a0a 2020  res=CRYPT())..  
-0001c710: 2020 656e 636f 6465 7320 7468 6520 7661    encodes the va
-0001c720: 6c75 6520 6f6e 2076 616c 6964 6174 696f  lue on validatio
-0001c730: 6e20 7769 7468 2061 2064 6967 6573 742e  n with a digest.
-0001c740: 0a0a 2020 2020 4966 206e 6f20 6172 6775  ..    If no argu
-0001c750: 6d65 6e74 7320 6172 6520 7072 6f76 6964  ments are provid
-0001c760: 6564 2043 5259 5054 2075 7365 7320 7468  ed CRYPT uses th
-0001c770: 6520 4d44 3520 616c 676f 7269 7468 6d2e  e MD5 algorithm.
-0001c780: 0a20 2020 2049 6620 7468 6520 6b65 7920  .    If the key 
-0001c790: 6172 6775 6d65 6e74 2069 7320 7072 6f76  argument is prov
-0001c7a0: 6964 6564 2074 6865 2048 4d41 432b 4d44  ided the HMAC+MD
-0001c7b0: 3520 616c 676f 7269 7468 6d20 6973 2075  5 algorithm is u
-0001c7c0: 7365 642e 0a20 2020 2049 6620 7468 6520  sed..    If the 
-0001c7d0: 6469 6765 7374 5f61 6c67 2069 7320 7370  digest_alg is sp
-0001c7e0: 6563 6966 6965 6420 7468 6973 2069 7320  ecified this is 
-0001c7f0: 7573 6564 2074 6f20 7265 706c 6163 6520  used to replace 
-0001c800: 7468 650a 2020 2020 4d44 3520 7769 7468  the.    MD5 with
-0001c810: 2c20 666f 7220 6578 616d 706c 652c 2053  , for example, S
-0001c820: 4841 3531 322e 2054 6865 2064 6967 6573  HA512. The diges
-0001c830: 745f 616c 6720 6361 6e20 6265 0a20 2020  t_alg can be.   
-0001c840: 2074 6865 206e 616d 6520 6f66 2061 2068   the name of a h
-0001c850: 6173 686c 6962 2061 6c67 6f72 6974 686d  ashlib algorithm
-0001c860: 2061 7320 6120 7374 7269 6e67 206f 7220   as a string or 
-0001c870: 7468 6520 616c 676f 7269 7468 6d20 6974  the algorithm it
-0001c880: 7365 6c66 2e0a 0a20 2020 206d 696e 5f6c  self...    min_l
-0001c890: 656e 6774 6820 6973 2074 6865 206d 696e  ength is the min
-0001c8a0: 696d 616c 2070 6173 7377 6f72 6420 6c65  imal password le
-0001c8b0: 6e67 7468 2028 6465 6661 756c 7420 3429  ngth (default 4)
-0001c8c0: 202d 2049 535f 5354 524f 4e47 2066 6f72   - IS_STRONG for
-0001c8d0: 2073 6572 696f 7573 2073 6563 7572 6974   serious securit
-0001c8e0: 790a 2020 2020 6572 726f 725f 6d65 7373  y.    error_mess
-0001c8f0: 6167 6520 6973 2074 6865 206d 6573 7361  age is the messa
-0001c900: 6765 2069 6620 7061 7373 776f 7264 2069  ge if password i
-0001c910: 7320 746f 6f20 7368 6f72 740a 0a20 2020  s too short..   
-0001c920: 204e 6f74 6963 6520 7468 6174 2061 6e20   Notice that an 
-0001c930: 656d 7074 7920 7061 7373 776f 7264 2069  empty password i
-0001c940: 7320 6163 6365 7074 6564 2062 7574 2069  s accepted but i
-0001c950: 6e76 616c 6964 2e20 4974 2077 696c 6c20  nvalid. It will 
-0001c960: 6e6f 7420 616c 6c6f 7720 6c6f 6769 6e20  not allow login 
-0001c970: 6261 636b 2e0a 2020 2020 5374 6f72 6573  back..    Stores
-0001c980: 206a 756e 6b20 6173 2068 6173 6865 6420   junk as hashed 
-0001c990: 7061 7373 776f 7264 2e0a 0a20 2020 2053  password...    S
-0001c9a0: 7065 6369 6679 2061 6e20 616c 676f 7269  pecify an algori
-0001c9b0: 7468 6d20 6f72 2062 7920 6465 6661 756c  thm or by defaul
-0001c9c0: 7420 7765 2077 696c 6c20 7573 6520 7368  t we will use sh
-0001c9d0: 6135 3132 2e0a 0a20 2020 2054 7970 6963  a512...    Typic
-0001c9e0: 616c 2061 7661 696c 6162 6c65 2061 6c67  al available alg
-0001c9f0: 6f72 6974 686d 733a 0a20 2020 2020 206d  orithms:.      m
-0001ca00: 6435 2c20 7368 6131 2c20 7368 6132 3234  d5, sha1, sha224
-0001ca10: 2c20 7368 6132 3536 2c20 7368 6133 3834  , sha256, sha384
-0001ca20: 2c20 7368 6135 3132 0a0a 2020 2020 4966  , sha512..    If
-0001ca30: 2073 616c 742c 2069 7420 6861 7368 6573   salt, it hashes
-0001ca40: 2061 2070 6173 7377 6f72 6420 7769 7468   a password with
-0001ca50: 2061 2073 616c 742e 0a20 2020 2049 6620   a salt..    If 
-0001ca60: 7361 6c74 2069 7320 5472 7565 2c20 7468  salt is True, th
-0001ca70: 6973 206d 6574 686f 6420 7769 6c6c 2061  is method will a
-0001ca80: 7574 6f6d 6174 6963 616c 6c79 2067 656e  utomatically gen
-0001ca90: 6572 6174 6520 6f6e 652e 0a20 2020 2045  erate one..    E
-0001caa0: 6974 6865 7220 6361 7365 2069 7420 7265  ither case it re
-0001cab0: 7475 726e 7320 616e 2065 6e63 7279 7074  turns an encrypt
-0001cac0: 6564 2070 6173 7377 6f72 6420 7374 7269  ed password stri
-0001cad0: 6e67 2069 6e20 7468 6520 666f 6c6c 6f77  ng in the follow
-0001cae0: 696e 6720 666f 726d 6174 3a0a 0a20 2020  ing format:..   
-0001caf0: 2020 203c 616c 676f 7269 7468 6d3e 243c     <algorithm>$<
-0001cb00: 7361 6c74 3e24 3c68 6173 683e 0a0a 2020  salt>$<hash>..  
-0001cb10: 2020 496d 706f 7274 616e 743a 2068 6173    Important: has
-0001cb20: 6865 6420 7061 7373 776f 7264 2069 7320  hed password is 
-0001cb30: 7265 7475 726e 6564 2061 7320 6120 4c61  returned as a La
-0001cb40: 7a79 4372 7970 7420 6f62 6a65 6374 2061  zyCrypt object a
-0001cb50: 6e64 2063 6f6d 7075 7465 6420 6f6e 6c79  nd computed only
-0001cb60: 2069 6620 6e65 6564 6564 2e0a 2020 2020   if needed..    
-0001cb70: 5468 6520 4c61 7379 4372 7970 7420 6f62  The LasyCrypt ob
-0001cb80: 6a65 6374 2061 6c73 6f20 6b6e 6f77 7320  ject also knows 
-0001cb90: 686f 7720 746f 2063 6f6d 7061 7265 2069  how to compare i
-0001cba0: 7473 656c 6620 7769 7468 2061 6e20 6578  tself with an ex
-0001cbb0: 6973 7469 6e67 2073 616c 7465 6420 7061  isting salted pa
-0001cbc0: 7373 776f 7264 0a0a 2020 2020 5375 7070  ssword..    Supp
-0001cbd0: 6f72 7473 2073 7461 6e64 6172 6420 616c  orts standard al
-0001cbe0: 676f 7269 7468 6d73 0a0a 2020 2020 2020  gorithms..      
-0001cbf0: 2020 3e3e 3e20 666f 7220 616c 6720 696e    >>> for alg in
-0001cc00: 2028 276d 6435 272c 2773 6861 3127 2c27   ('md5','sha1','
-0001cc10: 7368 6132 3536 272c 2773 6861 3338 3427  sha256','sha384'
-0001cc20: 2c27 7368 6135 3132 2729 3a0a 2020 2020  ,'sha512'):.    
-0001cc30: 2020 2020 2e2e 2e20 2020 2020 7072 696e      ...     prin
-0001cc40: 7428 7374 7228 4352 5950 5428 6469 6765  t(str(CRYPT(dige
-0001cc50: 7374 5f61 6c67 3d61 6c67 2c73 616c 743d  st_alg=alg,salt=
-0001cc60: 5472 7565 2928 2774 6573 7427 295b 305d  True)('test')[0]
-0001cc70: 2929 0a20 2020 2020 2020 206d 6435 242e  )).        md5$.
-0001cc80: 2e2e 242e 2e2e 0a20 2020 2020 2020 2073  ..$....        s
-0001cc90: 6861 3124 2e2e 2e24 2e2e 2e0a 2020 2020  ha1$...$....    
-0001cca0: 2020 2020 7368 6132 3536 242e 2e2e 242e      sha256$...$.
-0001ccb0: 2e2e 0a20 2020 2020 2020 2073 6861 3338  ...        sha38
-0001ccc0: 3424 2e2e 2e24 2e2e 2e0a 2020 2020 2020  4$...$....      
-0001ccd0: 2020 7368 6135 3132 242e 2e2e 242e 2e2e    sha512$...$...
-0001cce0: 0a0a 2020 2020 5468 6520 7379 6e74 6178  ..    The syntax
-0001ccf0: 2069 7320 616c 7761 7973 2061 6c67 2473   is always alg$s
-0001cd00: 616c 7424 6861 7368 0a0a 2020 2020 5375  alt$hash..    Su
-0001cd10: 7070 6f72 7473 2066 6f72 2070 626b 6466  pports for pbkdf
-0001cd20: 320a 0a20 2020 2020 2020 203e 3e3e 2061  2..        >>> a
-0001cd30: 6c67 203d 2027 7062 6b64 6632 2831 3030  lg = 'pbkdf2(100
-0001cd40: 302c 3230 2c73 6861 3531 3229 270a 2020  0,20,sha512)'.  
-0001cd50: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
-0001cd60: 7374 7228 4352 5950 5428 6469 6765 7374  str(CRYPT(digest
-0001cd70: 5f61 6c67 3d61 6c67 2c73 616c 743d 5472  _alg=alg,salt=Tr
-0001cd80: 7565 2928 2774 6573 7427 295b 305d 2929  ue)('test')[0]))
-0001cd90: 0a20 2020 2020 2020 2070 626b 6466 3228  .        pbkdf2(
-0001cda0: 3130 3030 2c32 302c 7368 6135 3132 2924  1000,20,sha512)$
-0001cdb0: 2e2e 2e24 2e2e 2e0a 0a20 2020 2041 6e20  ...$.....    An 
-0001cdc0: 6f70 7469 6f6e 616c 2068 6d61 635f 6b65  optional hmac_ke
-0001cdd0: 7920 6361 6e20 6265 2073 7065 6369 6669  y can be specifi
-0001cde0: 6564 2061 6e64 2069 7420 6973 2075 7365  ed and it is use
-0001cdf0: 6420 6173 2073 616c 7420 7072 6566 6978  d as salt prefix
-0001ce00: 0a0a 2020 2020 2020 2020 3e3e 3e20 6120  ..        >>> a 
-0001ce10: 3d20 7374 7228 4352 5950 5428 6469 6765  = str(CRYPT(dige
-0001ce20: 7374 5f61 6c67 3d27 6d64 3527 2c6b 6579  st_alg='md5',key
-0001ce30: 3d27 6d79 6b65 7927 2c73 616c 743d 5472  ='mykey',salt=Tr
-0001ce40: 7565 2928 2774 6573 7427 295b 305d 290a  ue)('test')[0]).
-0001ce50: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-0001ce60: 7428 6129 0a20 2020 2020 2020 206d 6435  t(a).        md5
-0001ce70: 242e 2e2e 242e 2e2e 0a0a 2020 2020 4576  $...$.....    Ev
-0001ce80: 656e 2069 6620 7468 6520 616c 676f 7269  en if the algori
-0001ce90: 7468 6d20 6368 616e 6765 7320 7468 6520  thm changes the 
-0001cea0: 6861 7368 2063 616e 2073 7469 6c6c 2062  hash can still b
-0001ceb0: 6520 7661 6c69 6461 7465 640a 0a20 2020  e validated..   
-0001cec0: 2020 2020 203e 3e3e 2043 5259 5054 2864       >>> CRYPT(d
-0001ced0: 6967 6573 745f 616c 673d 2773 6861 3127  igest_alg='sha1'
-0001cee0: 2c6b 6579 3d27 6d79 6b65 7927 2c73 616c  ,key='mykey',sal
-0001cef0: 743d 5472 7565 2928 2774 6573 7427 295b  t=True)('test')[
-0001cf00: 305d 203d 3d20 610a 2020 2020 2020 2020  0] == a.        
-0001cf10: 5472 7565 0a0a 2020 2020 4966 206e 6f20  True..    If no 
-0001cf20: 7361 6c74 2069 7320 7370 6563 6966 6965  salt is specifie
-0001cf30: 6420 4352 5950 5420 6361 6e20 6775 6573  d CRYPT can gues
-0001cf40: 7320 7468 6520 616c 676f 7269 7468 6d73  s the algorithms
-0001cf50: 2066 726f 6d20 6c65 6e67 7468 3a0a 0a20   from length:.. 
-0001cf60: 2020 2020 2020 203e 3e3e 2061 203d 2073         >>> a = s
-0001cf70: 7472 2843 5259 5054 2864 6967 6573 745f  tr(CRYPT(digest_
-0001cf80: 616c 673d 2773 6861 3127 2c73 616c 743d  alg='sha1',salt=
-0001cf90: 4661 6c73 6529 2827 7465 7374 2729 5b30  False)('test')[0
-0001cfa0: 5d29 0a20 2020 2020 2020 203e 3e3e 2061  ]).        >>> a
-0001cfb0: 0a20 2020 2020 2020 2027 7368 6131 2424  .        'sha1$$
-0001cfc0: 6139 3461 3866 6535 6363 6231 3962 6136  a94a8fe5ccb19ba6
-0001cfd0: 3163 3463 3038 3733 6433 3931 6539 3837  1c4c0873d391e987
-0001cfe0: 3938 3266 6262 6433 270a 2020 2020 2020  982fbbd3'.      
-0001cff0: 2020 3e3e 3e20 4352 5950 5428 6469 6765    >>> CRYPT(dige
-0001d000: 7374 5f61 6c67 3d27 7368 6131 272c 7361  st_alg='sha1',sa
-0001d010: 6c74 3d46 616c 7365 2928 2774 6573 7427  lt=False)('test'
-0001d020: 295b 305d 203d 3d20 610a 2020 2020 2020  )[0] == a.      
-0001d030: 2020 5472 7565 0a20 2020 2020 2020 203e    True.        >
-0001d040: 3e3e 2043 5259 5054 2864 6967 6573 745f  >> CRYPT(digest_
-0001d050: 616c 673d 2773 6861 3127 2c73 616c 743d  alg='sha1',salt=
-0001d060: 4661 6c73 6529 2827 7465 7374 2729 5b30  False)('test')[0
-0001d070: 5d20 3d3d 2061 5b36 3a5d 0a20 2020 2020  ] == a[6:].     
-0001d080: 2020 2054 7275 650a 2020 2020 2020 2020     True.        
-0001d090: 3e3e 3e20 4352 5950 5428 6469 6765 7374  >>> CRYPT(digest
-0001d0a0: 5f61 6c67 3d27 6d64 3527 2c73 616c 743d  _alg='md5',salt=
-0001d0b0: 4661 6c73 6529 2827 7465 7374 2729 5b30  False)('test')[0
-0001d0c0: 5d20 3d3d 2061 0a20 2020 2020 2020 2054  ] == a.        T
-0001d0d0: 7275 650a 2020 2020 2020 2020 3e3e 3e20  rue.        >>> 
-0001d0e0: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
-0001d0f0: 3d27 6d64 3527 2c73 616c 743d 4661 6c73  ='md5',salt=Fals
-0001d100: 6529 2827 7465 7374 2729 5b30 5d20 3d3d  e)('test')[0] ==
-0001d110: 2061 5b36 3a5d 0a20 2020 2020 2020 2054   a[6:].        T
-0001d120: 7275 650a 2020 2020 2222 220a 0a20 2020  rue.    """..   
-0001d130: 2053 5441 5253 203d 2022 2a2a 2a2a 2a2a   STARS = "******
-0001d140: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-0001d150: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-0001d160: 662c 0a20 2020 2020 2020 206b 6579 3d4e  f,.        key=N
-0001d170: 6f6e 652c 0a20 2020 2020 2020 2064 6967  one,.        dig
-0001d180: 6573 745f 616c 673d 2270 626b 6466 3228  est_alg="pbkdf2(
-0001d190: 3130 3030 2c32 302c 7368 6135 3132 2922  1000,20,sha512)"
-0001d1a0: 2c0a 2020 2020 2020 2020 6d69 6e5f 6c65  ,.        min_le
-0001d1b0: 6e67 7468 3d30 2c0a 2020 2020 2020 2020  ngth=0,.        
-0001d1c0: 6572 726f 725f 6d65 7373 6167 653d 2254  error_message="T
-0001d1d0: 6f6f 2073 686f 7274 222c 0a20 2020 2020  oo short",.     
-0001d1e0: 2020 2073 616c 743d 5472 7565 2c0a 2020     salt=True,.  
-0001d1f0: 2020 2020 2020 6d61 785f 6c65 6e67 7468        max_length
-0001d200: 3d31 3032 342c 0a20 2020 2029 3a0a 2020  =1024,.    ):.  
-0001d210: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d220: 2020 696d 706f 7274 616e 742c 2064 6967    important, dig
-0001d230: 6573 745f 616c 673d 276d 6435 2720 6973  est_alg='md5' is
-0001d240: 206e 6f74 2074 6865 2064 6566 6175 6c74   not the default
-0001d250: 2068 6173 6869 6e67 2061 6c67 6f72 6974   hashing algorit
-0001d260: 686d 2066 6f72 0a20 2020 2020 2020 2077  hm for.        w
-0001d270: 6562 3270 792e 2054 6869 7320 6973 206f  eb2py. This is o
-0001d280: 6e6c 7920 616e 2065 7861 6d70 6c65 206f  nly an example o
-0001d290: 6620 7573 6167 6520 6f66 2074 6869 7320  f usage of this 
-0001d2a0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
-0001d2b0: 2020 2054 6865 2061 6374 7561 6c20 6861     The actual ha
-0001d2c0: 7368 2061 6c67 6f72 6974 686d 2069 7320  sh algorithm is 
-0001d2d0: 6465 7465 726d 696e 6564 2066 726f 6d20  determined from 
-0001d2e0: 7468 6520 6b65 7920 7768 6963 6820 6973  the key which is
-0001d2f0: 0a20 2020 2020 2020 2067 656e 6572 6174  .        generat
-0001d300: 6564 2062 7920 7765 6232 7079 2069 6e20  ed by web2py in 
-0001d310: 746f 6f6c 732e 7079 2e20 5468 6973 2064  tools.py. This d
-0001d320: 6566 6175 6c74 7320 746f 2068 6d61 632b  efaults to hmac+
-0001d330: 7368 6135 3132 2e0a 2020 2020 2020 2020  sha512..        
-0001d340: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-0001d350: 2e6b 6579 203d 206b 6579 0a20 2020 2020  .key = key.     
-0001d360: 2020 2073 656c 662e 6469 6765 7374 5f61     self.digest_a
-0001d370: 6c67 203d 2064 6967 6573 745f 616c 670a  lg = digest_alg.
-0001d380: 2020 2020 2020 2020 7365 6c66 2e6d 696e          self.min
-0001d390: 5f6c 656e 6774 6820 3d20 6d69 6e5f 6c65  _length = min_le
-0001d3a0: 6e67 7468 0a20 2020 2020 2020 2073 656c  ngth.        sel
-0001d3b0: 662e 6d61 785f 6c65 6e67 7468 203d 206d  f.max_length = m
-0001d3c0: 6178 5f6c 656e 6774 680a 2020 2020 2020  ax_length.      
-0001d3d0: 2020 7365 6c66 2e65 7272 6f72 5f6d 6573    self.error_mes
-0001d3e0: 7361 6765 203d 2065 7272 6f72 5f6d 6573  sage = error_mes
-0001d3f0: 7361 6765 0a20 2020 2020 2020 2073 656c  sage.        sel
-0001d400: 662e 7361 6c74 203d 2073 616c 740a 0a20  f.salt = salt.. 
-0001d410: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
-0001d420: 7365 6c66 2c20 7661 6c75 652c 2072 6563  self, value, rec
-0001d430: 6f72 645f 6964 3d4e 6f6e 6529 3a0a 2020  ord_id=None):.  
-0001d440: 2020 2020 2020 6966 2076 616c 7565 203d        if value =
-0001d450: 3d20 7365 6c66 2e53 5441 5253 3a0a 2020  = self.STARS:.  
-0001d460: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001d470: 204e 6f6e 650a 2020 2020 2020 2020 7620   None.        v 
-0001d480: 3d20 7661 6c75 6520 616e 6420 7374 7228  = value and str(
-0001d490: 7661 6c75 6529 5b3a 2073 656c 662e 6d61  value)[: self.ma
-0001d4a0: 785f 6c65 6e67 7468 5d0a 2020 2020 2020  x_length].      
-0001d4b0: 2020 6966 206e 6f74 2076 206f 7220 6c65    if not v or le
-0001d4c0: 6e28 7629 203c 2073 656c 662e 6d69 6e5f  n(v) < self.min_
-0001d4d0: 6c65 6e67 7468 3a0a 2020 2020 2020 2020  length:.        
-0001d4e0: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
-0001d4f0: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
-0001d500: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
-0001d510: 7272 6f72 5f6d 6573 7361 6765 2929 0a20  rror_message)). 
-0001d520: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001d530: 616e 6365 2876 616c 7565 2c20 4c61 7a79  ance(value, Lazy
-0001d540: 4372 7970 7429 3a0a 2020 2020 2020 2020  Crypt):.        
-0001d550: 2020 2020 7265 7475 726e 2076 616c 7565      return value
-0001d560: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001d570: 4c61 7a79 4372 7970 7428 7365 6c66 2c20  LazyCrypt(self, 
-0001d580: 7661 6c75 6529 0a0a 2020 2020 6465 6620  value)..    def 
-0001d590: 666f 726d 6174 7465 7228 7365 6c66 2c20  formatter(self, 
-0001d5a0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-0001d5b0: 7265 7475 726e 2073 656c 662e 5354 4152  return self.STAR
-0001d5c0: 530a 0a0a 2320 2065 6e74 726f 7079 2063  S...#  entropy c
-0001d5d0: 616c 6375 6c61 746f 7220 666f 7220 4953  alculator for IS
-0001d5e0: 5f53 5452 4f4e 470a 230a 6c6f 7765 7273  _STRONG.#.lowers
-0001d5f0: 6574 203d 2066 726f 7a65 6e73 6574 2862  et = frozenset(b
-0001d600: 2261 6263 6465 6667 6869 6a6b 6c6d 6e6f  "abcdefghijklmno
-0001d610: 7071 7273 7475 7677 7879 7a22 290a 7570  pqrstuvwxyz").up
-0001d620: 7065 7273 6574 203d 2066 726f 7a65 6e73  perset = frozens
-0001d630: 6574 2862 2241 4243 4445 4647 4849 4a4b  et(b"ABCDEFGHIJK
-0001d640: 4c4d 4e4f 5051 5253 5455 5657 5859 5a22  LMNOPQRSTUVWXYZ"
-0001d650: 290a 6e75 6d62 6572 7365 7420 3d20 6672  ).numberset = fr
-0001d660: 6f7a 656e 7365 7428 6222 3031 3233 3435  ozenset(b"012345
-0001d670: 3637 3839 2229 0a73 796d 3173 6574 203d  6789").sym1set =
-0001d680: 2066 726f 7a65 6e73 6574 2862 2221 4023   frozenset(b"!@#
-0001d690: 2425 5e26 2a28 2920 2229 0a73 796d 3273  $%^&*() ").sym2s
-0001d6a0: 6574 203d 2066 726f 7a65 6e73 6574 2862  et = frozenset(b
-0001d6b0: 227e 602d 5f3d 2b5b 5d7b 7d5c 5c7c 3b3a  "~`-_=+[]{}\\|;:
-0001d6c0: 275c 222c 2e3c 3e3f 2f22 290a 6f74 6865  '\",.<>?/").othe
-0001d6d0: 7273 6574 203d 2066 726f 7a65 6e73 6574  rset = frozenset
-0001d6e0: 2862 2222 2e6a 6f69 6e28 6368 7228 7829  (b"".join(chr(x)
-0001d6f0: 2069 6620 5059 3220 656c 7365 2063 6872   if PY2 else chr
-0001d700: 2878 292e 656e 636f 6465 2829 2066 6f72  (x).encode() for
-0001d710: 2078 2069 6e20 7261 6e67 6528 3235 3629   x in range(256)
-0001d720: 2929 0a0a 0a64 6566 2063 616c 635f 656e  ))...def calc_en
-0001d730: 7472 6f70 7928 7374 7269 6e67 293a 0a20  tropy(string):. 
-0001d740: 2020 2022 2222 6361 6c63 756c 6174 6573     """calculates
-0001d750: 2061 2073 696d 706c 6520 656e 7472 6f70   a simple entrop
-0001d760: 7920 666f 7220 6120 6769 7665 6e20 7374  y for a given st
-0001d770: 7269 6e67 2222 220a 2020 2020 616c 7068  ring""".    alph
-0001d780: 6162 6574 203d 2030 2020 2320 616c 7068  abet = 0  # alph
-0001d790: 6162 6574 2073 697a 650a 2020 2020 6f74  abet size.    ot
-0001d7a0: 6865 7220 3d20 7365 7428 290a 2020 2020  her = set().    
-0001d7b0: 7365 656e 203d 2073 6574 2829 0a20 2020  seen = set().   
-0001d7c0: 206c 6173 7473 6574 203d 204e 6f6e 650a   lastset = None.
-0001d7d0: 2020 2020 7374 7269 6e67 203d 2074 6f5f      string = to_
-0001d7e0: 6279 7465 7328 7374 7269 6e67 206f 7220  bytes(string or 
-0001d7f0: 2222 290a 2020 2020 666f 7220 6320 696e  "").    for c in
-0001d800: 2073 7472 696e 673a 0a20 2020 2020 2020   string:.       
-0001d810: 2023 2063 6c61 7373 6966 7920 7468 6973   # classify this
-0001d820: 2063 6861 7261 6374 6572 0a20 2020 2020   character.     
-0001d830: 2020 2069 6e73 6574 203d 204e 6f6e 650a     inset = None.
-0001d840: 2020 2020 2020 2020 666f 7220 6373 6574          for cset
-0001d850: 2069 6e20 286c 6f77 6572 7365 742c 2075   in (lowerset, u
-0001d860: 7070 6572 7365 742c 206e 756d 6265 7273  pperset, numbers
-0001d870: 6574 2c20 7379 6d31 7365 742c 2073 796d  et, sym1set, sym
-0001d880: 3273 6574 2c20 6f74 6865 7273 6574 293a  2set, otherset):
-0001d890: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001d8a0: 6320 696e 2063 7365 743a 0a20 2020 2020  c in cset:.     
-0001d8b0: 2020 2020 2020 2020 2020 2069 6e73 6574             inset
-0001d8c0: 203d 2063 7365 740a 2020 2020 2020 2020   = cset.        
-0001d8d0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-0001d8e0: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
-0001d8f0: 6574 2069 7320 6e6f 7420 4e6f 6e65 0a20  et is not None. 
-0001d900: 2020 2020 2020 2023 2063 616c 6375 6c61         # calcula
-0001d910: 7465 2065 6666 6563 7420 6f66 2063 6861  te effect of cha
-0001d920: 7261 6374 6572 206f 6e20 616c 7068 6162  racter on alphab
-0001d930: 6574 2073 697a 650a 2020 2020 2020 2020  et size.        
-0001d940: 6966 2069 6e73 6574 206e 6f74 2069 6e20  if inset not in 
-0001d950: 7365 656e 3a0a 2020 2020 2020 2020 2020  seen:.          
-0001d960: 2020 7365 656e 2e61 6464 2869 6e73 6574    seen.add(inset
-0001d970: 290a 2020 2020 2020 2020 2020 2020 616c  ).            al
-0001d980: 7068 6162 6574 202b 3d20 6c65 6e28 696e  phabet += len(in
-0001d990: 7365 7429 2020 2320 6372 6564 6974 2066  set)  # credit f
-0001d9a0: 6f72 2061 206e 6577 2063 6861 7261 6374  or a new charact
-0001d9b0: 6572 2073 6574 0a20 2020 2020 2020 2065  er set.        e
-0001d9c0: 6c69 6620 6320 6e6f 7420 696e 206f 7468  lif c not in oth
-0001d9d0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-0001d9e0: 616c 7068 6162 6574 202b 3d20 3120 2023  alphabet += 1  #
-0001d9f0: 2063 7265 6469 7420 666f 7220 756e 6971   credit for uniq
-0001da00: 7565 2063 6861 7261 6374 6572 730a 2020  ue characters.  
-0001da10: 2020 2020 2020 2020 2020 6f74 6865 722e            other.
-0001da20: 6164 6428 6329 0a20 2020 2020 2020 2069  add(c).        i
-0001da30: 6620 696e 7365 7420 6973 206e 6f74 206c  f inset is not l
-0001da40: 6173 7473 6574 3a0a 2020 2020 2020 2020  astset:.        
-0001da50: 2020 2020 616c 7068 6162 6574 202b 3d20      alphabet += 
-0001da60: 3120 2023 2063 7265 6469 7420 666f 7220  1  # credit for 
-0001da70: 7365 7420 7472 616e 7369 7469 6f6e 730a  set transitions.
-0001da80: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-0001da90: 7365 7420 3d20 6373 6574 0a20 2020 2065  set = cset.    e
-0001daa0: 6e74 726f 7079 203d 206c 656e 2873 7472  ntropy = len(str
-0001dab0: 696e 6729 202a 206d 6174 682e 6c6f 6728  ing) * math.log(
-0001dac0: 616c 7068 6162 6574 206f 7220 3129 202f  alphabet or 1) /
-0001dad0: 2030 2e36 3933 3134 3731 3830 3535 3939   0.6931471805599
-0001dae0: 3435 3320 2023 206d 6174 682e 6c6f 6728  453  # math.log(
-0001daf0: 3229 0a20 2020 2072 6574 7572 6e20 726f  2).    return ro
-0001db00: 756e 6428 656e 7472 6f70 792c 2032 290a  und(entropy, 2).
-0001db10: 0a0a 636c 6173 7320 4953 5f53 5452 4f4e  ..class IS_STRON
-0001db20: 4728 5661 6c69 6461 746f 7229 3a0a 2020  G(Validator):.  
-0001db30: 2020 2222 220a 2020 2020 4578 616d 706c    """.    Exampl
-0001db40: 6573 3a0a 2020 2020 2020 2020 5573 6520  es:.        Use 
-0001db50: 6173 3a3a 0a0a 2020 2020 2020 2020 2020  as::..          
-0001db60: 2020 494e 5055 5428 5f74 7970 653d 2770    INPUT(_type='p
-0001db70: 6173 7377 6f72 6427 2c20 5f6e 616d 653d  assword', _name=
-0001db80: 2770 6173 7377 6427 2c0a 2020 2020 2020  'passwd',.      
-0001db90: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
-0001dba0: 535f 5354 524f 4e47 286d 696e 3d31 302c  S_STRONG(min=10,
-0001dbb0: 2073 7065 6369 616c 3d32 2c20 7570 7065   special=2, uppe
-0001dbc0: 723d 3229 290a 0a20 2020 2065 6e66 6f72  r=2))..    enfor
-0001dbd0: 6365 7320 636f 6d70 6c65 7869 7479 2072  ces complexity r
-0001dbe0: 6571 7569 7265 6d65 6e74 7320 6f6e 2061  equirements on a
-0001dbf0: 2066 6965 6c64 0a0a 2020 2020 2020 2020   field..        
-0001dc00: 3e3e 3e20 4953 5f53 5452 4f4e 4728 6573  >>> IS_STRONG(es
-0001dc10: 3d54 7275 6529 2827 4162 6364 3132 3334  =True)('Abcd1234
-0001dc20: 2729 0a20 2020 2020 2020 2028 2741 6263  ').        ('Abc
-0001dc30: 6431 3233 3427 2c0a 2020 2020 2020 2020  d1234',.        
-0001dc40: 2027 4d75 7374 2069 6e63 6c75 6465 2061   'Must include a
-0001dc50: 7420 6c65 6173 7420 3120 6f66 2074 6865  t least 1 of the
-0001dc60: 2066 6f6c 6c6f 7769 6e67 3a20 7e21 4023   following: ~!@#
-0001dc70: 2425 5e26 2a28 295f 2b2d 3d3f 3c3e 2c2e  $%^&*()_+-=?<>,.
-0001dc80: 3a3b 7b7d 5b5d 7c27 290a 2020 2020 2020  :;{}[]|').      
-0001dc90: 2020 3e3e 3e20 4953 5f53 5452 4f4e 4728    >>> IS_STRONG(
-0001dca0: 6573 3d54 7275 6529 2827 4162 6364 3132  es=True)('Abcd12
-0001dcb0: 3334 2127 290a 2020 2020 2020 2020 2827  34!').        ('
-0001dcc0: 4162 6364 3132 3334 2127 2c20 4e6f 6e65  Abcd1234!', None
-0001dcd0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-0001dce0: 5f53 5452 4f4e 4728 6573 3d54 7275 652c  _STRONG(es=True,
-0001dcf0: 2065 6e74 726f 7079 3d31 2928 2761 2729   entropy=1)('a')
-0001dd00: 0a20 2020 2020 2020 2028 2761 272c 204e  .        ('a', N
-0001dd10: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-0001dd20: 2049 535f 5354 524f 4e47 2865 733d 5472   IS_STRONG(es=Tr
-0001dd30: 7565 2c20 656e 7472 6f70 793d 312c 206d  ue, entropy=1, m
-0001dd40: 696e 3d32 2928 2761 2729 0a20 2020 2020  in=2)('a').     
-0001dd50: 2020 2028 2761 272c 2027 4d69 6e69 6d75     ('a', 'Minimu
-0001dd60: 6d20 6c65 6e67 7468 2069 7320 3227 290a  m length is 2').
-0001dd70: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
-0001dd80: 5452 4f4e 4728 6573 3d54 7275 652c 2065  TRONG(es=True, e
-0001dd90: 6e74 726f 7079 3d31 3030 2928 2761 6263  ntropy=100)('abc
-0001dda0: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
-0001ddb0: 6162 6331 3233 272c 2027 5061 7373 776f  abc123', 'Passwo
-0001ddc0: 7264 2074 6f6f 2073 696d 706c 6520 2833  rd too simple (3
-0001ddd0: 322e 3335 2f31 3030 2927 290a 2020 2020  2.35/100)').    
-0001dde0: 2020 2020 3e3e 3e20 4953 5f53 5452 4f4e      >>> IS_STRON
-0001ddf0: 4728 6573 3d54 7275 652c 2065 6e74 726f  G(es=True, entro
-0001de00: 7079 3d31 3030 2928 2761 6e64 2729 0a20  py=100)('and'). 
-0001de10: 2020 2020 2020 2028 2761 6e64 272c 2027         ('and', '
-0001de20: 5061 7373 776f 7264 2074 6f6f 2073 696d  Password too sim
-0001de30: 706c 6520 2831 342e 3537 2f31 3030 2927  ple (14.57/100)'
-0001de40: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-0001de50: 5f53 5452 4f4e 4728 6573 3d54 7275 652c  _STRONG(es=True,
-0001de60: 2065 6e74 726f 7079 3d31 3030 2928 2761   entropy=100)('a
-0001de70: 6161 2729 0a20 2020 2020 2020 2028 2761  aa').        ('a
-0001de80: 6161 272c 2027 5061 7373 776f 7264 2074  aa', 'Password t
-0001de90: 6f6f 2073 696d 706c 6520 2831 342e 3432  oo simple (14.42
-0001dea0: 2f31 3030 2927 290a 2020 2020 2020 2020  /100)').        
-0001deb0: 3e3e 3e20 4953 5f53 5452 4f4e 4728 6573  >>> IS_STRONG(es
-0001dec0: 3d54 7275 652c 2065 6e74 726f 7079 3d31  =True, entropy=1
-0001ded0: 3030 2928 2761 3164 2729 0a20 2020 2020  00)('a1d').     
-0001dee0: 2020 2028 2761 3164 272c 2027 5061 7373     ('a1d', 'Pass
-0001def0: 776f 7264 2074 6f6f 2073 696d 706c 6520  word too simple 
-0001df00: 2831 352e 3937 2f31 3030 2927 290a 2020  (15.97/100)').  
-0001df10: 2020 2020 2020 3e3e 3e20 4953 5f53 5452        >>> IS_STR
-0001df20: 4f4e 4728 6573 3d54 7275 652c 2065 6e74  ONG(es=True, ent
-0001df30: 726f 7079 3d31 3030 2928 2761 c3b1 6427  ropy=100)('a..d'
-0001df40: 290a 2020 2020 2020 2020 2827 615c 5c78  ).        ('a\\x
-0001df50: 6333 5c5c 7862 3164 272c 2027 5061 7373  c3\\xb1d', 'Pass
-0001df60: 776f 7264 2074 6f6f 2073 696d 706c 6520  word too simple 
-0001df70: 2833 312e 3236 2f31 3029 2729 0a0a 2020  (31.26/10)')..  
-0001df80: 2020 2222 220a 0a20 2020 2064 6566 205f    """..    def _
-0001df90: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-0001dfa0: 2073 656c 662c 0a20 2020 2020 2020 206d   self,.        m
-0001dfb0: 696e 3d4e 6f6e 652c 0a20 2020 2020 2020  in=None,.       
-0001dfc0: 206d 6178 3d4e 6f6e 652c 0a20 2020 2020   max=None,.     
-0001dfd0: 2020 2075 7070 6572 3d4e 6f6e 652c 0a20     upper=None,. 
-0001dfe0: 2020 2020 2020 206c 6f77 6572 3d4e 6f6e         lower=Non
-0001dff0: 652c 0a20 2020 2020 2020 206e 756d 6265  e,.        numbe
-0001e000: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
-0001e010: 656e 7472 6f70 793d 4e6f 6e65 2c0a 2020  entropy=None,.  
-0001e020: 2020 2020 2020 7370 6563 6961 6c3d 4e6f        special=No
-0001e030: 6e65 2c0a 2020 2020 2020 2020 7370 6563  ne,.        spec
-0001e040: 6961 6c73 3d72 227e 2140 2324 255e 262a  ials=r"~!@#$%^&*
-0001e050: 2829 5f2b 2d3d 3f3c 3e2c 2e3a 3b7b 7d5b  ()_+-=?<>,.:;{}[
-0001e060: 5d7c 222c 0a20 2020 2020 2020 2069 6e76  ]|",.        inv
-0001e070: 616c 6964 3d27 2022 272c 0a20 2020 2020  alid=' "',.     
-0001e080: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001e090: 3d4e 6f6e 652c 0a20 2020 2020 2020 2065  =None,.        e
-0001e0a0: 733d 4661 6c73 652c 0a20 2020 2029 3a0a  s=False,.    ):.
-0001e0b0: 2020 2020 2020 2020 7365 6c66 2e65 6e74          self.ent
-0001e0c0: 726f 7079 203d 2065 6e74 726f 7079 0a20  ropy = entropy. 
-0001e0d0: 2020 2020 2020 2069 6620 656e 7472 6f70         if entrop
-0001e0e0: 7920 6973 204e 6f6e 653a 0a20 2020 2020  y is None:.     
-0001e0f0: 2020 2020 2020 2023 2065 6e66 6f72 6365         # enforce
-0001e100: 2064 6566 6175 6c74 2072 6571 7569 7265   default require
-0001e110: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-0001e120: 2020 7365 6c66 2e6d 696e 203d 2038 2069    self.min = 8 i
-0001e130: 6620 6d69 6e20 6973 204e 6f6e 6520 656c  f min is None el
-0001e140: 7365 206d 696e 0a20 2020 2020 2020 2020  se min.         
-0001e150: 2020 2073 656c 662e 6d61 7820 3d20 6d61     self.max = ma
-0001e160: 7820 2023 2077 6173 2032 302c 2062 7574  x  # was 20, but
-0001e170: 2074 6861 7420 646f 6573 6e27 7420 6d61   that doesn't ma
-0001e180: 6b65 2073 656e 7365 0a20 2020 2020 2020  ke sense.       
-0001e190: 2020 2020 2073 656c 662e 7570 7065 7220       self.upper 
-0001e1a0: 3d20 3120 6966 2075 7070 6572 2069 7320  = 1 if upper is 
-0001e1b0: 4e6f 6e65 2065 6c73 6520 7570 7065 720a  None else upper.
-0001e1c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e1d0: 2e6c 6f77 6572 203d 2031 2069 6620 6c6f  .lower = 1 if lo
-0001e1e0: 7765 7220 6973 204e 6f6e 6520 656c 7365  wer is None else
-0001e1f0: 206c 6f77 6572 0a20 2020 2020 2020 2020   lower.         
-0001e200: 2020 2073 656c 662e 6e75 6d62 6572 203d     self.number =
-0001e210: 2031 2069 6620 6e75 6d62 6572 2069 7320   1 if number is 
-0001e220: 4e6f 6e65 2065 6c73 6520 6e75 6d62 6572  None else number
-0001e230: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001e240: 662e 7370 6563 6961 6c20 3d20 3120 6966  f.special = 1 if
-0001e250: 2073 7065 6369 616c 2069 7320 4e6f 6e65   special is None
-0001e260: 2065 6c73 6520 7370 6563 6961 6c0a 2020   else special.  
-0001e270: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001e280: 2020 2020 2020 2020 2320 6279 2064 6566          # by def
-0001e290: 6175 6c74 2c20 616e 2065 6e74 726f 7079  ault, an entropy
-0001e2a0: 2073 7065 6320 6973 2065 7863 6c75 7369   spec is exclusi
-0001e2b0: 7665 0a20 2020 2020 2020 2020 2020 2073  ve.            s
-0001e2c0: 656c 662e 6d69 6e20 3d20 6d69 6e0a 2020  elf.min = min.  
-0001e2d0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0001e2e0: 6178 203d 206d 6178 0a20 2020 2020 2020  ax = max.       
-0001e2f0: 2020 2020 2073 656c 662e 7570 7065 7220       self.upper 
-0001e300: 3d20 7570 7065 720a 2020 2020 2020 2020  = upper.        
-0001e310: 2020 2020 7365 6c66 2e6c 6f77 6572 203d      self.lower =
-0001e320: 206c 6f77 6572 0a20 2020 2020 2020 2020   lower.         
-0001e330: 2020 2073 656c 662e 6e75 6d62 6572 203d     self.number =
-0001e340: 206e 756d 6265 720a 2020 2020 2020 2020   number.        
-0001e350: 2020 2020 7365 6c66 2e73 7065 6369 616c      self.special
-0001e360: 203d 2073 7065 6369 616c 0a20 2020 2020   = special.     
-0001e370: 2020 2073 656c 662e 7370 6563 6961 6c73     self.specials
-0001e380: 203d 2073 7065 6369 616c 730a 2020 2020   = specials.    
-0001e390: 2020 2020 7365 6c66 2e69 6e76 616c 6964      self.invalid
-0001e3a0: 203d 2069 6e76 616c 6964 0a20 2020 2020   = invalid.     
-0001e3b0: 2020 2073 656c 662e 6572 726f 725f 6d65     self.error_me
-0001e3c0: 7373 6167 6520 3d20 6572 726f 725f 6d65  ssage = error_me
-0001e3d0: 7373 6167 650a 2020 2020 2020 2020 7365  ssage.        se
-0001e3e0: 6c66 2e65 7374 7269 6e67 203d 2065 7320  lf.estring = es 
-0001e3f0: 2023 2072 6574 7572 6e20 6572 726f 7220   # return error 
-0001e400: 6d65 7373 6167 6520 6173 2073 7472 696e  message as strin
-0001e410: 6720 2866 6f72 2064 6f63 7465 7374 290a  g (for doctest).
-0001e420: 0a20 2020 2064 6566 2076 616c 6964 6174  .    def validat
-0001e430: 6528 7365 6c66 2c20 7661 6c75 652c 2072  e(self, value, r
-0001e440: 6563 6f72 645f 6964 3d4e 6f6e 6529 3a0a  ecord_id=None):.
-0001e450: 2020 2020 2020 2020 6661 696c 7572 6573          failures
-0001e460: 203d 205b 5d0a 2020 2020 2020 2020 6966   = [].        if
-0001e470: 2076 616c 7565 2069 7320 4e6f 6e65 3a0a   value is None:.
-0001e480: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0001e490: 6520 3d20 2222 0a20 2020 2020 2020 2069  e = "".        i
-0001e4a0: 6620 7661 6c75 6520 616e 6420 6c65 6e28  f value and len(
-0001e4b0: 7661 6c75 6529 203d 3d20 7661 6c75 652e  value) == value.
-0001e4c0: 636f 756e 7428 222a 2229 203e 2034 3a0a  count("*") > 4:.
-0001e4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e4e0: 726e 2076 616c 7565 0a20 2020 2020 2020  rn value.       
-0001e4f0: 2069 6620 7365 6c66 2e65 6e74 726f 7079   if self.entropy
-0001e500: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0001e510: 2020 2020 2020 2020 2020 656e 7472 6f70            entrop
-0001e520: 7920 3d20 6361 6c63 5f65 6e74 726f 7079  y = calc_entropy
-0001e530: 2876 616c 7565 290a 2020 2020 2020 2020  (value).        
-0001e540: 2020 2020 6966 2065 6e74 726f 7079 203c      if entropy <
-0001e550: 2073 656c 662e 656e 7472 6f70 793a 0a20   self.entropy:. 
-0001e560: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001e570: 6169 6c75 7265 732e 6170 7065 6e64 280a  ailures.append(.
-0001e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e590: 2020 2020 7365 6c66 2e74 7261 6e73 6c61      self.transla
-0001e5a0: 746f 7228 2250 6173 7377 6f72 6420 746f  tor("Password to
-0001e5b0: 6f20 7369 6d70 6c65 2028 2528 6861 7665  o simple (%(have
-0001e5c0: 2973 2f25 286e 6565 6429 7329 2229 0a20  )s/%(need)s)"). 
-0001e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5e0: 2020 2025 2064 6963 7428 6861 7665 3d65     % dict(have=e
-0001e5f0: 6e74 726f 7079 2c20 6e65 6564 3d73 656c  ntropy, need=sel
-0001e600: 662e 656e 7472 6f70 7929 0a20 2020 2020  f.entropy).     
-0001e610: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001e620: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0001e630: 6365 2873 656c 662e 6d69 6e2c 2069 6e74  ce(self.min, int
-0001e640: 2920 616e 6420 7365 6c66 2e6d 696e 203e  ) and self.min >
-0001e650: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001e660: 6966 206e 6f74 206c 656e 2876 616c 7565  if not len(value
-0001e670: 2920 3e3d 2073 656c 662e 6d69 6e3a 0a20  ) >= self.min:. 
-0001e680: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001e690: 6169 6c75 7265 732e 6170 7065 6e64 2873  ailures.append(s
-0001e6a0: 656c 662e 7472 616e 736c 6174 6f72 2822  elf.translator("
-0001e6b0: 4d69 6e69 6d75 6d20 6c65 6e67 7468 2069  Minimum length i
-0001e6c0: 7320 2573 2229 2025 2073 656c 662e 6d69  s %s") % self.mi
-0001e6d0: 6e29 0a20 2020 2020 2020 2069 6620 6973  n).        if is
-0001e6e0: 696e 7374 616e 6365 2873 656c 662e 6d61  instance(self.ma
-0001e6f0: 782c 2069 6e74 2920 616e 6420 7365 6c66  x, int) and self
-0001e700: 2e6d 6178 203e 2030 3a0a 2020 2020 2020  .max > 0:.      
-0001e710: 2020 2020 2020 6966 206e 6f74 206c 656e        if not len
-0001e720: 2876 616c 7565 2920 3c3d 2073 656c 662e  (value) <= self.
-0001e730: 6d61 783a 0a20 2020 2020 2020 2020 2020  max:.           
-0001e740: 2020 2020 2066 6169 6c75 7265 732e 6170       failures.ap
-0001e750: 7065 6e64 2873 656c 662e 7472 616e 736c  pend(self.transl
-0001e760: 6174 6f72 2822 4d61 7869 6d75 6d20 6c65  ator("Maximum le
-0001e770: 6e67 7468 2069 7320 2573 2229 2025 2073  ngth is %s") % s
-0001e780: 656c 662e 6d61 7829 0a20 2020 2020 2020  elf.max).       
-0001e790: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-0001e7a0: 656c 662e 7370 6563 6961 6c2c 2069 6e74  elf.special, int
-0001e7b0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-0001e7c0: 6c6c 5f73 7065 6369 616c 203d 205b 6368  ll_special = [ch
-0001e7d0: 2069 6e20 7661 6c75 6520 666f 7220 6368   in value for ch
-0001e7e0: 2069 6e20 7365 6c66 2e73 7065 6369 616c   in self.special
-0001e7f0: 735d 0a20 2020 2020 2020 2020 2020 2069  s].            i
-0001e800: 6620 7365 6c66 2e73 7065 6369 616c 203e  f self.special >
-0001e810: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001e820: 2020 2020 6966 206e 6f74 2061 6c6c 5f73      if not all_s
-0001e830: 7065 6369 616c 2e63 6f75 6e74 2854 7275  pecial.count(Tru
-0001e840: 6529 203e 3d20 7365 6c66 2e73 7065 6369  e) >= self.speci
-0001e850: 616c 3a0a 2020 2020 2020 2020 2020 2020  al:.            
-0001e860: 2020 2020 2020 2020 6661 696c 7572 6573          failures
-0001e870: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-0001e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e890: 2073 656c 662e 7472 616e 736c 6174 6f72   self.translator
-0001e8a0: 2822 4d75 7374 2069 6e63 6c75 6465 2061  ("Must include a
-0001e8b0: 7420 6c65 6173 7420 2573 206f 6620 7468  t least %s of th
-0001e8c0: 6520 666f 6c6c 6f77 696e 673a 2025 7322  e following: %s"
-0001e8d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e8e0: 2020 2020 2020 2020 2020 2520 2873 656c            % (sel
-0001e8f0: 662e 7370 6563 6961 6c2c 2073 656c 662e  f.special, self.
-0001e900: 7370 6563 6961 6c73 290a 2020 2020 2020  specials).      
-0001e910: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001e920: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0001e930: 2073 656c 662e 7370 6563 6961 6c20 3d3d   self.special ==
-0001e940: 2030 2061 6e64 2073 656c 662e 7370 6563   0 and self.spec
-0001e950: 6961 6c20 6973 206e 6f74 2046 616c 7365  ial is not False
-0001e960: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001e970: 2020 6966 206c 656e 285b 6974 656d 2066    if len([item f
-0001e980: 6f72 2069 7465 6d20 696e 2061 6c6c 5f73  or item in all_s
-0001e990: 7065 6369 616c 2069 6620 6974 656d 5d29  pecial if item])
-0001e9a0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-0001e9b0: 2020 2020 2020 2020 2020 6661 696c 7572            failur
-0001e9c0: 6573 2e61 7070 656e 6428 0a20 2020 2020  es.append(.     
-0001e9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e9e0: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
-0001e9f0: 6f72 2822 4d61 7920 6e6f 7420 636f 6e74  or("May not cont
-0001ea00: 6169 6e20 616e 7920 6f66 2074 6865 2066  ain any of the f
-0001ea10: 6f6c 6c6f 7769 6e67 3a20 2573 2229 0a20  ollowing: %s"). 
-0001ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea30: 2020 2020 2020 2025 2073 656c 662e 7370         % self.sp
-0001ea40: 6563 6961 6c73 0a20 2020 2020 2020 2020  ecials.         
-0001ea50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001ea60: 2020 2020 2069 6620 7365 6c66 2e69 6e76       if self.inv
-0001ea70: 616c 6964 3a0a 2020 2020 2020 2020 2020  alid:.          
-0001ea80: 2020 616c 6c5f 696e 7661 6c69 6420 3d20    all_invalid = 
-0001ea90: 5b63 6820 696e 2076 616c 7565 2066 6f72  [ch in value for
-0001eaa0: 2063 6820 696e 2073 656c 662e 696e 7661   ch in self.inva
-0001eab0: 6c69 645d 0a20 2020 2020 2020 2020 2020  lid].           
-0001eac0: 2069 6620 616c 6c5f 696e 7661 6c69 642e   if all_invalid.
-0001ead0: 636f 756e 7428 5472 7565 2920 3e20 303a  count(True) > 0:
-0001eae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eaf0: 2066 6169 6c75 7265 732e 6170 7065 6e64   failures.append
-0001eb00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001eb10: 2020 2020 2020 7365 6c66 2e74 7261 6e73        self.trans
-0001eb20: 6c61 746f 7228 224d 6179 206e 6f74 2063  lator("May not c
-0001eb30: 6f6e 7461 696e 2061 6e79 206f 6620 7468  ontain any of th
-0001eb40: 6520 666f 6c6c 6f77 696e 673a 2025 7322  e following: %s"
-0001eb50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001eb60: 2020 2020 2020 2520 7365 6c66 2e69 6e76        % self.inv
-0001eb70: 616c 6964 0a20 2020 2020 2020 2020 2020  alid.           
-0001eb80: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-0001eb90: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-0001eba0: 662e 7570 7065 722c 2069 6e74 293a 0a20  f.upper, int):. 
-0001ebb0: 2020 2020 2020 2020 2020 2061 6c6c 5f75             all_u
-0001ebc0: 7070 6572 203d 2072 652e 6669 6e64 616c  pper = re.findal
-0001ebd0: 6c28 225b 412d 5a5d 222c 2076 616c 7565  l("[A-Z]", value
-0001ebe0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0001ebf0: 2073 656c 662e 7570 7065 7220 3e20 303a   self.upper > 0:
-0001ec00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ec10: 2069 6620 6e6f 7420 6c65 6e28 616c 6c5f   if not len(all_
-0001ec20: 7570 7065 7229 203e 3d20 7365 6c66 2e75  upper) >= self.u
-0001ec30: 7070 6572 3a0a 2020 2020 2020 2020 2020  pper:.          
-0001ec40: 2020 2020 2020 2020 2020 6661 696c 7572            failur
-0001ec50: 6573 2e61 7070 656e 6428 0a20 2020 2020  es.append(.     
-0001ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec70: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
-0001ec80: 6f72 2822 4d75 7374 2069 6e63 6c75 6465  or("Must include
-0001ec90: 2061 7420 6c65 6173 7420 2573 2075 7070   at least %s upp
-0001eca0: 6572 6361 7365 2229 0a20 2020 2020 2020  ercase").       
-0001ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ecc0: 2025 2073 7472 2873 656c 662e 7570 7065   % str(self.uppe
-0001ecd0: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-0001ece0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ecf0: 2020 2020 2065 6c69 6620 7365 6c66 2e75       elif self.u
-0001ed00: 7070 6572 203d 3d20 3020 616e 6420 7365  pper == 0 and se
-0001ed10: 6c66 2e75 7070 6572 2069 7320 6e6f 7420  lf.upper is not 
-0001ed20: 4661 6c73 653a 0a20 2020 2020 2020 2020  False:.         
-0001ed30: 2020 2020 2020 2069 6620 6c65 6e28 616c         if len(al
-0001ed40: 6c5f 7570 7065 7229 203e 2030 3a0a 2020  l_upper) > 0:.  
-0001ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed60: 2020 6661 696c 7572 6573 2e61 7070 656e    failures.appen
-0001ed70: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-0001ed80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001ed90: 7472 616e 736c 6174 6f72 2822 4d61 7920  translator("May 
-0001eda0: 6e6f 7420 696e 636c 7564 6520 616e 7920  not include any 
-0001edb0: 7570 7065 7263 6173 6520 6c65 7474 6572  uppercase letter
-0001edc0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-0001edd0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001ede0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001edf0: 7365 6c66 2e6c 6f77 6572 2c20 696e 7429  self.lower, int)
-0001ee00: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
-0001ee10: 6c5f 6c6f 7765 7220 3d20 7265 2e66 696e  l_lower = re.fin
-0001ee20: 6461 6c6c 2822 5b61 2d7a 5d22 2c20 7661  dall("[a-z]", va
-0001ee30: 6c75 6529 0a20 2020 2020 2020 2020 2020  lue).           
-0001ee40: 2069 6620 7365 6c66 2e6c 6f77 6572 203e   if self.lower >
-0001ee50: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001ee60: 2020 2020 6966 206e 6f74 206c 656e 2861      if not len(a
-0001ee70: 6c6c 5f6c 6f77 6572 2920 3e3d 2073 656c  ll_lower) >= sel
-0001ee80: 662e 6c6f 7765 723a 0a20 2020 2020 2020  f.lower:.       
-0001ee90: 2020 2020 2020 2020 2020 2020 2066 6169               fai
-0001eea0: 6c75 7265 732e 6170 7065 6e64 280a 2020  lures.append(.  
-0001eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eec0: 2020 2020 2020 7365 6c66 2e74 7261 6e73        self.trans
-0001eed0: 6c61 746f 7228 224d 7573 7420 696e 636c  lator("Must incl
-0001eee0: 7564 6520 6174 206c 6561 7374 2025 7320  ude at least %s 
-0001eef0: 6c6f 7765 7263 6173 6522 290a 2020 2020  lowercase").    
-0001ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef10: 2020 2020 2520 7374 7228 7365 6c66 2e6c      % str(self.l
-0001ef20: 6f77 6572 290a 2020 2020 2020 2020 2020  ower).          
-0001ef30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001ef40: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0001ef50: 662e 6c6f 7765 7220 3d3d 2030 2061 6e64  f.lower == 0 and
-0001ef60: 2073 656c 662e 6c6f 7765 7220 6973 206e   self.lower is n
-0001ef70: 6f74 2046 616c 7365 3a0a 2020 2020 2020  ot False:.      
-0001ef80: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0001ef90: 2861 6c6c 5f6c 6f77 6572 2920 3e20 303a  (all_lower) > 0:
-0001efa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001efb0: 2020 2020 2066 6169 6c75 7265 732e 6170       failures.ap
-0001efc0: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
-0001efd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001efe0: 6c66 2e74 7261 6e73 6c61 746f 7228 224d  lf.translator("M
-0001eff0: 6179 206e 6f74 2069 6e63 6c75 6465 2061  ay not include a
-0001f000: 6e79 206c 6f77 6572 6361 7365 206c 6574  ny lowercase let
-0001f010: 7465 7273 2229 0a20 2020 2020 2020 2020  ters").         
-0001f020: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001f030: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0001f040: 6365 2873 656c 662e 6e75 6d62 6572 2c20  ce(self.number, 
-0001f050: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-0001f060: 2020 616c 6c5f 6e75 6d62 6572 203d 2072    all_number = r
-0001f070: 652e 6669 6e64 616c 6c28 225b 302d 395d  e.findall("[0-9]
-0001f080: 222c 2076 616c 7565 290a 2020 2020 2020  ", value).      
-0001f090: 2020 2020 2020 6966 2073 656c 662e 6e75        if self.nu
-0001f0a0: 6d62 6572 203e 2030 3a0a 2020 2020 2020  mber > 0:.      
-0001f0b0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0001f0c0: 7320 3d20 226e 756d 6265 7222 0a20 2020  s = "number".   
-0001f0d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001f0e0: 7365 6c66 2e6e 756d 6265 7220 3e20 313a  self.number > 1:
-0001f0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f100: 2020 2020 206e 756d 6265 7273 203d 2022       numbers = "
-0001f110: 6e75 6d62 6572 7322 0a20 2020 2020 2020  numbers".       
-0001f120: 2020 2020 2020 2020 206e 756d 6265 7273           numbers
-0001f130: 203d 2073 656c 662e 7472 616e 736c 6174   = self.translat
-0001f140: 6f72 286e 756d 6265 7273 290a 2020 2020  or(numbers).    
-0001f150: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001f160: 6f74 206c 656e 2861 6c6c 5f6e 756d 6265  ot len(all_numbe
-0001f170: 7229 203e 3d20 7365 6c66 2e6e 756d 6265  r) >= self.numbe
-0001f180: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-0001f190: 2020 2020 2020 2066 6169 6c75 7265 732e         failures.
-0001f1a0: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+00014980: 2020 6966 2064 6f6d 6169 6e4d 6174 6368    if domainMatch
+00014990: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000149a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000149b0: 6966 2074 6865 2074 6f70 2d6c 6576 656c  if the top-level
+000149c0: 2064 6f6d 6169 6e20 7265 616c 6c79 2065   domain really e
+000149d0: 7869 7374 730a 2020 2020 2020 2020 2020  xists.          
+000149e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149f0: 2020 6966 2064 6f6d 6169 6e4d 6174 6368    if domainMatch
+00014a00: 2e67 726f 7570 2835 292e 6c6f 7765 7228  .group(5).lower(
+00014a10: 2920 696e 2073 656c 662e 616c 6c6f 7765  ) in self.allowe
+00014a20: 645f 746c 6473 3a0a 2020 2020 2020 2020  d_tlds:.        
+00014a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a40: 2020 2020 2020 2020 2320 5468 656e 2074          # Then t
+00014a50: 6869 7320 4854 5450 2055 524c 2069 7320  his HTTP URL is 
+00014a60: 7661 6c69 640a 2020 2020 2020 2020 2020  valid.          
+00014a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a80: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00014a90: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00014aa0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00014ab0: 2020 2020 2020 2020 2020 2020 2023 2065               # e
+00014ac0: 6c73 6520 7468 6973 2069 7320 6120 7265  lse this is a re
+00014ad0: 6c61 7469 7665 2f61 6262 7265 7669 6174  lative/abbreviat
+00014ae0: 6564 2055 524c 2c20 7768 6963 6820 7769  ed URL, which wi
+00014af0: 6c6c 2070 6172 7365 0a20 2020 2020 2020  ll parse.       
+00014b00: 2020 2020 2020 2020 2020 2020 2023 2069               # i
+00014b10: 6e74 6f20 7468 6520 5552 4c27 7320 7061  nto the URL's pa
+00014b20: 7468 2063 6f6d 706f 6e65 6e74 0a20 2020  th component.   
+00014b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b40: 2070 6174 6820 3d20 636f 6d70 6f6e 656e   path = componen
+00014b50: 7473 2e70 6174 680a 2020 2020 2020 2020  ts.path.        
+00014b60: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+00014b70: 6c61 7469 7665 2063 6173 653a 2069 6620  lative case: if 
+00014b80: 7468 6973 2069 7320 6120 7661 6c69 6420  this is a valid 
+00014b90: 7061 7468 2028 6966 2069 7420 7374 6172  path (if it star
+00014ba0: 7473 2077 6974 680a 2020 2020 2020 2020  ts with.        
+00014bb0: 2020 2020 2020 2020 2020 2020 2320 6120              # a 
+00014bc0: 736c 6173 6829 0a20 2020 2020 2020 2020  slash).         
+00014bd0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00014be0: 7420 7061 7468 2e73 7461 7274 7377 6974  t path.startswit
+00014bf0: 6828 222f 2229 3a0a 2020 2020 2020 2020  h("/"):.        
+00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c10: 2320 6162 6272 6576 6961 7465 6420 6361  # abbreviated ca
+00014c20: 7365 3a20 6966 2077 6520 6861 7665 6e27  se: if we haven'
+00014c30: 7420 616c 7265 6164 792c 2070 7265 7065  t already, prepe
+00014c40: 6e64 2061 0a20 2020 2020 2020 2020 2020  nd a.           
+00014c50: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+00014c60: 6368 656d 6520 616e 6420 7365 6520 6966  cheme and see if
+00014c70: 2069 7420 6669 7865 7320 7468 6520 7072   it fixes the pr
+00014c80: 6f62 6c65 6d0a 2020 2020 2020 2020 2020  oblem.          
+00014c90: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00014ca0: 2022 3a2f 2f22 206e 6f74 2069 6e20 7661   "://" not in va
+00014cb0: 6c75 6520 616e 6420 4e6f 6e65 2069 6e20  lue and None in 
+00014cc0: 7365 6c66 2e61 6c6c 6f77 6564 5f73 6368  self.allowed_sch
+00014cd0: 656d 6573 3a0a 2020 2020 2020 2020 2020  emes:.          
+00014ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014cf0: 2020 7363 6865 6d65 546f 5573 6520 3d20    schemeToUse = 
+00014d00: 7365 6c66 2e70 7265 7065 6e64 5f73 6368  self.prepend_sch
+00014d10: 656d 6520 6f72 2022 6874 7470 220a 2020  eme or "http".  
+00014d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014d30: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+00014d40: 6c75 6520 3d20 7365 6c66 2e76 616c 6964  lue = self.valid
+00014d50: 6174 6528 7363 6865 6d65 546f 5573 6520  ate(schemeToUse 
+00014d60: 2b20 223a 2f2f 2220 2b20 7661 6c75 6529  + "://" + value)
+00014d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d80: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00014d90: 7572 6e20 6e65 775f 7661 6c75 6520 6966  urn new_value if
+00014da0: 2073 656c 662e 7072 6570 656e 645f 7363   self.prepend_sc
+00014db0: 6865 6d65 2065 6c73 6520 7661 6c75 650a  heme else value.
+00014dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014dd0: 2020 2020 7265 7475 726e 2076 616c 7565      return value
+00014de0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+00014df0: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00014e00: 730a 2020 2020 2020 2020 7261 6973 6520  s.        raise 
+00014e10: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
+00014e20: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+00014e30: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
+00014e40: 6765 2929 0a0a 0a63 6c61 7373 2049 535f  ge))...class IS_
+00014e50: 5552 4c28 5661 6c69 6461 746f 7229 3a0a  URL(Validator):.
+00014e60: 2020 2020 2222 220a 2020 2020 5265 6a65      """.    Reje
+00014e70: 6374 7320 6120 5552 4c20 7374 7269 6e67  cts a URL string
+00014e80: 2069 6620 616e 7920 6f66 2074 6865 2066   if any of the f
+00014e90: 6f6c 6c6f 7769 6e67 2069 7320 7472 7565  ollowing is true
+00014ea0: 3a0a 0a20 2020 2020 2020 2a20 5468 6520  :..       * The 
+00014eb0: 7374 7269 6e67 2069 7320 656d 7074 7920  string is empty 
+00014ec0: 6f72 204e 6f6e 650a 2020 2020 2020 202a  or None.       *
+00014ed0: 2054 6865 2073 7472 696e 6720 7573 6573   The string uses
+00014ee0: 2063 6861 7261 6374 6572 7320 7468 6174   characters that
+00014ef0: 2061 7265 206e 6f74 2061 6c6c 6f77 6564   are not allowed
+00014f00: 2069 6e20 6120 5552 4c0a 2020 2020 2020   in a URL.      
+00014f10: 202a 2054 6865 2073 7472 696e 6720 6272   * The string br
+00014f20: 6561 6b73 2061 6e79 206f 6620 7468 6520  eaks any of the 
+00014f30: 4854 5450 2073 796e 7461 6374 6963 2072  HTTP syntactic r
+00014f40: 756c 6573 0a20 2020 2020 2020 2a20 5468  ules.       * Th
+00014f50: 6520 5552 4c20 7363 6865 6d65 2073 7065  e URL scheme spe
+00014f60: 6369 6669 6564 2028 6966 206f 6e65 2069  cified (if one i
+00014f70: 7320 7370 6563 6966 6965 6429 2069 7320  s specified) is 
+00014f80: 6e6f 7420 2768 7474 7027 206f 7220 2768  not 'http' or 'h
+00014f90: 7474 7073 270a 2020 2020 2020 202a 2054  ttps'.       * T
+00014fa0: 6865 2074 6f70 2d6c 6576 656c 2064 6f6d  he top-level dom
+00014fb0: 6169 6e20 2869 6620 6120 686f 7374 206e  ain (if a host n
+00014fc0: 616d 6520 6973 2073 7065 6369 6669 6564  ame is specified
+00014fd0: 2920 646f 6573 206e 6f74 2065 7869 7374  ) does not exist
+00014fe0: 0a0a 2020 2020 2854 6865 7365 2072 756c  ..    (These rul
+00014ff0: 6573 2061 7265 2062 6173 6564 206f 6e20  es are based on 
+00015000: 5246 4320 3236 3136 3a20 6874 7470 3a2f  RFC 2616: http:/
+00015010: 2f77 7777 2e66 6171 732e 6f72 672f 7266  /www.faqs.org/rf
+00015020: 6373 2f72 6663 3236 3136 2e68 746d 6c29  cs/rfc2616.html)
+00015030: 0a0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+00015040: 696f 6e20 6f6e 6c79 2063 6865 636b 7320  ion only checks 
+00015050: 7468 6520 5552 4c27 7320 7379 6e74 6178  the URL's syntax
+00015060: 2e20 4974 2064 6f65 7320 6e6f 7420 6368  . It does not ch
+00015070: 6563 6b20 7468 6174 2074 6865 2055 524c  eck that the URL
+00015080: 0a20 2020 2070 6f69 6e74 7320 746f 2061  .    points to a
+00015090: 2072 6561 6c20 646f 6375 6d65 6e74 2c20   real document, 
+000150a0: 666f 7220 6578 616d 706c 652c 206f 7220  for example, or 
+000150b0: 7468 6174 2069 7420 6f74 6865 7277 6973  that it otherwis
+000150c0: 6520 6d61 6b65 7320 7365 6e73 650a 2020  e makes sense.  
+000150d0: 2020 7365 6d61 6e74 6963 616c 6c79 2e20    semantically. 
+000150e0: 5468 6973 2066 756e 6374 696f 6e20 646f  This function do
+000150f0: 6573 2061 7574 6f6d 6174 6963 616c 6c79  es automatically
+00015100: 2070 7265 7065 6e64 2027 6874 7470 3a2f   prepend 'http:/
+00015110: 2f27 2069 6e20 6672 6f6e 740a 2020 2020  /' in front.    
+00015120: 6f66 2061 2055 524c 2069 6e20 7468 6520  of a URL in the 
+00015130: 6361 7365 206f 6620 616e 2061 6262 7265  case of an abbre
+00015140: 7669 6174 6564 2055 524c 2028 652e 672e  viated URL (e.g.
+00015150: 2027 676f 6f67 6c65 2e63 6127 292e 0a0a   'google.ca')...
+00015160: 2020 2020 4966 2074 6865 2070 6172 616d      If the param
+00015170: 6574 6572 206d 6f64 653d 2767 656e 6572  eter mode='gener
+00015180: 6963 2720 6973 2075 7365 642c 2074 6865  ic' is used, the
+00015190: 6e20 7468 6973 2066 756e 6374 696f 6e27  n this function'
+000151a0: 7320 6265 6861 7669 6f72 0a20 2020 2063  s behavior.    c
+000151b0: 6861 6e67 6573 2e20 4974 2074 6865 6e20  hanges. It then 
+000151c0: 7265 6a65 6374 7320 6120 5552 4c20 7374  rejects a URL st
+000151d0: 7269 6e67 2069 6620 616e 7920 6f66 2074  ring if any of t
+000151e0: 6865 2066 6f6c 6c6f 7769 6e67 2069 7320  he following is 
+000151f0: 7472 7565 3a0a 0a20 2020 2020 2020 2a20  true:..       * 
+00015200: 5468 6520 7374 7269 6e67 2069 7320 656d  The string is em
+00015210: 7074 7920 6f72 204e 6f6e 650a 2020 2020  pty or None.    
+00015220: 2020 202a 2054 6865 2073 7472 696e 6720     * The string 
+00015230: 7573 6573 2063 6861 7261 6374 6572 7320  uses characters 
+00015240: 7468 6174 2061 7265 206e 6f74 2061 6c6c  that are not all
+00015250: 6f77 6564 2069 6e20 6120 5552 4c0a 2020  owed in a URL.  
+00015260: 2020 2020 202a 2054 6865 2055 524c 2073       * The URL s
+00015270: 6368 656d 6520 7370 6563 6966 6965 6420  cheme specified 
+00015280: 2869 6620 6f6e 6520 6973 2073 7065 6369  (if one is speci
+00015290: 6669 6564 2920 6973 206e 6f74 2076 616c  fied) is not val
+000152a0: 6964 0a0a 2020 2020 2854 6865 7365 2072  id..    (These r
+000152b0: 756c 6573 2061 7265 2062 6173 6564 206f  ules are based o
+000152c0: 6e20 5246 4320 3233 3936 3a20 6874 7470  n RFC 2396: http
+000152d0: 3a2f 2f77 7777 2e66 6171 732e 6f72 672f  ://www.faqs.org/
+000152e0: 7266 6373 2f72 6663 3233 3936 2e68 746d  rfcs/rfc2396.htm
+000152f0: 6c29 0a0a 2020 2020 5468 6520 6c69 7374  l)..    The list
+00015300: 206f 6620 616c 6c6f 7765 6420 7363 6865   of allowed sche
+00015310: 6d65 7320 6973 2063 7573 746f 6d69 7a61  mes is customiza
+00015320: 626c 6520 7769 7468 2074 6865 2061 6c6c  ble with the all
+00015330: 6f77 6564 5f73 6368 656d 6573 0a20 2020  owed_schemes.   
+00015340: 2070 6172 616d 6574 6572 2e20 4966 2079   parameter. If y
+00015350: 6f75 2065 7863 6c75 6465 204e 6f6e 6520  ou exclude None 
+00015360: 6672 6f6d 2074 6865 206c 6973 742c 2074  from the list, t
+00015370: 6865 6e20 6162 6272 6576 6961 7465 6420  hen abbreviated 
+00015380: 5552 4c73 0a20 2020 2028 6c61 636b 696e  URLs.    (lackin
+00015390: 6720 6120 7363 6865 6d65 2073 7563 6820  g a scheme such 
+000153a0: 6173 2027 6874 7470 2729 2077 696c 6c20  as 'http') will 
+000153b0: 6265 2072 656a 6563 7465 642e 0a0a 2020  be rejected...  
+000153c0: 2020 5468 6520 6465 6661 756c 7420 7072    The default pr
+000153d0: 6570 656e 6465 6420 7363 6865 6d65 2069  epended scheme i
+000153e0: 7320 6375 7374 6f6d 697a 6162 6c65 2077  s customizable w
+000153f0: 6974 6820 7468 6520 7072 6570 656e 645f  ith the prepend_
+00015400: 7363 6865 6d65 0a20 2020 2070 6172 616d  scheme.    param
+00015410: 6574 6572 2e20 4966 2079 6f75 2073 6574  eter. If you set
+00015420: 2070 7265 7065 6e64 5f73 6368 656d 6520   prepend_scheme 
+00015430: 746f 204e 6f6e 6520 7468 656e 2070 7265  to None then pre
+00015440: 7065 6e64 696e 6720 7769 6c6c 2062 650a  pending will be.
+00015450: 2020 2020 6469 7361 626c 6564 2e20 5552      disabled. UR
+00015460: 4c73 2074 6861 7420 7265 7175 6972 6520  Ls that require 
+00015470: 7072 6570 656e 6469 6e67 2074 6f20 7061  prepending to pa
+00015480: 7273 6520 7769 6c6c 2073 7469 6c6c 2062  rse will still b
+00015490: 6520 6163 6365 7074 6564 2c0a 2020 2020  e accepted,.    
+000154a0: 6275 7420 7468 6520 7265 7475 726e 2076  but the return v
+000154b0: 616c 7565 2077 696c 6c20 6e6f 7420 6265  alue will not be
+000154c0: 206d 6f64 6966 6965 642e 0a0a 2020 2020   modified...    
+000154d0: 4953 5f55 524c 2069 7320 636f 6d70 6174  IS_URL is compat
+000154e0: 6962 6c65 2077 6974 6820 7468 6520 496e  ible with the In
+000154f0: 7465 726e 6174 696f 6e61 6c69 7a65 6420  ternationalized 
+00015500: 446f 6d61 696e 204e 616d 6520 2849 444e  Domain Name (IDN
+00015510: 2920 7374 616e 6461 7264 0a20 2020 2073  ) standard.    s
+00015520: 7065 6369 6669 6564 2069 6e20 5246 4320  pecified in RFC 
+00015530: 3334 3930 2028 6874 7470 3a2f 2f74 6f6f  3490 (http://too
+00015540: 6c73 2e69 6574 662e 6f72 672f 6874 6d6c  ls.ietf.org/html
+00015550: 2f72 6663 3334 3930 292e 2041 7320 6120  /rfc3490). As a 
+00015560: 7265 7375 6c74 2c0a 2020 2020 5552 4c73  result,.    URLs
+00015570: 2063 616e 2062 6520 7265 6775 6c61 7220   can be regular 
+00015580: 7374 7269 6e67 7320 6f72 2075 6e69 636f  strings or unico
+00015590: 6465 2073 7472 696e 6773 2e0a 2020 2020  de strings..    
+000155a0: 4966 2074 6865 2055 524c 2773 2064 6f6d  If the URL's dom
+000155b0: 6169 6e20 636f 6d70 6f6e 656e 7420 2865  ain component (e
+000155c0: 2e67 2e20 676f 6f67 6c65 2e63 6129 2063  .g. google.ca) c
+000155d0: 6f6e 7461 696e 7320 6e6f 6e2d 5553 2d41  ontains non-US-A
+000155e0: 5343 4949 0a20 2020 206c 6574 7465 7273  SCII.    letters
+000155f0: 2c20 7468 656e 2074 6865 2064 6f6d 6169  , then the domai
+00015600: 6e20 7769 6c6c 2062 6520 636f 6e76 6572  n will be conver
+00015610: 7465 6420 696e 746f 2050 756e 7963 6f64  ted into Punycod
+00015620: 6520 2864 6566 696e 6564 2069 6e0a 2020  e (defined in.  
+00015630: 2020 5246 4320 3334 3932 2c20 6874 7470    RFC 3492, http
+00015640: 3a2f 2f74 6f6f 6c73 2e69 6574 662e 6f72  ://tools.ietf.or
+00015650: 672f 6874 6d6c 2f72 6663 3334 3932 292e  g/html/rfc3492).
+00015660: 2049 535f 5552 4c20 676f 6573 2061 2062   IS_URL goes a b
+00015670: 6974 2062 6579 6f6e 640a 2020 2020 7468  it beyond.    th
+00015680: 6520 7374 616e 6461 7264 732c 2061 6e64  e standards, and
+00015690: 2061 6c6c 6f77 7320 6e6f 6e2d 5553 2d41   allows non-US-A
+000156a0: 5343 4949 2063 6861 7261 6374 6572 7320  SCII characters 
+000156b0: 746f 2062 6520 7072 6573 656e 7420 696e  to be present in
+000156c0: 2074 6865 2070 6174 680a 2020 2020 616e   the path.    an
+000156d0: 6420 7175 6572 7920 636f 6d70 6f6e 656e  d query componen
+000156e0: 7473 206f 6620 7468 6520 5552 4c20 6173  ts of the URL as
+000156f0: 2077 656c 6c2e 2054 6865 7365 206e 6f6e   well. These non
+00015700: 2d55 532d 4153 4349 4920 6368 6172 6163  -US-ASCII charac
+00015710: 7465 7273 2077 696c 6c0a 2020 2020 6265  ters will.    be
+00015720: 2065 7363 6170 6564 2075 7369 6e67 2074   escaped using t
+00015730: 6865 2073 7461 6e64 6172 6420 2725 3230  he standard '%20
+00015740: 2720 7479 7065 2073 796e 7461 782e 2065  ' type syntax. e
+00015750: 2e67 2e20 7468 6520 756e 6963 6f64 650a  .g. the unicode.
+00015760: 2020 2020 6368 6172 6163 7465 7220 7769      character wi
+00015770: 7468 2068 6578 2063 6f64 6520 3078 3465  th hex code 0x4e
+00015780: 3836 2077 696c 6c20 6265 636f 6d65 2027  86 will become '
+00015790: 2534 6525 3836 270a 0a20 2020 2041 7267  %4e%86'..    Arg
+000157a0: 733a 0a20 2020 2020 2020 2065 7272 6f72  s:.        error
+000157b0: 5f6d 6573 7361 6765 3a20 6120 7374 7269  _message: a stri
+000157c0: 6e67 2c20 7468 6520 6572 726f 7220 6d65  ng, the error me
+000157d0: 7373 6167 6520 746f 2067 6976 6520 7468  ssage to give th
+000157e0: 6520 656e 6420 7573 6572 0a20 2020 2020  e end user.     
+000157f0: 2020 2020 2020 2069 6620 7468 6520 5552         if the UR
+00015800: 4c20 646f 6573 206e 6f74 2076 616c 6964  L does not valid
+00015810: 6174 650a 2020 2020 2020 2020 616c 6c6f  ate.        allo
+00015820: 7765 645f 7363 6865 6d65 733a 2061 206c  wed_schemes: a l
+00015830: 6973 7420 636f 6e74 6169 6e69 6e67 2073  ist containing s
+00015840: 7472 696e 6773 206f 7220 4e6f 6e65 2e20  trings or None. 
+00015850: 4561 6368 2065 6c65 6d65 6e74 0a20 2020  Each element.   
+00015860: 2020 2020 2020 2020 2069 7320 6120 7363           is a sc
+00015870: 6865 6d65 2074 6865 2069 6e70 7574 7465  heme the inputte
+00015880: 6420 5552 4c20 6973 2061 6c6c 6f77 6564  d URL is allowed
+00015890: 2074 6f20 7573 650a 2020 2020 2020 2020   to use.        
+000158a0: 7072 6570 656e 645f 7363 6865 6d65 3a20  prepend_scheme: 
+000158b0: 6120 7374 7269 6e67 2c20 7468 6973 2073  a string, this s
+000158c0: 6368 656d 6520 6973 2070 7265 7065 6e64  cheme is prepend
+000158d0: 6564 2069 6620 6974 2773 0a20 2020 2020  ed if it's.     
+000158e0: 2020 2020 2020 206e 6563 6573 7361 7279         necessary
+000158f0: 2074 6f20 6d61 6b65 2074 6865 2055 524c   to make the URL
+00015900: 2076 616c 6964 0a0a 2020 2020 436f 6465   valid..    Code
+00015910: 2045 7861 6d70 6c65 733a 3a0a 0a20 2020   Examples::..   
+00015920: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
+00015930: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
+00015940: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
+00015950: 4953 5f55 524c 2829 290a 2020 2020 2020  IS_URL()).      
+00015960: 2020 3e3e 3e20 4953 5f55 524c 2829 2827    >>> IS_URL()('
+00015970: 6162 632e 636f 6d27 290a 2020 2020 2020  abc.com').      
+00015980: 2020 2827 6874 7470 3a2f 2f61 6263 2e63    ('http://abc.c
+00015990: 6f6d 272c 204e 6f6e 6529 0a0a 2020 2020  om', None)..    
+000159a0: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
+000159b0: 2774 6578 7427 2c20 5f6e 616d 653d 276e  'text', _name='n
+000159c0: 616d 6527 2c20 7265 7175 6972 6573 3d49  ame', requires=I
+000159d0: 535f 5552 4c28 6d6f 6465 3d27 6765 6e65  S_URL(mode='gene
+000159e0: 7269 6327 2929 0a20 2020 2020 2020 203e  ric')).        >
+000159f0: 3e3e 2049 535f 5552 4c28 6d6f 6465 3d27  >> IS_URL(mode='
+00015a00: 6765 6e65 7269 6327 2928 2761 6263 2e63  generic')('abc.c
+00015a10: 6f6d 2729 0a20 2020 2020 2020 2028 2761  om').        ('a
+00015a20: 6263 2e63 6f6d 272c 204e 6f6e 6529 0a0a  bc.com', None)..
+00015a30: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+00015a40: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
+00015a50: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
+00015a60: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
+00015a70: 535f 5552 4c28 616c 6c6f 7765 645f 7363  S_URL(allowed_sc
+00015a80: 6865 6d65 733d 5b27 6874 7470 7327 5d2c  hemes=['https'],
+00015a90: 2070 7265 7065 6e64 5f73 6368 656d 653d   prepend_scheme=
+00015aa0: 2768 7474 7073 2729 290a 2020 2020 2020  'https')).      
+00015ab0: 2020 3e3e 3e20 4953 5f55 524c 2861 6c6c    >>> IS_URL(all
+00015ac0: 6f77 6564 5f73 6368 656d 6573 3d5b 2768  owed_schemes=['h
+00015ad0: 7474 7073 275d 2c20 7072 6570 656e 645f  ttps'], prepend_
+00015ae0: 7363 6865 6d65 3d27 6874 7470 7327 2928  scheme='https')(
+00015af0: 2768 7474 7073 3a2f 2f61 6263 2e63 6f6d  'https://abc.com
+00015b00: 2729 0a20 2020 2020 2020 2028 2768 7474  ').        ('htt
+00015b10: 7073 3a2f 2f61 6263 2e63 6f6d 272c 204e  ps://abc.com', N
+00015b20: 6f6e 6529 0a0a 2020 2020 2020 2020 494e  one)..        IN
+00015b30: 5055 5428 5f74 7970 653d 2774 6578 7427  PUT(_type='text'
+00015b40: 2c20 5f6e 616d 653d 276e 616d 6527 2c0a  , _name='name',.
+00015b50: 2020 2020 2020 2020 2020 2020 7265 7175              requ
+00015b60: 6972 6573 3d49 535f 5552 4c28 7072 6570  ires=IS_URL(prep
+00015b70: 656e 645f 7363 6865 6d65 3d27 6874 7470  end_scheme='http
+00015b80: 7327 2929 0a20 2020 2020 2020 203e 3e3e  s')).        >>>
+00015b90: 2049 535f 5552 4c28 7072 6570 656e 645f   IS_URL(prepend_
+00015ba0: 7363 6865 6d65 3d27 6874 7470 7327 2928  scheme='https')(
+00015bb0: 2761 6263 2e63 6f6d 2729 0a20 2020 2020  'abc.com').     
+00015bc0: 2020 2028 2768 7474 7073 3a2f 2f61 6263     ('https://abc
+00015bd0: 2e63 6f6d 272c 204e 6f6e 6529 0a0a 2020  .com', None)..  
+00015be0: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
+00015bf0: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
+00015c00: 276e 616d 6527 2c0a 2020 2020 2020 2020  'name',.        
+00015c10: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+00015c20: 5552 4c28 6d6f 6465 3d27 6765 6e65 7269  URL(mode='generi
+00015c30: 6327 2c20 616c 6c6f 7765 645f 7363 6865  c', allowed_sche
+00015c40: 6d65 733d 5b27 6674 7073 272c 2027 6874  mes=['ftps', 'ht
+00015c50: 7470 7327 5d2c 0a20 2020 2020 2020 2020  tps'],.         
+00015c60: 2020 2020 2020 2070 7265 7065 6e64 5f73         prepend_s
+00015c70: 6368 656d 653d 2768 7474 7073 2729 290a  cheme='https')).
+00015c80: 2020 2020 2020 2020 3e3e 3e20 4953 5f55          >>> IS_U
+00015c90: 524c 286d 6f64 653d 2767 656e 6572 6963  RL(mode='generic
+00015ca0: 272c 2061 6c6c 6f77 6564 5f73 6368 656d  ', allowed_schem
+00015cb0: 6573 3d5b 2766 7470 7327 2c20 2768 7474  es=['ftps', 'htt
+00015cc0: 7073 275d 2c20 7072 6570 656e 645f 7363  ps'], prepend_sc
+00015cd0: 6865 6d65 3d27 6874 7470 7327 2928 2768  heme='https')('h
+00015ce0: 7474 7073 3a2f 2f61 6263 2e63 6f6d 2729  ttps://abc.com')
+00015cf0: 0a20 2020 2020 2020 2028 2768 7474 7073  .        ('https
+00015d00: 3a2f 2f61 6263 2e63 6f6d 272c 204e 6f6e  ://abc.com', Non
+00015d10: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
+00015d20: 535f 5552 4c28 6d6f 6465 3d27 6765 6e65  S_URL(mode='gene
+00015d30: 7269 6327 2c20 616c 6c6f 7765 645f 7363  ric', allowed_sc
+00015d40: 6865 6d65 733d 5b27 6674 7073 272c 2027  hemes=['ftps', '
+00015d50: 6874 7470 7327 2c20 4e6f 6e65 5d2c 2070  https', None], p
+00015d60: 7265 7065 6e64 5f73 6368 656d 653d 2768  repend_scheme='h
+00015d70: 7474 7073 2729 2827 6162 632e 636f 6d27  ttps')('abc.com'
+00015d80: 290a 2020 2020 2020 2020 2827 6162 632e  ).        ('abc.
+00015d90: 636f 6d27 2c20 4e6f 6e65 290a 0a20 2020  com', None)..   
+00015da0: 2040 6175 7468 6f72 3a20 4a6f 6e61 7468   @author: Jonath
+00015db0: 616e 2042 656e 6e0a 2020 2020 2222 220a  an Benn.    """.
+00015dc0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00015dd0: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00015de0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+00015df0: 6573 7361 6765 3d22 456e 7465 7220 6120  essage="Enter a 
+00015e00: 7661 6c69 6420 5552 4c22 2c0a 2020 2020  valid URL",.    
+00015e10: 2020 2020 6d6f 6465 3d22 6874 7470 222c      mode="http",
+00015e20: 0a20 2020 2020 2020 2061 6c6c 6f77 6564  .        allowed
+00015e30: 5f73 6368 656d 6573 3d4e 6f6e 652c 0a20  _schemes=None,. 
+00015e40: 2020 2020 2020 2070 7265 7065 6e64 5f73         prepend_s
+00015e50: 6368 656d 653d 2268 7474 7022 2c0a 2020  cheme="http",.  
+00015e60: 2020 2020 2020 616c 6c6f 7765 645f 746c        allowed_tl
+00015e70: 6473 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ds=None,.    ):.
+00015e80: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
+00015e90: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
+00015ea0: 6f72 5f6d 6573 7361 6765 0a20 2020 2020  or_message.     
+00015eb0: 2020 2073 656c 662e 6d6f 6465 203d 206d     self.mode = m
+00015ec0: 6f64 652e 6c6f 7765 7228 290a 2020 2020  ode.lower().    
+00015ed0: 2020 2020 6966 2073 656c 662e 6d6f 6465      if self.mode
+00015ee0: 206e 6f74 2069 6e20 5b22 6765 6e65 7269   not in ["generi
+00015ef0: 6322 2c20 2268 7474 7022 5d3a 0a20 2020  c", "http"]:.   
+00015f00: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
+00015f10: 796e 7461 7845 7272 6f72 2822 696e 7661  yntaxError("inva
+00015f20: 6c69 6420 6d6f 6465 2027 2573 2720 696e  lid mode '%s' in
+00015f30: 2049 535f 5552 4c22 2025 2073 656c 662e   IS_URL" % self.
+00015f40: 6d6f 6465 290a 2020 2020 2020 2020 7365  mode).        se
+00015f50: 6c66 2e61 6c6c 6f77 6564 5f73 6368 656d  lf.allowed_schem
+00015f60: 6573 203d 2061 6c6c 6f77 6564 5f73 6368  es = allowed_sch
+00015f70: 656d 6573 0a20 2020 2020 2020 2069 6620  emes.        if 
+00015f80: 616c 6c6f 7765 645f 746c 6473 2069 7320  allowed_tlds is 
+00015f90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00015fa0: 2020 7365 6c66 2e61 6c6c 6f77 6564 5f74    self.allowed_t
+00015fb0: 6c64 7320 3d20 6f66 6669 6369 616c 5f74  lds = official_t
+00015fc0: 6f70 5f6c 6576 656c 5f64 6f6d 6169 6e73  op_level_domains
+00015fd0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00015fe0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00015ff0: 616c 6c6f 7765 645f 746c 6473 203d 2061  allowed_tlds = a
+00016000: 6c6c 6f77 6564 5f74 6c64 730a 0a20 2020  llowed_tlds..   
+00016010: 2020 2020 2069 6620 7365 6c66 2e61 6c6c       if self.all
+00016020: 6f77 6564 5f73 6368 656d 6573 3a0a 2020  owed_schemes:.  
+00016030: 2020 2020 2020 2020 2020 6966 2070 7265            if pre
+00016040: 7065 6e64 5f73 6368 656d 6520 6e6f 7420  pend_scheme not 
+00016050: 696e 2073 656c 662e 616c 6c6f 7765 645f  in self.allowed_
+00016060: 7363 6865 6d65 733a 0a20 2020 2020 2020  schemes:.       
+00016070: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
+00016080: 796e 7461 7845 7272 6f72 280a 2020 2020  yntaxError(.    
+00016090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160a0: 2270 7265 7065 6e64 5f73 6368 656d 653d  "prepend_scheme=
+000160b0: 2725 7327 2069 7320 6e6f 7420 696e 2061  '%s' is not in a
+000160c0: 6c6c 6f77 6564 5f73 6368 656d 6573 3d25  llowed_schemes=%
+000160d0: 7322 0a20 2020 2020 2020 2020 2020 2020  s".             
+000160e0: 2020 2020 2020 2025 2028 7072 6570 656e         % (prepen
+000160f0: 645f 7363 6865 6d65 2c20 7365 6c66 2e61  d_scheme, self.a
+00016100: 6c6c 6f77 6564 5f73 6368 656d 6573 290a  llowed_schemes).
+00016110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016120: 290a 0a20 2020 2020 2020 2023 2069 6620  )..        # if 
+00016130: 616c 6c6f 7765 645f 7363 6865 6d65 7320  allowed_schemes 
+00016140: 6973 204e 6f6e 652c 2074 6865 6e20 7765  is None, then we
+00016150: 2077 696c 6c20 6465 6665 7220 7465 7374   will defer test
+00016160: 696e 670a 2020 2020 2020 2020 2320 7072  ing.        # pr
+00016170: 6570 656e 645f 7363 6865 6d65 2773 2076  epend_scheme's v
+00016180: 616c 6964 6974 7920 746f 2061 2073 7562  alidity to a sub
+00016190: 2d6d 6574 686f 640a 0a20 2020 2020 2020  -method..       
+000161a0: 2073 656c 662e 7072 6570 656e 645f 7363   self.prepend_sc
+000161b0: 6865 6d65 203d 2070 7265 7065 6e64 5f73  heme = prepend_s
+000161c0: 6368 656d 650a 0a20 2020 2064 6566 2076  cheme..    def v
+000161d0: 616c 6964 6174 6528 7365 6c66 2c20 7661  alidate(self, va
+000161e0: 6c75 652c 2072 6563 6f72 645f 6964 3d4e  lue, record_id=N
+000161f0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+00016200: 220a 2020 2020 2020 2020 4172 6773 3a0a  ".        Args:.
+00016210: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00016220: 653a 2061 2075 6e69 636f 6465 206f 7220  e: a unicode or 
+00016230: 7265 6775 6c61 7220 7374 7269 6e67 2c20  regular string, 
+00016240: 7468 6520 5552 4c20 746f 2076 616c 6964  the URL to valid
+00016250: 6174 650a 0a20 2020 2020 2020 2052 6574  ate..        Ret
+00016260: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+00016270: 2020 6120 2873 7472 696e 672c 2073 7472    a (string, str
+00016280: 696e 6729 2074 7570 6c65 2c20 7768 6572  ing) tuple, wher
+00016290: 6520 7475 706c 655b 305d 2069 7320 7468  e tuple[0] is th
+000162a0: 6520 6d6f 6469 6669 6564 0a20 2020 2020  e modified.     
+000162b0: 2020 2020 2020 2069 6e70 7574 2076 616c         input val
+000162c0: 7565 2061 6e64 2074 7570 6c65 5b31 5d20  ue and tuple[1] 
+000162d0: 6973 2065 6974 6865 7220 4e6f 6e65 2028  is either None (
+000162e0: 7375 6363 6573 7321 2920 6f72 2074 6865  success!) or the
+000162f0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00016300: 696e 6720 6572 726f 725f 6d65 7373 6167  ing error_messag
+00016310: 652e 2054 6865 2069 6e70 7574 2076 616c  e. The input val
+00016320: 7565 2077 696c 6c20 6e65 7665 7220 6265  ue will never be
+00016330: 206d 6f64 6966 6965 6420 696e 2074 6865   modified in the
+00016340: 0a20 2020 2020 2020 2020 2020 2063 6173  .            cas
+00016350: 6520 6f66 2061 6e20 6572 726f 722e 2048  e of an error. H
+00016360: 6f77 6576 6572 2c20 6966 2074 6865 7265  owever, if there
+00016370: 2069 7320 7375 6363 6573 7320 7468 656e   is success then
+00016380: 2074 6865 2069 6e70 7574 2055 524c 0a20   the input URL. 
+00016390: 2020 2020 2020 2020 2020 206d 6179 2062             may b
+000163a0: 6520 6d6f 6469 6669 6564 2074 6f20 2831  e modified to (1
+000163b0: 2920 7072 6570 656e 6420 6120 7363 6865  ) prepend a sche
+000163c0: 6d65 2c20 616e 642f 6f72 2028 3229 2063  me, and/or (2) c
+000163d0: 6f6e 7665 7274 2061 0a20 2020 2020 2020  onvert a.       
+000163e0: 2020 2020 206e 6f6e 2d63 6f6d 706c 6961       non-complia
+000163f0: 6e74 2075 6e69 636f 6465 2055 524c 2069  nt unicode URL i
+00016400: 6e74 6f20 6120 636f 6d70 6c69 616e 7420  nto a compliant 
+00016410: 5553 2d41 5343 4949 2076 6572 7369 6f6e  US-ASCII version
+00016420: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00016430: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
+00016440: 6465 203d 3d20 2267 656e 6572 6963 223a  de == "generic":
+00016450: 0a20 2020 2020 2020 2020 2020 2073 7562  .            sub
+00016460: 4d65 7468 6f64 203d 2049 535f 4745 4e45  Method = IS_GENE
+00016470: 5249 435f 5552 4c28 0a20 2020 2020 2020  RIC_URL(.       
+00016480: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+00016490: 6573 7361 6765 3d73 656c 662e 6572 726f  essage=self.erro
+000164a0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
+000164b0: 2020 2020 2020 2020 2020 2061 6c6c 6f77             allow
+000164c0: 6564 5f73 6368 656d 6573 3d73 656c 662e  ed_schemes=self.
+000164d0: 616c 6c6f 7765 645f 7363 6865 6d65 732c  allowed_schemes,
+000164e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000164f0: 2070 7265 7065 6e64 5f73 6368 656d 653d   prepend_scheme=
+00016500: 7365 6c66 2e70 7265 7065 6e64 5f73 6368  self.prepend_sch
+00016510: 656d 652c 0a20 2020 2020 2020 2020 2020  eme,.           
+00016520: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
+00016530: 7365 6c66 2e6d 6f64 6520 3d3d 2022 6874  self.mode == "ht
+00016540: 7470 223a 0a20 2020 2020 2020 2020 2020  tp":.           
+00016550: 2073 7562 4d65 7468 6f64 203d 2049 535f   subMethod = IS_
+00016560: 4854 5450 5f55 524c 280a 2020 2020 2020  HTTP_URL(.      
+00016570: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00016580: 6d65 7373 6167 653d 7365 6c66 2e65 7272  message=self.err
+00016590: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+000165a0: 2020 2020 2020 2020 2020 2020 616c 6c6f              allo
+000165b0: 7765 645f 7363 6865 6d65 733d 7365 6c66  wed_schemes=self
+000165c0: 2e61 6c6c 6f77 6564 5f73 6368 656d 6573  .allowed_schemes
+000165d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000165e0: 2020 7072 6570 656e 645f 7363 6865 6d65    prepend_scheme
+000165f0: 3d73 656c 662e 7072 6570 656e 645f 7363  =self.prepend_sc
+00016600: 6865 6d65 2c0a 2020 2020 2020 2020 2020  heme,.          
+00016610: 2020 2020 2020 616c 6c6f 7765 645f 746c        allowed_tl
+00016620: 6473 3d73 656c 662e 616c 6c6f 7765 645f  ds=self.allowed_
+00016630: 746c 6473 2c0a 2020 2020 2020 2020 2020  tlds,.          
+00016640: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00016650: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00016660: 6973 6520 5379 6e74 6178 4572 726f 7228  ise SyntaxError(
+00016670: 2269 6e76 616c 6964 206d 6f64 6520 2725  "invalid mode '%
+00016680: 7327 2069 6e20 4953 5f55 524c 2220 2520  s' in IS_URL" % 
+00016690: 7365 6c66 2e6d 6f64 6529 0a0a 2020 2020  self.mode)..    
+000166a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000166b0: 6528 7661 6c75 652c 2075 6e69 636f 6465  e(value, unicode
+000166c0: 5429 3a0a 2020 2020 2020 2020 2020 2020  T):.            
+000166d0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+000166e0: 2020 2020 2076 616c 7565 203d 2075 6e69       value = uni
+000166f0: 636f 6465 5f74 6f5f 6173 6369 695f 7572  code_to_ascii_ur
+00016700: 6c28 7661 6c75 652c 2073 656c 662e 7072  l(value, self.pr
+00016710: 6570 656e 645f 7363 6865 6d65 290a 2020  epend_scheme).  
+00016720: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00016730: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
+00016740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016750: 2023 2049 6620 7765 2061 7265 206e 6f74   # If we are not
+00016760: 2061 626c 6520 746f 2063 6f6e 7665 7274   able to convert
+00016770: 2074 6865 2075 6e69 636f 6465 2075 726c   the unicode url
+00016780: 2069 6e74 6f20 610a 2020 2020 2020 2020   into a.        
+00016790: 2020 2020 2020 2020 2320 5553 2d41 5343          # US-ASC
+000167a0: 4949 2055 524c 2c20 7468 656e 2074 6865  II URL, then the
+000167b0: 2055 524c 2069 7320 6e6f 7420 7661 6c69   URL is not vali
+000167c0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+000167d0: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
+000167e0: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
+000167f0: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
+00016800: 6f72 5f6d 6573 7361 6765 2929 0a20 2020  or_message)).   
+00016810: 2020 2020 2072 6574 7572 6e20 7375 624d       return subM
+00016820: 6574 686f 642e 7661 6c69 6461 7465 2876  ethod.validate(v
+00016830: 616c 7565 2c20 7265 636f 7264 5f69 6429  alue, record_id)
+00016840: 0a0a 0a63 6c61 7373 2049 535f 5449 4d45  ...class IS_TIME
+00016850: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
+00016860: 2022 2222 0a20 2020 2045 7861 6d70 6c65   """.    Example
+00016870: 3a0a 2020 2020 2020 2020 5573 6520 6173  :.        Use as
+00016880: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+00016890: 494e 5055 5428 5f74 7970 653d 2774 6578  INPUT(_type='tex
+000168a0: 7427 2c20 5f6e 616d 653d 276e 616d 6527  t', _name='name'
+000168b0: 2c20 7265 7175 6972 6573 3d49 535f 5449  , requires=IS_TI
+000168c0: 4d45 2829 290a 0a20 2020 2075 6e64 6572  ME())..    under
+000168d0: 7374 616e 6473 2074 6865 2066 6f6c 6c6f  stands the follo
+000168e0: 7769 6e67 2066 6f72 6d61 7473 0a20 2020  wing formats.   
+000168f0: 2068 683a 6d6d 3a73 7320 5b61 6d2f 706d   hh:mm:ss [am/pm
+00016900: 5d0a 2020 2020 6868 3a6d 6d20 5b61 6d2f  ].    hh:mm [am/
+00016910: 706d 5d0a 2020 2020 6868 205b 616d 2f70  pm].    hh [am/p
+00016920: 6d5d 0a0a 2020 2020 5b61 6d2f 706d 5d20  m]..    [am/pm] 
+00016930: 6973 206f 7074 696f 6e61 6c2c 2027 3a27  is optional, ':'
+00016940: 2063 616e 2062 6520 7265 706c 6163 6564   can be replaced
+00016950: 2062 7920 616e 7920 6f74 6865 7220 6e6f   by any other no
+00016960: 6e2d 7370 6163 6520 6e6f 6e2d 6469 6769  n-space non-digi
+00016970: 743a 3a0a 0a20 2020 2020 2020 203e 3e3e  t::..        >>>
+00016980: 2049 535f 5449 4d45 2829 2827 3231 3a33   IS_TIME()('21:3
+00016990: 3027 290a 2020 2020 2020 2020 2864 6174  0').        (dat
+000169a0: 6574 696d 652e 7469 6d65 2832 312c 2033  etime.time(21, 3
+000169b0: 3029 2c20 4e6f 6e65 290a 2020 2020 2020  0), None).      
+000169c0: 2020 3e3e 3e20 4953 5f54 494d 4528 2928    >>> IS_TIME()(
+000169d0: 2732 312d 3330 2729 0a20 2020 2020 2020  '21-30').       
+000169e0: 2028 6461 7465 7469 6d65 2e74 696d 6528   (datetime.time(
+000169f0: 3231 2c20 3330 292c 204e 6f6e 6529 0a20  21, 30), None). 
+00016a00: 2020 2020 2020 203e 3e3e 2049 535f 5449         >>> IS_TI
+00016a10: 4d45 2829 2827 3231 2e33 3027 290a 2020  ME()('21.30').  
+00016a20: 2020 2020 2020 2864 6174 6574 696d 652e        (datetime.
+00016a30: 7469 6d65 2832 312c 2033 3029 2c20 4e6f  time(21, 30), No
+00016a40: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+00016a50: 4953 5f54 494d 4528 2928 2732 313a 3330  IS_TIME()('21:30
+00016a60: 3a35 3927 290a 2020 2020 2020 2020 2864  :59').        (d
+00016a70: 6174 6574 696d 652e 7469 6d65 2832 312c  atetime.time(21,
+00016a80: 2033 302c 2035 3929 2c20 4e6f 6e65 290a   30, 59), None).
+00016a90: 2020 2020 2020 2020 3e3e 3e20 4953 5f54          >>> IS_T
+00016aa0: 494d 4528 2928 2735 3a33 3027 290a 2020  IME()('5:30').  
+00016ab0: 2020 2020 2020 2864 6174 6574 696d 652e        (datetime.
+00016ac0: 7469 6d65 2835 2c20 3330 292c 204e 6f6e  time(5, 30), Non
+00016ad0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
+00016ae0: 535f 5449 4d45 2829 2827 353a 3330 2061  S_TIME()('5:30 a
+00016af0: 6d27 290a 2020 2020 2020 2020 2864 6174  m').        (dat
+00016b00: 6574 696d 652e 7469 6d65 2835 2c20 3330  etime.time(5, 30
+00016b10: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
+00016b20: 203e 3e3e 2049 535f 5449 4d45 2829 2827   >>> IS_TIME()('
+00016b30: 353a 3330 2070 6d27 290a 2020 2020 2020  5:30 pm').      
+00016b40: 2020 2864 6174 6574 696d 652e 7469 6d65    (datetime.time
+00016b50: 2831 372c 2033 3029 2c20 4e6f 6e65 290a  (17, 30), None).
+00016b60: 2020 2020 2020 2020 3e3e 3e20 4953 5f54          >>> IS_T
+00016b70: 494d 4528 2928 2735 3a33 3020 7768 6174  IME()('5:30 what
+00016b80: 6576 6572 2729 0a20 2020 2020 2020 2028  ever').        (
+00016b90: 2735 3a33 3020 7768 6174 6576 6572 272c  '5:30 whatever',
+00016ba0: 2027 656e 7465 7220 7469 6d65 2061 7320   'enter time as 
+00016bb0: 6868 3a6d 6d3a 7373 2028 7365 636f 6e64  hh:mm:ss (second
+00016bc0: 732c 2061 6d2c 2070 6d20 6f70 7469 6f6e  s, am, pm option
+00016bd0: 616c 2927 290a 2020 2020 2020 2020 3e3e  al)').        >>
+00016be0: 3e20 4953 5f54 494d 4528 2928 2735 3a33  > IS_TIME()('5:3
+00016bf0: 3020 3230 2729 0a20 2020 2020 2020 2028  0 20').        (
+00016c00: 2735 3a33 3020 3230 272c 2027 656e 7465  '5:30 20', 'ente
+00016c10: 7220 7469 6d65 2061 7320 6868 3a6d 6d3a  r time as hh:mm:
+00016c20: 7373 2028 7365 636f 6e64 732c 2061 6d2c  ss (seconds, am,
+00016c30: 2070 6d20 6f70 7469 6f6e 616c 2927 290a   pm optional)').
+00016c40: 2020 2020 2020 2020 3e3e 3e20 4953 5f54          >>> IS_T
+00016c50: 494d 4528 2928 2732 343a 3330 2729 0a20  IME()('24:30'). 
+00016c60: 2020 2020 2020 2028 2732 343a 3330 272c         ('24:30',
+00016c70: 2027 656e 7465 7220 7469 6d65 2061 7320   'enter time as 
+00016c80: 6868 3a6d 6d3a 7373 2028 7365 636f 6e64  hh:mm:ss (second
+00016c90: 732c 2061 6d2c 2070 6d20 6f70 7469 6f6e  s, am, pm option
+00016ca0: 616c 2927 290a 2020 2020 2020 2020 3e3e  al)').        >>
+00016cb0: 3e20 4953 5f54 494d 4528 2928 2732 313a  > IS_TIME()('21:
+00016cc0: 3630 2729 0a20 2020 2020 2020 2028 2732  60').        ('2
+00016cd0: 313a 3630 272c 2027 656e 7465 7220 7469  1:60', 'enter ti
+00016ce0: 6d65 2061 7320 6868 3a6d 6d3a 7373 2028  me as hh:mm:ss (
+00016cf0: 7365 636f 6e64 732c 2061 6d2c 2070 6d20  seconds, am, pm 
+00016d00: 6f70 7469 6f6e 616c 2927 290a 2020 2020  optional)').    
+00016d10: 2020 2020 3e3e 3e20 4953 5f54 494d 4528      >>> IS_TIME(
+00016d20: 2928 2732 313a 3330 3a3a 2729 0a20 2020  )('21:30::').   
+00016d30: 2020 2020 2028 2732 313a 3330 3a3a 272c       ('21:30::',
+00016d40: 2027 656e 7465 7220 7469 6d65 2061 7320   'enter time as 
+00016d50: 6868 3a6d 6d3a 7373 2028 7365 636f 6e64  hh:mm:ss (second
+00016d60: 732c 2061 6d2c 2070 6d20 6f70 7469 6f6e  s, am, pm option
+00016d70: 616c 2927 290a 2020 2020 2020 2020 3e3e  al)').        >>
+00016d80: 3e20 4953 5f54 494d 4528 2928 2727 290a  > IS_TIME()('').
+00016d90: 2020 2020 2020 2020 2827 272c 2027 656e          ('', 'en
+00016da0: 7465 7220 7469 6d65 2061 7320 6868 3a6d  ter time as hh:m
+00016db0: 6d3a 7373 2028 7365 636f 6e64 732c 2061  m:ss (seconds, a
+00016dc0: 6d2c 2070 6d20 6f70 7469 6f6e 616c 2927  m, pm optional)'
+00016dd0: 29c3 b90a 0a20 2020 2022 2222 0a0a 2020  )....    """..  
+00016de0: 2020 5245 4745 585f 5449 4d45 203d 2022    REGEX_TIME = "
+00016df0: 2828 3f50 3c68 3e5b 302d 395d 2b29 2928  ((?P<h>[0-9]+))(
+00016e00: 5b5e 302d 3920 5d2b 283f 503c 6d3e 5b30  [^0-9 ]+(?P<m>[0
+00016e10: 2d39 205d 2b29 293f 285b 5e30 2d39 6170  -9 ]+))?([^0-9ap
+00016e20: 205d 2b28 3f50 3c73 3e5b 302d 395d 2a29   ]+(?P<s>[0-9]*)
+00016e30: 293f 2828 3f50 3c64 3e5b 6170 5d6d 2929  )?((?P<d>[ap]m))
+00016e40: 3f22 0a0a 2020 2020 6465 6620 5f5f 696e  ?"..    def __in
+00016e50: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+00016e60: 6c66 2c20 6572 726f 725f 6d65 7373 6167  lf, error_messag
+00016e70: 653d 2245 6e74 6572 2074 696d 6520 6173  e="Enter time as
+00016e80: 2068 683a 6d6d 3a73 7320 2873 6563 6f6e   hh:mm:ss (secon
+00016e90: 6473 2c20 616d 2c20 706d 206f 7074 696f  ds, am, pm optio
+00016ea0: 6e61 6c29 220a 2020 2020 293a 0a20 2020  nal)".    ):.   
+00016eb0: 2020 2020 2073 656c 662e 6572 726f 725f       self.error_
+00016ec0: 6d65 7373 6167 6520 3d20 6572 726f 725f  message = error_
+00016ed0: 6d65 7373 6167 650a 0a20 2020 2064 6566  message..    def
+00016ee0: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
+00016ef0: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
+00016f00: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00016f10: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00016f20: 2069 7661 6c75 6520 3d20 7661 6c75 650a   ivalue = value.
+00016f30: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00016f40: 6520 3d20 7265 2e6d 6174 6368 2873 656c  e = re.match(sel
+00016f50: 662e 5245 4745 585f 5449 4d45 2c20 7661  f.REGEX_TIME, va
+00016f60: 6c75 652e 6c6f 7765 7228 2929 0a20 2020  lue.lower()).   
+00016f70: 2020 2020 2020 2020 2028 682c 206d 2c20           (h, m, 
+00016f80: 7329 203d 2028 696e 7428 7661 6c75 652e  s) = (int(value.
+00016f90: 6772 6f75 7028 2268 2229 292c 2030 2c20  group("h")), 0, 
+00016fa0: 3029 0a20 2020 2020 2020 2020 2020 2069  0).            i
+00016fb0: 6620 6e6f 7420 7661 6c75 652e 6772 6f75  f not value.grou
+00016fc0: 7028 226d 2229 2069 7320 4e6f 6e65 3a0a  p("m") is None:.
+00016fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fe0: 6d20 3d20 696e 7428 7661 6c75 652e 6772  m = int(value.gr
+00016ff0: 6f75 7028 226d 2229 290a 2020 2020 2020  oup("m")).      
+00017000: 2020 2020 2020 6966 206e 6f74 2076 616c        if not val
+00017010: 7565 2e67 726f 7570 2822 7322 2920 6973  ue.group("s") is
+00017020: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00017030: 2020 2020 2020 2073 203d 2069 6e74 2876         s = int(v
+00017040: 616c 7565 2e67 726f 7570 2822 7322 2929  alue.group("s"))
+00017050: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00017060: 7661 6c75 652e 6772 6f75 7028 2264 2229  value.group("d")
+00017070: 203d 3d20 2270 6d22 2061 6e64 2030 203c   == "pm" and 0 <
+00017080: 2068 203c 2031 323a 0a20 2020 2020 2020   h < 12:.       
+00017090: 2020 2020 2020 2020 2068 202b 3d20 3132           h += 12
+000170a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000170b0: 7661 6c75 652e 6772 6f75 7028 2264 2229  value.group("d")
+000170c0: 203d 3d20 2261 6d22 2061 6e64 2068 203d   == "am" and h =
+000170d0: 3d20 3132 3a0a 2020 2020 2020 2020 2020  = 12:.          
+000170e0: 2020 2020 2020 6820 3d20 300a 2020 2020        h = 0.    
+000170f0: 2020 2020 2020 2020 6966 206e 6f74 2028          if not (
+00017100: 6820 696e 2072 616e 6765 2832 3429 2061  h in range(24) a
+00017110: 6e64 206d 2069 6e20 7261 6e67 6528 3630  nd m in range(60
+00017120: 2920 616e 6420 7320 696e 2072 616e 6765  ) and s in range
+00017130: 2836 3029 293a 0a20 2020 2020 2020 2020  (60)):.         
+00017140: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00017150: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00017160: 2020 2020 2020 2020 2020 2020 2022 486f               "Ho
+00017170: 7572 7320 6f72 206d 696e 7574 6573 206f  urs or minutes o
+00017180: 7220 7365 636f 6e64 7320 6172 6520 6f75  r seconds are ou
+00017190: 7473 6964 6520 6f66 2061 6c6c 6f77 6564  tside of allowed
+000171a0: 2072 616e 6765 220a 2020 2020 2020 2020   range".        
+000171b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000171c0: 2020 2020 2020 7661 6c75 6520 3d20 6461        value = da
+000171d0: 7465 7469 6d65 2e74 696d 6528 682c 206d  tetime.time(h, m
+000171e0: 2c20 7329 0a20 2020 2020 2020 2020 2020  , s).           
+000171f0: 2072 6574 7572 6e20 7661 6c75 650a 2020   return value.  
+00017200: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00017210: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
+00017220: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+00017230: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+00017240: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00017250: 7272 6f72 5f6d 6573 7361 6765 2929 0a0a  rror_message))..
+00017260: 0a23 2041 2055 5443 2063 6c61 7373 2e0a  .# A UTC class..
+00017270: 636c 6173 7320 5554 4328 6461 7465 7469  class UTC(dateti
+00017280: 6d65 2e74 7a69 6e66 6f29 3a0a 2020 2020  me.tzinfo):.    
+00017290: 2222 2255 5443 2222 220a 0a20 2020 205a  """UTC"""..    Z
+000172a0: 4552 4f20 3d20 6461 7465 7469 6d65 2e74  ERO = datetime.t
+000172b0: 696d 6564 656c 7461 2830 290a 0a20 2020  imedelta(0)..   
+000172c0: 2064 6566 2075 7463 6f66 6673 6574 2873   def utcoffset(s
+000172d0: 656c 662c 2064 7429 3a0a 2020 2020 2020  elf, dt):.      
+000172e0: 2020 7265 7475 726e 2055 5443 2e5a 4552    return UTC.ZER
+000172f0: 4f0a 0a20 2020 2064 6566 2074 7a6e 616d  O..    def tznam
+00017300: 6528 7365 6c66 2c20 6474 293a 0a20 2020  e(self, dt):.   
+00017310: 2020 2020 2072 6574 7572 6e20 2255 5443       return "UTC
+00017320: 220a 0a20 2020 2064 6566 2064 7374 2873  "..    def dst(s
+00017330: 656c 662c 2064 7429 3a0a 2020 2020 2020  elf, dt):.      
+00017340: 2020 7265 7475 726e 2055 5443 2e5a 4552    return UTC.ZER
+00017350: 4f0a 0a0a 7574 6320 3d20 5554 4328 290a  O...utc = UTC().
+00017360: 0a0a 636c 6173 7320 4953 5f44 4154 4528  ..class IS_DATE(
+00017370: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
+00017380: 2222 220a 2020 2020 4578 616d 706c 6573  """.    Examples
+00017390: 3a0a 2020 2020 2020 2020 5573 6520 6173  :.        Use as
+000173a0: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+000173b0: 494e 5055 5428 5f74 7970 653d 2774 6578  INPUT(_type='tex
+000173c0: 7427 2c20 5f6e 616d 653d 276e 616d 6527  t', _name='name'
+000173d0: 2c20 7265 7175 6972 6573 3d49 535f 4441  , requires=IS_DA
+000173e0: 5445 2829 290a 0a20 2020 2064 6174 6520  TE())..    date 
+000173f0: 6861 7320 746f 2062 6520 696e 2074 6865  has to be in the
+00017400: 2049 534f 3839 3630 2066 6f72 6d61 7420   ISO8960 format 
+00017410: 5959 5959 2d4d 4d2d 4444 0a20 2020 2022  YYYY-MM-DD.    "
+00017420: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+00017430: 6974 5f5f 2873 656c 662c 2066 6f72 6d61  it__(self, forma
+00017440: 743d 2225 592d 256d 2d25 6422 2c20 6572  t="%Y-%m-%d", er
+00017450: 726f 725f 6d65 7373 6167 653d 2245 6e74  ror_message="Ent
+00017460: 6572 2064 6174 6520 6173 2025 2866 6f72  er date as %(for
+00017470: 6d61 7429 7322 293a 0a20 2020 2020 2020  mat)s"):.       
+00017480: 2073 656c 662e 666f 726d 6174 203d 2073   self.format = s
+00017490: 656c 662e 7472 616e 736c 6174 6f72 2866  elf.translator(f
+000174a0: 6f72 6d61 7429 0a20 2020 2020 2020 2073  ormat).        s
+000174b0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
+000174c0: 6520 3d20 7374 7228 6572 726f 725f 6d65  e = str(error_me
+000174d0: 7373 6167 6529 0a20 2020 2020 2020 2073  ssage).        s
+000174e0: 656c 662e 6578 7472 656d 6573 203d 207b  elf.extremes = {
+000174f0: 7d0a 0a20 2020 2064 6566 2076 616c 6964  }..    def valid
+00017500: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+00017510: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+00017520: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+00017530: 6e73 7461 6e63 6528 7661 6c75 652c 2064  nstance(value, d
+00017540: 6174 6574 696d 652e 6461 7465 293a 0a20  atetime.date):. 
+00017550: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017560: 6e20 7661 6c75 650a 2020 2020 2020 2020  n value.        
+00017570: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00017580: 2028 792c 206d 2c20 642c 2068 682c 206d   (y, m, d, hh, m
+00017590: 6d2c 2073 732c 2074 302c 2074 312c 2074  m, ss, t0, t1, t
+000175a0: 3229 203d 2074 696d 652e 7374 7270 7469  2) = time.strpti
+000175b0: 6d65 2876 616c 7565 2c20 7374 7228 7365  me(value, str(se
+000175c0: 6c66 2e66 6f72 6d61 7429 290a 2020 2020  lf.format)).    
+000175d0: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+000175e0: 6461 7465 7469 6d65 2e64 6174 6528 792c  datetime.date(y,
+000175f0: 206d 2c20 6429 0a20 2020 2020 2020 2020   m, d).         
+00017600: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
+00017610: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+00017620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017630: 2e65 7874 7265 6d65 732e 7570 6461 7465  .extremes.update
+00017640: 2849 535f 4441 5445 5449 4d45 2e6e 6963  (IS_DATETIME.nic
+00017650: 6528 7365 6c66 2e66 6f72 6d61 7429 290a  e(self.format)).
+00017660: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00017670: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+00017680: 7228 7365 6c66 2e74 7261 6e73 6c61 746f  r(self.translato
+00017690: 7228 7365 6c66 2e65 7272 6f72 5f6d 6573  r(self.error_mes
+000176a0: 7361 6765 2920 2520 7365 6c66 2e65 7874  sage) % self.ext
+000176b0: 7265 6d65 7329 0a0a 2020 2020 6465 6620  remes)..    def 
+000176c0: 666f 726d 6174 7465 7228 7365 6c66 2c20  formatter(self, 
+000176d0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+000176e0: 6966 2076 616c 7565 2069 7320 4e6f 6e65  if value is None
+000176f0: 206f 7220 7661 6c75 6520 3d3d 2022 223a   or value == "":
+00017700: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017710: 7572 6e20 4e6f 6e65 0a20 2020 2020 2020  urn None.       
+00017720: 2066 6f72 6d61 7420 3d20 7365 6c66 2e66   format = self.f
+00017730: 6f72 6d61 740a 2020 2020 2020 2020 7965  ormat.        ye
+00017740: 6172 203d 2076 616c 7565 2e79 6561 720a  ar = value.year.
+00017750: 2020 2020 2020 2020 7920 3d20 2225 2e34          y = "%.4
+00017760: 6922 2025 2079 6561 720a 2020 2020 2020  i" % year.      
+00017770: 2020 666f 726d 6174 203d 2066 6f72 6d61    format = forma
+00017780: 742e 7265 706c 6163 6528 2225 7922 2c20  t.replace("%y", 
+00017790: 795b 2d32 3a5d 290a 2020 2020 2020 2020  y[-2:]).        
+000177a0: 666f 726d 6174 203d 2066 6f72 6d61 742e  format = format.
+000177b0: 7265 706c 6163 6528 2225 5922 2c20 7929  replace("%Y", y)
+000177c0: 0a20 2020 2020 2020 2069 6620 7965 6172  .        if year
+000177d0: 203c 2031 3930 303a 0a20 2020 2020 2020   < 1900:.       
+000177e0: 2020 2020 2079 6561 7220 3d20 3230 3030       year = 2000
+000177f0: 0a20 2020 2020 2020 2064 203d 2064 6174  .        d = dat
+00017800: 6574 696d 652e 6461 7465 2879 6561 722c  etime.date(year,
+00017810: 2076 616c 7565 2e6d 6f6e 7468 2c20 7661   value.month, va
+00017820: 6c75 652e 6461 7929 0a20 2020 2020 2020  lue.day).       
+00017830: 2072 6574 7572 6e20 642e 7374 7266 7469   return d.strfti
+00017840: 6d65 2866 6f72 6d61 7429 0a0a 0a63 6c61  me(format)...cla
+00017850: 7373 2049 535f 4441 5445 5449 4d45 2856  ss IS_DATETIME(V
+00017860: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
+00017870: 2222 0a20 2020 2045 7861 6d70 6c65 733a  "".    Examples:
+00017880: 0a20 2020 2020 2020 2055 7365 2061 733a  .        Use as:
+00017890: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
+000178a0: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
+000178b0: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
+000178c0: 2072 6571 7569 7265 733d 4953 5f44 4154   requires=IS_DAT
+000178d0: 4554 494d 4528 2929 0a0a 2020 2020 6461  ETIME())..    da
+000178e0: 7465 7469 6d65 2068 6173 2074 6f20 6265  tetime has to be
+000178f0: 2069 6e20 7468 6520 4953 4f38 3936 3020   in the ISO8960 
+00017900: 666f 726d 6174 2059 5959 592d 4d4d 2d44  format YYYY-MM-D
+00017910: 4420 6868 3a6d 6d3a 7373 0a20 2020 2074  D hh:mm:ss.    t
+00017920: 696d 657a 6f6d 6520 6d75 7374 2062 6520  imezome must be 
+00017930: 4e6f 6e65 206f 7220 6120 7079 747a 2e74  None or a pytz.t
+00017940: 696d 657a 6f6e 6528 2241 6d65 7269 6361  imezone("America
+00017950: 2f43 6869 6361 676f 2229 206f 626a 6563  /Chicago") objec
+00017960: 740a 2020 2020 2222 220a 0a20 2020 2069  t.    """..    i
+00017970: 736f 6461 7465 7469 6d65 203d 2022 2559  sodatetime = "%Y
+00017980: 2d25 6d2d 2564 2025 483a 254d 3a25 5322  -%m-%d %H:%M:%S"
+00017990: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+000179a0: 686f 640a 2020 2020 6465 6620 6e69 6365  hod.    def nice
+000179b0: 2866 6f72 6d61 7429 3a0a 2020 2020 2020  (format):.      
+000179c0: 2020 636f 6465 203d 2028 0a20 2020 2020    code = (.     
+000179d0: 2020 2020 2020 2028 2225 5922 2c20 2231         ("%Y", "1
+000179e0: 3936 3322 292c 0a20 2020 2020 2020 2020  963"),.         
+000179f0: 2020 2028 2225 7922 2c20 2236 3322 292c     ("%y", "63"),
+00017a00: 0a20 2020 2020 2020 2020 2020 2028 2225  .            ("%
+00017a10: 6422 2c20 2232 3822 292c 0a20 2020 2020  d", "28"),.     
+00017a20: 2020 2020 2020 2028 2225 6d22 2c20 2230         ("%m", "0
+00017a30: 3822 292c 0a20 2020 2020 2020 2020 2020  8"),.           
+00017a40: 2028 2225 6222 2c20 2241 7567 2229 2c0a   ("%b", "Aug"),.
+00017a50: 2020 2020 2020 2020 2020 2020 2822 2542              ("%B
+00017a60: 222c 2022 4175 6775 7374 2229 2c0a 2020  ", "August"),.  
+00017a70: 2020 2020 2020 2020 2020 2822 2548 222c            ("%H",
+00017a80: 2022 3134 2229 2c0a 2020 2020 2020 2020   "14"),.        
+00017a90: 2020 2020 2822 2549 222c 2022 3032 2229      ("%I", "02")
+00017aa0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+00017ab0: 2570 222c 2022 504d 2229 2c0a 2020 2020  %p", "PM"),.    
+00017ac0: 2020 2020 2020 2020 2822 254d 222c 2022          ("%M", "
+00017ad0: 3330 2229 2c0a 2020 2020 2020 2020 2020  30"),.          
+00017ae0: 2020 2822 2553 222c 2022 3539 2229 2c0a    ("%S", "59"),.
+00017af0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00017b00: 2020 666f 7220 612c 2062 2069 6e20 636f    for a, b in co
+00017b10: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
+00017b20: 666f 726d 6174 203d 2066 6f72 6d61 742e  format = format.
+00017b30: 7265 706c 6163 6528 612c 2062 290a 2020  replace(a, b).  
+00017b40: 2020 2020 2020 7265 7475 726e 2064 6963        return dic
+00017b50: 7428 666f 726d 6174 3d66 6f72 6d61 7429  t(format=format)
+00017b60: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00017b70: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
+00017b80: 2c0a 2020 2020 2020 2020 666f 726d 6174  ,.        format
+00017b90: 3d22 2559 2d25 6d2d 2564 2025 483a 254d  ="%Y-%m-%d %H:%M
+00017ba0: 3a25 5322 2c0a 2020 2020 2020 2020 6572  :%S",.        er
+00017bb0: 726f 725f 6d65 7373 6167 653d 2245 6e74  ror_message="Ent
+00017bc0: 6572 2064 6174 6520 616e 6420 7469 6d65  er date and time
+00017bd0: 2061 7320 2528 666f 726d 6174 2973 222c   as %(format)s",
+00017be0: 0a20 2020 2020 2020 2074 696d 657a 6f6e  .        timezon
+00017bf0: 653d 4e6f 6e65 2c0a 2020 2020 293a 0a20  e=None,.    ):. 
+00017c00: 2020 2020 2020 2073 656c 662e 666f 726d         self.form
+00017c10: 6174 203d 2073 656c 662e 7472 616e 736c  at = self.transl
+00017c20: 6174 6f72 2866 6f72 6d61 7429 0a20 2020  ator(format).   
+00017c30: 2020 2020 2073 656c 662e 6572 726f 725f       self.error_
+00017c40: 6d65 7373 6167 6520 3d20 7374 7228 6572  message = str(er
+00017c50: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
+00017c60: 2020 2020 2073 656c 662e 6578 7472 656d       self.extrem
+00017c70: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
+00017c80: 7365 6c66 2e74 696d 657a 6f6e 6520 3d20  self.timezone = 
+00017c90: 7469 6d65 7a6f 6e65 0a0a 2020 2020 6465  timezone..    de
+00017ca0: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
+00017cb0: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
+00017cc0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+00017cd0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+00017ce0: 616c 7565 2c20 6461 7465 7469 6d65 2e64  alue, datetime.d
+00017cf0: 6174 6574 696d 6529 3a0a 2020 2020 2020  atetime):.      
+00017d00: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+00017d10: 7565 0a20 2020 2020 2020 2074 7279 3a0a  ue.        try:.
+00017d20: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00017d30: 656c 662e 666f 726d 6174 203d 3d20 7365  elf.format == se
+00017d40: 6c66 2e69 736f 6461 7465 7469 6d65 3a0a  lf.isodatetime:.
+00017d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d60: 7661 6c75 6520 3d20 7661 6c75 652e 7265  value = value.re
+00017d70: 706c 6163 6528 2254 222c 2022 2022 290a  place("T", " ").
+00017d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d90: 6966 206c 656e 2876 616c 7565 2920 3d3d  if len(value) ==
+00017da0: 2031 363a 0a20 2020 2020 2020 2020 2020   16:.           
+00017db0: 2020 2020 2020 2020 2076 616c 7565 202b           value +
+00017dc0: 3d20 223a 3030 220a 2020 2020 2020 2020  = ":00".        
+00017dd0: 2020 2020 2879 2c20 6d2c 2064 2c20 6868      (y, m, d, hh
+00017de0: 2c20 6d6d 2c20 7373 2c20 7430 2c20 7431  , mm, ss, t0, t1
+00017df0: 2c20 7432 2920 3d20 7469 6d65 2e73 7472  , t2) = time.str
+00017e00: 7074 696d 6528 7661 6c75 652c 2073 7472  ptime(value, str
+00017e10: 2873 656c 662e 666f 726d 6174 2929 0a20  (self.format)). 
+00017e20: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00017e30: 203d 2064 6174 6574 696d 652e 6461 7465   = datetime.date
+00017e40: 7469 6d65 2879 2c20 6d2c 2064 2c20 6868  time(y, m, d, hh
+00017e50: 2c20 6d6d 2c20 7373 290a 2020 2020 2020  , mm, ss).      
+00017e60: 2020 2020 2020 6966 2073 656c 662e 7469        if self.ti
+00017e70: 6d65 7a6f 6e65 2069 7320 6e6f 7420 4e6f  mezone is not No
+00017e80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00017e90: 2020 2020 2320 544f 444f 3a20 6874 7470      # TODO: http
+00017ea0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f77  s://github.com/w
+00017eb0: 6562 3270 792f 7765 6232 7079 2f69 7373  eb2py/web2py/iss
+00017ec0: 7565 732f 3130 3934 2028 7465 6d70 6f72  ues/1094 (tempor
+00017ed0: 6172 7920 736f 6c75 7469 6f6e 290a 2020  ary solution).  
+00017ee0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00017ef0: 6c75 6520 3d20 280a 2020 2020 2020 2020  lue = (.        
+00017f00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017f10: 2e74 696d 657a 6f6e 652e 6c6f 6361 6c69  .timezone.locali
+00017f20: 7a65 2876 616c 7565 292e 6173 7469 6d65  ze(value).astime
+00017f30: 7a6f 6e65 2875 7463 292e 7265 706c 6163  zone(utc).replac
+00017f40: 6528 747a 696e 666f 3d4e 6f6e 6529 0a20  e(tzinfo=None). 
+00017f50: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00017f60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017f70: 7572 6e20 7661 6c75 650a 2020 2020 2020  urn value.      
+00017f80: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00017f90: 2020 2020 2020 7365 6c66 2e65 7874 7265        self.extre
+00017fa0: 6d65 732e 7570 6461 7465 2849 535f 4441  mes.update(IS_DA
+00017fb0: 5445 5449 4d45 2e6e 6963 6528 7365 6c66  TETIME.nice(self
+00017fc0: 2e66 6f72 6d61 7429 290a 2020 2020 2020  .format)).      
+00017fd0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
+00017fe0: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
+00017ff0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
+00018000: 2e65 7272 6f72 5f6d 6573 7361 6765 2920  .error_message) 
+00018010: 2520 7365 6c66 2e65 7874 7265 6d65 7329  % self.extremes)
+00018020: 0a0a 2020 2020 6465 6620 666f 726d 6174  ..    def format
+00018030: 7465 7228 7365 6c66 2c20 7661 6c75 6529  ter(self, value)
+00018040: 3a0a 2020 2020 2020 2020 6966 2076 616c  :.        if val
+00018050: 7565 2069 7320 4e6f 6e65 206f 7220 7661  ue is None or va
+00018060: 6c75 6520 3d3d 2022 223a 0a20 2020 2020  lue == "":.     
+00018070: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00018080: 6e65 0a20 2020 2020 2020 2066 6f72 6d61  ne.        forma
+00018090: 7420 3d20 7365 6c66 2e66 6f72 6d61 740a  t = self.format.
+000180a0: 2020 2020 2020 2020 7965 6172 203d 2076          year = v
+000180b0: 616c 7565 2e79 6561 720a 2020 2020 2020  alue.year.      
+000180c0: 2020 7920 3d20 2225 2e34 6922 2025 2079    y = "%.4i" % y
+000180d0: 6561 720a 2020 2020 2020 2020 666f 726d  ear.        form
+000180e0: 6174 203d 2066 6f72 6d61 742e 7265 706c  at = format.repl
+000180f0: 6163 6528 2225 7922 2c20 795b 2d32 3a5d  ace("%y", y[-2:]
+00018100: 290a 2020 2020 2020 2020 666f 726d 6174  ).        format
+00018110: 203d 2066 6f72 6d61 742e 7265 706c 6163   = format.replac
+00018120: 6528 2225 5922 2c20 7929 0a20 2020 2020  e("%Y", y).     
+00018130: 2020 2069 6620 7965 6172 203c 2031 3930     if year < 190
+00018140: 303a 0a20 2020 2020 2020 2020 2020 2079  0:.            y
+00018150: 6561 7220 3d20 3230 3030 0a20 2020 2020  ear = 2000.     
+00018160: 2020 2064 203d 2064 6174 6574 696d 652e     d = datetime.
+00018170: 6461 7465 7469 6d65 280a 2020 2020 2020  datetime(.      
+00018180: 2020 2020 2020 7965 6172 2c20 7661 6c75        year, valu
+00018190: 652e 6d6f 6e74 682c 2076 616c 7565 2e64  e.month, value.d
+000181a0: 6179 2c20 7661 6c75 652e 686f 7572 2c20  ay, value.hour, 
+000181b0: 7661 6c75 652e 6d69 6e75 7465 2c20 7661  value.minute, va
+000181c0: 6c75 652e 7365 636f 6e64 0a20 2020 2020  lue.second.     
+000181d0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+000181e0: 7365 6c66 2e74 696d 657a 6f6e 6520 6973  self.timezone is
+000181f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00018200: 2020 2020 2020 2064 203d 2064 2e72 6570         d = d.rep
+00018210: 6c61 6365 2874 7a69 6e66 6f3d 7574 6329  lace(tzinfo=utc)
+00018220: 2e61 7374 696d 657a 6f6e 6528 7365 6c66  .astimezone(self
+00018230: 2e74 696d 657a 6f6e 6529 0a20 2020 2020  .timezone).     
+00018240: 2020 2072 6574 7572 6e20 642e 7374 7266     return d.strf
+00018250: 7469 6d65 2866 6f72 6d61 7429 0a0a 0a63  time(format)...c
+00018260: 6c61 7373 2049 535f 4441 5445 5f49 4e5f  lass IS_DATE_IN_
+00018270: 5241 4e47 4528 4953 5f44 4154 4529 3a0a  RANGE(IS_DATE):.
+00018280: 2020 2020 2222 220a 2020 2020 4578 616d      """.    Exam
+00018290: 706c 6573 3a0a 2020 2020 2020 2020 5573  ples:.        Us
+000182a0: 6520 6173 3a3a 0a0a 2020 2020 2020 2020  e as::..        
+000182b0: 2020 2020 3e3e 3e20 7620 3d20 4953 5f44      >>> v = IS_D
+000182c0: 4154 455f 494e 5f52 414e 4745 286d 696e  ATE_IN_RANGE(min
+000182d0: 696d 756d 3d64 6174 6574 696d 652e 6461  imum=datetime.da
+000182e0: 7465 2832 3030 382c 312c 3129 2c20 5c0a  te(2008,1,1), \.
+000182f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018310: 2020 2020 206d 6178 696d 756d 3d64 6174       maximum=dat
+00018320: 6574 696d 652e 6461 7465 2832 3030 392c  etime.date(2009,
+00018330: 3132 2c33 3129 2c20 5c0a 2020 2020 2020  12,31), \.      
+00018340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018350: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00018360: 6f72 6d61 743d 2225 6d2f 2564 2f25 5922  ormat="%m/%d/%Y"
+00018370: 2c65 7272 6f72 5f6d 6573 7361 6765 3d22  ,error_message="
+00018380: 4f6f 7073 2229 0a0a 2020 2020 2020 2020  Oops")..        
+00018390: 2020 2020 3e3e 3e20 7628 2730 332f 3033      >>> v('03/03
+000183a0: 2f32 3030 3827 290a 2020 2020 2020 2020  /2008').        
+000183b0: 2020 2020 2864 6174 6574 696d 652e 6461      (datetime.da
+000183c0: 7465 2832 3030 382c 2033 2c20 3329 2c20  te(2008, 3, 3), 
+000183d0: 4e6f 6e65 290a 0a20 2020 2020 2020 2020  None)..         
+000183e0: 2020 203e 3e3e 2076 2827 3033 2f30 332f     >>> v('03/03/
+000183f0: 3230 3130 2729 0a20 2020 2020 2020 2020  2010').         
+00018400: 2020 2028 2730 332f 3033 2f32 3031 3027     ('03/03/2010'
+00018410: 2c20 276f 6f70 7327 290a 0a20 2020 2020  , 'oops')..     
+00018420: 2020 2020 2020 203e 3e3e 2076 2864 6174         >>> v(dat
+00018430: 6574 696d 652e 6461 7465 2832 3030 382c  etime.date(2008,
+00018440: 332c 3329 290a 2020 2020 2020 2020 2020  3,3)).          
+00018450: 2020 2864 6174 6574 696d 652e 6461 7465    (datetime.date
+00018460: 2832 3030 382c 2033 2c20 3329 2c20 4e6f  (2008, 3, 3), No
+00018470: 6e65 290a 0a20 2020 2020 2020 2020 2020  ne)..           
+00018480: 203e 3e3e 2076 2864 6174 6574 696d 652e   >>> v(datetime.
+00018490: 6461 7465 2832 3031 302c 332c 3329 290a  date(2010,3,3)).
+000184a0: 2020 2020 2020 2020 2020 2020 2864 6174              (dat
+000184b0: 6574 696d 652e 6461 7465 2832 3031 302c  etime.date(2010,
+000184c0: 2033 2c20 3329 2c20 276f 6f70 7327 290a   3, 3), 'oops').
+000184d0: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
+000184e0: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
+000184f0: 2020 2020 7365 6c66 2c20 6d69 6e69 6d75      self, minimu
+00018500: 6d3d 4e6f 6e65 2c20 6d61 7869 6d75 6d3d  m=None, maximum=
+00018510: 4e6f 6e65 2c20 666f 726d 6174 3d22 2559  None, format="%Y
+00018520: 2d25 6d2d 2564 222c 2065 7272 6f72 5f6d  -%m-%d", error_m
+00018530: 6573 7361 6765 3d4e 6f6e 650a 2020 2020  essage=None.    
+00018540: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00018550: 6d69 6e69 6d75 6d20 3d20 6d69 6e69 6d75  minimum = minimu
+00018560: 6d0a 2020 2020 2020 2020 7365 6c66 2e6d  m.        self.m
+00018570: 6178 696d 756d 203d 206d 6178 696d 756d  aximum = maximum
+00018580: 0a20 2020 2020 2020 2069 6620 6572 726f  .        if erro
+00018590: 725f 6d65 7373 6167 6520 6973 204e 6f6e  r_message is Non
+000185a0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+000185b0: 6620 6d69 6e69 6d75 6d20 6973 204e 6f6e  f minimum is Non
+000185c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000185d0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+000185e0: 203d 2022 456e 7465 7220 6461 7465 206f   = "Enter date o
+000185f0: 6e20 6f72 2062 6566 6f72 6520 2528 6d61  n or before %(ma
+00018600: 7829 7322 0a20 2020 2020 2020 2020 2020  x)s".           
+00018610: 2065 6c69 6620 6d61 7869 6d75 6d20 6973   elif maximum is
+00018620: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00018630: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00018640: 7361 6765 203d 2022 456e 7465 7220 6461  sage = "Enter da
+00018650: 7465 206f 6e20 6f72 2061 6674 6572 2025  te on or after %
+00018660: 286d 696e 2973 220a 2020 2020 2020 2020  (min)s".        
+00018670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00018680: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00018690: 6d65 7373 6167 6520 3d20 2245 6e74 6572  message = "Enter
+000186a0: 2064 6174 6520 696e 2072 616e 6765 2025   date in range %
+000186b0: 286d 696e 2973 2025 286d 6178 2973 220a  (min)s %(max)s".
+000186c0: 2020 2020 2020 2020 4953 5f44 4154 452e          IS_DATE.
+000186d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2066  __init__(self, f
+000186e0: 6f72 6d61 743d 666f 726d 6174 2c20 6572  ormat=format, er
+000186f0: 726f 725f 6d65 7373 6167 653d 6572 726f  ror_message=erro
+00018700: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
+00018710: 2020 2073 656c 662e 6578 7472 656d 6573     self.extremes
+00018720: 203d 2064 6963 7428 6d69 6e3d 7365 6c66   = dict(min=self
+00018730: 2e66 6f72 6d61 7474 6572 286d 696e 696d  .formatter(minim
+00018740: 756d 292c 206d 6178 3d73 656c 662e 666f  um), max=self.fo
+00018750: 726d 6174 7465 7228 6d61 7869 6d75 6d29  rmatter(maximum)
+00018760: 290a 0a20 2020 2064 6566 2076 616c 6964  )..    def valid
+00018770: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+00018780: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+00018790: 3a0a 2020 2020 2020 2020 7661 6c75 6520  :.        value 
+000187a0: 3d20 4953 5f44 4154 452e 7661 6c69 6461  = IS_DATE.valida
+000187b0: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
+000187c0: 7265 636f 7264 5f69 643d 4e6f 6e65 290a  record_id=None).
+000187d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000187e0: 6d69 6e69 6d75 6d20 616e 6420 7365 6c66  minimum and self
+000187f0: 2e6d 696e 696d 756d 203e 2076 616c 7565  .minimum > value
+00018800: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00018810: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+00018820: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+00018830: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+00018840: 6573 7361 6765 2920 2520 7365 6c66 2e65  essage) % self.e
+00018850: 7874 7265 6d65 7329 0a20 2020 2020 2020  xtremes).       
+00018860: 2069 6620 7365 6c66 2e6d 6178 696d 756d   if self.maximum
+00018870: 2061 6e64 2076 616c 7565 203e 2073 656c   and value > sel
+00018880: 662e 6d61 7869 6d75 6d3a 0a20 2020 2020  f.maximum:.     
+00018890: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000188a0: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
+000188b0: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+000188c0: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
+000188d0: 2025 2073 656c 662e 6578 7472 656d 6573   % self.extremes
+000188e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000188f0: 2076 616c 7565 0a0a 0a63 6c61 7373 2049   value...class I
+00018900: 535f 4441 5445 5449 4d45 5f49 4e5f 5241  S_DATETIME_IN_RA
+00018910: 4e47 4528 4953 5f44 4154 4554 494d 4529  NGE(IS_DATETIME)
+00018920: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
+00018930: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
+00018940: 5573 6520 6173 3a3a 0a20 2020 2020 2020  Use as::.       
+00018950: 2020 2020 203e 3e3e 2076 203d 2049 535f       >>> v = IS_
+00018960: 4441 5445 5449 4d45 5f49 4e5f 5241 4e47  DATETIME_IN_RANG
+00018970: 4528 5c0a 2020 2020 2020 2020 2020 2020  E(\.            
+00018980: 2020 2020 2020 2020 6d69 6e69 6d75 6d3d          minimum=
+00018990: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+000189a0: 6528 3230 3038 2c31 2c31 2c31 322c 3230  e(2008,1,1,12,20
+000189b0: 292c 205c 0a20 2020 2020 2020 2020 2020  ), \.           
+000189c0: 2020 2020 2020 2020 206d 6178 696d 756d           maximum
+000189d0: 3d64 6174 6574 696d 652e 6461 7465 7469  =datetime.dateti
+000189e0: 6d65 2832 3030 392c 3132 2c33 312c 3132  me(2009,12,31,12
+000189f0: 2c32 3029 2c20 5c0a 2020 2020 2020 2020  ,20), \.        
+00018a00: 2020 2020 2020 2020 2020 2020 666f 726d              form
+00018a10: 6174 3d22 256d 2f25 642f 2559 2025 483a  at="%m/%d/%Y %H:
+00018a20: 254d 222c 6572 726f 725f 6d65 7373 6167  %M",error_messag
+00018a30: 653d 224f 6f70 7322 290a 2020 2020 2020  e="Oops").      
+00018a40: 2020 2020 2020 3e3e 3e20 7628 2730 332f        >>> v('03/
+00018a50: 3033 2f32 3030 3820 3132 3a34 3027 290a  03/2008 12:40').
+00018a60: 2020 2020 2020 2020 2020 2020 2864 6174              (dat
+00018a70: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00018a80: 3030 382c 2033 2c20 332c 2031 322c 2034  008, 3, 3, 12, 4
+00018a90: 3029 2c20 4e6f 6e65 290a 0a20 2020 2020  0), None)..     
+00018aa0: 2020 2020 2020 203e 3e3e 2076 2827 3033         >>> v('03
+00018ab0: 2f30 332f 3230 3130 2031 303a 3334 2729  /03/2010 10:34')
+00018ac0: 0a20 2020 2020 2020 2020 2020 2028 2730  .            ('0
+00018ad0: 332f 3033 2f32 3031 3020 3130 3a33 3427  3/03/2010 10:34'
+00018ae0: 2c20 276f 6f70 7327 290a 0a20 2020 2020  , 'oops')..     
+00018af0: 2020 2020 2020 203e 3e3e 2076 2864 6174         >>> v(dat
+00018b00: 6574 696d 652e 6461 7465 7469 6d65 2832  etime.datetime(2
+00018b10: 3030 382c 332c 332c 302c 3029 290a 2020  008,3,3,0,0)).  
+00018b20: 2020 2020 2020 2020 2020 2864 6174 6574            (datet
+00018b30: 696d 652e 6461 7465 7469 6d65 2832 3030  ime.datetime(200
+00018b40: 382c 2033 2c20 332c 2030 2c20 3029 2c20  8, 3, 3, 0, 0), 
+00018b50: 4e6f 6e65 290a 0a20 2020 2020 2020 2020  None)..         
+00018b60: 2020 203e 3e3e 2076 2864 6174 6574 696d     >>> v(datetim
+00018b70: 652e 6461 7465 7469 6d65 2832 3031 302c  e.datetime(2010,
+00018b80: 332c 332c 302c 3029 290a 2020 2020 2020  3,3,0,0)).      
+00018b90: 2020 2020 2020 2864 6174 6574 696d 652e        (datetime.
+00018ba0: 6461 7465 7469 6d65 2832 3031 302c 2033  datetime(2010, 3
+00018bb0: 2c20 332c 2030 2c20 3029 2c20 276f 6f70  , 3, 0, 0), 'oop
+00018bc0: 7327 290a 0a20 2020 2022 2222 0a0a 2020  s')..    """..  
+00018bd0: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
+00018be0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00018bf0: 2020 2020 2020 6d69 6e69 6d75 6d3d 4e6f        minimum=No
+00018c00: 6e65 2c0a 2020 2020 2020 2020 6d61 7869  ne,.        maxi
+00018c10: 6d75 6d3d 4e6f 6e65 2c0a 2020 2020 2020  mum=None,.      
+00018c20: 2020 666f 726d 6174 3d22 2559 2d25 6d2d    format="%Y-%m-
+00018c30: 2564 2025 483a 254d 3a25 5322 2c0a 2020  %d %H:%M:%S",.  
+00018c40: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00018c50: 6167 653d 4e6f 6e65 2c0a 2020 2020 2020  age=None,.      
+00018c60: 2020 7469 6d65 7a6f 6e65 3d4e 6f6e 652c    timezone=None,
+00018c70: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00018c80: 7365 6c66 2e6d 696e 696d 756d 203d 206d  self.minimum = m
+00018c90: 696e 696d 756d 0a20 2020 2020 2020 2073  inimum.        s
+00018ca0: 656c 662e 6d61 7869 6d75 6d20 3d20 6d61  elf.maximum = ma
+00018cb0: 7869 6d75 6d0a 2020 2020 2020 2020 6966  ximum.        if
+00018cc0: 2065 7272 6f72 5f6d 6573 7361 6765 2069   error_message i
+00018cd0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00018ce0: 2020 2020 6966 206d 696e 696d 756d 2069      if minimum i
+00018cf0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00018d00: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00018d10: 7373 6167 6520 3d20 2245 6e74 6572 2064  ssage = "Enter d
+00018d20: 6174 6520 616e 6420 7469 6d65 206f 6e20  ate and time on 
+00018d30: 6f72 2062 6566 6f72 6520 2528 6d61 7829  or before %(max)
+00018d40: 7322 0a20 2020 2020 2020 2020 2020 2065  s".            e
+00018d50: 6c69 6620 6d61 7869 6d75 6d20 6973 204e  lif maximum is N
+00018d60: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00018d70: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00018d80: 6765 203d 2022 456e 7465 7220 6461 7465  ge = "Enter date
+00018d90: 2061 6e64 2074 696d 6520 6f6e 206f 7220   and time on or 
+00018da0: 6166 7465 7220 2528 6d69 6e29 7322 0a20  after %(min)s". 
+00018db0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00018dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018dd0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00018de0: 2022 456e 7465 7220 6461 7465 2061 6e64   "Enter date and
+00018df0: 2074 696d 6520 696e 2072 616e 6765 2025   time in range %
+00018e00: 286d 696e 2973 2025 286d 6178 2973 220a  (min)s %(max)s".
+00018e10: 2020 2020 2020 2020 4953 5f44 4154 4554          IS_DATET
+00018e20: 494d 452e 5f5f 696e 6974 5f5f 280a 2020  IME.__init__(.  
+00018e30: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00018e40: 666f 726d 6174 3d66 6f72 6d61 742c 2065  format=format, e
+00018e50: 7272 6f72 5f6d 6573 7361 6765 3d65 7272  rror_message=err
+00018e60: 6f72 5f6d 6573 7361 6765 2c20 7469 6d65  or_message, time
+00018e70: 7a6f 6e65 3d74 696d 657a 6f6e 650a 2020  zone=timezone.  
+00018e80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018e90: 7365 6c66 2e65 7874 7265 6d65 7320 3d20  self.extremes = 
+00018ea0: 6469 6374 286d 696e 3d73 656c 662e 666f  dict(min=self.fo
+00018eb0: 726d 6174 7465 7228 6d69 6e69 6d75 6d29  rmatter(minimum)
+00018ec0: 2c20 6d61 783d 7365 6c66 2e66 6f72 6d61  , max=self.forma
+00018ed0: 7474 6572 286d 6178 696d 756d 2929 0a0a  tter(maximum))..
+00018ee0: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+00018ef0: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+00018f00: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
+00018f10: 2020 2020 2020 2076 616c 7565 203d 2049         value = I
+00018f20: 535f 4441 5445 5449 4d45 2e76 616c 6964  S_DATETIME.valid
+00018f30: 6174 6528 7365 6c66 2c20 7661 6c75 652c  ate(self, value,
+00018f40: 2072 6563 6f72 645f 6964 3d4e 6f6e 6529   record_id=None)
+00018f50: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00018f60: 2e6d 696e 696d 756d 2061 6e64 2073 656c  .minimum and sel
+00018f70: 662e 6d69 6e69 6d75 6d20 3e20 7661 6c75  f.minimum > valu
+00018f80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00018f90: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
+00018fa0: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
+00018fb0: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
+00018fc0: 6d65 7373 6167 6529 2025 2073 656c 662e  message) % self.
+00018fd0: 6578 7472 656d 6573 290a 2020 2020 2020  extremes).      
+00018fe0: 2020 6966 2073 656c 662e 6d61 7869 6d75    if self.maximu
+00018ff0: 6d20 616e 6420 7661 6c75 6520 3e20 7365  m and value > se
+00019000: 6c66 2e6d 6178 696d 756d 3a0a 2020 2020  lf.maximum:.    
+00019010: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00019020: 6c69 6461 7469 6f6e 4572 726f 7228 7365  lidationError(se
+00019030: 6c66 2e74 7261 6e73 6c61 746f 7228 7365  lf.translator(se
+00019040: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
+00019050: 2920 2520 7365 6c66 2e65 7874 7265 6d65  ) % self.extreme
+00019060: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00019070: 6e20 7661 6c75 650a 0a0a 636c 6173 7320  n value...class 
+00019080: 4953 5f4c 4953 545f 4f46 2856 616c 6964  IS_LIST_OF(Valid
+00019090: 6174 6f72 293a 0a20 2020 2064 6566 205f  ator):.    def _
+000190a0: 5f69 6e69 745f 5f28 7365 6c66 2c20 6f74  _init__(self, ot
+000190b0: 6865 723d 4e6f 6e65 2c20 6d69 6e69 6d75  her=None, minimu
+000190c0: 6d3d 4e6f 6e65 2c20 6d61 7869 6d75 6d3d  m=None, maximum=
+000190d0: 4e6f 6e65 2c20 6572 726f 725f 6d65 7373  None, error_mess
+000190e0: 6167 653d 4e6f 6e65 293a 0a20 2020 2020  age=None):.     
+000190f0: 2020 2073 656c 662e 6f74 6865 7220 3d20     self.other = 
+00019100: 6f74 6865 720a 2020 2020 2020 2020 7365  other.        se
+00019110: 6c66 2e6d 696e 696d 756d 203d 206d 696e  lf.minimum = min
+00019120: 696d 756d 0a20 2020 2020 2020 2073 656c  imum.        sel
+00019130: 662e 6d61 7869 6d75 6d20 3d20 6d61 7869  f.maximum = maxi
+00019140: 6d75 6d0a 2020 2020 2020 2020 7365 6c66  mum.        self
+00019150: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
+00019160: 2065 7272 6f72 5f6d 6573 7361 6765 0a0a   error_message..
+00019170: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+00019180: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+00019190: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
+000191a0: 2020 2020 2020 2069 7661 6c75 6520 3d20         ivalue = 
+000191b0: 7661 6c75 650a 2020 2020 2020 2020 6966  value.        if
+000191c0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000191d0: 7661 6c75 652c 206c 6973 7429 3a0a 2020  value, list):.  
+000191e0: 2020 2020 2020 2020 2020 6976 616c 7565            ivalue
+000191f0: 203d 205b 6976 616c 7565 5d0a 2020 2020   = [ivalue].    
+00019200: 2020 2020 6976 616c 7565 203d 205b 6920      ivalue = [i 
+00019210: 666f 7220 6920 696e 2069 7661 6c75 6520  for i in ivalue 
+00019220: 6966 2073 7472 2869 292e 7374 7269 7028  if str(i).strip(
+00019230: 295d 0a20 2020 2020 2020 2069 6620 7365  )].        if se
+00019240: 6c66 2e6d 696e 696d 756d 2069 7320 6e6f  lf.minimum is no
+00019250: 7420 4e6f 6e65 2061 6e64 206c 656e 2869  t None and len(i
+00019260: 7661 6c75 6529 203c 2073 656c 662e 6d69  value) < self.mi
+00019270: 6e69 6d75 6d3a 0a20 2020 2020 2020 2020  nimum:.         
+00019280: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+00019290: 696f 6e45 7272 6f72 280a 2020 2020 2020  ionError(.      
+000192a0: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
+000192b0: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+000192c0: 7272 6f72 5f6d 6573 7361 6765 206f 7220  rror_message or 
+000192d0: 224d 696e 696d 756d 206c 656e 6774 6820  "Minimum length 
+000192e0: 6973 2025 286d 696e 2973 2229 0a20 2020  is %(min)s").   
+000192f0: 2020 2020 2020 2020 2020 2020 2025 2064               % d
+00019300: 6963 7428 6d69 6e3d 7365 6c66 2e6d 696e  ict(min=self.min
+00019310: 696d 756d 2c20 6d61 783d 7365 6c66 2e6d  imum, max=self.m
+00019320: 6178 696d 756d 290a 2020 2020 2020 2020  aximum).        
+00019330: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+00019340: 2073 656c 662e 6d61 7869 6d75 6d20 6973   self.maximum is
+00019350: 206e 6f74 204e 6f6e 6520 616e 6420 6c65   not None and le
+00019360: 6e28 6976 616c 7565 2920 3e20 7365 6c66  n(ivalue) > self
+00019370: 2e6d 6178 696d 756d 3a0a 2020 2020 2020  .maximum:.      
+00019380: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
+00019390: 6461 7469 6f6e 4572 726f 7228 0a20 2020  dationError(.   
+000193a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000193b0: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+000193c0: 662e 6572 726f 725f 6d65 7373 6167 6520  f.error_message 
+000193d0: 6f72 2022 4d61 7869 6d75 6d20 6c65 6e67  or "Maximum leng
+000193e0: 7468 2069 7320 2528 6d61 7829 7322 290a  th is %(max)s").
+000193f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019400: 2520 6469 6374 286d 696e 3d73 656c 662e  % dict(min=self.
+00019410: 6d69 6e69 6d75 6d2c 206d 6178 3d73 656c  minimum, max=sel
+00019420: 662e 6d61 7869 6d75 6d29 0a20 2020 2020  f.maximum).     
+00019430: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00019440: 206e 6577 5f76 616c 7565 203d 205b 5d0a   new_value = [].
+00019450: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+00019460: 7365 6c66 2e6f 7468 6572 0a20 2020 2020  self.other.     
+00019470: 2020 2069 6620 7365 6c66 2e6f 7468 6572     if self.other
+00019480: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00019490: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000194a0: 6f74 6865 722c 2028 6c69 7374 2c20 7475  other, (list, tu
+000194b0: 706c 6529 293a 0a20 2020 2020 2020 2020  ple)):.         
+000194c0: 2020 2020 2020 206f 7468 6572 203d 205b         other = [
+000194d0: 6f74 6865 725d 0a20 2020 2020 2020 2020  other].         
+000194e0: 2020 2066 6f72 2069 7465 6d20 696e 2069     for item in i
+000194f0: 7661 6c75 653a 0a20 2020 2020 2020 2020  value:.         
+00019500: 2020 2020 2020 2076 203d 2069 7465 6d0a         v = item.
+00019510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019520: 666f 7220 7661 6c69 6461 746f 7220 696e  for validator in
+00019530: 206f 7468 6572 3a0a 2020 2020 2020 2020   other:.        
+00019540: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+00019550: 7661 6c69 6461 746f 725f 6361 6c6c 6572  validator_caller
+00019560: 2876 616c 6964 6174 6f72 2c20 762c 2072  (validator, v, r
+00019570: 6563 6f72 645f 6964 290a 2020 2020 2020  ecord_id).      
+00019580: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+00019590: 6c75 652e 6170 7065 6e64 2876 290a 2020  lue.append(v).  
+000195a0: 2020 2020 2020 2020 2020 6976 616c 7565            ivalue
+000195b0: 203d 206e 6577 5f76 616c 7565 0a20 2020   = new_value.   
+000195c0: 2020 2020 2072 6574 7572 6e20 6976 616c       return ival
+000195d0: 7565 0a0a 0a63 6c61 7373 2049 535f 4c4f  ue...class IS_LO
+000195e0: 5745 5228 5661 6c69 6461 746f 7229 3a0a  WER(Validator):.
+000195f0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+00019600: 6572 7473 2074 6f20 6c6f 7765 7263 6173  erts to lowercas
+00019610: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00019620: 2049 535f 4c4f 5745 5228 2928 2741 4243   IS_LOWER()('ABC
+00019630: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
+00019640: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+00019650: 203e 3e3e 2049 535f 4c4f 5745 5228 2928   >>> IS_LOWER()(
+00019660: 27c3 9127 290a 2020 2020 2020 2020 2827  '..').        ('
+00019670: 5c5c 7863 335c 5c78 6231 272c 204e 6f6e  \\xc3\\xb1', Non
+00019680: 6529 0a0a 2020 2020 2222 220a 0a20 2020  e)..    """..   
+00019690: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+000196a0: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+000196b0: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+000196c0: 2020 2020 6361 7374 5f62 6163 6b20 3d20      cast_back = 
+000196d0: 6c61 6d62 6461 2078 3a20 780a 2020 2020  lambda x: x.    
+000196e0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000196f0: 6528 7661 6c75 652c 2073 7472 293a 0a20  e(value, str):. 
+00019700: 2020 2020 2020 2020 2020 2063 6173 745f             cast_
+00019710: 6261 636b 203d 2074 6f5f 6e61 7469 7665  back = to_native
+00019720: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+00019730: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+00019740: 6279 7465 7329 3a0a 2020 2020 2020 2020  bytes):.        
+00019750: 2020 2020 6361 7374 5f62 6163 6b20 3d20      cast_back = 
+00019760: 746f 5f62 7974 6573 0a20 2020 2020 2020  to_bytes.       
+00019770: 2076 616c 7565 203d 2074 6f5f 756e 6963   value = to_unic
+00019780: 6f64 6528 7661 6c75 6529 2e6c 6f77 6572  ode(value).lower
+00019790: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+000197a0: 6e20 6361 7374 5f62 6163 6b28 7661 6c75  n cast_back(valu
+000197b0: 6529 0a0a 0a63 6c61 7373 2049 535f 5550  e)...class IS_UP
+000197c0: 5045 5228 5661 6c69 6461 746f 7229 3a0a  PER(Validator):.
+000197d0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+000197e0: 6572 7473 2074 6f20 7570 7065 7263 6173  erts to uppercas
+000197f0: 653a 3a0a 0a20 2020 2020 2020 203e 3e3e  e::..        >>>
+00019800: 2049 535f 5550 5045 5228 2928 2761 6263   IS_UPPER()('abc
+00019810: 2729 0a20 2020 2020 2020 2028 2741 4243  ').        ('ABC
+00019820: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+00019830: 203e 3e3e 2049 535f 5550 5045 5228 2928   >>> IS_UPPER()(
+00019840: 27c3 b127 290a 2020 2020 2020 2020 2827  '..').        ('
+00019850: 5c5c 7863 335c 5c78 3931 272c 204e 6f6e  \\xc3\\x91', Non
+00019860: 6529 0a0a 2020 2020 2222 220a 0a20 2020  e)..    """..   
+00019870: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+00019880: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+00019890: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+000198a0: 2020 2020 6361 7374 5f62 6163 6b20 3d20      cast_back = 
+000198b0: 6c61 6d62 6461 2078 3a20 780a 2020 2020  lambda x: x.    
+000198c0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000198d0: 6528 7661 6c75 652c 2073 7472 293a 0a20  e(value, str):. 
+000198e0: 2020 2020 2020 2020 2020 2063 6173 745f             cast_
+000198f0: 6261 636b 203d 2074 6f5f 6e61 7469 7665  back = to_native
+00019900: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+00019910: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+00019920: 6279 7465 7329 3a0a 2020 2020 2020 2020  bytes):.        
+00019930: 2020 2020 6361 7374 5f62 6163 6b20 3d20      cast_back = 
+00019940: 746f 5f62 7974 6573 0a20 2020 2020 2020  to_bytes.       
+00019950: 2076 616c 7565 203d 2074 6f5f 756e 6963   value = to_unic
+00019960: 6f64 6528 7661 6c75 6529 2e75 7070 6572  ode(value).upper
+00019970: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+00019980: 6e20 6361 7374 5f62 6163 6b28 7661 6c75  n cast_back(valu
+00019990: 6529 0a0a 0a64 6566 2075 726c 6966 7928  e)...def urlify(
+000199a0: 732c 206d 6178 6c65 6e3d 3830 2c20 6b65  s, maxlen=80, ke
+000199b0: 6570 5f75 6e64 6572 7363 6f72 6573 3d46  ep_underscores=F
+000199c0: 616c 7365 293a 0a20 2020 2022 2222 0a20  alse):.    """. 
+000199d0: 2020 2043 6f6e 7665 7274 7320 696e 636f     Converts inco
+000199e0: 6d69 6e67 2073 7472 696e 6720 746f 2061  ming string to a
+000199f0: 2073 696d 706c 6966 6965 6420 4153 4349   simplified ASCI
+00019a00: 4920 7375 6273 6574 2e0a 2020 2020 6966  I subset..    if
+00019a10: 2028 6b65 6570 5f75 6e64 6572 7363 6f72   (keep_underscor
+00019a20: 6573 293a 2075 6e64 6572 7363 6f72 6573  es): underscores
+00019a30: 2061 7265 2072 6574 6169 6e65 6420 696e   are retained in
+00019a40: 2074 6865 2073 7472 696e 670a 2020 2020   the string.    
+00019a50: 656c 7365 3a20 756e 6465 7273 636f 7265  else: underscore
+00019a60: 7320 6172 6520 7472 616e 736c 6174 6564  s are translated
+00019a70: 2074 6f20 6879 7068 656e 7320 2864 6566   to hyphens (def
+00019a80: 6175 6c74 290a 2020 2020 2222 220a 2020  ault).    """.  
+00019a90: 2020 7320 3d20 746f 5f75 6e69 636f 6465    s = to_unicode
+00019aa0: 2873 2920 2023 2074 6f20 756e 6963 6f64  (s)  # to unicod
+00019ab0: 650a 2020 2020 7320 3d20 732e 6c6f 7765  e.    s = s.lowe
+00019ac0: 7228 2920 2023 2074 6f20 6c6f 7765 7263  r()  # to lowerc
+00019ad0: 6173 650a 2020 2020 7320 3d20 756e 6963  ase.    s = unic
+00019ae0: 6f64 6564 6174 612e 6e6f 726d 616c 697a  odedata.normaliz
+00019af0: 6528 224e 464b 4422 2c20 7329 2020 2320  e("NFKD", s)  # 
+00019b00: 7265 706c 6163 6520 7370 6563 6961 6c20  replace special 
+00019b10: 6368 6172 6163 7465 7273 0a20 2020 2073  characters.    s
+00019b20: 203d 2074 6f5f 6e61 7469 7665 2873 2c20   = to_native(s, 
+00019b30: 6368 6172 7365 743d 2261 7363 6969 222c  charset="ascii",
+00019b40: 2065 7272 6f72 733d 2269 676e 6f72 6522   errors="ignore"
+00019b50: 2920 2023 2065 6e63 6f64 6520 6173 2041  )  # encode as A
+00019b60: 5343 4949 0a20 2020 2073 203d 2072 652e  SCII.    s = re.
+00019b70: 7375 6228 7222 265c 772b 3f3b 222c 2022  sub(r"&\w+?;", "
+00019b80: 222c 2073 2920 2023 2073 7472 6970 2068  ", s)  # strip h
+00019b90: 746d 6c20 656e 7469 7469 6573 0a20 2020  tml entities.   
+00019ba0: 2069 6620 6b65 6570 5f75 6e64 6572 7363   if keep_undersc
+00019bb0: 6f72 6573 3a0a 2020 2020 2020 2020 7320  ores:.        s 
+00019bc0: 3d20 7265 2e73 7562 2872 225c 732b 222c  = re.sub(r"\s+",
+00019bd0: 2022 2d22 2c20 7329 2020 2320 7768 6974   "-", s)  # whit
+00019be0: 6573 7061 6365 2074 6f20 6879 7068 656e  espace to hyphen
+00019bf0: 730a 2020 2020 2020 2020 7320 3d20 7265  s.        s = re
+00019c00: 2e73 7562 2872 225b 5e5c 775c 2d5d 222c  .sub(r"[^\w\-]",
+00019c10: 2022 222c 2073 290a 2020 2020 2020 2020   "", s).        
+00019c20: 2320 7374 7269 7020 616c 6c20 6275 7420  # strip all but 
+00019c30: 616c 7068 616e 756d 6572 6963 2f75 6e64  alphanumeric/und
+00019c40: 6572 7363 6f72 652f 6879 7068 656e 0a20  erscore/hyphen. 
+00019c50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00019c60: 2073 203d 2072 652e 7375 6228 7222 5b5c   s = re.sub(r"[\
+00019c70: 735f 5d2b 222c 2022 2d22 2c20 7329 2020  s_]+", "-", s)  
+00019c80: 2320 7768 6974 6573 7061 6365 2026 2075  # whitespace & u
+00019c90: 6e64 6572 7363 6f72 6573 2074 6f20 6879  nderscores to hy
+00019ca0: 7068 656e 730a 2020 2020 2020 2020 7320  phens.        s 
+00019cb0: 3d20 7265 2e73 7562 2872 225b 5e61 2d7a  = re.sub(r"[^a-z
+00019cc0: 302d 395c 2d5d 222c 2022 222c 2073 2920  0-9\-]", "", s) 
+00019cd0: 2023 2073 7472 6970 2061 6c6c 2062 7574   # strip all but
+00019ce0: 2061 6c70 6861 6e75 6d65 7269 632f 6879   alphanumeric/hy
+00019cf0: 7068 656e 0a20 2020 2073 203d 2072 652e  phen.    s = re.
+00019d00: 7375 6228 7222 5b2d 5f5d 5b2d 5f5d 2b22  sub(r"[-_][-_]+"
+00019d10: 2c20 222d 222c 2073 2920 2023 2063 6f6c  , "-", s)  # col
+00019d20: 6c61 7073 6520 7374 7269 6e67 7320 6f66  lapse strings of
+00019d30: 2068 7970 6865 6e73 0a20 2020 2073 203d   hyphens.    s =
+00019d40: 2073 2e73 7472 6970 2822 2d22 2920 2023   s.strip("-")  #
+00019d50: 2072 656d 6f76 6520 6c65 6164 696e 6720   remove leading 
+00019d60: 616e 6420 7472 6169 6c69 6e67 2068 7970  and trailing hyp
+00019d70: 6865 6e73 0a20 2020 2072 6574 7572 6e20  hens.    return 
+00019d80: 735b 3a6d 6178 6c65 6e5d 2020 2320 656e  s[:maxlen]  # en
+00019d90: 666f 7263 6520 6d61 7869 6d75 6d20 6c65  force maximum le
+00019da0: 6e67 7468 0a0a 0a63 6c61 7373 2049 535f  ngth...class IS_
+00019db0: 534c 5547 2856 616c 6964 6174 6f72 293a  SLUG(Validator):
+00019dc0: 0a20 2020 2022 2222 0a20 2020 2063 6f6e  .    """.    con
+00019dd0: 7665 7274 7320 6172 6269 7472 6172 7920  verts arbitrary 
+00019de0: 7465 7874 2073 7472 696e 6720 746f 2061  text string to a
+00019df0: 2073 6c75 673a 3a0a 0a20 2020 2020 2020   slug::..       
+00019e00: 203e 3e3e 2049 535f 534c 5547 2829 2827   >>> IS_SLUG()('
+00019e10: 6162 6331 3233 2729 0a20 2020 2020 2020  abc123').       
+00019e20: 2028 2761 6263 3132 3327 2c20 4e6f 6e65   ('abc123', None
+00019e30: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00019e40: 5f53 4c55 4728 2928 2741 4243 3132 3327  _SLUG()('ABC123'
+00019e50: 290a 2020 2020 2020 2020 2827 6162 6331  ).        ('abc1
+00019e60: 3233 272c 204e 6f6e 6529 0a20 2020 2020  23', None).     
+00019e70: 2020 203e 3e3e 2049 535f 534c 5547 2829     >>> IS_SLUG()
+00019e80: 2827 6162 632d 3132 3327 290a 2020 2020  ('abc-123').    
+00019e90: 2020 2020 2827 6162 632d 3132 3327 2c20      ('abc-123', 
+00019ea0: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00019eb0: 3e20 4953 5f53 4c55 4728 2928 2761 6263  > IS_SLUG()('abc
+00019ec0: 2d2d 3132 3327 290a 2020 2020 2020 2020  --123').        
+00019ed0: 2827 6162 632d 3132 3327 2c20 4e6f 6e65  ('abc-123', None
+00019ee0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00019ef0: 5f53 4c55 4728 2928 2761 6263 2031 3233  _SLUG()('abc 123
+00019f00: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
+00019f10: 2d31 3233 272c 204e 6f6e 6529 0a20 2020  -123', None).   
+00019f20: 2020 2020 203e 3e3e 2049 535f 534c 5547       >>> IS_SLUG
+00019f30: 2829 2827 6162 635c 745f 3132 3327 290a  ()('abc\t_123').
+00019f40: 2020 2020 2020 2020 2827 6162 632d 3132          ('abc-12
+00019f50: 3327 2c20 4e6f 6e65 290a 2020 2020 2020  3', None).      
+00019f60: 2020 3e3e 3e20 4953 5f53 4c55 4728 2928    >>> IS_SLUG()(
+00019f70: 272d 6162 632d 2729 0a20 2020 2020 2020  '-abc-').       
+00019f80: 2028 2761 6263 272c 204e 6f6e 6529 0a20   ('abc', None). 
+00019f90: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
+00019fa0: 5547 2829 2827 2d2d 612d 2d62 2d2d 5f20  UG()('--a--b--_ 
+00019fb0: 2d63 2d2d 2729 0a20 2020 2020 2020 2028  -c--').        (
+00019fc0: 2761 2d62 2d63 272c 204e 6f6e 6529 0a20  'a-b-c', None). 
+00019fd0: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
+00019fe0: 5547 2829 2827 6162 6326 616d 703b 3132  UG()('abc&amp;12
+00019ff0: 3327 290a 2020 2020 2020 2020 2827 6162  3').        ('ab
+0001a000: 6331 3233 272c 204e 6f6e 6529 0a20 2020  c123', None).   
+0001a010: 2020 2020 203e 3e3e 2049 535f 534c 5547       >>> IS_SLUG
+0001a020: 2829 2827 6162 6326 616d 703b 3132 3326  ()('abc&amp;123&
+0001a030: 616d 703b 6465 6627 290a 2020 2020 2020  amp;def').      
+0001a040: 2020 2827 6162 6331 3233 6465 6627 2c20    ('abc123def', 
+0001a050: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+0001a060: 3e20 4953 5f53 4c55 4728 2928 27c3 b127  > IS_SLUG()('..'
+0001a070: 290a 2020 2020 2020 2020 2827 6e27 2c20  ).        ('n', 
+0001a080: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+0001a090: 3e20 4953 5f53 4c55 4728 6d61 786c 656e  > IS_SLUG(maxlen
+0001a0a0: 3d34 2928 2761 6263 3132 3327 290a 2020  =4)('abc123').  
+0001a0b0: 2020 2020 2020 2827 6162 6331 272c 204e        ('abc1', N
+0001a0c0: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
+0001a0d0: 2049 535f 534c 5547 2829 2827 6162 635f   IS_SLUG()('abc_
+0001a0e0: 3132 3327 290a 2020 2020 2020 2020 2827  123').        ('
+0001a0f0: 6162 632d 3132 3327 2c20 4e6f 6e65 290a  abc-123', None).
+0001a100: 2020 2020 2020 2020 3e3e 3e20 4953 5f53          >>> IS_S
+0001a110: 4c55 4728 6b65 6570 5f75 6e64 6572 7363  LUG(keep_undersc
+0001a120: 6f72 6573 3d46 616c 7365 2928 2761 6263  ores=False)('abc
+0001a130: 5f31 3233 2729 0a20 2020 2020 2020 2028  _123').        (
+0001a140: 2761 6263 2d31 3233 272c 204e 6f6e 6529  'abc-123', None)
+0001a150: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+0001a160: 534c 5547 286b 6565 705f 756e 6465 7273  SLUG(keep_unders
+0001a170: 636f 7265 733d 5472 7565 2928 2761 6263  cores=True)('abc
+0001a180: 5f31 3233 2729 0a20 2020 2020 2020 2028  _123').        (
+0001a190: 2761 6263 5f31 3233 272c 204e 6f6e 6529  'abc_123', None)
+0001a1a0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+0001a1b0: 534c 5547 2863 6865 636b 3d46 616c 7365  SLUG(check=False
+0001a1c0: 2928 2761 6263 2729 0a20 2020 2020 2020  )('abc').       
+0001a1d0: 2028 2761 6263 272c 204e 6f6e 6529 0a20   ('abc', None). 
+0001a1e0: 2020 2020 2020 203e 3e3e 2049 535f 534c         >>> IS_SL
+0001a1f0: 5547 2863 6865 636b 3d54 7275 6529 2827  UG(check=True)('
+0001a200: 6162 6327 290a 2020 2020 2020 2020 2827  abc').        ('
+0001a210: 6162 6327 2c20 4e6f 6e65 290a 2020 2020  abc', None).    
+0001a220: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
+0001a230: 6368 6563 6b3d 4661 6c73 6529 2827 6120  check=False)('a 
+0001a240: 6263 2729 0a20 2020 2020 2020 2028 2761  bc').        ('a
+0001a250: 2d62 6327 2c20 4e6f 6e65 290a 2020 2020  -bc', None).    
+0001a260: 2020 2020 3e3e 3e20 4953 5f53 4c55 4728      >>> IS_SLUG(
+0001a270: 6368 6563 6b3d 5472 7565 2928 2761 2062  check=True)('a b
+0001a280: 6327 290a 2020 2020 2020 2020 2827 6120  c').        ('a 
+0001a290: 6263 272c 2027 6d75 7374 2062 6520 736c  bc', 'must be sl
+0001a2a0: 7567 2729 0a20 2020 2022 2222 0a0a 2020  ug').    """..  
+0001a2b0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+0001a2c0: 2020 2020 6465 6620 7572 6c69 6679 2876      def urlify(v
+0001a2d0: 616c 7565 2c20 6d61 786c 656e 3d38 302c  alue, maxlen=80,
+0001a2e0: 206b 6565 705f 756e 6465 7273 636f 7265   keep_underscore
+0001a2f0: 733d 4661 6c73 6529 3a0a 2020 2020 2020  s=False):.      
+0001a300: 2020 7265 7475 726e 2075 726c 6966 7928    return urlify(
+0001a310: 7661 6c75 652c 206d 6178 6c65 6e2c 206b  value, maxlen, k
+0001a320: 6565 705f 756e 6465 7273 636f 7265 7329  eep_underscores)
+0001a330: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+0001a340: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
+0001a350: 2c0a 2020 2020 2020 2020 6d61 786c 656e  ,.        maxlen
+0001a360: 3d38 302c 0a20 2020 2020 2020 2063 6865  =80,.        che
+0001a370: 636b 3d46 616c 7365 2c0a 2020 2020 2020  ck=False,.      
+0001a380: 2020 6572 726f 725f 6d65 7373 6167 653d    error_message=
+0001a390: 224d 7573 7420 6265 2073 6c75 6722 2c0a  "Must be slug",.
+0001a3a0: 2020 2020 2020 2020 6b65 6570 5f75 6e64          keep_und
+0001a3b0: 6572 7363 6f72 6573 3d46 616c 7365 2c0a  erscores=False,.
+0001a3c0: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
+0001a3d0: 656c 662e 6d61 786c 656e 203d 206d 6178  elf.maxlen = max
+0001a3e0: 6c65 6e0a 2020 2020 2020 2020 7365 6c66  len.        self
+0001a3f0: 2e63 6865 636b 203d 2063 6865 636b 0a20  .check = check. 
+0001a400: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
+0001a410: 725f 6d65 7373 6167 6520 3d20 6572 726f  r_message = erro
+0001a420: 725f 6d65 7373 6167 650a 2020 2020 2020  r_message.      
+0001a430: 2020 7365 6c66 2e6b 6565 705f 756e 6465    self.keep_unde
+0001a440: 7273 636f 7265 7320 3d20 6b65 6570 5f75  rscores = keep_u
+0001a450: 6e64 6572 7363 6f72 6573 0a0a 2020 2020  nderscores..    
+0001a460: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
+0001a470: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
+0001a480: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
+0001a490: 2020 2069 6620 7365 6c66 2e63 6865 636b     if self.check
+0001a4a0: 2061 6e64 2076 616c 7565 2021 3d20 7572   and value != ur
+0001a4b0: 6c69 6679 2876 616c 7565 2c20 7365 6c66  lify(value, self
+0001a4c0: 2e6d 6178 6c65 6e2c 2073 656c 662e 6b65  .maxlen, self.ke
+0001a4d0: 6570 5f75 6e64 6572 7363 6f72 6573 293a  ep_underscores):
+0001a4e0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001a4f0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
+0001a500: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
+0001a510: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
+0001a520: 7373 6167 6529 290a 2020 2020 2020 2020  ssage)).        
+0001a530: 7265 7475 726e 2075 726c 6966 7928 7661  return urlify(va
+0001a540: 6c75 652c 2073 656c 662e 6d61 786c 656e  lue, self.maxlen
+0001a550: 2c20 7365 6c66 2e6b 6565 705f 756e 6465  , self.keep_unde
+0001a560: 7273 636f 7265 7329 0a0a 0a63 6c61 7373  rscores)...class
+0001a570: 2041 4e59 5f4f 4628 5661 6c69 6461 746f   ANY_OF(Validato
+0001a580: 7229 3a0a 2020 2020 2222 220a 2020 2020  r):.    """.    
+0001a590: 5465 7374 7320 6966 2061 6e79 206f 6620  Tests if any of 
+0001a5a0: 7468 6520 7661 6c69 6461 746f 7273 2069  the validators i
+0001a5b0: 6e20 6120 6c69 7374 2072 6574 7572 6e73  n a list returns
+0001a5c0: 2073 7563 6365 7373 6675 6c6c 793a 3a0a   successfully::.
+0001a5d0: 0a20 2020 2020 2020 203e 3e3e 2041 4e59  .        >>> ANY
+0001a5e0: 5f4f 4628 5b49 535f 454d 4149 4c28 292c  _OF([IS_EMAIL(),
+0001a5f0: 4953 5f41 4c50 4841 4e55 4d45 5249 4328  IS_ALPHANUMERIC(
+0001a600: 295d 2928 2761 4062 2e63 6f27 290a 2020  )])('a@b.co').  
+0001a610: 2020 2020 2020 2827 6140 622e 636f 272c        ('a@b.co',
+0001a620: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
+0001a630: 3e3e 2041 4e59 5f4f 4628 5b49 535f 454d  >> ANY_OF([IS_EM
+0001a640: 4149 4c28 292c 4953 5f41 4c50 4841 4e55  AIL(),IS_ALPHANU
+0001a650: 4d45 5249 4328 295d 2928 2761 6263 6f27  MERIC()])('abco'
+0001a660: 290a 2020 2020 2020 2020 2827 6162 636f  ).        ('abco
+0001a670: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+0001a680: 203e 3e3e 2041 4e59 5f4f 4628 5b49 535f   >>> ANY_OF([IS_
+0001a690: 454d 4149 4c28 292c 4953 5f41 4c50 4841  EMAIL(),IS_ALPHA
+0001a6a0: 4e55 4d45 5249 4328 295d 2928 2740 6162  NUMERIC()])('@ab
+0001a6b0: 2e63 6f27 290a 2020 2020 2020 2020 2827  .co').        ('
+0001a6c0: 4061 622e 636f 272c 2027 656e 7465 7220  @ab.co', 'enter 
+0001a6d0: 6f6e 6c79 206c 6574 7465 7273 2c20 6e75  only letters, nu
+0001a6e0: 6d62 6572 732c 2061 6e64 2075 6e64 6572  mbers, and under
+0001a6f0: 7363 6f72 6527 290a 2020 2020 2020 2020  score').        
+0001a700: 3e3e 3e20 414e 595f 4f46 285b 4953 5f41  >>> ANY_OF([IS_A
+0001a710: 4c50 4841 4e55 4d45 5249 4328 292c 4953  LPHANUMERIC(),IS
+0001a720: 5f45 4d41 494c 2829 5d29 2827 4061 622e  _EMAIL()])('@ab.
+0001a730: 636f 2729 0a20 2020 2020 2020 2028 2740  co').        ('@
+0001a740: 6162 2e63 6f27 2c20 2765 6e74 6572 2061  ab.co', 'enter a
+0001a750: 2076 616c 6964 2065 6d61 696c 2061 6464   valid email add
+0001a760: 7265 7373 2729 0a0a 2020 2020 2222 220a  ress')..    """.
+0001a770: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0001a780: 5f28 7365 6c66 2c20 7375 6273 2c20 6572  _(self, subs, er
+0001a790: 726f 725f 6d65 7373 6167 653d 4e6f 6e65  ror_message=None
+0001a7a0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0001a7b0: 7375 6273 203d 2073 7562 730a 2020 2020  subs = subs.    
+0001a7c0: 2020 2020 7365 6c66 2e65 7272 6f72 5f6d      self.error_m
+0001a7d0: 6573 7361 6765 203d 2065 7272 6f72 5f6d  essage = error_m
+0001a7e0: 6573 7361 6765 0a0a 2020 2020 6465 6620  essage..    def 
+0001a7f0: 7661 6c69 6461 7465 2873 656c 662c 2076  validate(self, v
+0001a800: 616c 7565 2c20 7265 636f 7264 5f69 643d  alue, record_id=
+0001a810: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
+0001a820: 6f72 2076 616c 6964 6174 6f72 2069 6e20  or validator in 
+0001a830: 7365 6c66 2e73 7562 733a 0a20 2020 2020  self.subs:.     
+0001a840: 2020 2020 2020 2076 2c20 6520 3d20 7661         v, e = va
+0001a850: 6c69 6461 746f 7228 7661 6c75 6529 0a20  lidator(value). 
+0001a860: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001a870: 7420 653a 0a20 2020 2020 2020 2020 2020  t e:.           
+0001a880: 2020 2020 2072 6574 7572 6e20 760a 2020       return v.  
+0001a890: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
+0001a8a0: 6461 7469 6f6e 4572 726f 7228 6529 0a0a  dationError(e)..
+0001a8b0: 2020 2020 6465 6620 666f 726d 6174 7465      def formatte
+0001a8c0: 7228 7365 6c66 2c20 7661 6c75 6529 3a0a  r(self, value):.
+0001a8d0: 2020 2020 2020 2020 2320 5573 6520 7468          # Use th
+0001a8e0: 6520 666f 726d 6174 7465 7220 6f66 2074  e formatter of t
+0001a8f0: 6865 2066 6972 7374 2073 7562 7661 6c69  he first subvali
+0001a900: 6461 746f 720a 2020 2020 2020 2020 2320  dator.        # 
+0001a910: 7468 6174 2076 616c 6964 6174 6573 2074  that validates t
+0001a920: 6865 2076 616c 7565 2061 6e64 2068 6173  he value and has
+0001a930: 2061 2066 6f72 6d61 7474 6572 0a20 2020   a formatter.   
+0001a940: 2020 2020 2066 6f72 2076 616c 6964 6174       for validat
+0001a950: 6f72 2069 6e20 7365 6c66 2e73 7562 733a  or in self.subs:
+0001a960: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001a970: 6861 7361 7474 7228 7661 6c69 6461 746f  hasattr(validato
+0001a980: 722c 2022 666f 726d 6174 7465 7222 2920  r, "formatter") 
+0001a990: 616e 6420 7661 6c69 6461 746f 7228 7661  and validator(va
+0001a9a0: 6c75 6529 5b31 5d20 6973 204e 6f6e 653a  lue)[1] is None:
+0001a9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a9c0: 2072 6574 7572 6e20 7661 6c69 6461 746f   return validato
+0001a9d0: 722e 666f 726d 6174 7465 7228 7661 6c75  r.formatter(valu
+0001a9e0: 6529 0a0a 0a63 6c61 7373 2049 535f 454d  e)...class IS_EM
+0001a9f0: 5054 595f 4f52 2856 616c 6964 6174 6f72  PTY_OR(Validator
+0001aa00: 293a 0a20 2020 2022 2222 0a20 2020 2044  ):.    """.    D
+0001aa10: 756d 6d79 2063 6c61 7373 2066 6f72 2074  ummy class for t
+0001aa20: 6573 7469 6e67 2049 535f 454d 5054 595f  esting IS_EMPTY_
+0001aa30: 4f52 3a3a 0a0a 2020 2020 2020 2020 3e3e  OR::..        >>
+0001aa40: 3e20 4953 5f45 4d50 5459 5f4f 5228 4953  > IS_EMPTY_OR(IS
+0001aa50: 5f45 4d41 494c 2829 2928 2761 6263 4064  _EMAIL())('abc@d
+0001aa60: 6566 2e63 6f6d 2729 0a20 2020 2020 2020  ef.com').       
+0001aa70: 2028 2761 6263 4064 6566 2e63 6f6d 272c   ('abc@def.com',
+0001aa80: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
+0001aa90: 3e3e 2049 535f 454d 5054 595f 4f52 2849  >> IS_EMPTY_OR(I
+0001aaa0: 535f 454d 4149 4c28 2929 2827 2020 2027  S_EMAIL())('   '
+0001aab0: 290a 2020 2020 2020 2020 284e 6f6e 652c  ).        (None,
+0001aac0: 204e 6f6e 6529 0a20 2020 2020 2020 203e   None).        >
+0001aad0: 3e3e 2049 535f 454d 5054 595f 4f52 2849  >> IS_EMPTY_OR(I
+0001aae0: 535f 454d 4149 4c28 292c 206e 756c 6c3d  S_EMAIL(), null=
+0001aaf0: 2761 6263 2729 2827 2020 2027 290a 2020  'abc')('   ').  
+0001ab00: 2020 2020 2020 2827 6162 6327 2c20 4e6f        ('abc', No
+0001ab10: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+0001ab20: 4953 5f45 4d50 5459 5f4f 5228 4953 5f45  IS_EMPTY_OR(IS_E
+0001ab30: 4d41 494c 2829 2c20 6e75 6c6c 3d27 6162  MAIL(), null='ab
+0001ab40: 6327 2c20 656d 7074 795f 7265 6765 783d  c', empty_regex=
+0001ab50: 2764 6566 2729 2827 6465 6627 290a 2020  'def')('def').  
+0001ab60: 2020 2020 2020 2827 6162 6327 2c20 4e6f        ('abc', No
+0001ab70: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
+0001ab80: 4953 5f45 4d50 5459 5f4f 5228 4953 5f45  IS_EMPTY_OR(IS_E
+0001ab90: 4d41 494c 2829 2928 2761 6263 2729 0a20  MAIL())('abc'). 
+0001aba0: 2020 2020 2020 2028 2761 6263 272c 2027         ('abc', '
+0001abb0: 656e 7465 7220 6120 7661 6c69 6420 656d  enter a valid em
+0001abc0: 6169 6c20 6164 6472 6573 7327 290a 2020  ail address').  
+0001abd0: 2020 2020 2020 3e3e 3e20 4953 5f45 4d50        >>> IS_EMP
+0001abe0: 5459 5f4f 5228 4953 5f45 4d41 494c 2829  TY_OR(IS_EMAIL()
+0001abf0: 2928 2720 6162 6320 2729 0a20 2020 2020  )(' abc ').     
+0001ac00: 2020 2028 2761 6263 272c 2027 656e 7465     ('abc', 'ente
+0001ac10: 7220 6120 7661 6c69 6420 656d 6169 6c20  r a valid email 
+0001ac20: 6164 6472 6573 7327 290a 2020 2020 2222  address').    ""
+0001ac30: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+0001ac40: 745f 5f28 7365 6c66 2c20 6f74 6865 722c  t__(self, other,
+0001ac50: 206e 756c 6c3d 4e6f 6e65 2c20 656d 7074   null=None, empt
+0001ac60: 795f 7265 6765 783d 4e6f 6e65 293a 0a20  y_regex=None):. 
+0001ac70: 2020 2020 2020 2028 7365 6c66 2e6f 7468         (self.oth
+0001ac80: 6572 2c20 7365 6c66 2e6e 756c 6c29 203d  er, self.null) =
+0001ac90: 2028 6f74 6865 722c 206e 756c 6c29 0a20   (other, null). 
+0001aca0: 2020 2020 2020 2069 6620 656d 7074 795f         if empty_
+0001acb0: 7265 6765 7820 6973 206e 6f74 204e 6f6e  regex is not Non
+0001acc0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0001acd0: 656c 662e 656d 7074 795f 7265 6765 7820  elf.empty_regex 
+0001ace0: 3d20 7265 2e63 6f6d 7069 6c65 2865 6d70  = re.compile(emp
+0001acf0: 7479 5f72 6567 6578 290a 2020 2020 2020  ty_regex).      
+0001ad00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001ad10: 2020 2020 7365 6c66 2e65 6d70 7479 5f72      self.empty_r
+0001ad20: 6567 6578 203d 204e 6f6e 650a 2020 2020  egex = None.    
+0001ad30: 2020 2020 6966 2068 6173 6174 7472 286f      if hasattr(o
+0001ad40: 7468 6572 2c20 226d 756c 7469 706c 6522  ther, "multiple"
+0001ad50: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+0001ad60: 656c 662e 6d75 6c74 6970 6c65 203d 206f  elf.multiple = o
+0001ad70: 7468 6572 2e6d 756c 7469 706c 650a 2020  ther.multiple.  
+0001ad80: 2020 2020 2020 6966 2068 6173 6174 7472        if hasattr
+0001ad90: 286f 7468 6572 2c20 226f 7074 696f 6e73  (other, "options
+0001ada0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0001adb0: 7365 6c66 2e6f 7074 696f 6e73 203d 2073  self.options = s
+0001adc0: 656c 662e 5f6f 7074 696f 6e73 0a0a 2020  elf._options..  
+0001add0: 2020 6465 6620 5f6f 7074 696f 6e73 2873    def _options(s
+0001ade0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+0001adf0: 6172 6773 293a 0a20 2020 2020 2020 206f  args):.        o
+0001ae00: 7074 696f 6e73 203d 2073 656c 662e 6f74  ptions = self.ot
+0001ae10: 6865 722e 6f70 7469 6f6e 7328 2a61 7267  her.options(*arg
+0001ae20: 732c 202a 2a6b 7761 7267 7329 0a20 2020  s, **kwargs).   
+0001ae30: 2020 2020 2069 6620 286e 6f74 206f 7074       if (not opt
+0001ae40: 696f 6e73 206f 7220 6f70 7469 6f6e 735b  ions or options[
+0001ae50: 305d 5b30 5d20 213d 2022 2229 2061 6e64  0][0] != "") and
+0001ae60: 206e 6f74 2073 656c 662e 6d75 6c74 6970   not self.multip
+0001ae70: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+0001ae80: 6f70 7469 6f6e 732e 696e 7365 7274 2830  options.insert(0
+0001ae90: 2c20 2822 222c 2022 2229 290a 2020 2020  , ("", "")).    
+0001aea0: 2020 2020 7265 7475 726e 206f 7074 696f      return optio
+0001aeb0: 6e73 0a0a 2020 2020 6465 6620 7365 745f  ns..    def set_
+0001aec0: 7365 6c66 5f69 6428 7365 6c66 2c20 6964  self_id(self, id
+0001aed0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
+0001aee0: 696e 7374 616e 6365 2873 656c 662e 6f74  instance(self.ot
+0001aef0: 6865 722c 2028 6c69 7374 2c20 7475 706c  her, (list, tupl
+0001af00: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+0001af10: 2066 6f72 2069 7465 6d20 696e 2073 656c   for item in sel
+0001af20: 662e 6f74 6865 723a 0a20 2020 2020 2020  f.other:.       
+0001af30: 2020 2020 2020 2020 2069 6620 6861 7361           if hasa
+0001af40: 7474 7228 6974 656d 2c20 2273 6574 5f73  ttr(item, "set_s
+0001af50: 656c 665f 6964 2229 3a0a 2020 2020 2020  elf_id"):.      
+0001af60: 2020 2020 2020 2020 2020 2020 2020 6974                it
+0001af70: 656d 2e73 6574 5f73 656c 665f 6964 2869  em.set_self_id(i
+0001af80: 6429 0a20 2020 2020 2020 2065 6c73 653a  d).        else:
+0001af90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001afa0: 6861 7361 7474 7228 7365 6c66 2e6f 7468  hasattr(self.oth
+0001afb0: 6572 2c20 2273 6574 5f73 656c 665f 6964  er, "set_self_id
+0001afc0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0001afd0: 2020 2020 7365 6c66 2e6f 7468 6572 2e73      self.other.s
+0001afe0: 6574 5f73 656c 665f 6964 2869 6429 0a0a  et_self_id(id)..
+0001aff0: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
+0001b000: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
+0001b010: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
+0001b020: 2020 2020 2020 2076 616c 7565 2c20 656d         value, em
+0001b030: 7074 7920 3d20 6973 5f65 6d70 7479 2876  pty = is_empty(v
+0001b040: 616c 7565 2c20 656d 7074 795f 7265 6765  alue, empty_rege
+0001b050: 783d 7365 6c66 2e65 6d70 7479 5f72 6567  x=self.empty_reg
+0001b060: 6578 290a 2020 2020 2020 2020 6966 2065  ex).        if e
+0001b070: 6d70 7479 3a0a 2020 2020 2020 2020 2020  mpty:.          
+0001b080: 2020 7265 7475 726e 2073 656c 662e 6e75    return self.nu
+0001b090: 6c6c 0a20 2020 2020 2020 2069 6620 6973  ll.        if is
+0001b0a0: 696e 7374 616e 6365 2873 656c 662e 6f74  instance(self.ot
+0001b0b0: 6865 722c 2028 6c69 7374 2c20 7475 706c  her, (list, tupl
+0001b0c0: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+0001b0d0: 2066 6f72 2069 7465 6d20 696e 2073 656c   for item in sel
+0001b0e0: 662e 6f74 6865 723a 0a20 2020 2020 2020  f.other:.       
+0001b0f0: 2020 2020 2020 2020 2076 616c 7565 203d           value =
+0001b100: 2076 616c 6964 6174 6f72 5f63 616c 6c65   validator_calle
+0001b110: 7228 6974 656d 2c20 7661 6c75 652c 2072  r(item, value, r
+0001b120: 6563 6f72 645f 6964 290a 2020 2020 2020  ecord_id).      
+0001b130: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+0001b140: 7565 0a20 2020 2020 2020 2072 6574 7572  ue.        retur
+0001b150: 6e20 7661 6c69 6461 746f 725f 6361 6c6c  n validator_call
+0001b160: 6572 2873 656c 662e 6f74 6865 722c 2076  er(self.other, v
+0001b170: 616c 7565 2c20 7265 636f 7264 5f69 6429  alue, record_id)
+0001b180: 0a0a 2020 2020 6465 6620 666f 726d 6174  ..    def format
+0001b190: 7465 7228 7365 6c66 2c20 7661 6c75 6529  ter(self, value)
+0001b1a0: 3a0a 2020 2020 2020 2020 6966 2068 6173  :.        if has
+0001b1b0: 6174 7472 2873 656c 662e 6f74 6865 722c  attr(self.other,
+0001b1c0: 2022 666f 726d 6174 7465 7222 293a 0a20   "formatter"):. 
+0001b1d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001b1e0: 6e20 7365 6c66 2e6f 7468 6572 2e66 6f72  n self.other.for
+0001b1f0: 6d61 7474 6572 2876 616c 7565 290a 2020  matter(value).  
+0001b200: 2020 2020 2020 7265 7475 726e 2076 616c        return val
+0001b210: 7565 0a0a 0a49 535f 4e55 4c4c 5f4f 5220  ue...IS_NULL_OR 
+0001b220: 3d20 4953 5f45 4d50 5459 5f4f 5220 2023  = IS_EMPTY_OR  #
+0001b230: 2066 6f72 2062 6163 6b77 6172 6420 636f   for backward co
+0001b240: 6d70 6174 6962 696c 6974 790a 0a0a 636c  mpatibility...cl
+0001b250: 6173 7320 434c 4541 4e55 5028 5661 6c69  ass CLEANUP(Vali
+0001b260: 6461 746f 7229 3a0a 2020 2020 2222 220a  dator):.    """.
+0001b270: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
+0001b280: 2020 2020 2020 5573 6520 6173 3a3a 0a0a        Use as::..
+0001b290: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
+0001b2a0: 5428 5f74 7970 653d 2774 6578 7427 2c20  T(_type='text', 
+0001b2b0: 5f6e 616d 653d 276e 616d 6527 2c20 7265  _name='name', re
+0001b2c0: 7175 6972 6573 3d43 4c45 414e 5550 2829  quires=CLEANUP()
+0001b2d0: 290a 0a20 2020 2072 656d 6f76 6573 2073  )..    removes s
+0001b2e0: 7065 6369 616c 2063 6861 7261 6374 6572  pecial character
+0001b2f0: 7320 6f6e 2076 616c 6964 6174 696f 6e0a  s on validation.
+0001b300: 2020 2020 2222 220a 0a20 2020 2052 4547      """..    REG
+0001b310: 4558 5f43 4c45 414e 5550 203d 2022 5b5e  EX_CLEANUP = "[^
+0001b320: 5c78 3039 5c78 3061 5c78 3064 5c78 3230  \x09\x0a\x0d\x20
+0001b330: 2d5c 7837 655d 220a 0a20 2020 2064 6566  -\x7e]"..    def
+0001b340: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+0001b350: 7265 6765 783d 4e6f 6e65 293a 0a20 2020  regex=None):.   
+0001b360: 2020 2020 2073 656c 662e 7265 6765 7820       self.regex 
+0001b370: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0001b380: 7265 2e63 6f6d 7069 6c65 2873 656c 662e  re.compile(self.
+0001b390: 5245 4745 585f 434c 4541 4e55 5029 2069  REGEX_CLEANUP) i
+0001b3a0: 6620 7265 6765 7820 6973 204e 6f6e 6520  f regex is None 
+0001b3b0: 656c 7365 2072 652e 636f 6d70 696c 6528  else re.compile(
+0001b3c0: 7265 6765 7829 0a20 2020 2020 2020 2029  regex).        )
+0001b3d0: 0a0a 2020 2020 6465 6620 7661 6c69 6461  ..    def valida
+0001b3e0: 7465 2873 656c 662c 2076 616c 7565 2c20  te(self, value, 
+0001b3f0: 7265 636f 7264 5f69 643d 4e6f 6e65 293a  record_id=None):
+0001b400: 0a20 2020 2020 2020 2076 203d 2073 656c  .        v = sel
+0001b410: 662e 7265 6765 782e 7375 6228 2222 2c20  f.regex.sub("", 
+0001b420: 7374 7228 7661 6c75 6529 2e73 7472 6970  str(value).strip
+0001b430: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+0001b440: 726e 2076 0a0a 0a64 6566 2070 626b 6466  rn v...def pbkdf
+0001b450: 325f 6865 7828 6461 7461 2c20 7361 6c74  2_hex(data, salt
+0001b460: 2c20 6974 6572 6174 696f 6e73 3d31 3030  , iterations=100
+0001b470: 302c 206b 6579 6c65 6e3d 3234 2c20 6861  0, keylen=24, ha
+0001b480: 7368 6675 6e63 3d4e 6f6e 6529 3a0a 2020  shfunc=None):.  
+0001b490: 2020 6861 7368 6675 6e63 203d 2068 6173    hashfunc = has
+0001b4a0: 6866 756e 6320 6f72 2068 6173 686c 6962  hfunc or hashlib
+0001b4b0: 2e73 6861 310a 2020 2020 686d 6163 203d  .sha1.    hmac =
+0001b4c0: 2068 6173 686c 6962 2e70 626b 6466 325f   hashlib.pbkdf2_
+0001b4d0: 686d 6163 280a 2020 2020 2020 2020 6861  hmac(.        ha
+0001b4e0: 7368 6675 6e63 2829 2e6e 616d 652c 2074  shfunc().name, t
+0001b4f0: 6f5f 6279 7465 7328 6461 7461 292c 2074  o_bytes(data), t
+0001b500: 6f5f 6279 7465 7328 7361 6c74 292c 2069  o_bytes(salt), i
+0001b510: 7465 7261 7469 6f6e 732c 206b 6579 6c65  terations, keyle
+0001b520: 6e0a 2020 2020 290a 2020 2020 7265 7475  n.    ).    retu
+0001b530: 726e 2062 696e 6173 6369 692e 6865 786c  rn binascii.hexl
+0001b540: 6966 7928 686d 6163 290a 0a0a 6465 6620  ify(hmac)...def 
+0001b550: 7369 6d70 6c65 5f68 6173 6828 7465 7874  simple_hash(text
+0001b560: 2c20 6b65 793d 2222 2c20 7361 6c74 3d22  , key="", salt="
+0001b570: 222c 2064 6967 6573 745f 616c 673d 226d  ", digest_alg="m
+0001b580: 6435 2229 3a0a 2020 2020 2222 2247 656e  d5"):.    """Gen
+0001b590: 6572 6174 6520 6861 7368 2077 6974 6820  erate hash with 
+0001b5a0: 7468 6520 6769 7665 6e20 7465 7874 2075  the given text u
+0001b5b0: 7369 6e67 2074 6865 2073 7065 6369 6669  sing the specifi
+0001b5c0: 6564 2064 6967 6573 7420 616c 676f 7269  ed digest algori
+0001b5d0: 7468 6d2e 2222 220a 2020 2020 7465 7874  thm.""".    text
+0001b5e0: 203d 2074 6f5f 6279 7465 7328 7465 7874   = to_bytes(text
+0001b5f0: 290a 2020 2020 6b65 7920 3d20 746f 5f62  ).    key = to_b
+0001b600: 7974 6573 286b 6579 290a 2020 2020 7361  ytes(key).    sa
+0001b610: 6c74 203d 2074 6f5f 6279 7465 7328 7361  lt = to_bytes(sa
+0001b620: 6c74 290a 2020 2020 6966 206e 6f74 2064  lt).    if not d
+0001b630: 6967 6573 745f 616c 673a 0a20 2020 2020  igest_alg:.     
+0001b640: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
+0001b650: 4572 726f 7228 2273 696d 706c 655f 6861  Error("simple_ha
+0001b660: 7368 2077 6974 6820 6469 6765 7374 5f61  sh with digest_a
+0001b670: 6c67 3d4e 6f6e 6522 290a 2020 2020 656c  lg=None").    el
+0001b680: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0001b690: 6528 6469 6765 7374 5f61 6c67 2c20 7374  e(digest_alg, st
+0001b6a0: 7229 3a20 2023 206d 616e 7561 6c20 6170  r):  # manual ap
+0001b6b0: 7072 6f61 6368 0a20 2020 2020 2020 2068  proach.        h
+0001b6c0: 203d 2064 6967 6573 745f 616c 6728 7465   = digest_alg(te
+0001b6d0: 7874 202b 206b 6579 202b 2073 616c 7429  xt + key + salt)
+0001b6e0: 0a20 2020 2065 6c69 6620 6469 6765 7374  .    elif digest
+0001b6f0: 5f61 6c67 2e73 7461 7274 7377 6974 6828  _alg.startswith(
+0001b700: 2270 626b 6466 3222 293a 2020 2320 6c61  "pbkdf2"):  # la
+0001b710: 7465 7374 2061 6e64 2063 6f6f 6c65 7374  test and coolest
+0001b720: 210a 2020 2020 2020 2020 6974 6572 6174  !.        iterat
+0001b730: 696f 6e73 2c20 6b65 796c 656e 2c20 616c  ions, keylen, al
+0001b740: 6720 3d20 6469 6765 7374 5f61 6c67 5b37  g = digest_alg[7
+0001b750: 3a2d 315d 2e73 706c 6974 2822 2c22 290a  :-1].split(",").
+0001b760: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+0001b770: 6f5f 6e61 7469 7665 280a 2020 2020 2020  o_native(.      
+0001b780: 2020 2020 2020 7062 6b64 6632 5f68 6578        pbkdf2_hex
+0001b790: 2874 6578 742c 2073 616c 742c 2069 6e74  (text, salt, int
+0001b7a0: 2869 7465 7261 7469 6f6e 7329 2c20 696e  (iterations), in
+0001b7b0: 7428 6b65 796c 656e 292c 2067 6574 5f64  t(keylen), get_d
+0001b7c0: 6967 6573 7428 616c 6729 290a 2020 2020  igest(alg)).    
+0001b7d0: 2020 2020 290a 2020 2020 656c 6966 206b      ).    elif k
+0001b7e0: 6579 3a20 2023 2075 7365 2068 6d61 630a  ey:  # use hmac.
+0001b7f0: 2020 2020 2020 2020 6469 6765 7374 5f61          digest_a
+0001b800: 6c67 203d 2067 6574 5f64 6967 6573 7428  lg = get_digest(
+0001b810: 6469 6765 7374 5f61 6c67 290a 2020 2020  digest_alg).    
+0001b820: 2020 2020 6820 3d20 686d 6163 2e6e 6577      h = hmac.new
+0001b830: 286b 6579 202b 2073 616c 742c 2074 6578  (key + salt, tex
+0001b840: 742c 2064 6967 6573 745f 616c 6729 0a20  t, digest_alg). 
+0001b850: 2020 2065 6c73 653a 2020 2320 636f 6d70     else:  # comp
+0001b860: 6174 6962 6c65 2077 6974 6820 7468 6972  atible with thir
+0001b870: 6420 7061 7274 7920 7379 7374 656d 730a  d party systems.
+0001b880: 2020 2020 2020 2020 6820 3d20 6765 745f          h = get_
+0001b890: 6469 6765 7374 2864 6967 6573 745f 616c  digest(digest_al
+0001b8a0: 6729 2829 0a20 2020 2020 2020 2068 2e75  g)().        h.u
+0001b8b0: 7064 6174 6528 7465 7874 202b 2073 616c  pdate(text + sal
+0001b8c0: 7429 0a20 2020 2072 6574 7572 6e20 682e  t).    return h.
+0001b8d0: 6865 7864 6967 6573 7428 290a 0a0a 6465  hexdigest()...de
+0001b8e0: 6620 6765 745f 6469 6765 7374 2876 616c  f get_digest(val
+0001b8f0: 7565 293a 0a20 2020 2022 2222 5265 7475  ue):.    """Retu
+0001b900: 726e 2061 2068 6173 686c 6962 2064 6967  rn a hashlib dig
+0001b910: 6573 7420 616c 676f 7269 7468 6d20 6672  est algorithm fr
+0001b920: 6f6d 2061 2073 7472 696e 672e 2222 220a  om a string.""".
+0001b930: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001b940: 6528 7661 6c75 652c 2073 7472 293a 0a20  e(value, str):. 
+0001b950: 2020 2020 2020 2076 616c 7565 203d 2076         value = v
+0001b960: 616c 7565 2e6c 6f77 6572 2829 0a20 2020  alue.lower().   
+0001b970: 2020 2020 2069 6620 7661 6c75 6520 6e6f       if value no
+0001b980: 7420 696e 2028 226d 6435 222c 2022 7368  t in ("md5", "sh
+0001b990: 6131 222c 2022 7368 6132 3234 222c 2022  a1", "sha224", "
+0001b9a0: 7368 6132 3536 222c 2022 7368 6133 3834  sha256", "sha384
+0001b9b0: 222c 2022 7368 6135 3132 2229 3a0a 2020  ", "sha512"):.  
+0001b9c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001b9d0: 5661 6c75 6545 7272 6f72 2822 496e 7661  ValueError("Inva
+0001b9e0: 6c69 6420 6469 6765 7374 2061 6c67 6f72  lid digest algor
+0001b9f0: 6974 686d 3a20 2573 2220 2520 7661 6c75  ithm: %s" % valu
+0001ba00: 6529 0a20 2020 2020 2020 2076 616c 7565  e).        value
+0001ba10: 203d 2067 6574 6174 7472 2868 6173 686c   = getattr(hashl
+0001ba20: 6962 2c20 7661 6c75 6529 0a20 2020 2072  ib, value).    r
+0001ba30: 6574 7572 6e20 7661 6c75 650a 0a0a 4449  eturn value...DI
+0001ba40: 4745 5354 5f41 4c47 5f42 595f 5349 5a45  GEST_ALG_BY_SIZE
+0001ba50: 203d 207b 0a20 2020 2031 3238 202f 2f20   = {.    128 // 
+0001ba60: 343a 2022 6d64 3522 2c0a 2020 2020 3136  4: "md5",.    16
+0001ba70: 3020 2f2f 2034 3a20 2273 6861 3122 2c0a  0 // 4: "sha1",.
+0001ba80: 2020 2020 3232 3420 2f2f 2034 3a20 2273      224 // 4: "s
+0001ba90: 6861 3232 3422 2c0a 2020 2020 3235 3620  ha224",.    256 
+0001baa0: 2f2f 2034 3a20 2273 6861 3235 3622 2c0a  // 4: "sha256",.
+0001bab0: 2020 2020 3338 3420 2f2f 2034 3a20 2273      384 // 4: "s
+0001bac0: 6861 3338 3422 2c0a 2020 2020 3531 3220  ha384",.    512 
+0001bad0: 2f2f 2034 3a20 2273 6861 3531 3222 2c0a  // 4: "sha512",.
+0001bae0: 7d0a 0a0a 636c 6173 7320 4c61 7a79 4372  }...class LazyCr
+0001baf0: 7970 7428 6f62 6a65 6374 293a 0a20 2020  ypt(object):.   
+0001bb00: 2022 2222 0a20 2020 2053 746f 7265 7320   """.    Stores 
+0001bb10: 6120 6c61 7a79 2070 6173 7377 6f72 6420  a lazy password 
+0001bb20: 6861 7368 0a20 2020 2022 2222 0a0a 2020  hash.    """..  
+0001bb30: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0001bb40: 656c 662c 2063 7279 7074 2c20 7061 7373  elf, crypt, pass
+0001bb50: 776f 7264 293a 0a20 2020 2020 2020 2022  word):.        "
+0001bb60: 2222 0a20 2020 2020 2020 2063 7279 7074  "".        crypt
+0001bb70: 2069 7320 616e 2069 6e73 7461 6e63 6520   is an instance 
+0001bb80: 6f66 2074 6865 2043 5259 5054 2076 616c  of the CRYPT val
+0001bb90: 6964 6174 6f72 2c0a 2020 2020 2020 2020  idator,.        
+0001bba0: 7061 7373 776f 7264 2069 7320 7468 6520  password is the 
+0001bbb0: 7061 7373 776f 7264 2061 7320 696e 7365  password as inse
+0001bbc0: 7274 6564 2062 7920 7468 6520 7573 6572  rted by the user
+0001bbd0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001bbe0: 2020 2020 2073 656c 662e 6372 7970 7420       self.crypt 
+0001bbf0: 3d20 6372 7970 740a 2020 2020 2020 2020  = crypt.        
+0001bc00: 7365 6c66 2e70 6173 7377 6f72 6420 3d20  self.password = 
+0001bc10: 7061 7373 776f 7264 0a20 2020 2020 2020  password.       
+0001bc20: 2073 656c 662e 6372 7970 7465 6420 3d20   self.crypted = 
+0001bc30: 4e6f 6e65 0a0a 2020 2020 6465 6620 5f5f  None..    def __
+0001bc40: 7374 725f 5f28 7365 6c66 293a 0a20 2020  str__(self):.   
+0001bc50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001bc60: 2045 6e63 7279 7074 6564 2073 656c 662e   Encrypted self.
+0001bc70: 7061 7373 776f 7264 2061 6e64 2063 6163  password and cac
+0001bc80: 6865 7320 6974 2069 6e20 7365 6c66 2e63  hes it in self.c
+0001bc90: 7279 7074 6564 2e0a 2020 2020 2020 2020  rypted..        
+0001bca0: 4966 2073 656c 662e 6372 7970 742e 7361  If self.crypt.sa
+0001bcb0: 6c74 2074 6865 206f 7574 7075 7420 6973  lt the output is
+0001bcc0: 2069 6e20 7468 6520 666f 726d 6174 203c   in the format <
+0001bcd0: 616c 676f 7269 7468 6d3e 243c 7361 6c74  algorithm>$<salt
+0001bce0: 3e24 3c68 6173 683e 0a0a 2020 2020 2020  >$<hash>..      
+0001bcf0: 2020 5472 7920 6765 7420 7468 6520 6469    Try get the di
+0001bd00: 6765 7374 5f61 6c67 2066 726f 6d20 7468  gest_alg from th
+0001bd10: 6520 6b65 7920 2869 6620 6974 2065 7869  e key (if it exi
+0001bd20: 7374 7329 0a20 2020 2020 2020 2065 6c73  sts).        els
+0001bd30: 6520 6173 7375 6d65 2074 6865 2064 6566  e assume the def
+0001bd40: 6175 6c74 2064 6967 6573 745f 616c 672e  ault digest_alg.
+0001bd50: 2049 6620 6e6f 7420 6b65 7920 6174 2061   If not key at a
+0001bd60: 6c6c 2c20 7365 7420 6b65 793d 2727 0a0a  ll, set key=''..
+0001bd70: 2020 2020 2020 2020 4966 2061 2073 616c          If a sal
+0001bd80: 7420 6973 2073 7065 6369 6669 6564 2075  t is specified u
+0001bd90: 7365 2069 742c 2069 6620 7361 6c74 2069  se it, if salt i
+0001bda0: 7320 5472 7565 2c20 7365 7420 7361 6c74  s True, set salt
+0001bdb0: 2074 6f20 7575 6964 0a20 2020 2020 2020   to uuid.       
+0001bdc0: 2028 7468 6973 2073 686f 756c 6420 616c   (this should al
+0001bdd0: 6c20 6265 2062 6163 6b77 6172 6420 636f  l be backward co
+0001bde0: 6d70 6174 6962 6c65 290a 0a20 2020 2020  mpatible)..     
+0001bdf0: 2020 204f 7074 696f 6e73 3a0a 2020 2020     Options:.    
+0001be00: 2020 2020 6b65 7920 3d20 2775 7569 6427      key = 'uuid'
+0001be10: 0a20 2020 2020 2020 206b 6579 203d 2027  .        key = '
+0001be20: 6d64 353a 7575 6964 270a 2020 2020 2020  md5:uuid'.      
+0001be30: 2020 6b65 7920 3d20 2773 6861 3531 323a    key = 'sha512:
+0001be40: 7575 6964 270a 2020 2020 2020 2020 2e2e  uuid'.        ..
+0001be50: 2e0a 2020 2020 2020 2020 6b65 7920 3d20  ..        key = 
+0001be60: 2770 626b 6466 3228 3130 3030 2c36 342c  'pbkdf2(1000,64,
+0001be70: 7368 6135 3132 293a 7575 6964 2720 3130  sha512):uuid' 10
+0001be80: 3030 2069 7465 7261 7469 6f6e 7320 616e  00 iterations an
+0001be90: 6420 3634 2063 6861 7273 206c 656e 6774  d 64 chars lengt
+0001bea0: 680a 2020 2020 2020 2020 2222 220a 2020  h.        """.  
+0001beb0: 2020 2020 2020 6966 2073 656c 662e 6372        if self.cr
+0001bec0: 7970 7465 643a 0a20 2020 2020 2020 2020  ypted:.         
+0001bed0: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+0001bee0: 7279 7074 6564 0a20 2020 2020 2020 2069  rypted.        i
+0001bef0: 6620 7365 6c66 2e63 7279 7074 2e6b 6579  f self.crypt.key
+0001bf00: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0001bf10: 2022 3a22 2069 6e20 7365 6c66 2e63 7279   ":" in self.cry
+0001bf20: 7074 2e6b 6579 3a0a 2020 2020 2020 2020  pt.key:.        
+0001bf30: 2020 2020 2020 2020 6469 6765 7374 5f61          digest_a
+0001bf40: 6c67 2c20 6b65 7920 3d20 7365 6c66 2e63  lg, key = self.c
+0001bf50: 7279 7074 2e6b 6579 2e73 706c 6974 2822  rypt.key.split("
+0001bf60: 3a22 2c20 3129 0a20 2020 2020 2020 2020  :", 1).         
+0001bf70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001bf80: 2020 2020 2020 2020 2064 6967 6573 745f           digest_
+0001bf90: 616c 672c 206b 6579 203d 2073 656c 662e  alg, key = self.
+0001bfa0: 6372 7970 742e 6469 6765 7374 5f61 6c67  crypt.digest_alg
+0001bfb0: 2c20 7365 6c66 2e63 7279 7074 2e6b 6579  , self.crypt.key
+0001bfc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001bfd0: 2020 2020 2020 2020 2020 2064 6967 6573             diges
+0001bfe0: 745f 616c 672c 206b 6579 203d 2073 656c  t_alg, key = sel
+0001bff0: 662e 6372 7970 742e 6469 6765 7374 5f61  f.crypt.digest_a
+0001c000: 6c67 2c20 2222 0a20 2020 2020 2020 2069  lg, "".        i
+0001c010: 6620 7365 6c66 2e63 7279 7074 2e73 616c  f self.crypt.sal
+0001c020: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
+0001c030: 6620 7365 6c66 2e63 7279 7074 2e73 616c  f self.crypt.sal
+0001c040: 7420 6973 2054 7275 653a 0a20 2020 2020  t is True:.     
+0001c050: 2020 2020 2020 2020 2020 2073 616c 7420             salt 
+0001c060: 3d20 7374 7228 7575 6964 2e75 7569 6434  = str(uuid.uuid4
+0001c070: 2829 292e 7265 706c 6163 6528 222d 222c  ()).replace("-",
+0001c080: 2022 2229 5b2d 3136 3a5d 0a20 2020 2020   "")[-16:].     
+0001c090: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001c0a0: 2020 2020 2020 2020 2020 2020 2073 616c               sal
+0001c0b0: 7420 3d20 7365 6c66 2e63 7279 7074 2e73  t = self.crypt.s
+0001c0c0: 616c 740a 2020 2020 2020 2020 656c 7365  alt.        else
+0001c0d0: 3a0a 2020 2020 2020 2020 2020 2020 7361  :.            sa
+0001c0e0: 6c74 203d 2022 220a 2020 2020 2020 2020  lt = "".        
+0001c0f0: 6861 7368 6564 203d 2073 696d 706c 655f  hashed = simple_
+0001c100: 6861 7368 2873 656c 662e 7061 7373 776f  hash(self.passwo
+0001c110: 7264 2c20 6b65 792c 2073 616c 742c 2064  rd, key, salt, d
+0001c120: 6967 6573 745f 616c 6729 0a20 2020 2020  igest_alg).     
+0001c130: 2020 2073 656c 662e 6372 7970 7465 6420     self.crypted 
+0001c140: 3d20 2225 7324 2573 2425 7322 2025 2028  = "%s$%s$%s" % (
+0001c150: 6469 6765 7374 5f61 6c67 2c20 7361 6c74  digest_alg, salt
+0001c160: 2c20 6861 7368 6564 290a 2020 2020 2020  , hashed).      
+0001c170: 2020 7265 7475 726e 2073 656c 662e 6372    return self.cr
+0001c180: 7970 7465 640a 0a20 2020 2064 6566 205f  ypted..    def _
+0001c190: 5f65 715f 5f28 7365 6c66 2c20 7374 6f72  _eq__(self, stor
+0001c1a0: 6564 5f70 6173 7377 6f72 6429 3a0a 2020  ed_password):.  
+0001c1b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c1c0: 2020 636f 6d70 6172 6573 2074 6865 2063    compares the c
+0001c1d0: 7572 7265 6e74 206c 617a 7920 6372 7970  urrent lazy cryp
+0001c1e0: 7465 6420 7061 7373 776f 7264 2077 6974  ted password wit
+0001c1f0: 6820 6120 7374 6f72 6564 2070 6173 7377  h a stored passw
+0001c200: 6f72 640a 2020 2020 2020 2020 2222 220a  ord.        """.
+0001c210: 0a20 2020 2020 2020 2023 204c 617a 7943  .        # LazyC
+0001c220: 7279 7074 206f 626a 6563 7473 2063 6f6d  rypt objects com
+0001c230: 7061 7269 736f 6e0a 2020 2020 2020 2020  parison.        
+0001c240: 6966 2069 7369 6e73 7461 6e63 6528 7374  if isinstance(st
+0001c250: 6f72 6564 5f70 6173 7377 6f72 642c 2073  ored_password, s
+0001c260: 656c 662e 5f5f 636c 6173 735f 5f29 3a0a  elf.__class__):.
+0001c270: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001c280: 726e 2028 7365 6c66 2069 7320 7374 6f72  rn (self is stor
+0001c290: 6564 5f70 6173 7377 6f72 6429 206f 7220  ed_password) or 
+0001c2a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001c2b0: 2020 2873 656c 662e 6372 7970 742e 6b65    (self.crypt.ke
+0001c2c0: 7920 3d3d 2073 746f 7265 645f 7061 7373  y == stored_pass
+0001c2d0: 776f 7264 2e63 7279 7074 2e6b 6579 290a  word.crypt.key).
+0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2f0: 616e 6420 2873 656c 662e 7061 7373 776f  and (self.passwo
+0001c300: 7264 203d 3d20 7374 6f72 6564 5f70 6173  rd == stored_pas
+0001c310: 7377 6f72 642e 7061 7373 776f 7264 290a  sword.password).
+0001c320: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001c330: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+0001c340: 7279 7074 2e6b 6579 3a0a 2020 2020 2020  rypt.key:.      
+0001c350: 2020 2020 2020 6966 2022 3a22 2069 6e20        if ":" in 
+0001c360: 7365 6c66 2e63 7279 7074 2e6b 6579 3a0a  self.crypt.key:.
+0001c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c380: 6b65 7920 3d20 7365 6c66 2e63 7279 7074  key = self.crypt
+0001c390: 2e6b 6579 2e73 706c 6974 2822 3a22 295b  .key.split(":")[
+0001c3a0: 315d 0a20 2020 2020 2020 2020 2020 2065  1].            e
+0001c3b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001c3c0: 2020 2020 206b 6579 203d 2073 656c 662e       key = self.
+0001c3d0: 6372 7970 742e 6b65 790a 2020 2020 2020  crypt.key.      
+0001c3e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001c3f0: 2020 2020 6b65 7920 3d20 2222 0a20 2020      key = "".   
+0001c400: 2020 2020 2069 6620 7374 6f72 6564 5f70       if stored_p
+0001c410: 6173 7377 6f72 6420 6973 204e 6f6e 653a  assword is None:
+0001c420: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001c430: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
+0001c440: 2020 656c 6966 2073 746f 7265 645f 7061    elif stored_pa
+0001c450: 7373 776f 7264 2e63 6f75 6e74 2822 2422  ssword.count("$"
+0001c460: 2920 3d3d 2032 3a0a 2020 2020 2020 2020  ) == 2:.        
+0001c470: 2020 2020 2864 6967 6573 745f 616c 672c      (digest_alg,
+0001c480: 2073 616c 742c 2068 6173 6829 203d 2073   salt, hash) = s
+0001c490: 746f 7265 645f 7061 7373 776f 7264 2e73  tored_password.s
+0001c4a0: 706c 6974 2822 2422 290a 2020 2020 2020  plit("$").      
+0001c4b0: 2020 2020 2020 6820 3d20 7369 6d70 6c65        h = simple
+0001c4c0: 5f68 6173 6828 7365 6c66 2e70 6173 7377  _hash(self.passw
+0001c4d0: 6f72 642c 206b 6579 2c20 7361 6c74 2c20  ord, key, salt, 
+0001c4e0: 6469 6765 7374 5f61 6c67 290a 2020 2020  digest_alg).    
+0001c4f0: 2020 2020 2020 2020 7465 6d70 5f70 6173          temp_pas
+0001c500: 7320 3d20 2225 7324 2573 2425 7322 2025  s = "%s$%s$%s" %
+0001c510: 2028 6469 6765 7374 5f61 6c67 2c20 7361   (digest_alg, sa
+0001c520: 6c74 2c20 6829 0a20 2020 2020 2020 2065  lt, h).        e
+0001c530: 6c73 653a 2020 2320 6e6f 2073 616c 7469  lse:  # no salti
+0001c540: 6e67 0a20 2020 2020 2020 2020 2020 2023  ng.            #
+0001c550: 2067 7565 7373 2064 6967 6573 745f 616c   guess digest_al
+0001c560: 670a 2020 2020 2020 2020 2020 2020 6469  g.            di
+0001c570: 6765 7374 5f61 6c67 203d 2044 4947 4553  gest_alg = DIGES
+0001c580: 545f 414c 475f 4259 5f53 495a 452e 6765  T_ALG_BY_SIZE.ge
+0001c590: 7428 6c65 6e28 7374 6f72 6564 5f70 6173  t(len(stored_pas
+0001c5a0: 7377 6f72 6429 2c20 4e6f 6e65 290a 2020  sword), None).  
+0001c5b0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001c5c0: 2064 6967 6573 745f 616c 673a 0a20 2020   digest_alg:.   
+0001c5d0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001c5e0: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
+0001c5f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001c600: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+0001c610: 5f70 6173 7320 3d20 7369 6d70 6c65 5f68  _pass = simple_h
+0001c620: 6173 6828 7365 6c66 2e70 6173 7377 6f72  ash(self.passwor
+0001c630: 642c 206b 6579 2c20 2222 2c20 6469 6765  d, key, "", dige
+0001c640: 7374 5f61 6c67 290a 2020 2020 2020 2020  st_alg).        
+0001c650: 7265 7475 726e 2074 656d 705f 7061 7373  return temp_pass
+0001c660: 203d 3d20 7374 6f72 6564 5f70 6173 7377   == stored_passw
+0001c670: 6f72 640a 0a20 2020 2064 6566 205f 5f6e  ord..    def __n
+0001c680: 655f 5f28 7365 6c66 2c20 6f74 6865 7229  e__(self, other)
+0001c690: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001c6a0: 206e 6f74 2073 656c 662e 5f5f 6571 5f5f   not self.__eq__
+0001c6b0: 286f 7468 6572 290a 0a0a 636c 6173 7320  (other)...class 
+0001c6c0: 4352 5950 5428 5661 6c69 6461 746f 7229  CRYPT(Validator)
+0001c6d0: 3a0a 2020 2020 2222 220a 2020 2020 4578  :.    """.    Ex
+0001c6e0: 616d 706c 6573 3a0a 2020 2020 2020 2020  amples:.        
+0001c6f0: 5573 6520 6173 3a3a 0a0a 2020 2020 2020  Use as::..      
+0001c700: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
+0001c710: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
+0001c720: 276e 616d 6527 2c20 7265 7175 6972 6573  'name', requires
+0001c730: 3d43 5259 5054 2829 290a 0a20 2020 2065  =CRYPT())..    e
+0001c740: 6e63 6f64 6573 2074 6865 2076 616c 7565  ncodes the value
+0001c750: 206f 6e20 7661 6c69 6461 7469 6f6e 2077   on validation w
+0001c760: 6974 6820 6120 6469 6765 7374 2e0a 0a20  ith a digest... 
+0001c770: 2020 2049 6620 6e6f 2061 7267 756d 656e     If no argumen
+0001c780: 7473 2061 7265 2070 726f 7669 6465 6420  ts are provided 
+0001c790: 4352 5950 5420 7573 6573 2074 6865 204d  CRYPT uses the M
+0001c7a0: 4435 2061 6c67 6f72 6974 686d 2e0a 2020  D5 algorithm..  
+0001c7b0: 2020 4966 2074 6865 206b 6579 2061 7267    If the key arg
+0001c7c0: 756d 656e 7420 6973 2070 726f 7669 6465  ument is provide
+0001c7d0: 6420 7468 6520 484d 4143 2b4d 4435 2061  d the HMAC+MD5 a
+0001c7e0: 6c67 6f72 6974 686d 2069 7320 7573 6564  lgorithm is used
+0001c7f0: 2e0a 2020 2020 4966 2074 6865 2064 6967  ..    If the dig
+0001c800: 6573 745f 616c 6720 6973 2073 7065 6369  est_alg is speci
+0001c810: 6669 6564 2074 6869 7320 6973 2075 7365  fied this is use
+0001c820: 6420 746f 2072 6570 6c61 6365 2074 6865  d to replace the
+0001c830: 0a20 2020 204d 4435 2077 6974 682c 2066  .    MD5 with, f
+0001c840: 6f72 2065 7861 6d70 6c65 2c20 5348 4135  or example, SHA5
+0001c850: 3132 2e20 5468 6520 6469 6765 7374 5f61  12. The digest_a
+0001c860: 6c67 2063 616e 2062 650a 2020 2020 7468  lg can be.    th
+0001c870: 6520 6e61 6d65 206f 6620 6120 6861 7368  e name of a hash
+0001c880: 6c69 6220 616c 676f 7269 7468 6d20 6173  lib algorithm as
+0001c890: 2061 2073 7472 696e 6720 6f72 2074 6865   a string or the
+0001c8a0: 2061 6c67 6f72 6974 686d 2069 7473 656c   algorithm itsel
+0001c8b0: 662e 0a0a 2020 2020 6d69 6e5f 6c65 6e67  f...    min_leng
+0001c8c0: 7468 2069 7320 7468 6520 6d69 6e69 6d61  th is the minima
+0001c8d0: 6c20 7061 7373 776f 7264 206c 656e 6774  l password lengt
+0001c8e0: 6820 2864 6566 6175 6c74 2034 2920 2d20  h (default 4) - 
+0001c8f0: 4953 5f53 5452 4f4e 4720 666f 7220 7365  IS_STRONG for se
+0001c900: 7269 6f75 7320 7365 6375 7269 7479 0a20  rious security. 
+0001c910: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001c920: 2069 7320 7468 6520 6d65 7373 6167 6520   is the message 
+0001c930: 6966 2070 6173 7377 6f72 6420 6973 2074  if password is t
+0001c940: 6f6f 2073 686f 7274 0a0a 2020 2020 4e6f  oo short..    No
+0001c950: 7469 6365 2074 6861 7420 616e 2065 6d70  tice that an emp
+0001c960: 7479 2070 6173 7377 6f72 6420 6973 2061  ty password is a
+0001c970: 6363 6570 7465 6420 6275 7420 696e 7661  ccepted but inva
+0001c980: 6c69 642e 2049 7420 7769 6c6c 206e 6f74  lid. It will not
+0001c990: 2061 6c6c 6f77 206c 6f67 696e 2062 6163   allow login bac
+0001c9a0: 6b2e 0a20 2020 2053 746f 7265 7320 6a75  k..    Stores ju
+0001c9b0: 6e6b 2061 7320 6861 7368 6564 2070 6173  nk as hashed pas
+0001c9c0: 7377 6f72 642e 0a0a 2020 2020 5370 6563  sword...    Spec
+0001c9d0: 6966 7920 616e 2061 6c67 6f72 6974 686d  ify an algorithm
+0001c9e0: 206f 7220 6279 2064 6566 6175 6c74 2077   or by default w
+0001c9f0: 6520 7769 6c6c 2075 7365 2073 6861 3531  e will use sha51
+0001ca00: 322e 0a0a 2020 2020 5479 7069 6361 6c20  2...    Typical 
+0001ca10: 6176 6169 6c61 626c 6520 616c 676f 7269  available algori
+0001ca20: 7468 6d73 3a0a 2020 2020 2020 6d64 352c  thms:.      md5,
+0001ca30: 2073 6861 312c 2073 6861 3232 342c 2073   sha1, sha224, s
+0001ca40: 6861 3235 362c 2073 6861 3338 342c 2073  ha256, sha384, s
+0001ca50: 6861 3531 320a 0a20 2020 2049 6620 7361  ha512..    If sa
+0001ca60: 6c74 2c20 6974 2068 6173 6865 7320 6120  lt, it hashes a 
+0001ca70: 7061 7373 776f 7264 2077 6974 6820 6120  password with a 
+0001ca80: 7361 6c74 2e0a 2020 2020 4966 2073 616c  salt..    If sal
+0001ca90: 7420 6973 2054 7275 652c 2074 6869 7320  t is True, this 
+0001caa0: 6d65 7468 6f64 2077 696c 6c20 6175 746f  method will auto
+0001cab0: 6d61 7469 6361 6c6c 7920 6765 6e65 7261  matically genera
+0001cac0: 7465 206f 6e65 2e0a 2020 2020 4569 7468  te one..    Eith
+0001cad0: 6572 2063 6173 6520 6974 2072 6574 7572  er case it retur
+0001cae0: 6e73 2061 6e20 656e 6372 7970 7465 6420  ns an encrypted 
+0001caf0: 7061 7373 776f 7264 2073 7472 696e 6720  password string 
+0001cb00: 696e 2074 6865 2066 6f6c 6c6f 7769 6e67  in the following
+0001cb10: 2066 6f72 6d61 743a 0a0a 2020 2020 2020   format:..      
+0001cb20: 3c61 6c67 6f72 6974 686d 3e24 3c73 616c  <algorithm>$<sal
+0001cb30: 743e 243c 6861 7368 3e0a 0a20 2020 2049  t>$<hash>..    I
+0001cb40: 6d70 6f72 7461 6e74 3a20 6861 7368 6564  mportant: hashed
+0001cb50: 2070 6173 7377 6f72 6420 6973 2072 6574   password is ret
+0001cb60: 7572 6e65 6420 6173 2061 204c 617a 7943  urned as a LazyC
+0001cb70: 7279 7074 206f 626a 6563 7420 616e 6420  rypt object and 
+0001cb80: 636f 6d70 7574 6564 206f 6e6c 7920 6966  computed only if
+0001cb90: 206e 6565 6465 642e 0a20 2020 2054 6865   needed..    The
+0001cba0: 204c 6173 7943 7279 7074 206f 626a 6563   LasyCrypt objec
+0001cbb0: 7420 616c 736f 206b 6e6f 7773 2068 6f77  t also knows how
+0001cbc0: 2074 6f20 636f 6d70 6172 6520 6974 7365   to compare itse
+0001cbd0: 6c66 2077 6974 6820 616e 2065 7869 7374  lf with an exist
+0001cbe0: 696e 6720 7361 6c74 6564 2070 6173 7377  ing salted passw
+0001cbf0: 6f72 640a 0a20 2020 2053 7570 706f 7274  ord..    Support
+0001cc00: 7320 7374 616e 6461 7264 2061 6c67 6f72  s standard algor
+0001cc10: 6974 686d 730a 0a20 2020 2020 2020 203e  ithms..        >
+0001cc20: 3e3e 2066 6f72 2061 6c67 2069 6e20 2827  >> for alg in ('
+0001cc30: 6d64 3527 2c27 7368 6131 272c 2773 6861  md5','sha1','sha
+0001cc40: 3235 3627 2c27 7368 6133 3834 272c 2773  256','sha384','s
+0001cc50: 6861 3531 3227 293a 0a20 2020 2020 2020  ha512'):.       
+0001cc60: 202e 2e2e 2020 2020 2070 7269 6e74 2873   ...     print(s
+0001cc70: 7472 2843 5259 5054 2864 6967 6573 745f  tr(CRYPT(digest_
+0001cc80: 616c 673d 616c 672c 7361 6c74 3d54 7275  alg=alg,salt=Tru
+0001cc90: 6529 2827 7465 7374 2729 5b30 5d29 290a  e)('test')[0])).
+0001cca0: 2020 2020 2020 2020 6d64 3524 2e2e 2e24          md5$...$
+0001ccb0: 2e2e 2e0a 2020 2020 2020 2020 7368 6131  ....        sha1
+0001ccc0: 242e 2e2e 242e 2e2e 0a20 2020 2020 2020  $...$....       
+0001ccd0: 2073 6861 3235 3624 2e2e 2e24 2e2e 2e0a   sha256$...$....
+0001cce0: 2020 2020 2020 2020 7368 6133 3834 242e          sha384$.
+0001ccf0: 2e2e 242e 2e2e 0a20 2020 2020 2020 2073  ..$....        s
+0001cd00: 6861 3531 3224 2e2e 2e24 2e2e 2e0a 0a20  ha512$...$..... 
+0001cd10: 2020 2054 6865 2073 796e 7461 7820 6973     The syntax is
+0001cd20: 2061 6c77 6179 7320 616c 6724 7361 6c74   always alg$salt
+0001cd30: 2468 6173 680a 0a20 2020 2053 7570 706f  $hash..    Suppo
+0001cd40: 7274 7320 666f 7220 7062 6b64 6632 0a0a  rts for pbkdf2..
+0001cd50: 2020 2020 2020 2020 3e3e 3e20 616c 6720          >>> alg 
+0001cd60: 3d20 2770 626b 6466 3228 3130 3030 2c32  = 'pbkdf2(1000,2
+0001cd70: 302c 7368 6135 3132 2927 0a20 2020 2020  0,sha512)'.     
+0001cd80: 2020 203e 3e3e 2070 7269 6e74 2873 7472     >>> print(str
+0001cd90: 2843 5259 5054 2864 6967 6573 745f 616c  (CRYPT(digest_al
+0001cda0: 673d 616c 672c 7361 6c74 3d54 7275 6529  g=alg,salt=True)
+0001cdb0: 2827 7465 7374 2729 5b30 5d29 290a 2020  ('test')[0])).  
+0001cdc0: 2020 2020 2020 7062 6b64 6632 2831 3030        pbkdf2(100
+0001cdd0: 302c 3230 2c73 6861 3531 3229 242e 2e2e  0,20,sha512)$...
+0001cde0: 242e 2e2e 0a0a 2020 2020 416e 206f 7074  $.....    An opt
+0001cdf0: 696f 6e61 6c20 686d 6163 5f6b 6579 2063  ional hmac_key c
+0001ce00: 616e 2062 6520 7370 6563 6966 6965 6420  an be specified 
+0001ce10: 616e 6420 6974 2069 7320 7573 6564 2061  and it is used a
+0001ce20: 7320 7361 6c74 2070 7265 6669 780a 0a20  s salt prefix.. 
+0001ce30: 2020 2020 2020 203e 3e3e 2061 203d 2073         >>> a = s
+0001ce40: 7472 2843 5259 5054 2864 6967 6573 745f  tr(CRYPT(digest_
+0001ce50: 616c 673d 276d 6435 272c 6b65 793d 276d  alg='md5',key='m
+0001ce60: 796b 6579 272c 7361 6c74 3d54 7275 6529  ykey',salt=True)
+0001ce70: 2827 7465 7374 2729 5b30 5d29 0a20 2020  ('test')[0]).   
+0001ce80: 2020 2020 203e 3e3e 2070 7269 6e74 2861       >>> print(a
+0001ce90: 290a 2020 2020 2020 2020 6d64 3524 2e2e  ).        md5$..
+0001cea0: 2e24 2e2e 2e0a 0a20 2020 2045 7665 6e20  .$.....    Even 
+0001ceb0: 6966 2074 6865 2061 6c67 6f72 6974 686d  if the algorithm
+0001cec0: 2063 6861 6e67 6573 2074 6865 2068 6173   changes the has
+0001ced0: 6820 6361 6e20 7374 696c 6c20 6265 2076  h can still be v
+0001cee0: 616c 6964 6174 6564 0a0a 2020 2020 2020  alidated..      
+0001cef0: 2020 3e3e 3e20 4352 5950 5428 6469 6765    >>> CRYPT(dige
+0001cf00: 7374 5f61 6c67 3d27 7368 6131 272c 6b65  st_alg='sha1',ke
+0001cf10: 793d 276d 796b 6579 272c 7361 6c74 3d54  y='mykey',salt=T
+0001cf20: 7275 6529 2827 7465 7374 2729 5b30 5d20  rue)('test')[0] 
+0001cf30: 3d3d 2061 0a20 2020 2020 2020 2054 7275  == a.        Tru
+0001cf40: 650a 0a20 2020 2049 6620 6e6f 2073 616c  e..    If no sal
+0001cf50: 7420 6973 2073 7065 6369 6669 6564 2043  t is specified C
+0001cf60: 5259 5054 2063 616e 2067 7565 7373 2074  RYPT can guess t
+0001cf70: 6865 2061 6c67 6f72 6974 686d 7320 6672  he algorithms fr
+0001cf80: 6f6d 206c 656e 6774 683a 0a0a 2020 2020  om length:..    
+0001cf90: 2020 2020 3e3e 3e20 6120 3d20 7374 7228      >>> a = str(
+0001cfa0: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
+0001cfb0: 3d27 7368 6131 272c 7361 6c74 3d46 616c  ='sha1',salt=Fal
+0001cfc0: 7365 2928 2774 6573 7427 295b 305d 290a  se)('test')[0]).
+0001cfd0: 2020 2020 2020 2020 3e3e 3e20 610a 2020          >>> a.  
+0001cfe0: 2020 2020 2020 2773 6861 3124 2461 3934        'sha1$$a94
+0001cff0: 6138 6665 3563 6362 3139 6261 3631 6334  a8fe5ccb19ba61c4
+0001d000: 6330 3837 3364 3339 3165 3938 3739 3832  c0873d391e987982
+0001d010: 6662 6264 3327 0a20 2020 2020 2020 203e  fbbd3'.        >
+0001d020: 3e3e 2043 5259 5054 2864 6967 6573 745f  >> CRYPT(digest_
+0001d030: 616c 673d 2773 6861 3127 2c73 616c 743d  alg='sha1',salt=
+0001d040: 4661 6c73 6529 2827 7465 7374 2729 5b30  False)('test')[0
+0001d050: 5d20 3d3d 2061 0a20 2020 2020 2020 2054  ] == a.        T
+0001d060: 7275 650a 2020 2020 2020 2020 3e3e 3e20  rue.        >>> 
+0001d070: 4352 5950 5428 6469 6765 7374 5f61 6c67  CRYPT(digest_alg
+0001d080: 3d27 7368 6131 272c 7361 6c74 3d46 616c  ='sha1',salt=Fal
+0001d090: 7365 2928 2774 6573 7427 295b 305d 203d  se)('test')[0] =
+0001d0a0: 3d20 615b 363a 5d0a 2020 2020 2020 2020  = a[6:].        
+0001d0b0: 5472 7565 0a20 2020 2020 2020 203e 3e3e  True.        >>>
+0001d0c0: 2043 5259 5054 2864 6967 6573 745f 616c   CRYPT(digest_al
+0001d0d0: 673d 276d 6435 272c 7361 6c74 3d46 616c  g='md5',salt=Fal
+0001d0e0: 7365 2928 2774 6573 7427 295b 305d 203d  se)('test')[0] =
+0001d0f0: 3d20 610a 2020 2020 2020 2020 5472 7565  = a.        True
+0001d100: 0a20 2020 2020 2020 203e 3e3e 2043 5259  .        >>> CRY
+0001d110: 5054 2864 6967 6573 745f 616c 673d 276d  PT(digest_alg='m
+0001d120: 6435 272c 7361 6c74 3d46 616c 7365 2928  d5',salt=False)(
+0001d130: 2774 6573 7427 295b 305d 203d 3d20 615b  'test')[0] == a[
+0001d140: 363a 5d0a 2020 2020 2020 2020 5472 7565  6:].        True
+0001d150: 0a20 2020 2022 2222 0a0a 2020 2020 5354  .    """..    ST
+0001d160: 4152 5320 3d20 222a 2a2a 2a2a 2a22 0a0a  ARS = "******"..
+0001d170: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0001d180: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001d190: 2020 2020 2020 2020 6b65 793d 4e6f 6e65          key=None
+0001d1a0: 2c0a 2020 2020 2020 2020 6469 6765 7374  ,.        digest
+0001d1b0: 5f61 6c67 3d22 7062 6b64 6632 2831 3030  _alg="pbkdf2(100
+0001d1c0: 302c 3230 2c73 6861 3531 3229 222c 0a20  0,20,sha512)",. 
+0001d1d0: 2020 2020 2020 206d 696e 5f6c 656e 6774         min_lengt
+0001d1e0: 683d 302c 0a20 2020 2020 2020 2065 7272  h=0,.        err
+0001d1f0: 6f72 5f6d 6573 7361 6765 3d22 546f 6f20  or_message="Too 
+0001d200: 7368 6f72 7422 2c0a 2020 2020 2020 2020  short",.        
+0001d210: 7361 6c74 3d54 7275 652c 0a20 2020 2020  salt=True,.     
+0001d220: 2020 206d 6178 5f6c 656e 6774 683d 3130     max_length=10
+0001d230: 3234 2c0a 2020 2020 293a 0a20 2020 2020  24,.    ):.     
+0001d240: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0001d250: 6d70 6f72 7461 6e74 2c20 6469 6765 7374  mportant, digest
+0001d260: 5f61 6c67 3d27 6d64 3527 2069 7320 6e6f  _alg='md5' is no
+0001d270: 7420 7468 6520 6465 6661 756c 7420 6861  t the default ha
+0001d280: 7368 696e 6720 616c 676f 7269 7468 6d20  shing algorithm 
+0001d290: 666f 720a 2020 2020 2020 2020 7765 6232  for.        web2
+0001d2a0: 7079 2e20 5468 6973 2069 7320 6f6e 6c79  py. This is only
+0001d2b0: 2061 6e20 6578 616d 706c 6520 6f66 2075   an example of u
+0001d2c0: 7361 6765 206f 6620 7468 6973 2066 756e  sage of this fun
+0001d2d0: 6374 696f 6e2e 0a0a 2020 2020 2020 2020  ction...        
+0001d2e0: 5468 6520 6163 7475 616c 2068 6173 6820  The actual hash 
+0001d2f0: 616c 676f 7269 7468 6d20 6973 2064 6574  algorithm is det
+0001d300: 6572 6d69 6e65 6420 6672 6f6d 2074 6865  ermined from the
+0001d310: 206b 6579 2077 6869 6368 2069 730a 2020   key which is.  
+0001d320: 2020 2020 2020 6765 6e65 7261 7465 6420        generated 
+0001d330: 6279 2077 6562 3270 7920 696e 2074 6f6f  by web2py in too
+0001d340: 6c73 2e70 792e 2054 6869 7320 6465 6661  ls.py. This defa
+0001d350: 756c 7473 2074 6f20 686d 6163 2b73 6861  ults to hmac+sha
+0001d360: 3531 322e 0a20 2020 2020 2020 2022 2222  512..        """
+0001d370: 0a20 2020 2020 2020 2073 656c 662e 6b65  .        self.ke
+0001d380: 7920 3d20 6b65 790a 2020 2020 2020 2020  y = key.        
+0001d390: 7365 6c66 2e64 6967 6573 745f 616c 6720  self.digest_alg 
+0001d3a0: 3d20 6469 6765 7374 5f61 6c67 0a20 2020  = digest_alg.   
+0001d3b0: 2020 2020 2073 656c 662e 6d69 6e5f 6c65       self.min_le
+0001d3c0: 6e67 7468 203d 206d 696e 5f6c 656e 6774  ngth = min_lengt
+0001d3d0: 680a 2020 2020 2020 2020 7365 6c66 2e6d  h.        self.m
+0001d3e0: 6178 5f6c 656e 6774 6820 3d20 6d61 785f  ax_length = max_
+0001d3f0: 6c65 6e67 7468 0a20 2020 2020 2020 2073  length.        s
+0001d400: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
+0001d410: 6520 3d20 6572 726f 725f 6d65 7373 6167  e = error_messag
+0001d420: 650a 2020 2020 2020 2020 7365 6c66 2e73  e.        self.s
+0001d430: 616c 7420 3d20 7361 6c74 0a0a 2020 2020  alt = salt..    
+0001d440: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
+0001d450: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
+0001d460: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
+0001d470: 2020 2069 6620 7661 6c75 6520 3d3d 2073     if value == s
+0001d480: 656c 662e 5354 4152 533a 0a20 2020 2020  elf.STARS:.     
+0001d490: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0001d4a0: 6e65 0a20 2020 2020 2020 2076 203d 2076  ne.        v = v
+0001d4b0: 616c 7565 2061 6e64 2073 7472 2876 616c  alue and str(val
+0001d4c0: 7565 295b 3a20 7365 6c66 2e6d 6178 5f6c  ue)[: self.max_l
+0001d4d0: 656e 6774 685d 0a20 2020 2020 2020 2069  ength].        i
+0001d4e0: 6620 6e6f 7420 7620 6f72 206c 656e 2876  f not v or len(v
+0001d4f0: 2920 3c20 7365 6c66 2e6d 696e 5f6c 656e  ) < self.min_len
+0001d500: 6774 683a 0a20 2020 2020 2020 2020 2020  gth:.           
+0001d510: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+0001d520: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+0001d530: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+0001d540: 725f 6d65 7373 6167 6529 290a 2020 2020  r_message)).    
+0001d550: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001d560: 6528 7661 6c75 652c 204c 617a 7943 7279  e(value, LazyCry
+0001d570: 7074 293a 0a20 2020 2020 2020 2020 2020  pt):.           
+0001d580: 2072 6574 7572 6e20 7661 6c75 650a 2020   return value.  
+0001d590: 2020 2020 2020 7265 7475 726e 204c 617a        return Laz
+0001d5a0: 7943 7279 7074 2873 656c 662c 2076 616c  yCrypt(self, val
+0001d5b0: 7565 290a 0a20 2020 2064 6566 2066 6f72  ue)..    def for
+0001d5c0: 6d61 7474 6572 2873 656c 662c 2076 616c  matter(self, val
+0001d5d0: 7565 293a 0a20 2020 2020 2020 2072 6574  ue):.        ret
+0001d5e0: 7572 6e20 7365 6c66 2e53 5441 5253 0a0a  urn self.STARS..
+0001d5f0: 0a23 2020 656e 7472 6f70 7920 6361 6c63  .#  entropy calc
+0001d600: 756c 6174 6f72 2066 6f72 2049 535f 5354  ulator for IS_ST
+0001d610: 524f 4e47 0a23 0a6c 6f77 6572 7365 7420  RONG.#.lowerset 
+0001d620: 3d20 6672 6f7a 656e 7365 7428 6222 6162  = frozenset(b"ab
+0001d630: 6364 6566 6768 696a 6b6c 6d6e 6f70 7172  cdefghijklmnopqr
+0001d640: 7374 7576 7778 797a 2229 0a75 7070 6572  stuvwxyz").upper
+0001d650: 7365 7420 3d20 6672 6f7a 656e 7365 7428  set = frozenset(
+0001d660: 6222 4142 4344 4546 4748 494a 4b4c 4d4e  b"ABCDEFGHIJKLMN
+0001d670: 4f50 5152 5354 5556 5758 595a 2229 0a6e  OPQRSTUVWXYZ").n
+0001d680: 756d 6265 7273 6574 203d 2066 726f 7a65  umberset = froze
+0001d690: 6e73 6574 2862 2230 3132 3334 3536 3738  nset(b"012345678
+0001d6a0: 3922 290a 7379 6d31 7365 7420 3d20 6672  9").sym1set = fr
+0001d6b0: 6f7a 656e 7365 7428 6222 2140 2324 255e  ozenset(b"!@#$%^
+0001d6c0: 262a 2829 2022 290a 7379 6d32 7365 7420  &*() ").sym2set 
+0001d6d0: 3d20 6672 6f7a 656e 7365 7428 6222 7e60  = frozenset(b"~`
+0001d6e0: 2d5f 3d2b 5b5d 7b7d 5c5c 7c3b 3a27 5c22  -_=+[]{}\\|;:'\"
+0001d6f0: 2c2e 3c3e 3f2f 2229 0a6f 7468 6572 7365  ,.<>?/").otherse
+0001d700: 7420 3d20 6672 6f7a 656e 7365 7428 6222  t = frozenset(b"
+0001d710: 222e 6a6f 696e 2863 6872 2878 2920 6966  ".join(chr(x) if
+0001d720: 2050 5932 2065 6c73 6520 6368 7228 7829   PY2 else chr(x)
+0001d730: 2e65 6e63 6f64 6528 2920 666f 7220 7820  .encode() for x 
+0001d740: 696e 2072 616e 6765 2832 3536 2929 290a  in range(256))).
+0001d750: 0a0a 6465 6620 6361 6c63 5f65 6e74 726f  ..def calc_entro
+0001d760: 7079 2873 7472 696e 6729 3a0a 2020 2020  py(string):.    
+0001d770: 2222 2263 616c 6375 6c61 7465 7320 6120  """calculates a 
+0001d780: 7369 6d70 6c65 2065 6e74 726f 7079 2066  simple entropy f
+0001d790: 6f72 2061 2067 6976 656e 2073 7472 696e  or a given strin
+0001d7a0: 6722 2222 0a20 2020 2061 6c70 6861 6265  g""".    alphabe
+0001d7b0: 7420 3d20 3020 2023 2061 6c70 6861 6265  t = 0  # alphabe
+0001d7c0: 7420 7369 7a65 0a20 2020 206f 7468 6572  t size.    other
+0001d7d0: 203d 2073 6574 2829 0a20 2020 2073 6565   = set().    see
+0001d7e0: 6e20 3d20 7365 7428 290a 2020 2020 6c61  n = set().    la
+0001d7f0: 7374 7365 7420 3d20 4e6f 6e65 0a20 2020  stset = None.   
+0001d800: 2073 7472 696e 6720 3d20 746f 5f62 7974   string = to_byt
+0001d810: 6573 2873 7472 696e 6720 6f72 2022 2229  es(string or "")
+0001d820: 0a20 2020 2066 6f72 2063 2069 6e20 7374  .    for c in st
+0001d830: 7269 6e67 3a0a 2020 2020 2020 2020 2320  ring:.        # 
+0001d840: 636c 6173 7369 6679 2074 6869 7320 6368  classify this ch
+0001d850: 6172 6163 7465 720a 2020 2020 2020 2020  aracter.        
+0001d860: 696e 7365 7420 3d20 4e6f 6e65 0a20 2020  inset = None.   
+0001d870: 2020 2020 2066 6f72 2063 7365 7420 696e       for cset in
+0001d880: 2028 6c6f 7765 7273 6574 2c20 7570 7065   (lowerset, uppe
+0001d890: 7273 6574 2c20 6e75 6d62 6572 7365 742c  rset, numberset,
+0001d8a0: 2073 796d 3173 6574 2c20 7379 6d32 7365   sym1set, sym2se
+0001d8b0: 742c 206f 7468 6572 7365 7429 3a0a 2020  t, otherset):.  
+0001d8c0: 2020 2020 2020 2020 2020 6966 2063 2069            if c i
+0001d8d0: 6e20 6373 6574 3a0a 2020 2020 2020 2020  n cset:.        
+0001d8e0: 2020 2020 2020 2020 696e 7365 7420 3d20          inset = 
+0001d8f0: 6373 6574 0a20 2020 2020 2020 2020 2020  cset.           
+0001d900: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0001d910: 2020 2061 7373 6572 7420 696e 7365 7420     assert inset 
+0001d920: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+0001d930: 2020 2020 2320 6361 6c63 756c 6174 6520      # calculate 
+0001d940: 6566 6665 6374 206f 6620 6368 6172 6163  effect of charac
+0001d950: 7465 7220 6f6e 2061 6c70 6861 6265 7420  ter on alphabet 
+0001d960: 7369 7a65 0a20 2020 2020 2020 2069 6620  size.        if 
+0001d970: 696e 7365 7420 6e6f 7420 696e 2073 6565  inset not in see
+0001d980: 6e3a 0a20 2020 2020 2020 2020 2020 2073  n:.            s
+0001d990: 6565 6e2e 6164 6428 696e 7365 7429 0a20  een.add(inset). 
+0001d9a0: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
+0001d9b0: 6265 7420 2b3d 206c 656e 2869 6e73 6574  bet += len(inset
+0001d9c0: 2920 2023 2063 7265 6469 7420 666f 7220  )  # credit for 
+0001d9d0: 6120 6e65 7720 6368 6172 6163 7465 7220  a new character 
+0001d9e0: 7365 740a 2020 2020 2020 2020 656c 6966  set.        elif
+0001d9f0: 2063 206e 6f74 2069 6e20 6f74 6865 723a   c not in other:
+0001da00: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
+0001da10: 6861 6265 7420 2b3d 2031 2020 2320 6372  habet += 1  # cr
+0001da20: 6564 6974 2066 6f72 2075 6e69 7175 6520  edit for unique 
+0001da30: 6368 6172 6163 7465 7273 0a20 2020 2020  characters.     
+0001da40: 2020 2020 2020 206f 7468 6572 2e61 6464         other.add
+0001da50: 2863 290a 2020 2020 2020 2020 6966 2069  (c).        if i
+0001da60: 6e73 6574 2069 7320 6e6f 7420 6c61 7374  nset is not last
+0001da70: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
+0001da80: 2061 6c70 6861 6265 7420 2b3d 2031 2020   alphabet += 1  
+0001da90: 2320 6372 6564 6974 2066 6f72 2073 6574  # credit for set
+0001daa0: 2074 7261 6e73 6974 696f 6e73 0a20 2020   transitions.   
+0001dab0: 2020 2020 2020 2020 206c 6173 7473 6574           lastset
+0001dac0: 203d 2063 7365 740a 2020 2020 656e 7472   = cset.    entr
+0001dad0: 6f70 7920 3d20 6c65 6e28 7374 7269 6e67  opy = len(string
+0001dae0: 2920 2a20 6d61 7468 2e6c 6f67 2861 6c70  ) * math.log(alp
+0001daf0: 6861 6265 7420 6f72 2031 2920 2f20 302e  habet or 1) / 0.
+0001db00: 3639 3331 3437 3138 3035 3539 3934 3533  6931471805599453
+0001db10: 2020 2320 6d61 7468 2e6c 6f67 2832 290a    # math.log(2).
+0001db20: 2020 2020 7265 7475 726e 2072 6f75 6e64      return round
+0001db30: 2865 6e74 726f 7079 2c20 3229 0a0a 0a63  (entropy, 2)...c
+0001db40: 6c61 7373 2049 535f 5354 524f 4e47 2856  lass IS_STRONG(V
+0001db50: 616c 6964 6174 6f72 293a 0a20 2020 2022  alidator):.    "
+0001db60: 2222 0a20 2020 2045 7861 6d70 6c65 733a  "".    Examples:
+0001db70: 0a20 2020 2020 2020 2055 7365 2061 733a  .        Use as:
+0001db80: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
+0001db90: 4e50 5554 285f 7479 7065 3d27 7061 7373  NPUT(_type='pass
+0001dba0: 776f 7264 272c 205f 6e61 6d65 3d27 7061  word', _name='pa
+0001dbb0: 7373 7764 272c 0a20 2020 2020 2020 2020  sswd',.         
+0001dbc0: 2020 2072 6571 7569 7265 733d 4953 5f53     requires=IS_S
+0001dbd0: 5452 4f4e 4728 6d69 6e3d 3130 2c20 7370  TRONG(min=10, sp
+0001dbe0: 6563 6961 6c3d 322c 2075 7070 6572 3d32  ecial=2, upper=2
+0001dbf0: 2929 0a0a 2020 2020 656e 666f 7263 6573  ))..    enforces
+0001dc00: 2063 6f6d 706c 6578 6974 7920 7265 7175   complexity requ
+0001dc10: 6972 656d 656e 7473 206f 6e20 6120 6669  irements on a fi
+0001dc20: 656c 640a 0a20 2020 2020 2020 203e 3e3e  eld..        >>>
+0001dc30: 2049 535f 5354 524f 4e47 2865 733d 5472   IS_STRONG(es=Tr
+0001dc40: 7565 2928 2741 6263 6431 3233 3427 290a  ue)('Abcd1234').
+0001dc50: 2020 2020 2020 2020 2827 4162 6364 3132          ('Abcd12
+0001dc60: 3334 272c 0a20 2020 2020 2020 2020 274d  34',.         'M
+0001dc70: 7573 7420 696e 636c 7564 6520 6174 206c  ust include at l
+0001dc80: 6561 7374 2031 206f 6620 7468 6520 666f  east 1 of the fo
+0001dc90: 6c6c 6f77 696e 673a 207e 2140 2324 255e  llowing: ~!@#$%^
+0001dca0: 262a 2829 5f2b 2d3d 3f3c 3e2c 2e3a 3b7b  &*()_+-=?<>,.:;{
+0001dcb0: 7d5b 5d7c 2729 0a20 2020 2020 2020 203e  }[]|').        >
+0001dcc0: 3e3e 2049 535f 5354 524f 4e47 2865 733d  >> IS_STRONG(es=
+0001dcd0: 5472 7565 2928 2741 6263 6431 3233 3421  True)('Abcd1234!
+0001dce0: 2729 0a20 2020 2020 2020 2028 2741 6263  ').        ('Abc
+0001dcf0: 6431 3233 3421 272c 204e 6f6e 6529 0a20  d1234!', None). 
+0001dd00: 2020 2020 2020 203e 3e3e 2049 535f 5354         >>> IS_ST
+0001dd10: 524f 4e47 2865 733d 5472 7565 2c20 656e  RONG(es=True, en
+0001dd20: 7472 6f70 793d 3129 2827 6127 290a 2020  tropy=1)('a').  
+0001dd30: 2020 2020 2020 2827 6127 2c20 4e6f 6e65        ('a', None
+0001dd40: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+0001dd50: 5f53 5452 4f4e 4728 6573 3d54 7275 652c  _STRONG(es=True,
+0001dd60: 2065 6e74 726f 7079 3d31 2c20 6d69 6e3d   entropy=1, min=
+0001dd70: 3229 2827 6127 290a 2020 2020 2020 2020  2)('a').        
+0001dd80: 2827 6127 2c20 274d 696e 696d 756d 206c  ('a', 'Minimum l
+0001dd90: 656e 6774 6820 6973 2032 2729 0a20 2020  ength is 2').   
+0001dda0: 2020 2020 203e 3e3e 2049 535f 5354 524f       >>> IS_STRO
+0001ddb0: 4e47 2865 733d 5472 7565 2c20 656e 7472  NG(es=True, entr
+0001ddc0: 6f70 793d 3130 3029 2827 6162 6331 3233  opy=100)('abc123
+0001ddd0: 2729 0a20 2020 2020 2020 2028 2761 6263  ').        ('abc
+0001dde0: 3132 3327 2c20 2750 6173 7377 6f72 6420  123', 'Password 
+0001ddf0: 746f 6f20 7369 6d70 6c65 2028 3332 2e33  too simple (32.3
+0001de00: 352f 3130 3029 2729 0a20 2020 2020 2020  5/100)').       
+0001de10: 203e 3e3e 2049 535f 5354 524f 4e47 2865   >>> IS_STRONG(e
+0001de20: 733d 5472 7565 2c20 656e 7472 6f70 793d  s=True, entropy=
+0001de30: 3130 3029 2827 616e 6427 290a 2020 2020  100)('and').    
+0001de40: 2020 2020 2827 616e 6427 2c20 2750 6173      ('and', 'Pas
+0001de50: 7377 6f72 6420 746f 6f20 7369 6d70 6c65  sword too simple
+0001de60: 2028 3134 2e35 372f 3130 3029 2729 0a20   (14.57/100)'). 
+0001de70: 2020 2020 2020 203e 3e3e 2049 535f 5354         >>> IS_ST
+0001de80: 524f 4e47 2865 733d 5472 7565 2c20 656e  RONG(es=True, en
+0001de90: 7472 6f70 793d 3130 3029 2827 6161 6127  tropy=100)('aaa'
+0001dea0: 290a 2020 2020 2020 2020 2827 6161 6127  ).        ('aaa'
+0001deb0: 2c20 2750 6173 7377 6f72 6420 746f 6f20  , 'Password too 
+0001dec0: 7369 6d70 6c65 2028 3134 2e34 322f 3130  simple (14.42/10
+0001ded0: 3029 2729 0a20 2020 2020 2020 203e 3e3e  0)').        >>>
+0001dee0: 2049 535f 5354 524f 4e47 2865 733d 5472   IS_STRONG(es=Tr
+0001def0: 7565 2c20 656e 7472 6f70 793d 3130 3029  ue, entropy=100)
+0001df00: 2827 6131 6427 290a 2020 2020 2020 2020  ('a1d').        
+0001df10: 2827 6131 6427 2c20 2750 6173 7377 6f72  ('a1d', 'Passwor
+0001df20: 6420 746f 6f20 7369 6d70 6c65 2028 3135  d too simple (15
+0001df30: 2e39 372f 3130 3029 2729 0a20 2020 2020  .97/100)').     
+0001df40: 2020 203e 3e3e 2049 535f 5354 524f 4e47     >>> IS_STRONG
+0001df50: 2865 733d 5472 7565 2c20 656e 7472 6f70  (es=True, entrop
+0001df60: 793d 3130 3029 2827 61c3 b164 2729 0a20  y=100)('a..d'). 
+0001df70: 2020 2020 2020 2028 2761 5c5c 7863 335c         ('a\\xc3\
+0001df80: 5c78 6231 6427 2c20 2750 6173 7377 6f72  \xb1d', 'Passwor
+0001df90: 6420 746f 6f20 7369 6d70 6c65 2028 3331  d too simple (31
+0001dfa0: 2e32 362f 3130 2927 290a 0a20 2020 2022  .26/10)')..    "
+0001dfb0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+0001dfc0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+0001dfd0: 6c66 2c0a 2020 2020 2020 2020 6d69 6e3d  lf,.        min=
+0001dfe0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d61  None,.        ma
+0001dff0: 783d 4e6f 6e65 2c0a 2020 2020 2020 2020  x=None,.        
+0001e000: 7570 7065 723d 4e6f 6e65 2c0a 2020 2020  upper=None,.    
+0001e010: 2020 2020 6c6f 7765 723d 4e6f 6e65 2c0a      lower=None,.
+0001e020: 2020 2020 2020 2020 6e75 6d62 6572 3d4e          number=N
+0001e030: 6f6e 652c 0a20 2020 2020 2020 2065 6e74  one,.        ent
+0001e040: 726f 7079 3d4e 6f6e 652c 0a20 2020 2020  ropy=None,.     
+0001e050: 2020 2073 7065 6369 616c 3d4e 6f6e 652c     special=None,
+0001e060: 0a20 2020 2020 2020 2073 7065 6369 616c  .        special
+0001e070: 733d 7222 7e21 4023 2425 5e26 2a28 295f  s=r"~!@#$%^&*()_
+0001e080: 2b2d 3d3f 3c3e 2c2e 3a3b 7b7d 5b5d 7c22  +-=?<>,.:;{}[]|"
+0001e090: 2c0a 2020 2020 2020 2020 696e 7661 6c69  ,.        invali
+0001e0a0: 643d 2720 2227 2c0a 2020 2020 2020 2020  d=' "',.        
+0001e0b0: 6572 726f 725f 6d65 7373 6167 653d 4e6f  error_message=No
+0001e0c0: 6e65 2c0a 2020 2020 2020 2020 6573 3d46  ne,.        es=F
+0001e0d0: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
+0001e0e0: 2020 2020 2073 656c 662e 656e 7472 6f70       self.entrop
+0001e0f0: 7920 3d20 656e 7472 6f70 790a 2020 2020  y = entropy.    
+0001e100: 2020 2020 6966 2065 6e74 726f 7079 2069      if entropy i
+0001e110: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001e120: 2020 2020 2320 656e 666f 7263 6520 6465      # enforce de
+0001e130: 6661 756c 7420 7265 7175 6972 656d 656e  fault requiremen
+0001e140: 7473 0a20 2020 2020 2020 2020 2020 2073  ts.            s
+0001e150: 656c 662e 6d69 6e20 3d20 3820 6966 206d  elf.min = 8 if m
+0001e160: 696e 2069 7320 4e6f 6e65 2065 6c73 6520  in is None else 
+0001e170: 6d69 6e0a 2020 2020 2020 2020 2020 2020  min.            
+0001e180: 7365 6c66 2e6d 6178 203d 206d 6178 2020  self.max = max  
+0001e190: 2320 7761 7320 3230 2c20 6275 7420 7468  # was 20, but th
+0001e1a0: 6174 2064 6f65 736e 2774 206d 616b 6520  at doesn't make 
+0001e1b0: 7365 6e73 650a 2020 2020 2020 2020 2020  sense.          
+0001e1c0: 2020 7365 6c66 2e75 7070 6572 203d 2031    self.upper = 1
+0001e1d0: 2069 6620 7570 7065 7220 6973 204e 6f6e   if upper is Non
+0001e1e0: 6520 656c 7365 2075 7070 6572 0a20 2020  e else upper.   
+0001e1f0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0001e200: 7765 7220 3d20 3120 6966 206c 6f77 6572  wer = 1 if lower
+0001e210: 2069 7320 4e6f 6e65 2065 6c73 6520 6c6f   is None else lo
+0001e220: 7765 720a 2020 2020 2020 2020 2020 2020  wer.            
+0001e230: 7365 6c66 2e6e 756d 6265 7220 3d20 3120  self.number = 1 
+0001e240: 6966 206e 756d 6265 7220 6973 204e 6f6e  if number is Non
+0001e250: 6520 656c 7365 206e 756d 6265 720a 2020  e else number.  
+0001e260: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+0001e270: 7065 6369 616c 203d 2031 2069 6620 7370  pecial = 1 if sp
+0001e280: 6563 6961 6c20 6973 204e 6f6e 6520 656c  ecial is None el
+0001e290: 7365 2073 7065 6369 616c 0a20 2020 2020  se special.     
+0001e2a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001e2b0: 2020 2020 2023 2062 7920 6465 6661 756c       # by defaul
+0001e2c0: 742c 2061 6e20 656e 7472 6f70 7920 7370  t, an entropy sp
+0001e2d0: 6563 2069 7320 6578 636c 7573 6976 650a  ec is exclusive.
+0001e2e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001e2f0: 2e6d 696e 203d 206d 696e 0a20 2020 2020  .min = min.     
+0001e300: 2020 2020 2020 2073 656c 662e 6d61 7820         self.max 
+0001e310: 3d20 6d61 780a 2020 2020 2020 2020 2020  = max.          
+0001e320: 2020 7365 6c66 2e75 7070 6572 203d 2075    self.upper = u
+0001e330: 7070 6572 0a20 2020 2020 2020 2020 2020  pper.           
+0001e340: 2073 656c 662e 6c6f 7765 7220 3d20 6c6f   self.lower = lo
+0001e350: 7765 720a 2020 2020 2020 2020 2020 2020  wer.            
+0001e360: 7365 6c66 2e6e 756d 6265 7220 3d20 6e75  self.number = nu
+0001e370: 6d62 6572 0a20 2020 2020 2020 2020 2020  mber.           
+0001e380: 2073 656c 662e 7370 6563 6961 6c20 3d20   self.special = 
+0001e390: 7370 6563 6961 6c0a 2020 2020 2020 2020  special.        
+0001e3a0: 7365 6c66 2e73 7065 6369 616c 7320 3d20  self.specials = 
+0001e3b0: 7370 6563 6961 6c73 0a20 2020 2020 2020  specials.       
+0001e3c0: 2073 656c 662e 696e 7661 6c69 6420 3d20   self.invalid = 
+0001e3d0: 696e 7661 6c69 640a 2020 2020 2020 2020  invalid.        
+0001e3e0: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
+0001e3f0: 6765 203d 2065 7272 6f72 5f6d 6573 7361  ge = error_messa
+0001e400: 6765 0a20 2020 2020 2020 2073 656c 662e  ge.        self.
+0001e410: 6573 7472 696e 6720 3d20 6573 2020 2320  estring = es  # 
+0001e420: 7265 7475 726e 2065 7272 6f72 206d 6573  return error mes
+0001e430: 7361 6765 2061 7320 7374 7269 6e67 2028  sage as string (
+0001e440: 666f 7220 646f 6374 6573 7429 0a0a 2020  for doctest)..  
+0001e450: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
+0001e460: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
+0001e470: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
+0001e480: 2020 2020 2066 6169 6c75 7265 7320 3d20       failures = 
+0001e490: 5b5d 0a20 2020 2020 2020 2069 6620 7661  [].        if va
+0001e4a0: 6c75 6520 6973 204e 6f6e 653a 0a20 2020  lue is None:.   
+0001e4b0: 2020 2020 2020 2020 2076 616c 7565 203d           value =
+0001e4c0: 2022 220a 2020 2020 2020 2020 6966 2076   "".        if v
+0001e4d0: 616c 7565 2061 6e64 206c 656e 2876 616c  alue and len(val
+0001e4e0: 7565 2920 3d3d 2076 616c 7565 2e63 6f75  ue) == value.cou
+0001e4f0: 6e74 2822 2a22 2920 3e20 343a 0a20 2020  nt("*") > 4:.   
+0001e500: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001e510: 7661 6c75 650a 2020 2020 2020 2020 6966  value.        if
+0001e520: 2073 656c 662e 656e 7472 6f70 7920 6973   self.entropy is
+0001e530: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001e540: 2020 2020 2020 2065 6e74 726f 7079 203d         entropy =
+0001e550: 2063 616c 635f 656e 7472 6f70 7928 7661   calc_entropy(va
+0001e560: 6c75 6529 0a20 2020 2020 2020 2020 2020  lue).           
+0001e570: 2069 6620 656e 7472 6f70 7920 3c20 7365   if entropy < se
+0001e580: 6c66 2e65 6e74 726f 7079 3a0a 2020 2020  lf.entropy:.    
+0001e590: 2020 2020 2020 2020 2020 2020 6661 696c              fail
+0001e5a0: 7572 6573 2e61 7070 656e 6428 0a20 2020  ures.append(.   
+0001e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e5c0: 2073 656c 662e 7472 616e 736c 6174 6f72   self.translator
+0001e5d0: 2822 5061 7373 776f 7264 2074 6f6f 2073  ("Password too s
+0001e5e0: 696d 706c 6520 2825 2868 6176 6529 732f  imple (%(have)s/
+0001e5f0: 2528 6e65 6564 2973 2922 290a 2020 2020  %(need)s)").    
+0001e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e610: 2520 6469 6374 2868 6176 653d 656e 7472  % dict(have=entr
+0001e620: 6f70 792c 206e 6565 643d 7365 6c66 2e65  opy, need=self.e
+0001e630: 6e74 726f 7079 290a 2020 2020 2020 2020  ntropy).        
+0001e640: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001e650: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001e660: 7365 6c66 2e6d 696e 2c20 696e 7429 2061  self.min, int) a
+0001e670: 6e64 2073 656c 662e 6d69 6e20 3e20 303a  nd self.min > 0:
+0001e680: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001e690: 6e6f 7420 6c65 6e28 7661 6c75 6529 203e  not len(value) >
+0001e6a0: 3d20 7365 6c66 2e6d 696e 3a0a 2020 2020  = self.min:.    
+0001e6b0: 2020 2020 2020 2020 2020 2020 6661 696c              fail
+0001e6c0: 7572 6573 2e61 7070 656e 6428 7365 6c66  ures.append(self
+0001e6d0: 2e74 7261 6e73 6c61 746f 7228 224d 696e  .translator("Min
+0001e6e0: 696d 756d 206c 656e 6774 6820 6973 2025  imum length is %
+0001e6f0: 7322 2920 2520 7365 6c66 2e6d 696e 290a  s") % self.min).
+0001e700: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001e710: 7461 6e63 6528 7365 6c66 2e6d 6178 2c20  tance(self.max, 
+0001e720: 696e 7429 2061 6e64 2073 656c 662e 6d61  int) and self.ma
+0001e730: 7820 3e20 303a 0a20 2020 2020 2020 2020  x > 0:.         
+0001e740: 2020 2069 6620 6e6f 7420 6c65 6e28 7661     if not len(va
+0001e750: 6c75 6529 203c 3d20 7365 6c66 2e6d 6178  lue) <= self.max
+0001e760: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e770: 2020 6661 696c 7572 6573 2e61 7070 656e    failures.appen
+0001e780: 6428 7365 6c66 2e74 7261 6e73 6c61 746f  d(self.translato
+0001e790: 7228 224d 6178 696d 756d 206c 656e 6774  r("Maximum lengt
+0001e7a0: 6820 6973 2025 7322 2920 2520 7365 6c66  h is %s") % self
+0001e7b0: 2e6d 6178 290a 2020 2020 2020 2020 6966  .max).        if
+0001e7c0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+0001e7d0: 2e73 7065 6369 616c 2c20 696e 7429 3a0a  .special, int):.
+0001e7e0: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+0001e7f0: 7370 6563 6961 6c20 3d20 5b63 6820 696e  special = [ch in
+0001e800: 2076 616c 7565 2066 6f72 2063 6820 696e   value for ch in
+0001e810: 2073 656c 662e 7370 6563 6961 6c73 5d0a   self.specials].
+0001e820: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001e830: 656c 662e 7370 6563 6961 6c20 3e20 303a  elf.special > 0:
+0001e840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e850: 2069 6620 6e6f 7420 616c 6c5f 7370 6563   if not all_spec
+0001e860: 6961 6c2e 636f 756e 7428 5472 7565 2920  ial.count(True) 
+0001e870: 3e3d 2073 656c 662e 7370 6563 6961 6c3a  >= self.special:
+0001e880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e890: 2020 2020 2066 6169 6c75 7265 732e 6170       failures.ap
+0001e8a0: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
+0001e8b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001e8c0: 6c66 2e74 7261 6e73 6c61 746f 7228 224d  lf.translator("M
+0001e8d0: 7573 7420 696e 636c 7564 6520 6174 206c  ust include at l
+0001e8e0: 6561 7374 2025 7320 6f66 2074 6865 2066  east %s of the f
+0001e8f0: 6f6c 6c6f 7769 6e67 3a20 2573 2229 0a20  ollowing: %s"). 
+0001e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e910: 2020 2020 2020 2025 2028 7365 6c66 2e73         % (self.s
+0001e920: 7065 6369 616c 2c20 7365 6c66 2e73 7065  pecial, self.spe
+0001e930: 6369 616c 7329 0a20 2020 2020 2020 2020  cials).         
+0001e940: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001e950: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+0001e960: 6c66 2e73 7065 6369 616c 203d 3d20 3020  lf.special == 0 
+0001e970: 616e 6420 7365 6c66 2e73 7065 6369 616c  and self.special
+0001e980: 2069 7320 6e6f 7420 4661 6c73 653a 0a20   is not False:. 
+0001e990: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001e9a0: 6620 6c65 6e28 5b69 7465 6d20 666f 7220  f len([item for 
+0001e9b0: 6974 656d 2069 6e20 616c 6c5f 7370 6563  item in all_spec
+0001e9c0: 6961 6c20 6966 2069 7465 6d5d 2920 3e20  ial if item]) > 
+0001e9d0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001e9e0: 2020 2020 2020 2066 6169 6c75 7265 732e         failures.
+0001e9f0: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+0001ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea10: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+0001ea20: 224d 6179 206e 6f74 2063 6f6e 7461 696e  "May not contain
+0001ea30: 2061 6e79 206f 6620 7468 6520 666f 6c6c   any of the foll
+0001ea40: 6f77 696e 673a 2025 7322 290a 2020 2020  owing: %s").    
+0001ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea60: 2020 2020 2520 7365 6c66 2e73 7065 6369      % self.speci
+0001ea70: 616c 730a 2020 2020 2020 2020 2020 2020  als.            
+0001ea80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001ea90: 2020 6966 2073 656c 662e 696e 7661 6c69    if self.invali
+0001eaa0: 643a 0a20 2020 2020 2020 2020 2020 2061  d:.            a
+0001eab0: 6c6c 5f69 6e76 616c 6964 203d 205b 6368  ll_invalid = [ch
+0001eac0: 2069 6e20 7661 6c75 6520 666f 7220 6368   in value for ch
+0001ead0: 2069 6e20 7365 6c66 2e69 6e76 616c 6964   in self.invalid
+0001eae0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+0001eaf0: 2061 6c6c 5f69 6e76 616c 6964 2e63 6f75   all_invalid.cou
+0001eb00: 6e74 2854 7275 6529 203e 2030 3a0a 2020  nt(True) > 0:.  
+0001eb10: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+0001eb20: 696c 7572 6573 2e61 7070 656e 6428 0a20  ilures.append(. 
+0001eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb40: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
+0001eb50: 6f72 2822 4d61 7920 6e6f 7420 636f 6e74  or("May not cont
+0001eb60: 6169 6e20 616e 7920 6f66 2074 6865 2066  ain any of the f
+0001eb70: 6f6c 6c6f 7769 6e67 3a20 2573 2229 0a20  ollowing: %s"). 
+0001eb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb90: 2020 2025 2073 656c 662e 696e 7661 6c69     % self.invali
+0001eba0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0001ebb0: 2020 290a 2020 2020 2020 2020 6966 2069    ).        if i
+0001ebc0: 7369 6e73 7461 6e63 6528 7365 6c66 2e75  sinstance(self.u
+0001ebd0: 7070 6572 2c20 696e 7429 3a0a 2020 2020  pper, int):.    
+0001ebe0: 2020 2020 2020 2020 616c 6c5f 7570 7065          all_uppe
+0001ebf0: 7220 3d20 7265 2e66 696e 6461 6c6c 2822  r = re.findall("
+0001ec00: 5b41 2d5a 5d22 2c20 7661 6c75 6529 0a20  [A-Z]", value). 
+0001ec10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001ec20: 6c66 2e75 7070 6572 203e 2030 3a0a 2020  lf.upper > 0:.  
+0001ec30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001ec40: 206e 6f74 206c 656e 2861 6c6c 5f75 7070   not len(all_upp
+0001ec50: 6572 2920 3e3d 2073 656c 662e 7570 7065  er) >= self.uppe
+0001ec60: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001ec70: 2020 2020 2020 2066 6169 6c75 7265 732e         failures.
+0001ec80: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+0001ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eca0: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+0001ecb0: 224d 7573 7420 696e 636c 7564 6520 6174  "Must include at
+0001ecc0: 206c 6561 7374 2025 7320 7570 7065 7263   least %s upperc
+0001ecd0: 6173 6522 290a 2020 2020 2020 2020 2020  ase").          
+0001ece0: 2020 2020 2020 2020 2020 2020 2020 2520                % 
+0001ecf0: 7374 7228 7365 6c66 2e75 7070 6572 290a  str(self.upper).
+0001ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed10: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001ed20: 2020 656c 6966 2073 656c 662e 7570 7065    elif self.uppe
+0001ed30: 7220 3d3d 2030 2061 6e64 2073 656c 662e  r == 0 and self.
+0001ed40: 7570 7065 7220 6973 206e 6f74 2046 616c  upper is not Fal
+0001ed50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001ed60: 2020 2020 6966 206c 656e 2861 6c6c 5f75      if len(all_u
+0001ed70: 7070 6572 2920 3e20 303a 0a20 2020 2020  pper) > 0:.     
+0001ed80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001ed90: 6169 6c75 7265 732e 6170 7065 6e64 280a  ailures.append(.
+0001eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001edb0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+0001edc0: 6e73 6c61 746f 7228 224d 6179 206e 6f74  nslator("May not
+0001edd0: 2069 6e63 6c75 6465 2061 6e79 2075 7070   include any upp
+0001ede0: 6572 6361 7365 206c 6574 7465 7273 2229  ercase letters")
+0001edf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ee00: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+0001ee10: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+0001ee20: 662e 6c6f 7765 722c 2069 6e74 293a 0a20  f.lower, int):. 
+0001ee30: 2020 2020 2020 2020 2020 2061 6c6c 5f6c             all_l
+0001ee40: 6f77 6572 203d 2072 652e 6669 6e64 616c  ower = re.findal
+0001ee50: 6c28 225b 612d 7a5d 222c 2076 616c 7565  l("[a-z]", value
+0001ee60: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001ee70: 2073 656c 662e 6c6f 7765 7220 3e20 303a   self.lower > 0:
+0001ee80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ee90: 2069 6620 6e6f 7420 6c65 6e28 616c 6c5f   if not len(all_
+0001eea0: 6c6f 7765 7229 203e 3d20 7365 6c66 2e6c  lower) >= self.l
+0001eeb0: 6f77 6572 3a0a 2020 2020 2020 2020 2020  ower:.          
+0001eec0: 2020 2020 2020 2020 2020 6661 696c 7572            failur
+0001eed0: 6573 2e61 7070 656e 6428 0a20 2020 2020  es.append(.     
+0001eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eef0: 2020 2073 656c 662e 7472 616e 736c 6174     self.translat
+0001ef00: 6f72 2822 4d75 7374 2069 6e63 6c75 6465  or("Must include
+0001ef10: 2061 7420 6c65 6173 7420 2573 206c 6f77   at least %s low
+0001ef20: 6572 6361 7365 2229 0a20 2020 2020 2020  ercase").       
+0001ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef40: 2025 2073 7472 2873 656c 662e 6c6f 7765   % str(self.lowe
+0001ef50: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
+0001ef60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001ef70: 2020 2020 2065 6c69 6620 7365 6c66 2e6c       elif self.l
+0001ef80: 6f77 6572 203d 3d20 3020 616e 6420 7365  ower == 0 and se
+0001ef90: 6c66 2e6c 6f77 6572 2069 7320 6e6f 7420  lf.lower is not 
+0001efa0: 4661 6c73 653a 0a20 2020 2020 2020 2020  False:.         
+0001efb0: 2020 2020 2020 2069 6620 6c65 6e28 616c         if len(al
+0001efc0: 6c5f 6c6f 7765 7229 203e 2030 3a0a 2020  l_lower) > 0:.  
+0001efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efe0: 2020 6661 696c 7572 6573 2e61 7070 656e    failures.appen
+0001eff0: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+0001f000: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f010: 7472 616e 736c 6174 6f72 2822 4d61 7920  translator("May 
+0001f020: 6e6f 7420 696e 636c 7564 6520 616e 7920  not include any 
+0001f030: 6c6f 7765 7263 6173 6520 6c65 7474 6572  lowercase letter
+0001f040: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+0001f050: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001f060: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001f070: 7365 6c66 2e6e 756d 6265 722c 2069 6e74  self.number, int
+0001f080: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0001f090: 6c6c 5f6e 756d 6265 7220 3d20 7265 2e66  ll_number = re.f
+0001f0a0: 696e 6461 6c6c 2822 5b30 2d39 5d22 2c20  indall("[0-9]", 
+0001f0b0: 7661 6c75 6529 0a20 2020 2020 2020 2020  value).         
+0001f0c0: 2020 2069 6620 7365 6c66 2e6e 756d 6265     if self.numbe
+0001f0d0: 7220 3e20 303a 0a20 2020 2020 2020 2020  r > 0:.         
+0001f0e0: 2020 2020 2020 206e 756d 6265 7273 203d         numbers =
+0001f0f0: 2022 6e75 6d62 6572 220a 2020 2020 2020   "number".      
+0001f100: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0001f110: 662e 6e75 6d62 6572 203e 2031 3a0a 2020  f.number > 1:.  
+0001f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f130: 2020 6e75 6d62 6572 7320 3d20 226e 756d    numbers = "num
+0001f140: 6265 7273 220a 2020 2020 2020 2020 2020  bers".          
+0001f150: 2020 2020 2020 6e75 6d62 6572 7320 3d20        numbers = 
+0001f160: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+0001f170: 6e75 6d62 6572 7329 0a20 2020 2020 2020  numbers).       
+0001f180: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001f190: 6c65 6e28 616c 6c5f 6e75 6d62 6572 2920  len(all_number) 
+0001f1a0: 3e3d 2073 656c 662e 6e75 6d62 6572 3a0a  >= self.number:.
 0001f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f1c0: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-0001f1d0: 224d 7573 7420 696e 636c 7564 6520 6174  "Must include at
-0001f1e0: 206c 6561 7374 2025 7320 2573 2229 0a20   least %s %s"). 
-0001f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f200: 2020 2020 2020 2025 2028 7374 7228 7365         % (str(se
-0001f210: 6c66 2e6e 756d 6265 7229 2c20 6e75 6d62  lf.number), numb
-0001f220: 6572 7329 0a20 2020 2020 2020 2020 2020  ers).           
-0001f230: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001f240: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0001f250: 2e6e 756d 6265 7220 3d3d 2030 2061 6e64  .number == 0 and
-0001f260: 2073 656c 662e 6e75 6d62 6572 2069 7320   self.number is 
-0001f270: 6e6f 7420 4661 6c73 653a 0a20 2020 2020  not False:.     
-0001f280: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0001f290: 6e28 616c 6c5f 6e75 6d62 6572 2920 3e20  n(all_number) > 
-0001f2a0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001f2b0: 2020 2020 2020 2066 6169 6c75 7265 732e         failures.
-0001f2c0: 6170 7065 6e64 2873 656c 662e 7472 616e  append(self.tran
-0001f2d0: 736c 6174 6f72 2822 4d61 7920 6e6f 7420  slator("May not 
-0001f2e0: 696e 636c 7564 6520 616e 7920 6e75 6d62  include any numb
-0001f2f0: 6572 7322 2929 0a20 2020 2020 2020 2069  ers")).        i
-0001f300: 6620 6c65 6e28 6661 696c 7572 6573 2920  f len(failures) 
-0001f310: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0001f320: 2020 7265 7475 726e 2076 616c 7565 0a20    return value. 
-0001f330: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0001f340: 6c66 2e65 7272 6f72 5f6d 6573 7361 6765  lf.error_message
-0001f350: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001f360: 2073 656c 662e 6573 7472 696e 673a 0a20   self.estring:. 
-0001f370: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001f380: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-0001f390: 7272 6f72 2822 7c22 2e6a 6f69 6e28 6d61  rror("|".join(ma
-0001f3a0: 7028 7374 722c 2066 6169 6c75 7265 7329  p(str, failures)
-0001f3b0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-0001f3c0: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
-0001f3d0: 7272 6f72 2822 2c20 222e 6a6f 696e 2866  rror(", ".join(f
-0001f3e0: 6169 6c75 7265 7329 290a 2020 2020 2020  ailures)).      
-0001f3f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001f400: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
-0001f410: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
-0001f420: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
-0001f430: 7272 6f72 5f6d 6573 7361 6765 2929 0a0a  rror_message))..
-0001f440: 0a63 6c61 7373 2049 535f 494d 4147 4528  .class IS_IMAGE(
-0001f450: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
-0001f460: 2222 220a 2020 2020 4368 6563 6b73 2069  """.    Checks i
-0001f470: 6620 6669 6c65 2075 706c 6f61 6465 6420  f file uploaded 
-0001f480: 7468 726f 7567 6820 6669 6c65 2069 6e70  through file inp
-0001f490: 7574 2077 6173 2073 6176 6564 2069 6e20  ut was saved in 
-0001f4a0: 6f6e 6520 6f66 2073 656c 6563 7465 640a  one of selected.
-0001f4b0: 2020 2020 696d 6167 6520 666f 726d 6174      image format
-0001f4c0: 7320 616e 6420 6861 7320 6469 6d65 6e73  s and has dimens
-0001f4d0: 696f 6e73 2028 7769 6474 6820 616e 6420  ions (width and 
-0001f4e0: 6865 6967 6874 2920 7769 7468 696e 2067  height) within g
-0001f4f0: 6976 656e 2062 6f75 6e64 6172 6965 732e  iven boundaries.
-0001f500: 0a0a 2020 2020 446f 6573 202a 6e6f 742a  ..    Does *not*
-0001f510: 2063 6865 636b 2066 6f72 206d 6178 696d   check for maxim
-0001f520: 756d 2066 696c 6520 7369 7a65 2028 7573  um file size (us
-0001f530: 6520 4953 5f4c 454e 4754 4820 666f 7220  e IS_LENGTH for 
-0001f540: 7468 6174 292e 2052 6574 7572 6e73 0a20  that). Returns. 
-0001f550: 2020 2076 616c 6964 6174 696f 6e20 6661     validation fa
-0001f560: 696c 7572 6520 6966 206e 6f20 6461 7461  ilure if no data
-0001f570: 2077 6173 2075 706c 6f61 6465 642e 0a0a   was uploaded...
-0001f580: 2020 2020 5375 7070 6f72 7465 6420 6669      Supported fi
-0001f590: 6c65 2066 6f72 6d61 7473 3a20 424d 502c  le formats: BMP,
-0001f5a0: 2047 4946 2c20 4a50 4547 2c20 504e 472e   GIF, JPEG, PNG.
-0001f5b0: 0a0a 2020 2020 436f 6465 2070 6172 7473  ..    Code parts
-0001f5c0: 2074 616b 656e 2066 726f 6d0a 2020 2020   taken from.    
-0001f5d0: 6874 7470 3a2f 2f6d 6169 6c2e 7079 7468  http://mail.pyth
-0001f5e0: 6f6e 2e6f 7267 2f70 6970 6572 6d61 696c  on.org/pipermail
-0001f5f0: 2f70 7974 686f 6e2d 6c69 7374 2f32 3030  /python-list/200
-0001f600: 372d 4a75 6e65 2f36 3137 3132 362e 6874  7-June/617126.ht
-0001f610: 6d6c 0a0a 2020 2020 4172 6773 3a0a 2020  ml..    Args:.  
-0001f620: 2020 2020 2020 6578 7465 6e73 696f 6e73        extensions
-0001f630: 3a20 6974 6572 6162 6c65 2063 6f6e 7461  : iterable conta
-0001f640: 696e 696e 6720 616c 6c6f 7765 6420 2a6c  ining allowed *l
-0001f650: 6f77 6572 6361 7365 2a20 696d 6167 6520  owercase* image 
-0001f660: 6669 6c65 2065 7874 656e 7369 6f6e 730a  file extensions.
-0001f670: 2020 2020 2020 2020 2827 6a70 6727 2065          ('jpg' e
-0001f680: 7874 656e 7369 6f6e 206f 6620 7570 6c6f  xtension of uplo
-0001f690: 6164 6564 2066 696c 6520 636f 756e 7473  aded file counts
-0001f6a0: 2061 7320 276a 7065 6727 290a 2020 2020   as 'jpeg').    
-0001f6b0: 2020 2020 6d61 7873 697a 653a 2069 7465      maxsize: ite
-0001f6c0: 7261 626c 6520 636f 6e74 6169 6e69 6e67  rable containing
-0001f6d0: 206d 6178 696d 756d 2077 6964 7468 2061   maximum width a
-0001f6e0: 6e64 2068 6569 6768 7420 6f66 2074 6865  nd height of the
-0001f6f0: 2069 6d61 6765 0a20 2020 2020 2020 206d   image.        m
-0001f700: 696e 7369 7a65 3a20 6974 6572 6162 6c65  insize: iterable
-0001f710: 2063 6f6e 7461 696e 696e 6720 6d69 6e69   containing mini
-0001f720: 6d75 6d20 7769 6474 6820 616e 6420 6865  mum width and he
-0001f730: 6967 6874 206f 6620 7468 6520 696d 6167  ight of the imag
-0001f740: 650a 2020 2020 2020 2020 6173 7065 6374  e.        aspect
-0001f750: 7261 7469 6f3a 2069 7465 7261 626c 6520  ratio: iterable 
-0001f760: 636f 6e74 6169 6e69 6e67 2074 6172 6765  containing targe
-0001f770: 7420 6173 7065 6374 2072 6174 696f 0a0a  t aspect ratio..
-0001f780: 2020 2020 5573 6520 282d 312c 202d 3129      Use (-1, -1)
-0001f790: 2061 7320 6d69 6e73 697a 6520 746f 2070   as minsize to p
-0001f7a0: 6173 7320 696d 6167 6520 7369 7a65 2063  ass image size c
-0001f7b0: 6865 636b 2e0a 2020 2020 5573 6520 282d  heck..    Use (-
-0001f7c0: 312c 202d 3129 2061 7320 6173 7065 6374  1, -1) as aspect
-0001f7d0: 7261 7469 6f20 746f 2070 6173 7320 6173  ratio to pass as
-0001f7e0: 7065 6374 2072 6174 696f 2063 6865 636b  pect ratio check
-0001f7f0: 2e0a 0a20 2020 2045 7861 6d70 6c65 733a  ...    Examples:
-0001f800: 0a20 2020 2020 2020 2043 6865 636b 2069  .        Check i
-0001f810: 6620 7570 6c6f 6164 6564 2066 696c 6520  f uploaded file 
-0001f820: 6973 2069 6e20 616e 7920 6f66 2073 7570  is in any of sup
-0001f830: 706f 7274 6564 2069 6d61 6765 2066 6f72  ported image for
-0001f840: 6d61 7473 3a0a 0a20 2020 2020 2020 2020  mats:..         
-0001f850: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
-0001f860: 6669 6c65 272c 205f 6e61 6d65 3d27 6e61  file', _name='na
-0001f870: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
-0001f880: 5f49 4d41 4745 2829 290a 0a20 2020 2020  _IMAGE())..     
-0001f890: 2020 2043 6865 636b 2069 6620 7570 6c6f     Check if uplo
-0001f8a0: 6164 6564 2066 696c 6520 6973 2065 6974  aded file is eit
-0001f8b0: 6865 7220 4a50 4547 206f 7220 504e 473a  her JPEG or PNG:
-0001f8c0: 0a0a 2020 2020 2020 2020 2020 2020 494e  ..            IN
-0001f8d0: 5055 5428 5f74 7970 653d 2766 696c 6527  PUT(_type='file'
-0001f8e0: 2c20 5f6e 616d 653d 276e 616d 6527 2c0a  , _name='name',.
-0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f900: 7265 7175 6972 6573 3d49 535f 494d 4147  requires=IS_IMAG
-0001f910: 4528 6578 7465 6e73 696f 6e73 3d28 276a  E(extensions=('j
-0001f920: 7065 6727 2c20 2770 6e67 2729 2929 0a0a  peg', 'png')))..
-0001f930: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
-0001f940: 2075 706c 6f61 6465 6420 6669 6c65 2069   uploaded file i
-0001f950: 7320 504e 4720 7769 7468 206d 6178 696d  s PNG with maxim
-0001f960: 756d 2073 697a 6520 6f66 2032 3030 7832  um size of 200x2
-0001f970: 3030 2070 6978 656c 733a 0a0a 2020 2020  00 pixels:..    
-0001f980: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
-0001f990: 7970 653d 2766 696c 6527 2c20 5f6e 616d  ype='file', _nam
-0001f9a0: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
-0001f9b0: 2020 2020 2020 2020 2020 7265 7175 6972            requir
-0001f9c0: 6573 3d49 535f 494d 4147 4528 6578 7465  es=IS_IMAGE(exte
-0001f9d0: 6e73 696f 6e73 3d28 2770 6e67 2729 2c20  nsions=('png'), 
-0001f9e0: 6d61 7873 697a 653d 2832 3030 2c20 3230  maxsize=(200, 20
-0001f9f0: 3029 2929 0a0a 2020 2020 2020 2020 4368  0)))..        Ch
-0001fa00: 6563 6b20 6966 2075 706c 6f61 6465 6420  eck if uploaded 
-0001fa10: 6669 6c65 2068 6173 2061 2031 363a 3920  file has a 16:9 
-0001fa20: 6173 7065 6374 2072 6174 696f 3a0a 0a20  aspect ratio:.. 
-0001fa30: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
-0001fa40: 285f 7479 7065 3d27 6669 6c65 272c 205f  (_type='file', _
-0001fa50: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
-0001fa60: 2020 2020 2020 2020 2020 2020 2072 6571               req
-0001fa70: 7569 7265 733d 4953 5f49 4d41 4745 2861  uires=IS_IMAGE(a
-0001fa80: 7370 6563 7472 6174 696f 3d28 3136 2c20  spectratio=(16, 
-0001fa90: 3929 2929 0a20 2020 2022 2222 0a0a 2020  9))).    """..  
-0001faa0: 2020 6465 6620 5f5f 696e 6974 5f5f 280a    def __init__(.
-0001fab0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001fac0: 2020 2020 2020 6578 7465 6e73 696f 6e73        extensions
-0001fad0: 3d28 2262 6d70 222c 2022 6769 6622 2c20  =("bmp", "gif", 
-0001fae0: 226a 7065 6722 2c20 2270 6e67 2229 2c0a  "jpeg", "png"),.
-0001faf0: 2020 2020 2020 2020 6d61 7873 697a 653d          maxsize=
-0001fb00: 2831 3030 3030 2c20 3130 3030 3029 2c0a  (10000, 10000),.
-0001fb10: 2020 2020 2020 2020 6d69 6e73 697a 653d          minsize=
-0001fb20: 2830 2c20 3029 2c0a 2020 2020 2020 2020  (0, 0),.        
-0001fb30: 6173 7065 6374 7261 7469 6f3d 282d 312c  aspectratio=(-1,
-0001fb40: 202d 3129 2c0a 2020 2020 2020 2020 6572   -1),.        er
-0001fb50: 726f 725f 6d65 7373 6167 653d 2249 6e76  ror_message="Inv
-0001fb60: 616c 6964 2069 6d61 6765 222c 0a20 2020  alid image",.   
-0001fb70: 2029 3a0a 2020 2020 2020 2020 7365 6c66   ):.        self
-0001fb80: 2e65 7874 656e 7369 6f6e 7320 3d20 6578  .extensions = ex
-0001fb90: 7465 6e73 696f 6e73 0a20 2020 2020 2020  tensions.       
-0001fba0: 2073 656c 662e 6d61 7873 697a 6520 3d20   self.maxsize = 
-0001fbb0: 6d61 7873 697a 650a 2020 2020 2020 2020  maxsize.        
-0001fbc0: 7365 6c66 2e6d 696e 7369 7a65 203d 206d  self.minsize = m
-0001fbd0: 696e 7369 7a65 0a20 2020 2020 2020 2073  insize.        s
-0001fbe0: 656c 662e 6173 7065 6374 7261 7469 6f20  elf.aspectratio 
-0001fbf0: 3d20 6173 7065 6374 7261 7469 6f0a 2020  = aspectratio.  
-0001fc00: 2020 2020 2020 7365 6c66 2e65 7272 6f72        self.error
-0001fc10: 5f6d 6573 7361 6765 203d 2065 7272 6f72  _message = error
-0001fc20: 5f6d 6573 7361 6765 0a0a 2020 2020 6465  _message..    de
-0001fc30: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
-0001fc40: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
-0001fc50: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
-0001fc60: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0001fc70: 2020 6578 7465 6e73 696f 6e20 3d20 7661    extension = va
-0001fc80: 6c75 652e 6669 6c65 6e61 6d65 2e72 6669  lue.filename.rfi
-0001fc90: 6e64 2822 2e22 290a 2020 2020 2020 2020  nd(".").        
-0001fca0: 2020 2020 6173 7365 7274 2065 7874 656e      assert exten
-0001fcb0: 7369 6f6e 203e 3d20 300a 2020 2020 2020  sion >= 0.      
-0001fcc0: 2020 2020 2020 6578 7465 6e73 696f 6e20        extension 
-0001fcd0: 3d20 7661 6c75 652e 6669 6c65 6e61 6d65  = value.filename
-0001fce0: 5b65 7874 656e 7369 6f6e 202b 2031 203a  [extension + 1 :
-0001fcf0: 5d2e 6c6f 7765 7228 290a 2020 2020 2020  ].lower().      
-0001fd00: 2020 2020 2020 6966 2065 7874 656e 7369        if extensi
-0001fd10: 6f6e 203d 3d20 226a 7067 223a 0a20 2020  on == "jpg":.   
-0001fd20: 2020 2020 2020 2020 2020 2020 2065 7874               ext
-0001fd30: 656e 7369 6f6e 203d 2022 6a70 6567 220a  ension = "jpeg".
-0001fd40: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-0001fd50: 7274 2065 7874 656e 7369 6f6e 2069 6e20  rt extension in 
-0001fd60: 7365 6c66 2e65 7874 656e 7369 6f6e 730a  self.extensions.
-0001fd70: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-0001fd80: 7874 656e 7369 6f6e 203d 3d20 2262 6d70  xtension == "bmp
-0001fd90: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-0001fda0: 2020 2077 6964 7468 2c20 6865 6967 6874     width, height
-0001fdb0: 203d 2073 656c 662e 5f5f 626d 7028 7661   = self.__bmp(va
-0001fdc0: 6c75 652e 6669 6c65 290a 2020 2020 2020  lue.file).      
-0001fdd0: 2020 2020 2020 656c 6966 2065 7874 656e        elif exten
-0001fde0: 7369 6f6e 203d 3d20 2267 6966 223a 0a20  sion == "gif":. 
-0001fdf0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0001fe00: 6964 7468 2c20 6865 6967 6874 203d 2073  idth, height = s
-0001fe10: 656c 662e 5f5f 6769 6628 7661 6c75 652e  elf.__gif(value.
-0001fe20: 6669 6c65 290a 2020 2020 2020 2020 2020  file).          
-0001fe30: 2020 656c 6966 2065 7874 656e 7369 6f6e    elif extension
-0001fe40: 203d 3d20 226a 7065 6722 3a0a 2020 2020   == "jpeg":.    
-0001fe50: 2020 2020 2020 2020 2020 2020 7769 6474              widt
-0001fe60: 682c 2068 6569 6768 7420 3d20 7365 6c66  h, height = self
-0001fe70: 2e5f 5f6a 7065 6728 7661 6c75 652e 6669  .__jpeg(value.fi
-0001fe80: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-0001fe90: 656c 6966 2065 7874 656e 7369 6f6e 203d  elif extension =
-0001fea0: 3d20 2270 6e67 223a 0a20 2020 2020 2020  = "png":.       
-0001feb0: 2020 2020 2020 2020 2077 6964 7468 2c20           width, 
-0001fec0: 6865 6967 6874 203d 2073 656c 662e 5f5f  height = self.__
-0001fed0: 706e 6728 7661 6c75 652e 6669 6c65 290a  png(value.file).
-0001fee0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001fef0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ff00: 2020 7769 6474 6820 3d20 2d31 0a20 2020    width = -1.   
-0001ff10: 2020 2020 2020 2020 2020 2020 2068 6569               hei
-0001ff20: 6768 7420 3d20 2d31 0a0a 2020 2020 2020  ght = -1..      
-0001ff30: 2020 2020 2020 6173 7365 7274 2028 0a20        assert (. 
-0001ff40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ff50: 656c 662e 6d69 6e73 697a 655b 305d 203c  elf.minsize[0] <
-0001ff60: 3d20 7769 6474 6820 3c3d 2073 656c 662e  = width <= self.
-0001ff70: 6d61 7873 697a 655b 305d 0a20 2020 2020  maxsize[0].     
-0001ff80: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
-0001ff90: 656c 662e 6d69 6e73 697a 655b 315d 203c  elf.minsize[1] <
-0001ffa0: 3d20 6865 6967 6874 203c 3d20 7365 6c66  = height <= self
-0001ffb0: 2e6d 6178 7369 7a65 5b31 5d0a 2020 2020  .maxsize[1].    
-0001ffc0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001ffd0: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
-0001ffe0: 7370 6563 7472 6174 696f 203e 2028 2d31  spectratio > (-1
-0001fff0: 2c20 2d31 293a 0a20 2020 2020 2020 2020  , -1):.         
-00020000: 2020 2020 2020 2074 6172 6765 745f 7261         target_ra
-00020010: 7469 6f20 3d20 2831 2e30 202a 2073 656c  tio = (1.0 * sel
-00020020: 662e 6173 7065 6374 7261 7469 6f5b 315d  f.aspectratio[1]
-00020030: 2920 2f20 7365 6c66 2e61 7370 6563 7472  ) / self.aspectr
-00020040: 6174 696f 5b30 5d0a 2020 2020 2020 2020  atio[0].        
-00020050: 2020 2020 2020 2020 6163 7475 616c 5f72          actual_r
-00020060: 6174 696f 203d 2028 312e 3020 2a20 6865  atio = (1.0 * he
-00020070: 6967 6874 2920 2f20 7769 6474 680a 0a20  ight) / width.. 
-00020080: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00020090: 7373 6572 7420 6163 7475 616c 5f72 6174  ssert actual_rat
-000200a0: 696f 203d 3d20 7461 7267 6574 5f72 6174  io == target_rat
-000200b0: 696f 0a0a 2020 2020 2020 2020 2020 2020  io..            
-000200c0: 7661 6c75 652e 6669 6c65 2e73 6565 6b28  value.file.seek(
-000200d0: 3029 0a20 2020 2020 2020 2020 2020 2072  0).            r
-000200e0: 6574 7572 6e20 7661 6c75 650a 2020 2020  eturn value.    
-000200f0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00020100: 7469 6f6e 2061 7320 653a 0a20 2020 2020  tion as e:.     
-00020110: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00020120: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
-00020130: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
-00020140: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
-00020150: 290a 0a20 2020 2064 6566 205f 5f62 6d70  )..    def __bmp
-00020160: 2873 656c 662c 2073 7472 6561 6d29 3a0a  (self, stream):.
-00020170: 2020 2020 2020 2020 6966 2073 7472 6561          if strea
-00020180: 6d2e 7265 6164 2832 2920 3d3d 2062 2242  m.read(2) == b"B
-00020190: 4d22 3a0a 2020 2020 2020 2020 2020 2020  M":.            
-000201a0: 7374 7265 616d 2e72 6561 6428 3136 290a  stream.read(16).
-000201b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000201c0: 726e 2073 7472 7563 742e 756e 7061 636b  rn struct.unpack
-000201d0: 2822 3c4c 4c22 2c20 7374 7265 616d 2e72  ("<LL", stream.r
-000201e0: 6561 6428 3829 290a 2020 2020 2020 2020  ead(8)).        
-000201f0: 7265 7475 726e 2028 2d31 2c20 2d31 290a  return (-1, -1).
-00020200: 0a20 2020 2064 6566 205f 5f67 6966 2873  .    def __gif(s
-00020210: 656c 662c 2073 7472 6561 6d29 3a0a 2020  elf, stream):.  
-00020220: 2020 2020 2020 6966 2073 7472 6561 6d2e        if stream.
-00020230: 7265 6164 2836 2920 696e 2028 6222 4749  read(6) in (b"GI
-00020240: 4638 3761 222c 2062 2247 4946 3839 6122  F87a", b"GIF89a"
-00020250: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00020260: 7472 6561 6d20 3d20 7374 7265 616d 2e72  tream = stream.r
-00020270: 6561 6428 3529 0a20 2020 2020 2020 2020  ead(5).         
-00020280: 2020 2069 6620 6c65 6e28 7374 7265 616d     if len(stream
-00020290: 2920 3d3d 2035 3a0a 2020 2020 2020 2020  ) == 5:.        
-000202a0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-000202b0: 7570 6c65 2873 7472 7563 742e 756e 7061  uple(struct.unpa
-000202c0: 636b 2822 3c48 4842 222c 2073 7472 6561  ck("<HHB", strea
-000202d0: 6d29 5b3a 2d31 5d29 0a20 2020 2020 2020  m)[:-1]).       
-000202e0: 2072 6574 7572 6e20 282d 312c 202d 3129   return (-1, -1)
-000202f0: 0a0a 2020 2020 6465 6620 5f5f 6a70 6567  ..    def __jpeg
-00020300: 2873 656c 662c 2073 7472 6561 6d29 3a0a  (self, stream):.
-00020310: 2020 2020 2020 2020 6966 2073 7472 6561          if strea
-00020320: 6d2e 7265 6164 2832 2920 3d3d 2062 225c  m.read(2) == b"\
-00020330: 7846 465c 7844 3822 3a0a 2020 2020 2020  xFF\xD8":.      
-00020340: 2020 2020 2020 7768 696c 6520 5472 7565        while True
-00020350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020360: 2020 286d 6172 6b65 722c 2063 6f64 652c    (marker, code,
-00020370: 206c 656e 6774 6829 203d 2073 7472 7563   length) = struc
-00020380: 742e 756e 7061 636b 2822 2142 4248 222c  t.unpack("!BBH",
-00020390: 2073 7472 6561 6d2e 7265 6164 2834 2929   stream.read(4))
-000203a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000203b0: 2069 6620 6d61 726b 6572 2021 3d20 3078   if marker != 0x
-000203c0: 4646 3a0a 2020 2020 2020 2020 2020 2020  FF:.            
-000203d0: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-000203e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000203f0: 6966 2063 6f64 6520 3e3d 2030 7843 3020  if code >= 0xC0 
-00020400: 616e 6420 636f 6465 203c 3d20 3078 4333  and code <= 0xC3
-00020410: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020420: 2020 2020 2020 7265 7475 726e 2074 7570        return tup
-00020430: 6c65 2872 6576 6572 7365 6428 7374 7275  le(reversed(stru
-00020440: 6374 2e75 6e70 6163 6b28 2221 7848 4822  ct.unpack("!xHH"
-00020450: 2c20 7374 7265 616d 2e72 6561 6428 3529  , stream.read(5)
-00020460: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-00020470: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00020480: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00020490: 7265 616d 2e72 6561 6428 6c65 6e67 7468  ream.read(length
-000204a0: 202d 2032 290a 2020 2020 2020 2020 7265   - 2).        re
-000204b0: 7475 726e 2028 2d31 2c20 2d31 290a 0a20  turn (-1, -1).. 
-000204c0: 2020 2064 6566 205f 5f70 6e67 2873 656c     def __png(sel
-000204d0: 662c 2073 7472 6561 6d29 3a0a 2020 2020  f, stream):.    
-000204e0: 2020 2020 6966 2073 7472 6561 6d2e 7265      if stream.re
-000204f0: 6164 2838 2920 3d3d 2062 225c 3231 3150  ad(8) == b"\211P
-00020500: 4e47 5c72 5c6e 5c30 3332 5c6e 223a 0a20  NG\r\n\032\n":. 
-00020510: 2020 2020 2020 2020 2020 2073 7472 6561             strea
-00020520: 6d2e 7265 6164 2834 290a 2020 2020 2020  m.read(4).      
-00020530: 2020 2020 2020 6966 2073 7472 6561 6d2e        if stream.
-00020540: 7265 6164 2834 2920 3d3d 2062 2249 4844  read(4) == b"IHD
-00020550: 5222 3a0a 2020 2020 2020 2020 2020 2020  R":.            
-00020560: 2020 2020 7265 7475 726e 2073 7472 7563      return struc
-00020570: 742e 756e 7061 636b 2822 214c 4c22 2c20  t.unpack("!LL", 
-00020580: 7374 7265 616d 2e72 6561 6428 3829 290a  stream.read(8)).
-00020590: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-000205a0: 2d31 2c20 2d31 290a 0a0a 636c 6173 7320  -1, -1)...class 
-000205b0: 4953 5f46 494c 4528 5661 6c69 6461 746f  IS_FILE(Validato
-000205c0: 7229 3a0a 2020 2020 2222 220a 2020 2020  r):.    """.    
-000205d0: 4368 6563 6b73 2069 6620 6e61 6d65 2061  Checks if name a
-000205e0: 6e64 2065 7874 656e 7369 6f6e 206f 6620  nd extension of 
-000205f0: 6669 6c65 2075 706c 6f61 6465 6420 7468  file uploaded th
-00020600: 726f 7567 6820 6669 6c65 2069 6e70 7574  rough file input
-00020610: 206d 6174 6368 6573 0a20 2020 2067 6976   matches.    giv
-00020620: 656e 2063 7269 7465 7269 612e 0a0a 2020  en criteria...  
-00020630: 2020 446f 6573 202a 6e6f 742a 2065 6e73    Does *not* ens
-00020640: 7572 6520 7468 6520 6669 6c65 2074 7970  ure the file typ
-00020650: 6520 696e 2061 6e79 2077 6179 2e20 5265  e in any way. Re
-00020660: 7475 726e 7320 7661 6c69 6461 7469 6f6e  turns validation
-00020670: 2066 6169 6c75 7265 0a20 2020 2069 6620   failure.    if 
-00020680: 6e6f 2064 6174 6120 7761 7320 7570 6c6f  no data was uplo
-00020690: 6164 6564 2e0a 0a20 2020 2041 7267 733a  aded...    Args:
-000206a0: 0a20 2020 2020 2020 2066 696c 656e 616d  .        filenam
-000206b0: 653a 2073 7472 696e 672f 636f 6d70 696c  e: string/compil
-000206c0: 6564 2072 6567 6578 206f 7220 6120 6c69  ed regex or a li
-000206d0: 7374 206f 6620 7374 7269 6e67 732f 7265  st of strings/re
-000206e0: 6765 7820 6f66 2076 616c 6964 2066 696c  gex of valid fil
-000206f0: 656e 616d 6573 0a20 2020 2020 2020 2065  enames.        e
-00020700: 7874 656e 7369 6f6e 3a20 7374 7269 6e67  xtension: string
-00020710: 2f63 6f6d 7069 6c65 6420 7265 6765 7820  /compiled regex 
-00020720: 6f72 2061 206c 6973 7420 6f66 2073 7472  or a list of str
-00020730: 696e 6773 2f72 6567 6578 206f 6620 7661  ings/regex of va
-00020740: 6c69 6420 6578 7465 6e73 696f 6e73 0a20  lid extensions. 
-00020750: 2020 2020 2020 206c 6173 7464 6f74 3a20         lastdot: 
-00020760: 7768 6963 6820 646f 7420 7368 6f75 6c64  which dot should
-00020770: 2062 6520 7573 6564 2061 7320 6120 6669   be used as a fi
-00020780: 6c65 6e61 6d65 202f 2065 7874 656e 7369  lename / extensi
-00020790: 6f6e 2073 6570 6172 6174 6f72 3a0a 2020  on separator:.  
-000207a0: 2020 2020 2020 2020 2020 5472 7565 206d            True m
-000207b0: 6561 6e73 206c 6173 7420 646f 742c 2065  eans last dot, e
-000207c0: 672e 2066 696c 652e 6a70 672e 706e 6720  g. file.jpg.png 
-000207d0: 2d3e 2066 696c 652e 6a70 6720 2f20 706e  -> file.jpg / pn
-000207e0: 670a 2020 2020 2020 2020 2020 2020 4661  g.            Fa
-000207f0: 6c73 6520 6d65 616e 7320 6669 7273 7420  lse means first 
-00020800: 646f 742c 2065 672e 2066 696c 652e 7461  dot, eg. file.ta
-00020810: 722e 677a 202d 3e20 6669 6c65 202f 2074  r.gz -> file / t
-00020820: 6172 2e67 7a0a 2020 2020 2020 2020 6361  ar.gz.        ca
-00020830: 7365 3a20 3020 2d20 6b65 6570 2074 6865  se: 0 - keep the
-00020840: 2063 6173 652c 2031 202d 2074 7261 6e73   case, 1 - trans
-00020850: 666f 726d 2074 6865 2073 7472 696e 6720  form the string 
-00020860: 696e 746f 206c 6f77 6572 6361 7365 2028  into lowercase (
-00020870: 6465 6661 756c 7429 2c0a 2020 2020 2020  default),.      
-00020880: 2020 2020 2020 3220 2d20 7472 616e 7366        2 - transf
-00020890: 6f72 6d20 7468 6520 7374 7269 6e67 2069  orm the string i
-000208a0: 6e74 6f20 7570 7065 7263 6173 650a 0a20  nto uppercase.. 
-000208b0: 2020 2049 6620 7468 6572 6520 6973 206e     If there is n
-000208c0: 6f20 646f 7420 7072 6573 656e 742c 2065  o dot present, e
-000208d0: 7874 656e 7369 6f6e 2063 6865 636b 7320  xtension checks 
-000208e0: 7769 6c6c 2062 6520 646f 6e65 2061 6761  will be done aga
-000208f0: 696e 7374 2065 6d70 7479 0a20 2020 2073  inst empty.    s
-00020900: 7472 696e 6720 616e 6420 6669 6c65 6e61  tring and filena
-00020910: 6d65 2063 6865 636b 7320 6167 6169 6e73  me checks agains
-00020920: 7420 7768 6f6c 6520 7661 6c75 652e 0a0a  t whole value...
-00020930: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
-00020940: 2020 2020 2020 4368 6563 6b20 6966 2066        Check if f
-00020950: 696c 6520 6861 7320 6120 7064 6620 6578  ile has a pdf ex
-00020960: 7465 6e73 696f 6e20 2863 6173 6520 696e  tension (case in
-00020970: 7365 6e73 6974 6976 6529 3a0a 0a20 2020  sensitive):..   
-00020980: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00020990: 3d27 6669 6c65 272c 205f 6e61 6d65 3d27  ='file', _name='
-000209a0: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
-000209b0: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
-000209c0: 4953 5f46 494c 4528 6578 7465 6e73 696f  IS_FILE(extensio
-000209d0: 6e3d 2770 6466 2729 290a 0a20 2020 2020  n='pdf'))..     
-000209e0: 2020 2043 6865 636b 2069 6620 6669 6c65     Check if file
-000209f0: 2069 7320 6361 6c6c 6564 2027 7468 756d   is called 'thum
-00020a00: 626e 6169 6c27 2061 6e64 2068 6173 2061  bnail' and has a
-00020a10: 206a 7067 206f 7220 706e 6720 6578 7465   jpg or png exte
-00020a20: 6e73 696f 6e0a 2020 2020 2020 2020 2863  nsion.        (c
-00020a30: 6173 6520 696e 7365 6e73 6974 6976 6529  ase insensitive)
-00020a40: 3a0a 0a20 2020 2020 2020 2049 4e50 5554  :..        INPUT
-00020a50: 285f 7479 7065 3d27 6669 6c65 272c 205f  (_type='file', _
-00020a60: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
-00020a70: 2020 2020 2020 2020 2020 2020 2072 6571               req
-00020a80: 7569 7265 733d 4953 5f46 494c 4528 6669  uires=IS_FILE(fi
-00020a90: 6c65 6e61 6d65 3d27 7468 756d 626e 6169  lename='thumbnai
-00020aa0: 6c27 2c0a 2020 2020 2020 2020 2020 2020  l',.            
-00020ab0: 2020 2020 6578 7465 6e73 696f 6e3d 5b27      extension=['
-00020ac0: 6a70 6727 2c20 2770 6e67 275d 2929 0a0a  jpg', 'png']))..
-00020ad0: 2020 2020 2020 2020 4368 6563 6b20 6966          Check if
-00020ae0: 2066 696c 6520 6861 7320 6120 7461 722e   file has a tar.
-00020af0: 677a 2065 7874 656e 7369 6f6e 2061 6e64  gz extension and
-00020b00: 206e 616d 6520 7374 6172 7469 6e67 2077   name starting w
-00020b10: 6974 6820 6261 636b 7570 3a0a 0a20 2020  ith backup:..   
-00020b20: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00020b30: 3d27 6669 6c65 272c 205f 6e61 6d65 3d27  ='file', _name='
-00020b40: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
-00020b50: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
-00020b60: 4953 5f46 494c 4528 6669 6c65 6e61 6d65  IS_FILE(filename
-00020b70: 3d72 652e 636f 6d70 696c 6528 2762 6163  =re.compile('bac
-00020b80: 6b75 702e 2a27 292c 0a20 2020 2020 2020  kup.*'),.       
-00020b90: 2020 2020 2020 2020 2065 7874 656e 7369           extensi
-00020ba0: 6f6e 3d27 7461 722e 677a 272c 206c 6173  on='tar.gz', las
-00020bb0: 7464 6f74 3d46 616c 7365 2929 0a0a 2020  tdot=False))..  
-00020bc0: 2020 2020 2020 4368 6563 6b20 6966 2066        Check if f
-00020bd0: 696c 6520 6861 7320 6e6f 2065 7874 656e  ile has no exten
-00020be0: 7369 6f6e 2061 6e64 206e 616d 6520 6d61  sion and name ma
-00020bf0: 7463 6869 6e67 2052 4541 444d 450a 2020  tching README.  
-00020c00: 2020 2020 2020 2863 6173 6520 7365 6e73        (case sens
-00020c10: 6974 6976 6529 3a0a 0a20 2020 2020 2020  itive):..       
-00020c20: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00020c30: 3d27 6669 6c65 272c 205f 6e61 6d65 3d27  ='file', _name='
-00020c40: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
-00020c50: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
-00020c60: 4953 5f46 494c 4528 6669 6c65 6e61 6d65  IS_FILE(filename
-00020c70: 3d27 5245 4144 4d45 272c 0a20 2020 2020  ='README',.     
-00020c80: 2020 2020 2020 2020 2020 2065 7874 656e             exten
-00020c90: 7369 6f6e 3d27 272c 2063 6173 653d 3029  sion='', case=0)
-00020ca0: 0a0a 2020 2020 2222 220a 0a20 2020 2064  ..    """..    d
-00020cb0: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
-00020cc0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00020cd0: 2020 2066 696c 656e 616d 653d 4e6f 6e65     filename=None
-00020ce0: 2c0a 2020 2020 2020 2020 6578 7465 6e73  ,.        extens
-00020cf0: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ion=None,.      
-00020d00: 2020 6c61 7374 646f 743d 5472 7565 2c0a    lastdot=True,.
-00020d10: 2020 2020 2020 2020 6361 7365 3d31 2c0a          case=1,.
-00020d20: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00020d30: 7373 6167 653d 2245 6e74 6572 2076 616c  ssage="Enter val
-00020d40: 6964 2066 696c 656e 616d 6522 2c0a 2020  id filename",.  
-00020d50: 2020 293a 0a20 2020 2020 2020 2073 656c    ):.        sel
-00020d60: 662e 6669 6c65 6e61 6d65 203d 2066 696c  f.filename = fil
-00020d70: 656e 616d 650a 2020 2020 2020 2020 7365  ename.        se
-00020d80: 6c66 2e65 7874 656e 7369 6f6e 203d 2065  lf.extension = e
-00020d90: 7874 656e 7369 6f6e 0a20 2020 2020 2020  xtension.       
-00020da0: 2073 656c 662e 6c61 7374 646f 7420 3d20   self.lastdot = 
-00020db0: 6c61 7374 646f 740a 2020 2020 2020 2020  lastdot.        
-00020dc0: 7365 6c66 2e63 6173 6520 3d20 6361 7365  self.case = case
-00020dd0: 0a20 2020 2020 2020 2073 656c 662e 6572  .        self.er
-00020de0: 726f 725f 6d65 7373 6167 6520 3d20 6572  ror_message = er
-00020df0: 726f 725f 6d65 7373 6167 650a 0a20 2020  ror_message..   
-00020e00: 2064 6566 206d 6174 6368 2873 656c 662c   def match(self,
-00020e10: 2076 616c 7565 312c 2076 616c 7565 3229   value1, value2)
-00020e20: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-00020e30: 6e73 7461 6e63 6528 7661 6c75 6531 2c20  nstance(value1, 
-00020e40: 286c 6973 742c 2074 7570 6c65 2929 3a0a  (list, tuple)):.
-00020e50: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00020e60: 7620 696e 2076 616c 7565 313a 0a20 2020  v in value1:.   
-00020e70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00020e80: 7365 6c66 2e6d 6174 6368 2876 2c20 7661  self.match(v, va
-00020e90: 6c75 6532 293a 0a20 2020 2020 2020 2020  lue2):.         
-00020ea0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00020eb0: 6e20 5472 7565 0a20 2020 2020 2020 2020  n True.         
-00020ec0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00020ed0: 2020 2020 2020 2020 656c 6966 2063 616c          elif cal
-00020ee0: 6c61 626c 6528 6765 7461 7474 7228 7661  lable(getattr(va
-00020ef0: 6c75 6531 2c20 226d 6174 6368 222c 204e  lue1, "match", N
-00020f00: 6f6e 6529 293a 0a20 2020 2020 2020 2020  one)):.         
-00020f10: 2020 2072 6574 7572 6e20 7661 6c75 6531     return value1
-00020f20: 2e6d 6174 6368 2876 616c 7565 3229 0a20  .match(value2). 
-00020f30: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00020f40: 7374 616e 6365 2876 616c 7565 312c 2073  stance(value1, s
-00020f50: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00020f60: 2072 6574 7572 6e20 7661 6c75 6531 203d   return value1 =
-00020f70: 3d20 7661 6c75 6532 0a0a 2020 2020 6465  = value2..    de
-00020f80: 6620 7661 6c69 6461 7465 2873 656c 662c  f validate(self,
-00020f90: 2076 616c 7565 2c20 7265 636f 7264 5f69   value, record_i
-00020fa0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
-00020fb0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00020fc0: 2020 7374 7269 6e67 203d 2076 616c 7565    string = value
-00020fd0: 2e66 696c 656e 616d 650a 2020 2020 2020  .filename.      
-00020fe0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-00020ff0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-00021000: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-00021010: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-00021020: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
-00021030: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00021040: 2e63 6173 6520 3d3d 2031 3a0a 2020 2020  .case == 1:.    
-00021050: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
-00021060: 2073 7472 696e 672e 6c6f 7765 7228 290a   string.lower().
-00021070: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00021080: 662e 6361 7365 203d 3d20 323a 0a20 2020  f.case == 2:.   
-00021090: 2020 2020 2020 2020 2073 7472 696e 6720           string 
-000210a0: 3d20 7374 7269 6e67 2e75 7070 6572 2829  = string.upper()
-000210b0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000210c0: 2e6c 6173 7464 6f74 3a0a 2020 2020 2020  .lastdot:.      
-000210d0: 2020 2020 2020 646f 7420 3d20 7374 7269        dot = stri
-000210e0: 6e67 2e72 6669 6e64 2822 2e22 290a 2020  ng.rfind(".").  
-000210f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00021100: 2020 2020 2020 2020 646f 7420 3d20 7374          dot = st
-00021110: 7269 6e67 2e66 696e 6428 222e 2229 0a20  ring.find("."). 
-00021120: 2020 2020 2020 2069 6620 646f 7420 3d3d         if dot ==
-00021130: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
-00021140: 2064 6f74 203d 206c 656e 2873 7472 696e   dot = len(strin
-00021150: 6729 0a20 2020 2020 2020 2069 6620 7365  g).        if se
-00021160: 6c66 2e66 696c 656e 616d 6520 616e 6420  lf.filename and 
-00021170: 6e6f 7420 7365 6c66 2e6d 6174 6368 2873  not self.match(s
-00021180: 656c 662e 6669 6c65 6e61 6d65 2c20 7374  elf.filename, st
-00021190: 7269 6e67 5b3a 646f 745d 293a 0a20 2020  ring[:dot]):.   
-000211a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000211b0: 616c 6964 6174 696f 6e45 7272 6f72 2873  alidationError(s
-000211c0: 656c 662e 7472 616e 736c 6174 6f72 2873  elf.translator(s
-000211d0: 656c 662e 6572 726f 725f 6d65 7373 6167  elf.error_messag
-000211e0: 6529 290a 2020 2020 2020 2020 656c 6966  e)).        elif
-000211f0: 2073 656c 662e 6578 7465 6e73 696f 6e20   self.extension 
-00021200: 616e 6420 6e6f 7420 7365 6c66 2e6d 6174  and not self.mat
-00021210: 6368 2873 656c 662e 6578 7465 6e73 696f  ch(self.extensio
-00021220: 6e2c 2073 7472 696e 675b 646f 7420 2b20  n, string[dot + 
-00021230: 3120 3a5d 293a 0a20 2020 2020 2020 2020  1 :]):.         
-00021240: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-00021250: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-00021260: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00021270: 726f 725f 6d65 7373 6167 6529 290a 2020  ror_message)).  
-00021280: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00021290: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-000212a0: 616c 7565 0a0a 0a63 6c61 7373 2049 535f  alue...class IS_
-000212b0: 5550 4c4f 4144 5f46 494c 454e 414d 4528  UPLOAD_FILENAME(
-000212c0: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
-000212d0: 2222 220a 2020 2020 466f 7220 6e65 7720  """.    For new 
-000212e0: 6170 706c 6963 6174 696f 6e73 2c20 7573  applications, us
-000212f0: 6520 4953 5f46 494c 4528 292e 0a0a 2020  e IS_FILE()...  
-00021300: 2020 4368 6563 6b73 2069 6620 6e61 6d65    Checks if name
-00021310: 2061 6e64 2065 7874 656e 7369 6f6e 206f   and extension o
-00021320: 6620 6669 6c65 2075 706c 6f61 6465 6420  f file uploaded 
-00021330: 7468 726f 7567 6820 6669 6c65 2069 6e70  through file inp
-00021340: 7574 206d 6174 6368 6573 0a20 2020 2067  ut matches.    g
-00021350: 6976 656e 2063 7269 7465 7269 612e 0a0a  iven criteria...
-00021360: 2020 2020 446f 6573 202a 6e6f 742a 2065      Does *not* e
-00021370: 6e73 7572 6520 7468 6520 6669 6c65 2074  nsure the file t
-00021380: 7970 6520 696e 2061 6e79 2077 6179 2e20  ype in any way. 
-00021390: 5265 7475 726e 7320 7661 6c69 6461 7469  Returns validati
-000213a0: 6f6e 2066 6169 6c75 7265 0a20 2020 2069  on failure.    i
-000213b0: 6620 6e6f 2064 6174 6120 7761 7320 7570  f no data was up
-000213c0: 6c6f 6164 6564 2e0a 0a20 2020 2041 7267  loaded...    Arg
-000213d0: 733a 0a20 2020 2020 2020 2066 696c 656e  s:.        filen
-000213e0: 616d 653a 2066 696c 656e 616d 6520 2862  ame: filename (b
-000213f0: 6566 6f72 6520 646f 7429 2072 6567 6578  efore dot) regex
-00021400: 0a20 2020 2020 2020 2065 7874 656e 7369  .        extensi
-00021410: 6f6e 3a20 6578 7465 6e73 696f 6e20 2861  on: extension (a
-00021420: 6674 6572 2064 6f74 2920 7265 6765 780a  fter dot) regex.
-00021430: 2020 2020 2020 2020 6c61 7374 646f 743a          lastdot:
-00021440: 2077 6869 6368 2064 6f74 2073 686f 756c   which dot shoul
-00021450: 6420 6265 2075 7365 6420 6173 2061 2066  d be used as a f
-00021460: 696c 656e 616d 6520 2f20 6578 7465 6e73  ilename / extens
-00021470: 696f 6e20 7365 7061 7261 746f 723a 0a20  ion separator:. 
-00021480: 2020 2020 2020 2020 2020 2054 7275 6520             True 
-00021490: 6d65 616e 7320 6c61 7374 2064 6f74 2c20  means last dot, 
-000214a0: 6567 2e20 6669 6c65 2e70 6e67 202d 3e20  eg. file.png -> 
-000214b0: 6669 6c65 202f 2070 6e67 0a20 2020 2020  file / png.     
-000214c0: 2020 2020 2020 2046 616c 7365 206d 6561         False mea
-000214d0: 6e73 2066 6972 7374 2064 6f74 2c20 6567  ns first dot, eg
-000214e0: 2e20 6669 6c65 2e74 6172 2e67 7a20 2d3e  . file.tar.gz ->
-000214f0: 2066 696c 6520 2f20 7461 722e 677a 0a20   file / tar.gz. 
-00021500: 2020 2020 2020 2063 6173 653a 2030 202d         case: 0 -
-00021510: 206b 6565 7020 7468 6520 6361 7365 2c20   keep the case, 
-00021520: 3120 2d20 7472 616e 7366 6f72 6d20 7468  1 - transform th
-00021530: 6520 7374 7269 6e67 2069 6e74 6f20 6c6f  e string into lo
-00021540: 7765 7263 6173 6520 2864 6566 6175 6c74  wercase (default
-00021550: 292c 0a20 2020 2020 2020 2020 2020 2032  ),.            2
-00021560: 202d 2074 7261 6e73 666f 726d 2074 6865   - transform the
-00021570: 2073 7472 696e 6720 696e 746f 2075 7070   string into upp
-00021580: 6572 6361 7365 0a0a 2020 2020 4966 2074  ercase..    If t
-00021590: 6865 7265 2069 7320 6e6f 2064 6f74 2070  here is no dot p
-000215a0: 7265 7365 6e74 2c20 6578 7465 6e73 696f  resent, extensio
-000215b0: 6e20 6368 6563 6b73 2077 696c 6c20 6265  n checks will be
-000215c0: 2064 6f6e 6520 6167 6169 6e73 7420 656d   done against em
-000215d0: 7074 790a 2020 2020 7374 7269 6e67 2061  pty.    string a
-000215e0: 6e64 2066 696c 656e 616d 6520 6368 6563  nd filename chec
-000215f0: 6b73 2061 6761 696e 7374 2077 686f 6c65  ks against whole
-00021600: 2076 616c 7565 2e0a 0a20 2020 2045 7861   value...    Exa
-00021610: 6d70 6c65 733a 0a20 2020 2020 2020 2043  mples:.        C
-00021620: 6865 636b 2069 6620 6669 6c65 2068 6173  heck if file has
-00021630: 2061 2070 6466 2065 7874 656e 7369 6f6e   a pdf extension
-00021640: 2028 6361 7365 2069 6e73 656e 7369 7469   (case insensiti
-00021650: 7665 293a 0a0a 2020 2020 2020 2020 494e  ve):..        IN
-00021660: 5055 5428 5f74 7970 653d 2766 696c 6527  PUT(_type='file'
-00021670: 2c20 5f6e 616d 653d 276e 616d 6527 2c0a  , _name='name',.
-00021680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021690: 7265 7175 6972 6573 3d49 535f 5550 4c4f  requires=IS_UPLO
-000216a0: 4144 5f46 494c 454e 414d 4528 6578 7465  AD_FILENAME(exte
-000216b0: 6e73 696f 6e3d 2770 6466 2729 290a 0a20  nsion='pdf')).. 
-000216c0: 2020 2020 2020 2043 6865 636b 2069 6620         Check if 
-000216d0: 6669 6c65 2068 6173 2061 2074 6172 2e67  file has a tar.g
-000216e0: 7a20 6578 7465 6e73 696f 6e20 616e 6420  z extension and 
-000216f0: 6e61 6d65 2073 7461 7274 696e 6720 7769  name starting wi
-00021700: 7468 2062 6163 6b75 703a 0a0a 2020 2020  th backup:..    
-00021710: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
-00021720: 2766 696c 6527 2c20 5f6e 616d 653d 276e  'file', _name='n
-00021730: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
-00021740: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
-00021750: 535f 5550 4c4f 4144 5f46 494c 454e 414d  S_UPLOAD_FILENAM
-00021760: 4528 6669 6c65 6e61 6d65 3d27 6261 636b  E(filename='back
-00021770: 7570 2e2a 272c 0a20 2020 2020 2020 2020  up.*',.         
-00021780: 2020 2020 2020 2065 7874 656e 7369 6f6e         extension
-00021790: 3d27 7461 722e 677a 272c 206c 6173 7464  ='tar.gz', lastd
-000217a0: 6f74 3d46 616c 7365 2929 0a0a 2020 2020  ot=False))..    
-000217b0: 2020 2020 4368 6563 6b20 6966 2066 696c      Check if fil
-000217c0: 6520 6861 7320 6e6f 2065 7874 656e 7369  e has no extensi
-000217d0: 6f6e 2061 6e64 206e 616d 6520 6d61 7463  on and name matc
-000217e0: 6869 6e67 2052 4541 444d 450a 2020 2020  hing README.    
-000217f0: 2020 2020 2863 6173 6520 7365 6e73 6974      (case sensit
-00021800: 6976 6529 3a0a 0a20 2020 2020 2020 2020  ive):..         
-00021810: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
-00021820: 6669 6c65 272c 205f 6e61 6d65 3d27 6e61  file', _name='na
-00021830: 6d65 272c 0a20 2020 2020 2020 2020 2020  me',.           
-00021840: 2020 2020 2072 6571 7569 7265 733d 4953       requires=IS
-00021850: 5f55 504c 4f41 445f 4649 4c45 4e41 4d45  _UPLOAD_FILENAME
-00021860: 2866 696c 656e 616d 653d 275e 5245 4144  (filename='^READ
-00021870: 4d45 2427 2c0a 2020 2020 2020 2020 2020  ME$',.          
-00021880: 2020 2020 2020 6578 7465 6e73 696f 6e3d        extension=
-00021890: 275e 2427 2c20 6361 7365 3d30 290a 0a20  '^$', case=0).. 
-000218a0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-000218b0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-000218c0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000218d0: 6669 6c65 6e61 6d65 3d4e 6f6e 652c 0a20  filename=None,. 
-000218e0: 2020 2020 2020 2065 7874 656e 7369 6f6e         extension
-000218f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
-00021900: 6173 7464 6f74 3d54 7275 652c 0a20 2020  astdot=True,.   
-00021910: 2020 2020 2063 6173 653d 312c 0a20 2020       case=1,.   
-00021920: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00021930: 6765 3d22 456e 7465 7220 7661 6c69 6420  ge="Enter valid 
-00021940: 6669 6c65 6e61 6d65 222c 0a20 2020 2029  filename",.    )
-00021950: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-00021960: 6e73 7461 6e63 6528 6669 6c65 6e61 6d65  nstance(filename
-00021970: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-00021980: 2020 2020 6669 6c65 6e61 6d65 203d 2072      filename = r
-00021990: 652e 636f 6d70 696c 6528 6669 6c65 6e61  e.compile(filena
-000219a0: 6d65 290a 2020 2020 2020 2020 6966 2069  me).        if i
-000219b0: 7369 6e73 7461 6e63 6528 6578 7465 6e73  sinstance(extens
-000219c0: 696f 6e2c 2073 7472 293a 0a20 2020 2020  ion, str):.     
-000219d0: 2020 2020 2020 2065 7874 656e 7369 6f6e         extension
-000219e0: 203d 2072 652e 636f 6d70 696c 6528 6578   = re.compile(ex
-000219f0: 7465 6e73 696f 6e29 0a20 2020 2020 2020  tension).       
-00021a00: 2073 656c 662e 6669 6c65 6e61 6d65 203d   self.filename =
-00021a10: 2066 696c 656e 616d 650a 2020 2020 2020   filename.      
-00021a20: 2020 7365 6c66 2e65 7874 656e 7369 6f6e    self.extension
-00021a30: 203d 2065 7874 656e 7369 6f6e 0a20 2020   = extension.   
-00021a40: 2020 2020 2073 656c 662e 6c61 7374 646f       self.lastdo
-00021a50: 7420 3d20 6c61 7374 646f 740a 2020 2020  t = lastdot.    
-00021a60: 2020 2020 7365 6c66 2e63 6173 6520 3d20      self.case = 
-00021a70: 6361 7365 0a20 2020 2020 2020 2073 656c  case.        sel
-00021a80: 662e 6572 726f 725f 6d65 7373 6167 6520  f.error_message 
-00021a90: 3d20 6572 726f 725f 6d65 7373 6167 650a  = error_message.
-00021aa0: 0a20 2020 2064 6566 2076 616c 6964 6174  .    def validat
-00021ab0: 6528 7365 6c66 2c20 7661 6c75 652c 2072  e(self, value, r
-00021ac0: 6563 6f72 645f 6964 3d4e 6f6e 6529 3a0a  ecord_id=None):.
-00021ad0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00021ae0: 2020 2020 2020 2020 2073 7472 696e 6720           string 
-00021af0: 3d20 7661 6c75 652e 6669 6c65 6e61 6d65  = value.filename
-00021b00: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00021b10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00021b20: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-00021b30: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-00021b40: 6f72 2873 656c 662e 6572 726f 725f 6d65  or(self.error_me
-00021b50: 7373 6167 6529 290a 2020 2020 2020 2020  ssage)).        
-00021b60: 6966 2073 656c 662e 6361 7365 203d 3d20  if self.case == 
-00021b70: 313a 0a20 2020 2020 2020 2020 2020 2073  1:.            s
-00021b80: 7472 696e 6720 3d20 7374 7269 6e67 2e6c  tring = string.l
-00021b90: 6f77 6572 2829 0a20 2020 2020 2020 2065  ower().        e
-00021ba0: 6c69 6620 7365 6c66 2e63 6173 6520 3d3d  lif self.case ==
-00021bb0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00021bc0: 7374 7269 6e67 203d 2073 7472 696e 672e  string = string.
-00021bd0: 7570 7065 7228 290a 2020 2020 2020 2020  upper().        
-00021be0: 6966 2073 656c 662e 6c61 7374 646f 743a  if self.lastdot:
-00021bf0: 0a20 2020 2020 2020 2020 2020 2064 6f74  .            dot
-00021c00: 203d 2073 7472 696e 672e 7266 696e 6428   = string.rfind(
-00021c10: 222e 2229 0a20 2020 2020 2020 2065 6c73  ".").        els
-00021c20: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-00021c30: 6f74 203d 2073 7472 696e 672e 6669 6e64  ot = string.find
-00021c40: 2822 2e22 290a 2020 2020 2020 2020 6966  (".").        if
-00021c50: 2064 6f74 203d 3d20 2d31 3a0a 2020 2020   dot == -1:.    
-00021c60: 2020 2020 2020 2020 646f 7420 3d20 6c65          dot = le
-00021c70: 6e28 7374 7269 6e67 290a 2020 2020 2020  n(string).      
-00021c80: 2020 6966 2073 656c 662e 6669 6c65 6e61    if self.filena
-00021c90: 6d65 2061 6e64 206e 6f74 2073 656c 662e  me and not self.
-00021ca0: 6669 6c65 6e61 6d65 2e6d 6174 6368 2873  filename.match(s
-00021cb0: 7472 696e 675b 3a64 6f74 5d29 3a0a 2020  tring[:dot]):.  
-00021cc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00021cd0: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
-00021ce0: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
-00021cf0: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
-00021d00: 6765 2929 0a20 2020 2020 2020 2065 6c69  ge)).        eli
-00021d10: 6620 7365 6c66 2e65 7874 656e 7369 6f6e  f self.extension
-00021d20: 2061 6e64 206e 6f74 2073 656c 662e 6578   and not self.ex
-00021d30: 7465 6e73 696f 6e2e 6d61 7463 6828 7374  tension.match(st
-00021d40: 7269 6e67 5b64 6f74 202b 2031 203a 5d29  ring[dot + 1 :])
-00021d50: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00021d60: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
-00021d70: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
-00021d80: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
-00021d90: 6573 7361 6765 2929 0a20 2020 2020 2020  essage)).       
-00021da0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00021db0: 2020 2072 6574 7572 6e20 7661 6c75 650a     return value.
-00021dc0: 0a0a 636c 6173 7320 4953 5f49 5056 3428  ..class IS_IPV4(
-00021dd0: 5661 6c69 6461 746f 7229 3a0a 2020 2020  Validator):.    
-00021de0: 2222 220a 2020 2020 4368 6563 6b73 2069  """.    Checks i
-00021df0: 6620 6669 656c 6427 7320 7661 6c75 6520  f field's value 
-00021e00: 6973 2061 6e20 4950 2076 6572 7369 6f6e  is an IP version
-00021e10: 2034 2061 6464 7265 7373 2069 6e20 6465   4 address in de
-00021e20: 6369 6d61 6c20 666f 726d 2e20 4361 6e0a  cimal form. Can.
-00021e30: 2020 2020 6265 2073 6574 2074 6f20 666f      be set to fo
-00021e40: 7263 6520 6164 6472 6573 7365 7320 6672  rce addresses fr
-00021e50: 6f6d 2063 6572 7461 696e 2072 616e 6765  om certain range
-00021e60: 2e0a 0a20 2020 2049 5076 3420 7265 6765  ...    IPv4 rege
-00021e70: 7820 7461 6b65 6e20 6672 6f6d 3a20 6874  x taken from: ht
-00021e80: 7470 3a2f 2f72 6567 6578 6c69 622e 636f  tp://regexlib.co
-00021e90: 6d2f 5245 4465 7461 696c 732e 6173 7078  m/REDetails.aspx
-00021ea0: 3f72 6567 6578 705f 6964 3d31 3431 310a  ?regexp_id=1411.
-00021eb0: 0a20 2020 2041 7267 733a 0a0a 2020 2020  .    Args:..    
-00021ec0: 2020 2020 6d69 6e69 703a 206c 6f77 6573      minip: lowes
-00021ed0: 7420 616c 6c6f 7765 6420 6164 6472 6573  t allowed addres
-00021ee0: 733b 2061 6363 6570 7473 3a0a 0a20 2020  s; accepts:..   
-00021ef0: 2020 2020 2020 2020 202d 2073 7472 2c20           - str, 
-00021f00: 6567 2e20 3139 322e 3136 382e 302e 310a  eg. 192.168.0.1.
-00021f10: 2020 2020 2020 2020 2020 2020 2d20 6c69              - li
-00021f20: 7374 206f 7220 7475 706c 6520 6f66 206f  st or tuple of o
-00021f30: 6374 6574 732c 2065 672e 205b 3139 322c  ctets, eg. [192,
-00021f40: 2031 3638 2c20 302c 2031 5d0a 2020 2020   168, 0, 1].    
-00021f50: 2020 2020 6d61 7869 703a 2068 6967 6865      maxip: highe
-00021f60: 7374 2061 6c6c 6f77 6564 2061 6464 7265  st allowed addre
-00021f70: 7373 3b20 7361 6d65 2061 7320 6162 6f76  ss; same as abov
-00021f80: 650a 2020 2020 2020 2020 696e 7665 7274  e.        invert
-00021f90: 3a20 5472 7565 2074 6f20 616c 6c6f 7720  : True to allow 
-00021fa0: 6164 6472 6573 7365 7320 6f6e 6c79 2066  addresses only f
-00021fb0: 726f 6d20 6f75 7473 6964 6520 6f66 2067  rom outside of g
-00021fc0: 6976 656e 2072 616e 6765 3b20 6e6f 7465  iven range; note
-00021fd0: 0a20 2020 2020 2020 2020 2020 2074 6861  .            tha
-00021fe0: 7420 7261 6e67 6520 626f 756e 6461 7269  t range boundari
-00021ff0: 6573 2061 7265 206e 6f74 206d 6174 6368  es are not match
-00022000: 6564 2074 6869 7320 7761 790a 2020 2020  ed this way.    
-00022010: 2020 2020 6973 5f6c 6f63 616c 686f 7374      is_localhost
-00022020: 3a20 6c6f 6361 6c68 6f73 7420 6164 6472  : localhost addr
-00022030: 6573 7320 7472 6561 746d 656e 743a 0a0a  ess treatment:..
-00022040: 2020 2020 2020 2020 2020 2020 2d20 4e6f              - No
-00022050: 6e65 2028 6465 6661 756c 7429 3a20 696e  ne (default): in
-00022060: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
-00022070: 2020 2020 2020 2d20 5472 7565 2028 656e        - True (en
-00022080: 666f 7263 6529 3a20 7175 6572 7920 6164  force): query ad
-00022090: 6472 6573 7320 6d75 7374 206d 6174 6368  dress must match
-000220a0: 206c 6f63 616c 686f 7374 2061 6464 7265   localhost addre
-000220b0: 7373 2028 3132 372e 302e 302e 3129 0a20  ss (127.0.0.1). 
-000220c0: 2020 2020 2020 2020 2020 202d 2046 616c             - Fal
-000220d0: 7365 2028 666f 7262 6964 293a 2071 7565  se (forbid): que
-000220e0: 7279 2061 6464 7265 7373 206d 7573 7420  ry address must 
-000220f0: 6e6f 7420 6d61 7463 6820 6c6f 6361 6c68  not match localh
-00022100: 6f73 7420 6164 6472 6573 730a 2020 2020  ost address.    
-00022110: 2020 2020 6973 5f70 7269 7661 7465 3a20      is_private: 
-00022120: 7361 6d65 2061 7320 6162 6f76 652c 2065  same as above, e
-00022130: 7863 6570 7420 7468 6174 2071 7565 7279  xcept that query
-00022140: 2061 6464 7265 7373 2069 7320 6368 6563   address is chec
-00022150: 6b65 6420 6167 6169 6e73 740a 2020 2020  ked against.    
-00022160: 2020 2020 2020 2020 7477 6f20 6164 6472          two addr
-00022170: 6573 7320 7261 6e67 6573 3a20 3137 322e  ess ranges: 172.
-00022180: 3136 2e30 2e30 202d 2031 3732 2e33 312e  16.0.0 - 172.31.
-00022190: 3235 352e 3235 3520 616e 640a 2020 2020  255.255 and.    
-000221a0: 2020 2020 2020 2020 3139 322e 3136 382e          192.168.
-000221b0: 302e 3020 2d20 3139 322e 3136 382e 3235  0.0 - 192.168.25
-000221c0: 352e 3235 350a 2020 2020 2020 2020 6973  5.255.        is
-000221d0: 5f61 7574 6f6d 6174 6963 3a20 7361 6d65  _automatic: same
-000221e0: 2061 7320 6162 6f76 652c 2065 7863 6570   as above, excep
-000221f0: 7420 7468 6174 2071 7565 7279 2061 6464  t that query add
-00022200: 7265 7373 2069 7320 6368 6563 6b65 6420  ress is checked 
-00022210: 6167 6169 6e73 740a 2020 2020 2020 2020  against.        
-00022220: 2020 2020 6f6e 6520 6164 6472 6573 7320      one address 
-00022230: 7261 6e67 653a 2031 3639 2e32 3534 2e30  range: 169.254.0
-00022240: 2e30 202d 2031 3639 2e32 3534 2e32 3535  .0 - 169.254.255
-00022250: 2e32 3535 0a0a 2020 2020 4d69 6e69 7020  .255..    Minip 
-00022260: 616e 6420 6d61 7869 7020 6d61 7920 616c  and maxip may al
-00022270: 736f 2062 6520 6c69 7374 7320 6f72 2074  so be lists or t
-00022280: 7570 6c65 7320 6f66 2061 6464 7265 7373  uples of address
-00022290: 6573 2069 6e20 616c 6c20 6162 6f76 650a  es in all above.
-000222a0: 2020 2020 666f 726d 7320 2873 7472 2c20      forms (str, 
-000222b0: 696e 742c 206c 6973 7420 2f20 7475 706c  int, list / tupl
-000222c0: 6529 2c20 616c 6c6f 7769 6e67 2073 6574  e), allowing set
-000222d0: 7570 206f 6620 6d75 6c74 6970 6c65 2061  up of multiple a
-000222e0: 6464 7265 7373 2072 616e 6765 733a 3a0a  ddress ranges::.
-000222f0: 0a20 2020 2020 2020 206d 696e 6970 203d  .        minip =
-00022300: 2028 6d69 6e69 7031 2c20 6d69 6e69 7032   (minip1, minip2
-00022310: 2c20 2e2e 2e20 6d69 6e69 704e 290a 2020  , ... minipN).  
-00022320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022330: 207c 2020 2020 2020 207c 2020 2020 2020   |       |      
-00022340: 2020 2020 207c 0a20 2020 2020 2020 2020       |.         
-00022350: 2020 2020 2020 2020 2020 7c20 2020 2020            |     
-00022360: 2020 7c20 2020 2020 2020 2020 2020 7c0a    |           |.
-00022370: 2020 2020 2020 2020 6d61 7869 7020 3d20          maxip = 
-00022380: 286d 6178 6970 312c 206d 6178 6970 322c  (maxip1, maxip2,
-00022390: 202e 2e2e 206d 6178 6970 4e29 0a0a 2020   ... maxipN)..  
-000223a0: 2020 4c6f 6e67 6572 2069 7465 7261 626c    Longer iterabl
-000223b0: 6520 7769 6c6c 2062 6520 7472 756e 6361  e will be trunca
-000223c0: 7465 6420 746f 206d 6174 6368 206c 656e  ted to match len
-000223d0: 6774 6820 6f66 2073 686f 7274 6572 206f  gth of shorter o
-000223e0: 6e65 2e0a 0a20 2020 2045 7861 6d70 6c65  ne...    Example
-000223f0: 733a 0a20 2020 2020 2020 2043 6865 636b  s:.        Check
-00022400: 2066 6f72 2076 616c 6964 2049 5076 3420   for valid IPv4 
-00022410: 6164 6472 6573 733a 0a0a 2020 2020 2020  address:..      
-00022420: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
-00022430: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
-00022440: 276e 616d 6527 2c20 7265 7175 6972 6573  'name', requires
-00022450: 3d49 535f 4950 5634 2829 290a 0a20 2020  =IS_IPV4())..   
-00022460: 2020 2020 2043 6865 636b 2066 6f72 2076       Check for v
-00022470: 616c 6964 2049 5076 3420 6164 6472 6573  alid IPv4 addres
-00022480: 7320 6265 6c6f 6e67 696e 6720 746f 2073  s belonging to s
-00022490: 7065 6369 6669 6320 7261 6e67 653a 0a0a  pecific range:..
-000224a0: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
-000224b0: 5428 5f74 7970 653d 2774 6578 7427 2c20  T(_type='text', 
-000224c0: 5f6e 616d 653d 276e 616d 6527 2c0a 2020  _name='name',.  
-000224d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000224e0: 7175 6972 6573 3d49 535f 4950 5634 286d  quires=IS_IPV4(m
-000224f0: 696e 6970 3d27 3130 302e 3230 302e 302e  inip='100.200.0.
-00022500: 3027 2c20 6d61 7869 703d 2731 3030 2e32  0', maxip='100.2
-00022510: 3030 2e32 3535 2e32 3535 2729 290a 0a20  00.255.255')).. 
-00022520: 2020 2020 2020 2043 6865 636b 2066 6f72         Check for
-00022530: 2076 616c 6964 2049 5076 3420 6164 6472   valid IPv4 addr
-00022540: 6573 7320 6265 6c6f 6e67 696e 6720 746f  ess belonging to
-00022550: 2065 6974 6865 7220 3130 302e 3131 302e   either 100.110.
-00022560: 302e 3020 2d0a 2020 2020 2020 2020 3130  0.0 -.        10
-00022570: 302e 3131 302e 3235 352e 3235 3520 6f72  0.110.255.255 or
-00022580: 2032 3030 2e35 302e 302e 3020 2d20 3230   200.50.0.0 - 20
-00022590: 302e 3530 2e30 2e32 3535 2061 6464 7265  0.50.0.255 addre
-000225a0: 7373 2072 616e 6765 3a0a 0a20 2020 2020  ss range:..     
-000225b0: 2020 2020 2020 2049 4e50 5554 285f 7479         INPUT(_ty
-000225c0: 7065 3d27 7465 7874 272c 205f 6e61 6d65  pe='text', _name
-000225d0: 3d27 6e61 6d65 272c 0a20 2020 2020 2020  ='name',.       
-000225e0: 2020 2020 2020 2020 2072 6571 7569 7265           require
-000225f0: 733d 4953 5f49 5056 3428 6d69 6e69 703d  s=IS_IPV4(minip=
-00022600: 2827 3130 302e 3131 302e 302e 3027 2c20  ('100.110.0.0', 
-00022610: 2732 3030 2e35 302e 302e 3027 292c 0a20  '200.50.0.0'),. 
-00022620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022630: 2020 2020 2020 2020 2020 2020 6d61 7869              maxi
-00022640: 703d 2827 3130 302e 3131 302e 3235 352e  p=('100.110.255.
-00022650: 3235 3527 2c20 2732 3030 2e35 302e 302e  255', '200.50.0.
-00022660: 3235 3527 2929 290a 0a20 2020 2020 2020  255')))..       
-00022670: 2043 6865 636b 2066 6f72 2076 616c 6964   Check for valid
-00022680: 2049 5076 3420 6164 6472 6573 7320 6265   IPv4 address be
-00022690: 6c6f 6e67 696e 6720 746f 2070 7269 7661  longing to priva
-000226a0: 7465 2061 6464 7265 7373 2073 7061 6365  te address space
-000226b0: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
-000226c0: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
-000226d0: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
-000226e0: 2072 6571 7569 7265 733d 4953 5f49 5056   requires=IS_IPV
-000226f0: 3428 6973 5f70 7269 7661 7465 3d54 7275  4(is_private=Tru
-00022700: 6529 290a 0a20 2020 2020 2020 2043 6865  e))..        Che
-00022710: 636b 2066 6f72 2076 616c 6964 2049 5076  ck for valid IPv
-00022720: 3420 6164 6472 6573 7320 7468 6174 2069  4 address that i
-00022730: 7320 6e6f 7420 6120 6c6f 6361 6c68 6f73  s not a localhos
-00022740: 7420 6164 6472 6573 733a 0a0a 2020 2020  t address:..    
-00022750: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
-00022760: 7970 653d 2774 6578 7427 2c20 5f6e 616d  ype='text', _nam
-00022770: 653d 276e 616d 6527 2c20 7265 7175 6972  e='name', requir
-00022780: 6573 3d49 535f 4950 5634 2869 735f 6c6f  es=IS_IPV4(is_lo
-00022790: 6361 6c68 6f73 743d 4661 6c73 6529 290a  calhost=False)).
-000227a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000227b0: 2049 535f 4950 5634 2829 2827 312e 322e   IS_IPV4()('1.2.
-000227c0: 332e 3427 290a 2020 2020 2020 2020 2020  3.4').          
-000227d0: 2020 2827 312e 322e 332e 3427 2c20 4e6f    ('1.2.3.4', No
-000227e0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-000227f0: 3e3e 3e20 4953 5f49 5056 3428 2928 2732  >>> IS_IPV4()('2
-00022800: 3535 2e32 3535 2e32 3535 2e32 3535 2729  55.255.255.255')
-00022810: 0a20 2020 2020 2020 2020 2020 2028 2732  .            ('2
-00022820: 3535 2e32 3535 2e32 3535 2e32 3535 272c  55.255.255.255',
-00022830: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-00022840: 2020 203e 3e3e 2049 535f 4950 5634 2829     >>> IS_IPV4()
-00022850: 2827 312e 322e 332e 3420 2729 0a20 2020  ('1.2.3.4 ').   
-00022860: 2020 2020 2020 2020 2028 2731 2e32 2e33           ('1.2.3
-00022870: 2e34 2027 2c20 2765 6e74 6572 2076 616c  .4 ', 'enter val
-00022880: 6964 2049 5076 3420 6164 6472 6573 7327  id IPv4 address'
-00022890: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000228a0: 3e20 4953 5f49 5056 3428 2928 2731 2e32  > IS_IPV4()('1.2
-000228b0: 2e33 2e34 2e35 2729 0a20 2020 2020 2020  .3.4.5').       
-000228c0: 2020 2020 2028 2731 2e32 2e33 2e34 2e35       ('1.2.3.4.5
-000228d0: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
-000228e0: 4950 7634 2061 6464 7265 7373 2729 0a20  IPv4 address'). 
-000228f0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
-00022900: 535f 4950 5634 2829 2827 3132 332e 3132  S_IPV4()('123.12
-00022910: 3327 290a 2020 2020 2020 2020 2020 2020  3').            
-00022920: 2827 3132 332e 3132 3327 2c20 2765 6e74  ('123.123', 'ent
-00022930: 6572 2076 616c 6964 2049 5076 3420 6164  er valid IPv4 ad
-00022940: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-00022950: 2020 2020 3e3e 3e20 4953 5f49 5056 3428      >>> IS_IPV4(
-00022960: 2928 2731 3131 312e 322e 332e 3427 290a  )('1111.2.3.4').
-00022970: 2020 2020 2020 2020 2020 2020 2827 3131              ('11
-00022980: 3131 2e32 2e33 2e34 272c 2027 656e 7465  11.2.3.4', 'ente
-00022990: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
-000229a0: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
-000229b0: 2020 203e 3e3e 2049 535f 4950 5634 2829     >>> IS_IPV4()
-000229c0: 2827 3031 3131 2e32 2e33 2e34 2729 0a20  ('0111.2.3.4'). 
-000229d0: 2020 2020 2020 2020 2020 2028 2730 3131             ('011
-000229e0: 312e 322e 332e 3427 2c20 2765 6e74 6572  1.2.3.4', 'enter
-000229f0: 2076 616c 6964 2049 5076 3420 6164 6472   valid IPv4 addr
-00022a00: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-00022a10: 2020 3e3e 3e20 4953 5f49 5056 3428 2928    >>> IS_IPV4()(
-00022a20: 2732 3536 2e32 2e33 2e34 2729 0a20 2020  '256.2.3.4').   
-00022a30: 2020 2020 2020 2020 2028 2732 3536 2e32           ('256.2
-00022a40: 2e33 2e34 272c 2027 656e 7465 7220 7661  .3.4', 'enter va
-00022a50: 6c69 6420 4950 7634 2061 6464 7265 7373  lid IPv4 address
-00022a60: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
-00022a70: 3e3e 2049 535f 4950 5634 2829 2827 3330  >> IS_IPV4()('30
-00022a80: 302e 322e 332e 3427 290a 2020 2020 2020  0.2.3.4').      
-00022a90: 2020 2020 2020 2827 3330 302e 322e 332e        ('300.2.3.
-00022aa0: 3427 2c20 2765 6e74 6572 2076 616c 6964  4', 'enter valid
-00022ab0: 2049 5076 3420 6164 6472 6573 7327 290a   IPv4 address').
-00022ac0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00022ad0: 4953 5f49 5056 3428 6d69 6e69 703d 2731  IS_IPV4(minip='1
-00022ae0: 2e32 2e33 2e34 272c 206d 6178 6970 3d27  .2.3.4', maxip='
-00022af0: 312e 322e 332e 3427 2928 2731 2e32 2e33  1.2.3.4')('1.2.3
-00022b00: 2e34 2729 0a20 2020 2020 2020 2020 2020  .4').           
-00022b10: 2028 2731 2e32 2e33 2e34 272c 204e 6f6e   ('1.2.3.4', Non
-00022b20: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-00022b30: 3e3e 2049 535f 4950 5634 286d 696e 6970  >> IS_IPV4(minip
-00022b40: 3d27 312e 322e 332e 3527 2c20 6d61 7869  ='1.2.3.5', maxi
-00022b50: 703d 2731 2e32 2e33 2e39 272c 2065 7272  p='1.2.3.9', err
-00022b60: 6f72 5f6d 6573 7361 6765 3d27 4261 6420  or_message='Bad 
-00022b70: 6970 2729 2827 312e 322e 332e 3427 290a  ip')('1.2.3.4').
-00022b80: 2020 2020 2020 2020 2020 2020 2827 312e              ('1.
-00022b90: 322e 332e 3427 2c20 2762 6164 2069 7027  2.3.4', 'bad ip'
-00022ba0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00022bb0: 3e20 4953 5f49 5056 3428 6d61 7869 703d  > IS_IPV4(maxip=
-00022bc0: 2731 2e32 2e33 2e34 272c 2069 6e76 6572  '1.2.3.4', inver
-00022bd0: 743d 5472 7565 2928 2731 3237 2e30 2e30  t=True)('127.0.0
-00022be0: 2e31 2729 0a20 2020 2020 2020 2020 2020  .1').           
-00022bf0: 2028 2731 3237 2e30 2e30 2e31 272c 204e   ('127.0.0.1', N
-00022c00: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-00022c10: 203e 3e3e 2049 535f 4950 5634 286d 6178   >>> IS_IPV4(max
-00022c20: 6970 3d27 312e 322e 332e 3427 2c20 696e  ip='1.2.3.4', in
-00022c30: 7665 7274 3d54 7275 6529 2827 312e 322e  vert=True)('1.2.
-00022c40: 332e 3427 290a 2020 2020 2020 2020 2020  3.4').          
-00022c50: 2020 2827 312e 322e 332e 3427 2c20 2765    ('1.2.3.4', 'e
-00022c60: 6e74 6572 2076 616c 6964 2049 5076 3420  nter valid IPv4 
-00022c70: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
-00022c80: 2020 2020 2020 3e3e 3e20 4953 5f49 5056        >>> IS_IPV
-00022c90: 3428 6973 5f6c 6f63 616c 686f 7374 3d54  4(is_localhost=T
-00022ca0: 7275 6529 2827 3132 372e 302e 302e 3127  rue)('127.0.0.1'
-00022cb0: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
-00022cc0: 3132 372e 302e 302e 3127 2c20 4e6f 6e65  127.0.0.1', None
-00022cd0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00022ce0: 3e20 4953 5f49 5056 3428 6973 5f6c 6f63  > IS_IPV4(is_loc
-00022cf0: 616c 686f 7374 3d54 7275 6529 2827 312e  alhost=True)('1.
-00022d00: 322e 332e 3427 290a 2020 2020 2020 2020  2.3.4').        
-00022d10: 2020 2020 2827 312e 322e 332e 3427 2c20      ('1.2.3.4', 
-00022d20: 2765 6e74 6572 2076 616c 6964 2049 5076  'enter valid IPv
-00022d30: 3420 6164 6472 6573 7327 290a 2020 2020  4 address').    
-00022d40: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
-00022d50: 5056 3428 6973 5f6c 6f63 616c 686f 7374  PV4(is_localhost
-00022d60: 3d46 616c 7365 2928 2731 3237 2e30 2e30  =False)('127.0.0
-00022d70: 2e31 2729 0a20 2020 2020 2020 2020 2020  .1').           
-00022d80: 2028 2731 3237 2e30 2e30 2e31 272c 2027   ('127.0.0.1', '
-00022d90: 656e 7465 7220 7661 6c69 6420 4950 7634  enter valid IPv4
-00022da0: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
-00022db0: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00022dc0: 5634 286d 6178 6970 3d27 3130 302e 302e  V4(maxip='100.0.
-00022dd0: 302e 3027 2c20 6973 5f6c 6f63 616c 686f  0.0', is_localho
-00022de0: 7374 3d54 7275 6529 2827 3132 372e 302e  st=True)('127.0.
-00022df0: 302e 3127 290a 2020 2020 2020 2020 2020  0.1').          
-00022e00: 2020 2827 3132 372e 302e 302e 3127 2c20    ('127.0.0.1', 
-00022e10: 2765 6e74 6572 2076 616c 6964 2049 5076  'enter valid IPv
-00022e20: 3420 6164 6472 6573 7327 290a 0a20 2020  4 address')..   
-00022e30: 2022 2222 0a0a 2020 2020 5245 4745 585f   """..    REGEX_
-00022e40: 4950 5634 203d 2072 652e 636f 6d70 696c  IPV4 = re.compil
-00022e50: 6528 0a20 2020 2020 2020 2072 225e 2828  e(.        r"^((
-00022e60: 5b31 2d39 5d3f 5c64 7c31 5c64 5c64 7c32  [1-9]?\d|1\d\d|2
-00022e70: 5b30 2d34 5d5c 647c 3235 5b30 2d35 5d29  [0-4]\d|25[0-5])
-00022e80: 5c2e 297b 337d 285b 312d 395d 3f5c 647c  \.){3}([1-9]?\d|
-00022e90: 315c 645c 647c 325b 302d 345d 5c64 7c32  1\d\d|2[0-4]\d|2
-00022ea0: 355b 302d 355d 2924 220a 2020 2020 290a  5[0-5])$".    ).
-00022eb0: 2020 2020 6e75 6d62 6572 7320 3d20 2831      numbers = (1
-00022ec0: 3637 3737 3231 362c 2036 3535 3336 2c20  6777216, 65536, 
-00022ed0: 3235 362c 2031 290a 2020 2020 6c6f 6361  256, 1).    loca
-00022ee0: 6c68 6f73 7420 3d20 3231 3330 3730 3634  lhost = 21307064
-00022ef0: 3333 0a20 2020 2070 7269 7661 7465 203d  33.    private =
-00022f00: 2028 2832 3838 3637 3239 3732 382c 2032   ((2886729728, 2
-00022f10: 3838 3637 3935 3236 3329 2c20 2833 3233  886795263), (323
-00022f20: 3232 3335 3532 302c 2033 3233 3233 3031  2235520, 3232301
-00022f30: 3035 3529 290a 2020 2020 6175 746f 6d61  055)).    automa
-00022f40: 7469 6320 3d20 2832 3835 3139 3935 3634  tic = (285199564
-00022f50: 382c 2032 3835 3230 3631 3138 3329 0a0a  8, 2852061183)..
-00022f60: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00022f70: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00022f80: 2020 2020 2020 2020 6d69 6e69 703d 2230          minip="0
-00022f90: 2e30 2e30 2e30 222c 0a20 2020 2020 2020  .0.0.0",.       
-00022fa0: 206d 6178 6970 3d22 3235 352e 3235 352e   maxip="255.255.
-00022fb0: 3235 352e 3235 3522 2c0a 2020 2020 2020  255.255",.      
-00022fc0: 2020 696e 7665 7274 3d46 616c 7365 2c0a    invert=False,.
-00022fd0: 2020 2020 2020 2020 6973 5f6c 6f63 616c          is_local
-00022fe0: 686f 7374 3d4e 6f6e 652c 0a20 2020 2020  host=None,.     
-00022ff0: 2020 2069 735f 7072 6976 6174 653d 4e6f     is_private=No
-00023000: 6e65 2c0a 2020 2020 2020 2020 6973 5f61  ne,.        is_a
-00023010: 7574 6f6d 6174 6963 3d4e 6f6e 652c 0a20  utomatic=None,. 
-00023020: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00023030: 7361 6765 3d22 456e 7465 7220 7661 6c69  sage="Enter vali
-00023040: 6420 4950 7634 2061 6464 7265 7373 222c  d IPv4 address",
-00023050: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00023060: 666f 7220 6e2c 2076 616c 7565 2069 6e20  for n, value in 
-00023070: 656e 756d 6572 6174 6528 286d 696e 6970  enumerate((minip
-00023080: 2c20 6d61 7869 7029 293a 0a20 2020 2020  , maxip)):.     
-00023090: 2020 2020 2020 2074 656d 7020 3d20 5b5d         temp = []
-000230a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000230b0: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-000230c0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-000230d0: 2020 2020 2020 2020 7465 6d70 2e61 7070          temp.app
-000230e0: 656e 6428 7661 6c75 652e 7370 6c69 7428  end(value.split(
-000230f0: 222e 2229 290a 2020 2020 2020 2020 2020  ".")).          
-00023100: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00023110: 6528 7661 6c75 652c 2028 6c69 7374 2c20  e(value, (list, 
-00023120: 7475 706c 6529 293a 0a20 2020 2020 2020  tuple)):.       
-00023130: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
-00023140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023150: 2020 6c65 6e28 7661 6c75 6529 0a20 2020    len(value).   
-00023160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023170: 203d 3d20 6c65 6e28 5b69 7465 6d20 666f   == len([item fo
-00023180: 7220 6974 656d 2069 6e20 7661 6c75 6520  r item in value 
-00023190: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
-000231a0: 656d 2c20 696e 7429 5d29 0a20 2020 2020  em, int)]).     
-000231b0: 2020 2020 2020 2020 2020 2020 2020 203d                 =
-000231c0: 3d20 340a 2020 2020 2020 2020 2020 2020  = 4.            
-000231d0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000231e0: 2020 2020 2020 2020 2020 2074 656d 702e             temp.
-000231f0: 6170 7065 6e64 2876 616c 7565 290a 2020  append(value).  
-00023200: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00023210: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00023220: 2020 2020 2020 2020 666f 7220 6974 656d          for item
-00023230: 2069 6e20 7661 6c75 653a 0a20 2020 2020   in value:.     
-00023240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023250: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00023260: 2869 7465 6d2c 2073 7472 293a 0a20 2020  (item, str):.   
+0001f1c0: 2020 2020 6661 696c 7572 6573 2e61 7070      failures.app
+0001f1d0: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0001f1e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001f1f0: 662e 7472 616e 736c 6174 6f72 2822 4d75  f.translator("Mu
+0001f200: 7374 2069 6e63 6c75 6465 2061 7420 6c65  st include at le
+0001f210: 6173 7420 2573 2025 7322 290a 2020 2020  ast %s %s").    
+0001f220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f230: 2020 2020 2520 2873 7472 2873 656c 662e      % (str(self.
+0001f240: 6e75 6d62 6572 292c 206e 756d 6265 7273  number), numbers
+0001f250: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001f260: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001f270: 2020 2020 656c 6966 2073 656c 662e 6e75      elif self.nu
+0001f280: 6d62 6572 203d 3d20 3020 616e 6420 7365  mber == 0 and se
+0001f290: 6c66 2e6e 756d 6265 7220 6973 206e 6f74  lf.number is not
+0001f2a0: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
+0001f2b0: 2020 2020 2020 2020 6966 206c 656e 2861          if len(a
+0001f2c0: 6c6c 5f6e 756d 6265 7229 203e 2030 3a0a  ll_number) > 0:.
+0001f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f2e0: 2020 2020 6661 696c 7572 6573 2e61 7070      failures.app
+0001f2f0: 656e 6428 7365 6c66 2e74 7261 6e73 6c61  end(self.transla
+0001f300: 746f 7228 224d 6179 206e 6f74 2069 6e63  tor("May not inc
+0001f310: 6c75 6465 2061 6e79 206e 756d 6265 7273  lude any numbers
+0001f320: 2229 290a 2020 2020 2020 2020 6966 206c  ")).        if l
+0001f330: 656e 2866 6169 6c75 7265 7329 203d 3d20  en(failures) == 
+0001f340: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+0001f350: 6574 7572 6e20 7661 6c75 650a 2020 2020  eturn value.    
+0001f360: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0001f370: 6572 726f 725f 6d65 7373 6167 653a 0a20  error_message:. 
+0001f380: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001f390: 6c66 2e65 7374 7269 6e67 3a0a 2020 2020  lf.estring:.    
+0001f3a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001f3b0: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+0001f3c0: 7228 227c 222e 6a6f 696e 286d 6170 2873  r("|".join(map(s
+0001f3d0: 7472 2c20 6661 696c 7572 6573 2929 290a  tr, failures))).
+0001f3e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001f3f0: 6520 5661 6c69 6461 7469 6f6e 4572 726f  e ValidationErro
+0001f400: 7228 222c 2022 2e6a 6f69 6e28 6661 696c  r(", ".join(fail
+0001f410: 7572 6573 2929 0a20 2020 2020 2020 2065  ures)).        e
+0001f420: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001f430: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+0001f440: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+0001f450: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+0001f460: 725f 6d65 7373 6167 6529 290a 0a0a 636c  r_message))...cl
+0001f470: 6173 7320 4953 5f49 4d41 4745 2856 616c  ass IS_IMAGE(Val
+0001f480: 6964 6174 6f72 293a 0a20 2020 2022 2222  idator):.    """
+0001f490: 0a20 2020 2043 6865 636b 7320 6966 2066  .    Checks if f
+0001f4a0: 696c 6520 7570 6c6f 6164 6564 2074 6872  ile uploaded thr
+0001f4b0: 6f75 6768 2066 696c 6520 696e 7075 7420  ough file input 
+0001f4c0: 7761 7320 7361 7665 6420 696e 206f 6e65  was saved in one
+0001f4d0: 206f 6620 7365 6c65 6374 6564 0a20 2020   of selected.   
+0001f4e0: 2069 6d61 6765 2066 6f72 6d61 7473 2061   image formats a
+0001f4f0: 6e64 2068 6173 2064 696d 656e 7369 6f6e  nd has dimension
+0001f500: 7320 2877 6964 7468 2061 6e64 2068 6569  s (width and hei
+0001f510: 6768 7429 2077 6974 6869 6e20 6769 7665  ght) within give
+0001f520: 6e20 626f 756e 6461 7269 6573 2e0a 0a20  n boundaries... 
+0001f530: 2020 2044 6f65 7320 2a6e 6f74 2a20 6368     Does *not* ch
+0001f540: 6563 6b20 666f 7220 6d61 7869 6d75 6d20  eck for maximum 
+0001f550: 6669 6c65 2073 697a 6520 2875 7365 2049  file size (use I
+0001f560: 535f 4c45 4e47 5448 2066 6f72 2074 6861  S_LENGTH for tha
+0001f570: 7429 2e20 5265 7475 726e 730a 2020 2020  t). Returns.    
+0001f580: 7661 6c69 6461 7469 6f6e 2066 6169 6c75  validation failu
+0001f590: 7265 2069 6620 6e6f 2064 6174 6120 7761  re if no data wa
+0001f5a0: 7320 7570 6c6f 6164 6564 2e0a 0a20 2020  s uploaded...   
+0001f5b0: 2053 7570 706f 7274 6564 2066 696c 6520   Supported file 
+0001f5c0: 666f 726d 6174 733a 2042 4d50 2c20 4749  formats: BMP, GI
+0001f5d0: 462c 204a 5045 472c 2050 4e47 2e0a 0a20  F, JPEG, PNG... 
+0001f5e0: 2020 2043 6f64 6520 7061 7274 7320 7461     Code parts ta
+0001f5f0: 6b65 6e20 6672 6f6d 0a20 2020 2068 7474  ken from.    htt
+0001f600: 703a 2f2f 6d61 696c 2e70 7974 686f 6e2e  p://mail.python.
+0001f610: 6f72 672f 7069 7065 726d 6169 6c2f 7079  org/pipermail/py
+0001f620: 7468 6f6e 2d6c 6973 742f 3230 3037 2d4a  thon-list/2007-J
+0001f630: 756e 652f 3631 3731 3236 2e68 746d 6c0a  une/617126.html.
+0001f640: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0001f650: 2020 2065 7874 656e 7369 6f6e 733a 2069     extensions: i
+0001f660: 7465 7261 626c 6520 636f 6e74 6169 6e69  terable containi
+0001f670: 6e67 2061 6c6c 6f77 6564 202a 6c6f 7765  ng allowed *lowe
+0001f680: 7263 6173 652a 2069 6d61 6765 2066 696c  rcase* image fil
+0001f690: 6520 6578 7465 6e73 696f 6e73 0a20 2020  e extensions.   
+0001f6a0: 2020 2020 2028 276a 7067 2720 6578 7465       ('jpg' exte
+0001f6b0: 6e73 696f 6e20 6f66 2075 706c 6f61 6465  nsion of uploade
+0001f6c0: 6420 6669 6c65 2063 6f75 6e74 7320 6173  d file counts as
+0001f6d0: 2027 6a70 6567 2729 0a20 2020 2020 2020   'jpeg').       
+0001f6e0: 206d 6178 7369 7a65 3a20 6974 6572 6162   maxsize: iterab
+0001f6f0: 6c65 2063 6f6e 7461 696e 696e 6720 6d61  le containing ma
+0001f700: 7869 6d75 6d20 7769 6474 6820 616e 6420  ximum width and 
+0001f710: 6865 6967 6874 206f 6620 7468 6520 696d  height of the im
+0001f720: 6167 650a 2020 2020 2020 2020 6d69 6e73  age.        mins
+0001f730: 697a 653a 2069 7465 7261 626c 6520 636f  ize: iterable co
+0001f740: 6e74 6169 6e69 6e67 206d 696e 696d 756d  ntaining minimum
+0001f750: 2077 6964 7468 2061 6e64 2068 6569 6768   width and heigh
+0001f760: 7420 6f66 2074 6865 2069 6d61 6765 0a20  t of the image. 
+0001f770: 2020 2020 2020 2061 7370 6563 7472 6174         aspectrat
+0001f780: 696f 3a20 6974 6572 6162 6c65 2063 6f6e  io: iterable con
+0001f790: 7461 696e 696e 6720 7461 7267 6574 2061  taining target a
+0001f7a0: 7370 6563 7420 7261 7469 6f0a 0a20 2020  spect ratio..   
+0001f7b0: 2055 7365 2028 2d31 2c20 2d31 2920 6173   Use (-1, -1) as
+0001f7c0: 206d 696e 7369 7a65 2074 6f20 7061 7373   minsize to pass
+0001f7d0: 2069 6d61 6765 2073 697a 6520 6368 6563   image size chec
+0001f7e0: 6b2e 0a20 2020 2055 7365 2028 2d31 2c20  k..    Use (-1, 
+0001f7f0: 2d31 2920 6173 2061 7370 6563 7472 6174  -1) as aspectrat
+0001f800: 696f 2074 6f20 7061 7373 2061 7370 6563  io to pass aspec
+0001f810: 7420 7261 7469 6f20 6368 6563 6b2e 0a0a  t ratio check...
+0001f820: 2020 2020 4578 616d 706c 6573 3a0a 2020      Examples:.  
+0001f830: 2020 2020 2020 4368 6563 6b20 6966 2075        Check if u
+0001f840: 706c 6f61 6465 6420 6669 6c65 2069 7320  ploaded file is 
+0001f850: 696e 2061 6e79 206f 6620 7375 7070 6f72  in any of suppor
+0001f860: 7465 6420 696d 6167 6520 666f 726d 6174  ted image format
+0001f870: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
+0001f880: 494e 5055 5428 5f74 7970 653d 2766 696c  INPUT(_type='fil
+0001f890: 6527 2c20 5f6e 616d 653d 276e 616d 6527  e', _name='name'
+0001f8a0: 2c20 7265 7175 6972 6573 3d49 535f 494d  , requires=IS_IM
+0001f8b0: 4147 4528 2929 0a0a 2020 2020 2020 2020  AGE())..        
+0001f8c0: 4368 6563 6b20 6966 2075 706c 6f61 6465  Check if uploade
+0001f8d0: 6420 6669 6c65 2069 7320 6569 7468 6572  d file is either
+0001f8e0: 204a 5045 4720 6f72 2050 4e47 3a0a 0a20   JPEG or PNG:.. 
+0001f8f0: 2020 2020 2020 2020 2020 2049 4e50 5554             INPUT
+0001f900: 285f 7479 7065 3d27 6669 6c65 272c 205f  (_type='file', _
+0001f910: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
+0001f920: 2020 2020 2020 2020 2020 2020 2072 6571               req
+0001f930: 7569 7265 733d 4953 5f49 4d41 4745 2865  uires=IS_IMAGE(e
+0001f940: 7874 656e 7369 6f6e 733d 2827 6a70 6567  xtensions=('jpeg
+0001f950: 272c 2027 706e 6727 2929 290a 0a20 2020  ', 'png')))..   
+0001f960: 2020 2020 2043 6865 636b 2069 6620 7570       Check if up
+0001f970: 6c6f 6164 6564 2066 696c 6520 6973 2050  loaded file is P
+0001f980: 4e47 2077 6974 6820 6d61 7869 6d75 6d20  NG with maximum 
+0001f990: 7369 7a65 206f 6620 3230 3078 3230 3020  size of 200x200 
+0001f9a0: 7069 7865 6c73 3a0a 0a20 2020 2020 2020  pixels:..       
+0001f9b0: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
+0001f9c0: 3d27 6669 6c65 272c 205f 6e61 6d65 3d27  ='file', _name='
+0001f9d0: 6e61 6d65 272c 0a20 2020 2020 2020 2020  name',.         
+0001f9e0: 2020 2020 2020 2072 6571 7569 7265 733d         requires=
+0001f9f0: 4953 5f49 4d41 4745 2865 7874 656e 7369  IS_IMAGE(extensi
+0001fa00: 6f6e 733d 2827 706e 6727 292c 206d 6178  ons=('png'), max
+0001fa10: 7369 7a65 3d28 3230 302c 2032 3030 2929  size=(200, 200))
+0001fa20: 290a 0a20 2020 2020 2020 2043 6865 636b  )..        Check
+0001fa30: 2069 6620 7570 6c6f 6164 6564 2066 696c   if uploaded fil
+0001fa40: 6520 6861 7320 6120 3136 3a39 2061 7370  e has a 16:9 asp
+0001fa50: 6563 7420 7261 7469 6f3a 0a0a 2020 2020  ect ratio:..    
+0001fa60: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+0001fa70: 7970 653d 2766 696c 6527 2c20 5f6e 616d  ype='file', _nam
+0001fa80: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
+0001fa90: 2020 2020 2020 2020 2020 7265 7175 6972            requir
+0001faa0: 6573 3d49 535f 494d 4147 4528 6173 7065  es=IS_IMAGE(aspe
+0001fab0: 6374 7261 7469 6f3d 2831 362c 2039 2929  ctratio=(16, 9))
+0001fac0: 290a 2020 2020 2222 220a 0a20 2020 2064  ).    """..    d
+0001fad0: 6566 205f 5f69 6e69 745f 5f28 0a20 2020  ef __init__(.   
+0001fae0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001faf0: 2020 2065 7874 656e 7369 6f6e 733d 2822     extensions=("
+0001fb00: 626d 7022 2c20 2267 6966 222c 2022 6a70  bmp", "gif", "jp
+0001fb10: 6567 222c 2022 706e 6722 292c 0a20 2020  eg", "png"),.   
+0001fb20: 2020 2020 206d 6178 7369 7a65 3d28 3130       maxsize=(10
+0001fb30: 3030 302c 2031 3030 3030 292c 0a20 2020  000, 10000),.   
+0001fb40: 2020 2020 206d 696e 7369 7a65 3d28 302c       minsize=(0,
+0001fb50: 2030 292c 0a20 2020 2020 2020 2061 7370   0),.        asp
+0001fb60: 6563 7472 6174 696f 3d28 2d31 2c20 2d31  ectratio=(-1, -1
+0001fb70: 292c 0a20 2020 2020 2020 2065 7272 6f72  ),.        error
+0001fb80: 5f6d 6573 7361 6765 3d22 496e 7661 6c69  _message="Invali
+0001fb90: 6420 696d 6167 6522 2c0a 2020 2020 293a  d image",.    ):
+0001fba0: 0a20 2020 2020 2020 2073 656c 662e 6578  .        self.ex
+0001fbb0: 7465 6e73 696f 6e73 203d 2065 7874 656e  tensions = exten
+0001fbc0: 7369 6f6e 730a 2020 2020 2020 2020 7365  sions.        se
+0001fbd0: 6c66 2e6d 6178 7369 7a65 203d 206d 6178  lf.maxsize = max
+0001fbe0: 7369 7a65 0a20 2020 2020 2020 2073 656c  size.        sel
+0001fbf0: 662e 6d69 6e73 697a 6520 3d20 6d69 6e73  f.minsize = mins
+0001fc00: 697a 650a 2020 2020 2020 2020 7365 6c66  ize.        self
+0001fc10: 2e61 7370 6563 7472 6174 696f 203d 2061  .aspectratio = a
+0001fc20: 7370 6563 7472 6174 696f 0a20 2020 2020  spectratio.     
+0001fc30: 2020 2073 656c 662e 6572 726f 725f 6d65     self.error_me
+0001fc40: 7373 6167 6520 3d20 6572 726f 725f 6d65  ssage = error_me
+0001fc50: 7373 6167 650a 0a20 2020 2064 6566 2076  ssage..    def v
+0001fc60: 616c 6964 6174 6528 7365 6c66 2c20 7661  alidate(self, va
+0001fc70: 6c75 652c 2072 6563 6f72 645f 6964 3d4e  lue, record_id=N
+0001fc80: 6f6e 6529 3a0a 2020 2020 2020 2020 7472  one):.        tr
+0001fc90: 793a 0a20 2020 2020 2020 2020 2020 2065  y:.            e
+0001fca0: 7874 656e 7369 6f6e 203d 2076 616c 7565  xtension = value
+0001fcb0: 2e66 696c 656e 616d 652e 7266 696e 6428  .filename.rfind(
+0001fcc0: 222e 2229 0a20 2020 2020 2020 2020 2020  ".").           
+0001fcd0: 2061 7373 6572 7420 6578 7465 6e73 696f   assert extensio
+0001fce0: 6e20 3e3d 2030 0a20 2020 2020 2020 2020  n >= 0.         
+0001fcf0: 2020 2065 7874 656e 7369 6f6e 203d 2076     extension = v
+0001fd00: 616c 7565 2e66 696c 656e 616d 655b 6578  alue.filename[ex
+0001fd10: 7465 6e73 696f 6e20 2b20 3120 3a5d 2e6c  tension + 1 :].l
+0001fd20: 6f77 6572 2829 0a20 2020 2020 2020 2020  ower().         
+0001fd30: 2020 2069 6620 6578 7465 6e73 696f 6e20     if extension 
+0001fd40: 3d3d 2022 6a70 6722 3a0a 2020 2020 2020  == "jpg":.      
+0001fd50: 2020 2020 2020 2020 2020 6578 7465 6e73            extens
+0001fd60: 696f 6e20 3d20 226a 7065 6722 0a20 2020  ion = "jpeg".   
+0001fd70: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0001fd80: 6578 7465 6e73 696f 6e20 696e 2073 656c  extension in sel
+0001fd90: 662e 6578 7465 6e73 696f 6e73 0a20 2020  f.extensions.   
+0001fda0: 2020 2020 2020 2020 2069 6620 6578 7465           if exte
+0001fdb0: 6e73 696f 6e20 3d3d 2022 626d 7022 3a0a  nsion == "bmp":.
+0001fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fdd0: 7769 6474 682c 2068 6569 6768 7420 3d20  width, height = 
+0001fde0: 7365 6c66 2e5f 5f62 6d70 2876 616c 7565  self.__bmp(value
+0001fdf0: 2e66 696c 6529 0a20 2020 2020 2020 2020  .file).         
+0001fe00: 2020 2065 6c69 6620 6578 7465 6e73 696f     elif extensio
+0001fe10: 6e20 3d3d 2022 6769 6622 3a0a 2020 2020  n == "gif":.    
+0001fe20: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+0001fe30: 682c 2068 6569 6768 7420 3d20 7365 6c66  h, height = self
+0001fe40: 2e5f 5f67 6966 2876 616c 7565 2e66 696c  .__gif(value.fil
+0001fe50: 6529 0a20 2020 2020 2020 2020 2020 2065  e).            e
+0001fe60: 6c69 6620 6578 7465 6e73 696f 6e20 3d3d  lif extension ==
+0001fe70: 2022 6a70 6567 223a 0a20 2020 2020 2020   "jpeg":.       
+0001fe80: 2020 2020 2020 2020 2077 6964 7468 2c20           width, 
+0001fe90: 6865 6967 6874 203d 2073 656c 662e 5f5f  height = self.__
+0001fea0: 6a70 6567 2876 616c 7565 2e66 696c 6529  jpeg(value.file)
+0001feb0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0001fec0: 6620 6578 7465 6e73 696f 6e20 3d3d 2022  f extension == "
+0001fed0: 706e 6722 3a0a 2020 2020 2020 2020 2020  png":.          
+0001fee0: 2020 2020 2020 7769 6474 682c 2068 6569        width, hei
+0001fef0: 6768 7420 3d20 7365 6c66 2e5f 5f70 6e67  ght = self.__png
+0001ff00: 2876 616c 7565 2e66 696c 6529 0a20 2020  (value.file).   
+0001ff10: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001ff20: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001ff30: 6964 7468 203d 202d 310a 2020 2020 2020  idth = -1.      
+0001ff40: 2020 2020 2020 2020 2020 6865 6967 6874            height
+0001ff50: 203d 202d 310a 0a20 2020 2020 2020 2020   = -1..         
+0001ff60: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+0001ff70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001ff80: 2e6d 696e 7369 7a65 5b30 5d20 3c3d 2077  .minsize[0] <= w
+0001ff90: 6964 7468 203c 3d20 7365 6c66 2e6d 6178  idth <= self.max
+0001ffa0: 7369 7a65 5b30 5d0a 2020 2020 2020 2020  size[0].        
+0001ffb0: 2020 2020 2020 2020 616e 6420 7365 6c66          and self
+0001ffc0: 2e6d 696e 7369 7a65 5b31 5d20 3c3d 2068  .minsize[1] <= h
+0001ffd0: 6569 6768 7420 3c3d 2073 656c 662e 6d61  eight <= self.ma
+0001ffe0: 7873 697a 655b 315d 0a20 2020 2020 2020  xsize[1].       
+0001fff0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00020000: 2020 2020 6966 2073 656c 662e 6173 7065      if self.aspe
+00020010: 6374 7261 7469 6f20 3e20 282d 312c 202d  ctratio > (-1, -
+00020020: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00020030: 2020 2020 7461 7267 6574 5f72 6174 696f      target_ratio
+00020040: 203d 2028 312e 3020 2a20 7365 6c66 2e61   = (1.0 * self.a
+00020050: 7370 6563 7472 6174 696f 5b31 5d29 202f  spectratio[1]) /
+00020060: 2073 656c 662e 6173 7065 6374 7261 7469   self.aspectrati
+00020070: 6f5b 305d 0a20 2020 2020 2020 2020 2020  o[0].           
+00020080: 2020 2020 2061 6374 7561 6c5f 7261 7469       actual_rati
+00020090: 6f20 3d20 2831 2e30 202a 2068 6569 6768  o = (1.0 * heigh
+000200a0: 7429 202f 2077 6964 7468 0a0a 2020 2020  t) / width..    
+000200b0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+000200c0: 7274 2061 6374 7561 6c5f 7261 7469 6f20  rt actual_ratio 
+000200d0: 3d3d 2074 6172 6765 745f 7261 7469 6f0a  == target_ratio.
+000200e0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+000200f0: 7565 2e66 696c 652e 7365 656b 2830 290a  ue.file.seek(0).
+00020100: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020110: 726e 2076 616c 7565 0a20 2020 2020 2020  rn value.       
+00020120: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00020130: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+00020140: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
+00020150: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
+00020160: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
+00020170: 7272 6f72 5f6d 6573 7361 6765 2929 0a0a  rror_message))..
+00020180: 2020 2020 6465 6620 5f5f 626d 7028 7365      def __bmp(se
+00020190: 6c66 2c20 7374 7265 616d 293a 0a20 2020  lf, stream):.   
+000201a0: 2020 2020 2069 6620 7374 7265 616d 2e72       if stream.r
+000201b0: 6561 6428 3229 203d 3d20 6222 424d 223a  ead(2) == b"BM":
+000201c0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+000201d0: 6561 6d2e 7265 6164 2831 3629 0a20 2020  eam.read(16).   
+000201e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000201f0: 7374 7275 6374 2e75 6e70 6163 6b28 223c  struct.unpack("<
+00020200: 4c4c 222c 2073 7472 6561 6d2e 7265 6164  LL", stream.read
+00020210: 2838 2929 0a20 2020 2020 2020 2072 6574  (8)).        ret
+00020220: 7572 6e20 282d 312c 202d 3129 0a0a 2020  urn (-1, -1)..  
+00020230: 2020 6465 6620 5f5f 6769 6628 7365 6c66    def __gif(self
+00020240: 2c20 7374 7265 616d 293a 0a20 2020 2020  , stream):.     
+00020250: 2020 2069 6620 7374 7265 616d 2e72 6561     if stream.rea
+00020260: 6428 3629 2069 6e20 2862 2247 4946 3837  d(6) in (b"GIF87
+00020270: 6122 2c20 6222 4749 4638 3961 2229 3a0a  a", b"GIF89a"):.
+00020280: 2020 2020 2020 2020 2020 2020 7374 7265              stre
+00020290: 616d 203d 2073 7472 6561 6d2e 7265 6164  am = stream.read
+000202a0: 2835 290a 2020 2020 2020 2020 2020 2020  (5).            
+000202b0: 6966 206c 656e 2873 7472 6561 6d29 203d  if len(stream) =
+000202c0: 3d20 353a 0a20 2020 2020 2020 2020 2020  = 5:.           
+000202d0: 2020 2020 2072 6574 7572 6e20 7475 706c       return tupl
+000202e0: 6528 7374 7275 6374 2e75 6e70 6163 6b28  e(struct.unpack(
+000202f0: 223c 4848 4222 2c20 7374 7265 616d 295b  "<HHB", stream)[
+00020300: 3a2d 315d 290a 2020 2020 2020 2020 7265  :-1]).        re
+00020310: 7475 726e 2028 2d31 2c20 2d31 290a 0a20  turn (-1, -1).. 
+00020320: 2020 2064 6566 205f 5f6a 7065 6728 7365     def __jpeg(se
+00020330: 6c66 2c20 7374 7265 616d 293a 0a20 2020  lf, stream):.   
+00020340: 2020 2020 2069 6620 7374 7265 616d 2e72       if stream.r
+00020350: 6561 6428 3229 203d 3d20 6222 5c78 4646  ead(2) == b"\xFF
+00020360: 5c78 4438 223a 0a20 2020 2020 2020 2020  \xD8":.         
+00020370: 2020 2077 6869 6c65 2054 7275 653a 0a20     while True:. 
+00020380: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00020390: 6d61 726b 6572 2c20 636f 6465 2c20 6c65  marker, code, le
+000203a0: 6e67 7468 2920 3d20 7374 7275 6374 2e75  ngth) = struct.u
+000203b0: 6e70 6163 6b28 2221 4242 4822 2c20 7374  npack("!BBH", st
+000203c0: 7265 616d 2e72 6561 6428 3429 290a 2020  ream.read(4)).  
+000203d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000203e0: 206d 6172 6b65 7220 213d 2030 7846 463a   marker != 0xFF:
+000203f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020400: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+00020410: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00020420: 636f 6465 203e 3d20 3078 4330 2061 6e64  code >= 0xC0 and
+00020430: 2063 6f64 6520 3c3d 2030 7843 333a 0a20   code <= 0xC3:. 
+00020440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020450: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+00020460: 7265 7665 7273 6564 2873 7472 7563 742e  reversed(struct.
+00020470: 756e 7061 636b 2822 2178 4848 222c 2073  unpack("!xHH", s
+00020480: 7472 6561 6d2e 7265 6164 2835 2929 2929  tream.read(5))))
+00020490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000204a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000204b0: 2020 2020 2020 2020 2020 2073 7472 6561             strea
+000204c0: 6d2e 7265 6164 286c 656e 6774 6820 2d20  m.read(length - 
+000204d0: 3229 0a20 2020 2020 2020 2072 6574 7572  2).        retur
+000204e0: 6e20 282d 312c 202d 3129 0a0a 2020 2020  n (-1, -1)..    
+000204f0: 6465 6620 5f5f 706e 6728 7365 6c66 2c20  def __png(self, 
+00020500: 7374 7265 616d 293a 0a20 2020 2020 2020  stream):.       
+00020510: 2069 6620 7374 7265 616d 2e72 6561 6428   if stream.read(
+00020520: 3829 203d 3d20 6222 5c32 3131 504e 475c  8) == b"\211PNG\
+00020530: 725c 6e5c 3033 325c 6e22 3a0a 2020 2020  r\n\032\n":.    
+00020540: 2020 2020 2020 2020 7374 7265 616d 2e72          stream.r
+00020550: 6561 6428 3429 0a20 2020 2020 2020 2020  ead(4).         
+00020560: 2020 2069 6620 7374 7265 616d 2e72 6561     if stream.rea
+00020570: 6428 3429 203d 3d20 6222 4948 4452 223a  d(4) == b"IHDR":
+00020580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020590: 2072 6574 7572 6e20 7374 7275 6374 2e75   return struct.u
+000205a0: 6e70 6163 6b28 2221 4c4c 222c 2073 7472  npack("!LL", str
+000205b0: 6561 6d2e 7265 6164 2838 2929 0a20 2020  eam.read(8)).   
+000205c0: 2020 2020 2072 6574 7572 6e20 282d 312c       return (-1,
+000205d0: 202d 3129 0a0a 0a63 6c61 7373 2049 535f   -1)...class IS_
+000205e0: 4649 4c45 2856 616c 6964 6174 6f72 293a  FILE(Validator):
+000205f0: 0a20 2020 2022 2222 0a20 2020 2043 6865  .    """.    Che
+00020600: 636b 7320 6966 206e 616d 6520 616e 6420  cks if name and 
+00020610: 6578 7465 6e73 696f 6e20 6f66 2066 696c  extension of fil
+00020620: 6520 7570 6c6f 6164 6564 2074 6872 6f75  e uploaded throu
+00020630: 6768 2066 696c 6520 696e 7075 7420 6d61  gh file input ma
+00020640: 7463 6865 730a 2020 2020 6769 7665 6e20  tches.    given 
+00020650: 6372 6974 6572 6961 2e0a 0a20 2020 2044  criteria...    D
+00020660: 6f65 7320 2a6e 6f74 2a20 656e 7375 7265  oes *not* ensure
+00020670: 2074 6865 2066 696c 6520 7479 7065 2069   the file type i
+00020680: 6e20 616e 7920 7761 792e 2052 6574 7572  n any way. Retur
+00020690: 6e73 2076 616c 6964 6174 696f 6e20 6661  ns validation fa
+000206a0: 696c 7572 650a 2020 2020 6966 206e 6f20  ilure.    if no 
+000206b0: 6461 7461 2077 6173 2075 706c 6f61 6465  data was uploade
+000206c0: 642e 0a0a 2020 2020 4172 6773 3a0a 2020  d...    Args:.  
+000206d0: 2020 2020 2020 6669 6c65 6e61 6d65 3a20        filename: 
+000206e0: 7374 7269 6e67 2f63 6f6d 7069 6c65 6420  string/compiled 
+000206f0: 7265 6765 7820 6f72 2061 206c 6973 7420  regex or a list 
+00020700: 6f66 2073 7472 696e 6773 2f72 6567 6578  of strings/regex
+00020710: 206f 6620 7661 6c69 6420 6669 6c65 6e61   of valid filena
+00020720: 6d65 730a 2020 2020 2020 2020 6578 7465  mes.        exte
+00020730: 6e73 696f 6e3a 2073 7472 696e 672f 636f  nsion: string/co
+00020740: 6d70 696c 6564 2072 6567 6578 206f 7220  mpiled regex or 
+00020750: 6120 6c69 7374 206f 6620 7374 7269 6e67  a list of string
+00020760: 732f 7265 6765 7820 6f66 2076 616c 6964  s/regex of valid
+00020770: 2065 7874 656e 7369 6f6e 730a 2020 2020   extensions.    
+00020780: 2020 2020 6c61 7374 646f 743a 2077 6869      lastdot: whi
+00020790: 6368 2064 6f74 2073 686f 756c 6420 6265  ch dot should be
+000207a0: 2075 7365 6420 6173 2061 2066 696c 656e   used as a filen
+000207b0: 616d 6520 2f20 6578 7465 6e73 696f 6e20  ame / extension 
+000207c0: 7365 7061 7261 746f 723a 0a20 2020 2020  separator:.     
+000207d0: 2020 2020 2020 2054 7275 6520 6d65 616e         True mean
+000207e0: 7320 6c61 7374 2064 6f74 2c20 6567 2e20  s last dot, eg. 
+000207f0: 6669 6c65 2e6a 7067 2e70 6e67 202d 3e20  file.jpg.png -> 
+00020800: 6669 6c65 2e6a 7067 202f 2070 6e67 0a20  file.jpg / png. 
+00020810: 2020 2020 2020 2020 2020 2046 616c 7365             False
+00020820: 206d 6561 6e73 2066 6972 7374 2064 6f74   means first dot
+00020830: 2c20 6567 2e20 6669 6c65 2e74 6172 2e67  , eg. file.tar.g
+00020840: 7a20 2d3e 2066 696c 6520 2f20 7461 722e  z -> file / tar.
+00020850: 677a 0a20 2020 2020 2020 2063 6173 653a  gz.        case:
+00020860: 2030 202d 206b 6565 7020 7468 6520 6361   0 - keep the ca
+00020870: 7365 2c20 3120 2d20 7472 616e 7366 6f72  se, 1 - transfor
+00020880: 6d20 7468 6520 7374 7269 6e67 2069 6e74  m the string int
+00020890: 6f20 6c6f 7765 7263 6173 6520 2864 6566  o lowercase (def
+000208a0: 6175 6c74 292c 0a20 2020 2020 2020 2020  ault),.         
+000208b0: 2020 2032 202d 2074 7261 6e73 666f 726d     2 - transform
+000208c0: 2074 6865 2073 7472 696e 6720 696e 746f   the string into
+000208d0: 2075 7070 6572 6361 7365 0a0a 2020 2020   uppercase..    
+000208e0: 4966 2074 6865 7265 2069 7320 6e6f 2064  If there is no d
+000208f0: 6f74 2070 7265 7365 6e74 2c20 6578 7465  ot present, exte
+00020900: 6e73 696f 6e20 6368 6563 6b73 2077 696c  nsion checks wil
+00020910: 6c20 6265 2064 6f6e 6520 6167 6169 6e73  l be done agains
+00020920: 7420 656d 7074 790a 2020 2020 7374 7269  t empty.    stri
+00020930: 6e67 2061 6e64 2066 696c 656e 616d 6520  ng and filename 
+00020940: 6368 6563 6b73 2061 6761 696e 7374 2077  checks against w
+00020950: 686f 6c65 2076 616c 7565 2e0a 0a20 2020  hole value...   
+00020960: 2045 7861 6d70 6c65 733a 0a20 2020 2020   Examples:.     
+00020970: 2020 2043 6865 636b 2069 6620 6669 6c65     Check if file
+00020980: 2068 6173 2061 2070 6466 2065 7874 656e   has a pdf exten
+00020990: 7369 6f6e 2028 6361 7365 2069 6e73 656e  sion (case insen
+000209a0: 7369 7469 7665 293a 0a0a 2020 2020 2020  sitive):..      
+000209b0: 2020 494e 5055 5428 5f74 7970 653d 2766    INPUT(_type='f
+000209c0: 696c 6527 2c20 5f6e 616d 653d 276e 616d  ile', _name='nam
+000209d0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+000209e0: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+000209f0: 4649 4c45 2865 7874 656e 7369 6f6e 3d27  FILE(extension='
+00020a00: 7064 6627 2929 0a0a 2020 2020 2020 2020  pdf'))..        
+00020a10: 4368 6563 6b20 6966 2066 696c 6520 6973  Check if file is
+00020a20: 2063 616c 6c65 6420 2774 6875 6d62 6e61   called 'thumbna
+00020a30: 696c 2720 616e 6420 6861 7320 6120 6a70  il' and has a jp
+00020a40: 6720 6f72 2070 6e67 2065 7874 656e 7369  g or png extensi
+00020a50: 6f6e 0a20 2020 2020 2020 2028 6361 7365  on.        (case
+00020a60: 2069 6e73 656e 7369 7469 7665 293a 0a0a   insensitive):..
+00020a70: 2020 2020 2020 2020 494e 5055 5428 5f74          INPUT(_t
+00020a80: 7970 653d 2766 696c 6527 2c20 5f6e 616d  ype='file', _nam
+00020a90: 653d 276e 616d 6527 2c0a 2020 2020 2020  e='name',.      
+00020aa0: 2020 2020 2020 2020 2020 7265 7175 6972            requir
+00020ab0: 6573 3d49 535f 4649 4c45 2866 696c 656e  es=IS_FILE(filen
+00020ac0: 616d 653d 2774 6875 6d62 6e61 696c 272c  ame='thumbnail',
+00020ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020ae0: 2065 7874 656e 7369 6f6e 3d5b 276a 7067   extension=['jpg
+00020af0: 272c 2027 706e 6727 5d29 290a 0a20 2020  ', 'png']))..   
+00020b00: 2020 2020 2043 6865 636b 2069 6620 6669       Check if fi
+00020b10: 6c65 2068 6173 2061 2074 6172 2e67 7a20  le has a tar.gz 
+00020b20: 6578 7465 6e73 696f 6e20 616e 6420 6e61  extension and na
+00020b30: 6d65 2073 7461 7274 696e 6720 7769 7468  me starting with
+00020b40: 2062 6163 6b75 703a 0a0a 2020 2020 2020   backup:..      
+00020b50: 2020 494e 5055 5428 5f74 7970 653d 2766    INPUT(_type='f
+00020b60: 696c 6527 2c20 5f6e 616d 653d 276e 616d  ile', _name='nam
+00020b70: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00020b80: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+00020b90: 4649 4c45 2866 696c 656e 616d 653d 7265  FILE(filename=re
+00020ba0: 2e63 6f6d 7069 6c65 2827 6261 636b 7570  .compile('backup
+00020bb0: 2e2a 2729 2c0a 2020 2020 2020 2020 2020  .*'),.          
+00020bc0: 2020 2020 2020 6578 7465 6e73 696f 6e3d        extension=
+00020bd0: 2774 6172 2e67 7a27 2c20 6c61 7374 646f  'tar.gz', lastdo
+00020be0: 743d 4661 6c73 6529 290a 0a20 2020 2020  t=False))..     
+00020bf0: 2020 2043 6865 636b 2069 6620 6669 6c65     Check if file
+00020c00: 2068 6173 206e 6f20 6578 7465 6e73 696f   has no extensio
+00020c10: 6e20 616e 6420 6e61 6d65 206d 6174 6368  n and name match
+00020c20: 696e 6720 5245 4144 4d45 0a20 2020 2020  ing README.     
+00020c30: 2020 2028 6361 7365 2073 656e 7369 7469     (case sensiti
+00020c40: 7665 293a 0a0a 2020 2020 2020 2020 2020  ve):..          
+00020c50: 2020 494e 5055 5428 5f74 7970 653d 2766    INPUT(_type='f
+00020c60: 696c 6527 2c20 5f6e 616d 653d 276e 616d  ile', _name='nam
+00020c70: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00020c80: 2020 2020 7265 7175 6972 6573 3d49 535f      requires=IS_
+00020c90: 4649 4c45 2866 696c 656e 616d 653d 2752  FILE(filename='R
+00020ca0: 4541 444d 4527 2c0a 2020 2020 2020 2020  EADME',.        
+00020cb0: 2020 2020 2020 2020 6578 7465 6e73 696f          extensio
+00020cc0: 6e3d 2727 2c20 6361 7365 3d30 290a 0a20  n='', case=0).. 
+00020cd0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+00020ce0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
+00020cf0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00020d00: 6669 6c65 6e61 6d65 3d4e 6f6e 652c 0a20  filename=None,. 
+00020d10: 2020 2020 2020 2065 7874 656e 7369 6f6e         extension
+00020d20: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
+00020d30: 6173 7464 6f74 3d54 7275 652c 0a20 2020  astdot=True,.   
+00020d40: 2020 2020 2063 6173 653d 312c 0a20 2020       case=1,.   
+00020d50: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00020d60: 6765 3d22 456e 7465 7220 7661 6c69 6420  ge="Enter valid 
+00020d70: 6669 6c65 6e61 6d65 222c 0a20 2020 2029  filename",.    )
+00020d80: 3a0a 2020 2020 2020 2020 7365 6c66 2e66  :.        self.f
+00020d90: 696c 656e 616d 6520 3d20 6669 6c65 6e61  ilename = filena
+00020da0: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
+00020db0: 6578 7465 6e73 696f 6e20 3d20 6578 7465  extension = exte
+00020dc0: 6e73 696f 6e0a 2020 2020 2020 2020 7365  nsion.        se
+00020dd0: 6c66 2e6c 6173 7464 6f74 203d 206c 6173  lf.lastdot = las
+00020de0: 7464 6f74 0a20 2020 2020 2020 2073 656c  tdot.        sel
+00020df0: 662e 6361 7365 203d 2063 6173 650a 2020  f.case = case.  
+00020e00: 2020 2020 2020 7365 6c66 2e65 7272 6f72        self.error
+00020e10: 5f6d 6573 7361 6765 203d 2065 7272 6f72  _message = error
+00020e20: 5f6d 6573 7361 6765 0a0a 2020 2020 6465  _message..    de
+00020e30: 6620 6d61 7463 6828 7365 6c66 2c20 7661  f match(self, va
+00020e40: 6c75 6531 2c20 7661 6c75 6532 293a 0a20  lue1, value2):. 
+00020e50: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00020e60: 616e 6365 2876 616c 7565 312c 2028 6c69  ance(value1, (li
+00020e70: 7374 2c20 7475 706c 6529 293a 0a20 2020  st, tuple)):.   
+00020e80: 2020 2020 2020 2020 2066 6f72 2076 2069           for v i
+00020e90: 6e20 7661 6c75 6531 3a0a 2020 2020 2020  n value1:.      
+00020ea0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00020eb0: 662e 6d61 7463 6828 762c 2076 616c 7565  f.match(v, value
+00020ec0: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+00020ed0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00020ee0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00020ef0: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
+00020f00: 2020 2020 2065 6c69 6620 6361 6c6c 6162       elif callab
+00020f10: 6c65 2867 6574 6174 7472 2876 616c 7565  le(getattr(value
+00020f20: 312c 2022 6d61 7463 6822 2c20 4e6f 6e65  1, "match", None
+00020f30: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00020f40: 7265 7475 726e 2076 616c 7565 312e 6d61  return value1.ma
+00020f50: 7463 6828 7661 6c75 6532 290a 2020 2020  tch(value2).    
+00020f60: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00020f70: 6e63 6528 7661 6c75 6531 2c20 7374 7229  nce(value1, str)
+00020f80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00020f90: 7475 726e 2076 616c 7565 3120 3d3d 2076  turn value1 == v
+00020fa0: 616c 7565 320a 0a20 2020 2064 6566 2076  alue2..    def v
+00020fb0: 616c 6964 6174 6528 7365 6c66 2c20 7661  alidate(self, va
+00020fc0: 6c75 652c 2072 6563 6f72 645f 6964 3d4e  lue, record_id=N
+00020fd0: 6f6e 6529 3a0a 2020 2020 2020 2020 7472  one):.        tr
+00020fe0: 793a 0a20 2020 2020 2020 2020 2020 2073  y:.            s
+00020ff0: 7472 696e 6720 3d20 7661 6c75 652e 6669  tring = value.fi
+00021000: 6c65 6e61 6d65 0a20 2020 2020 2020 2065  lename.        e
+00021010: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
+00021020: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+00021030: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
+00021040: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
+00021050: 726f 725f 6d65 7373 6167 6529 290a 2020  ror_message)).  
+00021060: 2020 2020 2020 6966 2073 656c 662e 6361        if self.ca
+00021070: 7365 203d 3d20 313a 0a20 2020 2020 2020  se == 1:.       
+00021080: 2020 2020 2073 7472 696e 6720 3d20 7374       string = st
+00021090: 7269 6e67 2e6c 6f77 6572 2829 0a20 2020  ring.lower().   
+000210a0: 2020 2020 2065 6c69 6620 7365 6c66 2e63       elif self.c
+000210b0: 6173 6520 3d3d 2032 3a0a 2020 2020 2020  ase == 2:.      
+000210c0: 2020 2020 2020 7374 7269 6e67 203d 2073        string = s
+000210d0: 7472 696e 672e 7570 7065 7228 290a 2020  tring.upper().  
+000210e0: 2020 2020 2020 6966 2073 656c 662e 6c61        if self.la
+000210f0: 7374 646f 743a 0a20 2020 2020 2020 2020  stdot:.         
+00021100: 2020 2064 6f74 203d 2073 7472 696e 672e     dot = string.
+00021110: 7266 696e 6428 222e 2229 0a20 2020 2020  rfind(".").     
+00021120: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00021130: 2020 2020 2064 6f74 203d 2073 7472 696e       dot = strin
+00021140: 672e 6669 6e64 2822 2e22 290a 2020 2020  g.find(".").    
+00021150: 2020 2020 6966 2064 6f74 203d 3d20 2d31      if dot == -1
+00021160: 3a0a 2020 2020 2020 2020 2020 2020 646f  :.            do
+00021170: 7420 3d20 6c65 6e28 7374 7269 6e67 290a  t = len(string).
+00021180: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00021190: 6669 6c65 6e61 6d65 2061 6e64 206e 6f74  filename and not
+000211a0: 2073 656c 662e 6d61 7463 6828 7365 6c66   self.match(self
+000211b0: 2e66 696c 656e 616d 652c 2073 7472 696e  .filename, strin
+000211c0: 675b 3a64 6f74 5d29 3a0a 2020 2020 2020  g[:dot]):.      
+000211d0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
+000211e0: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
+000211f0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
+00021200: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
+00021210: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00021220: 6c66 2e65 7874 656e 7369 6f6e 2061 6e64  lf.extension and
+00021230: 206e 6f74 2073 656c 662e 6d61 7463 6828   not self.match(
+00021240: 7365 6c66 2e65 7874 656e 7369 6f6e 2c20  self.extension, 
+00021250: 7374 7269 6e67 5b64 6f74 202b 2031 203a  string[dot + 1 :
+00021260: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00021270: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+00021280: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
+00021290: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
+000212a0: 5f6d 6573 7361 6765 2929 0a20 2020 2020  _message)).     
+000212b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000212c0: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
+000212d0: 650a 0a0a 636c 6173 7320 4953 5f55 504c  e...class IS_UPL
+000212e0: 4f41 445f 4649 4c45 4e41 4d45 2856 616c  OAD_FILENAME(Val
+000212f0: 6964 6174 6f72 293a 0a20 2020 2022 2222  idator):.    """
+00021300: 0a20 2020 2046 6f72 206e 6577 2061 7070  .    For new app
+00021310: 6c69 6361 7469 6f6e 732c 2075 7365 2049  lications, use I
+00021320: 535f 4649 4c45 2829 2e0a 0a20 2020 2043  S_FILE()...    C
+00021330: 6865 636b 7320 6966 206e 616d 6520 616e  hecks if name an
+00021340: 6420 6578 7465 6e73 696f 6e20 6f66 2066  d extension of f
+00021350: 696c 6520 7570 6c6f 6164 6564 2074 6872  ile uploaded thr
+00021360: 6f75 6768 2066 696c 6520 696e 7075 7420  ough file input 
+00021370: 6d61 7463 6865 730a 2020 2020 6769 7665  matches.    give
+00021380: 6e20 6372 6974 6572 6961 2e0a 0a20 2020  n criteria...   
+00021390: 2044 6f65 7320 2a6e 6f74 2a20 656e 7375   Does *not* ensu
+000213a0: 7265 2074 6865 2066 696c 6520 7479 7065  re the file type
+000213b0: 2069 6e20 616e 7920 7761 792e 2052 6574   in any way. Ret
+000213c0: 7572 6e73 2076 616c 6964 6174 696f 6e20  urns validation 
+000213d0: 6661 696c 7572 650a 2020 2020 6966 206e  failure.    if n
+000213e0: 6f20 6461 7461 2077 6173 2075 706c 6f61  o data was uploa
+000213f0: 6465 642e 0a0a 2020 2020 4172 6773 3a0a  ded...    Args:.
+00021400: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
+00021410: 3a20 6669 6c65 6e61 6d65 2028 6265 666f  : filename (befo
+00021420: 7265 2064 6f74 2920 7265 6765 780a 2020  re dot) regex.  
+00021430: 2020 2020 2020 6578 7465 6e73 696f 6e3a        extension:
+00021440: 2065 7874 656e 7369 6f6e 2028 6166 7465   extension (afte
+00021450: 7220 646f 7429 2072 6567 6578 0a20 2020  r dot) regex.   
+00021460: 2020 2020 206c 6173 7464 6f74 3a20 7768       lastdot: wh
+00021470: 6963 6820 646f 7420 7368 6f75 6c64 2062  ich dot should b
+00021480: 6520 7573 6564 2061 7320 6120 6669 6c65  e used as a file
+00021490: 6e61 6d65 202f 2065 7874 656e 7369 6f6e  name / extension
+000214a0: 2073 6570 6172 6174 6f72 3a0a 2020 2020   separator:.    
+000214b0: 2020 2020 2020 2020 5472 7565 206d 6561          True mea
+000214c0: 6e73 206c 6173 7420 646f 742c 2065 672e  ns last dot, eg.
+000214d0: 2066 696c 652e 706e 6720 2d3e 2066 696c   file.png -> fil
+000214e0: 6520 2f20 706e 670a 2020 2020 2020 2020  e / png.        
+000214f0: 2020 2020 4661 6c73 6520 6d65 616e 7320      False means 
+00021500: 6669 7273 7420 646f 742c 2065 672e 2066  first dot, eg. f
+00021510: 696c 652e 7461 722e 677a 202d 3e20 6669  ile.tar.gz -> fi
+00021520: 6c65 202f 2074 6172 2e67 7a0a 2020 2020  le / tar.gz.    
+00021530: 2020 2020 6361 7365 3a20 3020 2d20 6b65      case: 0 - ke
+00021540: 6570 2074 6865 2063 6173 652c 2031 202d  ep the case, 1 -
+00021550: 2074 7261 6e73 666f 726d 2074 6865 2073   transform the s
+00021560: 7472 696e 6720 696e 746f 206c 6f77 6572  tring into lower
+00021570: 6361 7365 2028 6465 6661 756c 7429 2c0a  case (default),.
+00021580: 2020 2020 2020 2020 2020 2020 3220 2d20              2 - 
+00021590: 7472 616e 7366 6f72 6d20 7468 6520 7374  transform the st
+000215a0: 7269 6e67 2069 6e74 6f20 7570 7065 7263  ring into upperc
+000215b0: 6173 650a 0a20 2020 2049 6620 7468 6572  ase..    If ther
+000215c0: 6520 6973 206e 6f20 646f 7420 7072 6573  e is no dot pres
+000215d0: 656e 742c 2065 7874 656e 7369 6f6e 2063  ent, extension c
+000215e0: 6865 636b 7320 7769 6c6c 2062 6520 646f  hecks will be do
+000215f0: 6e65 2061 6761 696e 7374 2065 6d70 7479  ne against empty
+00021600: 0a20 2020 2073 7472 696e 6720 616e 6420  .    string and 
+00021610: 6669 6c65 6e61 6d65 2063 6865 636b 7320  filename checks 
+00021620: 6167 6169 6e73 7420 7768 6f6c 6520 7661  against whole va
+00021630: 6c75 652e 0a0a 2020 2020 4578 616d 706c  lue...    Exampl
+00021640: 6573 3a0a 2020 2020 2020 2020 4368 6563  es:.        Chec
+00021650: 6b20 6966 2066 696c 6520 6861 7320 6120  k if file has a 
+00021660: 7064 6620 6578 7465 6e73 696f 6e20 2863  pdf extension (c
+00021670: 6173 6520 696e 7365 6e73 6974 6976 6529  ase insensitive)
+00021680: 3a0a 0a20 2020 2020 2020 2049 4e50 5554  :..        INPUT
+00021690: 285f 7479 7065 3d27 6669 6c65 272c 205f  (_type='file', _
+000216a0: 6e61 6d65 3d27 6e61 6d65 272c 0a20 2020  name='name',.   
+000216b0: 2020 2020 2020 2020 2020 2020 2072 6571               req
+000216c0: 7569 7265 733d 4953 5f55 504c 4f41 445f  uires=IS_UPLOAD_
+000216d0: 4649 4c45 4e41 4d45 2865 7874 656e 7369  FILENAME(extensi
+000216e0: 6f6e 3d27 7064 6627 2929 0a0a 2020 2020  on='pdf'))..    
+000216f0: 2020 2020 4368 6563 6b20 6966 2066 696c      Check if fil
+00021700: 6520 6861 7320 6120 7461 722e 677a 2065  e has a tar.gz e
+00021710: 7874 656e 7369 6f6e 2061 6e64 206e 616d  xtension and nam
+00021720: 6520 7374 6172 7469 6e67 2077 6974 6820  e starting with 
+00021730: 6261 636b 7570 3a0a 0a20 2020 2020 2020  backup:..       
+00021740: 2049 4e50 5554 285f 7479 7065 3d27 6669   INPUT(_type='fi
+00021750: 6c65 272c 205f 6e61 6d65 3d27 6e61 6d65  le', _name='name
+00021760: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00021770: 2020 2072 6571 7569 7265 733d 4953 5f55     requires=IS_U
+00021780: 504c 4f41 445f 4649 4c45 4e41 4d45 2866  PLOAD_FILENAME(f
+00021790: 696c 656e 616d 653d 2762 6163 6b75 702e  ilename='backup.
+000217a0: 2a27 2c0a 2020 2020 2020 2020 2020 2020  *',.            
+000217b0: 2020 2020 6578 7465 6e73 696f 6e3d 2774      extension='t
+000217c0: 6172 2e67 7a27 2c20 6c61 7374 646f 743d  ar.gz', lastdot=
+000217d0: 4661 6c73 6529 290a 0a20 2020 2020 2020  False))..       
+000217e0: 2043 6865 636b 2069 6620 6669 6c65 2068   Check if file h
+000217f0: 6173 206e 6f20 6578 7465 6e73 696f 6e20  as no extension 
+00021800: 616e 6420 6e61 6d65 206d 6174 6368 696e  and name matchin
+00021810: 6720 5245 4144 4d45 0a20 2020 2020 2020  g README.       
+00021820: 2028 6361 7365 2073 656e 7369 7469 7665   (case sensitive
+00021830: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+00021840: 494e 5055 5428 5f74 7970 653d 2766 696c  INPUT(_type='fil
+00021850: 6527 2c20 5f6e 616d 653d 276e 616d 6527  e', _name='name'
+00021860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00021870: 2020 7265 7175 6972 6573 3d49 535f 5550    requires=IS_UP
+00021880: 4c4f 4144 5f46 494c 454e 414d 4528 6669  LOAD_FILENAME(fi
+00021890: 6c65 6e61 6d65 3d27 5e52 4541 444d 4524  lename='^README$
+000218a0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+000218b0: 2020 2065 7874 656e 7369 6f6e 3d27 5e24     extension='^$
+000218c0: 272c 2063 6173 653d 3029 0a0a 2020 2020  ', case=0)..    
+000218d0: 2222 220a 0a20 2020 2064 6566 205f 5f69  """..    def __i
+000218e0: 6e69 745f 5f28 0a20 2020 2020 2020 2073  nit__(.        s
+000218f0: 656c 662c 0a20 2020 2020 2020 2066 696c  elf,.        fil
+00021900: 656e 616d 653d 4e6f 6e65 2c0a 2020 2020  ename=None,.    
+00021910: 2020 2020 6578 7465 6e73 696f 6e3d 4e6f      extension=No
+00021920: 6e65 2c0a 2020 2020 2020 2020 6c61 7374  ne,.        last
+00021930: 646f 743d 5472 7565 2c0a 2020 2020 2020  dot=True,.      
+00021940: 2020 6361 7365 3d31 2c0a 2020 2020 2020    case=1,.      
+00021950: 2020 6572 726f 725f 6d65 7373 6167 653d    error_message=
+00021960: 2245 6e74 6572 2076 616c 6964 2066 696c  "Enter valid fil
+00021970: 656e 616d 6522 2c0a 2020 2020 293a 0a20  ename",.    ):. 
+00021980: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00021990: 616e 6365 2866 696c 656e 616d 652c 2073  ance(filename, s
+000219a0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+000219b0: 2066 696c 656e 616d 6520 3d20 7265 2e63   filename = re.c
+000219c0: 6f6d 7069 6c65 2866 696c 656e 616d 6529  ompile(filename)
+000219d0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+000219e0: 7374 616e 6365 2865 7874 656e 7369 6f6e  stance(extension
+000219f0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+00021a00: 2020 2020 6578 7465 6e73 696f 6e20 3d20      extension = 
+00021a10: 7265 2e63 6f6d 7069 6c65 2865 7874 656e  re.compile(exten
+00021a20: 7369 6f6e 290a 2020 2020 2020 2020 7365  sion).        se
+00021a30: 6c66 2e66 696c 656e 616d 6520 3d20 6669  lf.filename = fi
+00021a40: 6c65 6e61 6d65 0a20 2020 2020 2020 2073  lename.        s
+00021a50: 656c 662e 6578 7465 6e73 696f 6e20 3d20  elf.extension = 
+00021a60: 6578 7465 6e73 696f 6e0a 2020 2020 2020  extension.      
+00021a70: 2020 7365 6c66 2e6c 6173 7464 6f74 203d    self.lastdot =
+00021a80: 206c 6173 7464 6f74 0a20 2020 2020 2020   lastdot.       
+00021a90: 2073 656c 662e 6361 7365 203d 2063 6173   self.case = cas
+00021aa0: 650a 2020 2020 2020 2020 7365 6c66 2e65  e.        self.e
+00021ab0: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
+00021ac0: 7272 6f72 5f6d 6573 7361 6765 0a0a 2020  rror_message..  
+00021ad0: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
+00021ae0: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
+00021af0: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
+00021b00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00021b10: 2020 2020 2020 7374 7269 6e67 203d 2076        string = v
+00021b20: 616c 7565 2e66 696c 656e 616d 650a 2020  alue.filename.  
+00021b30: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+00021b40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00021b50: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
+00021b60: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+00021b70: 7365 6c66 2e65 7272 6f72 5f6d 6573 7361  self.error_messa
+00021b80: 6765 2929 0a20 2020 2020 2020 2069 6620  ge)).        if 
+00021b90: 7365 6c66 2e63 6173 6520 3d3d 2031 3a0a  self.case == 1:.
+00021ba0: 2020 2020 2020 2020 2020 2020 7374 7269              stri
+00021bb0: 6e67 203d 2073 7472 696e 672e 6c6f 7765  ng = string.lowe
+00021bc0: 7228 290a 2020 2020 2020 2020 656c 6966  r().        elif
+00021bd0: 2073 656c 662e 6361 7365 203d 3d20 323a   self.case == 2:
+00021be0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00021bf0: 696e 6720 3d20 7374 7269 6e67 2e75 7070  ing = string.upp
+00021c00: 6572 2829 0a20 2020 2020 2020 2069 6620  er().        if 
+00021c10: 7365 6c66 2e6c 6173 7464 6f74 3a0a 2020  self.lastdot:.  
+00021c20: 2020 2020 2020 2020 2020 646f 7420 3d20            dot = 
+00021c30: 7374 7269 6e67 2e72 6669 6e64 2822 2e22  string.rfind("."
+00021c40: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00021c50: 2020 2020 2020 2020 2020 2020 646f 7420              dot 
+00021c60: 3d20 7374 7269 6e67 2e66 696e 6428 222e  = string.find(".
+00021c70: 2229 0a20 2020 2020 2020 2069 6620 646f  ").        if do
+00021c80: 7420 3d3d 202d 313a 0a20 2020 2020 2020  t == -1:.       
+00021c90: 2020 2020 2064 6f74 203d 206c 656e 2873       dot = len(s
+00021ca0: 7472 696e 6729 0a20 2020 2020 2020 2069  tring).        i
+00021cb0: 6620 7365 6c66 2e66 696c 656e 616d 6520  f self.filename 
+00021cc0: 616e 6420 6e6f 7420 7365 6c66 2e66 696c  and not self.fil
+00021cd0: 656e 616d 652e 6d61 7463 6828 7374 7269  ename.match(stri
+00021ce0: 6e67 5b3a 646f 745d 293a 0a20 2020 2020  ng[:dot]):.     
+00021cf0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00021d00: 6964 6174 696f 6e45 7272 6f72 2873 656c  idationError(sel
+00021d10: 662e 7472 616e 736c 6174 6f72 2873 656c  f.translator(sel
+00021d20: 662e 6572 726f 725f 6d65 7373 6167 6529  f.error_message)
+00021d30: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+00021d40: 656c 662e 6578 7465 6e73 696f 6e20 616e  elf.extension an
+00021d50: 6420 6e6f 7420 7365 6c66 2e65 7874 656e  d not self.exten
+00021d60: 7369 6f6e 2e6d 6174 6368 2873 7472 696e  sion.match(strin
+00021d70: 675b 646f 7420 2b20 3120 3a5d 293a 0a20  g[dot + 1 :]):. 
+00021d80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00021d90: 2056 616c 6964 6174 696f 6e45 7272 6f72   ValidationError
+00021da0: 2873 656c 662e 7472 616e 736c 6174 6f72  (self.translator
+00021db0: 2873 656c 662e 6572 726f 725f 6d65 7373  (self.error_mess
+00021dc0: 6167 6529 290a 2020 2020 2020 2020 656c  age)).        el
+00021dd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00021de0: 7265 7475 726e 2076 616c 7565 0a0a 0a63  return value...c
+00021df0: 6c61 7373 2049 535f 4950 5634 2856 616c  lass IS_IPV4(Val
+00021e00: 6964 6174 6f72 293a 0a20 2020 2022 2222  idator):.    """
+00021e10: 0a20 2020 2043 6865 636b 7320 6966 2066  .    Checks if f
+00021e20: 6965 6c64 2773 2076 616c 7565 2069 7320  ield's value is 
+00021e30: 616e 2049 5020 7665 7273 696f 6e20 3420  an IP version 4 
+00021e40: 6164 6472 6573 7320 696e 2064 6563 696d  address in decim
+00021e50: 616c 2066 6f72 6d2e 2043 616e 0a20 2020  al form. Can.   
+00021e60: 2062 6520 7365 7420 746f 2066 6f72 6365   be set to force
+00021e70: 2061 6464 7265 7373 6573 2066 726f 6d20   addresses from 
+00021e80: 6365 7274 6169 6e20 7261 6e67 652e 0a0a  certain range...
+00021e90: 2020 2020 4950 7634 2072 6567 6578 2074      IPv4 regex t
+00021ea0: 616b 656e 2066 726f 6d3a 2068 7474 703a  aken from: http:
+00021eb0: 2f2f 7265 6765 786c 6962 2e63 6f6d 2f52  //regexlib.com/R
+00021ec0: 4544 6574 6169 6c73 2e61 7370 783f 7265  EDetails.aspx?re
+00021ed0: 6765 7870 5f69 643d 3134 3131 0a0a 2020  gexp_id=1411..  
+00021ee0: 2020 4172 6773 3a0a 0a20 2020 2020 2020    Args:..       
+00021ef0: 206d 696e 6970 3a20 6c6f 7765 7374 2061   minip: lowest a
+00021f00: 6c6c 6f77 6564 2061 6464 7265 7373 3b20  llowed address; 
+00021f10: 6163 6365 7074 733a 0a0a 2020 2020 2020  accepts:..      
+00021f20: 2020 2020 2020 2d20 7374 722c 2065 672e        - str, eg.
+00021f30: 2031 3932 2e31 3638 2e30 2e31 0a20 2020   192.168.0.1.   
+00021f40: 2020 2020 2020 2020 202d 206c 6973 7420           - list 
+00021f50: 6f72 2074 7570 6c65 206f 6620 6f63 7465  or tuple of octe
+00021f60: 7473 2c20 6567 2e20 5b31 3932 2c20 3136  ts, eg. [192, 16
+00021f70: 382c 2030 2c20 315d 0a20 2020 2020 2020  8, 0, 1].       
+00021f80: 206d 6178 6970 3a20 6869 6768 6573 7420   maxip: highest 
+00021f90: 616c 6c6f 7765 6420 6164 6472 6573 733b  allowed address;
+00021fa0: 2073 616d 6520 6173 2061 626f 7665 0a20   same as above. 
+00021fb0: 2020 2020 2020 2069 6e76 6572 743a 2054         invert: T
+00021fc0: 7275 6520 746f 2061 6c6c 6f77 2061 6464  rue to allow add
+00021fd0: 7265 7373 6573 206f 6e6c 7920 6672 6f6d  resses only from
+00021fe0: 206f 7574 7369 6465 206f 6620 6769 7665   outside of give
+00021ff0: 6e20 7261 6e67 653b 206e 6f74 650a 2020  n range; note.  
+00022000: 2020 2020 2020 2020 2020 7468 6174 2072            that r
+00022010: 616e 6765 2062 6f75 6e64 6172 6965 7320  ange boundaries 
+00022020: 6172 6520 6e6f 7420 6d61 7463 6865 6420  are not matched 
+00022030: 7468 6973 2077 6179 0a20 2020 2020 2020  this way.       
+00022040: 2069 735f 6c6f 6361 6c68 6f73 743a 206c   is_localhost: l
+00022050: 6f63 616c 686f 7374 2061 6464 7265 7373  ocalhost address
+00022060: 2074 7265 6174 6d65 6e74 3a0a 0a20 2020   treatment:..   
+00022070: 2020 2020 2020 2020 202d 204e 6f6e 6520           - None 
+00022080: 2864 6566 6175 6c74 293a 2069 6e64 6966  (default): indif
+00022090: 6665 7265 6e74 0a20 2020 2020 2020 2020  ferent.         
+000220a0: 2020 202d 2054 7275 6520 2865 6e66 6f72     - True (enfor
+000220b0: 6365 293a 2071 7565 7279 2061 6464 7265  ce): query addre
+000220c0: 7373 206d 7573 7420 6d61 7463 6820 6c6f  ss must match lo
+000220d0: 6361 6c68 6f73 7420 6164 6472 6573 7320  calhost address 
+000220e0: 2831 3237 2e30 2e30 2e31 290a 2020 2020  (127.0.0.1).    
+000220f0: 2020 2020 2020 2020 2d20 4661 6c73 6520          - False 
+00022100: 2866 6f72 6269 6429 3a20 7175 6572 7920  (forbid): query 
+00022110: 6164 6472 6573 7320 6d75 7374 206e 6f74  address must not
+00022120: 206d 6174 6368 206c 6f63 616c 686f 7374   match localhost
+00022130: 2061 6464 7265 7373 0a20 2020 2020 2020   address.       
+00022140: 2069 735f 7072 6976 6174 653a 2073 616d   is_private: sam
+00022150: 6520 6173 2061 626f 7665 2c20 6578 6365  e as above, exce
+00022160: 7074 2074 6861 7420 7175 6572 7920 6164  pt that query ad
+00022170: 6472 6573 7320 6973 2063 6865 636b 6564  dress is checked
+00022180: 2061 6761 696e 7374 0a20 2020 2020 2020   against.       
+00022190: 2020 2020 2074 776f 2061 6464 7265 7373       two address
+000221a0: 2072 616e 6765 733a 2031 3732 2e31 362e   ranges: 172.16.
+000221b0: 302e 3020 2d20 3137 322e 3331 2e32 3535  0.0 - 172.31.255
+000221c0: 2e32 3535 2061 6e64 0a20 2020 2020 2020  .255 and.       
+000221d0: 2020 2020 2031 3932 2e31 3638 2e30 2e30       192.168.0.0
+000221e0: 202d 2031 3932 2e31 3638 2e32 3535 2e32   - 192.168.255.2
+000221f0: 3535 0a20 2020 2020 2020 2069 735f 6175  55.        is_au
+00022200: 746f 6d61 7469 633a 2073 616d 6520 6173  tomatic: same as
+00022210: 2061 626f 7665 2c20 6578 6365 7074 2074   above, except t
+00022220: 6861 7420 7175 6572 7920 6164 6472 6573  hat query addres
+00022230: 7320 6973 2063 6865 636b 6564 2061 6761  s is checked aga
+00022240: 696e 7374 0a20 2020 2020 2020 2020 2020  inst.           
+00022250: 206f 6e65 2061 6464 7265 7373 2072 616e   one address ran
+00022260: 6765 3a20 3136 392e 3235 342e 302e 3020  ge: 169.254.0.0 
+00022270: 2d20 3136 392e 3235 342e 3235 352e 3235  - 169.254.255.25
+00022280: 350a 0a20 2020 204d 696e 6970 2061 6e64  5..    Minip and
+00022290: 206d 6178 6970 206d 6179 2061 6c73 6f20   maxip may also 
+000222a0: 6265 206c 6973 7473 206f 7220 7475 706c  be lists or tupl
+000222b0: 6573 206f 6620 6164 6472 6573 7365 7320  es of addresses 
+000222c0: 696e 2061 6c6c 2061 626f 7665 0a20 2020  in all above.   
+000222d0: 2066 6f72 6d73 2028 7374 722c 2069 6e74   forms (str, int
+000222e0: 2c20 6c69 7374 202f 2074 7570 6c65 292c  , list / tuple),
+000222f0: 2061 6c6c 6f77 696e 6720 7365 7475 7020   allowing setup 
+00022300: 6f66 206d 756c 7469 706c 6520 6164 6472  of multiple addr
+00022310: 6573 7320 7261 6e67 6573 3a3a 0a0a 2020  ess ranges::..  
+00022320: 2020 2020 2020 6d69 6e69 7020 3d20 286d        minip = (m
+00022330: 696e 6970 312c 206d 696e 6970 322c 202e  inip1, minip2, .
+00022340: 2e2e 206d 696e 6970 4e29 0a20 2020 2020  .. minipN).     
+00022350: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00022360: 2020 2020 2020 7c20 2020 2020 2020 2020        |         
+00022370: 2020 7c0a 2020 2020 2020 2020 2020 2020    |.            
+00022380: 2020 2020 2020 207c 2020 2020 2020 207c         |       |
+00022390: 2020 2020 2020 2020 2020 207c 0a20 2020             |.   
+000223a0: 2020 2020 206d 6178 6970 203d 2028 6d61       maxip = (ma
+000223b0: 7869 7031 2c20 6d61 7869 7032 2c20 2e2e  xip1, maxip2, ..
+000223c0: 2e20 6d61 7869 704e 290a 0a20 2020 204c  . maxipN)..    L
+000223d0: 6f6e 6765 7220 6974 6572 6162 6c65 2077  onger iterable w
+000223e0: 696c 6c20 6265 2074 7275 6e63 6174 6564  ill be truncated
+000223f0: 2074 6f20 6d61 7463 6820 6c65 6e67 7468   to match length
+00022400: 206f 6620 7368 6f72 7465 7220 6f6e 652e   of shorter one.
+00022410: 0a0a 2020 2020 4578 616d 706c 6573 3a0a  ..    Examples:.
+00022420: 2020 2020 2020 2020 4368 6563 6b20 666f          Check fo
+00022430: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
+00022440: 7265 7373 3a0a 0a20 2020 2020 2020 2020  ress:..         
+00022450: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
+00022460: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
+00022470: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
+00022480: 5f49 5056 3428 2929 0a0a 2020 2020 2020  _IPV4())..      
+00022490: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
+000224a0: 6420 4950 7634 2061 6464 7265 7373 2062  d IPv4 address b
+000224b0: 656c 6f6e 6769 6e67 2074 6f20 7370 6563  elonging to spec
+000224c0: 6966 6963 2072 616e 6765 3a0a 0a20 2020  ific range:..   
+000224d0: 2020 2020 2020 2020 2049 4e50 5554 285f           INPUT(_
+000224e0: 7479 7065 3d27 7465 7874 272c 205f 6e61  type='text', _na
+000224f0: 6d65 3d27 6e61 6d65 272c 0a20 2020 2020  me='name',.     
+00022500: 2020 2020 2020 2020 2020 2072 6571 7569             requi
+00022510: 7265 733d 4953 5f49 5056 3428 6d69 6e69  res=IS_IPV4(mini
+00022520: 703d 2731 3030 2e32 3030 2e30 2e30 272c  p='100.200.0.0',
+00022530: 206d 6178 6970 3d27 3130 302e 3230 302e   maxip='100.200.
+00022540: 3235 352e 3235 3527 2929 0a0a 2020 2020  255.255'))..    
+00022550: 2020 2020 4368 6563 6b20 666f 7220 7661      Check for va
+00022560: 6c69 6420 4950 7634 2061 6464 7265 7373  lid IPv4 address
+00022570: 2062 656c 6f6e 6769 6e67 2074 6f20 6569   belonging to ei
+00022580: 7468 6572 2031 3030 2e31 3130 2e30 2e30  ther 100.110.0.0
+00022590: 202d 0a20 2020 2020 2020 2031 3030 2e31   -.        100.1
+000225a0: 3130 2e32 3535 2e32 3535 206f 7220 3230  10.255.255 or 20
+000225b0: 302e 3530 2e30 2e30 202d 2032 3030 2e35  0.50.0.0 - 200.5
+000225c0: 302e 302e 3235 3520 6164 6472 6573 7320  0.0.255 address 
+000225d0: 7261 6e67 653a 0a0a 2020 2020 2020 2020  range:..        
+000225e0: 2020 2020 494e 5055 5428 5f74 7970 653d      INPUT(_type=
+000225f0: 2774 6578 7427 2c20 5f6e 616d 653d 276e  'text', _name='n
+00022600: 616d 6527 2c0a 2020 2020 2020 2020 2020  ame',.          
+00022610: 2020 2020 2020 7265 7175 6972 6573 3d49        requires=I
+00022620: 535f 4950 5634 286d 696e 6970 3d28 2731  S_IPV4(minip=('1
+00022630: 3030 2e31 3130 2e30 2e30 272c 2027 3230  00.110.0.0', '20
+00022640: 302e 3530 2e30 2e30 2729 2c0a 2020 2020  0.50.0.0'),.    
+00022650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022660: 2020 2020 2020 2020 206d 6178 6970 3d28           maxip=(
+00022670: 2731 3030 2e31 3130 2e32 3535 2e32 3535  '100.110.255.255
+00022680: 272c 2027 3230 302e 3530 2e30 2e32 3535  ', '200.50.0.255
+00022690: 2729 2929 0a0a 2020 2020 2020 2020 4368  ')))..        Ch
+000226a0: 6563 6b20 666f 7220 7661 6c69 6420 4950  eck for valid IP
+000226b0: 7634 2061 6464 7265 7373 2062 656c 6f6e  v4 address belon
+000226c0: 6769 6e67 2074 6f20 7072 6976 6174 6520  ging to private 
+000226d0: 6164 6472 6573 7320 7370 6163 653a 0a0a  address space:..
+000226e0: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
+000226f0: 5428 5f74 7970 653d 2774 6578 7427 2c20  T(_type='text', 
+00022700: 5f6e 616d 653d 276e 616d 6527 2c20 7265  _name='name', re
+00022710: 7175 6972 6573 3d49 535f 4950 5634 2869  quires=IS_IPV4(i
+00022720: 735f 7072 6976 6174 653d 5472 7565 2929  s_private=True))
+00022730: 0a0a 2020 2020 2020 2020 4368 6563 6b20  ..        Check 
+00022740: 666f 7220 7661 6c69 6420 4950 7634 2061  for valid IPv4 a
+00022750: 6464 7265 7373 2074 6861 7420 6973 206e  ddress that is n
+00022760: 6f74 2061 206c 6f63 616c 686f 7374 2061  ot a localhost a
+00022770: 6464 7265 7373 3a0a 0a20 2020 2020 2020  ddress:..       
+00022780: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
+00022790: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
+000227a0: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
+000227b0: 4953 5f49 5056 3428 6973 5f6c 6f63 616c  IS_IPV4(is_local
+000227c0: 686f 7374 3d46 616c 7365 2929 0a0a 2020  host=False))..  
+000227d0: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+000227e0: 5f49 5056 3428 2928 2731 2e32 2e33 2e34  _IPV4()('1.2.3.4
+000227f0: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00022800: 2731 2e32 2e33 2e34 272c 204e 6f6e 6529  '1.2.3.4', None)
+00022810: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00022820: 2049 535f 4950 5634 2829 2827 3235 352e   IS_IPV4()('255.
+00022830: 3235 352e 3235 352e 3235 3527 290a 2020  255.255.255').  
+00022840: 2020 2020 2020 2020 2020 2827 3235 352e            ('255.
+00022850: 3235 352e 3235 352e 3235 3527 2c20 4e6f  255.255.255', No
+00022860: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00022870: 3e3e 3e20 4953 5f49 5056 3428 2928 2731  >>> IS_IPV4()('1
+00022880: 2e32 2e33 2e34 2027 290a 2020 2020 2020  .2.3.4 ').      
+00022890: 2020 2020 2020 2827 312e 322e 332e 3420        ('1.2.3.4 
+000228a0: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
+000228b0: 4950 7634 2061 6464 7265 7373 2729 0a20  IPv4 address'). 
+000228c0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+000228d0: 535f 4950 5634 2829 2827 312e 322e 332e  S_IPV4()('1.2.3.
+000228e0: 342e 3527 290a 2020 2020 2020 2020 2020  4.5').          
+000228f0: 2020 2827 312e 322e 332e 342e 3527 2c20    ('1.2.3.4.5', 
+00022900: 2765 6e74 6572 2076 616c 6964 2049 5076  'enter valid IPv
+00022910: 3420 6164 6472 6573 7327 290a 2020 2020  4 address').    
+00022920: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00022930: 5056 3428 2928 2731 3233 2e31 3233 2729  PV4()('123.123')
+00022940: 0a20 2020 2020 2020 2020 2020 2028 2731  .            ('1
+00022950: 3233 2e31 3233 272c 2027 656e 7465 7220  23.123', 'enter 
+00022960: 7661 6c69 6420 4950 7634 2061 6464 7265  valid IPv4 addre
+00022970: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
+00022980: 203e 3e3e 2049 535f 4950 5634 2829 2827   >>> IS_IPV4()('
+00022990: 3131 3131 2e32 2e33 2e34 2729 0a20 2020  1111.2.3.4').   
+000229a0: 2020 2020 2020 2020 2028 2731 3131 312e           ('1111.
+000229b0: 322e 332e 3427 2c20 2765 6e74 6572 2076  2.3.4', 'enter v
+000229c0: 616c 6964 2049 5076 3420 6164 6472 6573  alid IPv4 addres
+000229d0: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
+000229e0: 3e3e 3e20 4953 5f49 5056 3428 2928 2730  >>> IS_IPV4()('0
+000229f0: 3131 312e 322e 332e 3427 290a 2020 2020  111.2.3.4').    
+00022a00: 2020 2020 2020 2020 2827 3031 3131 2e32          ('0111.2
+00022a10: 2e33 2e34 272c 2027 656e 7465 7220 7661  .3.4', 'enter va
+00022a20: 6c69 6420 4950 7634 2061 6464 7265 7373  lid IPv4 address
+00022a30: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
+00022a40: 3e3e 2049 535f 4950 5634 2829 2827 3235  >> IS_IPV4()('25
+00022a50: 362e 322e 332e 3427 290a 2020 2020 2020  6.2.3.4').      
+00022a60: 2020 2020 2020 2827 3235 362e 322e 332e        ('256.2.3.
+00022a70: 3427 2c20 2765 6e74 6572 2076 616c 6964  4', 'enter valid
+00022a80: 2049 5076 3420 6164 6472 6573 7327 290a   IPv4 address').
+00022a90: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00022aa0: 4953 5f49 5056 3428 2928 2733 3030 2e32  IS_IPV4()('300.2
+00022ab0: 2e33 2e34 2729 0a20 2020 2020 2020 2020  .3.4').         
+00022ac0: 2020 2028 2733 3030 2e32 2e33 2e34 272c     ('300.2.3.4',
+00022ad0: 2027 656e 7465 7220 7661 6c69 6420 4950   'enter valid IP
+00022ae0: 7634 2061 6464 7265 7373 2729 0a20 2020  v4 address').   
+00022af0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+00022b00: 4950 5634 286d 696e 6970 3d27 312e 322e  IPV4(minip='1.2.
+00022b10: 332e 3427 2c20 6d61 7869 703d 2731 2e32  3.4', maxip='1.2
+00022b20: 2e33 2e34 2729 2827 312e 322e 332e 3427  .3.4')('1.2.3.4'
+00022b30: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00022b40: 312e 322e 332e 3427 2c20 4e6f 6e65 290a  1.2.3.4', None).
+00022b50: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00022b60: 4953 5f49 5056 3428 6d69 6e69 703d 2731  IS_IPV4(minip='1
+00022b70: 2e32 2e33 2e35 272c 206d 6178 6970 3d27  .2.3.5', maxip='
+00022b80: 312e 322e 332e 3927 2c20 6572 726f 725f  1.2.3.9', error_
+00022b90: 6d65 7373 6167 653d 2742 6164 2069 7027  message='Bad ip'
+00022ba0: 2928 2731 2e32 2e33 2e34 2729 0a20 2020  )('1.2.3.4').   
+00022bb0: 2020 2020 2020 2020 2028 2731 2e32 2e33           ('1.2.3
+00022bc0: 2e34 272c 2027 6261 6420 6970 2729 0a20  .4', 'bad ip'). 
+00022bd0: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00022be0: 535f 4950 5634 286d 6178 6970 3d27 312e  S_IPV4(maxip='1.
+00022bf0: 322e 332e 3427 2c20 696e 7665 7274 3d54  2.3.4', invert=T
+00022c00: 7275 6529 2827 3132 372e 302e 302e 3127  rue)('127.0.0.1'
+00022c10: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00022c20: 3132 372e 302e 302e 3127 2c20 4e6f 6e65  127.0.0.1', None
+00022c30: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00022c40: 3e20 4953 5f49 5056 3428 6d61 7869 703d  > IS_IPV4(maxip=
+00022c50: 2731 2e32 2e33 2e34 272c 2069 6e76 6572  '1.2.3.4', inver
+00022c60: 743d 5472 7565 2928 2731 2e32 2e33 2e34  t=True)('1.2.3.4
+00022c70: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00022c80: 2731 2e32 2e33 2e34 272c 2027 656e 7465  '1.2.3.4', 'ente
+00022c90: 7220 7661 6c69 6420 4950 7634 2061 6464  r valid IPv4 add
+00022ca0: 7265 7373 2729 0a20 2020 2020 2020 2020  ress').         
+00022cb0: 2020 203e 3e3e 2049 535f 4950 5634 2869     >>> IS_IPV4(i
+00022cc0: 735f 6c6f 6361 6c68 6f73 743d 5472 7565  s_localhost=True
+00022cd0: 2928 2731 3237 2e30 2e30 2e31 2729 0a20  )('127.0.0.1'). 
+00022ce0: 2020 2020 2020 2020 2020 2028 2731 3237             ('127
+00022cf0: 2e30 2e30 2e31 272c 204e 6f6e 6529 0a20  .0.0.1', None). 
+00022d00: 2020 2020 2020 2020 2020 203e 3e3e 2049             >>> I
+00022d10: 535f 4950 5634 2869 735f 6c6f 6361 6c68  S_IPV4(is_localh
+00022d20: 6f73 743d 5472 7565 2928 2731 2e32 2e33  ost=True)('1.2.3
+00022d30: 2e34 2729 0a20 2020 2020 2020 2020 2020  .4').           
+00022d40: 2028 2731 2e32 2e33 2e34 272c 2027 656e   ('1.2.3.4', 'en
+00022d50: 7465 7220 7661 6c69 6420 4950 7634 2061  ter valid IPv4 a
+00022d60: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
+00022d70: 2020 2020 203e 3e3e 2049 535f 4950 5634       >>> IS_IPV4
+00022d80: 2869 735f 6c6f 6361 6c68 6f73 743d 4661  (is_localhost=Fa
+00022d90: 6c73 6529 2827 3132 372e 302e 302e 3127  lse)('127.0.0.1'
+00022da0: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00022db0: 3132 372e 302e 302e 3127 2c20 2765 6e74  127.0.0.1', 'ent
+00022dc0: 6572 2076 616c 6964 2049 5076 3420 6164  er valid IPv4 ad
+00022dd0: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
+00022de0: 2020 2020 3e3e 3e20 4953 5f49 5056 3428      >>> IS_IPV4(
+00022df0: 6d61 7869 703d 2731 3030 2e30 2e30 2e30  maxip='100.0.0.0
+00022e00: 272c 2069 735f 6c6f 6361 6c68 6f73 743d  ', is_localhost=
+00022e10: 5472 7565 2928 2731 3237 2e30 2e30 2e31  True)('127.0.0.1
+00022e20: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00022e30: 2731 3237 2e30 2e30 2e31 272c 2027 656e  '127.0.0.1', 'en
+00022e40: 7465 7220 7661 6c69 6420 4950 7634 2061  ter valid IPv4 a
+00022e50: 6464 7265 7373 2729 0a0a 2020 2020 2222  ddress')..    ""
+00022e60: 220a 0a20 2020 2052 4547 4558 5f49 5056  "..    REGEX_IPV
+00022e70: 3420 3d20 7265 2e63 6f6d 7069 6c65 280a  4 = re.compile(.
+00022e80: 2020 2020 2020 2020 7222 5e28 285b 312d          r"^(([1-
+00022e90: 395d 3f5c 647c 315c 645c 647c 325b 302d  9]?\d|1\d\d|2[0-
+00022ea0: 345d 5c64 7c32 355b 302d 355d 295c 2e29  4]\d|25[0-5])\.)
+00022eb0: 7b33 7d28 5b31 2d39 5d3f 5c64 7c31 5c64  {3}([1-9]?\d|1\d
+00022ec0: 5c64 7c32 5b30 2d34 5d5c 647c 3235 5b30  \d|2[0-4]\d|25[0
+00022ed0: 2d35 5d29 2422 0a20 2020 2029 0a20 2020  -5])$".    ).   
+00022ee0: 206e 756d 6265 7273 203d 2028 3136 3737   numbers = (1677
+00022ef0: 3732 3136 2c20 3635 3533 362c 2032 3536  7216, 65536, 256
+00022f00: 2c20 3129 0a20 2020 206c 6f63 616c 686f  , 1).    localho
+00022f10: 7374 203d 2032 3133 3037 3036 3433 330a  st = 2130706433.
+00022f20: 2020 2020 7072 6976 6174 6520 3d20 2828      private = ((
+00022f30: 3238 3836 3732 3937 3238 2c20 3238 3836  2886729728, 2886
+00022f40: 3739 3532 3633 292c 2028 3332 3332 3233  795263), (323223
+00022f50: 3535 3230 2c20 3332 3332 3330 3130 3535  5520, 3232301055
+00022f60: 2929 0a20 2020 2061 7574 6f6d 6174 6963  )).    automatic
+00022f70: 203d 2028 3238 3531 3939 3536 3438 2c20   = (2851995648, 
+00022f80: 3238 3532 3036 3131 3833 290a 0a20 2020  2852061183)..   
+00022f90: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+00022fa0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00022fb0: 2020 2020 206d 696e 6970 3d22 302e 302e       minip="0.0.
+00022fc0: 302e 3022 2c0a 2020 2020 2020 2020 6d61  0.0",.        ma
+00022fd0: 7869 703d 2232 3535 2e32 3535 2e32 3535  xip="255.255.255
+00022fe0: 2e32 3535 222c 0a20 2020 2020 2020 2069  .255",.        i
+00022ff0: 6e76 6572 743d 4661 6c73 652c 0a20 2020  nvert=False,.   
+00023000: 2020 2020 2069 735f 6c6f 6361 6c68 6f73       is_localhos
+00023010: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00023020: 6973 5f70 7269 7661 7465 3d4e 6f6e 652c  is_private=None,
+00023030: 0a20 2020 2020 2020 2069 735f 6175 746f  .        is_auto
+00023040: 6d61 7469 633d 4e6f 6e65 2c0a 2020 2020  matic=None,.    
+00023050: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00023060: 653d 2245 6e74 6572 2076 616c 6964 2049  e="Enter valid I
+00023070: 5076 3420 6164 6472 6573 7322 2c0a 2020  Pv4 address",.  
+00023080: 2020 293a 0a20 2020 2020 2020 2066 6f72    ):.        for
+00023090: 206e 2c20 7661 6c75 6520 696e 2065 6e75   n, value in enu
+000230a0: 6d65 7261 7465 2828 6d69 6e69 702c 206d  merate((minip, m
+000230b0: 6178 6970 2929 3a0a 2020 2020 2020 2020  axip)):.        
+000230c0: 2020 2020 7465 6d70 203d 205b 5d0a 2020      temp = [].  
+000230d0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000230e0: 6e73 7461 6e63 6528 7661 6c75 652c 2073  nstance(value, s
+000230f0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+00023100: 2020 2020 2074 656d 702e 6170 7065 6e64       temp.append
+00023110: 2876 616c 7565 2e73 706c 6974 2822 2e22  (value.split("."
+00023120: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+00023130: 6c69 6620 6973 696e 7374 616e 6365 2876  lif isinstance(v
+00023140: 616c 7565 2c20 286c 6973 742c 2074 7570  alue, (list, tup
+00023150: 6c65 2929 3a0a 2020 2020 2020 2020 2020  le)):.          
+00023160: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+00023170: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00023180: 656e 2876 616c 7565 290a 2020 2020 2020  en(value).      
+00023190: 2020 2020 2020 2020 2020 2020 2020 3d3d                ==
+000231a0: 206c 656e 285b 6974 656d 2066 6f72 2069   len([item for i
+000231b0: 7465 6d20 696e 2076 616c 7565 2069 6620  tem in value if 
+000231c0: 6973 696e 7374 616e 6365 2869 7465 6d2c  isinstance(item,
+000231d0: 2069 6e74 295d 290a 2020 2020 2020 2020   int)]).        
+000231e0: 2020 2020 2020 2020 2020 2020 3d3d 2034              == 4
+000231f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023200: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00023210: 2020 2020 2020 2020 7465 6d70 2e61 7070          temp.app
+00023220: 656e 6428 7661 6c75 6529 0a20 2020 2020  end(value).     
+00023230: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00023240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023250: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
+00023260: 2076 616c 7565 3a0a 2020 2020 2020 2020   value:.        
 00023270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023280: 2020 2020 2020 2020 2074 656d 702e 6170           temp.ap
-00023290: 7065 6e64 2869 7465 6d2e 7370 6c69 7428  pend(item.split(
-000232a0: 222e 2229 290a 2020 2020 2020 2020 2020  ".")).          
-000232b0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000232c0: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
-000232d0: 656d 2c20 286c 6973 742c 2074 7570 6c65  em, (list, tuple
-000232e0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-000232f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023300: 7465 6d70 2e61 7070 656e 6428 6974 656d  temp.append(item
-00023310: 290a 2020 2020 2020 2020 2020 2020 6e75  ).            nu
-00023320: 6d62 6572 7320 3d20 5b5d 0a20 2020 2020  mbers = [].     
-00023330: 2020 2020 2020 2066 6f72 2069 7465 6d20         for item 
-00023340: 696e 2074 656d 703a 0a20 2020 2020 2020  in temp:.       
-00023350: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-00023360: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
-00023370: 2020 2020 666f 7220 692c 206a 2069 6e20      for i, j in 
-00023380: 7a69 7028 7365 6c66 2e6e 756d 6265 7273  zip(self.numbers
-00023390: 2c20 6974 656d 293a 0a20 2020 2020 2020  , item):.       
-000233a0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-000233b0: 6265 7220 2b3d 2069 202a 2069 6e74 286a  ber += i * int(j
-000233c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000233d0: 2020 6e75 6d62 6572 732e 6170 7065 6e64    numbers.append
-000233e0: 286e 756d 6265 7229 0a20 2020 2020 2020  (number).       
-000233f0: 2020 2020 2069 6620 6e20 3d3d 2030 3a0a       if n == 0:.
-00023400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023410: 7365 6c66 2e6d 696e 6970 203d 206e 756d  self.minip = num
-00023420: 6265 7273 0a20 2020 2020 2020 2020 2020  bers.           
-00023430: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023440: 2020 2020 2020 2073 656c 662e 6d61 7869         self.maxi
-00023450: 7020 3d20 6e75 6d62 6572 730a 2020 2020  p = numbers.    
-00023460: 2020 2020 7365 6c66 2e69 6e76 6572 7420      self.invert 
-00023470: 3d20 696e 7665 7274 0a20 2020 2020 2020  = invert.       
-00023480: 2073 656c 662e 6973 5f6c 6f63 616c 686f   self.is_localho
-00023490: 7374 203d 2069 735f 6c6f 6361 6c68 6f73  st = is_localhos
-000234a0: 740a 2020 2020 2020 2020 7365 6c66 2e69  t.        self.i
-000234b0: 735f 7072 6976 6174 6520 3d20 6973 5f70  s_private = is_p
-000234c0: 7269 7661 7465 0a20 2020 2020 2020 2073  rivate.        s
-000234d0: 656c 662e 6973 5f61 7574 6f6d 6174 6963  elf.is_automatic
-000234e0: 203d 2069 735f 6175 746f 6d61 7469 630a   = is_automatic.
-000234f0: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-00023500: 6f72 5f6d 6573 7361 6765 203d 2065 7272  or_message = err
-00023510: 6f72 5f6d 6573 7361 6765 0a0a 2020 2020  or_message..    
-00023520: 6465 6620 7661 6c69 6461 7465 2873 656c  def validate(sel
-00023530: 662c 2076 616c 7565 2c20 7265 636f 7264  f, value, record
-00023540: 5f69 643d 4e6f 6e65 293a 0a20 2020 2020  _id=None):.     
-00023550: 2020 2069 6620 7265 2e6d 6174 6368 2873     if re.match(s
-00023560: 656c 662e 5245 4745 585f 4950 5634 2c20  elf.REGEX_IPV4, 
-00023570: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-00023580: 2020 2020 6e75 6d62 6572 203d 2030 0a20      number = 0. 
-00023590: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-000235a0: 2c20 6a20 696e 207a 6970 2873 656c 662e  , j in zip(self.
-000235b0: 6e75 6d62 6572 732c 2076 616c 7565 2e73  numbers, value.s
-000235c0: 706c 6974 2822 2e22 2929 3a0a 2020 2020  plit(".")):.    
-000235d0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-000235e0: 6572 202b 3d20 6920 2a20 696e 7428 6a29  er += i * int(j)
-000235f0: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
-00023600: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-00023610: 2020 2020 2066 6f72 2062 6f74 746f 6d2c       for bottom,
-00023620: 2074 6f70 2069 6e20 7a69 7028 7365 6c66   top in zip(self
-00023630: 2e6d 696e 6970 2c20 7365 6c66 2e6d 6178  .minip, self.max
-00023640: 6970 293a 0a20 2020 2020 2020 2020 2020  ip):.           
-00023650: 2020 2020 2069 6620 7365 6c66 2e69 6e76       if self.inv
-00023660: 6572 7420 213d 2028 626f 7474 6f6d 203c  ert != (bottom <
-00023670: 3d20 6e75 6d62 6572 203c 3d20 746f 7029  = number <= top)
-00023680: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023690: 2020 2020 2020 6f6b 203d 2054 7275 650a        ok = True.
-000236a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000236b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000236c0: 2020 6f6b 0a20 2020 2020 2020 2020 2020    ok.           
-000236d0: 2020 2020 2061 6e64 2073 656c 662e 6973       and self.is
-000236e0: 5f6c 6f63 616c 686f 7374 2069 7320 6e6f  _localhost is no
-000236f0: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
-00023700: 2020 2020 2020 2061 6e64 2073 656c 662e         and self.
-00023710: 6973 5f6c 6f63 616c 686f 7374 2021 3d20  is_localhost != 
-00023720: 286e 756d 6265 7220 3d3d 2073 656c 662e  (number == self.
-00023730: 6c6f 6361 6c68 6f73 7429 0a20 2020 2020  localhost).     
-00023740: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00023750: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
-00023760: 616c 7365 0a0a 2020 2020 2020 2020 2020  alse..          
-00023770: 2020 7072 6976 6174 6520 3d20 616e 7928    private = any(
-00023780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023790: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000237a0: 2020 2020 2020 2070 7269 7661 7465 5f6e         private_n
-000237b0: 756d 6265 725b 305d 203c 3d20 6e75 6d62  umber[0] <= numb
-000237c0: 6572 203c 3d20 7072 6976 6174 655f 6e75  er <= private_nu
-000237d0: 6d62 6572 5b31 5d0a 2020 2020 2020 2020  mber[1].        
-000237e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000237f0: 7072 6976 6174 655f 6e75 6d62 6572 2069  private_number i
-00023800: 6e20 7365 6c66 2e70 7269 7661 7465 0a20  n self.private. 
-00023810: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00023820: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00023830: 2020 2020 2020 2020 2020 2069 6620 6f6b             if ok
-00023840: 2061 6e64 2073 656c 662e 6973 5f70 7269   and self.is_pri
-00023850: 7661 7465 2069 7320 6e6f 7420 4e6f 6e65  vate is not None
-00023860: 2061 6e64 2073 656c 662e 6973 5f70 7269   and self.is_pri
-00023870: 7661 7465 2021 3d20 7072 6976 6174 653a  vate != private:
-00023880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023890: 206f 6b20 3d20 4661 6c73 650a 0a20 2020   ok = False..   
-000238a0: 2020 2020 2020 2020 2061 7574 6f6d 6174           automat
-000238b0: 6963 203d 2073 656c 662e 6175 746f 6d61  ic = self.automa
-000238c0: 7469 635b 305d 203c 3d20 6e75 6d62 6572  tic[0] <= number
-000238d0: 203c 3d20 7365 6c66 2e61 7574 6f6d 6174   <= self.automat
-000238e0: 6963 5b31 5d0a 2020 2020 2020 2020 2020  ic[1].          
-000238f0: 2020 6966 206f 6b20 616e 6420 7365 6c66    if ok and self
-00023900: 2e69 735f 6175 746f 6d61 7469 6320 6973  .is_automatic is
-00023910: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-00023920: 6c66 2e69 735f 6175 746f 6d61 7469 6320  lf.is_automatic 
-00023930: 213d 2061 7574 6f6d 6174 6963 3a0a 2020  != automatic:.  
-00023940: 2020 2020 2020 2020 2020 2020 2020 6f6b                ok
-00023950: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
-00023960: 2020 2020 2020 6966 206f 6b3a 0a20 2020        if ok:.   
-00023970: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00023980: 7572 6e20 7661 6c75 650a 0a20 2020 2020  urn value..     
-00023990: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-000239a0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-000239b0: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-000239c0: 726f 725f 6d65 7373 6167 6529 290a 0a0a  ror_message))...
-000239d0: 636c 6173 7320 4953 5f49 5056 3628 5661  class IS_IPV6(Va
-000239e0: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
-000239f0: 220a 2020 2020 4368 6563 6b73 2069 6620  ".    Checks if 
-00023a00: 6669 656c 6427 7320 7661 6c75 6520 6973  field's value is
-00023a10: 2061 6e20 4950 2076 6572 7369 6f6e 2036   an IP version 6
-00023a20: 2061 6464 7265 7373 2e0a 0a20 2020 2055   address...    U
-00023a30: 7365 7320 7468 6520 6970 6164 6472 6573  ses the ipaddres
-00023a40: 7320 6672 6f6d 2074 6865 2050 7974 686f  s from the Pytho
-00023a50: 6e20 3320 7374 616e 6461 7264 206c 6962  n 3 standard lib
-00023a60: 7261 7279 0a20 2020 2061 6e64 2069 7473  rary.    and its
-00023a70: 2050 7974 686f 6e20 3220 6261 636b 706f   Python 2 backpo
-00023a80: 7274 2028 696e 2063 6f6e 7472 6962 2f69  rt (in contrib/i
-00023a90: 7061 6464 7265 7373 2e70 7929 2e0a 0a20  paddress.py)... 
-00023aa0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00023ab0: 2069 735f 7072 6976 6174 653a 204e 6f6e   is_private: Non
-00023ac0: 6520 2864 6566 6175 6c74 293a 2069 6e64  e (default): ind
-00023ad0: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
-00023ae0: 2020 2020 2020 2020 2020 2020 2054 7275               Tru
-00023af0: 6520 2865 6e66 6f72 6365 293a 2061 6464  e (enforce): add
-00023b00: 7265 7373 206d 7573 7420 6265 2069 6e20  ress must be in 
-00023b10: 6663 3030 3a3a 2f37 2072 616e 6765 0a20  fc00::/7 range. 
-00023b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b30: 2020 2046 616c 7365 2028 666f 7262 6964     False (forbid
-00023b40: 293a 2061 6464 7265 7373 206d 7573 7420  ): address must 
-00023b50: 4e4f 5420 6265 2069 6e20 6663 3030 3a3a  NOT be in fc00::
-00023b60: 2f37 2072 616e 6765 0a20 2020 2020 2020  /7 range.       
-00023b70: 2069 735f 6c69 6e6b 5f6c 6f63 616c 3a20   is_link_local: 
-00023b80: 5361 6d65 2061 7320 6162 6f76 6520 6275  Same as above bu
-00023b90: 7420 7573 6573 2066 6538 303a 3a2f 3130  t uses fe80::/10
-00023ba0: 2072 616e 6765 0a20 2020 2020 2020 2069   range.        i
-00023bb0: 735f 7265 7365 7276 6564 3a20 5361 6d65  s_reserved: Same
-00023bc0: 2061 7320 6162 6f76 6520 6275 7420 7573   as above but us
-00023bd0: 6573 2049 4554 4620 7265 7365 7276 6564  es IETF reserved
-00023be0: 2072 616e 6765 0a20 2020 2020 2020 2069   range.        i
-00023bf0: 735f 6d75 6c74 6963 6173 743a 2053 616d  s_multicast: Sam
-00023c00: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
-00023c10: 7365 7320 6666 3030 3a3a 2f38 2072 616e  ses ff00::/8 ran
-00023c20: 6765 0a20 2020 2020 2020 2069 735f 726f  ge.        is_ro
-00023c30: 7574 6561 626c 653a 2053 696d 696c 6172  uteable: Similar
-00023c40: 2074 6f20 6162 6f76 6520 6275 7420 656e   to above but en
-00023c50: 666f 7263 6573 206e 6f74 2070 7269 7661  forces not priva
-00023c60: 7465 2c20 6c69 6e6b 5f6c 6f63 616c 2c0a  te, link_local,.
-00023c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c80: 2020 2020 2020 7265 7365 7276 6564 206f        reserved o
-00023c90: 7220 6d75 6c74 6963 6173 740a 2020 2020  r multicast.    
-00023ca0: 2020 2020 6973 5f36 746f 343a 2053 616d      is_6to4: Sam
-00023cb0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
-00023cc0: 7365 7320 3230 3032 3a3a 2f31 3620 7261  ses 2002::/16 ra
-00023cd0: 6e67 650a 2020 2020 2020 2020 6973 5f74  nge.        is_t
-00023ce0: 6572 6564 6f3a 2053 616d 6520 6173 2061  eredo: Same as a
-00023cf0: 626f 7665 2062 7574 2075 7365 7320 3230  bove but uses 20
-00023d00: 3031 3a3a 2f33 3220 7261 6e67 650a 2020  01::/32 range.  
-00023d10: 2020 2020 2020 7375 626e 6574 733a 2076        subnets: v
-00023d20: 616c 7565 206d 7573 7420 6265 2061 206d  alue must be a m
-00023d30: 656d 6265 7220 6f66 2061 7420 6c65 6173  ember of at leas
-00023d40: 7420 6f6e 6520 6672 6f6d 206c 6973 7420  t one from list 
-00023d50: 6f66 2073 7562 6e65 7473 0a0a 2020 2020  of subnets..    
-00023d60: 4578 616d 706c 6573 3a0a 2020 2020 2020  Examples:.      
-00023d70: 2020 4368 6563 6b20 666f 7220 7661 6c69    Check for vali
-00023d80: 6420 4950 7636 2061 6464 7265 7373 3a0a  d IPv6 address:.
-00023d90: 0a20 2020 2020 2020 2020 2020 2049 4e50  .            INP
-00023da0: 5554 285f 7479 7065 3d27 7465 7874 272c  UT(_type='text',
-00023db0: 205f 6e61 6d65 3d27 6e61 6d65 272c 2072   _name='name', r
-00023dc0: 6571 7569 7265 733d 4953 5f49 5056 3628  equires=IS_IPV6(
-00023dd0: 2929 0a0a 2020 2020 2020 2020 4368 6563  ))..        Chec
-00023de0: 6b20 666f 7220 7661 6c69 6420 4950 7636  k for valid IPv6
-00023df0: 2061 6464 7265 7373 2069 7320 6120 6c69   address is a li
-00023e00: 6e6b 5f6c 6f63 616c 2061 6464 7265 7373  nk_local address
-00023e10: 3a0a 0a20 2020 2020 2020 2020 2020 2049  :..            I
-00023e20: 4e50 5554 285f 7479 7065 3d27 7465 7874  NPUT(_type='text
-00023e30: 272c 205f 6e61 6d65 3d27 6e61 6d65 272c  ', _name='name',
-00023e40: 2072 6571 7569 7265 733d 4953 5f49 5056   requires=IS_IPV
-00023e50: 3628 6973 5f6c 696e 6b5f 6c6f 6361 6c3d  6(is_link_local=
-00023e60: 5472 7565 2929 0a0a 2020 2020 2020 2020  True))..        
-00023e70: 4368 6563 6b20 666f 7220 7661 6c69 6420  Check for valid 
-00023e80: 4950 7636 2061 6464 7265 7373 2074 6861  IPv6 address tha
-00023e90: 7420 6973 2049 6e74 6572 6e65 7420 726f  t is Internet ro
-00023ea0: 7574 6561 626c 653a 0a0a 2020 2020 2020  uteable:..      
-00023eb0: 2020 2020 2020 494e 5055 5428 5f74 7970        INPUT(_typ
-00023ec0: 653d 2774 6578 7427 2c20 5f6e 616d 653d  e='text', _name=
-00023ed0: 276e 616d 6527 2c20 7265 7175 6972 6573  'name', requires
-00023ee0: 3d49 535f 4950 5636 2869 735f 726f 7574  =IS_IPV6(is_rout
-00023ef0: 6561 626c 653d 5472 7565 2929 0a0a 2020  eable=True))..  
-00023f00: 2020 2020 2020 4368 6563 6b20 666f 7220        Check for 
-00023f10: 7661 6c69 6420 4950 7636 2061 6464 7265  valid IPv6 addre
-00023f20: 7373 2069 6e20 7370 6563 6966 6965 6420  ss in specified 
-00023f30: 7375 626e 6574 3a0a 0a20 2020 2020 2020  subnet:..       
-00023f40: 2020 2020 2049 4e50 5554 285f 7479 7065       INPUT(_type
-00023f50: 3d27 7465 7874 272c 205f 6e61 6d65 3d27  ='text', _name='
-00023f60: 6e61 6d65 272c 2072 6571 7569 7265 733d  name', requires=
-00023f70: 4953 5f49 5056 3628 7375 626e 6574 733d  IS_IPV6(subnets=
-00023f80: 5b27 3230 3031 3a3a 2f33 3227 5d29 0a0a  ['2001::/32'])..
-00023f90: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00023fa0: 4953 5f49 5056 3628 2928 2766 6538 303a  IS_IPV6()('fe80:
-00023fb0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-00023fc0: 6233 6166 2729 0a20 2020 2020 2020 2020  b3af').         
-00023fd0: 2020 2028 2766 6538 303a 3a31 3236 633a     ('fe80::126c:
-00023fe0: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
-00023ff0: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
-00024000: 2020 203e 3e3e 2049 535f 4950 5636 2829     >>> IS_IPV6()
-00024010: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
-00024020: 2020 2020 2020 2020 2020 2020 2827 3139              ('19
-00024030: 322e 3136 382e 312e 3127 2c20 2765 6e74  2.168.1.1', 'ent
-00024040: 6572 2076 616c 6964 2049 5076 3620 6164  er valid IPv6 ad
-00024050: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
-00024060: 2020 2020 3e3e 3e20 4953 5f49 5056 3628      >>> IS_IPV6(
-00024070: 6572 726f 725f 6d65 7373 6167 653d 2742  error_message='B
-00024080: 6164 2069 7027 2928 2731 3932 2e31 3638  ad ip')('192.168
-00024090: 2e31 2e31 2729 0a20 2020 2020 2020 2020  .1.1').         
-000240a0: 2020 2028 2731 3932 2e31 3638 2e31 2e31     ('192.168.1.1
-000240b0: 272c 2027 6261 6420 6970 2729 0a20 2020  ', 'bad ip').   
-000240c0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
-000240d0: 4950 5636 2869 735f 6c69 6e6b 5f6c 6f63  IPV6(is_link_loc
-000240e0: 616c 3d54 7275 6529 2827 6665 3830 3a3a  al=True)('fe80::
-000240f0: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00024100: 3361 6627 290a 2020 2020 2020 2020 2020  3af').          
-00024110: 2020 2827 6665 3830 3a3a 3132 3663 3a38    ('fe80::126c:8
-00024120: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
-00024130: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-00024140: 2020 3e3e 3e20 4953 5f49 5056 3628 6973    >>> IS_IPV6(is
-00024150: 5f6c 696e 6b5f 6c6f 6361 6c3d 4661 6c73  _link_local=Fals
-00024160: 6529 2827 6665 3830 3a3a 3132 3663 3a38  e)('fe80::126c:8
-00024170: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
-00024180: 2020 2020 2020 2020 2020 2020 2827 6665              ('fe
-00024190: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
-000241a0: 3232 3a62 3361 6627 2c20 2765 6e74 6572  22:b3af', 'enter
-000241b0: 2076 616c 6964 2049 5076 3620 6164 6472   valid IPv6 addr
-000241c0: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-000241d0: 2020 3e3e 3e20 4953 5f49 5056 3628 6973    >>> IS_IPV6(is
-000241e0: 5f6c 696e 6b5f 6c6f 6361 6c3d 5472 7565  _link_local=True
-000241f0: 2928 2732 3030 313a 3a31 3236 633a 3866  )('2001::126c:8f
-00024200: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
-00024210: 2020 2020 2020 2020 2020 2028 2732 3030             ('200
-00024220: 313a 3a31 3236 633a 3866 6661 3a66 6532  1::126c:8ffa:fe2
-00024230: 323a 6233 6166 272c 2027 656e 7465 7220  2:b3af', 'enter 
-00024240: 7661 6c69 6420 4950 7636 2061 6464 7265  valid IPv6 addre
-00024250: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
-00024260: 203e 3e3e 2049 535f 4950 5636 2869 735f   >>> IS_IPV6(is_
-00024270: 6d75 6c74 6963 6173 743d 5472 7565 2928  multicast=True)(
-00024280: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
-00024290: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-000242a0: 2020 2020 2020 2020 2028 2732 3030 313a           ('2001:
-000242b0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-000242c0: 6233 6166 272c 2027 656e 7465 7220 7661  b3af', 'enter va
-000242d0: 6c69 6420 4950 7636 2061 6464 7265 7373  lid IPv6 address
-000242e0: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
-000242f0: 3e3e 2049 535f 4950 5636 2869 735f 6d75  >> IS_IPV6(is_mu
-00024300: 6c74 6963 6173 743d 5472 7565 2928 2766  lticast=True)('f
-00024310: 6630 303a 3a31 3236 633a 3866 6661 3a66  f00::126c:8ffa:f
-00024320: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
-00024330: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
-00024340: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00024350: 6166 272c 204e 6f6e 6529 0a20 2020 2020  af', None).     
-00024360: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00024370: 5636 2869 735f 726f 7574 6561 626c 653d  V6(is_routeable=
-00024380: 5472 7565 2928 2732 3030 313a 3a31 3236  True)('2001::126
-00024390: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
-000243a0: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
-000243b0: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
-000243c0: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-000243d0: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-000243e0: 3e3e 2049 535f 4950 5636 2869 735f 726f  >> IS_IPV6(is_ro
-000243f0: 7574 6561 626c 653d 5472 7565 2928 2766  uteable=True)('f
-00024400: 6630 303a 3a31 3236 633a 3866 6661 3a66  f00::126c:8ffa:f
-00024410: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
-00024420: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
-00024430: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00024440: 6166 272c 2027 656e 7465 7220 7661 6c69  af', 'enter vali
-00024450: 6420 4950 7636 2061 6464 7265 7373 2729  d IPv6 address')
-00024460: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00024470: 2049 535f 4950 5636 2873 7562 6e65 7473   IS_IPV6(subnets
-00024480: 3d27 3230 3031 3a3a 2f33 3227 2928 2732  ='2001::/32')('2
-00024490: 3030 313a 3a38 6666 613a 6665 3232 3a62  001::8ffa:fe22:b
-000244a0: 3361 6627 290a 2020 2020 2020 2020 2020  3af').          
-000244b0: 2020 2827 3230 3031 3a3a 3866 6661 3a66    ('2001::8ffa:f
-000244c0: 6532 323a 6233 6166 272c 204e 6f6e 6529  e22:b3af', None)
-000244d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000244e0: 2049 535f 4950 5636 2873 7562 6e65 7473   IS_IPV6(subnets
-000244f0: 3d27 6662 3030 3a3a 2f38 2729 2827 3230  ='fb00::/8')('20
-00024500: 3031 3a3a 3866 6661 3a66 6532 323a 6233  01::8ffa:fe22:b3
-00024510: 6166 2729 0a20 2020 2020 2020 2020 2020  af').           
-00024520: 2028 2732 3030 313a 3a38 6666 613a 6665   ('2001::8ffa:fe
-00024530: 3232 3a62 3361 6627 2c20 2765 6e74 6572  22:b3af', 'enter
-00024540: 2076 616c 6964 2049 5076 3620 6164 6472   valid IPv6 addr
-00024550: 6573 7327 290a 2020 2020 2020 2020 2020  ess').          
-00024560: 2020 3e3e 3e20 4953 5f49 5056 3628 7375    >>> IS_IPV6(su
-00024570: 626e 6574 733d 5b27 6663 3030 3a3a 2f38  bnets=['fc00::/8
-00024580: 272c 2732 3030 313a 3a2f 3332 275d 2928  ','2001::/32'])(
-00024590: 2732 3030 313a 3a38 6666 613a 6665 3232  '2001::8ffa:fe22
-000245a0: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
-000245b0: 2020 2020 2827 3230 3031 3a3a 3866 6661      ('2001::8ffa
-000245c0: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-000245d0: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
-000245e0: 3e3e 2049 535f 4950 5636 2873 7562 6e65  >> IS_IPV6(subne
-000245f0: 7473 3d27 696e 7661 6c69 6473 7562 6e65  ts='invalidsubne
-00024600: 7427 2928 2732 3030 313a 3a38 6666 613a  t')('2001::8ffa:
-00024610: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
-00024620: 2020 2020 2020 2020 2827 3230 3031 3a3a          ('2001::
-00024630: 3866 6661 3a66 6532 323a 6233 6166 272c  8ffa:fe22:b3af',
-00024640: 2027 696e 7661 6c69 6420 7375 626e 6574   'invalid subnet
-00024650: 2070 726f 7669 6465 6427 290a 0a20 2020   provided')..   
-00024660: 2022 2222 0a0a 2020 2020 6465 6620 5f5f   """..    def __
-00024670: 696e 6974 5f5f 280a 2020 2020 2020 2020  init__(.        
-00024680: 7365 6c66 2c0a 2020 2020 2020 2020 6973  self,.        is
-00024690: 5f70 7269 7661 7465 3d4e 6f6e 652c 0a20  _private=None,. 
-000246a0: 2020 2020 2020 2069 735f 6c69 6e6b 5f6c         is_link_l
-000246b0: 6f63 616c 3d4e 6f6e 652c 0a20 2020 2020  ocal=None,.     
-000246c0: 2020 2069 735f 7265 7365 7276 6564 3d4e     is_reserved=N
-000246d0: 6f6e 652c 0a20 2020 2020 2020 2069 735f  one,.        is_
-000246e0: 6d75 6c74 6963 6173 743d 4e6f 6e65 2c0a  multicast=None,.
-000246f0: 2020 2020 2020 2020 6973 5f72 6f75 7465          is_route
-00024700: 6162 6c65 3d4e 6f6e 652c 0a20 2020 2020  able=None,.     
-00024710: 2020 2069 735f 3674 6f34 3d4e 6f6e 652c     is_6to4=None,
-00024720: 0a20 2020 2020 2020 2069 735f 7465 7265  .        is_tere
-00024730: 646f 3d4e 6f6e 652c 0a20 2020 2020 2020  do=None,.       
-00024740: 2073 7562 6e65 7473 3d4e 6f6e 652c 0a20   subnets=None,. 
-00024750: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00024760: 7361 6765 3d22 456e 7465 7220 7661 6c69  sage="Enter vali
-00024770: 6420 4950 7636 2061 6464 7265 7373 222c  d IPv6 address",
-00024780: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00024790: 7365 6c66 2e69 735f 7072 6976 6174 6520  self.is_private 
-000247a0: 3d20 6973 5f70 7269 7661 7465 0a20 2020  = is_private.   
-000247b0: 2020 2020 2073 656c 662e 6973 5f6c 696e       self.is_lin
-000247c0: 6b5f 6c6f 6361 6c20 3d20 6973 5f6c 696e  k_local = is_lin
-000247d0: 6b5f 6c6f 6361 6c0a 2020 2020 2020 2020  k_local.        
-000247e0: 7365 6c66 2e69 735f 7265 7365 7276 6564  self.is_reserved
-000247f0: 203d 2069 735f 7265 7365 7276 6564 0a20   = is_reserved. 
-00024800: 2020 2020 2020 2073 656c 662e 6973 5f6d         self.is_m
-00024810: 756c 7469 6361 7374 203d 2069 735f 6d75  ulticast = is_mu
-00024820: 6c74 6963 6173 740a 2020 2020 2020 2020  lticast.        
-00024830: 7365 6c66 2e69 735f 726f 7574 6561 626c  self.is_routeabl
-00024840: 6520 3d20 6973 5f72 6f75 7465 6162 6c65  e = is_routeable
-00024850: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
-00024860: 5f36 746f 3420 3d20 6973 5f36 746f 340a  _6to4 = is_6to4.
-00024870: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-00024880: 7465 7265 646f 203d 2069 735f 7465 7265  teredo = is_tere
-00024890: 646f 0a20 2020 2020 2020 2073 656c 662e  do.        self.
-000248a0: 7375 626e 6574 7320 3d20 7375 626e 6574  subnets = subnet
-000248b0: 730a 2020 2020 2020 2020 7365 6c66 2e65  s.        self.e
-000248c0: 7272 6f72 5f6d 6573 7361 6765 203d 2065  rror_message = e
-000248d0: 7272 6f72 5f6d 6573 7361 6765 0a0a 2020  rror_message..  
-000248e0: 2020 6465 6620 7661 6c69 6461 7465 2873    def validate(s
-000248f0: 656c 662c 2076 616c 7565 2c20 7265 636f  elf, value, reco
-00024900: 7264 5f69 643d 4e6f 6e65 293a 0a20 2020  rd_id=None):.   
-00024910: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00024920: 2020 2020 2020 6970 203d 2069 7061 6464        ip = ipadd
-00024930: 7265 7373 2e49 5076 3641 6464 7265 7373  ress.IPv6Address
-00024940: 2874 6f5f 756e 6963 6f64 6528 7661 6c75  (to_unicode(valu
-00024950: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00024960: 6f6b 203d 2054 7275 650a 2020 2020 2020  ok = True.      
-00024970: 2020 6578 6365 7074 2069 7061 6464 7265    except ipaddre
-00024980: 7373 2e41 6464 7265 7373 5661 6c75 6545  ss.AddressValueE
-00024990: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-000249a0: 2020 7261 6973 6520 5661 6c69 6461 7469    raise Validati
-000249b0: 6f6e 4572 726f 7228 7365 6c66 2e74 7261  onError(self.tra
-000249c0: 6e73 6c61 746f 7228 7365 6c66 2e65 7272  nslator(self.err
-000249d0: 6f72 5f6d 6573 7361 6765 2929 0a0a 2020  or_message))..  
-000249e0: 2020 2020 2020 6966 2073 656c 662e 7375        if self.su
-000249f0: 626e 6574 733a 0a20 2020 2020 2020 2020  bnets:.         
-00024a00: 2020 2023 2069 7465 7261 7465 2074 6872     # iterate thr
-00024a10: 6f75 6768 2073 656c 662e 7375 626e 6574  ough self.subnet
-00024a20: 7320 746f 2073 6565 2069 6620 7661 6c75  s to see if valu
-00024a30: 6520 6973 2061 206d 656d 6265 720a 2020  e is a member.  
-00024a40: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
-00024a50: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00024a60: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00024a70: 656c 662e 7375 626e 6574 732c 2073 7472  elf.subnets, str
-00024a80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00024a90: 2020 2073 656c 662e 7375 626e 6574 7320     self.subnets 
-00024aa0: 3d20 5b73 656c 662e 7375 626e 6574 735d  = [self.subnets]
-00024ab0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00024ac0: 206e 6574 776f 726b 2069 6e20 7365 6c66   network in self
-00024ad0: 2e73 7562 6e65 7473 3a0a 2020 2020 2020  .subnets:.      
-00024ae0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-00024af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b00: 2020 2069 706e 6574 203d 2069 7061 6464     ipnet = ipadd
-00024b10: 7265 7373 2e49 5076 364e 6574 776f 726b  ress.IPv6Network
-00024b20: 2874 6f5f 756e 6963 6f64 6528 6e65 7477  (to_unicode(netw
-00024b30: 6f72 6b29 290a 2020 2020 2020 2020 2020  ork)).          
-00024b40: 2020 2020 2020 6578 6365 7074 2028 6970        except (ip
-00024b50: 6164 6472 6573 732e 4e65 746d 6173 6b56  address.NetmaskV
-00024b60: 616c 7565 4572 726f 722c 2069 7061 6464  alueError, ipadd
-00024b70: 7265 7373 2e41 6464 7265 7373 5661 6c75  ress.AddressValu
-00024b80: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
-00024b90: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00024ba0: 7365 2056 616c 6964 6174 696f 6e45 7272  se ValidationErr
-00024bb0: 6f72 2873 656c 662e 7472 616e 736c 6174  or(self.translat
-00024bc0: 6f72 2822 696e 7661 6c69 6420 7375 626e  or("invalid subn
-00024bd0: 6574 2070 726f 7669 6465 6422 2929 0a20  et provided")). 
-00024be0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00024bf0: 6620 6970 2069 6e20 6970 6e65 743a 0a20  f ip in ipnet:. 
-00024c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c10: 2020 206f 6b20 3d20 5472 7565 0a0a 2020     ok = True..  
-00024c20: 2020 2020 2020 6966 2073 656c 662e 6973        if self.is
-00024c30: 5f72 6f75 7465 6162 6c65 3a0a 2020 2020  _routeable:.    
-00024c40: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-00024c50: 7072 6976 6174 6520 3d20 4661 6c73 650a  private = False.
-00024c60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024c70: 2e69 735f 7265 7365 7276 6564 203d 2046  .is_reserved = F
-00024c80: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00024c90: 2073 656c 662e 6973 5f6d 756c 7469 6361   self.is_multica
-00024ca0: 7374 203d 2046 616c 7365 0a0a 2020 2020  st = False..    
-00024cb0: 2020 2020 6966 206f 6b20 616e 6420 7365      if ok and se
-00024cc0: 6c66 2e69 735f 7072 6976 6174 6520 6973  lf.is_private is
-00024cd0: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-00024ce0: 6c66 2e69 735f 7072 6976 6174 6520 213d  lf.is_private !=
-00024cf0: 2069 702e 6973 5f70 7269 7661 7465 3a0a   ip.is_private:.
-00024d00: 2020 2020 2020 2020 2020 2020 6f6b 203d              ok =
-00024d10: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-00024d20: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00024d30: 6f6b 0a20 2020 2020 2020 2020 2020 2061  ok.            a
-00024d40: 6e64 2073 656c 662e 6973 5f6c 696e 6b5f  nd self.is_link_
-00024d50: 6c6f 6361 6c20 6973 206e 6f74 204e 6f6e  local is not Non
-00024d60: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00024d70: 6420 7365 6c66 2e69 735f 6c69 6e6b 5f6c  d self.is_link_l
-00024d80: 6f63 616c 2021 3d20 6970 2e69 735f 6c69  ocal != ip.is_li
-00024d90: 6e6b 5f6c 6f63 616c 0a20 2020 2020 2020  nk_local.       
-00024da0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00024db0: 6f6b 203d 2046 616c 7365 0a20 2020 2020  ok = False.     
-00024dc0: 2020 2069 6620 6f6b 2061 6e64 2073 656c     if ok and sel
-00024dd0: 662e 6973 5f72 6573 6572 7665 6420 6973  f.is_reserved is
-00024de0: 206e 6f74 204e 6f6e 6520 616e 6420 7365   not None and se
-00024df0: 6c66 2e69 735f 7265 7365 7276 6564 2021  lf.is_reserved !
-00024e00: 3d20 6970 2e69 735f 7265 7365 7276 6564  = ip.is_reserved
-00024e10: 3a0a 2020 2020 2020 2020 2020 2020 6f6b  :.            ok
-00024e20: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-00024e30: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-00024e40: 2020 6f6b 0a20 2020 2020 2020 2020 2020    ok.           
-00024e50: 2061 6e64 2073 656c 662e 6973 5f6d 756c   and self.is_mul
-00024e60: 7469 6361 7374 2069 7320 6e6f 7420 4e6f  ticast is not No
-00024e70: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-00024e80: 6e64 2073 656c 662e 6973 5f6d 756c 7469  nd self.is_multi
-00024e90: 6361 7374 2021 3d20 6970 2e69 735f 6d75  cast != ip.is_mu
-00024ea0: 6c74 6963 6173 740a 2020 2020 2020 2020  lticast.        
-00024eb0: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-00024ec0: 6b20 3d20 4661 6c73 650a 2020 2020 2020  k = False.      
-00024ed0: 2020 6966 206f 6b20 616e 6420 7365 6c66    if ok and self
-00024ee0: 2e69 735f 3674 6f34 2069 7320 6e6f 7420  .is_6to4 is not 
-00024ef0: 4e6f 6e65 2061 6e64 2073 656c 662e 6973  None and self.is
-00024f00: 5f36 746f 3420 213d 2062 6f6f 6c28 6970  _6to4 != bool(ip
-00024f10: 2e73 6978 746f 666f 7572 293a 0a20 2020  .sixtofour):.   
-00024f20: 2020 2020 2020 2020 206f 6b20 3d20 4661           ok = Fa
-00024f30: 6c73 650a 2020 2020 2020 2020 6966 206f  lse.        if o
-00024f40: 6b20 616e 6420 7365 6c66 2e69 735f 7465  k and self.is_te
-00024f50: 7265 646f 2069 7320 6e6f 7420 4e6f 6e65  redo is not None
-00024f60: 2061 6e64 2073 656c 662e 6973 5f74 6572   and self.is_ter
-00024f70: 6564 6f20 213d 2062 6f6f 6c28 6970 2e74  edo != bool(ip.t
-00024f80: 6572 6564 6f29 3a0a 2020 2020 2020 2020  eredo):.        
-00024f90: 2020 2020 6f6b 203d 2046 616c 7365 0a0a      ok = False..
-00024fa0: 2020 2020 2020 2020 6966 206f 6b3a 0a20          if ok:. 
-00024fb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00024fc0: 6e20 7661 6c75 650a 0a20 2020 2020 2020  n value..       
-00024fd0: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
-00024fe0: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
-00024ff0: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
-00025000: 725f 6d65 7373 6167 6529 290a 0a0a 636c  r_message))...cl
-00025010: 6173 7320 4953 5f49 5041 4444 5245 5353  ass IS_IPADDRESS
-00025020: 2856 616c 6964 6174 6f72 293a 0a20 2020  (Validator):.   
-00025030: 2022 2222 0a20 2020 2043 6865 636b 7320   """.    Checks 
-00025040: 6966 2066 6965 6c64 2773 2076 616c 7565  if field's value
-00025050: 2069 7320 616e 2049 5020 4164 6472 6573   is an IP Addres
-00025060: 7320 2876 3420 6f72 2076 3629 2e20 4361  s (v4 or v6). Ca
-00025070: 6e20 6265 2073 6574 2074 6f20 666f 7263  n be set to forc
-00025080: 650a 2020 2020 6164 6472 6573 7365 7320  e.    addresses 
-00025090: 6672 6f6d 2077 6974 6869 6e20 6120 7370  from within a sp
-000250a0: 6563 6966 6963 2072 616e 6765 2e20 4368  ecific range. Ch
-000250b0: 6563 6b73 2061 7265 2064 6f6e 6520 7769  ecks are done wi
-000250c0: 7468 2074 6865 2063 6f72 7265 6374 0a20  th the correct. 
-000250d0: 2020 2049 535f 4950 5634 2061 6e64 2049     IS_IPV4 and I
-000250e0: 535f 4950 5636 2076 616c 6964 6174 6f72  S_IPV6 validator
-000250f0: 732e 0a0a 2020 2020 5573 6573 2074 6865  s...    Uses the
-00025100: 2069 7061 6464 7265 7373 2066 726f 6d20   ipaddress from 
-00025110: 7468 6520 5079 7468 6f6e 2033 2073 7461  the Python 3 sta
-00025120: 6e64 6172 6420 6c69 6272 6172 790a 2020  ndard library.  
-00025130: 2020 616e 6420 6974 7320 5079 7468 6f6e    and its Python
-00025140: 2032 2062 6163 6b70 6f72 7420 2869 6e20   2 backport (in 
-00025150: 636f 6e74 7269 622f 6970 6164 6472 6573  contrib/ipaddres
-00025160: 732e 7079 292e 0a0a 2020 2020 4172 6773  s.py)...    Args
-00025170: 3a0a 2020 2020 2020 2020 6d69 6e69 703a  :.        minip:
-00025180: 206c 6f77 6573 7420 616c 6c6f 7765 6420   lowest allowed 
-00025190: 6164 6472 6573 733b 2061 6363 6570 7473  address; accepts
-000251a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000251b0: 2073 7472 2c20 6567 2e20 3139 322e 3136   str, eg. 192.16
-000251c0: 382e 302e 310a 2020 2020 2020 2020 2020  8.0.1.          
-000251d0: 2020 2020 206c 6973 7420 6f72 2074 7570       list or tup
-000251e0: 6c65 206f 6620 6f63 7465 7473 2c20 6567  le of octets, eg
-000251f0: 2e20 5b31 3932 2c20 3136 382c 2030 2c20  . [192, 168, 0, 
-00025200: 315d 0a20 2020 2020 2020 206d 6178 6970  1].        maxip
-00025210: 3a20 6869 6768 6573 7420 616c 6c6f 7765  : highest allowe
-00025220: 6420 6164 6472 6573 733b 2073 616d 6520  d address; same 
-00025230: 6173 2061 626f 7665 0a20 2020 2020 2020  as above.       
-00025240: 2069 6e76 6572 743a 2054 7275 6520 746f   invert: True to
-00025250: 2061 6c6c 6f77 2061 6464 7265 7373 6573   allow addresses
-00025260: 206f 6e6c 7920 6672 6f6d 206f 7574 7369   only from outsi
-00025270: 6465 206f 6620 6769 7665 6e20 7261 6e67  de of given rang
-00025280: 653b 206e 6f74 650a 2020 2020 2020 2020  e; note.        
-00025290: 2020 2020 2020 2020 7468 6174 2072 616e          that ran
-000252a0: 6765 2062 6f75 6e64 6172 6965 7320 6172  ge boundaries ar
-000252b0: 6520 6e6f 7420 6d61 7463 6865 6420 7468  e not matched th
-000252c0: 6973 2077 6179 0a0a 2020 2020 4950 7634  is way..    IPv4
-000252d0: 2073 7065 6369 6669 6320 6172 6775 6d65   specific argume
-000252e0: 6e74 733a 0a0a 2020 2020 2020 2020 2d20  nts:..        - 
-000252f0: 6973 5f6c 6f63 616c 686f 7374 3a20 6c6f  is_localhost: lo
-00025300: 6361 6c68 6f73 7420 6164 6472 6573 7320  calhost address 
-00025310: 7472 6561 746d 656e 743a 0a0a 2020 2020  treatment:..    
-00025320: 2020 2020 2020 2020 2d20 4e6f 6e65 2028          - None (
-00025330: 6465 6661 756c 7429 3a20 696e 6469 6666  default): indiff
-00025340: 6572 656e 740a 2020 2020 2020 2020 2020  erent.          
-00025350: 2020 2d20 5472 7565 2028 656e 666f 7263    - True (enforc
-00025360: 6529 3a20 7175 6572 7920 6164 6472 6573  e): query addres
-00025370: 7320 6d75 7374 206d 6174 6368 206c 6f63  s must match loc
-00025380: 616c 686f 7374 2061 6464 7265 7373 0a20  alhost address. 
-00025390: 2020 2020 2020 2020 2020 2020 2028 3132               (12
-000253a0: 372e 302e 302e 3129 0a20 2020 2020 2020  7.0.0.1).       
-000253b0: 2020 2020 202d 2046 616c 7365 2028 666f       - False (fo
-000253c0: 7262 6964 293a 2071 7565 7279 2061 6464  rbid): query add
-000253d0: 7265 7373 206d 7573 7420 6e6f 7420 6d61  ress must not ma
-000253e0: 7463 6820 6c6f 6361 6c68 6f73 7420 6164  tch localhost ad
-000253f0: 6472 6573 730a 2020 2020 2020 2020 2d20  dress.        - 
-00025400: 6973 5f70 7269 7661 7465 3a20 7361 6d65  is_private: same
-00025410: 2061 7320 6162 6f76 652c 2065 7863 6570   as above, excep
-00025420: 7420 7468 6174 2071 7565 7279 2061 6464  t that query add
-00025430: 7265 7373 2069 7320 6368 6563 6b65 6420  ress is checked 
-00025440: 6167 6169 6e73 740a 2020 2020 2020 2020  against.        
-00025450: 2020 7477 6f20 6164 6472 6573 7320 7261    two address ra
-00025460: 6e67 6573 3a20 3137 322e 3136 2e30 2e30  nges: 172.16.0.0
-00025470: 202d 2031 3732 2e33 312e 3235 352e 3235   - 172.31.255.25
-00025480: 3520 616e 640a 2020 2020 2020 2020 2020  5 and.          
-00025490: 3139 322e 3136 382e 302e 3020 2d20 3139  192.168.0.0 - 19
-000254a0: 322e 3136 382e 3235 352e 3235 350a 2020  2.168.255.255.  
-000254b0: 2020 2020 2020 2d20 6973 5f61 7574 6f6d        - is_autom
-000254c0: 6174 6963 3a20 7361 6d65 2061 7320 6162  atic: same as ab
-000254d0: 6f76 652c 2065 7863 6570 7420 7468 6174  ove, except that
-000254e0: 2071 7565 7279 2061 6464 7265 7373 2069   query address i
-000254f0: 7320 6368 6563 6b65 6420 6167 6169 6e73  s checked agains
-00025500: 740a 2020 2020 2020 2020 2020 6f6e 6520  t.          one 
-00025510: 6164 6472 6573 7320 7261 6e67 653a 2031  address range: 1
-00025520: 3639 2e32 3534 2e30 2e30 202d 2031 3639  69.254.0.0 - 169
-00025530: 2e32 3534 2e32 3535 2e32 3535 0a20 2020  .254.255.255.   
-00025540: 2020 2020 202d 2069 735f 6970 7634 3a20       - is_ipv4: 
-00025550: 6569 7468 6572 3a0a 0a20 2020 2020 2020  either:..       
-00025560: 2020 2020 202d 204e 6f6e 6520 2864 6566       - None (def
-00025570: 6175 6c74 293a 2069 6e64 6966 6665 7265  ault): indiffere
-00025580: 6e74 0a20 2020 2020 2020 2020 2020 202d  nt.            -
-00025590: 2054 7275 6520 2865 6e66 6f72 6365 293a   True (enforce):
-000255a0: 206d 7573 7420 6265 2061 6e20 4950 7634   must be an IPv4
-000255b0: 2061 6464 7265 7373 0a20 2020 2020 2020   address.       
-000255c0: 2020 2020 202d 2046 616c 7365 2028 666f       - False (fo
-000255d0: 7262 6964 293a 206d 7573 7420 4e4f 5420  rbid): must NOT 
-000255e0: 6265 2061 6e20 4950 7634 2061 6464 7265  be an IPv4 addre
-000255f0: 7373 0a0a 2020 2020 4950 7636 2073 7065  ss..    IPv6 spe
-00025600: 6369 6669 6320 6172 6775 6d65 6e74 733a  cific arguments:
-00025610: 0a0a 2020 2020 2020 2020 2d20 6973 5f6c  ..        - is_l
-00025620: 696e 6b5f 6c6f 6361 6c3a 2053 616d 6520  ink_local: Same 
-00025630: 6173 2061 626f 7665 2062 7574 2075 7365  as above but use
-00025640: 7320 6665 3830 3a3a 2f31 3020 7261 6e67  s fe80::/10 rang
-00025650: 650a 2020 2020 2020 2020 2d20 6973 5f72  e.        - is_r
-00025660: 6573 6572 7665 643a 2053 616d 6520 6173  eserved: Same as
-00025670: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
-00025680: 4945 5446 2072 6573 6572 7665 6420 7261  IETF reserved ra
-00025690: 6e67 650a 2020 2020 2020 2020 2d20 6973  nge.        - is
-000256a0: 5f6d 756c 7469 6361 7374 3a20 5361 6d65  _multicast: Same
-000256b0: 2061 7320 6162 6f76 6520 6275 7420 7573   as above but us
-000256c0: 6573 2066 6630 303a 3a2f 3820 7261 6e67  es ff00::/8 rang
-000256d0: 650a 2020 2020 2020 2020 2d20 6973 5f72  e.        - is_r
-000256e0: 6f75 7465 6162 6c65 3a20 5369 6d69 6c61  outeable: Simila
-000256f0: 7220 746f 2061 626f 7665 2062 7574 2065  r to above but e
-00025700: 6e66 6f72 6365 7320 6e6f 7420 7072 6976  nforces not priv
-00025710: 6174 652c 206c 696e 6b5f 6c6f 6361 6c2c  ate, link_local,
-00025720: 0a20 2020 2020 2020 2020 2072 6573 6572  .          reser
-00025730: 7665 6420 6f72 206d 756c 7469 6361 7374  ved or multicast
-00025740: 0a20 2020 2020 2020 202d 2069 735f 3674  .        - is_6t
-00025750: 6f34 3a20 5361 6d65 2061 7320 6162 6f76  o4: Same as abov
-00025760: 6520 6275 7420 7573 6573 2032 3030 323a  e but uses 2002:
-00025770: 3a2f 3136 2072 616e 6765 0a20 2020 2020  :/16 range.     
-00025780: 2020 202d 2069 735f 7465 7265 646f 3a20     - is_teredo: 
-00025790: 5361 6d65 2061 7320 6162 6f76 6520 6275  Same as above bu
-000257a0: 7420 7573 6573 2032 3030 313a 3a2f 3332  t uses 2001::/32
-000257b0: 2072 616e 6765 0a20 2020 2020 2020 202d   range.        -
-000257c0: 2073 7562 6e65 7473 3a20 7661 6c75 6520   subnets: value 
-000257d0: 6d75 7374 2062 6520 6120 6d65 6d62 6572  must be a member
-000257e0: 206f 6620 6174 206c 6561 7374 206f 6e65   of at least one
-000257f0: 2066 726f 6d20 6c69 7374 206f 6620 7375   from list of su
-00025800: 626e 6574 730a 2020 2020 2020 2020 2d20  bnets.        - 
-00025810: 6973 5f69 7076 363a 2065 6974 6865 723a  is_ipv6: either:
-00025820: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00025830: 4e6f 6e65 2028 6465 6661 756c 7429 3a20  None (default): 
-00025840: 696e 6469 6666 6572 656e 740a 2020 2020  indifferent.    
-00025850: 2020 2020 2020 2020 2d20 5472 7565 2028          - True (
-00025860: 656e 666f 7263 6529 3a20 6d75 7374 2062  enforce): must b
-00025870: 6520 616e 2049 5076 3620 6164 6472 6573  e an IPv6 addres
-00025880: 730a 2020 2020 2020 2020 2020 2020 2d20  s.            - 
-00025890: 4661 6c73 6520 2866 6f72 6269 6429 3a20  False (forbid): 
-000258a0: 6d75 7374 204e 4f54 2062 6520 616e 2049  must NOT be an I
-000258b0: 5076 3620 6164 6472 6573 730a 0a20 2020  Pv6 address..   
-000258c0: 204d 696e 6970 2061 6e64 206d 6178 6970   Minip and maxip
-000258d0: 206d 6179 2061 6c73 6f20 6265 206c 6973   may also be lis
-000258e0: 7473 206f 7220 7475 706c 6573 206f 6620  ts or tuples of 
-000258f0: 6164 6472 6573 7365 7320 696e 2061 6c6c  addresses in all
-00025900: 2061 626f 7665 0a20 2020 2066 6f72 6d73   above.    forms
-00025910: 2028 7374 722c 2069 6e74 2c20 6c69 7374   (str, int, list
-00025920: 202f 2074 7570 6c65 292c 2061 6c6c 6f77   / tuple), allow
-00025930: 696e 6720 7365 7475 7020 6f66 206d 756c  ing setup of mul
-00025940: 7469 706c 6520 6164 6472 6573 7320 7261  tiple address ra
-00025950: 6e67 6573 3a3a 0a0a 2020 2020 2020 2020  nges::..        
-00025960: 6d69 6e69 7020 3d20 286d 696e 6970 312c  minip = (minip1,
-00025970: 206d 696e 6970 322c 202e 2e2e 206d 696e   minip2, ... min
-00025980: 6970 4e29 0a20 2020 2020 2020 2020 2020  ipN).           
-00025990: 2020 2020 2020 2020 7c20 2020 2020 2020          |       
-000259a0: 7c20 2020 2020 2020 2020 2020 7c0a 2020  |           |.  
-000259b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259c0: 207c 2020 2020 2020 207c 2020 2020 2020   |       |      
-000259d0: 2020 2020 207c 0a20 2020 2020 2020 206d       |.        m
-000259e0: 6178 6970 203d 2028 6d61 7869 7031 2c20  axip = (maxip1, 
-000259f0: 6d61 7869 7032 2c20 2e2e 2e20 6d61 7869  maxip2, ... maxi
-00025a00: 704e 290a 0a20 2020 204c 6f6e 6765 7220  pN)..    Longer 
-00025a10: 6974 6572 6162 6c65 2077 696c 6c20 6265  iterable will be
-00025a20: 2074 7275 6e63 6174 6564 2074 6f20 6d61   truncated to ma
-00025a30: 7463 6820 6c65 6e67 7468 206f 6620 7368  tch length of sh
-00025a40: 6f72 7465 7220 6f6e 652e 0a0a 2020 2020  orter one...    
-00025a50: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-00025a60: 5245 5353 2829 2827 3139 322e 3136 382e  RESS()('192.168.
-00025a70: 312e 3527 290a 2020 2020 2020 2020 2827  1.5').        ('
-00025a80: 3139 322e 3136 382e 312e 3527 2c20 4e6f  192.168.1.5', No
-00025a90: 6e65 290a 2020 2020 2020 2020 3e3e 3e20  ne).        >>> 
-00025aa0: 4953 5f49 5041 4444 5245 5353 2869 735f  IS_IPADDRESS(is_
-00025ab0: 6970 7636 3d46 616c 7365 2928 2731 3932  ipv6=False)('192
-00025ac0: 2e31 3638 2e31 2e35 2729 0a20 2020 2020  .168.1.5').     
-00025ad0: 2020 2028 2731 3932 2e31 3638 2e31 2e35     ('192.168.1.5
-00025ae0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00025af0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00025b00: 5328 2928 2732 3535 2e32 3535 2e32 3535  S()('255.255.255
-00025b10: 2e32 3535 2729 0a20 2020 2020 2020 2028  .255').        (
-00025b20: 2732 3535 2e32 3535 2e32 3535 2e32 3535  '255.255.255.255
-00025b30: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-00025b40: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00025b50: 5328 2928 2731 3932 2e31 3638 2e31 2e35  S()('192.168.1.5
-00025b60: 2027 290a 2020 2020 2020 2020 2827 3139   ').        ('19
-00025b70: 322e 3136 382e 312e 3520 272c 2027 656e  2.168.1.5 ', 'en
-00025b80: 7465 7220 7661 6c69 6420 4950 2061 6464  ter valid IP add
-00025b90: 7265 7373 2729 0a20 2020 2020 2020 203e  ress').        >
-00025ba0: 3e3e 2049 535f 4950 4144 4452 4553 5328  >> IS_IPADDRESS(
-00025bb0: 2928 2731 3932 2e31 3638 2e31 2e31 2e35  )('192.168.1.1.5
-00025bc0: 2729 0a20 2020 2020 2020 2028 2731 3932  ').        ('192
-00025bd0: 2e31 3638 2e31 2e31 2e35 272c 2027 656e  .168.1.1.5', 'en
-00025be0: 7465 7220 7661 6c69 6420 4950 2061 6464  ter valid IP add
-00025bf0: 7265 7373 2729 0a20 2020 2020 2020 203e  ress').        >
-00025c00: 3e3e 2049 535f 4950 4144 4452 4553 5328  >> IS_IPADDRESS(
-00025c10: 2928 2731 3233 2e31 3233 2729 0a20 2020  )('123.123').   
-00025c20: 2020 2020 2028 2731 3233 2e31 3233 272c       ('123.123',
-00025c30: 2027 656e 7465 7220 7661 6c69 6420 4950   'enter valid IP
-00025c40: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
-00025c50: 2020 203e 3e3e 2049 535f 4950 4144 4452     >>> IS_IPADDR
-00025c60: 4553 5328 2928 2731 3131 312e 322e 332e  ESS()('1111.2.3.
-00025c70: 3427 290a 2020 2020 2020 2020 2827 3131  4').        ('11
-00025c80: 3131 2e32 2e33 2e34 272c 2027 656e 7465  11.2.3.4', 'ente
-00025c90: 7220 7661 6c69 6420 4950 2061 6464 7265  r valid IP addre
-00025ca0: 7373 2729 0a20 2020 2020 2020 203e 3e3e  ss').        >>>
-00025cb0: 2049 535f 4950 4144 4452 4553 5328 2928   IS_IPADDRESS()(
-00025cc0: 2730 3131 312e 322e 332e 3427 290a 2020  '0111.2.3.4').  
-00025cd0: 2020 2020 2020 2827 3031 3131 2e32 2e33        ('0111.2.3
-00025ce0: 2e34 272c 2027 656e 7465 7220 7661 6c69  .4', 'enter vali
-00025cf0: 6420 4950 2061 6464 7265 7373 2729 0a20  d IP address'). 
-00025d00: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00025d10: 4144 4452 4553 5328 2928 2732 3536 2e32  ADDRESS()('256.2
-00025d20: 2e33 2e34 2729 0a20 2020 2020 2020 2028  .3.4').        (
-00025d30: 2732 3536 2e32 2e33 2e34 272c 2027 656e  '256.2.3.4', 'en
-00025d40: 7465 7220 7661 6c69 6420 4950 2061 6464  ter valid IP add
-00025d50: 7265 7373 2729 0a20 2020 2020 2020 203e  ress').        >
-00025d60: 3e3e 2049 535f 4950 4144 4452 4553 5328  >> IS_IPADDRESS(
-00025d70: 2928 2733 3030 2e32 2e33 2e34 2729 0a20  )('300.2.3.4'). 
-00025d80: 2020 2020 2020 2028 2733 3030 2e32 2e33         ('300.2.3
-00025d90: 2e34 272c 2027 656e 7465 7220 7661 6c69  .4', 'enter vali
-00025da0: 6420 4950 2061 6464 7265 7373 2729 0a20  d IP address'). 
-00025db0: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
-00025dc0: 4144 4452 4553 5328 6d69 6e69 703d 2731  ADDRESS(minip='1
-00025dd0: 3932 2e31 3638 2e31 2e30 272c 206d 6178  92.168.1.0', max
-00025de0: 6970 3d27 3139 322e 3136 382e 312e 3235  ip='192.168.1.25
-00025df0: 3527 2928 2731 3932 2e31 3638 2e31 2e31  5')('192.168.1.1
-00025e00: 3030 2729 0a20 2020 2020 2020 2028 2731  00').        ('1
-00025e10: 3932 2e31 3638 2e31 2e31 3030 272c 204e  92.168.1.100', N
-00025e20: 6f6e 6529 0a20 2020 2020 2020 203e 3e3e  one).        >>>
-00025e30: 2049 535f 4950 4144 4452 4553 5328 6d69   IS_IPADDRESS(mi
-00025e40: 6e69 703d 2731 2e32 2e33 2e35 272c 206d  nip='1.2.3.5', m
-00025e50: 6178 6970 3d27 312e 322e 332e 3927 2c20  axip='1.2.3.9', 
-00025e60: 6572 726f 725f 6d65 7373 6167 653d 2742  error_message='B
-00025e70: 6164 2069 7027 2928 2731 2e32 2e33 2e34  ad ip')('1.2.3.4
-00025e80: 2729 0a20 2020 2020 2020 2028 2731 2e32  ').        ('1.2
-00025e90: 2e33 2e34 272c 2027 6261 6420 6970 2729  .3.4', 'bad ip')
-00025ea0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00025eb0: 4950 4144 4452 4553 5328 6d61 7869 703d  IPADDRESS(maxip=
-00025ec0: 2731 2e32 2e33 2e34 272c 2069 6e76 6572  '1.2.3.4', inver
-00025ed0: 743d 5472 7565 2928 2731 3237 2e30 2e30  t=True)('127.0.0
-00025ee0: 2e31 2729 0a20 2020 2020 2020 2028 2731  .1').        ('1
-00025ef0: 3237 2e30 2e30 2e31 272c 204e 6f6e 6529  27.0.0.1', None)
-00025f00: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00025f10: 4950 4144 4452 4553 5328 6d61 7869 703d  IPADDRESS(maxip=
-00025f20: 2731 3932 2e31 3638 2e31 2e34 272c 2069  '192.168.1.4', i
-00025f30: 6e76 6572 743d 5472 7565 2928 2731 3932  nvert=True)('192
-00025f40: 2e31 3638 2e31 2e34 2729 0a20 2020 2020  .168.1.4').     
-00025f50: 2020 2028 2731 3932 2e31 3638 2e31 2e34     ('192.168.1.4
-00025f60: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
-00025f70: 4950 2061 6464 7265 7373 2729 0a20 2020  IP address').   
-00025f80: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-00025f90: 4452 4553 5328 6973 5f6c 6f63 616c 686f  DRESS(is_localho
-00025fa0: 7374 3d54 7275 6529 2827 3132 372e 302e  st=True)('127.0.
-00025fb0: 302e 3127 290a 2020 2020 2020 2020 2827  0.1').        ('
-00025fc0: 3132 372e 302e 302e 3127 2c20 4e6f 6e65  127.0.0.1', None
-00025fd0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
-00025fe0: 5f49 5041 4444 5245 5353 2869 735f 6c6f  _IPADDRESS(is_lo
-00025ff0: 6361 6c68 6f73 743d 5472 7565 2928 2731  calhost=True)('1
-00026000: 3932 2e31 3638 2e31 2e31 3027 290a 2020  92.168.1.10').  
-00026010: 2020 2020 2020 2827 3139 322e 3136 382e        ('192.168.
-00026020: 312e 3130 272c 2027 656e 7465 7220 7661  1.10', 'enter va
-00026030: 6c69 6420 4950 2061 6464 7265 7373 2729  lid IP address')
-00026040: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
-00026050: 4950 4144 4452 4553 5328 6973 5f6c 6f63  IPADDRESS(is_loc
-00026060: 616c 686f 7374 3d46 616c 7365 2928 2731  alhost=False)('1
-00026070: 3237 2e30 2e30 2e31 2729 0a20 2020 2020  27.0.0.1').     
-00026080: 2020 2028 2731 3237 2e30 2e30 2e31 272c     ('127.0.0.1',
-00026090: 2027 656e 7465 7220 7661 6c69 6420 4950   'enter valid IP
-000260a0: 2061 6464 7265 7373 2729 0a20 2020 2020   address').     
-000260b0: 2020 203e 3e3e 2049 535f 4950 4144 4452     >>> IS_IPADDR
-000260c0: 4553 5328 6d61 7869 703d 2731 3030 2e30  ESS(maxip='100.0
-000260d0: 2e30 2e30 272c 2069 735f 6c6f 6361 6c68  .0.0', is_localh
-000260e0: 6f73 743d 5472 7565 2928 2731 3237 2e30  ost=True)('127.0
-000260f0: 2e30 2e31 2729 0a20 2020 2020 2020 2028  .0.1').        (
-00026100: 2731 3237 2e30 2e30 2e31 272c 2027 656e  '127.0.0.1', 'en
-00026110: 7465 7220 7661 6c69 6420 4950 2061 6464  ter valid IP add
-00026120: 7265 7373 2729 0a0a 2020 2020 2020 2020  ress')..        
-00026130: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
-00026140: 2829 2827 6665 3830 3a3a 3132 3663 3a38  ()('fe80::126c:8
-00026150: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
-00026160: 2020 2020 2020 2020 2827 6665 3830 3a3a          ('fe80::
-00026170: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00026180: 3361 6627 2c20 4e6f 6e65 290a 2020 2020  3af', None).    
-00026190: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-000261a0: 5245 5353 2869 735f 6970 7634 3d46 616c  RESS(is_ipv4=Fal
-000261b0: 7365 2928 2766 6538 303a 3a31 3236 633a  se)('fe80::126c:
-000261c0: 3866 6661 3a66 6532 323a 6233 6166 2729  8ffa:fe22:b3af')
-000261d0: 0a20 2020 2020 2020 2028 2766 6538 303a  .        ('fe80:
-000261e0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-000261f0: 6233 6166 272c 204e 6f6e 6529 0a20 2020  b3af', None).   
-00026200: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-00026210: 4452 4553 5328 2928 2766 6538 303a 3a31  DRESS()('fe80::1
-00026220: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00026230: 6166 2020 2729 0a20 2020 2020 2020 2028  af  ').        (
-00026240: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
-00026250: 3a66 6532 323a 6233 6166 2020 272c 2027  :fe22:b3af  ', '
-00026260: 656e 7465 7220 7661 6c69 6420 4950 2061  enter valid IP a
-00026270: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
-00026280: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00026290: 5328 6973 5f69 7076 343d 5472 7565 2928  S(is_ipv4=True)(
-000262a0: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
-000262b0: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-000262c0: 2020 2020 2028 2766 6538 303a 3a31 3236       ('fe80::126
-000262d0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
-000262e0: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
-000262f0: 4950 2061 6464 7265 7373 2729 0a20 2020  IP address').   
-00026300: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
-00026310: 4452 4553 5328 6973 5f69 7076 363d 5472  DRESS(is_ipv6=Tr
-00026320: 7565 2928 2731 3932 2e31 3638 2e31 2e31  ue)('192.168.1.1
-00026330: 2729 0a20 2020 2020 2020 2028 2731 3932  ').        ('192
-00026340: 2e31 3638 2e31 2e31 272c 2027 656e 7465  .168.1.1', 'ente
-00026350: 7220 7661 6c69 6420 4950 2061 6464 7265  r valid IP addre
-00026360: 7373 2729 0a20 2020 2020 2020 203e 3e3e  ss').        >>>
-00026370: 2049 535f 4950 4144 4452 4553 5328 6973   IS_IPADDRESS(is
-00026380: 5f69 7076 363d 5472 7565 2c20 6572 726f  _ipv6=True, erro
-00026390: 725f 6d65 7373 6167 653d 2742 6164 2069  r_message='Bad i
-000263a0: 7027 2928 2731 3932 2e31 3638 2e31 2e31  p')('192.168.1.1
-000263b0: 2729 0a20 2020 2020 2020 2028 2731 3932  ').        ('192
-000263c0: 2e31 3638 2e31 2e31 272c 2027 6261 6420  .168.1.1', 'bad 
-000263d0: 6970 2729 0a20 2020 2020 2020 203e 3e3e  ip').        >>>
-000263e0: 2049 535f 4950 4144 4452 4553 5328 6973   IS_IPADDRESS(is
-000263f0: 5f6c 696e 6b5f 6c6f 6361 6c3d 5472 7565  _link_local=True
-00026400: 2928 2766 6538 303a 3a31 3236 633a 3866  )('fe80::126c:8f
-00026410: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
-00026420: 2020 2020 2020 2028 2766 6538 303a 3a31         ('fe80::1
-00026430: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
-00026440: 6166 272c 204e 6f6e 6529 0a20 2020 2020  af', None).     
-00026450: 2020 203e 3e3e 2049 535f 4950 4144 4452     >>> IS_IPADDR
-00026460: 4553 5328 6973 5f6c 696e 6b5f 6c6f 6361  ESS(is_link_loca
-00026470: 6c3d 4661 6c73 6529 2827 6665 3830 3a3a  l=False)('fe80::
-00026480: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00026490: 3361 6627 290a 2020 2020 2020 2020 2827  3af').        ('
-000264a0: 6665 3830 3a3a 3132 3663 3a38 6666 613a  fe80::126c:8ffa:
-000264b0: 6665 3232 3a62 3361 6627 2c20 2765 6e74  fe22:b3af', 'ent
-000264c0: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
-000264d0: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
-000264e0: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
-000264f0: 735f 6c69 6e6b 5f6c 6f63 616c 3d54 7275  s_link_local=Tru
-00026500: 6529 2827 3230 3031 3a3a 3132 3663 3a38  e)('2001::126c:8
-00026510: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
-00026520: 2020 2020 2020 2020 2827 3230 3031 3a3a          ('2001::
-00026530: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
-00026540: 3361 6627 2c20 2765 6e74 6572 2076 616c  3af', 'enter val
-00026550: 6964 2049 5020 6164 6472 6573 7327 290a  id IP address').
-00026560: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
-00026570: 5041 4444 5245 5353 2869 735f 6d75 6c74  PADDRESS(is_mult
-00026580: 6963 6173 743d 5472 7565 2928 2732 3030  icast=True)('200
-00026590: 313a 3a31 3236 633a 3866 6661 3a66 6532  1::126c:8ffa:fe2
-000265a0: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
-000265b0: 2028 2732 3030 313a 3a31 3236 633a 3866   ('2001::126c:8f
-000265c0: 6661 3a66 6532 323a 6233 6166 272c 2027  fa:fe22:b3af', '
-000265d0: 656e 7465 7220 7661 6c69 6420 4950 2061  enter valid IP a
-000265e0: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
-000265f0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00026600: 5328 6973 5f6d 756c 7469 6361 7374 3d54  S(is_multicast=T
-00026610: 7275 6529 2827 6666 3030 3a3a 3132 3663  rue)('ff00::126c
-00026620: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
-00026630: 290a 2020 2020 2020 2020 2827 6666 3030  ).        ('ff00
-00026640: 3a3a 3132 3663 3a38 6666 613a 6665 3232  ::126c:8ffa:fe22
-00026650: 3a62 3361 6627 2c20 4e6f 6e65 290a 2020  :b3af', None).  
-00026660: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
-00026670: 4444 5245 5353 2869 735f 726f 7574 6561  DDRESS(is_routea
-00026680: 626c 653d 5472 7565 2928 2732 3030 313a  ble=True)('2001:
-00026690: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
-000266a0: 6233 6166 2729 0a20 2020 2020 2020 2028  b3af').        (
-000266b0: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
-000266c0: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-000266d0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-000266e0: 535f 4950 4144 4452 4553 5328 6973 5f72  S_IPADDRESS(is_r
-000266f0: 6f75 7465 6162 6c65 3d54 7275 6529 2827  outeable=True)('
-00026700: 6666 3030 3a3a 3132 3663 3a38 6666 613a  ff00::126c:8ffa:
-00026710: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
-00026720: 2020 2020 2827 6666 3030 3a3a 3132 3663      ('ff00::126c
-00026730: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
-00026740: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
-00026750: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
-00026760: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
-00026770: 5245 5353 2873 7562 6e65 7473 3d27 3230  RESS(subnets='20
-00026780: 3031 3a3a 2f33 3227 2928 2732 3030 313a  01::/32')('2001:
-00026790: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
-000267a0: 290a 2020 2020 2020 2020 2827 3230 3031  ).        ('2001
-000267b0: 3a3a 3866 6661 3a66 6532 323a 6233 6166  ::8ffa:fe22:b3af
-000267c0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-000267d0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-000267e0: 5328 7375 626e 6574 733d 2766 6230 303a  S(subnets='fb00:
-000267f0: 3a2f 3827 2928 2732 3030 313a 3a38 6666  :/8')('2001::8ff
-00026800: 613a 6665 3232 3a62 3361 6627 290a 2020  a:fe22:b3af').  
-00026810: 2020 2020 2020 2827 3230 3031 3a3a 3866        ('2001::8f
-00026820: 6661 3a66 6532 323a 6233 6166 272c 2027  fa:fe22:b3af', '
-00026830: 656e 7465 7220 7661 6c69 6420 4950 2061  enter valid IP a
-00026840: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
-00026850: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
-00026860: 5328 7375 626e 6574 733d 5b27 6663 3030  S(subnets=['fc00
-00026870: 3a3a 2f38 272c 2732 3030 313a 3a2f 3332  ::/8','2001::/32
-00026880: 275d 2928 2732 3030 313a 3a38 6666 613a  '])('2001::8ffa:
-00026890: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
-000268a0: 2020 2020 2827 3230 3031 3a3a 3866 6661      ('2001::8ffa
-000268b0: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
-000268c0: 6529 0a20 2020 2020 2020 203e 3e3e 2049  e).        >>> I
-000268d0: 535f 4950 4144 4452 4553 5328 7375 626e  S_IPADDRESS(subn
-000268e0: 6574 733d 2769 6e76 616c 6964 7375 626e  ets='invalidsubn
-000268f0: 6574 2729 2827 3230 3031 3a3a 3866 6661  et')('2001::8ffa
-00026900: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
-00026910: 2020 2020 2028 2732 3030 313a 3a38 6666       ('2001::8ff
-00026920: 613a 6665 3232 3a62 3361 6627 2c20 2769  a:fe22:b3af', 'i
-00026930: 6e76 616c 6964 2073 7562 6e65 7420 7072  nvalid subnet pr
-00026940: 6f76 6964 6564 2729 0a20 2020 2022 2222  ovided').    """
-00026950: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00026960: 5f5f 280a 2020 2020 2020 2020 7365 6c66  __(.        self
-00026970: 2c0a 2020 2020 2020 2020 6d69 6e69 703d  ,.        minip=
-00026980: 2230 2e30 2e30 2e30 222c 0a20 2020 2020  "0.0.0.0",.     
-00026990: 2020 206d 6178 6970 3d22 3235 352e 3235     maxip="255.25
-000269a0: 352e 3235 352e 3235 3522 2c0a 2020 2020  5.255.255",.    
-000269b0: 2020 2020 696e 7665 7274 3d46 616c 7365      invert=False
-000269c0: 2c0a 2020 2020 2020 2020 6973 5f6c 6f63  ,.        is_loc
-000269d0: 616c 686f 7374 3d4e 6f6e 652c 0a20 2020  alhost=None,.   
-000269e0: 2020 2020 2069 735f 7072 6976 6174 653d       is_private=
-000269f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6973  None,.        is
-00026a00: 5f61 7574 6f6d 6174 6963 3d4e 6f6e 652c  _automatic=None,
-00026a10: 0a20 2020 2020 2020 2069 735f 6970 7634  .        is_ipv4
-00026a20: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
-00026a30: 735f 6c69 6e6b 5f6c 6f63 616c 3d4e 6f6e  s_link_local=Non
-00026a40: 652c 0a20 2020 2020 2020 2069 735f 7265  e,.        is_re
-00026a50: 7365 7276 6564 3d4e 6f6e 652c 0a20 2020  served=None,.   
-00026a60: 2020 2020 2069 735f 6d75 6c74 6963 6173       is_multicas
-00026a70: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00026a80: 6973 5f72 6f75 7465 6162 6c65 3d4e 6f6e  is_routeable=Non
-00026a90: 652c 0a20 2020 2020 2020 2069 735f 3674  e,.        is_6t
-00026aa0: 6f34 3d4e 6f6e 652c 0a20 2020 2020 2020  o4=None,.       
-00026ab0: 2069 735f 7465 7265 646f 3d4e 6f6e 652c   is_teredo=None,
-00026ac0: 0a20 2020 2020 2020 2073 7562 6e65 7473  .        subnets
-00026ad0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2069  =None,.        i
-00026ae0: 735f 6970 7636 3d4e 6f6e 652c 0a20 2020  s_ipv6=None,.   
-00026af0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00026b00: 6765 3d22 456e 7465 7220 7661 6c69 6420  ge="Enter valid 
-00026b10: 4950 2061 6464 7265 7373 222c 0a20 2020  IP address",.   
-00026b20: 2029 3a0a 2020 2020 2020 2020 7365 6c66   ):.        self
-00026b30: 2e6d 696e 6970 203d 2028 6d69 6e69 702c  .minip = (minip,
-00026b40: 290a 2020 2020 2020 2020 7365 6c66 2e6d  ).        self.m
-00026b50: 6178 6970 203d 2028 6d61 7869 702c 290a  axip = (maxip,).
-00026b60: 2020 2020 2020 2020 7365 6c66 2e69 6e76          self.inv
-00026b70: 6572 7420 3d20 696e 7665 7274 0a20 2020  ert = invert.   
-00026b80: 2020 2020 2073 656c 662e 6973 5f6c 6f63       self.is_loc
-00026b90: 616c 686f 7374 203d 2069 735f 6c6f 6361  alhost = is_loca
-00026ba0: 6c68 6f73 740a 2020 2020 2020 2020 7365  lhost.        se
-00026bb0: 6c66 2e69 735f 7072 6976 6174 6520 3d20  lf.is_private = 
-00026bc0: 6973 5f70 7269 7661 7465 0a20 2020 2020  is_private.     
-00026bd0: 2020 2073 656c 662e 6973 5f61 7574 6f6d     self.is_autom
-00026be0: 6174 6963 203d 2069 735f 6175 746f 6d61  atic = is_automa
-00026bf0: 7469 630a 2020 2020 2020 2020 7365 6c66  tic.        self
-00026c00: 2e69 735f 6970 7634 203d 2069 735f 6970  .is_ipv4 = is_ip
-00026c10: 7634 206f 7220 6973 5f69 7076 3620 6973  v4 or is_ipv6 is
-00026c20: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
-00026c30: 656c 662e 6973 5f70 7269 7661 7465 203d  elf.is_private =
-00026c40: 2069 735f 7072 6976 6174 650a 2020 2020   is_private.    
-00026c50: 2020 2020 7365 6c66 2e69 735f 6c69 6e6b      self.is_link
-00026c60: 5f6c 6f63 616c 203d 2069 735f 6c69 6e6b  _local = is_link
-00026c70: 5f6c 6f63 616c 0a20 2020 2020 2020 2073  _local.        s
-00026c80: 656c 662e 6973 5f72 6573 6572 7665 6420  elf.is_reserved 
-00026c90: 3d20 6973 5f72 6573 6572 7665 640a 2020  = is_reserved.  
-00026ca0: 2020 2020 2020 7365 6c66 2e69 735f 6d75        self.is_mu
-00026cb0: 6c74 6963 6173 7420 3d20 6973 5f6d 756c  lticast = is_mul
-00026cc0: 7469 6361 7374 0a20 2020 2020 2020 2073  ticast.        s
-00026cd0: 656c 662e 6973 5f72 6f75 7465 6162 6c65  elf.is_routeable
-00026ce0: 203d 2069 735f 726f 7574 6561 626c 650a   = is_routeable.
-00026cf0: 2020 2020 2020 2020 7365 6c66 2e69 735f          self.is_
-00026d00: 3674 6f34 203d 2069 735f 3674 6f34 0a20  6to4 = is_6to4. 
-00026d10: 2020 2020 2020 2073 656c 662e 6973 5f74         self.is_t
-00026d20: 6572 6564 6f20 3d20 6973 5f74 6572 6564  eredo = is_tered
-00026d30: 6f0a 2020 2020 2020 2020 7365 6c66 2e73  o.        self.s
-00026d40: 7562 6e65 7473 203d 2073 7562 6e65 7473  ubnets = subnets
-00026d50: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
-00026d60: 5f69 7076 3620 3d20 6973 5f69 7076 3620  _ipv6 = is_ipv6 
-00026d70: 6f72 2069 735f 6970 7634 2069 7320 4661  or is_ipv4 is Fa
-00026d80: 6c73 650a 2020 2020 2020 2020 7365 6c66  lse.        self
-00026d90: 2e65 7272 6f72 5f6d 6573 7361 6765 203d  .error_message =
-00026da0: 2065 7272 6f72 5f6d 6573 7361 6765 0a0a   error_message..
-00026db0: 2020 2020 6465 6620 7661 6c69 6461 7465      def validate
-00026dc0: 2873 656c 662c 2076 616c 7565 2c20 7265  (self, value, re
-00026dd0: 636f 7264 5f69 643d 4e6f 6e65 293a 0a20  cord_id=None):. 
-00026de0: 2020 2020 2020 2049 5041 6464 7265 7373         IPAddress
-00026df0: 203d 2069 7061 6464 7265 7373 2e69 705f   = ipaddress.ip_
-00026e00: 6164 6472 6573 730a 2020 2020 2020 2020  address.        
-00026e10: 4950 7636 4164 6472 6573 7320 3d20 6970  IPv6Address = ip
-00026e20: 6164 6472 6573 732e 4950 7636 4164 6472  address.IPv6Addr
-00026e30: 6573 730a 2020 2020 2020 2020 4950 7634  ess.        IPv4
-00026e40: 4164 6472 6573 7320 3d20 6970 6164 6472  Address = ipaddr
-00026e50: 6573 732e 4950 7634 4164 6472 6573 730a  ess.IPv4Address.
-00026e60: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00026e70: 2020 2020 2020 2020 2020 6970 203d 2049            ip = I
-00026e80: 5041 6464 7265 7373 2874 6f5f 756e 6963  PAddress(to_unic
-00026e90: 6f64 6528 7661 6c75 6529 290a 2020 2020  ode(value)).    
-00026ea0: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-00026eb0: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-00026ec0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-00026ed0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-00026ee0: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00026ef0: 726f 725f 6d65 7373 6167 6529 290a 0a20  ror_message)).. 
-00026f00: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00026f10: 735f 6970 7634 2061 6e64 2069 7369 6e73  s_ipv4 and isins
-00026f20: 7461 6e63 6528 6970 2c20 4950 7636 4164  tance(ip, IPv6Ad
-00026f30: 6472 6573 7329 3a0a 2020 2020 2020 2020  dress):.        
-00026f40: 2020 2020 7261 6973 6520 5661 6c69 6461      raise Valida
-00026f50: 7469 6f6e 4572 726f 7228 7365 6c66 2e74  tionError(self.t
-00026f60: 7261 6e73 6c61 746f 7228 7365 6c66 2e65  ranslator(self.e
-00026f70: 7272 6f72 5f6d 6573 7361 6765 2929 0a20  rror_message)). 
-00026f80: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00026f90: 2e69 735f 6970 7636 2061 6e64 2069 7369  .is_ipv6 and isi
-00026fa0: 6e73 7461 6e63 6528 6970 2c20 4950 7634  nstance(ip, IPv4
-00026fb0: 4164 6472 6573 7329 3a0a 2020 2020 2020  Address):.      
-00026fc0: 2020 2020 2020 7261 6973 6520 5661 6c69        raise Vali
-00026fd0: 6461 7469 6f6e 4572 726f 7228 7365 6c66  dationError(self
-00026fe0: 2e74 7261 6e73 6c61 746f 7228 7365 6c66  .translator(self
-00026ff0: 2e65 7272 6f72 5f6d 6573 7361 6765 2929  .error_message))
-00027000: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-00027010: 6c66 2e69 735f 6970 7634 206f 7220 6973  lf.is_ipv4 or is
-00027020: 696e 7374 616e 6365 2869 702c 2049 5076  instance(ip, IPv
-00027030: 3441 6464 7265 7373 293a 0a20 2020 2020  4Address):.     
-00027040: 2020 2020 2020 2072 6574 7572 6e20 4953         return IS
-00027050: 5f49 5056 3428 0a20 2020 2020 2020 2020  _IPV4(.         
-00027060: 2020 2020 2020 206d 696e 6970 3d73 656c         minip=sel
-00027070: 662e 6d69 6e69 702c 0a20 2020 2020 2020  f.minip,.       
-00027080: 2020 2020 2020 2020 206d 6178 6970 3d73           maxip=s
-00027090: 656c 662e 6d61 7869 702c 0a20 2020 2020  elf.maxip,.     
-000270a0: 2020 2020 2020 2020 2020 2069 6e76 6572             inver
-000270b0: 743d 7365 6c66 2e69 6e76 6572 742c 0a20  t=self.invert,. 
-000270c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000270d0: 735f 6c6f 6361 6c68 6f73 743d 7365 6c66  s_localhost=self
-000270e0: 2e69 735f 6c6f 6361 6c68 6f73 742c 0a20  .is_localhost,. 
-000270f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00027100: 735f 7072 6976 6174 653d 7365 6c66 2e69  s_private=self.i
-00027110: 735f 7072 6976 6174 652c 0a20 2020 2020  s_private,.     
-00027120: 2020 2020 2020 2020 2020 2069 735f 6175             is_au
-00027130: 746f 6d61 7469 633d 7365 6c66 2e69 735f  tomatic=self.is_
-00027140: 6175 746f 6d61 7469 632c 0a20 2020 2020  automatic,.     
-00027150: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-00027160: 5f6d 6573 7361 6765 3d73 656c 662e 6572  _message=self.er
-00027170: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
-00027180: 2020 2020 2020 2020 2029 2e76 616c 6964           ).valid
-00027190: 6174 6528 7661 6c75 652c 2072 6563 6f72  ate(value, recor
-000271a0: 645f 6964 290a 2020 2020 2020 2020 656c  d_id).        el
-000271b0: 6966 2073 656c 662e 6973 5f69 7076 3620  if self.is_ipv6 
-000271c0: 6f72 2069 7369 6e73 7461 6e63 6528 6970  or isinstance(ip
-000271d0: 2c20 4950 7636 4164 6472 6573 7329 3a0a  , IPv6Address):.
-000271e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000271f0: 726e 2049 535f 4950 5636 280a 2020 2020  rn IS_IPV6(.    
-00027200: 2020 2020 2020 2020 2020 2020 6973 5f70              is_p
-00027210: 7269 7661 7465 3d73 656c 662e 6973 5f70  rivate=self.is_p
-00027220: 7269 7661 7465 2c0a 2020 2020 2020 2020  rivate,.        
-00027230: 2020 2020 2020 2020 6973 5f6c 696e 6b5f          is_link_
-00027240: 6c6f 6361 6c3d 7365 6c66 2e69 735f 6c69  local=self.is_li
-00027250: 6e6b 5f6c 6f63 616c 2c0a 2020 2020 2020  nk_local,.      
-00027260: 2020 2020 2020 2020 2020 6973 5f72 6573            is_res
-00027270: 6572 7665 643d 7365 6c66 2e69 735f 7265  erved=self.is_re
-00027280: 7365 7276 6564 2c0a 2020 2020 2020 2020  served,.        
-00027290: 2020 2020 2020 2020 6973 5f6d 756c 7469          is_multi
-000272a0: 6361 7374 3d73 656c 662e 6973 5f6d 756c  cast=self.is_mul
-000272b0: 7469 6361 7374 2c0a 2020 2020 2020 2020  ticast,.        
-000272c0: 2020 2020 2020 2020 6973 5f72 6f75 7465          is_route
-000272d0: 6162 6c65 3d73 656c 662e 6973 5f72 6f75  able=self.is_rou
-000272e0: 7465 6162 6c65 2c0a 2020 2020 2020 2020  teable,.        
-000272f0: 2020 2020 2020 2020 6973 5f36 746f 343d          is_6to4=
-00027300: 7365 6c66 2e69 735f 3674 6f34 2c0a 2020  self.is_6to4,.  
-00027310: 2020 2020 2020 2020 2020 2020 2020 6973                is
-00027320: 5f74 6572 6564 6f3d 7365 6c66 2e69 735f  _teredo=self.is_
-00027330: 7465 7265 646f 2c0a 2020 2020 2020 2020  teredo,.        
-00027340: 2020 2020 2020 2020 7375 626e 6574 733d          subnets=
-00027350: 7365 6c66 2e73 7562 6e65 7473 2c0a 2020  self.subnets,.  
-00027360: 2020 2020 2020 2020 2020 2020 2020 6572                er
-00027370: 726f 725f 6d65 7373 6167 653d 7365 6c66  ror_message=self
-00027380: 2e65 7272 6f72 5f6d 6573 7361 6765 2c0a  .error_message,.
-00027390: 2020 2020 2020 2020 2020 2020 292e 7661              ).va
-000273a0: 6c69 6461 7465 2876 616c 7565 2c20 7265  lidate(value, re
-000273b0: 636f 7264 5f69 6429 0a20 2020 2020 2020  cord_id).       
-000273c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000273d0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
-000273e0: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
-000273f0: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
-00027400: 726f 725f 6d65 7373 6167 6529 290a       ror_message)).
+00023280: 6966 2069 7369 6e73 7461 6e63 6528 6974  if isinstance(it
+00023290: 656d 2c20 7374 7229 3a0a 2020 2020 2020  em, str):.      
+000232a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232b0: 2020 2020 2020 7465 6d70 2e61 7070 656e        temp.appen
+000232c0: 6428 6974 656d 2e73 706c 6974 2822 2e22  d(item.split("."
+000232d0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+000232e0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000232f0: 6973 696e 7374 616e 6365 2869 7465 6d2c  isinstance(item,
+00023300: 2028 6c69 7374 2c20 7475 706c 6529 293a   (list, tuple)):
+00023310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023320: 2020 2020 2020 2020 2020 2020 2074 656d               tem
+00023330: 702e 6170 7065 6e64 2869 7465 6d29 0a20  p.append(item). 
+00023340: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00023350: 7273 203d 205b 5d0a 2020 2020 2020 2020  rs = [].        
+00023360: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+00023370: 7465 6d70 3a0a 2020 2020 2020 2020 2020  temp:.          
+00023380: 2020 2020 2020 6e75 6d62 6572 203d 2030        number = 0
+00023390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000233a0: 2066 6f72 2069 2c20 6a20 696e 207a 6970   for i, j in zip
+000233b0: 2873 656c 662e 6e75 6d62 6572 732c 2069  (self.numbers, i
+000233c0: 7465 6d29 3a0a 2020 2020 2020 2020 2020  tem):.          
+000233d0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+000233e0: 202b 3d20 6920 2a20 696e 7428 6a29 0a20   += i * int(j). 
+000233f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00023400: 756d 6265 7273 2e61 7070 656e 6428 6e75  umbers.append(nu
+00023410: 6d62 6572 290a 2020 2020 2020 2020 2020  mber).          
+00023420: 2020 6966 206e 203d 3d20 303a 0a20 2020    if n == 0:.   
+00023430: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00023440: 662e 6d69 6e69 7020 3d20 6e75 6d62 6572  f.minip = number
+00023450: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00023460: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00023470: 2020 2020 7365 6c66 2e6d 6178 6970 203d      self.maxip =
+00023480: 206e 756d 6265 7273 0a20 2020 2020 2020   numbers.       
+00023490: 2073 656c 662e 696e 7665 7274 203d 2069   self.invert = i
+000234a0: 6e76 6572 740a 2020 2020 2020 2020 7365  nvert.        se
+000234b0: 6c66 2e69 735f 6c6f 6361 6c68 6f73 7420  lf.is_localhost 
+000234c0: 3d20 6973 5f6c 6f63 616c 686f 7374 0a20  = is_localhost. 
+000234d0: 2020 2020 2020 2073 656c 662e 6973 5f70         self.is_p
+000234e0: 7269 7661 7465 203d 2069 735f 7072 6976  rivate = is_priv
+000234f0: 6174 650a 2020 2020 2020 2020 7365 6c66  ate.        self
+00023500: 2e69 735f 6175 746f 6d61 7469 6320 3d20  .is_automatic = 
+00023510: 6973 5f61 7574 6f6d 6174 6963 0a20 2020  is_automatic.   
+00023520: 2020 2020 2073 656c 662e 6572 726f 725f       self.error_
+00023530: 6d65 7373 6167 6520 3d20 6572 726f 725f  message = error_
+00023540: 6d65 7373 6167 650a 0a20 2020 2064 6566  message..    def
+00023550: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
+00023560: 7661 6c75 652c 2072 6563 6f72 645f 6964  value, record_id
+00023570: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00023580: 6966 2072 652e 6d61 7463 6828 7365 6c66  if re.match(self
+00023590: 2e52 4547 4558 5f49 5056 342c 2076 616c  .REGEX_IPV4, val
+000235a0: 7565 293a 0a20 2020 2020 2020 2020 2020  ue):.           
+000235b0: 206e 756d 6265 7220 3d20 300a 2020 2020   number = 0.    
+000235c0: 2020 2020 2020 2020 666f 7220 692c 206a          for i, j
+000235d0: 2069 6e20 7a69 7028 7365 6c66 2e6e 756d   in zip(self.num
+000235e0: 6265 7273 2c20 7661 6c75 652e 7370 6c69  bers, value.spli
+000235f0: 7428 222e 2229 293a 0a20 2020 2020 2020  t(".")):.       
+00023600: 2020 2020 2020 2020 206e 756d 6265 7220           number 
+00023610: 2b3d 2069 202a 2069 6e74 286a 290a 2020  += i * int(j).  
+00023620: 2020 2020 2020 2020 2020 6f6b 203d 2046            ok = F
+00023630: 616c 7365 0a0a 2020 2020 2020 2020 2020  alse..          
+00023640: 2020 666f 7220 626f 7474 6f6d 2c20 746f    for bottom, to
+00023650: 7020 696e 207a 6970 2873 656c 662e 6d69  p in zip(self.mi
+00023660: 6e69 702c 2073 656c 662e 6d61 7869 7029  nip, self.maxip)
+00023670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00023680: 2020 6966 2073 656c 662e 696e 7665 7274    if self.invert
+00023690: 2021 3d20 2862 6f74 746f 6d20 3c3d 206e   != (bottom <= n
+000236a0: 756d 6265 7220 3c3d 2074 6f70 293a 0a20  umber <= top):. 
+000236b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000236c0: 2020 206f 6b20 3d20 5472 7565 0a0a 2020     ok = True..  
+000236d0: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
+000236e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000236f0: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+00023700: 2020 616e 6420 7365 6c66 2e69 735f 6c6f    and self.is_lo
+00023710: 6361 6c68 6f73 7420 6973 206e 6f74 204e  calhost is not N
+00023720: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00023730: 2020 2020 616e 6420 7365 6c66 2e69 735f      and self.is_
+00023740: 6c6f 6361 6c68 6f73 7420 213d 2028 6e75  localhost != (nu
+00023750: 6d62 6572 203d 3d20 7365 6c66 2e6c 6f63  mber == self.loc
+00023760: 616c 686f 7374 290a 2020 2020 2020 2020  alhost).        
+00023770: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00023780: 2020 2020 2020 206f 6b20 3d20 4661 6c73         ok = Fals
+00023790: 650a 0a20 2020 2020 2020 2020 2020 2070  e..            p
+000237a0: 7269 7661 7465 203d 2061 6e79 280a 2020  rivate = any(.  
+000237b0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000237c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000237d0: 2020 2020 7072 6976 6174 655f 6e75 6d62      private_numb
+000237e0: 6572 5b30 5d20 3c3d 206e 756d 6265 7220  er[0] <= number 
+000237f0: 3c3d 2070 7269 7661 7465 5f6e 756d 6265  <= private_numbe
+00023800: 725b 315d 0a20 2020 2020 2020 2020 2020  r[1].           
+00023810: 2020 2020 2020 2020 2066 6f72 2070 7269           for pri
+00023820: 7661 7465 5f6e 756d 6265 7220 696e 2073  vate_number in s
+00023830: 656c 662e 7072 6976 6174 650a 2020 2020  elf.private.    
+00023840: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00023850: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00023860: 2020 2020 2020 2020 6966 206f 6b20 616e          if ok an
+00023870: 6420 7365 6c66 2e69 735f 7072 6976 6174  d self.is_privat
+00023880: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
+00023890: 6420 7365 6c66 2e69 735f 7072 6976 6174  d self.is_privat
+000238a0: 6520 213d 2070 7269 7661 7465 3a0a 2020  e != private:.  
+000238b0: 2020 2020 2020 2020 2020 2020 2020 6f6b                ok
+000238c0: 203d 2046 616c 7365 0a0a 2020 2020 2020   = False..      
+000238d0: 2020 2020 2020 6175 746f 6d61 7469 6320        automatic 
+000238e0: 3d20 7365 6c66 2e61 7574 6f6d 6174 6963  = self.automatic
+000238f0: 5b30 5d20 3c3d 206e 756d 6265 7220 3c3d  [0] <= number <=
+00023900: 2073 656c 662e 6175 746f 6d61 7469 635b   self.automatic[
+00023910: 315d 0a20 2020 2020 2020 2020 2020 2069  1].            i
+00023920: 6620 6f6b 2061 6e64 2073 656c 662e 6973  f ok and self.is
+00023930: 5f61 7574 6f6d 6174 6963 2069 7320 6e6f  _automatic is no
+00023940: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+00023950: 6973 5f61 7574 6f6d 6174 6963 2021 3d20  is_automatic != 
+00023960: 6175 746f 6d61 7469 633a 0a20 2020 2020  automatic:.     
+00023970: 2020 2020 2020 2020 2020 206f 6b20 3d20             ok = 
+00023980: 4661 6c73 650a 0a20 2020 2020 2020 2020  False..         
+00023990: 2020 2069 6620 6f6b 3a0a 2020 2020 2020     if ok:.      
+000239a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000239b0: 2076 616c 7565 0a0a 2020 2020 2020 2020   value..        
+000239c0: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+000239d0: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
+000239e0: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
+000239f0: 5f6d 6573 7361 6765 2929 0a0a 0a63 6c61  _message))...cla
+00023a00: 7373 2049 535f 4950 5636 2856 616c 6964  ss IS_IPV6(Valid
+00023a10: 6174 6f72 293a 0a20 2020 2022 2222 0a20  ator):.    """. 
+00023a20: 2020 2043 6865 636b 7320 6966 2066 6965     Checks if fie
+00023a30: 6c64 2773 2076 616c 7565 2069 7320 616e  ld's value is an
+00023a40: 2049 5020 7665 7273 696f 6e20 3620 6164   IP version 6 ad
+00023a50: 6472 6573 732e 0a0a 2020 2020 5573 6573  dress...    Uses
+00023a60: 2074 6865 2069 7061 6464 7265 7373 2066   the ipaddress f
+00023a70: 726f 6d20 7468 6520 5079 7468 6f6e 2033  rom the Python 3
+00023a80: 2073 7461 6e64 6172 6420 6c69 6272 6172   standard librar
+00023a90: 790a 2020 2020 616e 6420 6974 7320 5079  y.    and its Py
+00023aa0: 7468 6f6e 2032 2062 6163 6b70 6f72 7420  thon 2 backport 
+00023ab0: 2869 6e20 636f 6e74 7269 622f 6970 6164  (in contrib/ipad
+00023ac0: 6472 6573 732e 7079 292e 0a0a 2020 2020  dress.py)...    
+00023ad0: 4172 6773 3a0a 2020 2020 2020 2020 6973  Args:.        is
+00023ae0: 5f70 7269 7661 7465 3a20 4e6f 6e65 2028  _private: None (
+00023af0: 6465 6661 756c 7429 3a20 696e 6469 6666  default): indiff
+00023b00: 6572 656e 740a 2020 2020 2020 2020 2020  erent.          
+00023b10: 2020 2020 2020 2020 2020 5472 7565 2028            True (
+00023b20: 656e 666f 7263 6529 3a20 6164 6472 6573  enforce): addres
+00023b30: 7320 6d75 7374 2062 6520 696e 2066 6330  s must be in fc0
+00023b40: 303a 3a2f 3720 7261 6e67 650a 2020 2020  0::/7 range.    
+00023b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b60: 4661 6c73 6520 2866 6f72 6269 6429 3a20  False (forbid): 
+00023b70: 6164 6472 6573 7320 6d75 7374 204e 4f54  address must NOT
+00023b80: 2062 6520 696e 2066 6330 303a 3a2f 3720   be in fc00::/7 
+00023b90: 7261 6e67 650a 2020 2020 2020 2020 6973  range.        is
+00023ba0: 5f6c 696e 6b5f 6c6f 6361 6c3a 2053 616d  _link_local: Sam
+00023bb0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
+00023bc0: 7365 7320 6665 3830 3a3a 2f31 3020 7261  ses fe80::/10 ra
+00023bd0: 6e67 650a 2020 2020 2020 2020 6973 5f72  nge.        is_r
+00023be0: 6573 6572 7665 643a 2053 616d 6520 6173  eserved: Same as
+00023bf0: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
+00023c00: 4945 5446 2072 6573 6572 7665 6420 7261  IETF reserved ra
+00023c10: 6e67 650a 2020 2020 2020 2020 6973 5f6d  nge.        is_m
+00023c20: 756c 7469 6361 7374 3a20 5361 6d65 2061  ulticast: Same a
+00023c30: 7320 6162 6f76 6520 6275 7420 7573 6573  s above but uses
+00023c40: 2066 6630 303a 3a2f 3820 7261 6e67 650a   ff00::/8 range.
+00023c50: 2020 2020 2020 2020 6973 5f72 6f75 7465          is_route
+00023c60: 6162 6c65 3a20 5369 6d69 6c61 7220 746f  able: Similar to
+00023c70: 2061 626f 7665 2062 7574 2065 6e66 6f72   above but enfor
+00023c80: 6365 7320 6e6f 7420 7072 6976 6174 652c  ces not private,
+00023c90: 206c 696e 6b5f 6c6f 6361 6c2c 0a20 2020   link_local,.   
+00023ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cb0: 2020 2072 6573 6572 7665 6420 6f72 206d     reserved or m
+00023cc0: 756c 7469 6361 7374 0a20 2020 2020 2020  ulticast.       
+00023cd0: 2069 735f 3674 6f34 3a20 5361 6d65 2061   is_6to4: Same a
+00023ce0: 7320 6162 6f76 6520 6275 7420 7573 6573  s above but uses
+00023cf0: 2032 3030 323a 3a2f 3136 2072 616e 6765   2002::/16 range
+00023d00: 0a20 2020 2020 2020 2069 735f 7465 7265  .        is_tere
+00023d10: 646f 3a20 5361 6d65 2061 7320 6162 6f76  do: Same as abov
+00023d20: 6520 6275 7420 7573 6573 2032 3030 313a  e but uses 2001:
+00023d30: 3a2f 3332 2072 616e 6765 0a20 2020 2020  :/32 range.     
+00023d40: 2020 2073 7562 6e65 7473 3a20 7661 6c75     subnets: valu
+00023d50: 6520 6d75 7374 2062 6520 6120 6d65 6d62  e must be a memb
+00023d60: 6572 206f 6620 6174 206c 6561 7374 206f  er of at least o
+00023d70: 6e65 2066 726f 6d20 6c69 7374 206f 6620  ne from list of 
+00023d80: 7375 626e 6574 730a 0a20 2020 2045 7861  subnets..    Exa
+00023d90: 6d70 6c65 733a 0a20 2020 2020 2020 2043  mples:.        C
+00023da0: 6865 636b 2066 6f72 2076 616c 6964 2049  heck for valid I
+00023db0: 5076 3620 6164 6472 6573 733a 0a0a 2020  Pv6 address:..  
+00023dc0: 2020 2020 2020 2020 2020 494e 5055 5428            INPUT(
+00023dd0: 5f74 7970 653d 2774 6578 7427 2c20 5f6e  _type='text', _n
+00023de0: 616d 653d 276e 616d 6527 2c20 7265 7175  ame='name', requ
+00023df0: 6972 6573 3d49 535f 4950 5636 2829 290a  ires=IS_IPV6()).
+00023e00: 0a20 2020 2020 2020 2043 6865 636b 2066  .        Check f
+00023e10: 6f72 2076 616c 6964 2049 5076 3620 6164  or valid IPv6 ad
+00023e20: 6472 6573 7320 6973 2061 206c 696e 6b5f  dress is a link_
+00023e30: 6c6f 6361 6c20 6164 6472 6573 733a 0a0a  local address:..
+00023e40: 2020 2020 2020 2020 2020 2020 494e 5055              INPU
+00023e50: 5428 5f74 7970 653d 2774 6578 7427 2c20  T(_type='text', 
+00023e60: 5f6e 616d 653d 276e 616d 6527 2c20 7265  _name='name', re
+00023e70: 7175 6972 6573 3d49 535f 4950 5636 2869  quires=IS_IPV6(i
+00023e80: 735f 6c69 6e6b 5f6c 6f63 616c 3d54 7275  s_link_local=Tru
+00023e90: 6529 290a 0a20 2020 2020 2020 2043 6865  e))..        Che
+00023ea0: 636b 2066 6f72 2076 616c 6964 2049 5076  ck for valid IPv
+00023eb0: 3620 6164 6472 6573 7320 7468 6174 2069  6 address that i
+00023ec0: 7320 496e 7465 726e 6574 2072 6f75 7465  s Internet route
+00023ed0: 6162 6c65 3a0a 0a20 2020 2020 2020 2020  able:..         
+00023ee0: 2020 2049 4e50 5554 285f 7479 7065 3d27     INPUT(_type='
+00023ef0: 7465 7874 272c 205f 6e61 6d65 3d27 6e61  text', _name='na
+00023f00: 6d65 272c 2072 6571 7569 7265 733d 4953  me', requires=IS
+00023f10: 5f49 5056 3628 6973 5f72 6f75 7465 6162  _IPV6(is_routeab
+00023f20: 6c65 3d54 7275 6529 290a 0a20 2020 2020  le=True))..     
+00023f30: 2020 2043 6865 636b 2066 6f72 2076 616c     Check for val
+00023f40: 6964 2049 5076 3620 6164 6472 6573 7320  id IPv6 address 
+00023f50: 696e 2073 7065 6369 6669 6564 2073 7562  in specified sub
+00023f60: 6e65 743a 0a0a 2020 2020 2020 2020 2020  net:..          
+00023f70: 2020 494e 5055 5428 5f74 7970 653d 2774    INPUT(_type='t
+00023f80: 6578 7427 2c20 5f6e 616d 653d 276e 616d  ext', _name='nam
+00023f90: 6527 2c20 7265 7175 6972 6573 3d49 535f  e', requires=IS_
+00023fa0: 4950 5636 2873 7562 6e65 7473 3d5b 2732  IPV6(subnets=['2
+00023fb0: 3030 313a 3a2f 3332 275d 290a 0a20 2020  001::/32'])..   
+00023fc0: 2020 2020 2020 2020 203e 3e3e 2049 535f           >>> IS_
+00023fd0: 4950 5636 2829 2827 6665 3830 3a3a 3132  IPV6()('fe80::12
+00023fe0: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+00023ff0: 6627 290a 2020 2020 2020 2020 2020 2020  f').            
+00024000: 2827 6665 3830 3a3a 3132 3663 3a38 6666  ('fe80::126c:8ff
+00024010: 613a 6665 3232 3a62 3361 6627 2c20 4e6f  a:fe22:b3af', No
+00024020: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00024030: 3e3e 3e20 4953 5f49 5056 3628 2928 2731  >>> IS_IPV6()('1
+00024040: 3932 2e31 3638 2e31 2e31 2729 0a20 2020  92.168.1.1').   
+00024050: 2020 2020 2020 2020 2028 2731 3932 2e31           ('192.1
+00024060: 3638 2e31 2e31 272c 2027 656e 7465 7220  68.1.1', 'enter 
+00024070: 7661 6c69 6420 4950 7636 2061 6464 7265  valid IPv6 addre
+00024080: 7373 2729 0a20 2020 2020 2020 2020 2020  ss').           
+00024090: 203e 3e3e 2049 535f 4950 5636 2865 7272   >>> IS_IPV6(err
+000240a0: 6f72 5f6d 6573 7361 6765 3d27 4261 6420  or_message='Bad 
+000240b0: 6970 2729 2827 3139 322e 3136 382e 312e  ip')('192.168.1.
+000240c0: 3127 290a 2020 2020 2020 2020 2020 2020  1').            
+000240d0: 2827 3139 322e 3136 382e 312e 3127 2c20  ('192.168.1.1', 
+000240e0: 2762 6164 2069 7027 290a 2020 2020 2020  'bad ip').      
+000240f0: 2020 2020 2020 3e3e 3e20 4953 5f49 5056        >>> IS_IPV
+00024100: 3628 6973 5f6c 696e 6b5f 6c6f 6361 6c3d  6(is_link_local=
+00024110: 5472 7565 2928 2766 6538 303a 3a31 3236  True)('fe80::126
+00024120: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00024130: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+00024140: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
+00024150: 3a66 6532 323a 6233 6166 272c 204e 6f6e  :fe22:b3af', Non
+00024160: 6529 0a20 2020 2020 2020 2020 2020 203e  e).            >
+00024170: 3e3e 2049 535f 4950 5636 2869 735f 6c69  >> IS_IPV6(is_li
+00024180: 6e6b 5f6c 6f63 616c 3d46 616c 7365 2928  nk_local=False)(
+00024190: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
+000241a0: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
+000241b0: 2020 2020 2020 2020 2028 2766 6538 303a           ('fe80:
+000241c0: 3a31 3236 633a 3866 6661 3a66 6532 323a  :126c:8ffa:fe22:
+000241d0: 6233 6166 272c 2027 656e 7465 7220 7661  b3af', 'enter va
+000241e0: 6c69 6420 4950 7636 2061 6464 7265 7373  lid IPv6 address
+000241f0: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
+00024200: 3e3e 2049 535f 4950 5636 2869 735f 6c69  >> IS_IPV6(is_li
+00024210: 6e6b 5f6c 6f63 616c 3d54 7275 6529 2827  nk_local=True)('
+00024220: 3230 3031 3a3a 3132 3663 3a38 6666 613a  2001::126c:8ffa:
+00024230: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
+00024240: 2020 2020 2020 2020 2827 3230 3031 3a3a          ('2001::
+00024250: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
+00024260: 3361 6627 2c20 2765 6e74 6572 2076 616c  3af', 'enter val
+00024270: 6964 2049 5076 3620 6164 6472 6573 7327  id IPv6 address'
+00024280: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00024290: 3e20 4953 5f49 5056 3628 6973 5f6d 756c  > IS_IPV6(is_mul
+000242a0: 7469 6361 7374 3d54 7275 6529 2827 3230  ticast=True)('20
+000242b0: 3031 3a3a 3132 3663 3a38 6666 613a 6665  01::126c:8ffa:fe
+000242c0: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
+000242d0: 2020 2020 2020 2827 3230 3031 3a3a 3132        ('2001::12
+000242e0: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+000242f0: 6627 2c20 2765 6e74 6572 2076 616c 6964  f', 'enter valid
+00024300: 2049 5076 3620 6164 6472 6573 7327 290a   IPv6 address').
+00024310: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00024320: 4953 5f49 5056 3628 6973 5f6d 756c 7469  IS_IPV6(is_multi
+00024330: 6361 7374 3d54 7275 6529 2827 6666 3030  cast=True)('ff00
+00024340: 3a3a 3132 3663 3a38 6666 613a 6665 3232  ::126c:8ffa:fe22
+00024350: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
+00024360: 2020 2020 2827 6666 3030 3a3a 3132 3663      ('ff00::126c
+00024370: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00024380: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00024390: 2020 2020 3e3e 3e20 4953 5f49 5056 3628      >>> IS_IPV6(
+000243a0: 6973 5f72 6f75 7465 6162 6c65 3d54 7275  is_routeable=Tru
+000243b0: 6529 2827 3230 3031 3a3a 3132 3663 3a38  e)('2001::126c:8
+000243c0: 6666 613a 6665 3232 3a62 3361 6627 290a  ffa:fe22:b3af').
+000243d0: 2020 2020 2020 2020 2020 2020 2827 3230              ('20
+000243e0: 3031 3a3a 3132 3663 3a38 6666 613a 6665  01::126c:8ffa:fe
+000243f0: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+00024400: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00024410: 4953 5f49 5056 3628 6973 5f72 6f75 7465  IS_IPV6(is_route
+00024420: 6162 6c65 3d54 7275 6529 2827 6666 3030  able=True)('ff00
+00024430: 3a3a 3132 3663 3a38 6666 613a 6665 3232  ::126c:8ffa:fe22
+00024440: 3a62 3361 6627 290a 2020 2020 2020 2020  :b3af').        
+00024450: 2020 2020 2827 6666 3030 3a3a 3132 3663      ('ff00::126c
+00024460: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00024470: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+00024480: 5076 3620 6164 6472 6573 7327 290a 2020  Pv6 address').  
+00024490: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+000244a0: 5f49 5056 3628 7375 626e 6574 733d 2732  _IPV6(subnets='2
+000244b0: 3030 313a 3a2f 3332 2729 2827 3230 3031  001::/32')('2001
+000244c0: 3a3a 3866 6661 3a66 6532 323a 6233 6166  ::8ffa:fe22:b3af
+000244d0: 2729 0a20 2020 2020 2020 2020 2020 2028  ').            (
+000244e0: 2732 3030 313a 3a38 6666 613a 6665 3232  '2001::8ffa:fe22
+000244f0: 3a62 3361 6627 2c20 4e6f 6e65 290a 2020  :b3af', None).  
+00024500: 2020 2020 2020 2020 2020 3e3e 3e20 4953            >>> IS
+00024510: 5f49 5056 3628 7375 626e 6574 733d 2766  _IPV6(subnets='f
+00024520: 6230 303a 3a2f 3827 2928 2732 3030 313a  b00::/8')('2001:
+00024530: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00024540: 290a 2020 2020 2020 2020 2020 2020 2827  ).            ('
+00024550: 3230 3031 3a3a 3866 6661 3a66 6532 323a  2001::8ffa:fe22:
+00024560: 6233 6166 272c 2027 656e 7465 7220 7661  b3af', 'enter va
+00024570: 6c69 6420 4950 7636 2061 6464 7265 7373  lid IPv6 address
+00024580: 2729 0a20 2020 2020 2020 2020 2020 203e  ').            >
+00024590: 3e3e 2049 535f 4950 5636 2873 7562 6e65  >> IS_IPV6(subne
+000245a0: 7473 3d5b 2766 6330 303a 3a2f 3827 2c27  ts=['fc00::/8','
+000245b0: 3230 3031 3a3a 2f33 3227 5d29 2827 3230  2001::/32'])('20
+000245c0: 3031 3a3a 3866 6661 3a66 6532 323a 6233  01::8ffa:fe22:b3
+000245d0: 6166 2729 0a20 2020 2020 2020 2020 2020  af').           
+000245e0: 2028 2732 3030 313a 3a38 6666 613a 6665   ('2001::8ffa:fe
+000245f0: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+00024600: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00024610: 4953 5f49 5056 3628 7375 626e 6574 733d  IS_IPV6(subnets=
+00024620: 2769 6e76 616c 6964 7375 626e 6574 2729  'invalidsubnet')
+00024630: 2827 3230 3031 3a3a 3866 6661 3a66 6532  ('2001::8ffa:fe2
+00024640: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+00024650: 2020 2020 2028 2732 3030 313a 3a38 6666       ('2001::8ff
+00024660: 613a 6665 3232 3a62 3361 6627 2c20 2769  a:fe22:b3af', 'i
+00024670: 6e76 616c 6964 2073 7562 6e65 7420 7072  nvalid subnet pr
+00024680: 6f76 6964 6564 2729 0a0a 2020 2020 2222  ovided')..    ""
+00024690: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+000246a0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
+000246b0: 662c 0a20 2020 2020 2020 2069 735f 7072  f,.        is_pr
+000246c0: 6976 6174 653d 4e6f 6e65 2c0a 2020 2020  ivate=None,.    
+000246d0: 2020 2020 6973 5f6c 696e 6b5f 6c6f 6361      is_link_loca
+000246e0: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
+000246f0: 6973 5f72 6573 6572 7665 643d 4e6f 6e65  is_reserved=None
+00024700: 2c0a 2020 2020 2020 2020 6973 5f6d 756c  ,.        is_mul
+00024710: 7469 6361 7374 3d4e 6f6e 652c 0a20 2020  ticast=None,.   
+00024720: 2020 2020 2069 735f 726f 7574 6561 626c       is_routeabl
+00024730: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+00024740: 6973 5f36 746f 343d 4e6f 6e65 2c0a 2020  is_6to4=None,.  
+00024750: 2020 2020 2020 6973 5f74 6572 6564 6f3d        is_teredo=
+00024760: 4e6f 6e65 2c0a 2020 2020 2020 2020 7375  None,.        su
+00024770: 626e 6574 733d 4e6f 6e65 2c0a 2020 2020  bnets=None,.    
+00024780: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00024790: 653d 2245 6e74 6572 2076 616c 6964 2049  e="Enter valid I
+000247a0: 5076 3620 6164 6472 6573 7322 2c0a 2020  Pv6 address",.  
+000247b0: 2020 293a 0a20 2020 2020 2020 2073 656c    ):.        sel
+000247c0: 662e 6973 5f70 7269 7661 7465 203d 2069  f.is_private = i
+000247d0: 735f 7072 6976 6174 650a 2020 2020 2020  s_private.      
+000247e0: 2020 7365 6c66 2e69 735f 6c69 6e6b 5f6c    self.is_link_l
+000247f0: 6f63 616c 203d 2069 735f 6c69 6e6b 5f6c  ocal = is_link_l
+00024800: 6f63 616c 0a20 2020 2020 2020 2073 656c  ocal.        sel
+00024810: 662e 6973 5f72 6573 6572 7665 6420 3d20  f.is_reserved = 
+00024820: 6973 5f72 6573 6572 7665 640a 2020 2020  is_reserved.    
+00024830: 2020 2020 7365 6c66 2e69 735f 6d75 6c74      self.is_mult
+00024840: 6963 6173 7420 3d20 6973 5f6d 756c 7469  icast = is_multi
+00024850: 6361 7374 0a20 2020 2020 2020 2073 656c  cast.        sel
+00024860: 662e 6973 5f72 6f75 7465 6162 6c65 203d  f.is_routeable =
+00024870: 2069 735f 726f 7574 6561 626c 650a 2020   is_routeable.  
+00024880: 2020 2020 2020 7365 6c66 2e69 735f 3674        self.is_6t
+00024890: 6f34 203d 2069 735f 3674 6f34 0a20 2020  o4 = is_6to4.   
+000248a0: 2020 2020 2073 656c 662e 6973 5f74 6572       self.is_ter
+000248b0: 6564 6f20 3d20 6973 5f74 6572 6564 6f0a  edo = is_teredo.
+000248c0: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+000248d0: 6e65 7473 203d 2073 7562 6e65 7473 0a20  nets = subnets. 
+000248e0: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
+000248f0: 725f 6d65 7373 6167 6520 3d20 6572 726f  r_message = erro
+00024900: 725f 6d65 7373 6167 650a 0a20 2020 2064  r_message..    d
+00024910: 6566 2076 616c 6964 6174 6528 7365 6c66  ef validate(self
+00024920: 2c20 7661 6c75 652c 2072 6563 6f72 645f  , value, record_
+00024930: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+00024940: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00024950: 2020 2069 7020 3d20 6970 6164 6472 6573     ip = ipaddres
+00024960: 732e 4950 7636 4164 6472 6573 7328 746f  s.IPv6Address(to
+00024970: 5f75 6e69 636f 6465 2876 616c 7565 2929  _unicode(value))
+00024980: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
+00024990: 3d20 5472 7565 0a20 2020 2020 2020 2065  = True.        e
+000249a0: 7863 6570 7420 6970 6164 6472 6573 732e  xcept ipaddress.
+000249b0: 4164 6472 6573 7356 616c 7565 4572 726f  AddressValueErro
+000249c0: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+000249d0: 6169 7365 2056 616c 6964 6174 696f 6e45  aise ValidationE
+000249e0: 7272 6f72 2873 656c 662e 7472 616e 736c  rror(self.transl
+000249f0: 6174 6f72 2873 656c 662e 6572 726f 725f  ator(self.error_
+00024a00: 6d65 7373 6167 6529 290a 0a20 2020 2020  message))..     
+00024a10: 2020 2069 6620 7365 6c66 2e73 7562 6e65     if self.subne
+00024a20: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00024a30: 2320 6974 6572 6174 6520 7468 726f 7567  # iterate throug
+00024a40: 6820 7365 6c66 2e73 7562 6e65 7473 2074  h self.subnets t
+00024a50: 6f20 7365 6520 6966 2076 616c 7565 2069  o see if value i
+00024a60: 7320 6120 6d65 6d62 6572 0a20 2020 2020  s a member.     
+00024a70: 2020 2020 2020 206f 6b20 3d20 4661 6c73         ok = Fals
+00024a80: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+00024a90: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00024aa0: 2e73 7562 6e65 7473 2c20 7374 7229 3a0a  .subnets, str):.
+00024ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ac0: 7365 6c66 2e73 7562 6e65 7473 203d 205b  self.subnets = [
+00024ad0: 7365 6c66 2e73 7562 6e65 7473 5d0a 2020  self.subnets].  
+00024ae0: 2020 2020 2020 2020 2020 666f 7220 6e65            for ne
+00024af0: 7477 6f72 6b20 696e 2073 656c 662e 7375  twork in self.su
+00024b00: 626e 6574 733a 0a20 2020 2020 2020 2020  bnets:.         
+00024b10: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00024b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b30: 6970 6e65 7420 3d20 6970 6164 6472 6573  ipnet = ipaddres
+00024b40: 732e 4950 7636 4e65 7477 6f72 6b28 746f  s.IPv6Network(to
+00024b50: 5f75 6e69 636f 6465 286e 6574 776f 726b  _unicode(network
+00024b60: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00024b70: 2020 2065 7863 6570 7420 2869 7061 6464     except (ipadd
+00024b80: 7265 7373 2e4e 6574 6d61 736b 5661 6c75  ress.NetmaskValu
+00024b90: 6545 7272 6f72 2c20 6970 6164 6472 6573  eError, ipaddres
+00024ba0: 732e 4164 6472 6573 7356 616c 7565 4572  s.AddressValueEr
+00024bb0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+00024bc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00024bd0: 5661 6c69 6461 7469 6f6e 4572 726f 7228  ValidationError(
+00024be0: 7365 6c66 2e74 7261 6e73 6c61 746f 7228  self.translator(
+00024bf0: 2269 6e76 616c 6964 2073 7562 6e65 7420  "invalid subnet 
+00024c00: 7072 6f76 6964 6564 2229 290a 2020 2020  provided")).    
+00024c10: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00024c20: 7020 696e 2069 706e 6574 3a0a 2020 2020  p in ipnet:.    
+00024c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024c40: 6f6b 203d 2054 7275 650a 0a20 2020 2020  ok = True..     
+00024c50: 2020 2069 6620 7365 6c66 2e69 735f 726f     if self.is_ro
+00024c60: 7574 6561 626c 653a 0a20 2020 2020 2020  uteable:.       
+00024c70: 2020 2020 2073 656c 662e 6973 5f70 7269       self.is_pri
+00024c80: 7661 7465 203d 2046 616c 7365 0a20 2020  vate = False.   
+00024c90: 2020 2020 2020 2020 2073 656c 662e 6973           self.is
+00024ca0: 5f72 6573 6572 7665 6420 3d20 4661 6c73  _reserved = Fals
+00024cb0: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
+00024cc0: 6c66 2e69 735f 6d75 6c74 6963 6173 7420  lf.is_multicast 
+00024cd0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+00024ce0: 2069 6620 6f6b 2061 6e64 2073 656c 662e   if ok and self.
+00024cf0: 6973 5f70 7269 7661 7465 2069 7320 6e6f  is_private is no
+00024d00: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+00024d10: 6973 5f70 7269 7661 7465 2021 3d20 6970  is_private != ip
+00024d20: 2e69 735f 7072 6976 6174 653a 0a20 2020  .is_private:.   
+00024d30: 2020 2020 2020 2020 206f 6b20 3d20 4661           ok = Fa
+00024d40: 6c73 650a 2020 2020 2020 2020 6966 2028  lse.        if (
+00024d50: 0a20 2020 2020 2020 2020 2020 206f 6b0a  .            ok.
+00024d60: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00024d70: 7365 6c66 2e69 735f 6c69 6e6b 5f6c 6f63  self.is_link_loc
+00024d80: 616c 2069 7320 6e6f 7420 4e6f 6e65 0a20  al is not None. 
+00024d90: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
+00024da0: 656c 662e 6973 5f6c 696e 6b5f 6c6f 6361  elf.is_link_loca
+00024db0: 6c20 213d 2069 702e 6973 5f6c 696e 6b5f  l != ip.is_link_
+00024dc0: 6c6f 6361 6c0a 2020 2020 2020 2020 293a  local.        ):
+00024dd0: 0a20 2020 2020 2020 2020 2020 206f 6b20  .            ok 
+00024de0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00024df0: 6966 206f 6b20 616e 6420 7365 6c66 2e69  if ok and self.i
+00024e00: 735f 7265 7365 7276 6564 2069 7320 6e6f  s_reserved is no
+00024e10: 7420 4e6f 6e65 2061 6e64 2073 656c 662e  t None and self.
+00024e20: 6973 5f72 6573 6572 7665 6420 213d 2069  is_reserved != i
+00024e30: 702e 6973 5f72 6573 6572 7665 643a 0a20  p.is_reserved:. 
+00024e40: 2020 2020 2020 2020 2020 206f 6b20 3d20             ok = 
+00024e50: 4661 6c73 650a 2020 2020 2020 2020 6966  False.        if
+00024e60: 2028 0a20 2020 2020 2020 2020 2020 206f   (.            o
+00024e70: 6b0a 2020 2020 2020 2020 2020 2020 616e  k.            an
+00024e80: 6420 7365 6c66 2e69 735f 6d75 6c74 6963  d self.is_multic
+00024e90: 6173 7420 6973 206e 6f74 204e 6f6e 650a  ast is not None.
+00024ea0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00024eb0: 7365 6c66 2e69 735f 6d75 6c74 6963 6173  self.is_multicas
+00024ec0: 7420 213d 2069 702e 6973 5f6d 756c 7469  t != ip.is_multi
+00024ed0: 6361 7374 0a20 2020 2020 2020 2029 3a0a  cast.        ):.
+00024ee0: 2020 2020 2020 2020 2020 2020 6f6b 203d              ok =
+00024ef0: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
+00024f00: 6620 6f6b 2061 6e64 2073 656c 662e 6973  f ok and self.is
+00024f10: 5f36 746f 3420 6973 206e 6f74 204e 6f6e  _6to4 is not Non
+00024f20: 6520 616e 6420 7365 6c66 2e69 735f 3674  e and self.is_6t
+00024f30: 6f34 2021 3d20 626f 6f6c 2869 702e 7369  o4 != bool(ip.si
+00024f40: 7874 6f66 6f75 7229 3a0a 2020 2020 2020  xtofour):.      
+00024f50: 2020 2020 2020 6f6b 203d 2046 616c 7365        ok = False
+00024f60: 0a20 2020 2020 2020 2069 6620 6f6b 2061  .        if ok a
+00024f70: 6e64 2073 656c 662e 6973 5f74 6572 6564  nd self.is_tered
+00024f80: 6f20 6973 206e 6f74 204e 6f6e 6520 616e  o is not None an
+00024f90: 6420 7365 6c66 2e69 735f 7465 7265 646f  d self.is_teredo
+00024fa0: 2021 3d20 626f 6f6c 2869 702e 7465 7265   != bool(ip.tere
+00024fb0: 646f 293a 0a20 2020 2020 2020 2020 2020  do):.           
+00024fc0: 206f 6b20 3d20 4661 6c73 650a 0a20 2020   ok = False..   
+00024fd0: 2020 2020 2069 6620 6f6b 3a0a 2020 2020       if ok:.    
+00024fe0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00024ff0: 616c 7565 0a0a 2020 2020 2020 2020 7261  alue..        ra
+00025000: 6973 6520 5661 6c69 6461 7469 6f6e 4572  ise ValidationEr
+00025010: 726f 7228 7365 6c66 2e74 7261 6e73 6c61  ror(self.transla
+00025020: 746f 7228 7365 6c66 2e65 7272 6f72 5f6d  tor(self.error_m
+00025030: 6573 7361 6765 2929 0a0a 0a63 6c61 7373  essage))...class
+00025040: 2049 535f 4950 4144 4452 4553 5328 5661   IS_IPADDRESS(Va
+00025050: 6c69 6461 746f 7229 3a0a 2020 2020 2222  lidator):.    ""
+00025060: 220a 2020 2020 4368 6563 6b73 2069 6620  ".    Checks if 
+00025070: 6669 656c 6427 7320 7661 6c75 6520 6973  field's value is
+00025080: 2061 6e20 4950 2041 6464 7265 7373 2028   an IP Address (
+00025090: 7634 206f 7220 7636 292e 2043 616e 2062  v4 or v6). Can b
+000250a0: 6520 7365 7420 746f 2066 6f72 6365 0a20  e set to force. 
+000250b0: 2020 2061 6464 7265 7373 6573 2066 726f     addresses fro
+000250c0: 6d20 7769 7468 696e 2061 2073 7065 6369  m within a speci
+000250d0: 6669 6320 7261 6e67 652e 2043 6865 636b  fic range. Check
+000250e0: 7320 6172 6520 646f 6e65 2077 6974 6820  s are done with 
+000250f0: 7468 6520 636f 7272 6563 740a 2020 2020  the correct.    
+00025100: 4953 5f49 5056 3420 616e 6420 4953 5f49  IS_IPV4 and IS_I
+00025110: 5056 3620 7661 6c69 6461 746f 7273 2e0a  PV6 validators..
+00025120: 0a20 2020 2055 7365 7320 7468 6520 6970  .    Uses the ip
+00025130: 6164 6472 6573 7320 6672 6f6d 2074 6865  address from the
+00025140: 2050 7974 686f 6e20 3320 7374 616e 6461   Python 3 standa
+00025150: 7264 206c 6962 7261 7279 0a20 2020 2061  rd library.    a
+00025160: 6e64 2069 7473 2050 7974 686f 6e20 3220  nd its Python 2 
+00025170: 6261 636b 706f 7274 2028 696e 2063 6f6e  backport (in con
+00025180: 7472 6962 2f69 7061 6464 7265 7373 2e70  trib/ipaddress.p
+00025190: 7929 2e0a 0a20 2020 2041 7267 733a 0a20  y)...    Args:. 
+000251a0: 2020 2020 2020 206d 696e 6970 3a20 6c6f         minip: lo
+000251b0: 7765 7374 2061 6c6c 6f77 6564 2061 6464  west allowed add
+000251c0: 7265 7373 3b20 6163 6365 7074 733a 0a20  ress; accepts:. 
+000251d0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+000251e0: 722c 2065 672e 2031 3932 2e31 3638 2e30  r, eg. 192.168.0
+000251f0: 2e31 0a20 2020 2020 2020 2020 2020 2020  .1.             
+00025200: 2020 6c69 7374 206f 7220 7475 706c 6520    list or tuple 
+00025210: 6f66 206f 6374 6574 732c 2065 672e 205b  of octets, eg. [
+00025220: 3139 322c 2031 3638 2c20 302c 2031 5d0a  192, 168, 0, 1].
+00025230: 2020 2020 2020 2020 6d61 7869 703a 2068          maxip: h
+00025240: 6967 6865 7374 2061 6c6c 6f77 6564 2061  ighest allowed a
+00025250: 6464 7265 7373 3b20 7361 6d65 2061 7320  ddress; same as 
+00025260: 6162 6f76 650a 2020 2020 2020 2020 696e  above.        in
+00025270: 7665 7274 3a20 5472 7565 2074 6f20 616c  vert: True to al
+00025280: 6c6f 7720 6164 6472 6573 7365 7320 6f6e  low addresses on
+00025290: 6c79 2066 726f 6d20 6f75 7473 6964 6520  ly from outside 
+000252a0: 6f66 2067 6976 656e 2072 616e 6765 3b20  of given range; 
+000252b0: 6e6f 7465 0a20 2020 2020 2020 2020 2020  note.           
+000252c0: 2020 2020 2074 6861 7420 7261 6e67 6520       that range 
+000252d0: 626f 756e 6461 7269 6573 2061 7265 206e  boundaries are n
+000252e0: 6f74 206d 6174 6368 6564 2074 6869 7320  ot matched this 
+000252f0: 7761 790a 0a20 2020 2049 5076 3420 7370  way..    IPv4 sp
+00025300: 6563 6966 6963 2061 7267 756d 656e 7473  ecific arguments
+00025310: 3a0a 0a20 2020 2020 2020 202d 2069 735f  :..        - is_
+00025320: 6c6f 6361 6c68 6f73 743a 206c 6f63 616c  localhost: local
+00025330: 686f 7374 2061 6464 7265 7373 2074 7265  host address tre
+00025340: 6174 6d65 6e74 3a0a 0a20 2020 2020 2020  atment:..       
+00025350: 2020 2020 202d 204e 6f6e 6520 2864 6566       - None (def
+00025360: 6175 6c74 293a 2069 6e64 6966 6665 7265  ault): indiffere
+00025370: 6e74 0a20 2020 2020 2020 2020 2020 202d  nt.            -
+00025380: 2054 7275 6520 2865 6e66 6f72 6365 293a   True (enforce):
+00025390: 2071 7565 7279 2061 6464 7265 7373 206d   query address m
+000253a0: 7573 7420 6d61 7463 6820 6c6f 6361 6c68  ust match localh
+000253b0: 6f73 7420 6164 6472 6573 730a 2020 2020  ost address.    
+000253c0: 2020 2020 2020 2020 2020 2831 3237 2e30            (127.0
+000253d0: 2e30 2e31 290a 2020 2020 2020 2020 2020  .0.1).          
+000253e0: 2020 2d20 4661 6c73 6520 2866 6f72 6269    - False (forbi
+000253f0: 6429 3a20 7175 6572 7920 6164 6472 6573  d): query addres
+00025400: 7320 6d75 7374 206e 6f74 206d 6174 6368  s must not match
+00025410: 206c 6f63 616c 686f 7374 2061 6464 7265   localhost addre
+00025420: 7373 0a20 2020 2020 2020 202d 2069 735f  ss.        - is_
+00025430: 7072 6976 6174 653a 2073 616d 6520 6173  private: same as
+00025440: 2061 626f 7665 2c20 6578 6365 7074 2074   above, except t
+00025450: 6861 7420 7175 6572 7920 6164 6472 6573  hat query addres
+00025460: 7320 6973 2063 6865 636b 6564 2061 6761  s is checked aga
+00025470: 696e 7374 0a20 2020 2020 2020 2020 2074  inst.          t
+00025480: 776f 2061 6464 7265 7373 2072 616e 6765  wo address range
+00025490: 733a 2031 3732 2e31 362e 302e 3020 2d20  s: 172.16.0.0 - 
+000254a0: 3137 322e 3331 2e32 3535 2e32 3535 2061  172.31.255.255 a
+000254b0: 6e64 0a20 2020 2020 2020 2020 2031 3932  nd.          192
+000254c0: 2e31 3638 2e30 2e30 202d 2031 3932 2e31  .168.0.0 - 192.1
+000254d0: 3638 2e32 3535 2e32 3535 0a20 2020 2020  68.255.255.     
+000254e0: 2020 202d 2069 735f 6175 746f 6d61 7469     - is_automati
+000254f0: 633a 2073 616d 6520 6173 2061 626f 7665  c: same as above
+00025500: 2c20 6578 6365 7074 2074 6861 7420 7175  , except that qu
+00025510: 6572 7920 6164 6472 6573 7320 6973 2063  ery address is c
+00025520: 6865 636b 6564 2061 6761 696e 7374 0a20  hecked against. 
+00025530: 2020 2020 2020 2020 206f 6e65 2061 6464           one add
+00025540: 7265 7373 2072 616e 6765 3a20 3136 392e  ress range: 169.
+00025550: 3235 342e 302e 3020 2d20 3136 392e 3235  254.0.0 - 169.25
+00025560: 342e 3235 352e 3235 350a 2020 2020 2020  4.255.255.      
+00025570: 2020 2d20 6973 5f69 7076 343a 2065 6974    - is_ipv4: eit
+00025580: 6865 723a 0a0a 2020 2020 2020 2020 2020  her:..          
+00025590: 2020 2d20 4e6f 6e65 2028 6465 6661 756c    - None (defaul
+000255a0: 7429 3a20 696e 6469 6666 6572 656e 740a  t): indifferent.
+000255b0: 2020 2020 2020 2020 2020 2020 2d20 5472              - Tr
+000255c0: 7565 2028 656e 666f 7263 6529 3a20 6d75  ue (enforce): mu
+000255d0: 7374 2062 6520 616e 2049 5076 3420 6164  st be an IPv4 ad
+000255e0: 6472 6573 730a 2020 2020 2020 2020 2020  dress.          
+000255f0: 2020 2d20 4661 6c73 6520 2866 6f72 6269    - False (forbi
+00025600: 6429 3a20 6d75 7374 204e 4f54 2062 6520  d): must NOT be 
+00025610: 616e 2049 5076 3420 6164 6472 6573 730a  an IPv4 address.
+00025620: 0a20 2020 2049 5076 3620 7370 6563 6966  .    IPv6 specif
+00025630: 6963 2061 7267 756d 656e 7473 3a0a 0a20  ic arguments:.. 
+00025640: 2020 2020 2020 202d 2069 735f 6c69 6e6b         - is_link
+00025650: 5f6c 6f63 616c 3a20 5361 6d65 2061 7320  _local: Same as 
+00025660: 6162 6f76 6520 6275 7420 7573 6573 2066  above but uses f
+00025670: 6538 303a 3a2f 3130 2072 616e 6765 0a20  e80::/10 range. 
+00025680: 2020 2020 2020 202d 2069 735f 7265 7365         - is_rese
+00025690: 7276 6564 3a20 5361 6d65 2061 7320 6162  rved: Same as ab
+000256a0: 6f76 6520 6275 7420 7573 6573 2049 4554  ove but uses IET
+000256b0: 4620 7265 7365 7276 6564 2072 616e 6765  F reserved range
+000256c0: 0a20 2020 2020 2020 202d 2069 735f 6d75  .        - is_mu
+000256d0: 6c74 6963 6173 743a 2053 616d 6520 6173  lticast: Same as
+000256e0: 2061 626f 7665 2062 7574 2075 7365 7320   above but uses 
+000256f0: 6666 3030 3a3a 2f38 2072 616e 6765 0a20  ff00::/8 range. 
+00025700: 2020 2020 2020 202d 2069 735f 726f 7574         - is_rout
+00025710: 6561 626c 653a 2053 696d 696c 6172 2074  eable: Similar t
+00025720: 6f20 6162 6f76 6520 6275 7420 656e 666f  o above but enfo
+00025730: 7263 6573 206e 6f74 2070 7269 7661 7465  rces not private
+00025740: 2c20 6c69 6e6b 5f6c 6f63 616c 2c0a 2020  , link_local,.  
+00025750: 2020 2020 2020 2020 7265 7365 7276 6564          reserved
+00025760: 206f 7220 6d75 6c74 6963 6173 740a 2020   or multicast.  
+00025770: 2020 2020 2020 2d20 6973 5f36 746f 343a        - is_6to4:
+00025780: 2053 616d 6520 6173 2061 626f 7665 2062   Same as above b
+00025790: 7574 2075 7365 7320 3230 3032 3a3a 2f31  ut uses 2002::/1
+000257a0: 3620 7261 6e67 650a 2020 2020 2020 2020  6 range.        
+000257b0: 2d20 6973 5f74 6572 6564 6f3a 2053 616d  - is_teredo: Sam
+000257c0: 6520 6173 2061 626f 7665 2062 7574 2075  e as above but u
+000257d0: 7365 7320 3230 3031 3a3a 2f33 3220 7261  ses 2001::/32 ra
+000257e0: 6e67 650a 2020 2020 2020 2020 2d20 7375  nge.        - su
+000257f0: 626e 6574 733a 2076 616c 7565 206d 7573  bnets: value mus
+00025800: 7420 6265 2061 206d 656d 6265 7220 6f66  t be a member of
+00025810: 2061 7420 6c65 6173 7420 6f6e 6520 6672   at least one fr
+00025820: 6f6d 206c 6973 7420 6f66 2073 7562 6e65  om list of subne
+00025830: 7473 0a20 2020 2020 2020 202d 2069 735f  ts.        - is_
+00025840: 6970 7636 3a20 6569 7468 6572 3a0a 0a20  ipv6: either:.. 
+00025850: 2020 2020 2020 2020 2020 202d 204e 6f6e             - Non
+00025860: 6520 2864 6566 6175 6c74 293a 2069 6e64  e (default): ind
+00025870: 6966 6665 7265 6e74 0a20 2020 2020 2020  ifferent.       
+00025880: 2020 2020 202d 2054 7275 6520 2865 6e66       - True (enf
+00025890: 6f72 6365 293a 206d 7573 7420 6265 2061  orce): must be a
+000258a0: 6e20 4950 7636 2061 6464 7265 7373 0a20  n IPv6 address. 
+000258b0: 2020 2020 2020 2020 2020 202d 2046 616c             - Fal
+000258c0: 7365 2028 666f 7262 6964 293a 206d 7573  se (forbid): mus
+000258d0: 7420 4e4f 5420 6265 2061 6e20 4950 7636  t NOT be an IPv6
+000258e0: 2061 6464 7265 7373 0a0a 2020 2020 4d69   address..    Mi
+000258f0: 6e69 7020 616e 6420 6d61 7869 7020 6d61  nip and maxip ma
+00025900: 7920 616c 736f 2062 6520 6c69 7374 7320  y also be lists 
+00025910: 6f72 2074 7570 6c65 7320 6f66 2061 6464  or tuples of add
+00025920: 7265 7373 6573 2069 6e20 616c 6c20 6162  resses in all ab
+00025930: 6f76 650a 2020 2020 666f 726d 7320 2873  ove.    forms (s
+00025940: 7472 2c20 696e 742c 206c 6973 7420 2f20  tr, int, list / 
+00025950: 7475 706c 6529 2c20 616c 6c6f 7769 6e67  tuple), allowing
+00025960: 2073 6574 7570 206f 6620 6d75 6c74 6970   setup of multip
+00025970: 6c65 2061 6464 7265 7373 2072 616e 6765  le address range
+00025980: 733a 3a0a 0a20 2020 2020 2020 206d 696e  s::..        min
+00025990: 6970 203d 2028 6d69 6e69 7031 2c20 6d69  ip = (minip1, mi
+000259a0: 6e69 7032 2c20 2e2e 2e20 6d69 6e69 704e  nip2, ... minipN
+000259b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000259c0: 2020 2020 207c 2020 2020 2020 207c 2020       |       |  
+000259d0: 2020 2020 2020 2020 207c 0a20 2020 2020           |.     
+000259e0: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+000259f0: 2020 2020 2020 7c20 2020 2020 2020 2020        |         
+00025a00: 2020 7c0a 2020 2020 2020 2020 6d61 7869    |.        maxi
+00025a10: 7020 3d20 286d 6178 6970 312c 206d 6178  p = (maxip1, max
+00025a20: 6970 322c 202e 2e2e 206d 6178 6970 4e29  ip2, ... maxipN)
+00025a30: 0a0a 2020 2020 4c6f 6e67 6572 2069 7465  ..    Longer ite
+00025a40: 7261 626c 6520 7769 6c6c 2062 6520 7472  rable will be tr
+00025a50: 756e 6361 7465 6420 746f 206d 6174 6368  uncated to match
+00025a60: 206c 656e 6774 6820 6f66 2073 686f 7274   length of short
+00025a70: 6572 206f 6e65 2e0a 0a20 2020 2020 2020  er one...       
+00025a80: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+00025a90: 5328 2928 2731 3932 2e31 3638 2e31 2e35  S()('192.168.1.5
+00025aa0: 2729 0a20 2020 2020 2020 2028 2731 3932  ').        ('192
+00025ab0: 2e31 3638 2e31 2e35 272c 204e 6f6e 6529  .168.1.5', None)
+00025ac0: 0a20 2020 2020 2020 203e 3e3e 2049 535f  .        >>> IS_
+00025ad0: 4950 4144 4452 4553 5328 6973 5f69 7076  IPADDRESS(is_ipv
+00025ae0: 363d 4661 6c73 6529 2827 3139 322e 3136  6=False)('192.16
+00025af0: 382e 312e 3527 290a 2020 2020 2020 2020  8.1.5').        
+00025b00: 2827 3139 322e 3136 382e 312e 3527 2c20  ('192.168.1.5', 
+00025b10: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00025b20: 3e20 4953 5f49 5041 4444 5245 5353 2829  > IS_IPADDRESS()
+00025b30: 2827 3235 352e 3235 352e 3235 352e 3235  ('255.255.255.25
+00025b40: 3527 290a 2020 2020 2020 2020 2827 3235  5').        ('25
+00025b50: 352e 3235 352e 3235 352e 3235 3527 2c20  5.255.255.255', 
+00025b60: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00025b70: 3e20 4953 5f49 5041 4444 5245 5353 2829  > IS_IPADDRESS()
+00025b80: 2827 3139 322e 3136 382e 312e 3520 2729  ('192.168.1.5 ')
+00025b90: 0a20 2020 2020 2020 2028 2731 3932 2e31  .        ('192.1
+00025ba0: 3638 2e31 2e35 2027 2c20 2765 6e74 6572  68.1.5 ', 'enter
+00025bb0: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025bc0: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+00025bd0: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+00025be0: 3139 322e 3136 382e 312e 312e 3527 290a  192.168.1.1.5').
+00025bf0: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00025c00: 382e 312e 312e 3527 2c20 2765 6e74 6572  8.1.1.5', 'enter
+00025c10: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025c20: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+00025c30: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+00025c40: 3132 332e 3132 3327 290a 2020 2020 2020  123.123').      
+00025c50: 2020 2827 3132 332e 3132 3327 2c20 2765    ('123.123', 'e
+00025c60: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
+00025c70: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
+00025c80: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+00025c90: 2829 2827 3131 3131 2e32 2e33 2e34 2729  ()('1111.2.3.4')
+00025ca0: 0a20 2020 2020 2020 2028 2731 3131 312e  .        ('1111.
+00025cb0: 322e 332e 3427 2c20 2765 6e74 6572 2076  2.3.4', 'enter v
+00025cc0: 616c 6964 2049 5020 6164 6472 6573 7327  alid IP address'
+00025cd0: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00025ce0: 5f49 5041 4444 5245 5353 2829 2827 3031  _IPADDRESS()('01
+00025cf0: 3131 2e32 2e33 2e34 2729 0a20 2020 2020  11.2.3.4').     
+00025d00: 2020 2028 2730 3131 312e 322e 332e 3427     ('0111.2.3.4'
+00025d10: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+00025d20: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
+00025d30: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
+00025d40: 5245 5353 2829 2827 3235 362e 322e 332e  RESS()('256.2.3.
+00025d50: 3427 290a 2020 2020 2020 2020 2827 3235  4').        ('25
+00025d60: 362e 322e 332e 3427 2c20 2765 6e74 6572  6.2.3.4', 'enter
+00025d70: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00025d80: 7327 290a 2020 2020 2020 2020 3e3e 3e20  s').        >>> 
+00025d90: 4953 5f49 5041 4444 5245 5353 2829 2827  IS_IPADDRESS()('
+00025da0: 3330 302e 322e 332e 3427 290a 2020 2020  300.2.3.4').    
+00025db0: 2020 2020 2827 3330 302e 322e 332e 3427      ('300.2.3.4'
+00025dc0: 2c20 2765 6e74 6572 2076 616c 6964 2049  , 'enter valid I
+00025dd0: 5020 6164 6472 6573 7327 290a 2020 2020  P address').    
+00025de0: 2020 2020 3e3e 3e20 4953 5f49 5041 4444      >>> IS_IPADD
+00025df0: 5245 5353 286d 696e 6970 3d27 3139 322e  RESS(minip='192.
+00025e00: 3136 382e 312e 3027 2c20 6d61 7869 703d  168.1.0', maxip=
+00025e10: 2731 3932 2e31 3638 2e31 2e32 3535 2729  '192.168.1.255')
+00025e20: 2827 3139 322e 3136 382e 312e 3130 3027  ('192.168.1.100'
+00025e30: 290a 2020 2020 2020 2020 2827 3139 322e  ).        ('192.
+00025e40: 3136 382e 312e 3130 3027 2c20 4e6f 6e65  168.1.100', None
+00025e50: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00025e60: 5f49 5041 4444 5245 5353 286d 696e 6970  _IPADDRESS(minip
+00025e70: 3d27 312e 322e 332e 3527 2c20 6d61 7869  ='1.2.3.5', maxi
+00025e80: 703d 2731 2e32 2e33 2e39 272c 2065 7272  p='1.2.3.9', err
+00025e90: 6f72 5f6d 6573 7361 6765 3d27 4261 6420  or_message='Bad 
+00025ea0: 6970 2729 2827 312e 322e 332e 3427 290a  ip')('1.2.3.4').
+00025eb0: 2020 2020 2020 2020 2827 312e 322e 332e          ('1.2.3.
+00025ec0: 3427 2c20 2762 6164 2069 7027 290a 2020  4', 'bad ip').  
+00025ed0: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+00025ee0: 4444 5245 5353 286d 6178 6970 3d27 312e  DDRESS(maxip='1.
+00025ef0: 322e 332e 3427 2c20 696e 7665 7274 3d54  2.3.4', invert=T
+00025f00: 7275 6529 2827 3132 372e 302e 302e 3127  rue)('127.0.0.1'
+00025f10: 290a 2020 2020 2020 2020 2827 3132 372e  ).        ('127.
+00025f20: 302e 302e 3127 2c20 4e6f 6e65 290a 2020  0.0.1', None).  
+00025f30: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+00025f40: 4444 5245 5353 286d 6178 6970 3d27 3139  DDRESS(maxip='19
+00025f50: 322e 3136 382e 312e 3427 2c20 696e 7665  2.168.1.4', inve
+00025f60: 7274 3d54 7275 6529 2827 3139 322e 3136  rt=True)('192.16
+00025f70: 382e 312e 3427 290a 2020 2020 2020 2020  8.1.4').        
+00025f80: 2827 3139 322e 3136 382e 312e 3427 2c20  ('192.168.1.4', 
+00025f90: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
+00025fa0: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00025fb0: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+00025fc0: 5353 2869 735f 6c6f 6361 6c68 6f73 743d  SS(is_localhost=
+00025fd0: 5472 7565 2928 2731 3237 2e30 2e30 2e31  True)('127.0.0.1
+00025fe0: 2729 0a20 2020 2020 2020 2028 2731 3237  ').        ('127
+00025ff0: 2e30 2e30 2e31 272c 204e 6f6e 6529 0a20  .0.0.1', None). 
+00026000: 2020 2020 2020 203e 3e3e 2049 535f 4950         >>> IS_IP
+00026010: 4144 4452 4553 5328 6973 5f6c 6f63 616c  ADDRESS(is_local
+00026020: 686f 7374 3d54 7275 6529 2827 3139 322e  host=True)('192.
+00026030: 3136 382e 312e 3130 2729 0a20 2020 2020  168.1.10').     
+00026040: 2020 2028 2731 3932 2e31 3638 2e31 2e31     ('192.168.1.1
+00026050: 3027 2c20 2765 6e74 6572 2076 616c 6964  0', 'enter valid
+00026060: 2049 5020 6164 6472 6573 7327 290a 2020   IP address').  
+00026070: 2020 2020 2020 3e3e 3e20 4953 5f49 5041        >>> IS_IPA
+00026080: 4444 5245 5353 2869 735f 6c6f 6361 6c68  DDRESS(is_localh
+00026090: 6f73 743d 4661 6c73 6529 2827 3132 372e  ost=False)('127.
+000260a0: 302e 302e 3127 290a 2020 2020 2020 2020  0.0.1').        
+000260b0: 2827 3132 372e 302e 302e 3127 2c20 2765  ('127.0.0.1', 'e
+000260c0: 6e74 6572 2076 616c 6964 2049 5020 6164  nter valid IP ad
+000260d0: 6472 6573 7327 290a 2020 2020 2020 2020  dress').        
+000260e0: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+000260f0: 286d 6178 6970 3d27 3130 302e 302e 302e  (maxip='100.0.0.
+00026100: 3027 2c20 6973 5f6c 6f63 616c 686f 7374  0', is_localhost
+00026110: 3d54 7275 6529 2827 3132 372e 302e 302e  =True)('127.0.0.
+00026120: 3127 290a 2020 2020 2020 2020 2827 3132  1').        ('12
+00026130: 372e 302e 302e 3127 2c20 2765 6e74 6572  7.0.0.1', 'enter
+00026140: 2076 616c 6964 2049 5020 6164 6472 6573   valid IP addres
+00026150: 7327 290a 0a20 2020 2020 2020 203e 3e3e  s')..        >>>
+00026160: 2049 535f 4950 4144 4452 4553 5328 2928   IS_IPADDRESS()(
+00026170: 2766 6538 303a 3a31 3236 633a 3866 6661  'fe80::126c:8ffa
+00026180: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
+00026190: 2020 2020 2028 2766 6538 303a 3a31 3236       ('fe80::126
+000261a0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+000261b0: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
+000261c0: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+000261d0: 5328 6973 5f69 7076 343d 4661 6c73 6529  S(is_ipv4=False)
+000261e0: 2827 6665 3830 3a3a 3132 3663 3a38 6666  ('fe80::126c:8ff
+000261f0: 613a 6665 3232 3a62 3361 6627 290a 2020  a:fe22:b3af').  
+00026200: 2020 2020 2020 2827 6665 3830 3a3a 3132        ('fe80::12
+00026210: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+00026220: 6627 2c20 4e6f 6e65 290a 2020 2020 2020  f', None).      
+00026230: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+00026240: 5353 2829 2827 6665 3830 3a3a 3132 3663  SS()('fe80::126c
+00026250: 3a38 6666 613a 6665 3232 3a62 3361 6620  :8ffa:fe22:b3af 
+00026260: 2027 290a 2020 2020 2020 2020 2827 6665   ').        ('fe
+00026270: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
+00026280: 3232 3a62 3361 6620 2027 2c20 2765 6e74  22:b3af  ', 'ent
+00026290: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+000262a0: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+000262b0: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
+000262c0: 735f 6970 7634 3d54 7275 6529 2827 6665  s_ipv4=True)('fe
+000262d0: 3830 3a3a 3132 3663 3a38 6666 613a 6665  80::126c:8ffa:fe
+000262e0: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
+000262f0: 2020 2827 6665 3830 3a3a 3132 3663 3a38    ('fe80::126c:8
+00026300: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
+00026310: 2765 6e74 6572 2076 616c 6964 2049 5020  'enter valid IP 
+00026320: 6164 6472 6573 7327 290a 2020 2020 2020  address').      
+00026330: 2020 3e3e 3e20 4953 5f49 5041 4444 5245    >>> IS_IPADDRE
+00026340: 5353 2869 735f 6970 7636 3d54 7275 6529  SS(is_ipv6=True)
+00026350: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
+00026360: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+00026370: 382e 312e 3127 2c20 2765 6e74 6572 2076  8.1.1', 'enter v
+00026380: 616c 6964 2049 5020 6164 6472 6573 7327  alid IP address'
+00026390: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+000263a0: 5f49 5041 4444 5245 5353 2869 735f 6970  _IPADDRESS(is_ip
+000263b0: 7636 3d54 7275 652c 2065 7272 6f72 5f6d  v6=True, error_m
+000263c0: 6573 7361 6765 3d27 4261 6420 6970 2729  essage='Bad ip')
+000263d0: 2827 3139 322e 3136 382e 312e 3127 290a  ('192.168.1.1').
+000263e0: 2020 2020 2020 2020 2827 3139 322e 3136          ('192.16
+000263f0: 382e 312e 3127 2c20 2762 6164 2069 7027  8.1.1', 'bad ip'
+00026400: 290a 2020 2020 2020 2020 3e3e 3e20 4953  ).        >>> IS
+00026410: 5f49 5041 4444 5245 5353 2869 735f 6c69  _IPADDRESS(is_li
+00026420: 6e6b 5f6c 6f63 616c 3d54 7275 6529 2827  nk_local=True)('
+00026430: 6665 3830 3a3a 3132 3663 3a38 6666 613a  fe80::126c:8ffa:
+00026440: 6665 3232 3a62 3361 6627 290a 2020 2020  fe22:b3af').    
+00026450: 2020 2020 2827 6665 3830 3a3a 3132 3663      ('fe80::126c
+00026460: 3a38 6666 613a 6665 3232 3a62 3361 6627  :8ffa:fe22:b3af'
+00026470: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+00026480: 3e3e 3e20 4953 5f49 5041 4444 5245 5353  >>> IS_IPADDRESS
+00026490: 2869 735f 6c69 6e6b 5f6c 6f63 616c 3d46  (is_link_local=F
+000264a0: 616c 7365 2928 2766 6538 303a 3a31 3236  alse)('fe80::126
+000264b0: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+000264c0: 2729 0a20 2020 2020 2020 2028 2766 6538  ').        ('fe8
+000264d0: 303a 3a31 3236 633a 3866 6661 3a66 6532  0::126c:8ffa:fe2
+000264e0: 323a 6233 6166 272c 2027 656e 7465 7220  2:b3af', 'enter 
+000264f0: 7661 6c69 6420 4950 2061 6464 7265 7373  valid IP address
+00026500: 2729 0a20 2020 2020 2020 203e 3e3e 2049  ').        >>> I
+00026510: 535f 4950 4144 4452 4553 5328 6973 5f6c  S_IPADDRESS(is_l
+00026520: 696e 6b5f 6c6f 6361 6c3d 5472 7565 2928  ink_local=True)(
+00026530: 2732 3030 313a 3a31 3236 633a 3866 6661  '2001::126c:8ffa
+00026540: 3a66 6532 323a 6233 6166 2729 0a20 2020  :fe22:b3af').   
+00026550: 2020 2020 2028 2732 3030 313a 3a31 3236       ('2001::126
+00026560: 633a 3866 6661 3a66 6532 323a 6233 6166  c:8ffa:fe22:b3af
+00026570: 272c 2027 656e 7465 7220 7661 6c69 6420  ', 'enter valid 
+00026580: 4950 2061 6464 7265 7373 2729 0a20 2020  IP address').   
+00026590: 2020 2020 203e 3e3e 2049 535f 4950 4144       >>> IS_IPAD
+000265a0: 4452 4553 5328 6973 5f6d 756c 7469 6361  DRESS(is_multica
+000265b0: 7374 3d54 7275 6529 2827 3230 3031 3a3a  st=True)('2001::
+000265c0: 3132 3663 3a38 6666 613a 6665 3232 3a62  126c:8ffa:fe22:b
+000265d0: 3361 6627 290a 2020 2020 2020 2020 2827  3af').        ('
+000265e0: 3230 3031 3a3a 3132 3663 3a38 6666 613a  2001::126c:8ffa:
+000265f0: 6665 3232 3a62 3361 6627 2c20 2765 6e74  fe22:b3af', 'ent
+00026600: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+00026610: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+00026620: 3e20 4953 5f49 5041 4444 5245 5353 2869  > IS_IPADDRESS(i
+00026630: 735f 6d75 6c74 6963 6173 743d 5472 7565  s_multicast=True
+00026640: 2928 2766 6630 303a 3a31 3236 633a 3866  )('ff00::126c:8f
+00026650: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
+00026660: 2020 2020 2020 2028 2766 6630 303a 3a31         ('ff00::1
+00026670: 3236 633a 3866 6661 3a66 6532 323a 6233  26c:8ffa:fe22:b3
+00026680: 6166 272c 204e 6f6e 6529 0a20 2020 2020  af', None).     
+00026690: 2020 203e 3e3e 2049 535f 4950 4144 4452     >>> IS_IPADDR
+000266a0: 4553 5328 6973 5f72 6f75 7465 6162 6c65  ESS(is_routeable
+000266b0: 3d54 7275 6529 2827 3230 3031 3a3a 3132  =True)('2001::12
+000266c0: 3663 3a38 6666 613a 6665 3232 3a62 3361  6c:8ffa:fe22:b3a
+000266d0: 6627 290a 2020 2020 2020 2020 2827 3230  f').        ('20
+000266e0: 3031 3a3a 3132 3663 3a38 6666 613a 6665  01::126c:8ffa:fe
+000266f0: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+00026700: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00026710: 5041 4444 5245 5353 2869 735f 726f 7574  PADDRESS(is_rout
+00026720: 6561 626c 653d 5472 7565 2928 2766 6630  eable=True)('ff0
+00026730: 303a 3a31 3236 633a 3866 6661 3a66 6532  0::126c:8ffa:fe2
+00026740: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+00026750: 2028 2766 6630 303a 3a31 3236 633a 3866   ('ff00::126c:8f
+00026760: 6661 3a66 6532 323a 6233 6166 272c 2027  fa:fe22:b3af', '
+00026770: 656e 7465 7220 7661 6c69 6420 4950 2061  enter valid IP a
+00026780: 6464 7265 7373 2729 0a20 2020 2020 2020  ddress').       
+00026790: 203e 3e3e 2049 535f 4950 4144 4452 4553   >>> IS_IPADDRES
+000267a0: 5328 7375 626e 6574 733d 2732 3030 313a  S(subnets='2001:
+000267b0: 3a2f 3332 2729 2827 3230 3031 3a3a 3866  :/32')('2001::8f
+000267c0: 6661 3a66 6532 323a 6233 6166 2729 0a20  fa:fe22:b3af'). 
+000267d0: 2020 2020 2020 2028 2732 3030 313a 3a38         ('2001::8
+000267e0: 6666 613a 6665 3232 3a62 3361 6627 2c20  ffa:fe22:b3af', 
+000267f0: 4e6f 6e65 290a 2020 2020 2020 2020 3e3e  None).        >>
+00026800: 3e20 4953 5f49 5041 4444 5245 5353 2873  > IS_IPADDRESS(s
+00026810: 7562 6e65 7473 3d27 6662 3030 3a3a 2f38  ubnets='fb00::/8
+00026820: 2729 2827 3230 3031 3a3a 3866 6661 3a66  ')('2001::8ffa:f
+00026830: 6532 323a 6233 6166 2729 0a20 2020 2020  e22:b3af').     
+00026840: 2020 2028 2732 3030 313a 3a38 6666 613a     ('2001::8ffa:
+00026850: 6665 3232 3a62 3361 6627 2c20 2765 6e74  fe22:b3af', 'ent
+00026860: 6572 2076 616c 6964 2049 5020 6164 6472  er valid IP addr
+00026870: 6573 7327 290a 2020 2020 2020 2020 3e3e  ess').        >>
+00026880: 3e20 4953 5f49 5041 4444 5245 5353 2873  > IS_IPADDRESS(s
+00026890: 7562 6e65 7473 3d5b 2766 6330 303a 3a2f  ubnets=['fc00::/
+000268a0: 3827 2c27 3230 3031 3a3a 2f33 3227 5d29  8','2001::/32'])
+000268b0: 2827 3230 3031 3a3a 3866 6661 3a66 6532  ('2001::8ffa:fe2
+000268c0: 323a 6233 6166 2729 0a20 2020 2020 2020  2:b3af').       
+000268d0: 2028 2732 3030 313a 3a38 6666 613a 6665   ('2001::8ffa:fe
+000268e0: 3232 3a62 3361 6627 2c20 4e6f 6e65 290a  22:b3af', None).
+000268f0: 2020 2020 2020 2020 3e3e 3e20 4953 5f49          >>> IS_I
+00026900: 5041 4444 5245 5353 2873 7562 6e65 7473  PADDRESS(subnets
+00026910: 3d27 696e 7661 6c69 6473 7562 6e65 7427  ='invalidsubnet'
+00026920: 2928 2732 3030 313a 3a38 6666 613a 6665  )('2001::8ffa:fe
+00026930: 3232 3a62 3361 6627 290a 2020 2020 2020  22:b3af').      
+00026940: 2020 2827 3230 3031 3a3a 3866 6661 3a66    ('2001::8ffa:f
+00026950: 6532 323a 6233 6166 272c 2027 696e 7661  e22:b3af', 'inva
+00026960: 6c69 6420 7375 626e 6574 2070 726f 7669  lid subnet provi
+00026970: 6465 6427 290a 2020 2020 2222 220a 0a20  ded').    """.. 
+00026980: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00026990: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000269a0: 2020 2020 2020 206d 696e 6970 3d22 302e         minip="0.
+000269b0: 302e 302e 3022 2c0a 2020 2020 2020 2020  0.0.0",.        
+000269c0: 6d61 7869 703d 2232 3535 2e32 3535 2e32  maxip="255.255.2
+000269d0: 3535 2e32 3535 222c 0a20 2020 2020 2020  55.255",.       
+000269e0: 2069 6e76 6572 743d 4661 6c73 652c 0a20   invert=False,. 
+000269f0: 2020 2020 2020 2069 735f 6c6f 6361 6c68         is_localh
+00026a00: 6f73 743d 4e6f 6e65 2c0a 2020 2020 2020  ost=None,.      
+00026a10: 2020 6973 5f70 7269 7661 7465 3d4e 6f6e    is_private=Non
+00026a20: 652c 0a20 2020 2020 2020 2069 735f 6175  e,.        is_au
+00026a30: 746f 6d61 7469 633d 4e6f 6e65 2c0a 2020  tomatic=None,.  
+00026a40: 2020 2020 2020 6973 5f69 7076 343d 4e6f        is_ipv4=No
+00026a50: 6e65 2c0a 2020 2020 2020 2020 6973 5f6c  ne,.        is_l
+00026a60: 696e 6b5f 6c6f 6361 6c3d 4e6f 6e65 2c0a  ink_local=None,.
+00026a70: 2020 2020 2020 2020 6973 5f72 6573 6572          is_reser
+00026a80: 7665 643d 4e6f 6e65 2c0a 2020 2020 2020  ved=None,.      
+00026a90: 2020 6973 5f6d 756c 7469 6361 7374 3d4e    is_multicast=N
+00026aa0: 6f6e 652c 0a20 2020 2020 2020 2069 735f  one,.        is_
+00026ab0: 726f 7574 6561 626c 653d 4e6f 6e65 2c0a  routeable=None,.
+00026ac0: 2020 2020 2020 2020 6973 5f36 746f 343d          is_6to4=
+00026ad0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6973  None,.        is
+00026ae0: 5f74 6572 6564 6f3d 4e6f 6e65 2c0a 2020  _teredo=None,.  
+00026af0: 2020 2020 2020 7375 626e 6574 733d 4e6f        subnets=No
+00026b00: 6e65 2c0a 2020 2020 2020 2020 6973 5f69  ne,.        is_i
+00026b10: 7076 363d 4e6f 6e65 2c0a 2020 2020 2020  pv6=None,.      
+00026b20: 2020 6572 726f 725f 6d65 7373 6167 653d    error_message=
+00026b30: 2245 6e74 6572 2076 616c 6964 2049 5020  "Enter valid IP 
+00026b40: 6164 6472 6573 7322 2c0a 2020 2020 293a  address",.    ):
+00026b50: 0a20 2020 2020 2020 2073 656c 662e 6d69  .        self.mi
+00026b60: 6e69 7020 3d20 286d 696e 6970 2c29 0a20  nip = (minip,). 
+00026b70: 2020 2020 2020 2073 656c 662e 6d61 7869         self.maxi
+00026b80: 7020 3d20 286d 6178 6970 2c29 0a20 2020  p = (maxip,).   
+00026b90: 2020 2020 2073 656c 662e 696e 7665 7274       self.invert
+00026ba0: 203d 2069 6e76 6572 740a 2020 2020 2020   = invert.      
+00026bb0: 2020 7365 6c66 2e69 735f 6c6f 6361 6c68    self.is_localh
+00026bc0: 6f73 7420 3d20 6973 5f6c 6f63 616c 686f  ost = is_localho
+00026bd0: 7374 0a20 2020 2020 2020 2073 656c 662e  st.        self.
+00026be0: 6973 5f70 7269 7661 7465 203d 2069 735f  is_private = is_
+00026bf0: 7072 6976 6174 650a 2020 2020 2020 2020  private.        
+00026c00: 7365 6c66 2e69 735f 6175 746f 6d61 7469  self.is_automati
+00026c10: 6320 3d20 6973 5f61 7574 6f6d 6174 6963  c = is_automatic
+00026c20: 0a20 2020 2020 2020 2073 656c 662e 6973  .        self.is
+00026c30: 5f69 7076 3420 3d20 6973 5f69 7076 3420  _ipv4 = is_ipv4 
+00026c40: 6f72 2069 735f 6970 7636 2069 7320 4661  or is_ipv6 is Fa
+00026c50: 6c73 650a 2020 2020 2020 2020 7365 6c66  lse.        self
+00026c60: 2e69 735f 7072 6976 6174 6520 3d20 6973  .is_private = is
+00026c70: 5f70 7269 7661 7465 0a20 2020 2020 2020  _private.       
+00026c80: 2073 656c 662e 6973 5f6c 696e 6b5f 6c6f   self.is_link_lo
+00026c90: 6361 6c20 3d20 6973 5f6c 696e 6b5f 6c6f  cal = is_link_lo
+00026ca0: 6361 6c0a 2020 2020 2020 2020 7365 6c66  cal.        self
+00026cb0: 2e69 735f 7265 7365 7276 6564 203d 2069  .is_reserved = i
+00026cc0: 735f 7265 7365 7276 6564 0a20 2020 2020  s_reserved.     
+00026cd0: 2020 2073 656c 662e 6973 5f6d 756c 7469     self.is_multi
+00026ce0: 6361 7374 203d 2069 735f 6d75 6c74 6963  cast = is_multic
+00026cf0: 6173 740a 2020 2020 2020 2020 7365 6c66  ast.        self
+00026d00: 2e69 735f 726f 7574 6561 626c 6520 3d20  .is_routeable = 
+00026d10: 6973 5f72 6f75 7465 6162 6c65 0a20 2020  is_routeable.   
+00026d20: 2020 2020 2073 656c 662e 6973 5f36 746f       self.is_6to
+00026d30: 3420 3d20 6973 5f36 746f 340a 2020 2020  4 = is_6to4.    
+00026d40: 2020 2020 7365 6c66 2e69 735f 7465 7265      self.is_tere
+00026d50: 646f 203d 2069 735f 7465 7265 646f 0a20  do = is_teredo. 
+00026d60: 2020 2020 2020 2073 656c 662e 7375 626e         self.subn
+00026d70: 6574 7320 3d20 7375 626e 6574 730a 2020  ets = subnets.  
+00026d80: 2020 2020 2020 7365 6c66 2e69 735f 6970        self.is_ip
+00026d90: 7636 203d 2069 735f 6970 7636 206f 7220  v6 = is_ipv6 or 
+00026da0: 6973 5f69 7076 3420 6973 2046 616c 7365  is_ipv4 is False
+00026db0: 0a20 2020 2020 2020 2073 656c 662e 6572  .        self.er
+00026dc0: 726f 725f 6d65 7373 6167 6520 3d20 6572  ror_message = er
+00026dd0: 726f 725f 6d65 7373 6167 650a 0a20 2020  ror_message..   
+00026de0: 2064 6566 2076 616c 6964 6174 6528 7365   def validate(se
+00026df0: 6c66 2c20 7661 6c75 652c 2072 6563 6f72  lf, value, recor
+00026e00: 645f 6964 3d4e 6f6e 6529 3a0a 2020 2020  d_id=None):.    
+00026e10: 2020 2020 4950 4164 6472 6573 7320 3d20      IPAddress = 
+00026e20: 6970 6164 6472 6573 732e 6970 5f61 6464  ipaddress.ip_add
+00026e30: 7265 7373 0a20 2020 2020 2020 2049 5076  ress.        IPv
+00026e40: 3641 6464 7265 7373 203d 2069 7061 6464  6Address = ipadd
+00026e50: 7265 7373 2e49 5076 3641 6464 7265 7373  ress.IPv6Address
+00026e60: 0a20 2020 2020 2020 2049 5076 3441 6464  .        IPv4Add
+00026e70: 7265 7373 203d 2069 7061 6464 7265 7373  ress = ipaddress
+00026e80: 2e49 5076 3441 6464 7265 7373 0a0a 2020  .IPv4Address..  
+00026e90: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00026ea0: 2020 2020 2020 2069 7020 3d20 4950 4164         ip = IPAd
+00026eb0: 6472 6573 7328 746f 5f75 6e69 636f 6465  dress(to_unicode
+00026ec0: 2876 616c 7565 2929 0a20 2020 2020 2020  (value)).       
+00026ed0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+00026ee0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00026ef0: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+00026f00: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
+00026f10: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
+00026f20: 5f6d 6573 7361 6765 2929 0a0a 2020 2020  _message))..    
+00026f30: 2020 2020 6966 2073 656c 662e 6973 5f69      if self.is_i
+00026f40: 7076 3420 616e 6420 6973 696e 7374 616e  pv4 and isinstan
+00026f50: 6365 2869 702c 2049 5076 3641 6464 7265  ce(ip, IPv6Addre
+00026f60: 7373 293a 0a20 2020 2020 2020 2020 2020  ss):.           
+00026f70: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+00026f80: 6e45 7272 6f72 2873 656c 662e 7472 616e  nError(self.tran
+00026f90: 736c 6174 6f72 2873 656c 662e 6572 726f  slator(self.erro
+00026fa0: 725f 6d65 7373 6167 6529 290a 2020 2020  r_message)).    
+00026fb0: 2020 2020 656c 6966 2073 656c 662e 6973      elif self.is
+00026fc0: 5f69 7076 3620 616e 6420 6973 696e 7374  _ipv6 and isinst
+00026fd0: 616e 6365 2869 702c 2049 5076 3441 6464  ance(ip, IPv4Add
+00026fe0: 7265 7373 293a 0a20 2020 2020 2020 2020  ress):.         
+00026ff0: 2020 2072 6169 7365 2056 616c 6964 6174     raise Validat
+00027000: 696f 6e45 7272 6f72 2873 656c 662e 7472  ionError(self.tr
+00027010: 616e 736c 6174 6f72 2873 656c 662e 6572  anslator(self.er
+00027020: 726f 725f 6d65 7373 6167 6529 290a 2020  ror_message)).  
+00027030: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+00027040: 6973 5f69 7076 3420 6f72 2069 7369 6e73  is_ipv4 or isins
+00027050: 7461 6e63 6528 6970 2c20 4950 7634 4164  tance(ip, IPv4Ad
+00027060: 6472 6573 7329 3a0a 2020 2020 2020 2020  dress):.        
+00027070: 2020 2020 7265 7475 726e 2049 535f 4950      return IS_IP
+00027080: 5634 280a 2020 2020 2020 2020 2020 2020  V4(.            
+00027090: 2020 2020 6d69 6e69 703d 7365 6c66 2e6d      minip=self.m
+000270a0: 696e 6970 2c0a 2020 2020 2020 2020 2020  inip,.          
+000270b0: 2020 2020 2020 6d61 7869 703d 7365 6c66        maxip=self
+000270c0: 2e6d 6178 6970 2c0a 2020 2020 2020 2020  .maxip,.        
+000270d0: 2020 2020 2020 2020 696e 7665 7274 3d73          invert=s
+000270e0: 656c 662e 696e 7665 7274 2c0a 2020 2020  elf.invert,.    
+000270f0: 2020 2020 2020 2020 2020 2020 6973 5f6c              is_l
+00027100: 6f63 616c 686f 7374 3d73 656c 662e 6973  ocalhost=self.is
+00027110: 5f6c 6f63 616c 686f 7374 2c0a 2020 2020  _localhost,.    
+00027120: 2020 2020 2020 2020 2020 2020 6973 5f70              is_p
+00027130: 7269 7661 7465 3d73 656c 662e 6973 5f70  rivate=self.is_p
+00027140: 7269 7661 7465 2c0a 2020 2020 2020 2020  rivate,.        
+00027150: 2020 2020 2020 2020 6973 5f61 7574 6f6d          is_autom
+00027160: 6174 6963 3d73 656c 662e 6973 5f61 7574  atic=self.is_aut
+00027170: 6f6d 6174 6963 2c0a 2020 2020 2020 2020  omatic,.        
+00027180: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00027190: 7373 6167 653d 7365 6c66 2e65 7272 6f72  ssage=self.error
+000271a0: 5f6d 6573 7361 6765 2c0a 2020 2020 2020  _message,.      
+000271b0: 2020 2020 2020 292e 7661 6c69 6461 7465        ).validate
+000271c0: 2876 616c 7565 2c20 7265 636f 7264 5f69  (value, record_i
+000271d0: 6429 0a20 2020 2020 2020 2065 6c69 6620  d).        elif 
+000271e0: 7365 6c66 2e69 735f 6970 7636 206f 7220  self.is_ipv6 or 
+000271f0: 6973 696e 7374 616e 6365 2869 702c 2049  isinstance(ip, I
+00027200: 5076 3641 6464 7265 7373 293a 0a20 2020  Pv6Address):.   
+00027210: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00027220: 4953 5f49 5056 3628 0a20 2020 2020 2020  IS_IPV6(.       
+00027230: 2020 2020 2020 2020 2069 735f 7072 6976           is_priv
+00027240: 6174 653d 7365 6c66 2e69 735f 7072 6976  ate=self.is_priv
+00027250: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00027260: 2020 2020 2069 735f 6c69 6e6b 5f6c 6f63       is_link_loc
+00027270: 616c 3d73 656c 662e 6973 5f6c 696e 6b5f  al=self.is_link_
+00027280: 6c6f 6361 6c2c 0a20 2020 2020 2020 2020  local,.         
+00027290: 2020 2020 2020 2069 735f 7265 7365 7276         is_reserv
+000272a0: 6564 3d73 656c 662e 6973 5f72 6573 6572  ed=self.is_reser
+000272b0: 7665 642c 0a20 2020 2020 2020 2020 2020  ved,.           
+000272c0: 2020 2020 2069 735f 6d75 6c74 6963 6173       is_multicas
+000272d0: 743d 7365 6c66 2e69 735f 6d75 6c74 6963  t=self.is_multic
+000272e0: 6173 742c 0a20 2020 2020 2020 2020 2020  ast,.           
+000272f0: 2020 2020 2069 735f 726f 7574 6561 626c       is_routeabl
+00027300: 653d 7365 6c66 2e69 735f 726f 7574 6561  e=self.is_routea
+00027310: 626c 652c 0a20 2020 2020 2020 2020 2020  ble,.           
+00027320: 2020 2020 2069 735f 3674 6f34 3d73 656c       is_6to4=sel
+00027330: 662e 6973 5f36 746f 342c 0a20 2020 2020  f.is_6to4,.     
+00027340: 2020 2020 2020 2020 2020 2069 735f 7465             is_te
+00027350: 7265 646f 3d73 656c 662e 6973 5f74 6572  redo=self.is_ter
+00027360: 6564 6f2c 0a20 2020 2020 2020 2020 2020  edo,.           
+00027370: 2020 2020 2073 7562 6e65 7473 3d73 656c       subnets=sel
+00027380: 662e 7375 626e 6574 732c 0a20 2020 2020  f.subnets,.     
+00027390: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+000273a0: 5f6d 6573 7361 6765 3d73 656c 662e 6572  _message=self.er
+000273b0: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
+000273c0: 2020 2020 2020 2020 2029 2e76 616c 6964           ).valid
+000273d0: 6174 6528 7661 6c75 652c 2072 6563 6f72  ate(value, recor
+000273e0: 645f 6964 290a 2020 2020 2020 2020 656c  d_id).        el
+000273f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00027400: 7261 6973 6520 5661 6c69 6461 7469 6f6e  raise Validation
+00027410: 4572 726f 7228 7365 6c66 2e74 7261 6e73  Error(self.trans
+00027420: 6c61 746f 7228 7365 6c66 2e65 7272 6f72  lator(self.error
+00027430: 5f6d 6573 7361 6765 2929 0a              _message)).
```

### Comparing `pydal-20240601.1/pydal.egg-info/PKG-INFO` & `pydal-20240601.2/pydal.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pydal
-Version: 20240601.1
+Version: 20240601.2
 Summary: pyDAL is a Database Abstraction Layer. It generates queries for SQlite, PotsgreSQL, MySQL, and other backends. It was originally part of the web2py frameworks but it is now an independent project. Example: db.define_table("thing",Field("name")) and db.thing.insert(name="Pizza")
 Author-email: Massimo Di Pierro <massimo.dipierro@gmail.com>
 Project-URL: Homepage, https://github.com/web2py/pydal
 Project-URL: Bug Tracker, https://github.com/web2py/pydal/issues
 Project-URL: Documentation, https://py4web.com/_documentation/static/en/chapter-07.html
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: BSD License
```

### Comparing `pydal-20240601.1/pydal.egg-info/SOURCES.txt` & `pydal-20240601.2/pydal.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/pyproject.toml` & `pydal-20240601.2/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [project]
 name = "pydal"
-version = "20240601.1"
+version = "20240601.2"
 authors = [{ name="Massimo Di Pierro", email="massimo.dipierro@gmail.com" },]
 description = 'pyDAL is a Database Abstraction Layer. It generates queries for SQlite, PotsgreSQL, MySQL, and other backends. It was originally part of the web2py frameworks but it is now an independent project. Example: db.define_table("thing",Field("name")) and db.thing.insert(name="Pizza")'
 readme = "README.md"
 requires-python = ">=3.7"
 classifiers = [
       "Programming Language :: Python :: 3",
       "License :: OSI Approved :: BSD License",
```

### Comparing `pydal-20240601.1/tests/__pycache__/__init__.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/__init__.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/_adapt.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/_adapt.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/_helpers.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/_helpers.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/base.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/base.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/caching.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/caching.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/contribs.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/contribs.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/indexes.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/indexes.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/is_url_validators.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/is_url_validators.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/restapi.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/restapi.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/scheduler.cpython-311-pytest-8.2.1.pyc` & `pydal-20240601.2/tests/__pycache__/scheduler.cpython-311-pytest-8.2.1.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/scheduler.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/scheduler.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/smart_query.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/smart_query.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/sql.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/sql.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/tags.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/tags.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/validation.cpython-311-pytest-8.2.1.pyc` & `pydal-20240601.2/tests/__pycache__/validation.cpython-311-pytest-8.2.1.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/validation.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/validation.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/validators.cpython-311-pytest-8.2.1.pyc` & `pydal-20240601.2/tests/__pycache__/validators.cpython-311-pytest-8.2.1.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/__pycache__/validators.cpython-311.pyc` & `pydal-20240601.2/tests/__pycache__/validators.cpython-311.pyc`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/_adapt.py` & `pydal-20240601.2/tests/_adapt.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/_helpers.py` & `pydal-20240601.2/tests/_helpers.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/base.py` & `pydal-20240601.2/tests/base.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/caching.py` & `pydal-20240601.2/tests/caching.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/contribs.py` & `pydal-20240601.2/tests/contribs.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/indexes.py` & `pydal-20240601.2/tests/indexes.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/is_url_validators.py` & `pydal-20240601.2/tests/is_url_validators.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/nosql.py` & `pydal-20240601.2/tests/nosql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/restapi.py` & `pydal-20240601.2/tests/restapi.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/scheduler.py` & `pydal-20240601.2/tests/scheduler.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/scheduler.py~` & `pydal-20240601.2/tests/scheduler.py~`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/smart_query.py` & `pydal-20240601.2/tests/smart_query.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/sql.py` & `pydal-20240601.2/tests/sql.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/tags.py` & `pydal-20240601.2/tests/tags.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/validation.py` & `pydal-20240601.2/tests/validation.py`

 * *Files identical despite different names*

### Comparing `pydal-20240601.1/tests/validators.py` & `pydal-20240601.2/tests/validators.py`

 * *Files identical despite different names*

