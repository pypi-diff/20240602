# Comparing `tmp/runningz-0.16.4-py39-none-any.whl.zip` & `tmp/runningz-0.16.5-py39-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,173 +1,173 @@
-Zip file size: 492723 bytes, number of entries: 171
--rw-r--r--  2.0 unx      196 b- defN 24-May-31 14:45 runningz/.gitignore
--rw-r--r--  2.0 unx     1299 b- defN 24-May-31 14:45 runningz/__init__.pyc
--rw-r--r--  2.0 unx      186 b- defN 24-May-31 14:45 runningz/api.pyc
--rw-r--r--  2.0 unx    18311 b- defN 24-May-31 14:45 runningz/core/DataMaster.pyc
--rw-r--r--  2.0 unx      151 b- defN 24-May-31 14:45 runningz/core/__init__.pyc
--rw-r--r--  2.0 unx     3856 b- defN 24-May-31 14:45 runningz/core/api.pyc
--rw-r--r--  2.0 unx      154 b- defN 24-May-31 14:45 runningz/core/er/__init__.pyc
--rw-r--r--  2.0 unx      572 b- defN 24-May-31 14:45 runningz/core/er/hasher.pyc
--rw-r--r--  2.0 unx      651 b- defN 24-May-31 14:45 runningz/core/er/idxer.pyc
--rw-r--r--  2.0 unx      573 b- defN 24-May-31 14:45 runningz/core/er/masker.pyc
--rw-r--r--  2.0 unx     9357 b- defN 24-May-31 14:45 runningz/core/er/namer.pyc
--rw-r--r--  2.0 unx      550 b- defN 24-May-31 14:45 runningz/core/er/scaler.pyc
--rw-r--r--  2.0 unx     7484 b- defN 24-May-31 14:45 runningz/core/op/OPMaster.pyc
--rw-r--r--  2.0 unx    15662 b- defN 24-May-31 14:45 runningz/core/op/OPMaster_py.pyc
--rw-r--r--  2.0 unx     6671 b- defN 24-May-31 14:45 runningz/core/op/__init__.pyc
--rw-r--r--  2.0 unx     7346 b- defN 24-May-31 14:45 runningz/core/op/__init___py.pyc
--rw-r--r--  2.0 unx    11402 b- defN 24-May-31 14:45 runningz/core/op/_numba.pyc
--rw-r--r--  2.0 unx    24188 b- defN 24-May-31 14:45 runningz/core/op/_numba_1.pyc
--rw-r--r--  2.0 unx    27784 b- defN 24-May-31 14:45 runningz/core/op/_numba_2.pyc
--rw-r--r--  2.0 unx    17533 b- defN 24-May-31 14:45 runningz/core/op/_numba_2_2.pyc
--rw-r--r--  2.0 unx     6742 b- defN 24-May-31 14:45 runningz/core/op/_numba_merge_roll.pyc
--rw-r--r--  2.0 unx     9392 b- defN 24-May-31 14:45 runningz/core/op/op_1.pyc
--rw-r--r--  2.0 unx    13877 b- defN 24-May-31 14:45 runningz/core/op/op_1_numba.pyc
--rw-r--r--  2.0 unx     2558 b- defN 24-May-31 14:45 runningz/core/op/op_1_numba_old.pyc
--rw-r--r--  2.0 unx    26907 b- defN 24-May-31 14:45 runningz/core/op/op_2.pyc
--rw-r--r--  2.0 unx    34643 b- defN 24-May-31 14:45 runningz/core/op/op_2_numba.pyc
--rw-r--r--  2.0 unx     5608 b- defN 24-May-31 14:45 runningz/core/op/op_3.pyc
--rw-r--r--  2.0 unx     7119 b- defN 24-May-31 14:45 runningz/core/op/op_3_numba.pyc
--rw-r--r--  2.0 unx     3788 b- defN 24-May-31 14:45 runningz/core/op/op_groupby.pyc
--rw-r--r--  2.0 unx     3575 b- defN 24-May-31 14:45 runningz/core/op/op_m.pyc
--rw-r--r--  2.0 unx     5128 b- defN 24-May-31 14:45 runningz/core/op/op_m_numba.pyc
--rw-r--r--  2.0 unx     8705 b- defN 24-May-31 14:45 runningz/core/op/op_other.pyc
--rw-r--r--  2.0 unx       15 b- defN 24-May-31 14:45 runningz/fe/.gitignore
--rw-r--r--  2.0 unx    14548 b- defN 24-May-31 14:45 runningz/fe/FEMaster.pyc
--rw-r--r--  2.0 unx    23960 b- defN 24-May-31 14:45 runningz/fe/FEMaster_py.pyc
--rw-r--r--  2.0 unx      178 b- defN 24-May-31 14:45 runningz/fe/__init__.pyc
--rw-r--r--  2.0 unx     2487 b- defN 24-May-31 14:45 runningz/fe/fe_dump.pyc
--rw-r--r--  2.0 unx     3708 b- defN 24-May-31 14:45 runningz/fe/fe_dump_py.pyc
--rw-r--r--  2.0 unx     4481 b- defN 24-May-31 14:45 runningz/fe/fe_eval.pyc
--rw-r--r--  2.0 unx     7299 b- defN 24-May-31 14:45 runningz/fe/fe_eval_py.pyc
--rw-r--r--  2.0 unx     4850 b- defN 24-May-31 14:45 runningz/fe/fe_main.pyc
--rw-r--r--  2.0 unx     8473 b- defN 24-May-31 14:45 runningz/fe/fe_main_py.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-31 14:45 runningz/fe/config/__init__.pyc
--rw-r--r--  2.0 unx    11438 b- defN 24-May-31 14:45 runningz/fe/config/cols_dict.pyc
--rw-r--r--  2.0 unx    74158 b- defN 24-May-31 14:45 runningz/fe/config/cols_fea.pyc
--rw-r--r--  2.0 unx     1274 b- defN 24-May-31 14:45 runningz/fe/config/fm_config.pyc
--rw-r--r--  2.0 unx     1919 b- defN 24-May-31 14:45 runningz/fe/config/fm_config_opt.pyc
--rw-r--r--  2.0 unx     5184 b- defN 24-May-31 14:45 runningz/fe/config/fm_config_opt_py.pyc
--rw-r--r--  2.0 unx     5988 b- defN 24-May-31 14:45 runningz/fe/config/fm_config_py.pyc
--rw-r--r--  2.0 unx     5793 b- defN 24-May-31 14:45 runningz/fe/config/fm_config_top.pyc
--rw-r--r--  2.0 unx    19957 b- defN 24-May-31 14:45 runningz/fe/config/fm_config_top_py.pyc
--rw-r--r--  2.0 unx      298 b- defN 24-May-31 14:45 runningz/fe/er/__init__.pyc
--rw-r--r--  2.0 unx     3039 b- defN 24-May-31 14:45 runningz/fe/er/pather.pyc
--rw-r--r--  2.0 unx    17161 b- defN 24-May-31 14:45 runningz/fe/er/pooler.pyc
--rw-r--r--  2.0 unx    17241 b- defN 24-May-31 14:45 runningz/fe/er/pooler_old.pyc
--rw-r--r--  2.0 unx    38247 b- defN 24-May-31 14:45 runningz/fe/er/pooler_py.pyc
--rw-r--r--  2.0 unx     8018 b- defN 24-May-31 14:45 runningz/fe/er/ranker.pyc
--rw-r--r--  2.0 unx    12370 b- defN 24-May-31 14:45 runningz/fe/er/ranker_py.pyc
--rw-r--r--  2.0 unx     5561 b- defN 24-May-31 14:45 runningz/fe/er/typer.pyc
--rw-r--r--  2.0 unx      162 b- defN 24-May-31 14:45 runningz/fe/prepare_data/__init__.pyc
--rw-r--r--  2.0 unx    13207 b- defN 24-May-31 14:45 runningz/fe/prepare_data/base_data.pyc
--rw-r--r--  2.0 unx    20242 b- defN 24-May-31 14:45 runningz/fe/prepare_data/base_data_py.pyc
--rw-r--r--  2.0 unx     1554 b- defN 24-May-31 14:45 runningz/fe/prepare_data/basic_data.pyc
--rw-r--r--  2.0 unx     2741 b- defN 24-May-31 14:45 runningz/fe/prepare_data/basic_data_py.pyc
--rw-r--r--  2.0 unx     8499 b- defN 24-May-31 14:45 runningz/fe/prepare_data/factor_data.pyc
--rw-r--r--  2.0 unx      193 b- defN 24-May-31 14:45 runningz/fe/status/__init__.pyc
--rw-r--r--  2.0 unx    10623 b- defN 24-May-31 14:45 runningz/fe/status/status.pyc
--rw-r--r--  2.0 unx    16648 b- defN 24-May-31 14:45 runningz/fe/status/status_py.pyc
--rw-r--r--  2.0 unx      154 b- defN 24-May-31 14:45 runningz/fe/util/__init__.pyc
--rw-r--r--  2.0 unx    11846 b- defN 24-May-31 14:45 runningz/fe/util/util.pyc
--rw-r--r--  2.0 unx    14775 b- defN 24-May-31 14:45 runningz/fe/util/util_py.pyc
--rw-r--r--  2.0 unx      294 b- defN 24-May-31 14:45 runningz/metric/__init__.pyc
--rw-r--r--  2.0 unx     1818 b- defN 24-May-31 14:45 runningz/metric/get_score_metric.pyc
--rw-r--r--  2.0 unx      883 b- defN 24-May-31 14:45 runningz/metric/ic.pyc
--rw-r--r--  2.0 unx     3441 b- defN 24-May-31 14:45 runningz/metric/metrics.pyc
--rw-r--r--  2.0 unx     3252 b- defN 24-May-31 14:45 runningz/metric/metrics_numba.pyc
--rw-r--r--  2.0 unx      277 b- defN 24-May-31 14:45 runningz/model/__init__.pyc
--rw-r--r--  2.0 unx      147 b- defN 24-May-31 14:45 runningz/model/api.pyc
--rw-r--r--  2.0 unx     3266 b- defN 24-May-31 14:45 runningz/model/base.pyc
--rw-r--r--  2.0 unx     1874 b- defN 24-May-31 14:45 runningz/model/lgb.pyc
--rw-r--r--  2.0 unx     1629 b- defN 24-May-31 14:45 runningz/model/test_lgb.pyc
--rw-r--r--  2.0 unx     6063 b- defN 24-May-31 14:45 runningz/model/test_model_all.pyc
--rw-r--r--  2.0 unx      444 b- defN 24-May-31 14:45 runningz/model/imp/__init__.pyc
--rw-r--r--  2.0 unx     2330 b- defN 24-May-31 14:45 runningz/model/imp/adv.pyc
--rw-r--r--  2.0 unx     1017 b- defN 24-May-31 14:45 runningz/model/imp/fit.pyc
--rw-r--r--  2.0 unx     2148 b- defN 24-May-31 14:45 runningz/model/imp/lars.pyc
--rw-r--r--  2.0 unx     1288 b- defN 24-May-31 14:45 runningz/model/imp/pfi.pyc
--rw-r--r--  2.0 unx      303 b- defN 24-May-31 14:45 runningz/model/imp/pti.pyc
--rw-r--r--  2.0 unx     1473 b- defN 24-May-31 14:45 runningz/model/imp/util.pyc
--rw-r--r--  2.0 unx      281 b- defN 24-May-31 14:45 runningz/model/linear/__init__.pyc
--rw-r--r--  2.0 unx     3135 b- defN 24-May-31 14:45 runningz/model/linear/model_l2.pyc
--rw-r--r--  2.0 unx     3931 b- defN 24-May-31 14:45 runningz/model/linear/model_lr.pyc
--rw-r--r--  2.0 unx     3245 b- defN 24-May-31 14:45 runningz/model/linear/model_sgd.pyc
--rw-r--r--  2.0 unx      197 b- defN 24-May-31 14:45 runningz/model/nn/__init__.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-31 14:45 runningz/model/nn/model_cnn.pyc
--rw-r--r--  2.0 unx      162 b- defN 24-May-31 14:45 runningz/model/nn/model_deep_wide.pyc
--rw-r--r--  2.0 unx      157 b- defN 24-May-31 14:45 runningz/model/nn/model_lstm.pyc
--rw-r--r--  2.0 unx     6022 b- defN 24-May-31 14:45 runningz/model/nn/model_mlp.pyc
--rw-r--r--  2.0 unx    11745 b- defN 24-May-31 14:45 runningz/model/nn/model_mlp_py.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-31 14:45 runningz/model/nn/model_moe.pyc
--rw-r--r--  2.0 unx     4888 b- defN 24-May-31 14:45 runningz/model/nn/model_rxnet.pyc
--rw-r--r--  2.0 unx      159 b- defN 24-May-31 14:45 runningz/model/nn/model_tabnet.pyc
--rw-r--r--  2.0 unx    14568 b- defN 24-May-31 14:45 runningz/model/nn/nn_util.pyc
--rw-r--r--  2.0 unx    16916 b- defN 24-May-31 14:45 runningz/model/nn/nn_util_py.pyc
--rw-r--r--  2.0 unx      365 b- defN 24-May-31 14:45 runningz/model/tree/__init__.pyc
--rw-r--r--  2.0 unx     4689 b- defN 24-May-31 14:45 runningz/model/tree/model_cat.pyc
--rw-r--r--  2.0 unx     8214 b- defN 24-May-31 14:45 runningz/model/tree/model_cat_py.pyc
--rw-r--r--  2.0 unx     2815 b- defN 24-May-31 14:45 runningz/model/tree/model_erf.pyc
--rw-r--r--  2.0 unx     8323 b- defN 24-May-31 14:45 runningz/model/tree/model_lgb.pyc
--rw-r--r--  2.0 unx    12185 b- defN 24-May-31 14:45 runningz/model/tree/model_lgb_py.pyc
--rw-r--r--  2.0 unx     2829 b- defN 24-May-31 14:45 runningz/model/tree/model_rf.pyc
--rw-r--r--  2.0 unx     3677 b- defN 24-May-31 14:45 runningz/model/tree/model_xgb.pyc
--rw-r--r--  2.0 unx      349 b- defN 24-May-31 14:45 runningz/opt/__init__.pyc
--rw-r--r--  2.0 unx      152 b- defN 24-May-31 14:45 runningz/opt/opt_convex.pyc
--rw-r--r--  2.0 unx    12130 b- defN 24-May-31 14:45 runningz/opt/opt_elo.pyc
--rw-r--r--  2.0 unx     2320 b- defN 24-May-31 14:45 runningz/opt/opt_optuna.pyc
--rw-r--r--  2.0 unx     6914 b- defN 24-May-31 14:45 runningz/opt/opt_random.pyc
--rw-r--r--  2.0 unx     9665 b- defN 24-May-31 14:45 runningz/opt/opt_random_py.pyc
--rw-r--r--  2.0 unx      927 b- defN 24-May-31 14:45 runningz/opt/opt_scipy.pyc
--rw-r--r--  2.0 unx     3556 b- defN 24-May-31 14:45 runningz/opt/opt_sgd.pyc
--rw-r--r--  2.0 unx      150 b- defN 24-May-31 14:45 runningz/res/__init__.pyc
--rw-r--r--  2.0 unx     1180 b- defN 24-May-31 14:45 runningz/res/res_dates.pyc
--rw-r--r--  2.0 unx     1498 b- defN 24-May-31 14:45 runningz/res/res_dates_py.pyc
--rw-r--r--  2.0 unx     1680 b- defN 24-May-31 14:45 runningz/res/res_labels.pyc
--rw-r--r--  2.0 unx     3050 b- defN 24-May-31 14:45 runningz/res/res_labels_py.pyc
--rw-r--r--  2.0 unx    11914 b- defN 24-May-31 14:45 runningz/res/res_main.pyc
--rw-r--r--  2.0 unx    21483 b- defN 24-May-31 14:45 runningz/res/res_main_py.pyc
--rw-r--r--  2.0 unx      301 b- defN 24-May-31 14:45 runningz/res/res_run.pyc
--rw-r--r--  2.0 unx     1993 b- defN 24-May-31 14:45 runningz/res/res_run_py.pyc
--rw-r--r--  2.0 unx      971 b- defN 24-May-31 14:45 runningz/res/res_seeds.pyc
--rw-r--r--  2.0 unx     1183 b- defN 24-May-31 14:45 runningz/res/res_seeds_py.pyc
--rw-r--r--  2.0 unx      157 b- defN 24-May-31 14:45 runningz/res/config/__init__.pyc
--rw-r--r--  2.0 unx     1706 b- defN 24-May-31 14:45 runningz/res/config/res_config.pyc
--rw-r--r--  2.0 unx     3923 b- defN 24-May-31 14:45 runningz/res/config/res_config_py.pyc
--rw-r--r--  2.0 unx      153 b- defN 24-May-31 14:45 runningz/res/er/__init__.pyc
--rw-r--r--  2.0 unx     9978 b- defN 24-May-31 14:45 runningz/res/er/pooler.pyc
--rw-r--r--  2.0 unx    23432 b- defN 24-May-31 14:45 runningz/res/er/pooler_py.pyc
--rw-r--r--  2.0 unx      155 b- defN 24-May-31 14:45 runningz/res/util/__init__.pyc
--rw-r--r--  2.0 unx     2094 b- defN 24-May-31 14:45 runningz/res/util/util.pyc
--rw-r--r--  2.0 unx     2564 b- defN 24-May-31 14:45 runningz/res/util/util_py.pyc
--rw-r--r--  2.0 unx      172 b- defN 24-May-31 14:45 runningz/util/__init__.pyc
--rw-r--r--  2.0 unx     1813 b- defN 24-May-31 14:45 runningz/util/api.pyc
--rw-r--r--  2.0 unx     2062 b- defN 24-May-31 14:45 runningz/util/clss.pyc
--rw-r--r--  2.0 unx    46539 b- defN 24-May-31 14:45 runningz/util/code.pyc
--rw-r--r--  2.0 unx     3448 b- defN 24-May-31 14:45 runningz/util/const.pyc
--rw-r--r--  2.0 unx     4372 b- defN 24-May-31 14:45 runningz/util/const_py.pyc
--rw-r--r--  2.0 unx     1566 b- defN 24-May-31 14:45 runningz/util/csv.pyc
--rw-r--r--  2.0 unx    12208 b- defN 24-May-31 14:45 runningz/util/db.pyc
--rw-r--r--  2.0 unx      469 b- defN 24-May-31 14:45 runningz/util/debug.pyc
--rw-r--r--  2.0 unx     2191 b- defN 24-May-31 14:45 runningz/util/dec.pyc
--rw-r--r--  2.0 unx     9190 b- defN 24-May-31 14:45 runningz/util/dist.pyc
--rw-r--r--  2.0 unx     3599 b- defN 24-May-31 14:45 runningz/util/env.pyc
--rw-r--r--  2.0 unx     2172 b- defN 24-May-31 14:45 runningz/util/login.pyc
--rw-r--r--  2.0 unx     4867 b- defN 24-May-31 14:45 runningz/util/mem.pyc
--rw-r--r--  2.0 unx    20047 b- defN 24-May-31 14:45 runningz/util/npy.pyc
--rw-r--r--  2.0 unx    68037 b- defN 24-May-31 14:45 runningz/util/npy_numba.pyc
--rw-r--r--  2.0 unx    88353 b- defN 24-May-31 14:45 runningz/util/npy_numba_py.pyc
--rw-r--r--  2.0 unx    25675 b- defN 24-May-31 14:45 runningz/util/npy_py.pyc
--rw-r--r--  2.0 unx   702066 b- defN 24-May-31 14:45 runningz/util/pool.pyc
--rw-r--r--  2.0 unx     9422 b- defN 24-May-31 14:45 runningz/util/run.pyc
--rw-r--r--  2.0 unx     3974 b- defN 24-May-31 14:45 runningz/util/split.pyc
--rw-r--r--  2.0 unx     5670 b- defN 24-May-31 14:45 runningz/util/test.pyc
--rw-r--r--  2.0 unx     7503 b- defN 24-May-31 14:45 runningz/util/test_py.pyc
--rw-r--r--  2.0 unx    18691 b- defN 24-May-31 14:45 runningz/util/util.pyc
--rw-r--r--  2.0 unx      156 b- defN 24-May-31 14:45 runningz/util/temp/__init__.pyc
--rw-r--r--  2.0 unx     1211 b- defN 24-May-31 14:45 runningz/util/temp/main.pyc
--rw-r--r--  2.0 unx      510 b- defN 24-May-31 14:45 runningz-0.16.4.dist-info/METADATA
--rw-r--r--  2.0 unx       82 b- defN 24-May-31 14:45 runningz-0.16.4.dist-info/WHEEL
--rw-r--r--  2.0 unx       52 b- defN 24-May-31 14:45 runningz-0.16.4.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        9 b- defN 24-May-31 14:45 runningz-0.16.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    14559 b- defN 24-May-31 14:45 runningz-0.16.4.dist-info/RECORD
-171 files, 2007438 bytes uncompressed, 469955 bytes compressed:  76.6%
+Zip file size: 494167 bytes, number of entries: 171
+-rw-r--r--  2.0 unx      196 b- defN 24-Jun-02 16:24 runningz/.gitignore
+-rw-r--r--  2.0 unx     1299 b- defN 24-Jun-02 16:24 runningz/__init__.pyc
+-rw-r--r--  2.0 unx      186 b- defN 24-Jun-02 16:24 runningz/api.pyc
+-rw-r--r--  2.0 unx    18311 b- defN 24-Jun-02 16:24 runningz/core/DataMaster.pyc
+-rw-r--r--  2.0 unx      151 b- defN 24-Jun-02 16:24 runningz/core/__init__.pyc
+-rw-r--r--  2.0 unx     3856 b- defN 24-Jun-02 16:24 runningz/core/api.pyc
+-rw-r--r--  2.0 unx      154 b- defN 24-Jun-02 16:24 runningz/core/er/__init__.pyc
+-rw-r--r--  2.0 unx      572 b- defN 24-Jun-02 16:24 runningz/core/er/hasher.pyc
+-rw-r--r--  2.0 unx      651 b- defN 24-Jun-02 16:24 runningz/core/er/idxer.pyc
+-rw-r--r--  2.0 unx      573 b- defN 24-Jun-02 16:24 runningz/core/er/masker.pyc
+-rw-r--r--  2.0 unx     9357 b- defN 24-Jun-02 16:24 runningz/core/er/namer.pyc
+-rw-r--r--  2.0 unx      550 b- defN 24-Jun-02 16:24 runningz/core/er/scaler.pyc
+-rw-r--r--  2.0 unx     7484 b- defN 24-Jun-02 16:24 runningz/core/op/OPMaster.pyc
+-rw-r--r--  2.0 unx    15662 b- defN 24-Jun-02 16:24 runningz/core/op/OPMaster_py.pyc
+-rw-r--r--  2.0 unx     6671 b- defN 24-Jun-02 16:24 runningz/core/op/__init__.pyc
+-rw-r--r--  2.0 unx     7346 b- defN 24-Jun-02 16:24 runningz/core/op/__init___py.pyc
+-rw-r--r--  2.0 unx    11402 b- defN 24-Jun-02 16:24 runningz/core/op/_numba.pyc
+-rw-r--r--  2.0 unx    24188 b- defN 24-Jun-02 16:24 runningz/core/op/_numba_1.pyc
+-rw-r--r--  2.0 unx    27784 b- defN 24-Jun-02 16:24 runningz/core/op/_numba_2.pyc
+-rw-r--r--  2.0 unx    17533 b- defN 24-Jun-02 16:24 runningz/core/op/_numba_2_2.pyc
+-rw-r--r--  2.0 unx     6742 b- defN 24-Jun-02 16:24 runningz/core/op/_numba_merge_roll.pyc
+-rw-r--r--  2.0 unx     9392 b- defN 24-Jun-02 16:24 runningz/core/op/op_1.pyc
+-rw-r--r--  2.0 unx    13877 b- defN 24-Jun-02 16:24 runningz/core/op/op_1_numba.pyc
+-rw-r--r--  2.0 unx     2558 b- defN 24-Jun-02 16:24 runningz/core/op/op_1_numba_old.pyc
+-rw-r--r--  2.0 unx    26907 b- defN 24-Jun-02 16:24 runningz/core/op/op_2.pyc
+-rw-r--r--  2.0 unx    34643 b- defN 24-Jun-02 16:24 runningz/core/op/op_2_numba.pyc
+-rw-r--r--  2.0 unx     5608 b- defN 24-Jun-02 16:24 runningz/core/op/op_3.pyc
+-rw-r--r--  2.0 unx     7119 b- defN 24-Jun-02 16:24 runningz/core/op/op_3_numba.pyc
+-rw-r--r--  2.0 unx     3788 b- defN 24-Jun-02 16:24 runningz/core/op/op_groupby.pyc
+-rw-r--r--  2.0 unx     3575 b- defN 24-Jun-02 16:24 runningz/core/op/op_m.pyc
+-rw-r--r--  2.0 unx     5128 b- defN 24-Jun-02 16:24 runningz/core/op/op_m_numba.pyc
+-rw-r--r--  2.0 unx     8705 b- defN 24-Jun-02 16:24 runningz/core/op/op_other.pyc
+-rw-r--r--  2.0 unx       15 b- defN 24-Jun-02 16:24 runningz/fe/.gitignore
+-rw-r--r--  2.0 unx    14548 b- defN 24-Jun-02 16:24 runningz/fe/FEMaster.pyc
+-rw-r--r--  2.0 unx    23960 b- defN 24-Jun-02 16:24 runningz/fe/FEMaster_py.pyc
+-rw-r--r--  2.0 unx      178 b- defN 24-Jun-02 16:24 runningz/fe/__init__.pyc
+-rw-r--r--  2.0 unx     2487 b- defN 24-Jun-02 16:24 runningz/fe/fe_dump.pyc
+-rw-r--r--  2.0 unx     3708 b- defN 24-Jun-02 16:24 runningz/fe/fe_dump_py.pyc
+-rw-r--r--  2.0 unx     4481 b- defN 24-Jun-02 16:24 runningz/fe/fe_eval.pyc
+-rw-r--r--  2.0 unx     7299 b- defN 24-Jun-02 16:24 runningz/fe/fe_eval_py.pyc
+-rw-r--r--  2.0 unx     4850 b- defN 24-Jun-02 16:24 runningz/fe/fe_main.pyc
+-rw-r--r--  2.0 unx     8473 b- defN 24-Jun-02 16:24 runningz/fe/fe_main_py.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-Jun-02 16:24 runningz/fe/config/__init__.pyc
+-rw-r--r--  2.0 unx    11438 b- defN 24-Jun-02 16:24 runningz/fe/config/cols_dict.pyc
+-rw-r--r--  2.0 unx    74158 b- defN 24-Jun-02 16:24 runningz/fe/config/cols_fea.pyc
+-rw-r--r--  2.0 unx     1274 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config.pyc
+-rw-r--r--  2.0 unx     1919 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config_opt.pyc
+-rw-r--r--  2.0 unx     5184 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config_opt_py.pyc
+-rw-r--r--  2.0 unx     5988 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config_py.pyc
+-rw-r--r--  2.0 unx     5793 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config_top.pyc
+-rw-r--r--  2.0 unx    19957 b- defN 24-Jun-02 16:24 runningz/fe/config/fm_config_top_py.pyc
+-rw-r--r--  2.0 unx      298 b- defN 24-Jun-02 16:24 runningz/fe/er/__init__.pyc
+-rw-r--r--  2.0 unx     3039 b- defN 24-Jun-02 16:24 runningz/fe/er/pather.pyc
+-rw-r--r--  2.0 unx    17161 b- defN 24-Jun-02 16:24 runningz/fe/er/pooler.pyc
+-rw-r--r--  2.0 unx    17241 b- defN 24-Jun-02 16:24 runningz/fe/er/pooler_old.pyc
+-rw-r--r--  2.0 unx    38247 b- defN 24-Jun-02 16:24 runningz/fe/er/pooler_py.pyc
+-rw-r--r--  2.0 unx     8018 b- defN 24-Jun-02 16:24 runningz/fe/er/ranker.pyc
+-rw-r--r--  2.0 unx    12370 b- defN 24-Jun-02 16:24 runningz/fe/er/ranker_py.pyc
+-rw-r--r--  2.0 unx     5561 b- defN 24-Jun-02 16:24 runningz/fe/er/typer.pyc
+-rw-r--r--  2.0 unx      162 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/__init__.pyc
+-rw-r--r--  2.0 unx    13461 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/base_data.pyc
+-rw-r--r--  2.0 unx    20477 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/base_data_py.pyc
+-rw-r--r--  2.0 unx     1554 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/basic_data.pyc
+-rw-r--r--  2.0 unx     2741 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/basic_data_py.pyc
+-rw-r--r--  2.0 unx     8499 b- defN 24-Jun-02 16:24 runningz/fe/prepare_data/factor_data.pyc
+-rw-r--r--  2.0 unx      193 b- defN 24-Jun-02 16:24 runningz/fe/status/__init__.pyc
+-rw-r--r--  2.0 unx    10623 b- defN 24-Jun-02 16:24 runningz/fe/status/status.pyc
+-rw-r--r--  2.0 unx    16648 b- defN 24-Jun-02 16:24 runningz/fe/status/status_py.pyc
+-rw-r--r--  2.0 unx      154 b- defN 24-Jun-02 16:24 runningz/fe/util/__init__.pyc
+-rw-r--r--  2.0 unx    11846 b- defN 24-Jun-02 16:24 runningz/fe/util/util.pyc
+-rw-r--r--  2.0 unx    14775 b- defN 24-Jun-02 16:24 runningz/fe/util/util_py.pyc
+-rw-r--r--  2.0 unx      294 b- defN 24-Jun-02 16:24 runningz/metric/__init__.pyc
+-rw-r--r--  2.0 unx     1818 b- defN 24-Jun-02 16:24 runningz/metric/get_score_metric.pyc
+-rw-r--r--  2.0 unx      883 b- defN 24-Jun-02 16:24 runningz/metric/ic.pyc
+-rw-r--r--  2.0 unx     3441 b- defN 24-Jun-02 16:24 runningz/metric/metrics.pyc
+-rw-r--r--  2.0 unx     3252 b- defN 24-Jun-02 16:24 runningz/metric/metrics_numba.pyc
+-rw-r--r--  2.0 unx      277 b- defN 24-Jun-02 16:24 runningz/model/__init__.pyc
+-rw-r--r--  2.0 unx      147 b- defN 24-Jun-02 16:24 runningz/model/api.pyc
+-rw-r--r--  2.0 unx     3266 b- defN 24-Jun-02 16:24 runningz/model/base.pyc
+-rw-r--r--  2.0 unx     1874 b- defN 24-Jun-02 16:24 runningz/model/lgb.pyc
+-rw-r--r--  2.0 unx     1629 b- defN 24-Jun-02 16:24 runningz/model/test_lgb.pyc
+-rw-r--r--  2.0 unx     6063 b- defN 24-Jun-02 16:24 runningz/model/test_model_all.pyc
+-rw-r--r--  2.0 unx      444 b- defN 24-Jun-02 16:24 runningz/model/imp/__init__.pyc
+-rw-r--r--  2.0 unx     2330 b- defN 24-Jun-02 16:24 runningz/model/imp/adv.pyc
+-rw-r--r--  2.0 unx     1017 b- defN 24-Jun-02 16:24 runningz/model/imp/fit.pyc
+-rw-r--r--  2.0 unx     2148 b- defN 24-Jun-02 16:24 runningz/model/imp/lars.pyc
+-rw-r--r--  2.0 unx     1288 b- defN 24-Jun-02 16:24 runningz/model/imp/pfi.pyc
+-rw-r--r--  2.0 unx      303 b- defN 24-Jun-02 16:24 runningz/model/imp/pti.pyc
+-rw-r--r--  2.0 unx     1473 b- defN 24-Jun-02 16:24 runningz/model/imp/util.pyc
+-rw-r--r--  2.0 unx      281 b- defN 24-Jun-02 16:24 runningz/model/linear/__init__.pyc
+-rw-r--r--  2.0 unx     3135 b- defN 24-Jun-02 16:24 runningz/model/linear/model_l2.pyc
+-rw-r--r--  2.0 unx     3931 b- defN 24-Jun-02 16:24 runningz/model/linear/model_lr.pyc
+-rw-r--r--  2.0 unx     3245 b- defN 24-Jun-02 16:24 runningz/model/linear/model_sgd.pyc
+-rw-r--r--  2.0 unx      197 b- defN 24-Jun-02 16:24 runningz/model/nn/__init__.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-Jun-02 16:24 runningz/model/nn/model_cnn.pyc
+-rw-r--r--  2.0 unx      162 b- defN 24-Jun-02 16:24 runningz/model/nn/model_deep_wide.pyc
+-rw-r--r--  2.0 unx      157 b- defN 24-Jun-02 16:24 runningz/model/nn/model_lstm.pyc
+-rw-r--r--  2.0 unx     6022 b- defN 24-Jun-02 16:24 runningz/model/nn/model_mlp.pyc
+-rw-r--r--  2.0 unx    11745 b- defN 24-Jun-02 16:24 runningz/model/nn/model_mlp_py.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-Jun-02 16:24 runningz/model/nn/model_moe.pyc
+-rw-r--r--  2.0 unx     4888 b- defN 24-Jun-02 16:24 runningz/model/nn/model_rxnet.pyc
+-rw-r--r--  2.0 unx      159 b- defN 24-Jun-02 16:24 runningz/model/nn/model_tabnet.pyc
+-rw-r--r--  2.0 unx    14568 b- defN 24-Jun-02 16:24 runningz/model/nn/nn_util.pyc
+-rw-r--r--  2.0 unx    16916 b- defN 24-Jun-02 16:24 runningz/model/nn/nn_util_py.pyc
+-rw-r--r--  2.0 unx      365 b- defN 24-Jun-02 16:24 runningz/model/tree/__init__.pyc
+-rw-r--r--  2.0 unx     5239 b- defN 24-Jun-02 16:24 runningz/model/tree/model_cat.pyc
+-rw-r--r--  2.0 unx     9150 b- defN 24-Jun-02 16:24 runningz/model/tree/model_cat_py.pyc
+-rw-r--r--  2.0 unx     2815 b- defN 24-Jun-02 16:24 runningz/model/tree/model_erf.pyc
+-rw-r--r--  2.0 unx     8440 b- defN 24-Jun-02 16:24 runningz/model/tree/model_lgb.pyc
+-rw-r--r--  2.0 unx    12393 b- defN 24-Jun-02 16:24 runningz/model/tree/model_lgb_py.pyc
+-rw-r--r--  2.0 unx     2829 b- defN 24-Jun-02 16:24 runningz/model/tree/model_rf.pyc
+-rw-r--r--  2.0 unx     3677 b- defN 24-Jun-02 16:24 runningz/model/tree/model_xgb.pyc
+-rw-r--r--  2.0 unx      349 b- defN 24-Jun-02 16:24 runningz/opt/__init__.pyc
+-rw-r--r--  2.0 unx      152 b- defN 24-Jun-02 16:24 runningz/opt/opt_convex.pyc
+-rw-r--r--  2.0 unx    12130 b- defN 24-Jun-02 16:24 runningz/opt/opt_elo.pyc
+-rw-r--r--  2.0 unx     2320 b- defN 24-Jun-02 16:24 runningz/opt/opt_optuna.pyc
+-rw-r--r--  2.0 unx     6914 b- defN 24-Jun-02 16:24 runningz/opt/opt_random.pyc
+-rw-r--r--  2.0 unx     9665 b- defN 24-Jun-02 16:24 runningz/opt/opt_random_py.pyc
+-rw-r--r--  2.0 unx      927 b- defN 24-Jun-02 16:24 runningz/opt/opt_scipy.pyc
+-rw-r--r--  2.0 unx     3556 b- defN 24-Jun-02 16:24 runningz/opt/opt_sgd.pyc
+-rw-r--r--  2.0 unx      150 b- defN 24-Jun-02 16:24 runningz/res/__init__.pyc
+-rw-r--r--  2.0 unx     1180 b- defN 24-Jun-02 16:24 runningz/res/res_dates.pyc
+-rw-r--r--  2.0 unx     1498 b- defN 24-Jun-02 16:24 runningz/res/res_dates_py.pyc
+-rw-r--r--  2.0 unx     1680 b- defN 24-Jun-02 16:24 runningz/res/res_labels.pyc
+-rw-r--r--  2.0 unx     3050 b- defN 24-Jun-02 16:24 runningz/res/res_labels_py.pyc
+-rw-r--r--  2.0 unx    11914 b- defN 24-Jun-02 16:24 runningz/res/res_main.pyc
+-rw-r--r--  2.0 unx    21483 b- defN 24-Jun-02 16:24 runningz/res/res_main_py.pyc
+-rw-r--r--  2.0 unx      301 b- defN 24-Jun-02 16:24 runningz/res/res_run.pyc
+-rw-r--r--  2.0 unx     1993 b- defN 24-Jun-02 16:24 runningz/res/res_run_py.pyc
+-rw-r--r--  2.0 unx      971 b- defN 24-Jun-02 16:24 runningz/res/res_seeds.pyc
+-rw-r--r--  2.0 unx     1183 b- defN 24-Jun-02 16:24 runningz/res/res_seeds_py.pyc
+-rw-r--r--  2.0 unx      157 b- defN 24-Jun-02 16:24 runningz/res/config/__init__.pyc
+-rw-r--r--  2.0 unx     1706 b- defN 24-Jun-02 16:24 runningz/res/config/res_config.pyc
+-rw-r--r--  2.0 unx     3923 b- defN 24-Jun-02 16:24 runningz/res/config/res_config_py.pyc
+-rw-r--r--  2.0 unx      153 b- defN 24-Jun-02 16:24 runningz/res/er/__init__.pyc
+-rw-r--r--  2.0 unx     9978 b- defN 24-Jun-02 16:24 runningz/res/er/pooler.pyc
+-rw-r--r--  2.0 unx    23432 b- defN 24-Jun-02 16:24 runningz/res/er/pooler_py.pyc
+-rw-r--r--  2.0 unx      155 b- defN 24-Jun-02 16:24 runningz/res/util/__init__.pyc
+-rw-r--r--  2.0 unx     2094 b- defN 24-Jun-02 16:24 runningz/res/util/util.pyc
+-rw-r--r--  2.0 unx     2564 b- defN 24-Jun-02 16:24 runningz/res/util/util_py.pyc
+-rw-r--r--  2.0 unx      172 b- defN 24-Jun-02 16:24 runningz/util/__init__.pyc
+-rw-r--r--  2.0 unx     1813 b- defN 24-Jun-02 16:24 runningz/util/api.pyc
+-rw-r--r--  2.0 unx     2062 b- defN 24-Jun-02 16:24 runningz/util/clss.pyc
+-rw-r--r--  2.0 unx    49101 b- defN 24-Jun-02 16:24 runningz/util/code.pyc
+-rw-r--r--  2.0 unx     3448 b- defN 24-Jun-02 16:24 runningz/util/const.pyc
+-rw-r--r--  2.0 unx     4372 b- defN 24-Jun-02 16:24 runningz/util/const_py.pyc
+-rw-r--r--  2.0 unx     1566 b- defN 24-Jun-02 16:24 runningz/util/csv.pyc
+-rw-r--r--  2.0 unx    12208 b- defN 24-Jun-02 16:24 runningz/util/db.pyc
+-rw-r--r--  2.0 unx      469 b- defN 24-Jun-02 16:24 runningz/util/debug.pyc
+-rw-r--r--  2.0 unx     2191 b- defN 24-Jun-02 16:24 runningz/util/dec.pyc
+-rw-r--r--  2.0 unx     9190 b- defN 24-Jun-02 16:24 runningz/util/dist.pyc
+-rw-r--r--  2.0 unx     3599 b- defN 24-Jun-02 16:24 runningz/util/env.pyc
+-rw-r--r--  2.0 unx     2172 b- defN 24-Jun-02 16:24 runningz/util/login.pyc
+-rw-r--r--  2.0 unx     4867 b- defN 24-Jun-02 16:24 runningz/util/mem.pyc
+-rw-r--r--  2.0 unx    20136 b- defN 24-Jun-02 16:24 runningz/util/npy.pyc
+-rw-r--r--  2.0 unx    68037 b- defN 24-Jun-02 16:24 runningz/util/npy_numba.pyc
+-rw-r--r--  2.0 unx    88353 b- defN 24-Jun-02 16:24 runningz/util/npy_numba_py.pyc
+-rw-r--r--  2.0 unx    25829 b- defN 24-Jun-02 16:24 runningz/util/npy_py.pyc
+-rw-r--r--  2.0 unx   702066 b- defN 24-Jun-02 16:24 runningz/util/pool.pyc
+-rw-r--r--  2.0 unx     9422 b- defN 24-Jun-02 16:24 runningz/util/run.pyc
+-rw-r--r--  2.0 unx     3974 b- defN 24-Jun-02 16:24 runningz/util/split.pyc
+-rw-r--r--  2.0 unx     5670 b- defN 24-Jun-02 16:24 runningz/util/test.pyc
+-rw-r--r--  2.0 unx     7503 b- defN 24-Jun-02 16:24 runningz/util/test_py.pyc
+-rw-r--r--  2.0 unx    18691 b- defN 24-Jun-02 16:24 runningz/util/util.pyc
+-rw-r--r--  2.0 unx      156 b- defN 24-Jun-02 16:24 runningz/util/temp/__init__.pyc
+-rw-r--r--  2.0 unx     1211 b- defN 24-Jun-02 16:24 runningz/util/temp/main.pyc
+-rw-r--r--  2.0 unx      510 b- defN 24-Jun-02 16:24 runningz-0.16.5.dist-info/METADATA
+-rw-r--r--  2.0 unx       82 b- defN 24-Jun-02 16:24 runningz-0.16.5.dist-info/WHEEL
+-rw-r--r--  2.0 unx       52 b- defN 24-Jun-02 16:24 runningz-0.16.5.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        9 b- defN 24-Jun-02 16:24 runningz-0.16.5.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    14559 b- defN 24-Jun-02 16:24 runningz-0.16.5.dist-info/RECORD
+171 files, 2012543 bytes uncompressed, 471399 bytes compressed:  76.6%
```

## zipnote {}

```diff
@@ -492,23 +492,23 @@
 
 Filename: runningz/util/temp/__init__.pyc
 Comment: 
 
 Filename: runningz/util/temp/main.pyc
 Comment: 
 
-Filename: runningz-0.16.4.dist-info/METADATA
+Filename: runningz-0.16.5.dist-info/METADATA
 Comment: 
 
-Filename: runningz-0.16.4.dist-info/WHEEL
+Filename: runningz-0.16.5.dist-info/WHEEL
 Comment: 
 
-Filename: runningz-0.16.4.dist-info/entry_points.txt
+Filename: runningz-0.16.5.dist-info/entry_points.txt
 Comment: 
 
-Filename: runningz-0.16.4.dist-info/top_level.txt
+Filename: runningz-0.16.5.dist-info/top_level.txt
 Comment: 
 
-Filename: runningz-0.16.4.dist-info/RECORD
+Filename: runningz-0.16.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## runningz/__init__.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:24 2024 UTC, .py size: 1326 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,22 +1,22 @@
-00000000: 610d 0d0a 0000 0000 84e2 5966 2e05 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 ff99 5c66 2e05 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 b200 0000 6400  .....@...s....d.
 00000030: 5a00 6401 5a01 6402 5a02 6403 6404 6c03  Z.d.Z.d.Z.d.d.l.
 00000040: 5a03 6503 6a04 a005 6405 a101 0100 6503  Z.e.j...d.....e.
 00000050: 6a04 a005 6406 a101 0100 6503 6a04 a005  j...d.....e.j...
 00000060: 6407 a101 0100 6403 6404 6c06 5a06 6408  d.....d.d.l.Z.d.
 00000070: 6506 6a07 6409 3c00 640a 640b 6c08 6d09  e.j.d.<.d.d.l.m.
 00000080: 5a09 6d0a 5a0a 6d0b 5a0b 6d0c 5a0c 0100  Z.m.Z.m.Z.m.Z...
 00000090: 640a 640c 6c0d 5400 640a 640d 6c0e 6d0f  d.d.l.T.d.d.l.m.
 000000a0: 5a0f 0100 640a 640e 6c0e 6d10 5a10 0100  Z...d.d.l.m.Z...
 000000b0: 640a 640f 6c0e 6d11 5a11 0100 6509 6506  d.d.l.m.Z...e.e.
 000000c0: 6a07 a012 6410 a101 8301 0100 6403 6404  j...d.......d.d.
 000000d0: 6c03 5a03 6411 6412 8400 5a13 6404 5300  l.Z.d.d...Z.d.S.
-000000e0: 2913 7a06 302e 3136 2e34 da08 7275 6e6e  ).z.0.16.4..runn
+000000e0: 2913 7a06 302e 3136 2e35 da08 7275 6e6e  ).z.0.16.5..runn
 000000f0: 696e 677a 5a07 5632 4c41 4245 4ce9 0000  ingzZ.V2LABEL...
 00000100: 0000 4e7a 022e 2f7a 032e 2e2f 7a06 2e2e  ..Nz../z.../z...
 00000110: 2f2e 2e2f da03 6f66 665a 0c4b 4d50 5f57  /../..offZ.KMP_W
 00000120: 4152 4e49 4e47 53e9 0100 0000 2904 da0e  ARNINGS.....)...
 00000130: 6973 5f76 616c 6964 5f74 6f6b 656e da0a  is_valid_token..
 00000140: 4461 7461 4d61 7374 6572 da08 4f50 4d61  DataMaster..OPMa
 00000150: 7374 6572 da04 494e 464f 2901 da01 2a29  ster..INFO)...*)
```

## runningz/core/op/OPMaster_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 15403 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 2b3c 0000  a.........Yf+<..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 2b3c 0000  a.........\f+<..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/core/op/__init___py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 7091 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 b31b 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 b31b 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/FEMaster_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 23702 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 965c 0000  a.........Yf.\..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 965c 0000  a.........\f.\..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_dump_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 3463 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 870d 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 870d 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_eval_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 7050 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 8a1b 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 8a1b 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/fe_main_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 8224 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 2020 0000  a.........Yf  ..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 2020 0000  a.........\f  ..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_opt_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 4926 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 3e13 0000  a.........Yf>...
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 3e13 0000  a.........\f>...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 5734 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 6616 0000  a.........Yff...
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 6616 0000  a.........\ff...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/config/fm_config_top_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 19685 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 e54c 0000  a.........Yf.L..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 e54c 0000  a.........\f.L..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/er/pooler_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 37980 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 5c94 0000  a.........Yf\...
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 5c94 0000  a.........\f\...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/er/ranker_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 12115 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 532f 0000  a.........YfS/..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 532f 0000  a.........\fS/..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/prepare_data/base_data.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sun May 26 06:35:35 2024 UTC, .py size: 19549 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 37d8 5266 5d4c 0000  a.......7.Rf]L..
+00000000: 610d 0d0a 0000 0000 499c 5c66 484d 0000  a.......I.\fHM..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 ca00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a04 6400 6401 6c05 5a06 6402  d.l.Z.d.d.l.Z.d.
 00000050: 6403 6c07 6d08 5a08 0100 6402 6404 6c09  d.l.m.Z...d.d.l.
 00000060: 6d0a 5a0a 6d0b 5a0b 6d0c 5a0c 0100 6402  m.Z.m.Z.m.Z...d.
 00000070: 6405 6c0d 6d0e 5a0e 0100 6402 6406 6c0f  d.l.m.Z...d.d.l.
@@ -74,16 +74,16 @@
 00000490: 6eda 0666 6f72 6d61 74da 0e52 6563 7572  n..format..Recur
 000004a0: 7369 6f6e 4572 726f 7229 01da 0e63 6f6c  sionError)...col
 000004b0: 5f6c 6162 656c 5f61 7267 7372 1300 0000  _label_argsr....
 000004c0: 7213 0000 0072 1400 0000 da15 636f 6c5f  r....r......col_
 000004d0: 6c61 6265 6c5f 6172 6773 5f32 5f6e 616d  label_args_2_nam
 000004e0: 6519 0000 0073 0a00 0000 0001 0c01 0a01  e....s..........
 000004f0: 0c01 0a02 722e 0000 00da 0054 6307 0000  ....r......Tc...
-00000500: 0000 0000 0000 0000 0027 0000 0009 0000  .........'......
-00000510: 0003 0000 0073 2603 0000 7c01 7c02 6702  .....s&...|.|.g.
+00000500: 0000 0000 0000 0000 0028 0000 0009 0000  .........(......
+00000510: 0003 0000 0073 8c03 0000 7c01 7c02 6702  .....s....|.|.g.
 00000520: 8900 8701 6601 6401 6402 8408 8800 4400  ....f.d.d.....D.
 00000530: 8301 7d07 6403 6402 8400 7c07 4400 8301  ..}.d.d...|.D...
 00000540: 7d08 7400 7c07 8800 6404 8d02 7d09 7c09  }.t.|...d...}.|.
 00000550: a001 8801 8800 1900 6a02 a003 a100 a101  ........j.......
 00000560: 7d09 7404 a005 7c09 a101 7d0a 7404 a005  }.t...|...}.t...
 00000570: 8801 8800 7c03 1700 6405 6701 1700 1900  ....|...d.g.....
 00000580: a101 7d0b 7c0a 6a06 7c0b 8800 6406 6407  ..}.|.j.|...d.d.
@@ -111,716 +111,732 @@
 000006e0: 8302 7d1a 7c16 7c1a 1400 7c19 1b00 640b  ..}.|.|...|...d.
 000006f0: 1800 7d1b 7407 6a13 7c1b 7407 a014 7c1b  ..}.t.j.|.t...|.
 00000700: a101 0f00 3c00 7415 7c0f 8301 7d1c 7c0d  ....<.t.|...}.|.
 00000710: a016 7404 a017 7c1c 7c1b a018 a100 a001  ..t...|.|.......
 00000720: 7407 6a19 a101 a102 a101 7d0d 719e 7c0b  t.j.......}.q.|.
 00000730: 8800 1900 7d1d 7c1d 6a06 7c0d 8800 6406  ....}.|.j.|...d.
 00000740: 6407 8d03 7d1e 7c1e 7d1f 740c 7c05 8301  d...}.|.}.t.|...
-00000750: 640c 6b04 9003 720a 7c05 a01a 640d a101  d.k...r.|...d...
+00000750: 640c 6b04 9003 7270 7c05 a01a 640d a101  d.k...rp|...d...
 00000760: 7d20 7c20 640c 1900 7c20 640b 6400 8502  } | d...| d.d...
 00000770: 1900 0200 7d21 7d22 640e 6402 8400 7c22  ....}!}"d.d...|"
 00000780: 4400 8301 7d22 7c21 640f 7600 9002 7288  D...}"|!d.v...r.
 00000790: 7c1f 7c22 640c 1900 1900 a009 a100 7d23  |.|"d.........}#
-000007a0: 6e70 7c21 6410 7600 9002 72a8 7c1f 7c22  np|!d.v...r.|.|"
+000007a0: 6ed6 7c21 6410 7600 9002 72a8 7c1f 7c22  n.|!d.v...r.|.|"
 000007b0: 1900 a009 a100 6a1b 640b 6411 8d01 7d23  ......j.d.d...}#
-000007c0: 6e50 7c21 6412 7600 9002 72ea 7c1f 7c22  nP|!d.v...r.|.|"
+000007c0: 6eb6 7c21 6412 7600 9002 72ea 7c1f 7c22  n.|!d.v...r.|.|"
 000007d0: 640c 1900 1900 a009 a100 7d24 7c1f 7c22  d.........}$|.|"
 000007e0: 640b 1900 1900 a009 a100 7d25 7407 a01c  d.........}%t...
 000007f0: 7c24 7c25 1400 640c 6b04 7c24 640c a103  |$|%..d.k.|$d...
-00000800: 7d23 6e0e 741d 6413 7c21 9b00 9d02 8301  }#n.t.d.|!......
-00000810: 8201 7c1f a016 7404 a017 6414 7c23 a102  ..|...t...d.|#..
-00000820: a101 7d1f 8700 6601 6415 6402 8408 7c1f  ..}...f.d.d...|.
-00000830: 6a1e 4400 8301 7d26 7c1f 7c26 6602 5300  j.D...}&|.|&f.S.
-00000840: 2916 4e63 0100 0000 0000 0000 0000 0000  ).Nc............
-00000850: 0200 0000 0600 0000 1300 0000 731e 0000  ............s...
-00000860: 0067 007c 005d 167d 0174 00a0 0188 007c  .g.|.].}.t.....|
-00000870: 0119 00a0 02a1 00a1 0191 0271 0453 0072  ...........q.S.r
-00000880: 1300 0000 2903 da02 6e70 da04 736f 7274  ....)...np..sort
-00000890: da06 756e 6971 7565 a902 7211 0000 00da  ..unique..r.....
-000008a0: 0363 6f6c 2901 da02 6466 7213 0000 0072  .col)...dfr....r
-000008b0: 1400 0000 da0a 3c6c 6973 7463 6f6d 703e  ......<listcomp>
-000008c0: 2300 0000 7216 0000 007a 2667 6574 5f64  #...r....z&get_d
-000008d0: 665f 6c61 6265 6c5f 6669 6e61 6c2e 3c6c  f_label_final.<l
-000008e0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
-000008f0: 3e63 0100 0000 0000 0000 0000 0000 0200  >c..............
-00000900: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
-00000910: 007c 005d 0c7d 0174 007c 0183 0191 0271  .|.].}.t.|.....q
-00000920: 0453 0072 1300 0000 2901 722a 0000 0072  .S.r....).r*...r
-00000930: 1000 0000 7213 0000 0072 1300 0000 7214  ....r....r....r.
-00000940: 0000 0072 3600 0000 2400 0000 7216 0000  ...r6...$...r...
-00000950: 00a9 01da 0763 6f6c 735f 6964 da03 4144  .....cols_id..AD
-00000960: 4ada 046c 6566 7429 02da 026f 6eda 0368  J..left)...on..h
-00000970: 6f77 7a28 5b2b 5d20 6765 745f 6466 5f6c  owz([+] get_df_l
-00000980: 6162 656c 5f66 696e 616c 2e63 6f6c 5f6c  abel_final.col_l
-00000990: 6162 656c 5f61 7267 7320 3d20 7202 0000  abel_args = r...
-000009a0: 00e9 ffff ffff 7221 0000 0072 0100 0000  ......r!...r....
-000009b0: da02 5f5f 6301 0000 0000 0000 0000 0000  ..__c...........
-000009c0: 0002 0000 0005 0000 0053 0000 0073 1800  .........S...s..
-000009d0: 0000 6700 7c00 5d10 7d01 7400 7401 7c01  ..g.|.].}.t.t.|.
-000009e0: 8301 8301 9102 7104 5300 7213 0000 0029  ......q.S.r....)
-000009f0: 0272 2e00 0000 7228 0000 0072 1000 0000  .r....r(...r....
-00000a00: 7213 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
-00000a10: 3600 0000 5100 0000 7216 0000 0029 015a  6...Q...r....).Z
-00000a20: 0352 4157 2901 5a03 4144 44a9 01da 0461  .RAW).Z.ADD....a
-00000a30: 7869 7329 015a 034d 554c 7a1b 6c61 6265  xis).Z.MULz.labe
-00000a40: 6c5f 6672 6f6d 5f73 7472 2065 7272 6f72  l_from_str error
-00000a50: 2c20 6f70 203d 20da 0e4c 4142 454c 5f46  , op = ..LABEL_F
-00000a60: 524f 4d5f 5354 5263 0100 0000 0000 0000  ROM_STRc........
-00000a70: 0000 0000 0200 0000 0400 0000 1300 0000  ................
-00000a80: 7318 0000 0067 007c 005d 107d 017c 0188  s....g.|.].}.|..
-00000a90: 0076 0172 047c 0191 0271 0453 0072 1300  .v.r.|...q.S.r..
-00000aa0: 0000 7213 0000 0072 3300 0000 7237 0000  ..r....r3...r7..
-00000ab0: 0072 1300 0000 7214 0000 0072 3600 0000  .r....r....r6...
-00000ac0: 5c00 0000 7216 0000 0029 1f72 0700 0000  \...r....).r....
-00000ad0: da06 6173 7479 7065 5a06 6474 7970 6573  ..astypeZ.dtypes
-00000ae0: 5a07 746f 5f64 6963 74da 0270 6c5a 0b66  Z.to_dict..plZ.f
-00000af0: 726f 6d5f 7061 6e64 6173 721a 0000 0072  rom_pandasr....r
-00000b00: 3000 0000 5a11 6173 636f 6e74 6967 756f  0...Z.ascontiguo
-00000b10: 7573 6172 7261 79da 0874 6f5f 6e75 6d70  usarray..to_nump
-00000b20: 795a 0772 6573 6861 7065 da05 7072 696e  yZ.reshape..prin
-00000b30: 7472 2a00 0000 7227 0000 0072 0800 0000  tr*...r'...r....
-00000b40: da03 6d61 78da 0569 736e 616e da05 7261  ..max..isnan..ra
-00000b50: 6e67 65da 036d 696e da03 6e61 6eda 0869  nge..min..nan..i
-00000b60: 7366 696e 6974 6572 2e00 0000 5a0c 7769  sfiniter....Z.wi
-00000b70: 7468 5f63 6f6c 756d 6e73 da06 5365 7269  th_columns..Seri
-00000b80: 6573 5a05 7261 7665 6c5a 0766 6c6f 6174  esZ.ravelZ.float
-00000b90: 3332 7226 0000 00da 046d 6561 6eda 0577  32r&.....mean..w
-00000ba0: 6865 7265 da13 4e6f 7449 6d70 6c65 6d65  here..NotImpleme
-00000bb0: 6e74 6564 4572 726f 72da 0763 6f6c 756d  ntedError..colum
-00000bc0: 6e73 2927 7235 0000 00da 0763 6f6c 5f74  ns)'r5.....col_t
-00000bd0: 6964 da06 636f 6c5f 6964 da0a 636f 6c73  id..col_id..cols
-00000be0: 5f70 7269 6365 da13 636f 6c5f 6c61 6265  _price..col_labe
-00000bf0: 6c5f 6172 6773 5f6c 6973 74da 0e6c 6162  l_args_list..lab
-00000c00: 656c 5f66 726f 6d5f 7374 72da 0776 6572  el_from_str..ver
-00000c10: 626f 7365 5a07 6964 5f6c 6973 74da 0573  boseZ.id_list..s
-00000c20: 6861 7065 5a09 6466 5f69 645f 616c 6c5a  hapeZ.df_id_allZ
-00000c30: 055f 6466 5f4c 5a05 5f64 665f 525a 0664  ._df_LZ._df_RZ.d
-00000c40: 665f 4c5f 525a 065f 6466 5f4c 325a 0561  f_L_RZ._df_L2Z.a
-00000c50: 5f61 646a 722d 0000 0072 3400 0000 da01  _adjr-...r4.....
-00000c60: 69da 016a da01 615a 0261 325a 0463 6f6c  i..j..aZ.a2Z.col
-00000c70: 325a 0361 646a 5a02 696a 5a06 6164 6a5f  2Z.adjZ.ijZ.adj_
-00000c80: 696a 5a03 615f 695a 0361 5f6a 5a05 615f  ijZ.a_iZ.a_jZ.a_
-00000c90: 6932 6ada 046e 616d 655a 065f 6466 5f52  i2j..nameZ._df_R
-00000ca0: 325a 095f 6466 5f52 325f 4c32 da0e 6466  2Z._df_R2_L2..df
-00000cb0: 5f6c 6162 656c 5f66 696e 616c da02 7373  _label_final..ss
-00000cc0: da02 6f70 da04 636f 6c73 7212 0000 005a  ..op..colsr....Z
-00000cd0: 0278 30da 0278 31da 0a63 6f6c 735f 6c61  .x0..x1..cols_la
-00000ce0: 6265 6c72 1300 0000 2902 7238 0000 0072  belr....).r8...r
-00000cf0: 3500 0000 7214 0000 00da 1267 6574 5f64  5...r......get_d
-00000d00: 665f 6c61 6265 6c5f 6669 6e61 6c21 0000  f_label_final!..
-00000d10: 0073 6800 0000 0001 0801 1201 0e01 0c01  .sh.............
-00000d20: 1402 0a01 1801 1002 0801 1801 0a01 1201  ................
-00000d30: 0c01 0a01 1801 0602 0c01 1801 1801 1202  ................
-00000d40: 1401 0e01 1e01 0e01 0e01 0c01 0e02 0e01  ................
-00000d50: 0e01 1001 1201 0801 2002 0801 1001 0403  ........ .......
-00000d60: 0e01 0a01 1601 0e01 0a01 1201 0a01 1601  ................
-00000d70: 0a01 1001 1001 1801 0e01 1201 1401 7262  ..............rb
-00000d80: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
-00000d90: 0800 0000 0500 0000 4300 0000 73c0 0000  ........C...s...
-00000da0: 007c 0164 0119 00a0 00a1 007d 027c 0064  .|.d.......}.|.d
-00000db0: 0119 00a0 00a1 007d 037c 037c 037c 0264  .......}.|.|.|.d
-00000dc0: 0219 006b 0419 007d 037c 017c 0164 0119  ...k...}.|.|.d..
-00000dd0: 007c 0264 0219 006b 0219 006a 0164 0364  .|.d...k...j.d.d
-00000de0: 048d 017d 0474 027c 0383 0164 056b 0272  ...}.t.|...d.k.r
-00000df0: 547c 0153 0067 007d 0574 0364 067c 039b  T|.S.g.}.t.d.|..
-00000e00: 009d 0283 0101 007c 0344 005d 1e7d 067c  .......|.D.].}.|
-00000e10: 04a0 04a1 007d 077c 067c 0764 013c 007c  .....}.|.|.d.<.|
-00000e20: 05a0 057c 07a1 0101 0071 6a74 066a 077c  ...|.....qjt.j.|
-00000e30: 0564 0564 078d 026a 0164 0364 048d 017d  .d.d...j.d.d...}
-00000e40: 0774 066a 077c 017c 0767 0264 0564 0864  .t.j.|.|.g.d.d.d
-00000e50: 098d 036a 0164 0364 048d 017d 017c 0153  ...j.d.d...}.|.S
-00000e60: 0029 0a4e 5a0a 7472 6164 655f 6461 7465  .).NZ.trade_date
-00000e70: 723d 0000 0054 a901 da04 6472 6f70 7201  r=...T....dropr.
-00000e80: 0000 007a 115b 2b5d 2064 6174 6573 5f74  ...z.[+] dates_t
-00000e90: 6f64 6f20 3d20 723f 0000 0046 2902 7240  odo = r?...F).r@
-00000ea0: 0000 0072 3100 0000 2908 7232 0000 00da  ...r1...).r2....
-00000eb0: 0b72 6573 6574 5f69 6e64 6578 722a 0000  .reset_indexr*..
-00000ec0: 0072 4500 0000 da04 636f 7079 da06 6170  .rE.....copy..ap
-00000ed0: 7065 6e64 da02 7064 da06 636f 6e63 6174  pend..pd..concat
-00000ee0: 2908 da04 6466 5f4c da04 6466 5f52 5a0a  )...df_L..df_RZ.
-00000ef0: 6461 7465 735f 6861 7665 5a0a 6461 7465  dates_haveZ.date
-00000f00: 735f 746f 646f 5a09 6466 5f52 5f6c 6173  s_todoZ.df_R_las
-00000f10: 745a 0c64 665f 6e65 7874 5f6c 6973 74da  tZ.df_next_list.
-00000f20: 0464 6174 655a 0764 665f 6e65 7874 7213  .dateZ.df_nextr.
-00000f30: 0000 0072 1300 0000 7214 0000 00da 0d64  ...r....r......d
-00000f40: 665f 6578 7061 6e64 5f4c 5f52 5f00 0000  f_expand_L_R_...
-00000f50: 731c 0000 0000 010c 010c 0110 011c 0110  s...............
-00000f60: 0104 010e 0108 0108 0108 010c 0116 011c  ................
-00000f70: 0172 6d00 0000 6305 0000 0000 0000 0000  .rm...c.........
-00000f80: 0000 0022 0000 000d 0000 0043 0000 0073  ...".......C...s
-00000f90: f604 0000 7c01 a000 7c02 7c03 6702 6401  ....|...|.|.g.d.
-00000fa0: 6402 6702 1700 a101 7d05 7401 7c00 7c04  d.g.....}.t.|.|.
-00000fb0: 6403 8d02 7d06 7c06 a002 a100 0100 7c02  d...}.|.......|.
-00000fc0: 7c03 6702 7d07 7c05 7c07 1900 7d08 6404  |.g.}.|.|...}.d.
-00000fd0: 7d09 7c06 6a03 6405 7c03 6701 7c09 6701  }.|.j.d.|.g.|.g.
-00000fe0: 1700 6406 8d02 7d0a 7c0a 7c0a 6404 1900  ..d...}.|.|.d...
-00000ff0: 6407 6b04 1900 6a04 6408 6409 8d01 7d0a  d.k...j.d.d...}.
-00001000: 7405 7c08 7c0a 7c03 6701 8303 7c09 1900  t.|.|.|.g...|...
-00001010: a006 a100 7d0b 640a 7d09 7c06 6a03 640b  ....}.d.}.|.j.d.
-00001020: 7c07 7c09 6701 1700 6406 8d02 7d0a 7407  |.|.g...d...}.t.
-00001030: 7c08 7c0a 8302 7d0a 7405 7c08 7c0a 7c07  |.|...}.t.|.|.|.
-00001040: 8303 640a 1900 a006 a100 a008 6407 a101  ..d.........d...
-00001050: 7d0c 640c 7d09 7c06 6a03 640d 7c07 7c09  }.d.}.|.j.d.|.|.
-00001060: 6701 1700 6406 8d02 7d0a 7407 7c08 7c0a  g...d...}.t.|.|.
-00001070: 8302 7d0a 7405 7c08 7c0a 7c07 8303 640c  ..}.t.|.|.|...d.
-00001080: 1900 a006 a100 a008 6407 a101 7d0d 7c05  ........d...}.|.
-00001090: 7c07 6401 6402 6702 1700 1900 7d0e 7c0b  |.d.d.g.....}.|.
-000010a0: 7c0e 6404 3c00 7c0c 7c0e 640a 3c00 7c0d  |.d.<.|.|.d.<.|.
-000010b0: 7c0e 640c 3c00 7c0e 7c02 1900 a009 a100  |.d.<.|.|.......
-000010c0: 6a04 6408 6409 8d01 7d0f 740a 740b 7c0f  j.d.d...}.t.t.|.
-000010d0: 740c 6a0d 7c0f 640e 640f 8d02 8302 8301  t.j.|.d.d.......
-000010e0: 7d10 7c0e 6404 1900 a009 a100 6a04 6408  }.|.d.......j.d.
-000010f0: 6409 8d01 7d0f 740a 740b 7c0f 740c 6a0d  d...}.t.t.|.t.j.
-00001100: 7c0f 640e 640f 8d02 8302 8301 7d11 7c0e  |.d.d.......}.|.
-00001110: 7c02 1900 a00e 7c10 a101 7c0e 6404 1900  |.....|...|.d...
-00001120: a00e 7c11 a101 1800 6a0f 6a10 6410 6b05  ..|.....j.j.d.k.
-00001130: 7d12 7c0e 6401 1900 a011 a100 0f00 7d13  }.|.d.........}.
-00001140: 7c0e 640a 1900 6407 6b01 7d14 7c0e 640c  |.d...d.k.}.|.d.
-00001150: 1900 6411 6b01 7d15 6412 7c03 9b00 6413  ..d.k.}.d.|...d.
-00001160: 7c02 9b00 6414 9d05 6415 7c03 9b00 6413  |...d...d.|...d.
-00001170: 7c02 9b00 6416 9d05 6417 7c03 9b00 6413  |...d...d.|...d.
-00001180: 7c02 9b00 6418 9d05 6419 7c03 9b00 641a  |...d...d.|...d.
-00001190: 7c02 9b00 6414 9d05 641b 7c03 9b00 641a  |...d...d.|...d.
-000011a0: 7c02 9b00 6416 9d05 641c 7c03 9b00 641a  |...d...d.|...d.
-000011b0: 7c02 9b00 6418 9d05 641d 7c03 9b00 641e  |...d...d.|...d.
-000011c0: 7c02 9b00 6414 9d05 641f 7c03 9b00 641e  |...d...d.|...d.
-000011d0: 7c02 9b00 6416 9d05 6420 7c03 9b00 641e  |...d...d |...d.
-000011e0: 7c02 9b00 6418 9d05 6709 7d16 7c01 6a12  |...d...g.}.|.j.
-000011f0: 7c16 6421 6403 8d02 0100 7c01 a013 6422  |.d!d.....|...d"
-00001200: a101 6423 6b01 7d17 7c17 7c01 a013 6424  ..d#k.}.|.|...d$
-00001210: a101 6423 6b01 4d00 7d17 7c17 7c01 a013  ..d#k.M.}.|.|...
-00001220: 6425 a101 6423 6b01 4d00 7d17 7414 a015  d%..d#k.M.}.t...
-00001230: 7c01 a013 6426 a101 7c01 a013 6427 a101  |...d&..|...d'..
-00001240: 1b00 6411 1800 a101 6428 6b01 7d18 7c18  ..d.....d(k.}.|.
-00001250: 7414 a015 7c01 a013 6429 a101 7c01 a013  t...|...d)..|...
-00001260: 642a a101 1b00 6411 1800 a101 6428 6b01  d*....d.....d(k.
-00001270: 4d00 7d18 7c18 7414 a015 7c01 a013 642b  M.}.|.t...|...d+
-00001280: a101 7c01 a013 642c a101 1b00 6411 1800  ..|...d,....d...
-00001290: a101 6428 6b01 4d00 7d18 7414 a015 7c01  ..d(k.M.}.t...|.
-000012a0: a013 6426 a101 7c01 a013 6427 a101 1800  ..d&..|...d'....
-000012b0: 6407 1800 a101 642d 6b01 7d19 7c19 7414  d.....d-k.}.|.t.
-000012c0: a015 7c01 a013 6429 a101 7c01 a013 642a  ..|...d)..|...d*
-000012d0: a101 1800 6407 1800 a101 642d 6b01 4d00  ....d.....d-k.M.
-000012e0: 7d19 7c19 7414 a015 7c01 a013 642b a101  }.|.t...|...d+..
-000012f0: 7c01 a013 642c a101 1800 6407 1800 a101  |...d,....d.....
-00001300: 642d 6b01 4d00 7d19 7c01 6a16 7c16 6421  d-k.M.}.|.j.|.d!
-00001310: 6403 8d02 0100 7c17 7c18 4200 7c19 4200  d.....|.|.B.|.B.
-00001320: 0f00 7d1a 7c05 7c03 1900 a017 a100 7d1b  ..}.|.|.......}.
-00001330: 740c a018 7c1b a101 a019 741a a101 642e  t...|.....t...d.
-00001340: 6b01 7d1c 7c05 7c03 1900 a00e 740a 740b  k.}.|.|.....t.t.
-00001350: 7c1b 7c1c 8302 8301 a101 6408 6b02 7d1d  |.|.......d.k.}.
-00001360: 7c04 9003 72da 741b 642f 8301 0100 7c14  |...r.t.d/....|.
-00001370: a01c 7414 6a1d a101 7c0e 6430 3c00 7c13  ..t.j...|.d0<.|.
-00001380: 7c12 4000 7c14 4000 7c15 4000 a01c 7414  |.@.|.@.|.@...t.
-00001390: 6a1d a101 7c0e 6431 3c00 7c04 9004 7222  j...|.d1<.|...r"
-000013a0: 741b 6432 7c0e 6431 1900 a01e a100 9b00  t.d2|.d1........
-000013b0: 9d02 8301 0100 7c04 9004 7240 741b 6432  ......|...r@t.d2
-000013c0: 7c0e 6431 1900 a01e a100 9b00 6433 9d03  |.d1........d3..
-000013d0: 8301 0100 7c0e 6431 1900 7c1d 4000 a01c  ....|.d1..|.@...
-000013e0: 7414 6a1d a101 7c0e 6431 3c00 7c04 9004  t.j...|.d1<.|...
-000013f0: 7276 741b 6432 7c0e 6431 1900 a01e a100  rvt.d2|.d1......
-00001400: 9b00 6434 9d03 8301 0100 7c0e 6402 1900  ..d4......|.d...
-00001410: a011 a100 7d1e 7c14 6411 6b02 7c0e 6402  ....}.|.d.k.|.d.
-00001420: 1900 a015 a100 6435 6b01 4000 7d1f 7c14  ......d5k.@.}.|.
-00001430: 6407 6b02 7c0e 6402 1900 a015 a100 6436  d.k.|.d.......d6
-00001440: 6b01 4000 7d20 7c1f 7c20 4200 7c1e 4200  k.@.} |.| B.|.B.
-00001450: a01c 7414 6a1d a101 7c0e 6437 3c00 7c0e  ..t.j...|.d7<.|.
-00001460: 6431 1900 7c0e 6437 1900 4000 7c0e 6438  d1..|.d7..@.|.d8
-00001470: 3c00 6700 6439 a201 7d21 7c06 a01f a100  <.g.d9..}!|.....
-00001480: 0100 7c0e 7c21 6602 5300 293a 4eda 046f  ..|.|!f.S.):N..o
-00001490: 7065 6e5a 0770 6374 5f63 6867 a901 7256  penZ.pct_chg..rV
-000014a0: 0000 005a 096c 6973 745f 6461 7465 5a0c  ...Z.list_dateZ.
-000014b0: 6466 5f6c 6973 745f 6461 7465 2901 725f  df_list_date).r_
-000014c0: 0000 0072 0100 0000 5472 6300 0000 5a02  ...r....Trc...Z.
-000014d0: 5354 5a05 6466 5f73 745a 0353 5553 5a06  STZ.df_stZ.SUSZ.
-000014e0: 6466 5f73 7573 7a06 2559 256d 2564 2901  df_susz.%Y%m%d).
-000014f0: 722b 0000 00e9 1400 0000 7221 0000 007a  r+........r!...z
-00001500: 195f 5f54 454d 505f 615f 3120 3d20 726f  .__TEMP_a_1 = ro
-00001510: 6c6c 2873 6869 6674 2c20 7a0a 2c20 616d  ll(shift, z., am
-00001520: 6f75 6e74 2c20 7a04 2c20 3029 7a19 5f5f  ount, z., 0)z.__
-00001530: 5445 4d50 5f61 5f32 203d 2072 6f6c 6c28  TEMP_a_2 = roll(
-00001540: 7368 6966 742c 20fa 042c 2031 297a 195f  shift, .., 1)z._
-00001550: 5f54 454d 505f 615f 3320 3d20 726f 6c6c  _TEMP_a_3 = roll
-00001560: 2873 6869 6674 2c20 7a04 2c20 3229 7a19  (shift, z., 2)z.
-00001570: 5f5f 5445 4d50 5f68 5f31 203d 2072 6f6c  __TEMP_h_1 = rol
-00001580: 6c28 7368 6966 742c 207a 082c 2068 6967  l(shift, z., hig
-00001590: 682c 207a 195f 5f54 454d 505f 685f 3220  h, z.__TEMP_h_2 
-000015a0: 3d20 726f 6c6c 2873 6869 6674 2c20 7a19  = roll(shift, z.
-000015b0: 5f5f 5445 4d50 5f68 5f33 203d 2072 6f6c  __TEMP_h_3 = rol
-000015c0: 6c28 7368 6966 742c 207a 195f 5f54 454d  l(shift, z.__TEM
-000015d0: 505f 6c5f 3120 3d20 726f 6c6c 2873 6869  P_l_1 = roll(shi
-000015e0: 6674 2c20 7a07 2c20 6c6f 772c 207a 195f  ft, z., low, z._
-000015f0: 5f54 454d 505f 6c5f 3220 3d20 726f 6c6c  _TEMP_l_2 = roll
-00001600: 2873 6869 6674 2c20 7a19 5f5f 5445 4d50  (shift, z.__TEMP
-00001610: 5f6c 5f33 203d 2072 6f6c 6c28 7368 6966  _l_3 = roll(shif
-00001620: 742c 2046 5a0a 5f5f 5445 4d50 5f61 5f31  t, FZ.__TEMP_a_1
-00001630: 6700 0000 00d0 1253 415a 0a5f 5f54 454d  g......SAZ.__TEM
-00001640: 505f 615f 325a 0a5f 5f54 454d 505f 615f  P_a_2Z.__TEMP_a_
-00001650: 335a 0a5f 5f54 454d 505f 685f 315a 0a5f  3Z.__TEMP_h_1Z._
-00001660: 5f54 454d 505f 6c5f 3167 fca9 f1d2 4d62  _TEMP_l_1g....Mb
-00001670: 603f 5a0a 5f5f 5445 4d50 5f68 5f32 5a0a  `?Z.__TEMP_h_2Z.
-00001680: 5f5f 5445 4d50 5f6c 5f32 5a0a 5f5f 5445  __TEMP_l_2Z.__TE
-00001690: 4d50 5f68 5f33 5a0a 5f5f 5445 4d50 5f6c  MP_h_3Z.__TEMP_l
-000016a0: 5f33 677b 14ae 47e1 7aa4 3f72 0200 0000  _3g{..G.z.?r....
-000016b0: 7a16 5b2b 5d20 5354 2c20 4b4a 592c 205a  z.[+] ST, KJY, Z
-000016c0: 4454 2c20 4d41 534b da07 4d41 534b 5f53  DT, MASK..MASK_S
-000016d0: 54da 084d 4153 4b5f 4b4a 597a 205b 2b5d  T..MASK_KJYz [+]
-000016e0: 2064 665f 6d61 736b 5b27 4d41 534b 5f4b   df_mask['MASK_K
-000016f0: 4a59 275d 2e73 756d 2829 203d 207a 172c  JY'].sum() = z.,
-00001700: 2061 6674 6572 2026 3d20 6d61 736b 5f6b   after &= mask_k
-00001710: 6a79 5f74 7672 7a16 2c20 6166 7465 7220  jy_tvrz., after 
-00001720: 263d 206d 6173 6b5f 6b6a 795f 6964 6700  &= mask_kjy_idg.
-00001730: 0000 0000 0023 4067 0000 0000 0000 1340  .....#@g.......@
-00001740: da08 4d41 534b 5f5a 4454 da04 4d41 534b  ..MASK_ZDT..MASK
-00001750: a904 7272 0000 0072 7300 0000 7274 0000  ..rr...rs...rt..
-00001760: 0072 7500 0000 2920 da0f 6765 745f 636f  .ru...) ..get_co
-00001770: 6c73 5f70 616e 6461 7372 0a00 0000 da07  ls_pandasr......
-00001780: 636f 6e6e 6563 74da 0673 656c 6563 7472  connect..selectr
-00001790: 6500 0000 7205 0000 005a 0974 6f5f 7061  e...r....Z.to_pa
-000017a0: 6e64 6173 726d 0000 005a 0666 696c 6c6e  ndasrm...Z.filln
-000017b0: 61da 0f64 726f 705f 6475 706c 6963 6174  a..drop_duplicat
-000017c0: 6573 da04 6469 6374 da03 7a69 7072 6800  es..dict..ziprh.
-000017d0: 0000 5a0b 746f 5f64 6174 6574 696d 65da  ..Z.to_datetime.
-000017e0: 036d 6170 da02 6474 da04 6461 7973 5a06  .map..dt..daysZ.
-000017f0: 6973 6e75 6c6c da05 6665 5f67 6fda 0d67  isnull..fe_go..g
-00001800: 6574 5f63 6f6c 5f6e 756d 7079 7230 0000  et_col_numpyr0..
-00001810: 00da 0361 6273 7264 0000 0072 3200 0000  ...absrd...r2...
-00001820: 724c 0000 00da 0561 7070 6c79 7206 0000  rL.....applyr...
-00001830: 0072 4500 0000 7242 0000 00da 0569 6e74  .rE...rB.....int
-00001840: 3332 da03 7375 6dda 0563 6c6f 7365 2922  32..sum..close)"
-00001850: da07 7061 7468 5f64 62da 0264 6d72 5100  ..path_db..dmrQ.
-00001860: 0000 7252 0000 0072 5600 0000 7235 0000  ..rR...rV...r5..
-00001870: 005a 0264 62da 046b 6579 7372 6a00 0000  .Z.db..keysrj...
-00001880: 7234 0000 0072 6b00 0000 5a0b 735f 6c69  r4...rk...Z.s_li
-00001890: 7374 5f64 6174 655a 0473 5f73 745a 0573  st_dateZ.s_stZ.s
-000018a0: 5f73 7573 da07 6466 5f6d 6173 6bda 0173  _sus..df_mask..s
-000018b0: 5a0b 6461 7465 5f64 6963 745f 315a 0b64  Z.date_dict_1Z.d
-000018c0: 6174 655f 6469 6374 5f32 5a06 6964 785f  ate_dict_2Z.idx_
-000018d0: 3230 5a07 6964 785f 6e61 6e5a 0669 6478  20Z.idx_nanZ.idx
-000018e0: 5f73 745a 0769 6478 5f73 7573 da09 6e61  _stZ.idx_sus..na
-000018f0: 6d65 5f6c 6973 745a 0569 6478 5f61 5a0d  me_listZ.idx_aZ.
-00001900: 6964 785f 696e 7472 615f 7265 745a 0d69  idx_intra_retZ.i
-00001910: 6478 5f69 6e74 7261 5f64 6966 5a0c 6d61  dx_intra_difZ.ma
-00001920: 736b 5f6b 6a79 5f74 7672 5a04 6964 5f6b  sk_kjy_tvrZ.id_k
-00001930: 5a04 6964 5f76 5a0b 6d61 736b 5f6b 6a79  Z.id_vZ.mask_kjy
-00001940: 5f69 645a 0c6d 6173 6b5f 7a64 745f 6e61  _idZ.mask_zdt_na
-00001950: 6e5a 0b6d 6173 6b5f 7a64 745f 3130 5a0b  nZ.mask_zdt_10Z.
-00001960: 6d61 736b 5f7a 6474 5f73 74da 0963 6f6c  mask_zdt_st..col
-00001970: 735f 6d61 736b 7213 0000 0072 1300 0000  s_maskr....r....
-00001980: 7214 0000 00da 0b67 6574 5f64 665f 6d61  r......get_df_ma
-00001990: 736b 6f00 0000 738a 0000 0000 0116 010c  sko...s.........
-000019a0: 0108 0208 0108 0304 0116 0118 0116 0304  ................
-000019b0: 0114 010a 011a 0304 0114 010a 011a 0410  ................
-000019c0: 0108 0108 0108 0214 0118 0114 0118 0324  ...............$
-000019d0: 010e 010c 010c 0410 0110 0110 0210 0110  ................
-000019e0: 0110 0210 0110 0110 f504 0d0e 010e 0112  ................
-000019f0: 0112 0222 0126 0126 0222 0126 0126 010e  ...".&.&.".&.&..
-00001a00: 010e 070c 0114 011c 030e 0110 021c 011c  ................
-00001a10: 021e 0118 011e 020c 0118 0118 0118 0114  ................
-00001a20: 0108 0108 0172 8e00 0000 6300 0000 0000  .....r....c.....
-00001a30: 0000 0000 0000 0000 0000 0003 0000 0040  ...............@
-00001a40: 0000 0073 1e00 0000 6500 5a01 6400 5a02  ...s....e.Z.d.Z.
-00001a50: 6401 6402 8400 5a03 6407 6405 6406 8401  d.d...Z.d.d.d...
-00001a60: 5a04 6403 5300 2908 da08 4261 7365 4461  Z.d.S.)...BaseDa
-00001a70: 7461 6305 0000 0000 0000 0000 0000 0005  tac.............
-00001a80: 0000 0002 0000 0043 0000 0073 0c00 0000  .......C...s....
-00001a90: 7400 6401 8301 8201 6400 5300 2902 4e7a  t.d.....d.S.).Nz
-00001aa0: 1e79 6f75 206e 6565 6420 746f 2069 6d70  .you need to imp
-00001ab0: 6c65 6d65 6e74 2067 6574 5f64 6628 2929  lement get_df())
-00001ac0: 0172 4f00 0000 2905 da04 7365 6c66 da0a  .rO...)...self..
-00001ad0: 7061 7468 5f69 6e70 7574 da0a 6461 7465  path_input..date
-00001ae0: 5f62 6567 696e da08 6461 7465 5f65 6e64  _begin..date_end
-00001af0: da06 6e5f 6a6f 6273 7213 0000 0072 1300  ..n_jobsr....r..
-00001b00: 0000 7214 0000 00da 0667 6574 5f64 66d6  ..r......get_df.
-00001b10: 0000 0073 0200 0000 0001 7a0f 4261 7365  ...s......z.Base
-00001b20: 4461 7461 2e67 6574 5f64 664e 5463 0400  Data.get_dfNTc..
-00001b30: 0000 0000 0000 0000 0000 2700 0000 0b00  ..........'.....
-00001b40: 0000 0300 0000 73d0 0900 0074 006a 017d  ......s....t.j.}
-00001b50: 047c 0164 0119 007d 057c 0164 0219 007d  .|.d...}.|.d...}
-00001b60: 067c 0164 0319 007d 077c 0164 0419 007d  .|.d...}.|.d...}
-00001b70: 087c 0764 0519 0089 007c 0764 0619 007d  .|.d.....|.d...}
-00001b80: 097c 0764 0719 007d 0a7c 0764 0819 0089  .|.d...}.|.d....
-00001b90: 017c 0264 0075 0072 767c 006a 027c 0467  .|.d.u.rv|.j.|.g
-00001ba0: 017c 0564 0919 00a2 017c 0691 0152 0064  .|.d.....|...R.d
-00001bb0: 0a7c 08a0 0364 0a64 0ba1 0269 018e 017d  .|...d.d...i...}
-00001bc0: 0264 0c74 0474 057c 0283 0183 0176 0072  .d.t.t.|.....v.r
-00001bd0: 8c7c 027d 0b6e 1c7c 026a 0664 0b64 0b64  .|.}.n.|.j.d.d.d
-00001be0: 0d8d 0201 0074 077c 0264 0e64 0b64 0f8d  .....t.|.d.d.d..
-00001bf0: 037d 0b7c 0b6a 0888 0167 0164 0e64 108d  .}.|.j...g.d.d..
-00001c00: 0201 007c 0372 c474 0964 1183 0101 0064  ...|.r.t.d.....d
-00001c10: 1288 009b 0064 1388 019b 0064 149d 057d  .....d.....d...}
-00001c20: 0c7c 0b6a 0864 157c 0c9b 0064 169d 0367  .|.j.d.|...d...g
-00001c30: 017c 0364 108d 0201 007c 0b6a 0a7c 0c67  .|.d.....|.j.|.g
-00001c40: 0164 0e64 108d 0201 0064 1764 1867 027d  .d.d.....d.d.g.}
-00001c50: 0d64 197c 0ba0 0ba1 006a 0c76 0190 0172  .d.|.....j.v...r
-00001c60: 207c 0d64 1a67 0137 007d 0d7c 0b6a 087c   |.d.g.7.}.|.j.|
-00001c70: 0d64 0e64 108d 0201 0067 007d 0d67 0064  .d.d.....g.}.g.d
-00001c80: 1ba2 0164 1c67 0117 0044 005d 567d 0c64  ...d.g...D.]V}.d
-00001c90: 1d7c 0ba0 0ba1 006a 0c76 0190 0172 787c  .|.....j.v...rx|
-00001ca0: 0d64 1e7c 0c9b 0064 1f88 009b 0064 207c  .d.|...d.....d |
-00001cb0: 0c9b 0064 2088 019b 0064 149d 0967 0137  ...d ....d...g.7
-00001cc0: 007d 0d7c 0d7c 0c9b 0064 217c 0c9b 0064  .}.|.|...d!|...d
-00001cd0: 207c 0c9b 0064 229d 0667 0137 007d 0d90   |...d"..g.7.}..
-00001ce0: 0171 407c 0b6a 087c 0d64 0e64 108d 0201  .q@|.j.|.d.d....
-00001cf0: 007c 08a0 0364 2364 24a1 027d 0e74 0d7c  .|...d#d$..}.t.|
-00001d00: 0e83 0164 256b 0490 0172 ec64 267d 0f7c  ...d%k...r.d&}.|
-00001d10: 0ea0 0e64 27a1 0164 2864 0085 0219 007d  ...d'..d(d.....}
-00001d20: 1074 0fa0 1064 2964 2a84 007c 1044 0083  .t...d)d*..|.D..
-00001d30: 01a1 017d 116e 3874 117c 0864 2b19 0083  ...}.n8t.|.d+...
-00001d40: 017d 0f7c 0864 2b19 0067 017d 1074 0fa0  .}.|.d+..g.}.t..
-00001d50: 1064 2c64 2a84 007c 0fa0 0e64 2da1 0164  .d,d*..|...d-..d
-00001d60: 2e64 2f85 0219 0044 0083 01a1 017d 117c  .d/....D.....}.|
-00001d70: 107c 08a0 0364 3067 00a1 0237 007d 1064  .|...d0g...7.}.d
-00001d80: 3164 2a84 007c 1044 0083 017d 1074 1274  1d*..|.D...}.t.t
-00001d90: 13a0 147c 10a1 01a0 15a1 0083 017d 107c  ...|.........}.|
-00001da0: 107c 0864 303c 007c 0f7c 0864 323c 007c  .|.d0<.|.|.d2<.|
-00001db0: 0390 0272 7e74 0964 337c 0e9b 0064 347c  ...r~t.d3|...d4|
-00001dc0: 0f9b 009d 0483 0101 007c 0390 0272 9274  .........|...r.t
-00001dd0: 0964 357c 109b 009d 0283 0101 0064 3664  .d5|.........d6d
-00001de0: 2a84 007c 1044 0083 0164 3764 2a84 007c  *..|.D...d7d*..|
-00001df0: 1044 0083 0117 007d 1274 1274 13a0 147c  .D.....}.t.t...|
-00001e00: 12a1 01a0 15a1 0083 017d 127c 0ba0 1688  .........}.|....
-00001e10: 0188 0067 027c 1217 0064 3867 0117 00a1  ...g.|...d8g....
-00001e20: 017d 0274 177c 0288 0188 007c 127c 107c  .}.t.|.....|.|.|
-00001e30: 0e7c 08a0 0364 0a64 0ba1 0264 108d 075c  .|...d.d...d...\
-00001e40: 027d 137d 147c 1444 005d 167d 0c7c 0ba0  .}.}.|.D.].}.|..
-00001e50: 187c 0c7c 137c 0c19 00a1 0201 0090 0271  .|.|.|.........q
-00001e60: fe7c 1464 3967 0137 007d 1464 3a7c 0ba0  .|.d9g.7.}.d:|..
-00001e70: 0ba1 006a 0c76 0090 0372 3a7c 1464 3a67  ...j.v...r:|.d:g
-00001e80: 0137 007d 147c 147c 0164 0319 0064 3b3c  .7.}.|.|.d...d;<
-00001e90: 007c 0390 0372 5a74 0964 3c7c 149b 009d  .|...rZt.d<|....
-00001ea0: 0283 0101 007c 08a0 0364 3d64 00a1 027d  .....|...d=d...}
-00001eb0: 157c 0390 0372 8074 0964 3e7c 159b 0064  .|...r.t.d>|...d
-00001ec0: 347c 0f9b 009d 0483 0101 007c 1564 3f6b  4|.........|.d?k
-00001ed0: 0290 0372 e87c 0b6a 0864 407c 0f9b 0064  ...r.|.j.d@|...d
-00001ee0: 229d 0367 017c 0364 108d 0201 007c 0b6a  "..g.|.d.....|.j
-00001ef0: 087c 099b 0064 4188 019b 0064 207c 0f9b  .|...dA....d |..
-00001f00: 0064 229d 0667 017c 0364 108d 0201 0087  .d"..g.|.d......
-00001f10: 0166 0164 4264 2a84 087c 1444 0083 017d  .f.dBd*..|.D...}
-00001f20: 0d7c 0b6a 087c 0d7c 0364 2e64 438d 0301  .|.j.|.|.d.dC...
-00001f30: 006e 987c 1564 446b 0290 0472 287c 0b6a  .n.|.dDk...r(|.j
-00001f40: 0864 407c 0f9b 0064 229d 0367 017c 0364  .d@|...d"..g.|.d
-00001f50: 108d 0201 007c 0b6a 087c 099b 0064 457c  .....|.j.|...dE|
-00001f60: 0f9b 0064 229d 0467 017c 0364 108d 0201  ...d"..g.|.d....
-00001f70: 006e 587c 1564 466b 0290 0472 727c 0390  .nX|.dFk...rr|..
-00001f80: 0472 4074 0964 4783 0101 007c 0b6a 0864  .r@t.dG....|.j.d
-00001f90: 407c 099b 0064 229d 0367 017c 0364 108d  @|...d"..g.|.d..
-00001fa0: 0201 007c 097c 0ba0 0ba1 006a 0c76 0090  ...|.|.....j.v..
-00001fb0: 0473 804a 0064 4883 0182 016e 0e74 1964  .s.J.dH....n.t.d
-00001fc0: 3e7c 159b 009d 0283 0182 017c 0390 0472  >|.........|...r
-00001fd0: 8e74 0964 4983 0101 0074 1a6a 1ba0 1c74  .t.dI....t.j...t
-00001fe0: 1a6a 1ba0 1d7c 04a1 01a1 019b 0064 4a9d  .j...|.......dJ.
-00001ff0: 027d 167c 0390 0472 bc74 0964 4b7c 169b  .}.|...r.t.dK|..
-00002000: 009d 0283 0101 0074 1a6a 1ba0 1e7c 16a1  .......t.j...|..
-00002010: 0190 0472 fe74 1f7c 167c 0b88 0188 007c  ...r.t.|.|.....|
-00002020: 0364 108d 055c 027d 177d 187c 1844 005d  .d...\.}.}.|.D.]
-00002030: 167d 0c7c 0ba0 187c 0c7c 177c 0c19 00a1  .}.|...|.|.|....
-00002040: 0201 0090 0471 e46e 0c67 0064 4ca2 0104  .....q.n.g.dL...
-00002050: 007d 187d 187c 187c 0164 0319 0064 4d3c  .}.}.|.|.d...dM<
-00002060: 007c 0390 0572 2a74 0964 4e7c 189b 009d  .|...r*t.dN|....
-00002070: 0283 0101 0064 4f7c 0ba0 0ba1 006a 0c76  .....dO|.....j.v
-00002080: 0090 056f 4664 507c 0ba0 0ba1 006a 0c76  ...oFdP|.....j.v
-00002090: 007d 197c 1990 0573 5c74 1a6a 1ba0 1e7c  .}.|...s\t.j...|
-000020a0: 16a1 0190 0572 a874 0fa0 207c 0b6a 2164  .....r.t.. |.j!d
-000020b0: 5119 007c 0919 00a0 22a1 00a1 010f 00a0  Q..|....".......
-000020c0: 2374 0f6a 24a1 017d 1a7c 1a7c 0b6a 2164  #t.j$..}.|.|.j!d
-000020d0: 5119 0064 4f19 00a0 22a1 004d 007d 1a7c  Q..dO..."..M.}.|
-000020e0: 0b6a 2164 5119 0064 5019 00a0 22a1 007d  .j!dQ..dP..."..}
-000020f0: 1b6e 5674 0fa0 207c 0b6a 2164 5119 007c  .nVt.. |.j!dQ..|
-00002100: 0919 00a0 22a1 00a1 010f 00a0 2374 0f6a  ....".......#t.j
-00002110: 24a1 017d 1a7c 1a74 0fa0 207c 0b6a 2164  $..}.|.t.. |.j!d
-00002120: 5119 0064 5219 00a0 22a1 00a1 010f 00a0  Q..dR...".......
-00002130: 2374 0f6a 24a1 014d 007d 1a7c 0ba0 2564  #t.j$..M.}.|..%d
-00002140: 53a1 0164 286b 027d 1b7c 0ba0 267c 1aa0  S..d(k.}.|..&|..
-00002150: 2374 0f6a 24a1 0164 54a1 0201 007c 0ba0  #t.j$..dT....|..
-00002160: 267c 1ba0 2374 0f6a 24a1 0164 55a1 0201  &|..#t.j$..dU...
-00002170: 0064 0e90 0672 da74 1a6a 1ba0 1e7c 16a1  .d...r.t.j...|..
-00002180: 0190 0672 da7c 0ba0 0864 5688 019b 0064  ...r.|...dV....d
-00002190: 579d 0367 01a1 0101 007c 0b6a 1664 5888  W..g.....|.j.dX.
-000021a0: 019b 009d 0264 598d 017d 1c7c 1c7c 1c64  .....dY..}.|.|.d
-000021b0: 5688 019b 0064 579d 0319 00a0 27a1 0064  V....dW.....'..d
-000021c0: 5a6b 0419 0088 0119 006a 287d 1d7c 1d7c  Zk.......j(}.|.|
-000021d0: 1d7c 0564 0919 0064 2819 006b 0119 007d  .|.d...d(..k...}
-000021e0: 1d74 0964 5b74 0d7c 1d83 019b 0064 5c64  .t.d[t.|.....d\d
-000021f0: 20a0 2964 5d64 5e84 007c 1d44 0083 01a1   .)d]d^..|.D....
-00002200: 019b 0064 5f9d 0583 0101 007c 0ba0 2a88  ...d_......|..*.
-00002210: 01a1 01a0 2b74 2c7c 1d83 01a1 010f 006a  ....+t,|.......j
-00002220: 287d 1e6e 1074 0fa0 2d7c 1aa1 01a0 2374  (}.n.t..-|....#t
-00002230: 2ea1 017d 1e7c 1a7c 1b40 007d 1f7c 1f7c  ...}.|.|.@.}.|.|
-00002240: 1e4d 007d 1f7c 0ba0 267c 1f64 53a1 0201  .M.}.|..&|.dS...
-00002250: 007c 0ba0 1864 607c 1fa1 0201 007c 0390  .|...d`|.....|..
-00002260: 0772 8a74 0964 617c 1aa0 2fa1 009b 0064  .r.t.da|../....d
-00002270: 6274 0d7c 1a83 019b 0064 637c 1aa0 30a1  bt.|.....dc|..0.
-00002280: 009b 009d 0683 0101 0074 0964 647c 1ba0  .........t.dd|..
-00002290: 2fa1 009b 0064 6274 0d7c 1b83 019b 0064  /....dbt.|.....d
-000022a0: 637c 1ba0 30a1 009b 009d 0683 0101 0074  c|..0..........t
-000022b0: 0964 657c 1fa0 2fa1 009b 0064 6274 0d7c  .de|../....dbt.|
-000022c0: 1f83 019b 0064 637c 1fa0 30a1 009b 009d  .....dc|..0.....
-000022d0: 0683 0101 0064 667c 05a0 31a1 0076 0190  .....df|..1..v..
-000022e0: 0772 fc64 677c 05a0 31a1 0076 0090 0772  .r.dg|..1..v...r
-000022f0: b47c 0564 6719 007c 0564 663c 006e 4864  .|.dg..|.df<.nHd
-00002300: 687c 05a0 31a1 0076 0090 0772 d07c 0564  h|..1..v...r.|.d
-00002310: 6819 007c 0564 663c 006e 2c64 097c 05a0  h..|.df<.n,d.|..
-00002320: 31a1 0076 0090 0772 ec7c 0564 0919 007c  1..v...r.|.d...|
-00002330: 0564 663c 006e 1074 1964 697c 059b 0064  .df<.n.t.di|...d
-00002340: 6a9d 0383 0182 017c 0390 0872 1674 0964  j......|...r.t.d
-00002350: 6b7c 119b 0064 347c 0f9b 009d 0483 0101  k|...d4|........
-00002360: 007c 0b6a 2164 5119 0088 0119 00a0 22a1  .|.j!dQ.......".
-00002370: 007d 207c 05a0 31a1 0044 005d da7d 217c  .} |..1..D.].}!|
-00002380: 057c 2119 005c 027d 227d 237c 2164 6c76  .|!..\.}"}#|!dlv
-00002390: 0090 0872 7074 0fa0 327c 20a1 017d 2474  ...rpt..2| ..}$t
-000023a0: 0fa0 337c 247c 247c 236b 0119 00a1 0164  ..3|$|$|#k.....d
-000023b0: 287c 1117 000b 0019 007d 237c 207c 226b  (|.......}#| |"k
-000023c0: 057c 207c 236b 0140 007d 257c 2164 6d6b  .| |#k.@.}%|!dmk
-000023d0: 0390 0872 987c 257c 1fa0 2374 2ea1 014d  ...r.|%|..#t...M
-000023e0: 007d 257c 0b6a 267c 257c 2164 6e8d 0201  .}%|.j&|%|!dn...
-000023f0: 007c 0390 0872 3074 0d7c 207c 2519 0083  .|...r0t.| |%...
-00002400: 0164 256b 0490 0872 f674 0964 6f7c 2164  .d%k...r.t.do|!d
-00002410: 709b 0464 717c 207c 2519 00a0 34a1 009b  p..dq| |%...4...
-00002420: 0064 727c 207c 2519 00a0 10a1 009b 0064  .dr| |%........d
-00002430: 637c 25a0 2fa1 009b 009d 0883 0101 006e  c|%./..........n
-00002440: 1274 0964 6f7c 2164 709b 0464 739d 0383  .t.do|!dp..ds...
-00002450: 0101 0090 0871 307c 0390 0972 1a74 0964  .....q0|...r.t.d
-00002460: 7483 0101 007c 08a0 0364 7564 28a1 0289  t....|...dud(...
-00002470: 037c 0390 0972 3a74 0964 7688 039b 009d  .|...r:t.dv.....
-00002480: 0283 0101 0088 0088 017c 0967 037c 0a17  .........|.g.|..
-00002490: 007c 1417 007c 1817 007c 08a0 0364 7764  .|...|...|...dwd
-000024a0: 00a1 0267 0117 0089 0288 027c 08a0 0364  ...g.......|...d
-000024b0: 7867 00a1 0237 0089 0288 027c 0864 783c  xg...7.....|.dx<
-000024c0: 007c 0390 0972 8a74 0964 7988 029b 009d  .|...r.t.dy.....
-000024d0: 0283 0101 0087 0266 0164 7a64 2a84 087c  .......f.dzd*..|
-000024e0: 0ba0 0ba1 006a 0c44 0083 017d 2688 0364  .....j.D...}&..d
-000024f0: 256b 0390 0972 cc7c 0b6a 0887 0087 0187  %k...r.|.j......
-00002500: 0366 0364 7b64 2a84 087c 2644 0083 017c  .f.d{d*..|&D...|
-00002510: 0364 108d 0201 007c 0b53 0029 7c4e da09  .d.....|.S.)|N..
-00002520: 6461 7465 5f64 6963 7472 9400 0000 da09  date_dictr......
-00002530: 636f 6c73 5f64 6963 74da 0a6f 7468 6572  cols_dict..other
-00002540: 5f69 6e66 6f72 5200 0000 da09 636f 6c5f  _inforR.....col_
-00002550: 6c61 6265 6cda 0863 6f6c 735f 7469 6472  label..cols_tidr
-00002560: 5100 0000 da03 616c 6c72 5600 0000 5472  Q.....allrV...Tr
-00002570: 0300 0000 2902 7264 0000 005a 0769 6e70  ....).rd...Z.inp
-00002580: 6c61 6365 4629 0272 5600 0000 5a0a 6b65  laceF).rV...Z.ke
-00002590: 6570 5f73 7061 6365 726f 0000 007a 255b  ep_spacero...z%[
-000025a0: 696e 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d  init] <---------
-000025b0: 2d20 6c61 6265 6c20 2d2d 2d2d 2d2d 2d2d  - label --------
-000025c0: 2d2d 3e20 7a0c 726f 6c6c 2873 6869 6674  --> z.roll(shift
-000025d0: 2c20 7a0a 2c20 636c 6f73 652c 2020 7271  , z., close,  rq
-000025e0: 0000 007a 0a41 444a 203d 2064 6976 287a  ...z.ADJ = div(z
-000025f0: 0c2c 2070 7265 5f63 6c6f 7365 297a 1776  ., pre_close)z.v
-00002600: 7761 7020 3d20 6469 7628 616d 6f75 6e74  wap = div(amount
-00002610: 2c20 766f 6c29 7a25 6d65 616e 203d 206d  , vol)z%mean = m
-00002620: 6561 6e5f 6d28 6f70 656e 2c20 6869 6768  ean_m(open, high
-00002630: 2c20 6c6f 772c 2063 6c6f 7365 29da 0474  , low, close)..t
-00002640: 7761 707a 0e74 7761 7020 3d20 6f28 7677  wapz.twap = o(vw
-00002650: 6170 2929 0472 9c00 0000 5a04 7677 6170  ap)).r....Z.vwap
-00002660: 726e 0000 0072 8600 0000 724d 0000 007a  rn...r....rM...z
-00002670: 0970 7265 5f7b 636f 6c7d 5a04 7072 655f  .pre_{col}Z.pre_
-00002680: fa0f 203d 2072 6f6c 6c28 7368 6966 742c  .. = roll(shift,
-00002690: 20fa 022c 207a 0f5f 7265 7420 3d20 7265   .., z._ret = re
-000026a0: 7428 7072 655f fa01 2972 5500 0000 722f  t(pre_..)rU...r/
-000026b0: 0000 0072 0100 0000 7241 0000 0072 3e00  ...r....rA...r>.
-000026c0: 0000 7221 0000 0063 0100 0000 0000 0000  ..r!...c........
-000026d0: 0000 0000 0200 0000 0700 0000 5300 0000  ............S...
-000026e0: 7322 0000 0067 007c 005d 1a7d 0174 00a0  s"...g.|.].}.t..
-000026f0: 0174 027c 0183 0164 0064 0185 0219 00a1  .t.|...d.d......
-00002700: 0191 0271 0453 0029 0272 2100 0000 7202  ...q.S.).r!...r.
-00002710: 0000 0029 0372 3000 0000 7246 0000 0072  ...).r0...rF...r
-00002720: 2800 0000 7210 0000 0072 1300 0000 7213  (...r....r....r.
-00002730: 0000 0072 1400 0000 7236 0000 000a 0100  ...r....r6......
-00002740: 0072 1600 0000 7a21 4261 7365 4461 7461  .r....z!BaseData
-00002750: 2e6c 6f61 642e 3c6c 6f63 616c 733e 2e3c  .load.<locals>.<
-00002760: 6c69 7374 636f 6d70 3e72 2d00 0000 6301  listcomp>r-...c.
-00002770: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-00002780: 0000 0053 0000 0073 1400 0000 6700 7c00  ...S...s....g.|.
-00002790: 5d0c 7d01 7400 7c01 8301 9102 7104 5300  ].}.t.|.....q.S.
-000027a0: 7213 0000 0029 0172 2700 0000 7210 0000  r....).r'...r...
-000027b0: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
-000027c0: 7236 0000 000e 0100 0072 1600 0000 da01  r6.......r......
-000027d0: 5f72 2200 0000 7229 0000 0072 5400 0000  _r"...r)...rT...
-000027e0: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-000027f0: 0004 0000 0053 0000 0073 1400 0000 6700  .....S...s....g.
-00002800: 7c00 5d0c 7d01 7400 7c01 8301 9102 7104  |.].}.t.|.....q.
-00002810: 5300 7213 0000 0029 0172 2800 0000 7210  S.r....).r(...r.
-00002820: 0000 0072 1300 0000 7213 0000 0072 1400  ...r....r....r..
-00002830: 0000 7236 0000 0010 0100 0072 1600 0000  ..r6.......r....
-00002840: da0e 636f 6c5f 6c61 6265 6c5f 6672 6f6d  ..col_label_from
-00002850: 7a15 5b2b 5d20 6c61 6265 6c5f 6672 6f6d  z.[+] label_from
-00002860: 5f73 7472 203d 207a 132c 2063 6f6c 5f6c  _str = z., col_l
-00002870: 6162 656c 5f66 726f 6d20 3d20 7a1a 5b2b  abel_from = z.[+
-00002880: 5d20 636f 6c5f 6c61 6265 6c5f 6172 6773  ] col_label_args
-00002890: 5f6c 6973 7420 3d20 6301 0000 0000 0000  _list = c.......
-000028a0: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
-000028b0: 0073 1400 0000 6700 7c00 5d0c 7d01 7c01  .s....g.|.].}.|.
-000028c0: 6400 1900 9102 7104 5300 2901 7201 0000  d.....q.S.).r...
-000028d0: 0072 1300 0000 7210 0000 0072 1300 0000  .r....r....r....
-000028e0: 7213 0000 0072 1400 0000 7236 0000 0018  r....r....r6....
-000028f0: 0100 0072 1600 0000 6301 0000 0000 0000  ...r....c.......
-00002900: 0000 0000 0002 0000 0005 0000 0053 0000  .............S..
-00002910: 0073 2400 0000 6700 7c00 5d1c 7d01 7400  .s$...g.|.].}.t.
-00002920: 7c01 6400 1900 8301 7401 7500 7204 7c01  |.d.....t.u.r.|.
-00002930: 6400 1900 9102 7104 5300 2901 723d 0000  d.....q.S.).r=..
-00002940: 0029 0272 2300 0000 720f 0000 0072 1000  .).r#...r....r..
-00002950: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
-00002960: 0072 3600 0000 1801 0000 7216 0000 0072  .r6.......r....r
-00002970: 3900 0000 da09 4c41 4245 4c5f 5241 57da  9.....LABEL_RAW.
-00002980: 056c 6162 656c 7261 0000 007a 115b 2b5d  .labelra...z.[+]
-00002990: 2063 6f6c 735f 6c61 6265 6c20 3d20 da0b   cols_label = ..
-000029a0: 665f 6c61 6265 6c5f 7072 657a 125b 2b5d  f_label_prez.[+]
-000029b0: 2066 5f6c 6162 656c 5f70 7265 203d 205a   f_label_pre = Z
-000029c0: 0863 737a 7363 6f72 657a 0e4c 4142 454c  .cszscorez.LABEL
-000029d0: 5f52 4157 203d 206f 287a 0f20 3d20 6167  _RAW = o(z. = ag
-000029e0: 6728 7a73 636f 7265 2c20 6301 0000 0000  g(zscore, c.....
-000029f0: 0000 0000 0000 0002 0000 0007 0000 0013  ................
-00002a00: 0000 0073 2600 0000 6700 7c00 5d1e 7d01  ...s&...g.|.].}.
-00002a10: 7c01 6400 7601 7204 6401 8800 9b00 6402  |.d.v.r.d.....d.
-00002a20: 7c01 9b00 6403 9d05 9102 7104 5300 2904  |...d.....q.S.).
-00002a30: 2901 72a2 0000 007a 0c61 6767 287a 7363  ).r....z.agg(zsc
-00002a40: 6f72 652c 2072 9e00 0000 729f 0000 0072  ore, r....r....r
-00002a50: 1300 0000 7233 0000 0029 0172 5100 0000  ....r3...).rQ...
-00002a60: 7213 0000 0072 1400 0000 7236 0000 002a  r....r....r6...*
-00002a70: 0100 0072 1600 0000 2902 7256 0000 005a  ...r....).rV...Z
-00002a80: 096b 6565 705f 6e61 6d65 da06 6f72 6967  .keep_name..orig
-00002a90: 696e 7a05 203d 206f 285a 0565 7869 7374  inz. = o(Z.exist
-00002aa0: 7a3c 5b2b 5d20 7261 7720 6c61 6265 6c20  z<[+] raw label 
-00002ab0: 6672 6f6d 2064 6d2c 2028 7768 6963 6820  from dm, (which 
-00002ac0: 6d65 616e 2065 7869 7374 2074 6869 7320  mean exist this 
-00002ad0: 636f 6c75 6d6e 2c20 6c61 6265 6c29 7a22  column, label)z"
-00002ae0: 636f 6c5f 6c61 6265 6c20 3d20 7b63 6f6c  col_label = {col
-00002af0: 5f6c 6162 656c 7d20 6e6f 7420 696e 2064  _label} not in d
-00002b00: 6d21 7a25 5b69 6e69 745d 203c 2d2d 2d2d  m!z%[init] <----
-00002b10: 2d2d 2d2d 2d2d 206d 6173 6b20 202d 2d2d  ------ mask  ---
-00002b20: 2d2d 2d2d 2d2d 2d3e 207a 062f 727a 2e64  -------> z./rz.d
-00002b30: 627a 0e5b 2b5d 2070 6174 685f 6462 203d  bz.[+] path_db =
-00002b40: 2072 7600 0000 728d 0000 007a 105b 2b5d   rv...r....z.[+]
-00002b50: 2063 6f6c 735f 6d61 736b 203d 2072 7300   cols_mask = rs.
-00002b60: 0000 7274 0000 005a 0254 3072 6e00 0000  ..rt...Z.T0rn...
-00002b70: da04 6d61 736b 5a03 6b6a 795a 037a 6474  ..maskZ.kjyZ.zdt
-00002b80: 7a09 6770 286d 6561 6e2c 207a 0c2c 204c  z.gp(mean, z., L
-00002b90: 4142 454c 5f52 4157 297a 0354 302e 2901  ABEL_RAW)z.T0.).
-00002ba0: 5a07 6466 5f6e 616d 6567 b81e 85eb 51b8  Z.df_nameg....Q.
-00002bb0: 9e3f 7a10 5b2b 5d20 6461 7465 5f64 726f  .?z.[+] date_dro
-00002bc0: 7020 3d20 7a0e 0a64 6174 655f 6472 6f70  p = z..date_drop
-00002bd0: 203d 205b 6301 0000 0000 0000 0000 0000   = [c...........
-00002be0: 0002 0000 0003 0000 0073 0000 0073 1600  .........s...s..
-00002bf0: 0000 7c00 5d0e 7d01 7400 7c01 8301 5600  ..|.].}.t.|...V.
-00002c00: 0100 7102 6400 5300 720d 0000 0072 0e00  ..q.d.S.r....r..
-00002c10: 0000 7210 0000 0072 1300 0000 7213 0000  ..r....r....r...
-00002c20: 0072 1400 0000 7215 0000 005a 0100 0072  .r....r....Z...r
-00002c30: 1600 0000 7a20 4261 7365 4461 7461 2e6c  ....z BaseData.l
-00002c40: 6f61 642e 3c6c 6f63 616c 733e 2e3c 6765  oad.<locals>.<ge
-00002c50: 6e65 7870 723e fa01 5d72 7500 0000 7a0b  nexpr>..]ru...z.
-00002c60: 5b2b 5d20 6b6a 7920 203d 207a 0320 2f20  [+] kjy  = z. / 
-00002c70: 7a03 203d 207a 0b5b 2b5d 207a 6474 2020  z. = z.[+] zdt  
-00002c80: 3d20 7a0b 5b2b 5d20 6d61 736b 203d 20da  = z.[+] mask = .
-00002c90: 0468 6973 74da 0574 7261 696e 5a04 6c6f  .hist..trainZ.lo
-00002ca0: 6f6b 7a0c 6461 7465 5f64 6963 7420 3d20  okz.date_dict = 
-00002cb0: 7a0b 2c20 6e65 6564 2068 6973 747a 0e5b  z., need histz.[
-00002cc0: 2b5d 2070 6164 6469 6e67 203d 2029 0272  +] padding = ).r
-00002cd0: a900 0000 72a8 0000 00da 0474 6573 7429  ....r......test)
-00002ce0: 015a 096d 6173 6b5f 6e61 6d65 7a10 5b2b  .Z.mask_namez.[+
-00002cf0: 5d20 6d61 736b 5f6e 616d 6520 3d20 7a03  ] mask_name = z.
-00002d00: 3c31 317a 027c 207a 0420 2d3e 207a 097c  <11z.| z. -> z.|
-00002d10: 206c 656e 203d 2030 7a27 5b69 6e69 745d   len = 0z'[init]
-00002d20: 203c 2d2d 2d2d 2d2d 2d2d 2d2d 2073 6869   <---------- shi
-00002d30: 6674 5f69 202d 2d2d 2d2d 2d2d 2d2d 2d3e  ft_i ---------->
-00002d40: 20da 0773 6869 6674 5f69 7a0e 5b2b 5d20   ..shift_iz.[+] 
-00002d50: 7368 6966 745f 6920 3d20 5a08 636f 6c5f  shift_i = Z.col_
-00002d60: 6461 7465 da10 636f 6c73 5f73 6869 6674  date..cols_shift
-00002d70: 5f31 5f6e 6f74 7a17 5b2b 5d20 636f 6c73  _1_notz.[+] cols
-00002d80: 5f73 6869 6674 5f31 5f6e 6f74 203d 2063  _shift_1_not = c
-00002d90: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002da0: 0400 0000 1300 0000 7318 0000 0067 007c  ........s....g.|
-00002db0: 005d 107d 017c 0188 0076 0172 047c 0191  .].}.|...v.r.|..
-00002dc0: 0271 0453 0072 1300 0000 7213 0000 0072  .q.S.r....r....r
-00002dd0: 3300 0000 2901 72ac 0000 0072 1300 0000  3...).r....r....
-00002de0: 7214 0000 0072 3600 0000 8601 0000 7216  r....r6.......r.
-00002df0: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00002e00: 0200 0000 0c00 0000 1300 0000 732e 0000  ............s...
-00002e10: 0067 007c 005d 267d 017c 019b 0064 0088  .g.|.]&}.|...d..
-00002e20: 009b 0064 017c 019b 0064 0188 019b 0064  ...d.|...d.....d
-00002e30: 0188 029b 0064 029d 0a91 0271 0453 0029  .....d.....q.S.)
-00002e40: 0372 9d00 0000 729e 0000 0072 9f00 0000  .r....r....r....
-00002e50: 7213 0000 0072 3300 0000 2903 7252 0000  r....r3...).rR..
-00002e60: 0072 5100 0000 72ab 0000 0072 1300 0000  .rQ...r....r....
-00002e70: 7214 0000 0072 3600 0000 8701 0000 7216  r....r6.......r.
-00002e80: 0000 0029 3572 1e00 0000 5a09 5041 5448  ...)5r....Z.PATH
-00002e90: 5f44 4154 4172 9500 0000 7217 0000 0072  _DATAr....r....r
-00002ea0: 0f00 0000 7223 0000 0072 6500 0000 7203  ....r#...re...r.
-00002eb0: 0000 0072 8000 0000 7245 0000 0072 6400  ...r....rE...rd.
-00002ec0: 0000 da04 6865 6164 7250 0000 0072 2a00  ....headrP...r*.
-00002ed0: 0000 7226 0000 0072 3000 0000 7246 0000  ..r&...r0...rF..
-00002ee0: 0072 2e00 0000 7224 0000 0072 6800 0000  .r....r$...rh...
-00002ef0: 724c 0000 0072 7a00 0000 7277 0000 0072  rL...rz...rw...r
-00002f00: 6200 0000 5a0a 7365 745f 6279 5f63 6f6c  b...Z.set_by_col
-00002f10: 724f 0000 00da 026f 73da 0470 6174 68da  rO.....os..path.
-00002f20: 0764 6972 6e61 6d65 da07 6162 7370 6174  .dirname..abspat
-00002f30: 68da 0665 7869 7374 7372 8e00 0000 7247  h..existsr....rG
-00002f40: 0000 005a 0764 665f 6469 6374 7244 0000  ...Z.df_dictrD..
-00002f50: 0072 4200 0000 7284 0000 0072 8100 0000  .rB...r....r....
-00002f60: 5a08 7365 745f 6d61 736b 7282 0000 00da  Z.set_maskr.....
-00002f70: 0676 616c 7565 7372 1a00 0000 5a0e 6765  .valuesr....Z.ge
-00002f80: 745f 636f 6c5f 7061 6e64 6173 5a04 6973  t_col_pandasZ.is
-00002f90: 696e da03 7365 745a 096f 6e65 735f 6c69  in..setZ.ones_li
-00002fa0: 6b65 da04 626f 6f6c 7285 0000 0072 4d00  ke..boolr....rM.
-00002fb0: 0000 7289 0000 0072 3200 0000 7231 0000  ..r....r2...r1..
-00002fc0: 0072 4900 0000 2927 7290 0000 005a 0b64  .rI...)'r....Z.d
-00002fd0: 6174 615f 636f 6e66 6967 7235 0000 0072  ata_configr5...r
-00002fe0: 5600 0000 7291 0000 0072 9600 0000 7294  V...r....r....r.
-00002ff0: 0000 0072 9700 0000 7298 0000 0072 9900  ...r....r....r..
-00003000: 0000 729a 0000 0072 8800 0000 7234 0000  ..r....r....r4..
-00003010: 0072 8c00 0000 7255 0000 0072 a100 0000  .r....rU...r....
-00003020: 7254 0000 00da 0770 6164 6469 6e67 7253  rT.....paddingrS
-00003030: 0000 0072 5c00 0000 7261 0000 0072 a400  ...r\...ra...r..
-00003040: 0000 7287 0000 0072 8a00 0000 728d 0000  ..r....r....r...
-00003050: 005a 0a65 7869 7374 5f6d 6173 6b5a 086d  .Z.exist_maskZ.m
-00003060: 6173 6b5f 6b6a 795a 086d 6173 6b5f 7a64  ask_kjyZ.mask_zd
-00003070: 745a 0564 665f 6770 5a09 6461 7465 5f64  tZ.df_gpZ.date_d
-00003080: 726f 705a 096d 6173 6b5f 6472 6f70 5a09  ropZ.mask_dropZ.
-00003090: 6d61 736b 5f6d 6173 6b72 1200 0000 da03  mask_maskr......
-000030a0: 6b65 7972 9200 0000 7293 0000 005a 0878  keyr....r....Z.x
-000030b0: 5f75 6e69 7175 6572 a600 0000 5a0c 636f  _uniquer....Z.co
-000030c0: 6c73 5f73 6869 6674 5f31 7213 0000 0029  ls_shift_1r....)
-000030d0: 0472 5200 0000 7251 0000 0072 ac00 0000  .rR...rQ...r....
-000030e0: 72ab 0000 0072 1400 0000 da04 6c6f 6164  r....r......load
-000030f0: d900 0000 7308 0100 0000 0206 0108 0108  ....s...........
-00003100: 0208 0108 0208 0108 0108 0108 0330 0116  .............0..
-00003110: 020e 010e 0210 030c 0112 0118 0110 0302  ................
-00003120: 0102 fe04 041a 010e 0304 0112 0110 0124  ...............$
-00003130: 0120 010e 030c 010e 0104 0112 0116 020c  . ..............
-00003140: 010a 0122 0110 010e 0112 0108 0108 021a  ..."............
-00003150: 0114 021c 0112 0118 0122 011c 010a 011a  ........."......
-00003160: 010c 0114 030c 011a 010a 0118 0122 0312  ............."..
-00003170: 0112 010a 0118 011e 010a 010e 0118 011a  ................
-00003180: 020e 050e 011a 0114 010e 0116 011e 020c  ................
-00003190: 010c 0114 031e 0114 0222 0116 0214 0222  ........."....."
-000031a0: 0126 020e 0114 0114 0314 0114 0112 0122  .&............."
-000031b0: 0114 012a 011a 0210 0208 0108 010c 010c  ...*............
-000031c0: 0106 0126 0126 0126 030e 011c 011c 011c  ...&.&.&........
-000031d0: 0110 011a 0112 010c 010c 010a 010a 011c  ................
-000031e0: 0210 010a 010e 010e 0106 014a 0116 030e  ...........J....
-000031f0: 010c 0114 0124 0110 0108 0114 0118 012a  .....$.........*
-00003200: 027a 0d42 6173 6544 6174 612e 6c6f 6164  .z.BaseData.load
-00003210: 2902 4e54 2905 da08 5f5f 6e61 6d65 5f5f  ).NT)...__name__
-00003220: da0a 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f  ..__module__..__
-00003230: 7175 616c 6e61 6d65 5f5f 7295 0000 0072  qualname__r....r
-00003240: b800 0000 7213 0000 0072 1300 0000 7213  ....r....r....r.
-00003250: 0000 0072 1400 0000 728f 0000 00d5 0000  ...r....r.......
-00003260: 0073 0400 0000 0801 0803 728f 0000 0029  .s........r....)
-00003270: 0272 2f00 0000 5429 0154 291f 72ae 0000  .r/...T).T).r...
-00003280: 00da 056e 756d 7079 7230 0000 00da 0670  ...numpyr0.....p
-00003290: 616e 6461 7372 6800 0000 da06 706f 6c61  andasrh.....pola
-000032a0: 7273 7243 0000 005a 0f63 6f72 652e 4461  rsrC...Z.core.Da
-000032b0: 7461 4d61 7374 6572 7203 0000 005a 0975  taMasterr....Z.u
-000032c0: 7469 6c2e 7574 696c 7204 0000 0072 0500  til.utilr....r..
-000032d0: 0000 7206 0000 005a 0875 7469 6c2e 6e70  ..r....Z.util.np
-000032e0: 7972 0700 0000 5a0e 7574 696c 2e6e 7079  yr....Z.util.npy
-000032f0: 5f6e 756d 6261 7208 0000 0072 0900 0000  _numbar....r....
-00003300: 5a07 7574 696c 2e64 6272 0a00 0000 7245  Z.util.dbr....rE
-00003310: 0000 0072 1800 0000 5a0a 7574 696c 2e63  ...r....Z.util.c
-00003320: 6f6e 7374 721e 0000 0072 1f00 0000 7228  onstr....r....r(
-00003330: 0000 0072 2e00 0000 7262 0000 0072 6d00  ...r....rb...rm.
-00003340: 0000 728e 0000 0072 8f00 0000 7213 0000  ..r....r....r...
-00003350: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
-00003360: da08 3c6d 6f64 756c 653e 0100 0000 7324  ..<module>....s$
-00003370: 0000 0008 0108 0108 0108 010c 0114 010c  ................
-00003380: 0110 010c 0104 0108 020c 010c 0308 0808  ................
-00003390: 080a 3e08 100a 66                        ..>...f
+00000800: 7d23 6e74 6413 7c21 7600 9003 7250 6414  }#ntd.|!v...rPd.
+00000810: 6402 8400 7c21 a01a 6415 a101 640b 6400  d...|!..d...d.d.
+00000820: 8502 1900 4400 8301 7d26 740c 7c26 8301  ....D...}&t.|&..
+00000830: 740c 7c22 8301 6b02 9003 7336 4a00 6416  t.|"..k...s6J.d.
+00000840: 7c22 9b00 6417 7c26 9b00 9d04 8301 8201  |"..d.|&........
+00000850: 7c1f 7c22 1900 a009 a100 7c26 1400 6a1d  |.|"......|&..j.
+00000860: 640b 6411 8d01 7d23 6e0e 741e 6418 7c21  d.d...}#n.t.d.|!
+00000870: 9b00 9d02 8301 8201 7c1f a016 7404 a017  ........|...t...
+00000880: 6419 7c23 a102 a101 7d1f 8700 6601 641a  d.|#....}...f.d.
+00000890: 6402 8408 7c1f 6a1f 4400 8301 7d27 7c1f  d...|.j.D...}'|.
+000008a0: 7c27 6602 5300 291b 4e63 0100 0000 0000  |'f.S.).Nc......
+000008b0: 0000 0000 0000 0200 0000 0600 0000 1300  ................
+000008c0: 0000 731e 0000 0067 007c 005d 167d 0174  ..s....g.|.].}.t
+000008d0: 00a0 0188 007c 0119 00a0 02a1 00a1 0191  .....|..........
+000008e0: 0271 0453 0072 1300 0000 2903 da02 6e70  .q.S.r....)...np
+000008f0: da04 736f 7274 da06 756e 6971 7565 a902  ..sort..unique..
+00000900: 7211 0000 00da 0363 6f6c 2901 da02 6466  r......col)...df
+00000910: 7213 0000 0072 1400 0000 da0a 3c6c 6973  r....r......<lis
+00000920: 7463 6f6d 703e 2300 0000 7216 0000 007a  tcomp>#...r....z
+00000930: 2667 6574 5f64 665f 6c61 6265 6c5f 6669  &get_df_label_fi
+00000940: 6e61 6c2e 3c6c 6f63 616c 733e 2e3c 6c69  nal.<locals>.<li
+00000950: 7374 636f 6d70 3e63 0100 0000 0000 0000  stcomp>c........
+00000960: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+00000970: 7314 0000 0067 007c 005d 0c7d 0174 007c  s....g.|.].}.t.|
+00000980: 0183 0191 0271 0453 0072 1300 0000 2901  .....q.S.r....).
+00000990: 722a 0000 0072 1000 0000 7213 0000 0072  r*...r....r....r
+000009a0: 1300 0000 7214 0000 0072 3600 0000 2400  ....r....r6...$.
+000009b0: 0000 7216 0000 00a9 01da 0763 6f6c 735f  ..r........cols_
+000009c0: 6964 da03 4144 4ada 046c 6566 7429 02da  id..ADJ..left)..
+000009d0: 026f 6eda 0368 6f77 7a28 5b2b 5d20 6765  .on..howz([+] ge
+000009e0: 745f 6466 5f6c 6162 656c 5f66 696e 616c  t_df_label_final
+000009f0: 2e63 6f6c 5f6c 6162 656c 5f61 7267 7320  .col_label_args 
+00000a00: 3d20 7202 0000 00e9 ffff ffff 7221 0000  = r.........r!..
+00000a10: 0072 0100 0000 da02 5f5f 6301 0000 0000  .r......__c.....
+00000a20: 0000 0000 0000 0002 0000 0005 0000 0053  ...............S
+00000a30: 0000 0073 1800 0000 6700 7c00 5d10 7d01  ...s....g.|.].}.
+00000a40: 7400 7401 7c01 8301 8301 9102 7104 5300  t.t.|.......q.S.
+00000a50: 7213 0000 0029 0272 2e00 0000 7228 0000  r....).r....r(..
+00000a60: 0072 1000 0000 7213 0000 0072 1300 0000  .r....r....r....
+00000a70: 7214 0000 0072 3600 0000 5100 0000 7216  r....r6...Q...r.
+00000a80: 0000 0029 015a 0352 4157 2901 5a03 4144  ...).Z.RAW).Z.AD
+00000a90: 44a9 01da 0461 7869 7329 015a 034d 554c  D....axis).Z.MUL
+00000aa0: 5a03 5747 5463 0100 0000 0000 0000 0000  Z.WGTc..........
+00000ab0: 0000 0200 0000 0500 0000 5300 0000 7316  ..........S...s.
+00000ac0: 0000 0067 007c 005d 0e7d 0174 00a0 017c  ...g.|.].}.t...|
+00000ad0: 01a1 0191 0271 0453 0072 1300 0000 2902  .....q.S.r....).
+00000ae0: 7230 0000 00da 0766 6c6f 6174 3332 2902  r0.....float32).
+00000af0: 7211 0000 005a 0277 6972 1300 0000 7213  r....Z.wir....r.
+00000b00: 0000 0072 1400 0000 7236 0000 005b 0000  ...r....r6...[..
+00000b10: 0072 1600 0000 7220 0000 007a 0763 6f6c  .r....r ...z.col
+00000b20: 7320 3d20 7a06 2c20 7720 3d20 7a1b 6c61  s = z., w = z.la
+00000b30: 6265 6c5f 6672 6f6d 5f73 7472 2065 7272  bel_from_str err
+00000b40: 6f72 2c20 6f70 203d 20da 0e4c 4142 454c  or, op = ..LABEL
+00000b50: 5f46 524f 4d5f 5354 5263 0100 0000 0000  _FROM_STRc......
+00000b60: 0000 0000 0000 0200 0000 0400 0000 1300  ................
+00000b70: 0000 7318 0000 0067 007c 005d 107d 017c  ..s....g.|.].}.|
+00000b80: 0188 0076 0172 047c 0191 0271 0453 0072  ...v.r.|...q.S.r
+00000b90: 1300 0000 7213 0000 0072 3300 0000 7237  ....r....r3...r7
+00000ba0: 0000 0072 1300 0000 7214 0000 0072 3600  ...r....r....r6.
+00000bb0: 0000 6100 0000 7216 0000 0029 2072 0700  ..a...r....) r..
+00000bc0: 0000 da06 6173 7479 7065 5a06 6474 7970  ....astypeZ.dtyp
+00000bd0: 6573 5a07 746f 5f64 6963 74da 0270 6c5a  esZ.to_dict..plZ
+00000be0: 0b66 726f 6d5f 7061 6e64 6173 721a 0000  .from_pandasr...
+00000bf0: 0072 3000 0000 5a11 6173 636f 6e74 6967  .r0...Z.ascontig
+00000c00: 756f 7573 6172 7261 79da 0874 6f5f 6e75  uousarray..to_nu
+00000c10: 6d70 795a 0772 6573 6861 7065 da05 7072  mpyZ.reshape..pr
+00000c20: 696e 7472 2a00 0000 7227 0000 0072 0800  intr*...r'...r..
+00000c30: 0000 da03 6d61 78da 0569 736e 616e da05  ....max..isnan..
+00000c40: 7261 6e67 65da 036d 696e da03 6e61 6eda  range..min..nan.
+00000c50: 0869 7366 696e 6974 6572 2e00 0000 5a0c  .isfiniter....Z.
+00000c60: 7769 7468 5f63 6f6c 756d 6e73 da06 5365  with_columns..Se
+00000c70: 7269 6573 5a05 7261 7665 6c72 4100 0000  riesZ.ravelrA...
+00000c80: 7226 0000 00da 046d 6561 6eda 0577 6865  r&.....mean..whe
+00000c90: 7265 da03 7375 6dda 134e 6f74 496d 706c  re..sum..NotImpl
+00000ca0: 656d 656e 7465 6445 7272 6f72 da07 636f  ementedError..co
+00000cb0: 6c75 6d6e 7329 2872 3500 0000 da07 636f  lumns)(r5.....co
+00000cc0: 6c5f 7469 64da 0663 6f6c 5f69 64da 0a63  l_tid..col_id..c
+00000cd0: 6f6c 735f 7072 6963 65da 1363 6f6c 5f6c  ols_price..col_l
+00000ce0: 6162 656c 5f61 7267 735f 6c69 7374 da0e  abel_args_list..
+00000cf0: 6c61 6265 6c5f 6672 6f6d 5f73 7472 da07  label_from_str..
+00000d00: 7665 7262 6f73 655a 0769 645f 6c69 7374  verboseZ.id_list
+00000d10: da05 7368 6170 655a 0964 665f 6964 5f61  ..shapeZ.df_id_a
+00000d20: 6c6c 5a05 5f64 665f 4c5a 055f 6466 5f52  llZ._df_LZ._df_R
+00000d30: 5a06 6466 5f4c 5f52 5a06 5f64 665f 4c32  Z.df_L_RZ._df_L2
+00000d40: 5a05 615f 6164 6a72 2d00 0000 7234 0000  Z.a_adjr-...r4..
+00000d50: 00da 0169 da01 6ada 0161 5a02 6132 5a04  ...i..j..aZ.a2Z.
+00000d60: 636f 6c32 5a03 6164 6a5a 0269 6a5a 0661  col2Z.adjZ.ijZ.a
+00000d70: 646a 5f69 6a5a 0361 5f69 5a03 615f 6a5a  dj_ijZ.a_iZ.a_jZ
+00000d80: 0561 5f69 326a da04 6e61 6d65 5a06 5f64  .a_i2j..nameZ._d
+00000d90: 665f 5232 5a09 5f64 665f 5232 5f4c 32da  f_R2Z._df_R2_L2.
+00000da0: 0e64 665f 6c61 6265 6c5f 6669 6e61 6cda  .df_label_final.
+00000db0: 0273 73da 026f 70da 0463 6f6c 7372 1200  .ss..op..colsr..
+00000dc0: 0000 5a02 7830 da02 7831 da01 77da 0a63  ..Z.x0..x1..w..c
+00000dd0: 6f6c 735f 6c61 6265 6c72 1300 0000 2902  ols_labelr....).
+00000de0: 7238 0000 0072 3500 0000 7214 0000 00da  r8...r5...r.....
+00000df0: 1267 6574 5f64 665f 6c61 6265 6c5f 6669  .get_df_label_fi
+00000e00: 6e61 6c21 0000 0073 7000 0000 0001 0801  nal!...sp.......
+00000e10: 1201 0e01 0c01 1402 0a01 1801 1002 0801  ................
+00000e20: 1801 0a01 1201 0c01 0a01 1801 0602 0c01  ................
+00000e30: 1801 1801 1202 1401 0e01 1e01 0e01 0e01  ................
+00000e40: 0c01 0e02 0e01 0e01 1001 1201 0801 2002  .............. .
+00000e50: 0801 1001 0403 0e01 0a01 1601 0e01 0a01  ................
+00000e60: 1201 0a01 1601 0a01 1001 1001 1801 0a01  ................
+00000e70: 1c01 2601 1a02 0e01 1201 1401 7265 0000  ..&.........re..
+00000e80: 0063 0200 0000 0000 0000 0000 0000 0800  .c..............
+00000e90: 0000 0500 0000 4300 0000 73c0 0000 007c  ......C...s....|
+00000ea0: 0164 0119 00a0 00a1 007d 027c 0064 0119  .d.......}.|.d..
+00000eb0: 00a0 00a1 007d 037c 037c 037c 0264 0219  .....}.|.|.|.d..
+00000ec0: 006b 0419 007d 037c 017c 0164 0119 007c  .k...}.|.|.d...|
+00000ed0: 0264 0219 006b 0219 006a 0164 0364 048d  .d...k...j.d.d..
+00000ee0: 017d 0474 027c 0383 0164 056b 0272 547c  .}.t.|...d.k.rT|
+00000ef0: 0153 0067 007d 0574 0364 067c 039b 009d  .S.g.}.t.d.|....
+00000f00: 0283 0101 007c 0344 005d 1e7d 067c 04a0  .....|.D.].}.|..
+00000f10: 04a1 007d 077c 067c 0764 013c 007c 05a0  ...}.|.|.d.<.|..
+00000f20: 057c 07a1 0101 0071 6a74 066a 077c 0564  .|.....qjt.j.|.d
+00000f30: 0564 078d 026a 0164 0364 048d 017d 0774  .d...j.d.d...}.t
+00000f40: 066a 077c 017c 0767 0264 0564 0864 098d  .j.|.|.g.d.d.d..
+00000f50: 036a 0164 0364 048d 017d 017c 0153 0029  .j.d.d...}.|.S.)
+00000f60: 0a4e 5a0a 7472 6164 655f 6461 7465 723d  .NZ.trade_dater=
+00000f70: 0000 0054 a901 da04 6472 6f70 7201 0000  ...T....dropr...
+00000f80: 007a 115b 2b5d 2064 6174 6573 5f74 6f64  .z.[+] dates_tod
+00000f90: 6f20 3d20 723f 0000 0046 2902 7240 0000  o = r?...F).r@..
+00000fa0: 0072 3100 0000 2908 7232 0000 00da 0b72  .r1...).r2.....r
+00000fb0: 6573 6574 5f69 6e64 6578 722a 0000 0072  eset_indexr*...r
+00000fc0: 4600 0000 da04 636f 7079 da06 6170 7065  F.....copy..appe
+00000fd0: 6e64 da02 7064 da06 636f 6e63 6174 2908  nd..pd..concat).
+00000fe0: da04 6466 5f4c da04 6466 5f52 5a0a 6461  ..df_L..df_RZ.da
+00000ff0: 7465 735f 6861 7665 5a0a 6461 7465 735f  tes_haveZ.dates_
+00001000: 746f 646f 5a09 6466 5f52 5f6c 6173 745a  todoZ.df_R_lastZ
+00001010: 0c64 665f 6e65 7874 5f6c 6973 74da 0464  .df_next_list..d
+00001020: 6174 655a 0764 665f 6e65 7874 7213 0000  ateZ.df_nextr...
+00001030: 0072 1300 0000 7214 0000 00da 0d64 665f  .r....r......df_
+00001040: 6578 7061 6e64 5f4c 5f52 6400 0000 731c  expand_L_Rd...s.
+00001050: 0000 0000 010c 010c 0110 011c 0110 0104  ................
+00001060: 010e 0108 0108 0108 010c 0116 011c 0172  ...............r
+00001070: 7000 0000 6305 0000 0000 0000 0000 0000  p...c...........
+00001080: 0022 0000 000d 0000 0043 0000 0073 f604  .".......C...s..
+00001090: 0000 7c01 a000 7c02 7c03 6702 6401 6402  ..|...|.|.g.d.d.
+000010a0: 6702 1700 a101 7d05 7401 7c00 7c04 6403  g.....}.t.|.|.d.
+000010b0: 8d02 7d06 7c06 a002 a100 0100 7c02 7c03  ..}.|.......|.|.
+000010c0: 6702 7d07 7c05 7c07 1900 7d08 6404 7d09  g.}.|.|...}.d.}.
+000010d0: 7c06 6a03 6405 7c03 6701 7c09 6701 1700  |.j.d.|.g.|.g...
+000010e0: 6406 8d02 7d0a 7c0a 7c0a 6404 1900 6407  d...}.|.|.d...d.
+000010f0: 6b04 1900 6a04 6408 6409 8d01 7d0a 7405  k...j.d.d...}.t.
+00001100: 7c08 7c0a 7c03 6701 8303 7c09 1900 a006  |.|.|.g...|.....
+00001110: a100 7d0b 640a 7d09 7c06 6a03 640b 7c07  ..}.d.}.|.j.d.|.
+00001120: 7c09 6701 1700 6406 8d02 7d0a 7407 7c08  |.g...d...}.t.|.
+00001130: 7c0a 8302 7d0a 7405 7c08 7c0a 7c07 8303  |...}.t.|.|.|...
+00001140: 640a 1900 a006 a100 a008 6407 a101 7d0c  d.........d...}.
+00001150: 640c 7d09 7c06 6a03 640d 7c07 7c09 6701  d.}.|.j.d.|.|.g.
+00001160: 1700 6406 8d02 7d0a 7407 7c08 7c0a 8302  ..d...}.t.|.|...
+00001170: 7d0a 7405 7c08 7c0a 7c07 8303 640c 1900  }.t.|.|.|...d...
+00001180: a006 a100 a008 6407 a101 7d0d 7c05 7c07  ......d...}.|.|.
+00001190: 6401 6402 6702 1700 1900 7d0e 7c0b 7c0e  d.d.g.....}.|.|.
+000011a0: 6404 3c00 7c0c 7c0e 640a 3c00 7c0d 7c0e  d.<.|.|.d.<.|.|.
+000011b0: 640c 3c00 7c0e 7c02 1900 a009 a100 6a04  d.<.|.|.......j.
+000011c0: 6408 6409 8d01 7d0f 740a 740b 7c0f 740c  d.d...}.t.t.|.t.
+000011d0: 6a0d 7c0f 640e 640f 8d02 8302 8301 7d10  j.|.d.d.......}.
+000011e0: 7c0e 6404 1900 a009 a100 6a04 6408 6409  |.d.......j.d.d.
+000011f0: 8d01 7d0f 740a 740b 7c0f 740c 6a0d 7c0f  ..}.t.t.|.t.j.|.
+00001200: 640e 640f 8d02 8302 8301 7d11 7c0e 7c02  d.d.......}.|.|.
+00001210: 1900 a00e 7c10 a101 7c0e 6404 1900 a00e  ....|...|.d.....
+00001220: 7c11 a101 1800 6a0f 6a10 6410 6b05 7d12  |.....j.j.d.k.}.
+00001230: 7c0e 6401 1900 a011 a100 0f00 7d13 7c0e  |.d.........}.|.
+00001240: 640a 1900 6407 6b01 7d14 7c0e 640c 1900  d...d.k.}.|.d...
+00001250: 6411 6b01 7d15 6412 7c03 9b00 6413 7c02  d.k.}.d.|...d.|.
+00001260: 9b00 6414 9d05 6415 7c03 9b00 6413 7c02  ..d...d.|...d.|.
+00001270: 9b00 6416 9d05 6417 7c03 9b00 6413 7c02  ..d...d.|...d.|.
+00001280: 9b00 6418 9d05 6419 7c03 9b00 641a 7c02  ..d...d.|...d.|.
+00001290: 9b00 6414 9d05 641b 7c03 9b00 641a 7c02  ..d...d.|...d.|.
+000012a0: 9b00 6416 9d05 641c 7c03 9b00 641a 7c02  ..d...d.|...d.|.
+000012b0: 9b00 6418 9d05 641d 7c03 9b00 641e 7c02  ..d...d.|...d.|.
+000012c0: 9b00 6414 9d05 641f 7c03 9b00 641e 7c02  ..d...d.|...d.|.
+000012d0: 9b00 6416 9d05 6420 7c03 9b00 641e 7c02  ..d...d |...d.|.
+000012e0: 9b00 6418 9d05 6709 7d16 7c01 6a12 7c16  ..d...g.}.|.j.|.
+000012f0: 6421 6403 8d02 0100 7c01 a013 6422 a101  d!d.....|...d"..
+00001300: 6423 6b01 7d17 7c17 7c01 a013 6424 a101  d#k.}.|.|...d$..
+00001310: 6423 6b01 4d00 7d17 7c17 7c01 a013 6425  d#k.M.}.|.|...d%
+00001320: a101 6423 6b01 4d00 7d17 7414 a015 7c01  ..d#k.M.}.t...|.
+00001330: a013 6426 a101 7c01 a013 6427 a101 1b00  ..d&..|...d'....
+00001340: 6411 1800 a101 6428 6b01 7d18 7c18 7414  d.....d(k.}.|.t.
+00001350: a015 7c01 a013 6429 a101 7c01 a013 642a  ..|...d)..|...d*
+00001360: a101 1b00 6411 1800 a101 6428 6b01 4d00  ....d.....d(k.M.
+00001370: 7d18 7c18 7414 a015 7c01 a013 642b a101  }.|.t...|...d+..
+00001380: 7c01 a013 642c a101 1b00 6411 1800 a101  |...d,....d.....
+00001390: 6428 6b01 4d00 7d18 7414 a015 7c01 a013  d(k.M.}.t...|...
+000013a0: 6426 a101 7c01 a013 6427 a101 1800 6407  d&..|...d'....d.
+000013b0: 1800 a101 642d 6b01 7d19 7c19 7414 a015  ....d-k.}.|.t...
+000013c0: 7c01 a013 6429 a101 7c01 a013 642a a101  |...d)..|...d*..
+000013d0: 1800 6407 1800 a101 642d 6b01 4d00 7d19  ..d.....d-k.M.}.
+000013e0: 7c19 7414 a015 7c01 a013 642b a101 7c01  |.t...|...d+..|.
+000013f0: a013 642c a101 1800 6407 1800 a101 642d  ..d,....d.....d-
+00001400: 6b01 4d00 7d19 7c01 6a16 7c16 6421 6403  k.M.}.|.j.|.d!d.
+00001410: 8d02 0100 7c17 7c18 4200 7c19 4200 0f00  ....|.|.B.|.B...
+00001420: 7d1a 7c05 7c03 1900 a017 a100 7d1b 740c  }.|.|.......}.t.
+00001430: a018 7c1b a101 a019 741a a101 642e 6b01  ..|.....t...d.k.
+00001440: 7d1c 7c05 7c03 1900 a00e 740a 740b 7c1b  }.|.|.....t.t.|.
+00001450: 7c1c 8302 8301 a101 6408 6b02 7d1d 7c04  |.......d.k.}.|.
+00001460: 9003 72da 741b 642f 8301 0100 7c14 a01c  ..r.t.d/....|...
+00001470: 7414 6a1d a101 7c0e 6430 3c00 7c13 7c12  t.j...|.d0<.|.|.
+00001480: 4000 7c14 4000 7c15 4000 a01c 7414 6a1d  @.|.@.|.@...t.j.
+00001490: a101 7c0e 6431 3c00 7c04 9004 7222 741b  ..|.d1<.|...r"t.
+000014a0: 6432 7c0e 6431 1900 a01e a100 9b00 9d02  d2|.d1..........
+000014b0: 8301 0100 7c04 9004 7240 741b 6432 7c0e  ....|...r@t.d2|.
+000014c0: 6431 1900 a01e a100 9b00 6433 9d03 8301  d1........d3....
+000014d0: 0100 7c0e 6431 1900 7c1d 4000 a01c 7414  ..|.d1..|.@...t.
+000014e0: 6a1d a101 7c0e 6431 3c00 7c04 9004 7276  j...|.d1<.|...rv
+000014f0: 741b 6432 7c0e 6431 1900 a01e a100 9b00  t.d2|.d1........
+00001500: 6434 9d03 8301 0100 7c0e 6402 1900 a011  d4......|.d.....
+00001510: a100 7d1e 7c14 6411 6b02 7c0e 6402 1900  ..}.|.d.k.|.d...
+00001520: a015 a100 6435 6b01 4000 7d1f 7c14 6407  ....d5k.@.}.|.d.
+00001530: 6b02 7c0e 6402 1900 a015 a100 6436 6b01  k.|.d.......d6k.
+00001540: 4000 7d20 7c1f 7c20 4200 7c1e 4200 a01c  @.} |.| B.|.B...
+00001550: 7414 6a1d a101 7c0e 6437 3c00 7c0e 6431  t.j...|.d7<.|.d1
+00001560: 1900 7c0e 6437 1900 4000 7c0e 6438 3c00  ..|.d7..@.|.d8<.
+00001570: 6700 6439 a201 7d21 7c06 a01f a100 0100  g.d9..}!|.......
+00001580: 7c0e 7c21 6602 5300 293a 4eda 046f 7065  |.|!f.S.):N..ope
+00001590: 6e5a 0770 6374 5f63 6867 a901 7258 0000  nZ.pct_chg..rX..
+000015a0: 005a 096c 6973 745f 6461 7465 5a0c 6466  .Z.list_dateZ.df
+000015b0: 5f6c 6973 745f 6461 7465 2901 7261 0000  _list_date).ra..
+000015c0: 0072 0100 0000 5472 6600 0000 5a02 5354  .r....Trf...Z.ST
+000015d0: 5a05 6466 5f73 745a 0353 5553 5a06 6466  Z.df_stZ.SUSZ.df
+000015e0: 5f73 7573 7a06 2559 256d 2564 2901 722b  _susz.%Y%m%d).r+
+000015f0: 0000 00e9 1400 0000 7221 0000 007a 195f  ........r!...z._
+00001600: 5f54 454d 505f 615f 3120 3d20 726f 6c6c  _TEMP_a_1 = roll
+00001610: 2873 6869 6674 2c20 7a0a 2c20 616d 6f75  (shift, z., amou
+00001620: 6e74 2c20 7a04 2c20 3029 7a19 5f5f 5445  nt, z., 0)z.__TE
+00001630: 4d50 5f61 5f32 203d 2072 6f6c 6c28 7368  MP_a_2 = roll(sh
+00001640: 6966 742c 20fa 042c 2031 297a 195f 5f54  ift, .., 1)z.__T
+00001650: 454d 505f 615f 3320 3d20 726f 6c6c 2873  EMP_a_3 = roll(s
+00001660: 6869 6674 2c20 7a04 2c20 3229 7a19 5f5f  hift, z., 2)z.__
+00001670: 5445 4d50 5f68 5f31 203d 2072 6f6c 6c28  TEMP_h_1 = roll(
+00001680: 7368 6966 742c 207a 082c 2068 6967 682c  shift, z., high,
+00001690: 207a 195f 5f54 454d 505f 685f 3220 3d20   z.__TEMP_h_2 = 
+000016a0: 726f 6c6c 2873 6869 6674 2c20 7a19 5f5f  roll(shift, z.__
+000016b0: 5445 4d50 5f68 5f33 203d 2072 6f6c 6c28  TEMP_h_3 = roll(
+000016c0: 7368 6966 742c 207a 195f 5f54 454d 505f  shift, z.__TEMP_
+000016d0: 6c5f 3120 3d20 726f 6c6c 2873 6869 6674  l_1 = roll(shift
+000016e0: 2c20 7a07 2c20 6c6f 772c 207a 195f 5f54  , z., low, z.__T
+000016f0: 454d 505f 6c5f 3220 3d20 726f 6c6c 2873  EMP_l_2 = roll(s
+00001700: 6869 6674 2c20 7a19 5f5f 5445 4d50 5f6c  hift, z.__TEMP_l
+00001710: 5f33 203d 2072 6f6c 6c28 7368 6966 742c  _3 = roll(shift,
+00001720: 2046 5a0a 5f5f 5445 4d50 5f61 5f31 6700   FZ.__TEMP_a_1g.
+00001730: 0000 00d0 1253 415a 0a5f 5f54 454d 505f  .....SAZ.__TEMP_
+00001740: 615f 325a 0a5f 5f54 454d 505f 615f 335a  a_2Z.__TEMP_a_3Z
+00001750: 0a5f 5f54 454d 505f 685f 315a 0a5f 5f54  .__TEMP_h_1Z.__T
+00001760: 454d 505f 6c5f 3167 fca9 f1d2 4d62 603f  EMP_l_1g....Mb`?
+00001770: 5a0a 5f5f 5445 4d50 5f68 5f32 5a0a 5f5f  Z.__TEMP_h_2Z.__
+00001780: 5445 4d50 5f6c 5f32 5a0a 5f5f 5445 4d50  TEMP_l_2Z.__TEMP
+00001790: 5f68 5f33 5a0a 5f5f 5445 4d50 5f6c 5f33  _h_3Z.__TEMP_l_3
+000017a0: 677b 14ae 47e1 7aa4 3f72 0200 0000 7a16  g{..G.z.?r....z.
+000017b0: 5b2b 5d20 5354 2c20 4b4a 592c 205a 4454  [+] ST, KJY, ZDT
+000017c0: 2c20 4d41 534b da07 4d41 534b 5f53 54da  , MASK..MASK_ST.
+000017d0: 084d 4153 4b5f 4b4a 597a 205b 2b5d 2064  .MASK_KJYz [+] d
+000017e0: 665f 6d61 736b 5b27 4d41 534b 5f4b 4a59  f_mask['MASK_KJY
+000017f0: 275d 2e73 756d 2829 203d 207a 172c 2061  '].sum() = z., a
+00001800: 6674 6572 2026 3d20 6d61 736b 5f6b 6a79  fter &= mask_kjy
+00001810: 5f74 7672 7a16 2c20 6166 7465 7220 263d  _tvrz., after &=
+00001820: 206d 6173 6b5f 6b6a 795f 6964 6700 0000   mask_kjy_idg...
+00001830: 0000 0023 4067 0000 0000 0000 1340 da08  ...#@g.......@..
+00001840: 4d41 534b 5f5a 4454 da04 4d41 534b a904  MASK_ZDT..MASK..
+00001850: 7275 0000 0072 7600 0000 7277 0000 0072  ru...rv...rw...r
+00001860: 7800 0000 2920 da0f 6765 745f 636f 6c73  x...) ..get_cols
+00001870: 5f70 616e 6461 7372 0a00 0000 da07 636f  _pandasr......co
+00001880: 6e6e 6563 74da 0673 656c 6563 7472 6800  nnect..selectrh.
+00001890: 0000 7205 0000 005a 0974 6f5f 7061 6e64  ..r....Z.to_pand
+000018a0: 6173 7270 0000 005a 0666 696c 6c6e 61da  asrp...Z.fillna.
+000018b0: 0f64 726f 705f 6475 706c 6963 6174 6573  .drop_duplicates
+000018c0: da04 6469 6374 da03 7a69 7072 6b00 0000  ..dict..ziprk...
+000018d0: 5a0b 746f 5f64 6174 6574 696d 65da 036d  Z.to_datetime..m
+000018e0: 6170 da02 6474 da04 6461 7973 5a06 6973  ap..dt..daysZ.is
+000018f0: 6e75 6c6c da05 6665 5f67 6fda 0d67 6574  null..fe_go..get
+00001900: 5f63 6f6c 5f6e 756d 7079 7230 0000 00da  _col_numpyr0....
+00001910: 0361 6273 7267 0000 0072 3200 0000 724d  .absrg...r2...rM
+00001920: 0000 00da 0561 7070 6c79 7206 0000 0072  .....applyr....r
+00001930: 4600 0000 7243 0000 00da 0569 6e74 3332  F...rC.....int32
+00001940: 7250 0000 00da 0563 6c6f 7365 2922 da07  rP.....close)"..
+00001950: 7061 7468 5f64 62da 0264 6d72 5300 0000  path_db..dmrS...
+00001960: 7254 0000 0072 5800 0000 7235 0000 005a  rT...rX...r5...Z
+00001970: 0264 62da 046b 6579 7372 6d00 0000 7234  .db..keysrm...r4
+00001980: 0000 0072 6e00 0000 5a0b 735f 6c69 7374  ...rn...Z.s_list
+00001990: 5f64 6174 655a 0473 5f73 745a 0573 5f73  _dateZ.s_stZ.s_s
+000019a0: 7573 da07 6466 5f6d 6173 6bda 0173 5a0b  us..df_mask..sZ.
+000019b0: 6461 7465 5f64 6963 745f 315a 0b64 6174  date_dict_1Z.dat
+000019c0: 655f 6469 6374 5f32 5a06 6964 785f 3230  e_dict_2Z.idx_20
+000019d0: 5a07 6964 785f 6e61 6e5a 0669 6478 5f73  Z.idx_nanZ.idx_s
+000019e0: 745a 0769 6478 5f73 7573 da09 6e61 6d65  tZ.idx_sus..name
+000019f0: 5f6c 6973 745a 0569 6478 5f61 5a0d 6964  _listZ.idx_aZ.id
+00001a00: 785f 696e 7472 615f 7265 745a 0d69 6478  x_intra_retZ.idx
+00001a10: 5f69 6e74 7261 5f64 6966 5a0c 6d61 736b  _intra_difZ.mask
+00001a20: 5f6b 6a79 5f74 7672 5a04 6964 5f6b 5a04  _kjy_tvrZ.id_kZ.
+00001a30: 6964 5f76 5a0b 6d61 736b 5f6b 6a79 5f69  id_vZ.mask_kjy_i
+00001a40: 645a 0c6d 6173 6b5f 7a64 745f 6e61 6e5a  dZ.mask_zdt_nanZ
+00001a50: 0b6d 6173 6b5f 7a64 745f 3130 5a0b 6d61  .mask_zdt_10Z.ma
+00001a60: 736b 5f7a 6474 5f73 74da 0963 6f6c 735f  sk_zdt_st..cols_
+00001a70: 6d61 736b 7213 0000 0072 1300 0000 7214  maskr....r....r.
+00001a80: 0000 00da 0b67 6574 5f64 665f 6d61 736b  .....get_df_mask
+00001a90: 7400 0000 738a 0000 0000 0116 010c 0108  t...s...........
+00001aa0: 0208 0108 0304 0116 0118 0116 0304 0114  ................
+00001ab0: 010a 011a 0304 0114 010a 011a 0410 0108  ................
+00001ac0: 0108 0108 0214 0118 0114 0118 0324 010e  .............$..
+00001ad0: 010c 010c 0410 0110 0110 0210 0110 0110  ................
+00001ae0: 0210 0110 0110 f504 0d0e 010e 0112 0112  ................
+00001af0: 0222 0126 0126 0222 0126 0126 010e 010e  .".&.&.".&.&....
+00001b00: 070c 0114 011c 030e 0110 021c 011c 021e  ................
+00001b10: 0118 011e 020c 0118 0118 0118 0114 0108  ................
+00001b20: 0108 0172 9000 0000 6300 0000 0000 0000  ...r....c.......
+00001b30: 0000 0000 0000 0000 0003 0000 0040 0000  .............@..
+00001b40: 0073 1e00 0000 6500 5a01 6400 5a02 6401  .s....e.Z.d.Z.d.
+00001b50: 6402 8400 5a03 6407 6405 6406 8401 5a04  d...Z.d.d.d...Z.
+00001b60: 6403 5300 2908 da08 4261 7365 4461 7461  d.S.)...BaseData
+00001b70: 6305 0000 0000 0000 0000 0000 0005 0000  c...............
+00001b80: 0002 0000 0043 0000 0073 0c00 0000 7400  .....C...s....t.
+00001b90: 6401 8301 8201 6400 5300 2902 4e7a 1e79  d.....d.S.).Nz.y
+00001ba0: 6f75 206e 6565 6420 746f 2069 6d70 6c65  ou need to imple
+00001bb0: 6d65 6e74 2067 6574 5f64 6628 2929 0172  ment get_df()).r
+00001bc0: 5100 0000 2905 da04 7365 6c66 da0a 7061  Q...)...self..pa
+00001bd0: 7468 5f69 6e70 7574 da0a 6461 7465 5f62  th_input..date_b
+00001be0: 6567 696e da08 6461 7465 5f65 6e64 da06  egin..date_end..
+00001bf0: 6e5f 6a6f 6273 7213 0000 0072 1300 0000  n_jobsr....r....
+00001c00: 7214 0000 00da 0667 6574 5f64 66db 0000  r......get_df...
+00001c10: 0073 0200 0000 0001 7a0f 4261 7365 4461  .s......z.BaseDa
+00001c20: 7461 2e67 6574 5f64 664e 5463 0400 0000  ta.get_dfNTc....
+00001c30: 0000 0000 0000 0000 2700 0000 0b00 0000  ........'.......
+00001c40: 0300 0000 73d0 0900 0074 006a 017d 047c  ....s....t.j.}.|
+00001c50: 0164 0119 007d 057c 0164 0219 007d 067c  .d...}.|.d...}.|
+00001c60: 0164 0319 007d 077c 0164 0419 007d 087c  .d...}.|.d...}.|
+00001c70: 0764 0519 0089 007c 0764 0619 007d 097c  .d.....|.d...}.|
+00001c80: 0764 0719 007d 0a7c 0764 0819 0089 017c  .d...}.|.d.....|
+00001c90: 0264 0075 0072 767c 006a 027c 0467 017c  .d.u.rv|.j.|.g.|
+00001ca0: 0564 0919 00a2 017c 0691 0152 0064 0a7c  .d.....|...R.d.|
+00001cb0: 08a0 0364 0a64 0ba1 0269 018e 017d 0264  ...d.d...i...}.d
+00001cc0: 0c74 0474 057c 0283 0183 0176 0072 8c7c  .t.t.|.....v.r.|
+00001cd0: 027d 0b6e 1c7c 026a 0664 0b64 0b64 0d8d  .}.n.|.j.d.d.d..
+00001ce0: 0201 0074 077c 0264 0e64 0b64 0f8d 037d  ...t.|.d.d.d...}
+00001cf0: 0b7c 0b6a 0888 0167 0164 0e64 108d 0201  .|.j...g.d.d....
+00001d00: 007c 0372 c474 0964 1183 0101 0064 1288  .|.r.t.d.....d..
+00001d10: 009b 0064 1388 019b 0064 149d 057d 0c7c  ...d.....d...}.|
+00001d20: 0b6a 0864 157c 0c9b 0064 169d 0367 017c  .j.d.|...d...g.|
+00001d30: 0364 108d 0201 007c 0b6a 0a7c 0c67 0164  .d.....|.j.|.g.d
+00001d40: 0e64 108d 0201 0064 1764 1867 027d 0d64  .d.....d.d.g.}.d
+00001d50: 197c 0ba0 0ba1 006a 0c76 0190 0172 207c  .|.....j.v...r |
+00001d60: 0d64 1a67 0137 007d 0d7c 0b6a 087c 0d64  .d.g.7.}.|.j.|.d
+00001d70: 0e64 108d 0201 0067 007d 0d67 0064 1ba2  .d.....g.}.g.d..
+00001d80: 0164 1c67 0117 0044 005d 567d 0c64 1d7c  .d.g...D.]V}.d.|
+00001d90: 0ba0 0ba1 006a 0c76 0190 0172 787c 0d64  .....j.v...rx|.d
+00001da0: 1e7c 0c9b 0064 1f88 009b 0064 207c 0c9b  .|...d.....d |..
+00001db0: 0064 2088 019b 0064 149d 0967 0137 007d  .d ....d...g.7.}
+00001dc0: 0d7c 0d7c 0c9b 0064 217c 0c9b 0064 207c  .|.|...d!|...d |
+00001dd0: 0c9b 0064 229d 0667 0137 007d 0d90 0171  ...d"..g.7.}...q
+00001de0: 407c 0b6a 087c 0d64 0e64 108d 0201 007c  @|.j.|.d.d.....|
+00001df0: 08a0 0364 2364 24a1 027d 0e74 0d7c 0e83  ...d#d$..}.t.|..
+00001e00: 0164 256b 0490 0172 ec64 267d 0f7c 0ea0  .d%k...r.d&}.|..
+00001e10: 0e64 27a1 0164 2864 0085 0219 007d 1074  .d'..d(d.....}.t
+00001e20: 0fa0 1064 2964 2a84 007c 1044 0083 01a1  ...d)d*..|.D....
+00001e30: 017d 116e 3874 117c 0864 2b19 0083 017d  .}.n8t.|.d+....}
+00001e40: 0f7c 0864 2b19 0067 017d 1074 0fa0 1064  .|.d+..g.}.t...d
+00001e50: 2c64 2a84 007c 0fa0 0e64 2da1 0164 2e64  ,d*..|...d-..d.d
+00001e60: 2f85 0219 0044 0083 01a1 017d 117c 107c  /....D.....}.|.|
+00001e70: 08a0 0364 3067 00a1 0237 007d 1064 3164  ...d0g...7.}.d1d
+00001e80: 2a84 007c 1044 0083 017d 1074 1274 13a0  *..|.D...}.t.t..
+00001e90: 147c 10a1 01a0 15a1 0083 017d 107c 107c  .|.........}.|.|
+00001ea0: 0864 303c 007c 0f7c 0864 323c 007c 0390  .d0<.|.|.d2<.|..
+00001eb0: 0272 7e74 0964 337c 0e9b 0064 347c 0f9b  .r~t.d3|...d4|..
+00001ec0: 009d 0483 0101 007c 0390 0272 9274 0964  .......|...r.t.d
+00001ed0: 357c 109b 009d 0283 0101 0064 3664 2a84  5|.........d6d*.
+00001ee0: 007c 1044 0083 0164 3764 2a84 007c 1044  .|.D...d7d*..|.D
+00001ef0: 0083 0117 007d 1274 1274 13a0 147c 12a1  .....}.t.t...|..
+00001f00: 01a0 15a1 0083 017d 127c 0ba0 1688 0188  .......}.|......
+00001f10: 0067 027c 1217 0064 3867 0117 00a1 017d  .g.|...d8g.....}
+00001f20: 0274 177c 0288 0188 007c 127c 107c 0e7c  .t.|.....|.|.|.|
+00001f30: 08a0 0364 0a64 0ba1 0264 108d 075c 027d  ...d.d...d...\.}
+00001f40: 137d 147c 1444 005d 167d 0c7c 0ba0 187c  .}.|.D.].}.|...|
+00001f50: 0c7c 137c 0c19 00a1 0201 0090 0271 fe7c  .|.|.........q.|
+00001f60: 1464 3967 0137 007d 1464 3a7c 0ba0 0ba1  .d9g.7.}.d:|....
+00001f70: 006a 0c76 0090 0372 3a7c 1464 3a67 0137  .j.v...r:|.d:g.7
+00001f80: 007d 147c 147c 0164 0319 0064 3b3c 007c  .}.|.|.d...d;<.|
+00001f90: 0390 0372 5a74 0964 3c7c 149b 009d 0283  ...rZt.d<|......
+00001fa0: 0101 007c 08a0 0364 3d64 00a1 027d 157c  ...|...d=d...}.|
+00001fb0: 0390 0372 8074 0964 3e7c 159b 0064 347c  ...r.t.d>|...d4|
+00001fc0: 0f9b 009d 0483 0101 007c 1564 3f6b 0290  .........|.d?k..
+00001fd0: 0372 e87c 0b6a 0864 407c 0f9b 0064 229d  .r.|.j.d@|...d".
+00001fe0: 0367 017c 0364 108d 0201 007c 0b6a 087c  .g.|.d.....|.j.|
+00001ff0: 099b 0064 4188 019b 0064 207c 0f9b 0064  ...dA....d |...d
+00002000: 229d 0667 017c 0364 108d 0201 0087 0166  "..g.|.d.......f
+00002010: 0164 4264 2a84 087c 1444 0083 017d 0d7c  .dBd*..|.D...}.|
+00002020: 0b6a 087c 0d7c 0364 2e64 438d 0301 006e  .j.|.|.d.dC....n
+00002030: 987c 1564 446b 0290 0472 287c 0b6a 0864  .|.dDk...r(|.j.d
+00002040: 407c 0f9b 0064 229d 0367 017c 0364 108d  @|...d"..g.|.d..
+00002050: 0201 007c 0b6a 087c 099b 0064 457c 0f9b  ...|.j.|...dE|..
+00002060: 0064 229d 0467 017c 0364 108d 0201 006e  .d"..g.|.d.....n
+00002070: 587c 1564 466b 0290 0472 727c 0390 0472  X|.dFk...rr|...r
+00002080: 4074 0964 4783 0101 007c 0b6a 0864 407c  @t.dG....|.j.d@|
+00002090: 099b 0064 229d 0367 017c 0364 108d 0201  ...d"..g.|.d....
+000020a0: 007c 097c 0ba0 0ba1 006a 0c76 0090 0473  .|.|.....j.v...s
+000020b0: 804a 0064 4883 0182 016e 0e74 1964 3e7c  .J.dH....n.t.d>|
+000020c0: 159b 009d 0283 0182 017c 0390 0472 8e74  .........|...r.t
+000020d0: 0964 4983 0101 0074 1a6a 1ba0 1c74 1a6a  .dI....t.j...t.j
+000020e0: 1ba0 1d7c 04a1 01a1 019b 0064 4a9d 027d  ...|.......dJ..}
+000020f0: 167c 0390 0472 bc74 0964 4b7c 169b 009d  .|...r.t.dK|....
+00002100: 0283 0101 0074 1a6a 1ba0 1e7c 16a1 0190  .....t.j...|....
+00002110: 0472 fe74 1f7c 167c 0b88 0188 007c 0364  .r.t.|.|.....|.d
+00002120: 108d 055c 027d 177d 187c 1844 005d 167d  ...\.}.}.|.D.].}
+00002130: 0c7c 0ba0 187c 0c7c 177c 0c19 00a1 0201  .|...|.|.|......
+00002140: 0090 0471 e46e 0c67 0064 4ca2 0104 007d  ...q.n.g.dL....}
+00002150: 187d 187c 187c 0164 0319 0064 4d3c 007c  .}.|.|.d...dM<.|
+00002160: 0390 0572 2a74 0964 4e7c 189b 009d 0283  ...r*t.dN|......
+00002170: 0101 0064 4f7c 0ba0 0ba1 006a 0c76 0090  ...dO|.....j.v..
+00002180: 056f 4664 507c 0ba0 0ba1 006a 0c76 007d  .oFdP|.....j.v.}
+00002190: 197c 1990 0573 5c74 1a6a 1ba0 1e7c 16a1  .|...s\t.j...|..
+000021a0: 0190 0572 a874 0fa0 207c 0b6a 2164 5119  ...r.t.. |.j!dQ.
+000021b0: 007c 0919 00a0 22a1 00a1 010f 00a0 2374  .|....".......#t
+000021c0: 0f6a 24a1 017d 1a7c 1a7c 0b6a 2164 5119  .j$..}.|.|.j!dQ.
+000021d0: 0064 4f19 00a0 22a1 004d 007d 1a7c 0b6a  .dO..."..M.}.|.j
+000021e0: 2164 5119 0064 5019 00a0 22a1 007d 1b6e  !dQ..dP..."..}.n
+000021f0: 5674 0fa0 207c 0b6a 2164 5119 007c 0919  Vt.. |.j!dQ..|..
+00002200: 00a0 22a1 00a1 010f 00a0 2374 0f6a 24a1  ..".......#t.j$.
+00002210: 017d 1a7c 1a74 0fa0 207c 0b6a 2164 5119  .}.|.t.. |.j!dQ.
+00002220: 0064 5219 00a0 22a1 00a1 010f 00a0 2374  .dR...".......#t
+00002230: 0f6a 24a1 014d 007d 1a7c 0ba0 2564 53a1  .j$..M.}.|..%dS.
+00002240: 0164 286b 027d 1b7c 0ba0 267c 1aa0 2374  .d(k.}.|..&|..#t
+00002250: 0f6a 24a1 0164 54a1 0201 007c 0ba0 267c  .j$..dT....|..&|
+00002260: 1ba0 2374 0f6a 24a1 0164 55a1 0201 0064  ..#t.j$..dU....d
+00002270: 0e90 0672 da74 1a6a 1ba0 1e7c 16a1 0190  ...r.t.j...|....
+00002280: 0672 da7c 0ba0 0864 5688 019b 0064 579d  .r.|...dV....dW.
+00002290: 0367 01a1 0101 007c 0b6a 1664 5888 019b  .g.....|.j.dX...
+000022a0: 009d 0264 598d 017d 1c7c 1c7c 1c64 5688  ...dY..}.|.|.dV.
+000022b0: 019b 0064 579d 0319 00a0 27a1 0064 5a6b  ...dW.....'..dZk
+000022c0: 0419 0088 0119 006a 287d 1d7c 1d7c 1d7c  .......j(}.|.|.|
+000022d0: 0564 0919 0064 2819 006b 0119 007d 1d74  .d...d(..k...}.t
+000022e0: 0964 5b74 0d7c 1d83 019b 0064 5c64 20a0  .d[t.|.....d\d .
+000022f0: 2964 5d64 5e84 007c 1d44 0083 01a1 019b  )d]d^..|.D......
+00002300: 0064 5f9d 0583 0101 007c 0ba0 2a88 01a1  .d_......|..*...
+00002310: 01a0 2b74 2c7c 1d83 01a1 010f 006a 287d  ..+t,|.......j(}
+00002320: 1e6e 1074 0fa0 2d7c 1aa1 01a0 2374 2ea1  .n.t..-|....#t..
+00002330: 017d 1e7c 1a7c 1b40 007d 1f7c 1f7c 1e4d  .}.|.|.@.}.|.|.M
+00002340: 007d 1f7c 0ba0 267c 1f64 53a1 0201 007c  .}.|..&|.dS....|
+00002350: 0ba0 1864 607c 1fa1 0201 007c 0390 0772  ...d`|.....|...r
+00002360: 8a74 0964 617c 1aa0 2fa1 009b 0064 6274  .t.da|../....dbt
+00002370: 0d7c 1a83 019b 0064 637c 1aa0 30a1 009b  .|.....dc|..0...
+00002380: 009d 0683 0101 0074 0964 647c 1ba0 2fa1  .......t.dd|../.
+00002390: 009b 0064 6274 0d7c 1b83 019b 0064 637c  ...dbt.|.....dc|
+000023a0: 1ba0 30a1 009b 009d 0683 0101 0074 0964  ..0..........t.d
+000023b0: 657c 1fa0 2fa1 009b 0064 6274 0d7c 1f83  e|../....dbt.|..
+000023c0: 019b 0064 637c 1fa0 30a1 009b 009d 0683  ...dc|..0.......
+000023d0: 0101 0064 667c 05a0 31a1 0076 0190 0772  ...df|..1..v...r
+000023e0: fc64 677c 05a0 31a1 0076 0090 0772 b47c  .dg|..1..v...r.|
+000023f0: 0564 6719 007c 0564 663c 006e 4864 687c  .dg..|.df<.nHdh|
+00002400: 05a0 31a1 0076 0090 0772 d07c 0564 6819  ..1..v...r.|.dh.
+00002410: 007c 0564 663c 006e 2c64 097c 05a0 31a1  .|.df<.n,d.|..1.
+00002420: 0076 0090 0772 ec7c 0564 0919 007c 0564  .v...r.|.d...|.d
+00002430: 663c 006e 1074 1964 697c 059b 0064 6a9d  f<.n.t.di|...dj.
+00002440: 0383 0182 017c 0390 0872 1674 0964 6b7c  .....|...r.t.dk|
+00002450: 119b 0064 347c 0f9b 009d 0483 0101 007c  ...d4|.........|
+00002460: 0b6a 2164 5119 0088 0119 00a0 22a1 007d  .j!dQ......."..}
+00002470: 207c 05a0 31a1 0044 005d da7d 217c 057c   |..1..D.].}!|.|
+00002480: 2119 005c 027d 227d 237c 2164 6c76 0090  !..\.}"}#|!dlv..
+00002490: 0872 7074 0fa0 327c 20a1 017d 2474 0fa0  .rpt..2| ..}$t..
+000024a0: 337c 247c 247c 236b 0119 00a1 0164 287c  3|$|$|#k.....d(|
+000024b0: 1117 000b 0019 007d 237c 207c 226b 057c  .......}#| |"k.|
+000024c0: 207c 236b 0140 007d 257c 2164 6d6b 0390   |#k.@.}%|!dmk..
+000024d0: 0872 987c 257c 1fa0 2374 2ea1 014d 007d  .r.|%|..#t...M.}
+000024e0: 257c 0b6a 267c 257c 2164 6e8d 0201 007c  %|.j&|%|!dn....|
+000024f0: 0390 0872 3074 0d7c 207c 2519 0083 0164  ...r0t.| |%....d
+00002500: 256b 0490 0872 f674 0964 6f7c 2164 709b  %k...r.t.do|!dp.
+00002510: 0464 717c 207c 2519 00a0 34a1 009b 0064  .dq| |%...4....d
+00002520: 727c 207c 2519 00a0 10a1 009b 0064 637c  r| |%........dc|
+00002530: 25a0 2fa1 009b 009d 0883 0101 006e 1274  %./..........n.t
+00002540: 0964 6f7c 2164 709b 0464 739d 0383 0101  .do|!dp..ds.....
+00002550: 0090 0871 307c 0390 0972 1a74 0964 7483  ...q0|...r.t.dt.
+00002560: 0101 007c 08a0 0364 7564 28a1 0289 037c  ...|...dud(....|
+00002570: 0390 0972 3a74 0964 7688 039b 009d 0283  ...r:t.dv.......
+00002580: 0101 0088 0088 017c 0967 037c 0a17 007c  .......|.g.|...|
+00002590: 1417 007c 1817 007c 08a0 0364 7764 00a1  ...|...|...dwd..
+000025a0: 0267 0117 0089 0288 027c 08a0 0364 7867  .g.......|...dxg
+000025b0: 00a1 0237 0089 0288 027c 0864 783c 007c  ...7.....|.dx<.|
+000025c0: 0390 0972 8a74 0964 7988 029b 009d 0283  ...r.t.dy.......
+000025d0: 0101 0087 0266 0164 7a64 2a84 087c 0ba0  .....f.dzd*..|..
+000025e0: 0ba1 006a 0c44 0083 017d 2688 0364 256b  ...j.D...}&..d%k
+000025f0: 0390 0972 cc7c 0b6a 0887 0087 0187 0366  ...r.|.j.......f
+00002600: 0364 7b64 2a84 087c 2644 0083 017c 0364  .d{d*..|&D...|.d
+00002610: 108d 0201 007c 0b53 0029 7c4e da09 6461  .....|.S.)|N..da
+00002620: 7465 5f64 6963 7472 9600 0000 da09 636f  te_dictr......co
+00002630: 6c73 5f64 6963 74da 0a6f 7468 6572 5f69  ls_dict..other_i
+00002640: 6e66 6f72 5400 0000 da09 636f 6c5f 6c61  nforT.....col_la
+00002650: 6265 6cda 0863 6f6c 735f 7469 6472 5300  bel..cols_tidrS.
+00002660: 0000 da03 616c 6c72 5800 0000 5472 0300  ....allrX...Tr..
+00002670: 0000 2902 7267 0000 005a 0769 6e70 6c61  ..).rg...Z.inpla
+00002680: 6365 4629 0272 5800 0000 5a0a 6b65 6570  ceF).rX...Z.keep
+00002690: 5f73 7061 6365 7272 0000 007a 255b 696e  _spacerr...z%[in
+000026a0: 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d 2d20  it] <---------- 
+000026b0: 6c61 6265 6c20 2d2d 2d2d 2d2d 2d2d 2d2d  label ----------
+000026c0: 3e20 7a0c 726f 6c6c 2873 6869 6674 2c20  > z.roll(shift, 
+000026d0: 7a0a 2c20 636c 6f73 652c 2020 7274 0000  z., close,  rt..
+000026e0: 007a 0a41 444a 203d 2064 6976 287a 0c2c  .z.ADJ = div(z.,
+000026f0: 2070 7265 5f63 6c6f 7365 297a 1776 7761   pre_close)z.vwa
+00002700: 7020 3d20 6469 7628 616d 6f75 6e74 2c20  p = div(amount, 
+00002710: 766f 6c29 7a25 6d65 616e 203d 206d 6561  vol)z%mean = mea
+00002720: 6e5f 6d28 6f70 656e 2c20 6869 6768 2c20  n_m(open, high, 
+00002730: 6c6f 772c 2063 6c6f 7365 29da 0474 7761  low, close)..twa
+00002740: 707a 0e74 7761 7020 3d20 6f28 7677 6170  pz.twap = o(vwap
+00002750: 2929 0472 9e00 0000 5a04 7677 6170 7271  )).r....Z.vwaprq
+00002760: 0000 0072 8800 0000 724e 0000 007a 0970  ...r....rN...z.p
+00002770: 7265 5f7b 636f 6c7d 5a04 7072 655f fa0f  re_{col}Z.pre_..
+00002780: 203d 2072 6f6c 6c28 7368 6966 742c 20fa   = roll(shift, .
+00002790: 022c 207a 0f5f 7265 7420 3d20 7265 7428  ., z._ret = ret(
+000027a0: 7072 655f fa01 2972 5700 0000 722f 0000  pre_..)rW...r/..
+000027b0: 0072 0100 0000 7242 0000 0072 3e00 0000  .r....rB...r>...
+000027c0: 7221 0000 0063 0100 0000 0000 0000 0000  r!...c..........
+000027d0: 0000 0200 0000 0700 0000 5300 0000 7322  ..........S...s"
+000027e0: 0000 0067 007c 005d 1a7d 0174 00a0 0174  ...g.|.].}.t...t
+000027f0: 027c 0183 0164 0064 0185 0219 00a1 0191  .|...d.d........
+00002800: 0271 0453 0029 0272 2100 0000 7202 0000  .q.S.).r!...r...
+00002810: 0029 0372 3000 0000 7247 0000 0072 2800  .).r0...rG...r(.
+00002820: 0000 7210 0000 0072 1300 0000 7213 0000  ..r....r....r...
+00002830: 0072 1400 0000 7236 0000 000f 0100 0072  .r....r6.......r
+00002840: 1600 0000 7a21 4261 7365 4461 7461 2e6c  ....z!BaseData.l
+00002850: 6f61 642e 3c6c 6f63 616c 733e 2e3c 6c69  oad.<locals>.<li
+00002860: 7374 636f 6d70 3e72 2d00 0000 6301 0000  stcomp>r-...c...
+00002870: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00002880: 0053 0000 0073 1400 0000 6700 7c00 5d0c  .S...s....g.|.].
+00002890: 7d01 7400 7c01 8301 9102 7104 5300 7213  }.t.|.....q.S.r.
+000028a0: 0000 0029 0172 2700 0000 7210 0000 0072  ...).r'...r....r
+000028b0: 1300 0000 7213 0000 0072 1400 0000 7236  ....r....r....r6
+000028c0: 0000 0013 0100 0072 1600 0000 da01 5f72  .......r......_r
+000028d0: 2200 0000 7229 0000 0072 5600 0000 6301  "...r)...rV...c.
+000028e0: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+000028f0: 0000 0053 0000 0073 1400 0000 6700 7c00  ...S...s....g.|.
+00002900: 5d0c 7d01 7400 7c01 8301 9102 7104 5300  ].}.t.|.....q.S.
+00002910: 7213 0000 0029 0172 2800 0000 7210 0000  r....).r(...r...
+00002920: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
+00002930: 7236 0000 0015 0100 0072 1600 0000 da0e  r6.......r......
+00002940: 636f 6c5f 6c61 6265 6c5f 6672 6f6d 7a15  col_label_fromz.
+00002950: 5b2b 5d20 6c61 6265 6c5f 6672 6f6d 5f73  [+] label_from_s
+00002960: 7472 203d 207a 132c 2063 6f6c 5f6c 6162  tr = z., col_lab
+00002970: 656c 5f66 726f 6d20 3d20 7a1a 5b2b 5d20  el_from = z.[+] 
+00002980: 636f 6c5f 6c61 6265 6c5f 6172 6773 5f6c  col_label_args_l
+00002990: 6973 7420 3d20 6301 0000 0000 0000 0000  ist = c.........
+000029a0: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+000029b0: 1400 0000 6700 7c00 5d0c 7d01 7c01 6400  ....g.|.].}.|.d.
+000029c0: 1900 9102 7104 5300 2901 7201 0000 0072  ....q.S.).r....r
+000029d0: 1300 0000 7210 0000 0072 1300 0000 7213  ....r....r....r.
+000029e0: 0000 0072 1400 0000 7236 0000 001d 0100  ...r....r6......
+000029f0: 0072 1600 0000 6301 0000 0000 0000 0000  .r....c.........
+00002a00: 0000 0002 0000 0005 0000 0053 0000 0073  ...........S...s
+00002a10: 2400 0000 6700 7c00 5d1c 7d01 7400 7c01  $...g.|.].}.t.|.
+00002a20: 6400 1900 8301 7401 7500 7204 7c01 6400  d.....t.u.r.|.d.
+00002a30: 1900 9102 7104 5300 2901 723d 0000 0029  ....q.S.).r=...)
+00002a40: 0272 2300 0000 720f 0000 0072 1000 0000  .r#...r....r....
+00002a50: 7213 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
+00002a60: 3600 0000 1d01 0000 7216 0000 0072 3900  6.......r....r9.
+00002a70: 0000 da09 4c41 4245 4c5f 5241 57da 056c  ....LABEL_RAW..l
+00002a80: 6162 656c 7264 0000 007a 115b 2b5d 2063  abelrd...z.[+] c
+00002a90: 6f6c 735f 6c61 6265 6c20 3d20 da0b 665f  ols_label = ..f_
+00002aa0: 6c61 6265 6c5f 7072 657a 125b 2b5d 2066  label_prez.[+] f
+00002ab0: 5f6c 6162 656c 5f70 7265 203d 205a 0863  _label_pre = Z.c
+00002ac0: 737a 7363 6f72 657a 0e4c 4142 454c 5f52  szscorez.LABEL_R
+00002ad0: 4157 203d 206f 287a 0f20 3d20 6167 6728  AW = o(z. = agg(
+00002ae0: 7a73 636f 7265 2c20 6301 0000 0000 0000  zscore, c.......
+00002af0: 0000 0000 0002 0000 0007 0000 0013 0000  ................
+00002b00: 0073 2600 0000 6700 7c00 5d1e 7d01 7c01  .s&...g.|.].}.|.
+00002b10: 6400 7601 7204 6401 8800 9b00 6402 7c01  d.v.r.d.....d.|.
+00002b20: 9b00 6403 9d05 9102 7104 5300 2904 2901  ..d.....q.S.).).
+00002b30: 72a4 0000 007a 0c61 6767 287a 7363 6f72  r....z.agg(zscor
+00002b40: 652c 2072 a000 0000 72a1 0000 0072 1300  e, r....r....r..
+00002b50: 0000 7233 0000 0029 0172 5300 0000 7213  ..r3...).rS...r.
+00002b60: 0000 0072 1400 0000 7236 0000 002f 0100  ...r....r6.../..
+00002b70: 0072 1600 0000 2902 7258 0000 005a 096b  .r....).rX...Z.k
+00002b80: 6565 705f 6e61 6d65 da06 6f72 6967 696e  eep_name..origin
+00002b90: 7a05 203d 206f 285a 0565 7869 7374 7a3c  z. = o(Z.existz<
+00002ba0: 5b2b 5d20 7261 7720 6c61 6265 6c20 6672  [+] raw label fr
+00002bb0: 6f6d 2064 6d2c 2028 7768 6963 6820 6d65  om dm, (which me
+00002bc0: 616e 2065 7869 7374 2074 6869 7320 636f  an exist this co
+00002bd0: 6c75 6d6e 2c20 6c61 6265 6c29 7a22 636f  lumn, label)z"co
+00002be0: 6c5f 6c61 6265 6c20 3d20 7b63 6f6c 5f6c  l_label = {col_l
+00002bf0: 6162 656c 7d20 6e6f 7420 696e 2064 6d21  abel} not in dm!
+00002c00: 7a25 5b69 6e69 745d 203c 2d2d 2d2d 2d2d  z%[init] <------
+00002c10: 2d2d 2d2d 206d 6173 6b20 202d 2d2d 2d2d  ---- mask  -----
+00002c20: 2d2d 2d2d 2d3e 207a 062f 727a 2e64 627a  -----> z./rz.dbz
+00002c30: 0e5b 2b5d 2070 6174 685f 6462 203d 2072  .[+] path_db = r
+00002c40: 7900 0000 728f 0000 007a 105b 2b5d 2063  y...r....z.[+] c
+00002c50: 6f6c 735f 6d61 736b 203d 2072 7600 0000  ols_mask = rv...
+00002c60: 7277 0000 005a 0254 3072 7100 0000 da04  rw...Z.T0rq.....
+00002c70: 6d61 736b 5a03 6b6a 795a 037a 6474 7a09  maskZ.kjyZ.zdtz.
+00002c80: 6770 286d 6561 6e2c 207a 0c2c 204c 4142  gp(mean, z., LAB
+00002c90: 454c 5f52 4157 297a 0354 302e 2901 5a07  EL_RAW)z.T0.).Z.
+00002ca0: 6466 5f6e 616d 6567 b81e 85eb 51b8 9e3f  df_nameg....Q..?
+00002cb0: 7a10 5b2b 5d20 6461 7465 5f64 726f 7020  z.[+] date_drop 
+00002cc0: 3d20 7a0e 0a64 6174 655f 6472 6f70 203d  = z..date_drop =
+00002cd0: 205b 6301 0000 0000 0000 0000 0000 0002   [c.............
+00002ce0: 0000 0003 0000 0073 0000 0073 1600 0000  .......s...s....
+00002cf0: 7c00 5d0e 7d01 7400 7c01 8301 5600 0100  |.].}.t.|...V...
+00002d00: 7102 6400 5300 720d 0000 0072 0e00 0000  q.d.S.r....r....
+00002d10: 7210 0000 0072 1300 0000 7213 0000 0072  r....r....r....r
+00002d20: 1400 0000 7215 0000 005f 0100 0072 1600  ....r...._...r..
+00002d30: 0000 7a20 4261 7365 4461 7461 2e6c 6f61  ..z BaseData.loa
+00002d40: 642e 3c6c 6f63 616c 733e 2e3c 6765 6e65  d.<locals>.<gene
+00002d50: 7870 723e fa01 5d72 7800 0000 7a0b 5b2b  xpr>..]rx...z.[+
+00002d60: 5d20 6b6a 7920 203d 207a 0320 2f20 7a03  ] kjy  = z. / z.
+00002d70: 203d 207a 0b5b 2b5d 207a 6474 2020 3d20   = z.[+] zdt  = 
+00002d80: 7a0b 5b2b 5d20 6d61 736b 203d 20da 0468  z.[+] mask = ..h
+00002d90: 6973 74da 0574 7261 696e 5a04 6c6f 6f6b  ist..trainZ.look
+00002da0: 7a0c 6461 7465 5f64 6963 7420 3d20 7a0b  z.date_dict = z.
+00002db0: 2c20 6e65 6564 2068 6973 747a 0e5b 2b5d  , need histz.[+]
+00002dc0: 2070 6164 6469 6e67 203d 2029 0272 ab00   padding = ).r..
+00002dd0: 0000 72aa 0000 00da 0474 6573 7429 015a  ..r......test).Z
+00002de0: 096d 6173 6b5f 6e61 6d65 7a10 5b2b 5d20  .mask_namez.[+] 
+00002df0: 6d61 736b 5f6e 616d 6520 3d20 7a03 3c31  mask_name = z.<1
+00002e00: 317a 027c 207a 0420 2d3e 207a 097c 206c  1z.| z. -> z.| l
+00002e10: 656e 203d 2030 7a27 5b69 6e69 745d 203c  en = 0z'[init] <
+00002e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2073 6869 6674  ---------- shift
+00002e30: 5f69 202d 2d2d 2d2d 2d2d 2d2d 2d3e 20da  _i ----------> .
+00002e40: 0773 6869 6674 5f69 7a0e 5b2b 5d20 7368  .shift_iz.[+] sh
+00002e50: 6966 745f 6920 3d20 5a08 636f 6c5f 6461  ift_i = Z.col_da
+00002e60: 7465 da10 636f 6c73 5f73 6869 6674 5f31  te..cols_shift_1
+00002e70: 5f6e 6f74 7a17 5b2b 5d20 636f 6c73 5f73  _notz.[+] cols_s
+00002e80: 6869 6674 5f31 5f6e 6f74 203d 2063 0100  hift_1_not = c..
+00002e90: 0000 0000 0000 0000 0000 0200 0000 0400  ................
+00002ea0: 0000 1300 0000 7318 0000 0067 007c 005d  ......s....g.|.]
+00002eb0: 107d 017c 0188 0076 0172 047c 0191 0271  .}.|...v.r.|...q
+00002ec0: 0453 0072 1300 0000 7213 0000 0072 3300  .S.r....r....r3.
+00002ed0: 0000 2901 72ae 0000 0072 1300 0000 7214  ..).r....r....r.
+00002ee0: 0000 0072 3600 0000 8b01 0000 7216 0000  ...r6.......r...
+00002ef0: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+00002f00: 0000 0c00 0000 1300 0000 732e 0000 0067  ..........s....g
+00002f10: 007c 005d 267d 017c 019b 0064 0088 009b  .|.]&}.|...d....
+00002f20: 0064 017c 019b 0064 0188 019b 0064 0188  .d.|...d.....d..
+00002f30: 029b 0064 029d 0a91 0271 0453 0029 0372  ...d.....q.S.).r
+00002f40: 9f00 0000 72a0 0000 0072 a100 0000 7213  ....r....r....r.
+00002f50: 0000 0072 3300 0000 2903 7254 0000 0072  ...r3...).rT...r
+00002f60: 5300 0000 72ad 0000 0072 1300 0000 7214  S...r....r....r.
+00002f70: 0000 0072 3600 0000 8c01 0000 7216 0000  ...r6.......r...
+00002f80: 0029 3572 1e00 0000 5a09 5041 5448 5f44  .)5r....Z.PATH_D
+00002f90: 4154 4172 9700 0000 7217 0000 0072 0f00  ATAr....r....r..
+00002fa0: 0000 7223 0000 0072 6800 0000 7203 0000  ..r#...rh...r...
+00002fb0: 0072 8300 0000 7246 0000 0072 6700 0000  .r....rF...rg...
+00002fc0: da04 6865 6164 7252 0000 0072 2a00 0000  ..headrR...r*...
+00002fd0: 7226 0000 0072 3000 0000 7247 0000 0072  r&...r0...rG...r
+00002fe0: 2e00 0000 7224 0000 0072 6b00 0000 724d  ....r$...rk...rM
+00002ff0: 0000 0072 7d00 0000 727a 0000 0072 6500  ...r}...rz...re.
+00003000: 0000 5a0a 7365 745f 6279 5f63 6f6c 7251  ..Z.set_by_colrQ
+00003010: 0000 00da 026f 73da 0470 6174 68da 0764  .....os..path..d
+00003020: 6972 6e61 6d65 da07 6162 7370 6174 68da  irname..abspath.
+00003030: 0665 7869 7374 7372 9000 0000 7248 0000  .existsr....rH..
+00003040: 005a 0764 665f 6469 6374 7245 0000 0072  .Z.df_dictrE...r
+00003050: 4300 0000 7287 0000 0072 8400 0000 5a08  C...r....r....Z.
+00003060: 7365 745f 6d61 736b 7285 0000 00da 0676  set_maskr......v
+00003070: 616c 7565 7372 1a00 0000 5a0e 6765 745f  aluesr....Z.get_
+00003080: 636f 6c5f 7061 6e64 6173 5a04 6973 696e  col_pandasZ.isin
+00003090: da03 7365 745a 096f 6e65 735f 6c69 6b65  ..setZ.ones_like
+000030a0: da04 626f 6f6c 7250 0000 0072 4e00 0000  ..boolrP...rN...
+000030b0: 728b 0000 0072 3200 0000 7231 0000 0072  r....r2...r1...r
+000030c0: 4a00 0000 2927 7292 0000 005a 0b64 6174  J...)'r....Z.dat
+000030d0: 615f 636f 6e66 6967 7235 0000 0072 5800  a_configr5...rX.
+000030e0: 0000 7293 0000 0072 9800 0000 7296 0000  ..r....r....r...
+000030f0: 0072 9900 0000 729a 0000 0072 9b00 0000  .r....r....r....
+00003100: 729c 0000 0072 8a00 0000 7234 0000 0072  r....r....r4...r
+00003110: 8e00 0000 7257 0000 0072 a300 0000 7256  ....rW...r....rV
+00003120: 0000 00da 0770 6164 6469 6e67 7255 0000  .....paddingrU..
+00003130: 0072 5e00 0000 7264 0000 0072 a600 0000  .r^...rd...r....
+00003140: 7289 0000 0072 8c00 0000 728f 0000 005a  r....r....r....Z
+00003150: 0a65 7869 7374 5f6d 6173 6b5a 086d 6173  .exist_maskZ.mas
+00003160: 6b5f 6b6a 795a 086d 6173 6b5f 7a64 745a  k_kjyZ.mask_zdtZ
+00003170: 0564 665f 6770 5a09 6461 7465 5f64 726f  .df_gpZ.date_dro
+00003180: 705a 096d 6173 6b5f 6472 6f70 5a09 6d61  pZ.mask_dropZ.ma
+00003190: 736b 5f6d 6173 6b72 1200 0000 da03 6b65  sk_maskr......ke
+000031a0: 7972 9400 0000 7295 0000 005a 0878 5f75  yr....r....Z.x_u
+000031b0: 6e69 7175 6572 a800 0000 5a0c 636f 6c73  niquer....Z.cols
+000031c0: 5f73 6869 6674 5f31 7213 0000 0029 0472  _shift_1r....).r
+000031d0: 5400 0000 7253 0000 0072 ae00 0000 72ad  T...rS...r....r.
+000031e0: 0000 0072 1400 0000 da04 6c6f 6164 de00  ...r......load..
+000031f0: 0000 7308 0100 0000 0206 0108 0108 0208  ..s.............
+00003200: 0108 0208 0108 0108 0108 0330 0116 020e  ...........0....
+00003210: 010e 0210 030c 0112 0118 0110 0302 0102  ................
+00003220: fe04 041a 010e 0304 0112 0110 0124 0120  .............$. 
+00003230: 010e 030c 010e 0104 0112 0116 020c 010a  ................
+00003240: 0122 0110 010e 0112 0108 0108 021a 0114  ."..............
+00003250: 021c 0112 0118 0122 011c 010a 011a 010c  ......."........
+00003260: 0114 030c 011a 010a 0118 0122 0312 0112  ..........."....
+00003270: 010a 0118 011e 010a 010e 0118 011a 020e  ................
+00003280: 050e 011a 0114 010e 0116 011e 020c 010c  ................
+00003290: 0114 031e 0114 0222 0116 0214 0222 0126  .......".....".&
+000032a0: 020e 0114 0114 0314 0114 0112 0122 0114  ............."..
+000032b0: 012a 011a 0210 0208 0108 010c 010c 0106  .*..............
+000032c0: 0126 0126 0126 030e 011c 011c 011c 0110  .&.&.&..........
+000032d0: 011a 0112 010c 010c 010a 010a 011c 0210  ................
+000032e0: 010a 010e 010e 0106 014a 0116 030e 010c  .........J......
+000032f0: 0114 0124 0110 0108 0114 0118 012a 027a  ...$.........*.z
+00003300: 0d42 6173 6544 6174 612e 6c6f 6164 2902  .BaseData.load).
+00003310: 4e54 2905 da08 5f5f 6e61 6d65 5f5f da0a  NT)...__name__..
+00003320: 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f 7175  __module__..__qu
+00003330: 616c 6e61 6d65 5f5f 7297 0000 0072 ba00  alname__r....r..
+00003340: 0000 7213 0000 0072 1300 0000 7213 0000  ..r....r....r...
+00003350: 0072 1400 0000 7291 0000 00da 0000 0073  .r....r........s
+00003360: 0400 0000 0801 0803 7291 0000 0029 0272  ........r....).r
+00003370: 2f00 0000 5429 0154 291f 72b0 0000 00da  /...T).T).r.....
+00003380: 056e 756d 7079 7230 0000 00da 0670 616e  .numpyr0.....pan
+00003390: 6461 7372 6b00 0000 da06 706f 6c61 7273  dasrk.....polars
+000033a0: 7244 0000 005a 0f63 6f72 652e 4461 7461  rD...Z.core.Data
+000033b0: 4d61 7374 6572 7203 0000 005a 0975 7469  Masterr....Z.uti
+000033c0: 6c2e 7574 696c 7204 0000 0072 0500 0000  l.utilr....r....
+000033d0: 7206 0000 005a 0875 7469 6c2e 6e70 7972  r....Z.util.npyr
+000033e0: 0700 0000 5a0e 7574 696c 2e6e 7079 5f6e  ....Z.util.npy_n
+000033f0: 756d 6261 7208 0000 0072 0900 0000 5a07  umbar....r....Z.
+00003400: 7574 696c 2e64 6272 0a00 0000 7246 0000  util.dbr....rF..
+00003410: 0072 1800 0000 5a0a 7574 696c 2e63 6f6e  .r....Z.util.con
+00003420: 7374 721e 0000 0072 1f00 0000 7228 0000  str....r....r(..
+00003430: 0072 2e00 0000 7265 0000 0072 7000 0000  .r....re...rp...
+00003440: 7290 0000 0072 9100 0000 7213 0000 0072  r....r....r....r
+00003450: 1300 0000 7213 0000 0072 1400 0000 da08  ....r....r......
+00003460: 3c6d 6f64 756c 653e 0100 0000 7324 0000  <module>....s$..
+00003470: 0008 0108 0108 0108 010c 0114 010c 0110  ................
+00003480: 010c 0104 0108 020c 010c 0308 0808 080a  ................
+00003490: 4308 100a 66                             C...f
```

## runningz/fe/prepare_data/base_data_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 19970 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 024e 0000  a.........Yf.N..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 ed4e 0000  a.........\f.N..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 755d 4c00  ..d.S.).N../u]L.
+00000100: 0100 6400 5300 2906 4efa 012f 7548 4d00  ..d.S.).N../uHM.
 00000110: 0069 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
 00000120: 7420 6e75 6d70 7920 6173 206e 700a 696d  t numpy as np.im
 00000130: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
 00000140: 640a 696d 706f 7274 2070 6f6c 6172 7320  d.import polars 
 00000150: 6173 2070 6c0a 6672 6f6d 202e 2e2e 636f  as pl.from ...co
 00000160: 7265 2e44 6174 614d 6173 7465 7220 696d  re.DataMaster im
 00000170: 706f 7274 2044 6174 614d 6173 7465 720a  port DataMaster.
@@ -236,1031 +236,1045 @@
 00000eb0: 305d 5d2e 746f 5f6e 756d 7079 2829 0a20  0]].to_numpy(). 
 00000ec0: 2020 2020 2020 2020 2020 2078 3120 3d20             x1 = 
 00000ed0: 6466 5f6c 6162 656c 5f66 696e 616c 5b63  df_label_final[c
 00000ee0: 6f6c 735b 315d 5d2e 746f 5f6e 756d 7079  ols[1]].to_numpy
 00000ef0: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
 00000f00: 203d 206e 702e 7768 6572 6528 7830 202a   = np.where(x0 *
 00000f10: 2078 3120 3e20 302c 2078 302c 2030 290a   x1 > 0, x0, 0).
-00000f20: 2020 2020 2020 2020 656c 7365 3a20 7261          else: ra
-00000f30: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00000f40: 6564 4572 726f 7228 6627 6c61 6265 6c5f  edError(f'label_
-00000f50: 6672 6f6d 5f73 7472 2065 7272 6f72 2c20  from_str error, 
-00000f60: 6f70 203d 207b 6f70 7d27 290a 2020 2020  op = {op}').    
-00000f70: 2020 2020 6466 5f6c 6162 656c 5f66 696e      df_label_fin
-00000f80: 616c 203d 2064 665f 6c61 6265 6c5f 6669  al = df_label_fi
-00000f90: 6e61 6c2e 7769 7468 5f63 6f6c 756d 6e73  nal.with_columns
-00000fa0: 2870 6c2e 5365 7269 6573 2827 4c41 4245  (pl.Series('LABE
-00000fb0: 4c5f 4652 4f4d 5f53 5452 272c 2078 2929  L_FROM_STR', x))
-00000fc0: 0a20 2020 2063 6f6c 735f 6c61 6265 6c20  .    cols_label 
-00000fd0: 3d20 5b63 6f6c 2066 6f72 2063 6f6c 2069  = [col for col i
-00000fe0: 6e20 6466 5f6c 6162 656c 5f66 696e 616c  n df_label_final
-00000ff0: 2e63 6f6c 756d 6e73 2069 6620 636f 6c20  .columns if col 
-00001000: 6e6f 7420 696e 2063 6f6c 735f 6964 5d20  not in cols_id] 
-00001010: 200a 2020 2020 7265 7475 726e 2064 665f   .    return df_
-00001020: 6c61 6265 6c5f 6669 6e61 6c2c 2063 6f6c  label_final, col
-00001030: 735f 6c61 6265 6c0a 0a64 6566 2064 665f  s_label..def df_
-00001040: 6578 7061 6e64 5f4c 5f52 2864 665f 4c2c  expand_L_R(df_L,
-00001050: 2064 665f 5229 3a0a 2020 2020 6461 7465   df_R):.    date
-00001060: 735f 6861 7665 203d 2064 665f 525b 2774  s_have = df_R['t
-00001070: 7261 6465 5f64 6174 6527 5d2e 756e 6971  rade_date'].uniq
-00001080: 7565 2829 0a20 2020 2064 6174 6573 5f74  ue().    dates_t
-00001090: 6f64 6f20 3d20 6466 5f4c 5b27 7472 6164  odo = df_L['trad
-000010a0: 655f 6461 7465 275d 2e75 6e69 7175 6528  e_date'].unique(
-000010b0: 290a 2020 2020 6461 7465 735f 746f 646f  ).    dates_todo
-000010c0: 203d 2064 6174 6573 5f74 6f64 6f5b 6461   = dates_todo[da
-000010d0: 7465 735f 746f 646f 203e 2064 6174 6573  tes_todo > dates
-000010e0: 5f68 6176 655b 2d31 5d5d 0a20 2020 2064  _have[-1]].    d
-000010f0: 665f 525f 6c61 7374 203d 2064 665f 525b  f_R_last = df_R[
-00001100: 6466 5f52 5b27 7472 6164 655f 6461 7465  df_R['trade_date
-00001110: 275d 203d 3d20 6461 7465 735f 6861 7665  '] == dates_have
-00001120: 5b2d 315d 5d2e 7265 7365 745f 696e 6465  [-1]].reset_inde
-00001130: 7828 6472 6f70 203d 2054 7275 6529 0a20  x(drop = True). 
-00001140: 2020 2069 6620 6c65 6e28 6461 7465 735f     if len(dates_
-00001150: 746f 646f 2920 3d3d 2030 3a20 7265 7475  todo) == 0: retu
-00001160: 726e 2064 665f 520a 2020 2020 6466 5f6e  rn df_R.    df_n
-00001170: 6578 745f 6c69 7374 203d 205b 5d20 0a20  ext_list = [] . 
-00001180: 2020 2070 7269 6e74 2866 275b 2b5d 2064     print(f'[+] d
-00001190: 6174 6573 5f74 6f64 6f20 3d20 7b64 6174  ates_todo = {dat
-000011a0: 6573 5f74 6f64 6f7d 2729 0a20 2020 2066  es_todo}').    f
-000011b0: 6f72 2064 6174 6520 696e 2064 6174 6573  or date in dates
-000011c0: 5f74 6f64 6f3a 0a20 2020 2020 2020 2064  _todo:.        d
-000011d0: 665f 6e65 7874 203d 2064 665f 525f 6c61  f_next = df_R_la
-000011e0: 7374 2e63 6f70 7928 290a 2020 2020 2020  st.copy().      
-000011f0: 2020 6466 5f6e 6578 745b 2774 7261 6465    df_next['trade
-00001200: 5f64 6174 6527 5d20 3d20 6461 7465 0a20  _date'] = date. 
-00001210: 2020 2020 2020 2064 665f 6e65 7874 5f6c         df_next_l
-00001220: 6973 742e 6170 7065 6e64 2864 665f 6e65  ist.append(df_ne
-00001230: 7874 290a 2020 2020 6466 5f6e 6578 7420  xt).    df_next 
-00001240: 3d20 7064 2e63 6f6e 6361 7428 6466 5f6e  = pd.concat(df_n
-00001250: 6578 745f 6c69 7374 2c20 6178 6973 203d  ext_list, axis =
-00001260: 2030 292e 7265 7365 745f 696e 6465 7828   0).reset_index(
-00001270: 6472 6f70 203d 2054 7275 6529 0a20 2020  drop = True).   
-00001280: 2064 665f 5220 3d20 7064 2e63 6f6e 6361   df_R = pd.conca
-00001290: 7428 5b64 665f 522c 2064 665f 6e65 7874  t([df_R, df_next
-000012a0: 5d2c 2061 7869 7320 3d20 302c 2073 6f72  ], axis = 0, sor
-000012b0: 7420 3d20 4661 6c73 6529 2e72 6573 6574  t = False).reset
-000012c0: 5f69 6e64 6578 2864 726f 7020 3d20 5472  _index(drop = Tr
-000012d0: 7565 290a 2020 2020 7265 7475 726e 2064  ue).    return d
-000012e0: 665f 520a 0a64 6566 2067 6574 5f64 665f  f_R..def get_df_
-000012f0: 6d61 736b 2870 6174 685f 6462 2c20 646d  mask(path_db, dm
-00001300: 2c20 636f 6c5f 7469 642c 2063 6f6c 5f69  , col_tid, col_i
-00001310: 642c 2076 6572 626f 7365 203d 2054 7275  d, verbose = Tru
-00001320: 6529 3a0a 2020 2020 6466 203d 2064 6d2e  e):.    df = dm.
-00001330: 6765 745f 636f 6c73 5f70 616e 6461 7328  get_cols_pandas(
-00001340: 5b63 6f6c 5f74 6964 2c20 636f 6c5f 6964  [col_tid, col_id
-00001350: 5d20 2b20 5b27 6f70 656e 272c 2027 7063  ] + ['open', 'pc
-00001360: 745f 6368 6727 5d29 0a20 2020 2064 6220  t_chg']).    db 
-00001370: 3d20 4442 4d61 7374 6572 2870 6174 685f  = DBMaster(path_
-00001380: 6462 2c20 7665 7262 6f73 6520 3d20 7665  db, verbose = ve
-00001390: 7262 6f73 6529 0a20 2020 2064 622e 636f  rbose).    db.co
-000013a0: 6e6e 6563 7428 290a 0a20 2020 206b 6579  nnect()..    key
-000013b0: 7320 3d20 5b63 6f6c 5f74 6964 2c20 636f  s = [col_tid, co
-000013c0: 6c5f 6964 5d0a 2020 2020 6466 5f4c 203d  l_id].    df_L =
-000013d0: 2064 665b 6b65 7973 5d0a 2020 2020 0a20   df[keys].    . 
-000013e0: 2020 2023 2070 7269 6e74 2827 5b2b 5d20     # print('[+] 
-000013f0: 7265 6164 206c 6973 745f 6461 7465 2729  read list_date')
-00001400: 0a20 2020 2063 6f6c 203d 2027 6c69 7374  .    col = 'list
-00001410: 5f64 6174 6527 0a20 2020 2064 665f 5220  _date'.    df_R 
-00001420: 3d20 6462 2e73 656c 6563 7428 2764 665f  = db.select('df_
-00001430: 6c69 7374 5f64 6174 6527 2c20 636f 6c73  list_date', cols
-00001440: 203d 205b 636f 6c5f 6964 5d20 2b20 5b63   = [col_id] + [c
-00001450: 6f6c 5d29 0a20 2020 2064 665f 5220 3d20  ol]).    df_R = 
-00001460: 6466 5f52 5b64 665f 525b 276c 6973 745f  df_R[df_R['list_
-00001470: 6461 7465 275d 203e 2030 5d2e 7265 7365  date'] > 0].rese
-00001480: 745f 696e 6465 7828 6472 6f70 203d 2054  t_index(drop = T
-00001490: 7275 6529 0a20 2020 2073 5f6c 6973 745f  rue).    s_list_
-000014a0: 6461 7465 203d 206d 6572 6765 2864 665f  date = merge(df_
-000014b0: 4c2c 2064 665f 522c 205b 636f 6c5f 6964  L, df_R, [col_id
-000014c0: 5d29 5b63 6f6c 5d2e 746f 5f70 616e 6461  ])[col].to_panda
-000014d0: 7328 290a 2020 2020 0a20 2020 2023 2070  s().    .    # p
-000014e0: 7269 6e74 2827 5b2b 5d20 7265 6164 2073  rint('[+] read s
-000014f0: 5f73 7427 290a 2020 2020 636f 6c20 3d20  _st').    col = 
-00001500: 2753 5427 0a20 2020 2064 665f 5220 3d20  'ST'.    df_R = 
-00001510: 6462 2e73 656c 6563 7428 2764 665f 7374  db.select('df_st
-00001520: 272c 2063 6f6c 7320 3d20 6b65 7973 202b  ', cols = keys +
-00001530: 205b 636f 6c5d 290a 2020 2020 6466 5f52   [col]).    df_R
-00001540: 203d 2064 665f 6578 7061 6e64 5f4c 5f52   = df_expand_L_R
-00001550: 2864 665f 4c2c 2064 665f 5229 0a20 2020  (df_L, df_R).   
-00001560: 2073 5f73 7420 3d20 6d65 7267 6528 6466   s_st = merge(df
-00001570: 5f4c 2c20 6466 5f52 2c20 6b65 7973 295b  _L, df_R, keys)[
-00001580: 2753 5427 5d2e 746f 5f70 616e 6461 7328  'ST'].to_pandas(
-00001590: 292e 6669 6c6c 6e61 2830 290a 2020 2020  ).fillna(0).    
-000015a0: 0a20 2020 2023 2070 7269 6e74 2827 5b2b  .    # print('[+
-000015b0: 5d20 7265 6164 2073 5f73 7573 2729 0a20  ] read s_sus'). 
-000015c0: 2020 2063 6f6c 203d 2027 5355 5327 0a20     col = 'SUS'. 
-000015d0: 2020 2064 665f 5220 3d20 6462 2e73 656c     df_R = db.sel
-000015e0: 6563 7428 2764 665f 7375 7327 2c20 636f  ect('df_sus', co
-000015f0: 6c73 203d 206b 6579 7320 2b20 5b63 6f6c  ls = keys + [col
-00001600: 5d29 0a20 2020 2064 665f 5220 3d20 6466  ]).    df_R = df
-00001610: 5f65 7870 616e 645f 4c5f 5228 6466 5f4c  _expand_L_R(df_L
-00001620: 2c20 6466 5f52 290a 2020 2020 735f 7375  , df_R).    s_su
-00001630: 7320 3d20 6d65 7267 6528 6466 5f4c 2c20  s = merge(df_L, 
-00001640: 6466 5f52 2c20 6b65 7973 295b 2753 5553  df_R, keys)['SUS
-00001650: 275d 2e74 6f5f 7061 6e64 6173 2829 2e66  '].to_pandas().f
-00001660: 696c 6c6e 6128 3029 0a20 2020 200a 2020  illna(0).    .  
-00001670: 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2064    # ---------- d
-00001680: 665f 6d61 736b 202d 2d2d 2d2d 2d2d 2d2d  f_mask ---------
-00001690: 2d0a 2020 2020 2320 7072 696e 7428 275b  -.    # print('[
-000016a0: 2b5d 2064 665f 6d61 736b 2729 0a20 2020  +] df_mask').   
-000016b0: 2064 665f 6d61 736b 203d 2064 665b 6b65   df_mask = df[ke
-000016c0: 7973 202b 205b 276f 7065 6e27 2c20 2770  ys + ['open', 'p
-000016d0: 6374 5f63 6867 275d 5d0a 2020 2020 6466  ct_chg']].    df
-000016e0: 5f6d 6173 6b5b 276c 6973 745f 6461 7465  _mask['list_date
-000016f0: 275d 203d 2073 5f6c 6973 745f 6461 7465  '] = s_list_date
-00001700: 0a20 2020 2064 665f 6d61 736b 5b27 5354  .    df_mask['ST
-00001710: 275d 203d 2073 5f73 740a 2020 2020 6466  '] = s_st.    df
-00001720: 5f6d 6173 6b5b 2753 5553 275d 203d 2073  _mask['SUS'] = s
-00001730: 5f73 7573 0a0a 2020 2020 7320 3d20 6466  _sus..    s = df
-00001740: 5f6d 6173 6b5b 636f 6c5f 7469 645d 2e64  _mask[col_tid].d
-00001750: 726f 705f 6475 706c 6963 6174 6573 2829  rop_duplicates()
-00001760: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
-00001770: 7020 3d20 5472 7565 290a 2020 2020 6461  p = True).    da
-00001780: 7465 5f64 6963 745f 3120 3d20 6469 6374  te_dict_1 = dict
-00001790: 287a 6970 2873 2c20 7064 2e74 6f5f 6461  (zip(s, pd.to_da
-000017a0: 7465 7469 6d65 2873 2c20 666f 726d 6174  tetime(s, format
-000017b0: 3d27 2559 256d 2564 2729 2929 0a20 2020  ='%Y%m%d'))).   
-000017c0: 2073 203d 2064 665f 6d61 736b 5b27 6c69   s = df_mask['li
-000017d0: 7374 5f64 6174 6527 5d2e 6472 6f70 5f64  st_date'].drop_d
-000017e0: 7570 6c69 6361 7465 7328 292e 7265 7365  uplicates().rese
-000017f0: 745f 696e 6465 7828 6472 6f70 203d 2054  t_index(drop = T
-00001800: 7275 6529 0a20 2020 2064 6174 655f 6469  rue).    date_di
-00001810: 6374 5f32 203d 2064 6963 7428 7a69 7028  ct_2 = dict(zip(
-00001820: 732c 2070 642e 746f 5f64 6174 6574 696d  s, pd.to_datetim
-00001830: 6528 732c 2066 6f72 6d61 743d 2725 5925  e(s, format='%Y%
-00001840: 6d25 6427 2929 290a 0a20 2020 2023 2069  m%d')))..    # i
-00001850: 6478 5f78 7878 0a20 2020 2069 6478 5f32  dx_xxx.    idx_2
-00001860: 3020 3d20 2864 665f 6d61 736b 5b63 6f6c  0 = (df_mask[col
-00001870: 5f74 6964 5d2e 6d61 7028 6461 7465 5f64  _tid].map(date_d
-00001880: 6963 745f 3129 202d 2064 665f 6d61 736b  ict_1) - df_mask
-00001890: 5b27 6c69 7374 5f64 6174 6527 5d2e 6d61  ['list_date'].ma
-000018a0: 7028 6461 7465 5f64 6963 745f 3229 292e  p(date_dict_2)).
-000018b0: 6474 2e64 6179 7320 3e3d 2032 300a 2020  dt.days >= 20.  
-000018c0: 2020 6964 785f 6e61 6e20 3d20 7e64 665f    idx_nan = ~df_
-000018d0: 6d61 736b 5b27 6f70 656e 275d 2e69 736e  mask['open'].isn
-000018e0: 756c 6c28 290a 2020 2020 6964 785f 7374  ull().    idx_st
-000018f0: 203d 2064 665f 6d61 736b 5b27 5354 275d   = df_mask['ST']
-00001900: 203c 3d20 300a 2020 2020 6964 785f 7375   <= 0.    idx_su
-00001910: 7320 3d20 6466 5f6d 6173 6b5b 2753 5553  s = df_mask['SUS
-00001920: 275d 203c 3d20 310a 2020 2020 0a20 2020  '] <= 1.    .   
-00001930: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-00001940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001990: 2d2d 2d2d 2d2d 2d0a 2020 2020 6e61 6d65  -------.    name
-000019a0: 5f6c 6973 7420 3d20 5b0a 2020 2020 2020  _list = [.      
-000019b0: 2020 6627 5f5f 5445 4d50 5f61 5f31 203d    f'__TEMP_a_1 =
-000019c0: 2072 6f6c 6c28 7368 6966 742c 207b 636f   roll(shift, {co
-000019d0: 6c5f 6964 7d2c 2061 6d6f 756e 742c 207b  l_id}, amount, {
-000019e0: 636f 6c5f 7469 647d 2c20 3029 272c 0a20  col_tid}, 0)',. 
-000019f0: 2020 2020 2020 2066 275f 5f54 454d 505f         f'__TEMP_
-00001a00: 615f 3220 3d20 726f 6c6c 2873 6869 6674  a_2 = roll(shift
-00001a10: 2c20 7b63 6f6c 5f69 647d 2c20 616d 6f75  , {col_id}, amou
-00001a20: 6e74 2c20 7b63 6f6c 5f74 6964 7d2c 2031  nt, {col_tid}, 1
-00001a30: 2927 2c0a 2020 2020 2020 2020 6627 5f5f  )',.        f'__
-00001a40: 5445 4d50 5f61 5f33 203d 2072 6f6c 6c28  TEMP_a_3 = roll(
-00001a50: 7368 6966 742c 207b 636f 6c5f 6964 7d2c  shift, {col_id},
-00001a60: 2061 6d6f 756e 742c 207b 636f 6c5f 7469   amount, {col_ti
-00001a70: 647d 2c20 3229 272c 0a20 2020 2020 2020  d}, 2)',.       
-00001a80: 200a 2020 2020 2020 2020 6627 5f5f 5445   .        f'__TE
-00001a90: 4d50 5f68 5f31 203d 2072 6f6c 6c28 7368  MP_h_1 = roll(sh
-00001aa0: 6966 742c 207b 636f 6c5f 6964 7d2c 2068  ift, {col_id}, h
-00001ab0: 6967 682c 207b 636f 6c5f 7469 647d 2c20  igh, {col_tid}, 
-00001ac0: 3029 272c 0a20 2020 2020 2020 2066 275f  0)',.        f'_
-00001ad0: 5f54 454d 505f 685f 3220 3d20 726f 6c6c  _TEMP_h_2 = roll
-00001ae0: 2873 6869 6674 2c20 7b63 6f6c 5f69 647d  (shift, {col_id}
-00001af0: 2c20 6869 6768 2c20 7b63 6f6c 5f74 6964  , high, {col_tid
-00001b00: 7d2c 2031 2927 2c0a 2020 2020 2020 2020  }, 1)',.        
-00001b10: 6627 5f5f 5445 4d50 5f68 5f33 203d 2072  f'__TEMP_h_3 = r
-00001b20: 6f6c 6c28 7368 6966 742c 207b 636f 6c5f  oll(shift, {col_
-00001b30: 6964 7d2c 2068 6967 682c 207b 636f 6c5f  id}, high, {col_
-00001b40: 7469 647d 2c20 3229 272c 0a0a 2020 2020  tid}, 2)',..    
-00001b50: 2020 2020 6627 5f5f 5445 4d50 5f6c 5f31      f'__TEMP_l_1
-00001b60: 203d 2072 6f6c 6c28 7368 6966 742c 207b   = roll(shift, {
-00001b70: 636f 6c5f 6964 7d2c 206c 6f77 2c20 7b63  col_id}, low, {c
-00001b80: 6f6c 5f74 6964 7d2c 2030 2927 2c0a 2020  ol_tid}, 0)',.  
-00001b90: 2020 2020 2020 6627 5f5f 5445 4d50 5f6c        f'__TEMP_l
-00001ba0: 5f32 203d 2072 6f6c 6c28 7368 6966 742c  _2 = roll(shift,
-00001bb0: 207b 636f 6c5f 6964 7d2c 206c 6f77 2c20   {col_id}, low, 
-00001bc0: 7b63 6f6c 5f74 6964 7d2c 2031 2927 2c0a  {col_tid}, 1)',.
-00001bd0: 2020 2020 2020 2020 6627 5f5f 5445 4d50          f'__TEMP
-00001be0: 5f6c 5f33 203d 2072 6f6c 6c28 7368 6966  _l_3 = roll(shif
-00001bf0: 742c 207b 636f 6c5f 6964 7d2c 206c 6f77  t, {col_id}, low
-00001c00: 2c20 7b63 6f6c 5f74 6964 7d2c 2032 2927  , {col_tid}, 2)'
-00001c10: 2c0a 2020 2020 5d0a 2020 2020 646d 2e66  ,.    ].    dm.f
-00001c20: 655f 676f 286e 616d 655f 6c69 7374 2c20  e_go(name_list, 
-00001c30: 7665 7262 6f73 6520 3d20 4661 6c73 6529  verbose = False)
-00001c40: 0a20 2020 2069 6478 5f61 2020 3d20 646d  .    idx_a  = dm
-00001c50: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
-00001c60: 5f5f 5445 4d50 5f61 5f31 2729 203c 3d20  __TEMP_a_1') <= 
-00001c70: 3565 360a 2020 2020 6964 785f 6120 263d  5e6.    idx_a &=
-00001c80: 2064 6d2e 6765 745f 636f 6c5f 6e75 6d70   dm.get_col_nump
-00001c90: 7928 275f 5f54 454d 505f 615f 3227 2920  y('__TEMP_a_2') 
-00001ca0: 3c3d 2035 6536 0a20 2020 2069 6478 5f61  <= 5e6.    idx_a
-00001cb0: 2026 3d20 646d 2e67 6574 5f63 6f6c 5f6e   &= dm.get_col_n
-00001cc0: 756d 7079 2827 5f5f 5445 4d50 5f61 5f33  umpy('__TEMP_a_3
-00001cd0: 2729 203c 3d20 3565 360a 0a20 2020 2069  ') <= 5e6..    i
-00001ce0: 6478 5f69 6e74 7261 5f72 6574 2020 3d20  dx_intra_ret  = 
-00001cf0: 6e70 2e61 6273 2864 6d2e 6765 745f 636f  np.abs(dm.get_co
-00001d00: 6c5f 6e75 6d70 7928 275f 5f54 454d 505f  l_numpy('__TEMP_
-00001d10: 685f 3127 2920 2f20 646d 2e67 6574 5f63  h_1') / dm.get_c
-00001d20: 6f6c 5f6e 756d 7079 2827 5f5f 5445 4d50  ol_numpy('__TEMP
-00001d30: 5f6c 5f31 2729 202d 2031 2920 3c3d 2030  _l_1') - 1) <= 0
-00001d40: 2e32 202f 2031 3030 0a20 2020 2069 6478  .2 / 100.    idx
-00001d50: 5f69 6e74 7261 5f72 6574 2026 3d20 6e70  _intra_ret &= np
-00001d60: 2e61 6273 2864 6d2e 6765 745f 636f 6c5f  .abs(dm.get_col_
-00001d70: 6e75 6d70 7928 275f 5f54 454d 505f 685f  numpy('__TEMP_h_
-00001d80: 3227 2920 2f20 646d 2e67 6574 5f63 6f6c  2') / dm.get_col
-00001d90: 5f6e 756d 7079 2827 5f5f 5445 4d50 5f6c  _numpy('__TEMP_l
-00001da0: 5f32 2729 202d 2031 2920 3c3d 2030 2e32  _2') - 1) <= 0.2
-00001db0: 202f 2031 3030 0a20 2020 2069 6478 5f69   / 100.    idx_i
-00001dc0: 6e74 7261 5f72 6574 2026 3d20 6e70 2e61  ntra_ret &= np.a
-00001dd0: 6273 2864 6d2e 6765 745f 636f 6c5f 6e75  bs(dm.get_col_nu
-00001de0: 6d70 7928 275f 5f54 454d 505f 685f 3327  mpy('__TEMP_h_3'
-00001df0: 2920 2f20 646d 2e67 6574 5f63 6f6c 5f6e  ) / dm.get_col_n
-00001e00: 756d 7079 2827 5f5f 5445 4d50 5f6c 5f33  umpy('__TEMP_l_3
-00001e10: 2729 202d 2031 2920 3c3d 2030 2e32 202f  ') - 1) <= 0.2 /
-00001e20: 2031 3030 0a0a 2020 2020 6964 785f 696e   100..    idx_in
-00001e30: 7472 615f 6469 6620 203d 206e 702e 6162  tra_dif  = np.ab
-00001e40: 7328 646d 2e67 6574 5f63 6f6c 5f6e 756d  s(dm.get_col_num
-00001e50: 7079 2827 5f5f 5445 4d50 5f68 5f31 2729  py('__TEMP_h_1')
-00001e60: 202d 2064 6d2e 6765 745f 636f 6c5f 6e75   - dm.get_col_nu
-00001e70: 6d70 7928 275f 5f54 454d 505f 6c5f 3127  mpy('__TEMP_l_1'
-00001e80: 2920 2d20 3029 203c 3d20 302e 3034 0a20  ) - 0) <= 0.04. 
-00001e90: 2020 2069 6478 5f69 6e74 7261 5f64 6966     idx_intra_dif
-00001ea0: 2026 3d20 6e70 2e61 6273 2864 6d2e 6765   &= np.abs(dm.ge
-00001eb0: 745f 636f 6c5f 6e75 6d70 7928 275f 5f54  t_col_numpy('__T
-00001ec0: 454d 505f 685f 3227 2920 2d20 646d 2e67  EMP_h_2') - dm.g
-00001ed0: 6574 5f63 6f6c 5f6e 756d 7079 2827 5f5f  et_col_numpy('__
-00001ee0: 5445 4d50 5f6c 5f32 2729 202d 2030 2920  TEMP_l_2') - 0) 
-00001ef0: 3c3d 2030 2e30 340a 2020 2020 6964 785f  <= 0.04.    idx_
-00001f00: 696e 7472 615f 6469 6620 263d 206e 702e  intra_dif &= np.
-00001f10: 6162 7328 646d 2e67 6574 5f63 6f6c 5f6e  abs(dm.get_col_n
-00001f20: 756d 7079 2827 5f5f 5445 4d50 5f68 5f33  umpy('__TEMP_h_3
-00001f30: 2729 202d 2064 6d2e 6765 745f 636f 6c5f  ') - dm.get_col_
-00001f40: 6e75 6d70 7928 275f 5f54 454d 505f 6c5f  numpy('__TEMP_l_
-00001f50: 3327 2920 2d20 3029 203c 3d20 302e 3034  3') - 0) <= 0.04
-00001f60: 0a20 2020 2064 6d2e 6472 6f70 286e 616d  .    dm.drop(nam
-00001f70: 655f 6c69 7374 2c20 7665 7262 6f73 6520  e_list, verbose 
-00001f80: 3d20 4661 6c73 6529 0a20 2020 206d 6173  = False).    mas
-00001f90: 6b5f 6b6a 795f 7476 7220 3d20 7e28 6964  k_kjy_tvr = ~(id
-00001fa0: 785f 6120 7c20 6964 785f 696e 7472 615f  x_a | idx_intra_
-00001fb0: 7265 7420 7c20 6964 785f 696e 7472 615f  ret | idx_intra_
-00001fc0: 6469 6629 0a0a 2020 2020 2320 3020 3d20  dif)..    # 0 = 
-00001fd0: 3630 7878 7878 2e53 480a 2020 2020 2320  60xxxx.SH.    # 
-00001fe0: 3120 3d20 3030 7878 7878 2e53 5a0a 2020  1 = 00xxxx.SZ.  
-00001ff0: 2020 2320 3220 3d20 3330 7878 7878 2e53    # 2 = 30xxxx.S
-00002000: 5a0a 2020 2020 2320 3320 3d20 3638 7878  Z.    # 3 = 68xx
-00002010: 7878 2e53 480a 2020 2020 2320 3420 3d20  xx.SH.    # 4 = 
-00002020: 5b34 2c38 5d78 7878 7878 2e42 4a0a 2020  [4,8]xxxxx.BJ.  
-00002030: 2020 6964 5f6b 203d 2064 665b 636f 6c5f    id_k = df[col_
-00002040: 6964 5d2e 756e 6971 7565 2829 0a20 2020  id].unique().   
-00002050: 2069 645f 7620 3d20 2870 642e 5365 7269   id_v = (pd.Seri
-00002060: 6573 2869 645f 6b29 2e61 7070 6c79 2863  es(id_k).apply(c
-00002070: 6f64 655f 325f 6d61 726b 6574 2920 3c3d  ode_2_market) <=
-00002080: 2033 290a 2020 2020 6d61 736b 5f6b 6a79   3).    mask_kjy
-00002090: 5f69 6420 3d20 6466 5b63 6f6c 5f69 645d  _id = df[col_id]
-000020a0: 2e6d 6170 2864 6963 7428 7a69 7028 6964  .map(dict(zip(id
-000020b0: 5f6b 2c20 6964 5f76 2929 2920 3d3d 2054  _k, id_v))) == T
-000020c0: 7275 650a 2020 2020 2320 2d2d 2d2d 2d2d  rue.    # ------
-000020d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000020e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000020f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002100: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002110: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a  --------------..
-00002130: 2020 2020 6966 2076 6572 626f 7365 3a20      if verbose: 
-00002140: 7072 696e 7428 275b 2b5d 2053 542c 204b  print('[+] ST, K
-00002150: 4a59 2c20 5a44 542c 204d 4153 4b27 290a  JY, ZDT, MASK').
-00002160: 2020 2020 6466 5f6d 6173 6b5b 274d 4153      df_mask['MAS
-00002170: 4b5f 5354 275d 203d 2028 6964 785f 7374  K_ST'] = (idx_st
-00002180: 292e 6173 7479 7065 286e 702e 696e 7433  ).astype(np.int3
-00002190: 3229 0a0a 2020 2020 6466 5f6d 6173 6b5b  2)..    df_mask[
-000021a0: 274d 4153 4b5f 4b4a 5927 5d20 3d20 2869  'MASK_KJY'] = (i
-000021b0: 6478 5f6e 616e 2026 2069 6478 5f32 3020  dx_nan & idx_20 
-000021c0: 2620 6964 785f 7374 2026 2069 6478 5f73  & idx_st & idx_s
-000021d0: 7573 292e 6173 7479 7065 286e 702e 696e  us).astype(np.in
-000021e0: 7433 3229 0a20 2020 2069 6620 7665 7262  t32).    if verb
-000021f0: 6f73 653a 2070 7269 6e74 2866 225b 2b5d  ose: print(f"[+]
-00002200: 2064 665f 6d61 736b 5b27 4d41 534b 5f4b   df_mask['MASK_K
-00002210: 4a59 275d 2e73 756d 2829 203d 207b 6466  JY'].sum() = {df
-00002220: 5f6d 6173 6b5b 274d 4153 4b5f 4b4a 5927  _mask['MASK_KJY'
-00002230: 5d2e 7375 6d28 297d 2229 0a20 2020 2023  ].sum()}").    #
-00002240: 2064 665f 6d61 736b 5b27 4d41 534b 5f4b   df_mask['MASK_K
-00002250: 4a59 275d 203d 2028 6466 5f6d 6173 6b5b  JY'] = (df_mask[
-00002260: 274d 4153 4b5f 4b4a 5927 5d20 2620 6d61  'MASK_KJY'] & ma
-00002270: 736b 5f6b 6a79 5f74 7672 292e 6173 7479  sk_kjy_tvr).asty
-00002280: 7065 286e 702e 696e 7433 3229 0a20 2020  pe(np.int32).   
-00002290: 2069 6620 7665 7262 6f73 653a 2070 7269   if verbose: pri
-000022a0: 6e74 2866 225b 2b5d 2064 665f 6d61 736b  nt(f"[+] df_mask
-000022b0: 5b27 4d41 534b 5f4b 4a59 275d 2e73 756d  ['MASK_KJY'].sum
-000022c0: 2829 203d 207b 6466 5f6d 6173 6b5b 274d  () = {df_mask['M
-000022d0: 4153 4b5f 4b4a 5927 5d2e 7375 6d28 297d  ASK_KJY'].sum()}
-000022e0: 2c20 6166 7465 7220 263d 206d 6173 6b5f  , after &= mask_
-000022f0: 6b6a 795f 7476 7222 290a 2020 2020 6466  kjy_tvr").    df
-00002300: 5f6d 6173 6b5b 274d 4153 4b5f 4b4a 5927  _mask['MASK_KJY'
-00002310: 5d20 3d20 2864 665f 6d61 736b 5b27 4d41  ] = (df_mask['MA
-00002320: 534b 5f4b 4a59 275d 2026 206d 6173 6b5f  SK_KJY'] & mask_
-00002330: 6b6a 795f 6964 292e 6173 7479 7065 286e  kjy_id).astype(n
-00002340: 702e 696e 7433 3229 0a20 2020 2069 6620  p.int32).    if 
-00002350: 7665 7262 6f73 653a 2070 7269 6e74 2866  verbose: print(f
-00002360: 225b 2b5d 2064 665f 6d61 736b 5b27 4d41  "[+] df_mask['MA
-00002370: 534b 5f4b 4a59 275d 2e73 756d 2829 203d  SK_KJY'].sum() =
-00002380: 207b 6466 5f6d 6173 6b5b 274d 4153 4b5f   {df_mask['MASK_
-00002390: 4b4a 5927 5d2e 7375 6d28 297d 2c20 6166  KJY'].sum()}, af
-000023a0: 7465 7220 263d 206d 6173 6b5f 6b6a 795f  ter &= mask_kjy_
-000023b0: 6964 2229 0a20 2020 200a 2020 2020 6d61  id").    .    ma
-000023c0: 736b 5f7a 6474 5f6e 616e 203d 2064 665f  sk_zdt_nan = df_
-000023d0: 6d61 736b 5b27 7063 745f 6368 6727 5d2e  mask['pct_chg'].
-000023e0: 6973 6e75 6c6c 2829 2023 2070 6374 5f63  isnull() # pct_c
-000023f0: 6867 2069 7320 6e61 6e2c 206e 6f74 2073  hg is nan, not s
-00002400: 6574 2066 6f72 207a 6474 0a20 2020 206d  et for zdt.    m
-00002410: 6173 6b5f 7a64 745f 3130 203d 2028 6964  ask_zdt_10 = (id
-00002420: 785f 7374 203d 3d20 3129 2026 2028 6466  x_st == 1) & (df
-00002430: 5f6d 6173 6b5b 2770 6374 5f63 6867 275d  _mask['pct_chg']
-00002440: 2e61 6273 2829 203c 3d20 392e 3530 290a  .abs() <= 9.50).
-00002450: 2020 2020 6d61 736b 5f7a 6474 5f73 7420      mask_zdt_st 
-00002460: 3d20 2869 6478 5f73 7420 3d3d 2030 2920  = (idx_st == 0) 
-00002470: 2620 2864 665f 6d61 736b 5b27 7063 745f  & (df_mask['pct_
-00002480: 6368 6727 5d2e 6162 7328 2920 3c3d 2034  chg'].abs() <= 4
-00002490: 2e37 3529 0a20 2020 2064 665f 6d61 736b  .75).    df_mask
-000024a0: 5b27 4d41 534b 5f5a 4454 275d 203d 2028  ['MASK_ZDT'] = (
-000024b0: 6d61 736b 5f7a 6474 5f31 3020 7c20 6d61  mask_zdt_10 | ma
-000024c0: 736b 5f7a 6474 5f73 7420 7c20 6d61 736b  sk_zdt_st | mask
-000024d0: 5f7a 6474 5f6e 616e 292e 6173 7479 7065  _zdt_nan).astype
-000024e0: 286e 702e 696e 7433 3229 0a20 2020 2064  (np.int32).    d
-000024f0: 665f 6d61 736b 5b27 4d41 534b 275d 203d  f_mask['MASK'] =
-00002500: 2064 665f 6d61 736b 5b27 4d41 534b 5f4b   df_mask['MASK_K
-00002510: 4a59 275d 2026 2064 665f 6d61 736b 5b27  JY'] & df_mask['
-00002520: 4d41 534b 5f5a 4454 275d 0a20 2020 2063  MASK_ZDT'].    c
-00002530: 6f6c 735f 6d61 736b 203d 205b 274d 4153  ols_mask = ['MAS
-00002540: 4b5f 5354 272c 2027 4d41 534b 5f4b 4a59  K_ST', 'MASK_KJY
-00002550: 272c 2027 4d41 534b 5f5a 4454 272c 2027  ', 'MASK_ZDT', '
-00002560: 4d41 534b 275d 0a20 2020 2064 622e 636c  MASK'].    db.cl
-00002570: 6f73 6528 290a 2020 2020 7265 7475 726e  ose().    return
-00002580: 2064 665f 6d61 736b 2c20 636f 6c73 5f6d   df_mask, cols_m
-00002590: 6173 6b0a 0a63 6c61 7373 2042 6173 6544  ask..class BaseD
-000025a0: 6174 6128 293a 0a20 2020 2064 6566 2067  ata():.    def g
-000025b0: 6574 5f64 6628 7365 6c66 2c20 7061 7468  et_df(self, path
-000025c0: 5f69 6e70 7574 2c20 6461 7465 5f62 6567  _input, date_beg
-000025d0: 696e 2c20 6461 7465 5f65 6e64 2c20 6e5f  in, date_end, n_
-000025e0: 6a6f 6273 293a 0a20 2020 2020 2020 2072  jobs):.        r
-000025f0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00002600: 7465 6445 7272 6f72 2827 796f 7520 6e65  tedError('you ne
-00002610: 6564 2074 6f20 696d 706c 656d 656e 7420  ed to implement 
-00002620: 6765 745f 6466 2829 2729 0a0a 2020 2020  get_df()')..    
-00002630: 6465 6620 6c6f 6164 2873 656c 662c 2064  def load(self, d
-00002640: 6174 615f 636f 6e66 6967 2c20 6466 203d  ata_config, df =
-00002650: 204e 6f6e 652c 2076 6572 626f 7365 203d   None, verbose =
-00002660: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
-00002670: 2320 696e 7075 740a 2020 2020 2020 2020  # input.        
-00002680: 7061 7468 5f69 6e70 7574 203d 2043 4f4e  path_input = CON
-00002690: 5354 2e50 4154 485f 4441 5441 0a20 2020  ST.PATH_DATA.   
-000026a0: 2020 2020 2064 6174 655f 6469 6374 203d       date_dict =
-000026b0: 2064 6174 615f 636f 6e66 6967 5b27 6461   data_config['da
-000026c0: 7465 5f64 6963 7427 5d0a 2020 2020 2020  te_dict'].      
-000026d0: 2020 6e5f 6a6f 6273 203d 2064 6174 615f    n_jobs = data_
-000026e0: 636f 6e66 6967 5b27 6e5f 6a6f 6273 275d  config['n_jobs']
-000026f0: 0a0a 2020 2020 2020 2020 636f 6c73 5f64  ..        cols_d
-00002700: 6963 7420 3d20 6461 7461 5f63 6f6e 6669  ict = data_confi
-00002710: 675b 2763 6f6c 735f 6469 6374 275d 0a20  g['cols_dict']. 
-00002720: 2020 2020 2020 206f 7468 6572 5f69 6e66         other_inf
-00002730: 6f20 3d20 6461 7461 5f63 6f6e 6669 675b  o = data_config[
-00002740: 276f 7468 6572 5f69 6e66 6f27 5d0a 0a20  'other_info'].. 
-00002750: 2020 2020 2020 2063 6f6c 5f69 6420 3d20         col_id = 
-00002760: 636f 6c73 5f64 6963 745b 2763 6f6c 5f69  cols_dict['col_i
-00002770: 6427 5d0a 2020 2020 2020 2020 636f 6c5f  d'].        col_
-00002780: 6c61 6265 6c20 3d20 636f 6c73 5f64 6963  label = cols_dic
-00002790: 745b 2763 6f6c 5f6c 6162 656c 275d 0a20  t['col_label']. 
-000027a0: 2020 2020 2020 2063 6f6c 735f 7469 6420         cols_tid 
-000027b0: 3d20 636f 6c73 5f64 6963 745b 2763 6f6c  = cols_dict['col
-000027c0: 735f 7469 6427 5d0a 2020 2020 2020 2020  s_tid'].        
-000027d0: 636f 6c5f 7469 6420 3d20 636f 6c73 5f64  col_tid = cols_d
-000027e0: 6963 745b 2763 6f6c 5f74 6964 275d 0a20  ict['col_tid']. 
-000027f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00002800: 2320 646d 0a20 2020 2020 2020 2069 6620  # dm.        if 
-00002810: 6466 2069 7320 4e6f 6e65 3a20 6466 203d  df is None: df =
-00002820: 2073 656c 662e 6765 745f 6466 2870 6174   self.get_df(pat
-00002830: 685f 696e 7075 742c 202a 6461 7465 5f64  h_input, *date_d
-00002840: 6963 745b 2761 6c6c 275d 2c20 6e5f 6a6f  ict['all'], n_jo
-00002850: 6273 2c20 7665 7262 6f73 6520 3d20 6f74  bs, verbose = ot
-00002860: 6865 725f 696e 666f 2e67 6574 2827 7665  her_info.get('ve
-00002870: 7262 6f73 6527 2c20 5472 7565 2929 2023  rbose', True)) #
-00002880: 206d 6173 6b5f 616c 6c0a 2020 2020 2020   mask_all.      
-00002890: 2020 6966 2027 4461 7461 4d61 7374 6572    if 'DataMaster
-000028a0: 2720 696e 2073 7472 2874 7970 6528 6466  ' in str(type(df
-000028b0: 2929 3a20 646d 203d 2064 660a 2020 2020  )): dm = df.    
-000028c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000028d0: 2020 2020 2020 6466 2e72 6573 6574 5f69        df.reset_i
-000028e0: 6e64 6578 2864 726f 7020 3d20 5472 7565  ndex(drop = True
-000028f0: 2c20 696e 706c 6163 6520 3d20 5472 7565  , inplace = True
-00002900: 2920 2320 544f 444f 2072 6573 6574 5f69  ) # TODO reset_i
-00002910: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-00002920: 2064 6d20 3d20 4461 7461 4d61 7374 6572   dm = DataMaster
-00002930: 2864 662c 2076 6572 626f 7365 203d 2046  (df, verbose = F
-00002940: 616c 7365 2c20 6b65 6570 5f73 7061 6365  alse, keep_space
-00002950: 203d 2054 7275 6529 0a20 2020 2020 2020   = True).       
-00002960: 2020 2020 2023 2064 6d2e 736f 7274 5f76       # dm.sort_v
-00002970: 616c 7565 7328 636f 6c73 5f74 6964 202b  alues(cols_tid +
-00002980: 205b 636f 6c5f 6964 5d29 2023 2073 6f72   [col_id]) # sor
-00002990: 742c 2054 4f44 4f0a 2020 2020 2020 2020  t, TODO.        
-000029a0: 646d 2e66 655f 676f 285b 636f 6c5f 7469  dm.fe_go([col_ti
-000029b0: 645d 2c20 7665 7262 6f73 6520 3d20 4661  d], verbose = Fa
-000029c0: 6c73 6529 0a20 2020 2020 2020 200a 2020  lse).        .  
-000029d0: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
-000029e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000029f0: 2d2d 2d2d 2d2d 206c 6162 656c 202d 2d2d  ------ label ---
-00002a00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d20 544f 444f  ----------- TODO
-00002a20: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-00002a30: 6f73 653a 2070 7269 6e74 2827 5b69 6e69  ose: print('[ini
-00002a40: 745d 203c 2d2d 2d2d 2d2d 2d2d 2d2d 206c  t] <---------- l
-00002a50: 6162 656c 202d 2d2d 2d2d 2d2d 2d2d 2d3e  abel ---------->
-00002a60: 2027 290a 2020 2020 2020 2020 636f 6c20   ').        col 
-00002a70: 3d20 6627 726f 6c6c 2873 6869 6674 2c20  = f'roll(shift, 
-00002a80: 7b63 6f6c 5f69 647d 2c20 636c 6f73 652c  {col_id}, close,
-00002a90: 2020 7b63 6f6c 5f74 6964 7d2c 2031 2927    {col_tid}, 1)'
-00002aa0: 0a20 2020 2020 2020 2064 6d2e 6665 5f67  .        dm.fe_g
-00002ab0: 6f28 5b66 2741 444a 203d 2064 6976 287b  o([f'ADJ = div({
-00002ac0: 636f 6c7d 2c20 7072 655f 636c 6f73 6529  col}, pre_close)
-00002ad0: 275d 2c20 7665 7262 6f73 6520 3d20 7665  '], verbose = ve
-00002ae0: 7262 6f73 6529 0a20 2020 2020 2020 2064  rbose).        d
-00002af0: 6d2e 6472 6f70 285b 636f 6c5d 2c20 7665  m.drop([col], ve
-00002b00: 7262 6f73 6520 3d20 4661 6c73 6529 0a20  rbose = False). 
-00002b10: 2020 2020 2020 2023 2062 6173 6963 2063         # basic c
-00002b20: 6f6c 756d 6e73 0a20 2020 2020 2020 206e  olumns.        n
-00002b30: 616d 655f 6c69 7374 203d 205b 0a20 2020  ame_list = [.   
-00002b40: 2020 2020 2020 2020 2066 2776 7761 7020           f'vwap 
-00002b50: 3d20 6469 7628 616d 6f75 6e74 2c20 766f  = div(amount, vo
-00002b60: 6c29 272c 0a20 2020 2020 2020 2020 2020  l)',.           
-00002b70: 2066 276d 6561 6e20 3d20 6d65 616e 5f6d   f'mean = mean_m
-00002b80: 286f 7065 6e2c 2068 6967 682c 206c 6f77  (open, high, low
-00002b90: 2c20 636c 6f73 6529 272c 0a20 2020 2020  , close)',.     
-00002ba0: 2020 205d 0a20 2020 2020 2020 2069 6620     ].        if 
-00002bb0: 2774 7761 7027 206e 6f74 2069 6e20 646d  'twap' not in dm
-00002bc0: 2e68 6561 6428 292e 636f 6c75 6d6e 733a  .head().columns:
-00002bd0: 206e 616d 655f 6c69 7374 202b 3d20 5b66   name_list += [f
-00002be0: 2774 7761 7020 3d20 6f28 7677 6170 2927  'twap = o(vwap)'
-00002bf0: 5d0a 2020 2020 2020 2020 646d 2e66 655f  ].        dm.fe_
-00002c00: 676f 286e 616d 655f 6c69 7374 2c20 7665  go(name_list, ve
-00002c10: 7262 6f73 6520 3d20 4661 6c73 6529 0a0a  rbose = False)..
-00002c20: 2020 2020 2020 2020 2320 7072 655f 7878          # pre_xx
-00002c30: 782c 2078 7878 5f72 6574 0a20 2020 2020  x, xxx_ret.     
-00002c40: 2020 206e 616d 655f 6c69 7374 203d 205b     name_list = [
-00002c50: 5d0a 2020 2020 2020 2020 666f 7220 636f  ].        for co
-00002c60: 6c20 696e 205b 2774 7761 7027 2c20 2776  l in ['twap', 'v
-00002c70: 7761 7027 2c20 276f 7065 6e27 2c20 2763  wap', 'open', 'c
-00002c80: 6c6f 7365 275d 202b 205b 276d 6561 6e27  lose'] + ['mean'
-00002c90: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-00002ca0: 6620 2770 7265 5f7b 636f 6c7d 2720 6e6f  f 'pre_{col}' no
-00002cb0: 7420 696e 2064 6d2e 6865 6164 2829 2e63  t in dm.head().c
-00002cc0: 6f6c 756d 6e73 3a0a 2020 2020 2020 2020  olumns:.        
-00002cd0: 2020 2020 2020 2020 6e61 6d65 5f6c 6973          name_lis
-00002ce0: 7420 2b3d 205b 6627 7072 655f 7b63 6f6c  t += [f'pre_{col
-00002cf0: 7d20 3d20 726f 6c6c 2873 6869 6674 2c20  } = roll(shift, 
-00002d00: 7b63 6f6c 5f69 647d 2c20 7b63 6f6c 7d2c  {col_id}, {col},
-00002d10: 207b 636f 6c5f 7469 647d 2c20 3129 275d   {col_tid}, 1)']
-00002d20: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00002d30: 655f 6c69 7374 202b 3d20 5b66 277b 636f  e_list += [f'{co
-00002d40: 6c7d 5f72 6574 203d 2072 6574 2870 7265  l}_ret = ret(pre
-00002d50: 5f7b 636f 6c7d 2c20 7b63 6f6c 7d29 275d  _{col}, {col})']
-00002d60: 0a20 2020 2020 2020 2064 6d2e 6665 5f67  .        dm.fe_g
-00002d70: 6f28 6e61 6d65 5f6c 6973 742c 2076 6572  o(name_list, ver
-00002d80: 626f 7365 203d 2046 616c 7365 2920 2020  bose = False)   
-00002d90: 2020 2020 200a 0a20 2020 2020 2020 2023       ..        #
-00002da0: 2064 665f 6c61 6265 6c5f 6669 6e61 6c0a   df_label_final.
-00002db0: 2020 2020 2020 2020 6c61 6265 6c5f 6672          label_fr
-00002dc0: 6f6d 5f73 7472 203d 206f 7468 6572 5f69  om_str = other_i
-00002dd0: 6e66 6f2e 6765 7428 276c 6162 656c 5f66  nfo.get('label_f
-00002de0: 726f 6d5f 7374 7227 2c20 2727 290a 2020  rom_str', '').  
-00002df0: 2020 2020 2020 6966 206c 656e 286c 6162        if len(lab
-00002e00: 656c 5f66 726f 6d5f 7374 7229 203e 2030  el_from_str) > 0
-00002e10: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00002e20: 6c5f 6c61 6265 6c5f 6672 6f6d 203d 2027  l_label_from = '
-00002e30: 4c41 4245 4c5f 4652 4f4d 5f53 5452 270a  LABEL_FROM_STR'.
-00002e40: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
-00002e50: 6c61 6265 6c5f 6172 6773 5f6c 6973 7420  label_args_list 
-00002e60: 3d20 6c61 6265 6c5f 6672 6f6d 5f73 7472  = label_from_str
-00002e70: 2e73 706c 6974 2827 5f5f 2729 5b31 3a5d  .split('__')[1:]
-00002e80: 0a20 2020 2020 2020 2020 2020 2070 6164  .            pad
-00002e90: 6469 6e67 203d 206e 702e 6d61 7828 5b6e  ding = np.max([n
-00002ea0: 702e 6d61 7828 6465 636f 6465 5f6c 6162  p.max(decode_lab
-00002eb0: 656c 5f61 7267 7328 7829 5b31 3a33 5d29  el_args(x)[1:3])
-00002ec0: 2066 6f72 2078 2069 6e20 636f 6c5f 6c61   for x in col_la
-00002ed0: 6265 6c5f 6172 6773 5f6c 6973 745d 290a  bel_args_list]).
-00002ee0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00002ef0: 2020 2020 2020 2020 2020 636f 6c5f 6c61            col_la
-00002f00: 6265 6c5f 6672 6f6d 203d 2063 6f6c 5f6c  bel_from = col_l
-00002f10: 6162 656c 5f61 7267 735f 325f 6e61 6d65  abel_args_2_name
-00002f20: 286f 7468 6572 5f69 6e66 6f5b 2763 6f6c  (other_info['col
-00002f30: 5f6c 6162 656c 5f61 7267 7327 5d29 0a20  _label_args']). 
-00002f40: 2020 2020 2020 2020 2020 2063 6f6c 5f6c             col_l
-00002f50: 6162 656c 5f61 7267 735f 6c69 7374 203d  abel_args_list =
-00002f60: 205b 6f74 6865 725f 696e 666f 5b27 636f   [other_info['co
-00002f70: 6c5f 6c61 6265 6c5f 6172 6773 275d 5d0a  l_label_args']].
-00002f80: 2020 2020 2020 2020 2020 2020 7061 6464              padd
-00002f90: 696e 6720 3d20 6e70 2e6d 6178 285b 696e  ing = np.max([in
-00002fa0: 7428 7829 2066 6f72 2078 2069 6e20 636f  t(x) for x in co
-00002fb0: 6c5f 6c61 6265 6c5f 6672 6f6d 2e73 706c  l_label_from.spl
-00002fc0: 6974 2827 5f27 295b 323a 345d 5d29 2023  it('_')[2:4]]) #
-00002fd0: 2070 6164 6469 6e67 206b 2064 6179 730a   padding k days.
-00002fe0: 2020 2020 2020 2020 636f 6c5f 6c61 6265          col_labe
-00002ff0: 6c5f 6172 6773 5f6c 6973 7420 2b3d 206f  l_args_list += o
-00003000: 7468 6572 5f69 6e66 6f2e 6765 7428 2763  ther_info.get('c
-00003010: 6f6c 5f6c 6162 656c 5f61 7267 735f 6c69  ol_label_args_li
-00003020: 7374 272c 205b 5d29 0a20 2020 2020 2020  st', []).       
-00003030: 2063 6f6c 5f6c 6162 656c 5f61 7267 735f   col_label_args_
-00003040: 6c69 7374 203d 205b 6465 636f 6465 5f6c  list = [decode_l
-00003050: 6162 656c 5f61 7267 7328 7829 2066 6f72  abel_args(x) for
-00003060: 2078 2069 6e20 636f 6c5f 6c61 6265 6c5f   x in col_label_
-00003070: 6172 6773 5f6c 6973 745d 0a20 2020 2020  args_list].     
-00003080: 2020 2063 6f6c 5f6c 6162 656c 5f61 7267     col_label_arg
-00003090: 735f 6c69 7374 203d 206c 6973 7428 7064  s_list = list(pd
-000030a0: 2e53 6572 6965 7328 636f 6c5f 6c61 6265  .Series(col_labe
-000030b0: 6c5f 6172 6773 5f6c 6973 7429 2e64 726f  l_args_list).dro
-000030c0: 705f 6475 706c 6963 6174 6573 2829 290a  p_duplicates()).
-000030d0: 2020 2020 2020 2020 6f74 6865 725f 696e          other_in
-000030e0: 666f 5b27 636f 6c5f 6c61 6265 6c5f 6172  fo['col_label_ar
-000030f0: 6773 5f6c 6973 7427 5d20 3d20 636f 6c5f  gs_list'] = col_
-00003100: 6c61 6265 6c5f 6172 6773 5f6c 6973 740a  label_args_list.
-00003110: 2020 2020 2020 2020 6f74 6865 725f 696e          other_in
-00003120: 666f 5b27 636f 6c5f 6c61 6265 6c5f 6672  fo['col_label_fr
-00003130: 6f6d 275d 2020 3d20 636f 6c5f 6c61 6265  om']  = col_labe
-00003140: 6c5f 6672 6f6d 0a20 2020 2020 2020 200a  l_from.        .
-00003150: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00003160: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
-00003170: 6c61 6265 6c5f 6672 6f6d 5f73 7472 203d  label_from_str =
-00003180: 207b 6c61 6265 6c5f 6672 6f6d 5f73 7472   {label_from_str
-00003190: 7d2c 2063 6f6c 5f6c 6162 656c 5f66 726f  }, col_label_fro
-000031a0: 6d20 3d20 7b63 6f6c 5f6c 6162 656c 5f66  m = {col_label_f
-000031b0: 726f 6d7d 2729 0a20 2020 2020 2020 2069  rom}').        i
-000031c0: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
-000031d0: 2866 275b 2b5d 2063 6f6c 5f6c 6162 656c  (f'[+] col_label
-000031e0: 5f61 7267 735f 6c69 7374 203d 207b 636f  _args_list = {co
-000031f0: 6c5f 6c61 6265 6c5f 6172 6773 5f6c 6973  l_label_args_lis
-00003200: 747d 2729 0a0a 2020 2020 2020 2020 636f  t}')..        co
-00003210: 6c73 5f70 7269 6365 203d 205b 785b 305d  ls_price = [x[0]
-00003220: 2066 6f72 2078 2069 6e20 636f 6c5f 6c61   for x in col_la
-00003230: 6265 6c5f 6172 6773 5f6c 6973 745d 202b  bel_args_list] +
-00003240: 205b 785b 2d31 5d20 666f 7220 7820 696e   [x[-1] for x in
-00003250: 2063 6f6c 5f6c 6162 656c 5f61 7267 735f   col_label_args_
-00003260: 6c69 7374 2069 6620 7479 7065 2878 5b2d  list if type(x[-
-00003270: 315d 2920 6973 2073 7472 5d0a 2020 2020  1]) is str].    
-00003280: 2020 2020 636f 6c73 5f70 7269 6365 203d      cols_price =
-00003290: 206c 6973 7428 7064 2e53 6572 6965 7328   list(pd.Series(
-000032a0: 636f 6c73 5f70 7269 6365 292e 6472 6f70  cols_price).drop
-000032b0: 5f64 7570 6c69 6361 7465 7328 2929 0a20  _duplicates()). 
-000032c0: 2020 2020 2020 2064 6620 3d20 646d 2e67         df = dm.g
-000032d0: 6574 5f63 6f6c 735f 7061 6e64 6173 285b  et_cols_pandas([
-000032e0: 636f 6c5f 7469 642c 2063 6f6c 5f69 645d  col_tid, col_id]
-000032f0: 202b 2063 6f6c 735f 7072 6963 6520 2b20   + cols_price + 
-00003300: 5b27 4144 4a27 5d29 0a20 2020 2020 2020  ['ADJ']).       
-00003310: 2064 665f 6c61 6265 6c5f 6669 6e61 6c2c   df_label_final,
-00003320: 2063 6f6c 735f 6c61 6265 6c20 3d20 6765   cols_label = ge
-00003330: 745f 6466 5f6c 6162 656c 5f66 696e 616c  t_df_label_final
-00003340: 2864 662c 2063 6f6c 5f74 6964 2c20 636f  (df, col_tid, co
-00003350: 6c5f 6964 2c20 636f 6c73 5f70 7269 6365  l_id, cols_price
-00003360: 2c20 636f 6c5f 6c61 6265 6c5f 6172 6773  , col_label_args
-00003370: 5f6c 6973 742c 206c 6162 656c 5f66 726f  _list, label_fro
-00003380: 6d5f 7374 722c 2076 6572 626f 7365 203d  m_str, verbose =
-00003390: 206f 7468 6572 5f69 6e66 6f2e 6765 7428   other_info.get(
-000033a0: 2776 6572 626f 7365 272c 2054 7275 6529  'verbose', True)
-000033b0: 290a 2020 2020 2020 2020 666f 7220 636f  ).        for co
-000033c0: 6c20 696e 2063 6f6c 735f 6c61 6265 6c3a  l in cols_label:
-000033d0: 2064 6d2e 7365 745f 6279 5f63 6f6c 2863   dm.set_by_col(c
-000033e0: 6f6c 2c20 6466 5f6c 6162 656c 5f66 696e  ol, df_label_fin
-000033f0: 616c 5b63 6f6c 5d29 0a20 2020 2020 2020  al[col]).       
-00003400: 2063 6f6c 735f 6c61 6265 6c20 2b3d 205b   cols_label += [
-00003410: 274c 4142 454c 5f52 4157 275d 0a20 2020  'LABEL_RAW'].   
-00003420: 2020 2020 2069 6620 276c 6162 656c 2720       if 'label' 
-00003430: 696e 2064 6d2e 6865 6164 2829 2e63 6f6c  in dm.head().col
-00003440: 756d 6e73 3a20 636f 6c73 5f6c 6162 656c  umns: cols_label
-00003450: 202b 3d20 5b27 6c61 6265 6c27 5d0a 2020   += ['label'].  
-00003460: 2020 2020 2020 6461 7461 5f63 6f6e 6669        data_confi
-00003470: 675b 2763 6f6c 735f 6469 6374 275d 5b27  g['cols_dict']['
-00003480: 636f 6c73 5f6c 6162 656c 275d 203d 2063  cols_label'] = c
-00003490: 6f6c 735f 6c61 6265 6c0a 2020 2020 2020  ols_label.      
-000034a0: 2020 6966 2076 6572 626f 7365 3a20 7072    if verbose: pr
-000034b0: 696e 7428 6627 5b2b 5d20 636f 6c73 5f6c  int(f'[+] cols_l
-000034c0: 6162 656c 203d 207b 636f 6c73 5f6c 6162  abel = {cols_lab
-000034d0: 656c 7d27 290a 0a20 2020 2020 2020 2023  el}')..        #
-000034e0: 2066 5f6c 6162 656c 5f70 7265 0a20 2020   f_label_pre.   
-000034f0: 2020 2020 2066 5f6c 6162 656c 5f70 7265       f_label_pre
-00003500: 203d 206f 7468 6572 5f69 6e66 6f2e 6765   = other_info.ge
-00003510: 7428 2766 5f6c 6162 656c 5f70 7265 272c  t('f_label_pre',
-00003520: 204e 6f6e 6529 0a20 2020 2020 2020 2069   None).        i
-00003530: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
-00003540: 2866 275b 2b5d 2066 5f6c 6162 656c 5f70  (f'[+] f_label_p
-00003550: 7265 203d 207b 665f 6c61 6265 6c5f 7072  re = {f_label_pr
-00003560: 657d 2c20 636f 6c5f 6c61 6265 6c5f 6672  e}, col_label_fr
-00003570: 6f6d 203d 207b 636f 6c5f 6c61 6265 6c5f  om = {col_label_
-00003580: 6672 6f6d 7d27 290a 2020 2020 2020 2020  from}').        
-00003590: 6966 2066 5f6c 6162 656c 5f70 7265 203d  if f_label_pre =
-000035a0: 3d20 2763 737a 7363 6f72 6527 3a20 2320  = 'cszscore': # 
-000035b0: 665f 6c61 6265 6c5f 7072 650a 2020 2020  f_label_pre.    
-000035c0: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
-000035d0: 285b 6627 4c41 4245 4c5f 5241 5720 3d20  ([f'LABEL_RAW = 
-000035e0: 6f28 7b63 6f6c 5f6c 6162 656c 5f66 726f  o({col_label_fro
-000035f0: 6d7d 2927 5d2c 2076 6572 626f 7365 203d  m})'], verbose =
-00003600: 2076 6572 626f 7365 290a 2020 2020 2020   verbose).      
-00003610: 2020 2020 2020 646d 2e66 655f 676f 285b        dm.fe_go([
-00003620: 6627 7b63 6f6c 5f6c 6162 656c 7d20 3d20  f'{col_label} = 
-00003630: 6167 6728 7a73 636f 7265 2c20 7b63 6f6c  agg(zscore, {col
-00003640: 5f74 6964 7d2c 207b 636f 6c5f 6c61 6265  _tid}, {col_labe
-00003650: 6c5f 6672 6f6d 7d29 275d 2c20 7665 7262  l_from})'], verb
-00003660: 6f73 6520 3d20 7665 7262 6f73 6529 2023  ose = verbose) #
-00003670: 2054 4f44 4f3f 206d 6173 6b20 3f20 0a20   TODO? mask ? . 
-00003680: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00003690: 2020 2020 2020 2020 2320 7a73 636f 7265          # zscore
-000036a0: 2066 6f72 2061 6c6c 204c 4142 454c 0a20   for all LABEL. 
-000036b0: 2020 2020 2020 2020 2020 206e 616d 655f             name_
-000036c0: 6c69 7374 203d 205b 6627 6167 6728 7a73  list = [f'agg(zs
-000036d0: 636f 7265 2c20 7b63 6f6c 5f74 6964 7d2c  core, {col_tid},
-000036e0: 207b 636f 6c7d 2927 2066 6f72 2063 6f6c   {col})' for col
-000036f0: 2069 6e20 636f 6c73 5f6c 6162 656c 2069   in cols_label i
-00003700: 6620 636f 6c20 6e6f 7420 696e 205b 274c  f col not in ['L
-00003710: 4142 454c 5f52 4157 275d 5d0a 2020 2020  ABEL_RAW']].    
-00003720: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
-00003730: 286e 616d 655f 6c69 7374 2c20 7665 7262  (name_list, verb
-00003740: 6f73 6520 3d20 7665 7262 6f73 652c 206b  ose = verbose, k
-00003750: 6565 705f 6e61 6d65 203d 2032 290a 2020  eep_name = 2).  
-00003760: 2020 2020 2020 656c 6966 2066 5f6c 6162        elif f_lab
-00003770: 656c 5f70 7265 203d 3d20 276f 7269 6769  el_pre == 'origi
-00003780: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-00003790: 646d 2e66 655f 676f 285b 6627 4c41 4245  dm.fe_go([f'LABE
-000037a0: 4c5f 5241 5720 3d20 6f28 7b63 6f6c 5f6c  L_RAW = o({col_l
-000037b0: 6162 656c 5f66 726f 6d7d 2927 5d2c 2076  abel_from})'], v
-000037c0: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
-000037d0: 290a 2020 2020 2020 2020 2020 2020 646d  ).            dm
-000037e0: 2e66 655f 676f 285b 6627 7b63 6f6c 5f6c  .fe_go([f'{col_l
-000037f0: 6162 656c 7d20 3d20 6f28 7b63 6f6c 5f6c  abel} = o({col_l
-00003800: 6162 656c 5f66 726f 6d7d 2927 5d2c 2076  abel_from})'], v
-00003810: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
-00003820: 290a 2020 2020 2020 2020 656c 6966 2066  ).        elif f
-00003830: 5f6c 6162 656c 5f70 7265 203d 3d20 2765  _label_pre == 'e
-00003840: 7869 7374 273a 0a20 2020 2020 2020 2020  xist':.         
-00003850: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
-00003860: 7269 6e74 2866 275b 2b5d 2072 6177 206c  rint(f'[+] raw l
-00003870: 6162 656c 2066 726f 6d20 646d 2c20 2877  abel from dm, (w
-00003880: 6869 6368 206d 6561 6e20 6578 6973 7420  hich mean exist 
-00003890: 7468 6973 2063 6f6c 756d 6e2c 206c 6162  this column, lab
-000038a0: 656c 2927 290a 2020 2020 2020 2020 2020  el)').          
-000038b0: 2020 646d 2e66 655f 676f 285b 6627 4c41    dm.fe_go([f'LA
-000038c0: 4245 4c5f 5241 5720 3d20 6f28 7b63 6f6c  BEL_RAW = o({col
-000038d0: 5f6c 6162 656c 7d29 275d 2c20 7665 7262  _label})'], verb
-000038e0: 6f73 6520 3d20 7665 7262 6f73 6529 0a20  ose = verbose). 
-000038f0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00003900: 7420 636f 6c5f 6c61 6265 6c20 696e 2064  t col_label in d
-00003910: 6d2e 6865 6164 2829 2e63 6f6c 756d 6e73  m.head().columns
-00003920: 2c20 2763 6f6c 5f6c 6162 656c 203d 207b  , 'col_label = {
-00003930: 636f 6c5f 6c61 6265 6c7d 206e 6f74 2069  col_label} not i
-00003940: 6e20 646d 2127 0a20 2020 2020 2020 2065  n dm!'.        e
-00003950: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00003960: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00003970: 656e 7465 6445 7272 6f72 2866 275b 2b5d  entedError(f'[+]
-00003980: 2066 5f6c 6162 656c 5f70 7265 203d 207b   f_label_pre = {
-00003990: 665f 6c61 6265 6c5f 7072 657d 2729 0a20  f_label_pre}'). 
-000039a0: 2020 2020 2020 2023 2064 6d2e 7365 745f         # dm.set_
-000039b0: 6279 5f63 6f6c 2863 6f6c 5f6c 6162 656c  by_col(col_label
-000039c0: 2c20 6e70 2e63 6c69 7028 646d 2e67 6574  , np.clip(dm.get
-000039d0: 5f63 6f6c 5f6e 756d 7079 2863 6f6c 5f6c  _col_numpy(col_l
-000039e0: 6162 656c 292c 202d 3130 2c20 3130 2929  abel), -10, 10))
-000039f0: 2023 2054 4f44 4f20 636c 6970 0a0a 2020   # TODO clip..  
-00003a00: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
-00003a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003a20: 2d2d 2d2d 2d2d 206d 6173 6b20 2d2d 2d2d  ------ mask ----
-00003a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2054 4f44 4f0a  ---------- TODO.
-00003a50: 2020 2020 2020 2020 2320 6466 5f6d 6173          # df_mas
-00003a60: 6b0a 2020 2020 2020 2020 6966 2076 6572  k.        if ver
-00003a70: 626f 7365 3a20 7072 696e 7428 275b 696e  bose: print('[in
-00003a80: 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d 2d20  it] <---------- 
-00003a90: 6d61 736b 2020 2d2d 2d2d 2d2d 2d2d 2d2d  mask  ----------
-00003aa0: 3e20 2729 0a20 2020 2020 2020 2070 6174  > ').        pat
-00003ab0: 685f 6462 203d 2066 277b 6f73 2e70 6174  h_db = f'{os.pat
-00003ac0: 682e 6469 726e 616d 6528 6f73 2e70 6174  h.dirname(os.pat
-00003ad0: 682e 6162 7370 6174 6828 7061 7468 5f69  h.abspath(path_i
-00003ae0: 6e70 7574 2929 7d2f 727a 2e64 6227 0a20  nput))}/rz.db'. 
-00003af0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00003b00: 653a 2070 7269 6e74 2866 275b 2b5d 2070  e: print(f'[+] p
-00003b10: 6174 685f 6462 203d 207b 7061 7468 5f64  ath_db = {path_d
-00003b20: 627d 2729 0a20 2020 2020 2020 2069 6620  b}').        if 
-00003b30: 6f73 2e70 6174 682e 6578 6973 7473 2870  os.path.exists(p
-00003b40: 6174 685f 6462 293a 0a20 2020 2020 2020  ath_db):.       
-00003b50: 2020 2020 2064 665f 6d61 736b 2c20 636f       df_mask, co
-00003b60: 6c73 5f6d 6173 6b20 3d20 6765 745f 6466  ls_mask = get_df
-00003b70: 5f6d 6173 6b28 7061 7468 5f64 622c 2064  _mask(path_db, d
-00003b80: 6d2c 2063 6f6c 5f74 6964 2c20 636f 6c5f  m, col_tid, col_
-00003b90: 6964 2c20 7665 7262 6f73 653d 7665 7262  id, verbose=verb
-00003ba0: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
-00003bb0: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
-00003bc0: 5f6d 6173 6b3a 2064 6d2e 7365 745f 6279  _mask: dm.set_by
-00003bd0: 5f63 6f6c 2863 6f6c 2c20 6466 5f6d 6173  _col(col, df_mas
-00003be0: 6b5b 636f 6c5d 290a 2020 2020 2020 2020  k[col]).        
-00003bf0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00003c00: 2020 636f 6c73 5f6d 6173 6b20 3d20 636f    cols_mask = co
-00003c10: 6c73 5f6d 6173 6b20 3d20 5b27 4d41 534b  ls_mask = ['MASK
-00003c20: 5f53 5427 2c20 274d 4153 4b5f 4b4a 5927  _ST', 'MASK_KJY'
-00003c30: 2c20 274d 4153 4b5f 5a44 5427 2c20 274d  , 'MASK_ZDT', 'M
-00003c40: 4153 4b27 5d0a 2020 2020 2020 2020 6461  ASK'].        da
-00003c50: 7461 5f63 6f6e 6669 675b 2763 6f6c 735f  ta_config['cols_
-00003c60: 6469 6374 275d 5b27 636f 6c73 5f6d 6173  dict']['cols_mas
-00003c70: 6b27 5d20 3d20 636f 6c73 5f6d 6173 6b0a  k'] = cols_mask.
-00003c80: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00003c90: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
-00003ca0: 636f 6c73 5f6d 6173 6b20 3d20 7b63 6f6c  cols_mask = {col
-00003cb0: 735f 6d61 736b 7d27 290a 0a20 2020 2020  s_mask}')..     
-00003cc0: 2020 2023 206b 6a79 2026 207a 6474 0a20     # kjy & zdt. 
-00003cd0: 2020 2020 2020 2065 7869 7374 5f6d 6173         exist_mas
-00003ce0: 6b20 3d20 2827 4d41 534b 5f4b 4a59 2720  k = ('MASK_KJY' 
-00003cf0: 696e 2064 6d2e 6865 6164 2829 2e63 6f6c  in dm.head().col
-00003d00: 756d 6e73 2920 616e 6420 2827 4d41 534b  umns) and ('MASK
-00003d10: 5f5a 4454 2720 696e 2064 6d2e 6865 6164  _ZDT' in dm.head
-00003d20: 2829 2e63 6f6c 756d 6e73 290a 2020 2020  ().columns).    
-00003d30: 2020 2020 6966 2065 7869 7374 5f6d 6173      if exist_mas
-00003d40: 6b20 6f72 206f 732e 7061 7468 2e65 7869  k or os.path.exi
-00003d50: 7374 7328 7061 7468 5f64 6229 3a0a 2020  sts(path_db):.  
-00003d60: 2020 2020 2020 2020 2020 2320 6d61 736b            # mask
-00003d70: 203d 2031 e79a 842c 206c 6162 656c 2e69   = 1..., label.i
-00003d80: 736e 756c 6c28 29e7 9a84 2c20 e4b8 bbe8  snull()..., ....
-00003d90: a681 e698 afe5 9ba0 e4b8 bae5 9084 e7a7  ................
-00003da0: 8de5 819c e789 8ce7 9a84 e683 85e5 86b5  ................
-00003db0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00003dc0: 6b5f 6b6a 7920 3d20 287e 6e70 2e69 736e  k_kjy = (~np.isn
-00003dd0: 616e 2864 6d2e 6466 5f64 6963 745b 2754  an(dm.df_dict['T
-00003de0: 3027 5d5b 636f 6c5f 6c61 6265 6c5d 2e74  0'][col_label].t
-00003df0: 6f5f 6e75 6d70 7928 2929 292e 6173 7479  o_numpy())).asty
-00003e00: 7065 286e 702e 696e 7433 3229 2023 20e4  pe(np.int32) # .
-00003e10: bc9a e5af bce8 87b4 e4b8 8de5 908c 6c61  ..............la
-00003e20: 6265 6ce4 b88d e4b8 80e6 a0b7 2c20 e9bb  bel........., ..
-00003e30: 98e8 aea4 6c61 6265 6ce9 83bd e794 a878  ....label......x
-00003e40: 7878 2c30 2c31 e590 a70a 2020 2020 2020  xx,0,1....      
-00003e50: 2020 2020 2020 6d61 736b 5f6b 6a79 2026        mask_kjy &
-00003e60: 3d20 646d 2e64 665f 6469 6374 5b27 5430  = dm.df_dict['T0
-00003e70: 275d 5b27 4d41 534b 5f4b 4a59 275d 2e74  ']['MASK_KJY'].t
-00003e80: 6f5f 6e75 6d70 7928 290a 2020 2020 2020  o_numpy().      
-00003e90: 2020 2020 2020 2320 6d61 736b 5f6b 6a79        # mask_kjy
-00003ea0: 203d 2064 6d2e 6466 5f64 6963 745b 2754   = dm.df_dict['T
-00003eb0: 3027 5d5b 274d 4153 4b5f 4b4a 5927 5d2e  0']['MASK_KJY'].
-00003ec0: 746f 5f6e 756d 7079 2829 0a20 2020 2020  to_numpy().     
-00003ed0: 2020 2020 2020 206d 6173 6b5f 7a64 7420         mask_zdt 
-00003ee0: 3d20 646d 2e64 665f 6469 6374 5b27 5430  = dm.df_dict['T0
-00003ef0: 275d 5b27 4d41 534b 5f5a 4454 275d 2e74  ']['MASK_ZDT'].t
-00003f00: 6f5f 6e75 6d70 7928 290a 2020 2020 2020  o_numpy().      
-00003f10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00003f20: 2020 2020 6d61 736b 5f6b 6a79 203d 2028      mask_kjy = (
-00003f30: 7e6e 702e 6973 6e61 6e28 646d 2e64 665f  ~np.isnan(dm.df_
-00003f40: 6469 6374 5b27 5430 275d 5b63 6f6c 5f6c  dict['T0'][col_l
-00003f50: 6162 656c 5d2e 746f 5f6e 756d 7079 2829  abel].to_numpy()
-00003f60: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
-00003f70: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
-00003f80: 6d61 736b 5f6b 6a79 2026 3d20 287e 6e70  mask_kjy &= (~np
-00003f90: 2e69 736e 616e 2864 6d2e 6466 5f64 6963  .isnan(dm.df_dic
-00003fa0: 745b 2754 3027 5d5b 276f 7065 6e27 5d2e  t['T0']['open'].
-00003fb0: 746f 5f6e 756d 7079 2829 2929 2e61 7374  to_numpy())).ast
-00003fc0: 7970 6528 6e70 2e69 6e74 3332 290a 2020  ype(np.int32).  
-00003fd0: 2020 2020 2020 2020 2020 2320 6d61 736b            # mask
-00003fe0: 5f6b 6a79 203d 2028 7e6e 702e 6973 6e61  _kjy = (~np.isna
-00003ff0: 6e28 646d 2e64 665f 6469 6374 5b27 5430  n(dm.df_dict['T0
-00004000: 275d 5b27 6f70 656e 275d 2e74 6f5f 6e75  ']['open'].to_nu
-00004010: 6d70 7928 2929 292e 6173 7479 7065 286e  mpy())).astype(n
-00004020: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
-00004030: 2020 2020 206d 6173 6b5f 7a64 7420 3d20       mask_zdt = 
-00004040: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
-00004050: 2827 6d61 736b 2729 203d 3d20 310a 2020  ('mask') == 1.  
-00004060: 2020 2020 2020 646d 2e73 6574 5f6d 6173        dm.set_mas
-00004070: 6b28 6d61 736b 5f6b 6a79 2e61 7374 7970  k(mask_kjy.astyp
-00004080: 6528 6e70 2e69 6e74 3332 292c 2027 6b6a  e(np.int32), 'kj
-00004090: 7927 290a 2020 2020 2020 2020 646d 2e73  y').        dm.s
-000040a0: 6574 5f6d 6173 6b28 6d61 736b 5f7a 6474  et_mask(mask_zdt
-000040b0: 2e61 7374 7970 6528 6e70 2e69 6e74 3332  .astype(np.int32
-000040c0: 292c 2027 7a64 7427 290a 0a20 2020 2020  ), 'zdt')..     
-000040d0: 2020 2023 206d 6173 6b5f 6472 6f70 0a20     # mask_drop. 
-000040e0: 2020 2020 2020 2069 6620 4661 6c73 6520         if False 
-000040f0: 616e 6420 6f73 2e70 6174 682e 6578 6973  and os.path.exis
-00004100: 7473 2870 6174 685f 6462 293a 0a20 2020  ts(path_db):.   
-00004110: 2020 2020 2020 2020 2064 6d2e 6665 5f67           dm.fe_g
-00004120: 6f28 5b66 2767 7028 6d65 616e 2c20 7b63  o([f'gp(mean, {c
-00004130: 6f6c 5f74 6964 7d2c 204c 4142 454c 5f52  ol_tid}, LABEL_R
-00004140: 4157 2927 5d29 0a20 2020 2020 2020 2020  AW)']).         
-00004150: 2020 2064 665f 6770 203d 2064 6d2e 6765     df_gp = dm.ge
-00004160: 745f 636f 6c73 5f70 616e 6461 7328 6466  t_cols_pandas(df
-00004170: 5f6e 616d 6520 3d20 6627 5430 2e7b 636f  _name = f'T0.{co
-00004180: 6c5f 7469 647d 2729 0a20 2020 2020 2020  l_tid}').       
-00004190: 2020 2020 2064 6174 655f 6472 6f70 203d       date_drop =
-000041a0: 2064 665f 6770 5b64 665f 6770 5b66 2767   df_gp[df_gp[f'g
-000041b0: 7028 6d65 616e 2c20 7b63 6f6c 5f74 6964  p(mean, {col_tid
-000041c0: 7d2c 204c 4142 454c 5f52 4157 2927 5d2e  }, LABEL_RAW)'].
-000041d0: 6162 7328 2920 3e20 302e 3033 5d5b 636f  abs() > 0.03][co
-000041e0: 6c5f 7469 645d 2e76 616c 7565 730a 2020  l_tid].values.  
-000041f0: 2020 2020 2020 2020 2020 6461 7465 5f64            date_d
-00004200: 726f 7020 3d20 6461 7465 5f64 726f 705b  rop = date_drop[
-00004210: 6461 7465 5f64 726f 7020 3c3d 2064 6174  date_drop <= dat
-00004220: 655f 6469 6374 5b27 616c 6c27 5d5b 315d  e_dict['all'][1]
-00004230: 5d0a 2020 2020 2020 2020 2020 2020 7072  ].            pr
-00004240: 696e 7428 6627 5b2b 5d20 6461 7465 5f64  int(f'[+] date_d
-00004250: 726f 7020 3d20 7b6c 656e 2864 6174 655f  rop = {len(date_
-00004260: 6472 6f70 297d 5c6e 6461 7465 5f64 726f  drop)}\ndate_dro
-00004270: 7020 3d20 5b7b 222c 2022 2e6a 6f69 6e28  p = [{", ".join(
-00004280: 7374 7228 7829 2066 6f72 2078 2069 6e20  str(x) for x in 
-00004290: 6461 7465 5f64 726f 7029 7d5d 2729 0a20  date_drop)}]'). 
-000042a0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-000042b0: 6472 6f70 203d 2028 7e64 6d2e 6765 745f  drop = (~dm.get_
-000042c0: 636f 6c5f 7061 6e64 6173 2863 6f6c 5f74  col_pandas(col_t
-000042d0: 6964 292e 6973 696e 2873 6574 2864 6174  id).isin(set(dat
-000042e0: 655f 6472 6f70 2929 292e 7661 6c75 6573  e_drop))).values
-000042f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00004300: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-00004310: 6472 6f70 203d 206e 702e 6f6e 6573 5f6c  drop = np.ones_l
-00004320: 696b 6528 6d61 736b 5f6b 6a79 292e 6173  ike(mask_kjy).as
-00004330: 7479 7065 2862 6f6f 6c29 0a20 2020 2020  type(bool).     
-00004340: 2020 2023 206d 6173 6b0a 2020 2020 2020     # mask.      
-00004350: 2020 6d61 736b 5f6d 6173 6b20 3d20 6d61    mask_mask = ma
-00004360: 736b 5f6b 6a79 2026 206d 6173 6b5f 7a64  sk_kjy & mask_zd
-00004370: 740a 2020 2020 2020 2020 6d61 736b 5f6d  t.        mask_m
-00004380: 6173 6b20 263d 206d 6173 6b5f 6472 6f70  ask &= mask_drop
-00004390: 0a20 2020 2020 2020 2064 6d2e 7365 745f  .        dm.set_
-000043a0: 6d61 736b 286d 6173 6b5f 6d61 736b 2c20  mask(mask_mask, 
-000043b0: 276d 6173 6b27 290a 2020 2020 2020 2020  'mask').        
-000043c0: 646d 2e73 6574 5f62 795f 636f 6c28 274d  dm.set_by_col('M
-000043d0: 4153 4b27 2c20 6d61 736b 5f6d 6173 6b29  ASK', mask_mask)
-000043e0: 2023 2075 7064 6174 6520 6d61 736b 0a20   # update mask. 
-000043f0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00004400: 653a 200a 2020 2020 2020 2020 2020 2020  e: .            
-00004410: 7072 696e 7428 6627 5b2b 5d20 6b6a 7920  print(f'[+] kjy 
-00004420: 203d 207b 6d61 736b 5f6b 6a79 2e73 756d   = {mask_kjy.sum
-00004430: 2829 7d20 2f20 7b6c 656e 286d 6173 6b5f  ()} / {len(mask_
-00004440: 6b6a 7929 7d20 3d20 7b6d 6173 6b5f 6b6a  kjy)} = {mask_kj
-00004450: 792e 6d65 616e 2829 7d27 290a 2020 2020  y.mean()}').    
-00004460: 2020 2020 2020 2020 7072 696e 7428 6627          print(f'
-00004470: 5b2b 5d20 7a64 7420 203d 207b 6d61 736b  [+] zdt  = {mask
-00004480: 5f7a 6474 2e73 756d 2829 7d20 2f20 7b6c  _zdt.sum()} / {l
-00004490: 656e 286d 6173 6b5f 7a64 7429 7d20 3d20  en(mask_zdt)} = 
-000044a0: 7b6d 6173 6b5f 7a64 742e 6d65 616e 2829  {mask_zdt.mean()
-000044b0: 7d27 290a 2020 2020 2020 2020 2020 2020  }').            
-000044c0: 7072 696e 7428 6627 5b2b 5d20 6d61 736b  print(f'[+] mask
-000044d0: 203d 207b 6d61 736b 5f6d 6173 6b2e 7375   = {mask_mask.su
-000044e0: 6d28 297d 202f 207b 6c65 6e28 6d61 736b  m()} / {len(mask
-000044f0: 5f6d 6173 6b29 7d20 3d20 7b6d 6173 6b5f  _mask)} = {mask_
-00004500: 6d61 736b 2e6d 6561 6e28 297d 2729 0a20  mask.mean()}'). 
-00004510: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00004520: 2320 666f 7220 7472 6169 6e20 7661 6c69  # for train vali
-00004530: 6420 2074 6573 740a 2020 2020 2020 2020  d  test.        
-00004540: 6966 2027 6869 7374 2720 6e6f 7420 696e  if 'hist' not in
-00004550: 2064 6174 655f 6469 6374 2e6b 6579 7328   date_dict.keys(
-00004560: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00004570: 6620 2020 2774 7261 696e 2720 696e 2064  f   'train' in d
-00004580: 6174 655f 6469 6374 2e6b 6579 7328 293a  ate_dict.keys():
-00004590: 2064 6174 655f 6469 6374 5b27 6869 7374   date_dict['hist
-000045a0: 275d 203d 2064 6174 655f 6469 6374 5b27  '] = date_dict['
-000045b0: 7472 6169 6e27 5d0a 2020 2020 2020 2020  train'].        
-000045c0: 2020 2020 656c 6966 2027 6c6f 6f6b 2720      elif 'look' 
-000045d0: 696e 2064 6174 655f 6469 6374 2e6b 6579  in date_dict.key
-000045e0: 7328 293a 2064 6174 655f 6469 6374 5b27  s(): date_dict['
-000045f0: 6869 7374 275d 203d 2064 6174 655f 6469  hist'] = date_di
-00004600: 6374 5b27 6c6f 6f6b 275d 0a20 2020 2020  ct['look'].     
-00004610: 2020 2020 2020 2065 6c69 6620 2761 6c6c         elif 'all
-00004620: 2720 696e 2064 6174 655f 6469 6374 2e6b  ' in date_dict.k
-00004630: 6579 7328 293a 2064 6174 655f 6469 6374  eys(): date_dict
-00004640: 5b27 6869 7374 275d 203d 2064 6174 655f  ['hist'] = date_
-00004650: 6469 6374 5b27 616c 6c27 5d0a 2020 2020  dict['all'].    
-00004660: 2020 2020 2020 2020 656c 7365 3a20 7261          else: ra
-00004670: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00004680: 6564 4572 726f 7228 6627 6461 7465 5f64  edError(f'date_d
-00004690: 6963 7420 3d20 7b64 6174 655f 6469 6374  ict = {date_dict
-000046a0: 7d2c 206e 6565 6420 6869 7374 2729 0a20  }, need hist'). 
-000046b0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-000046c0: 653a 2070 7269 6e74 2866 275b 2b5d 2070  e: print(f'[+] p
-000046d0: 6164 6469 6e67 203d 207b 7061 6464 696e  adding = {paddin
-000046e0: 677d 2c20 636f 6c5f 6c61 6265 6c5f 6672  g}, col_label_fr
-000046f0: 6f6d 203d 207b 636f 6c5f 6c61 6265 6c5f  om = {col_label_
-00004700: 6672 6f6d 7d27 290a 2020 2020 2020 2020  from}').        
-00004710: 7820 3d20 646d 2e64 665f 6469 6374 5b27  x = dm.df_dict['
-00004720: 5430 275d 5b63 6f6c 5f74 6964 5d2e 746f  T0'][col_tid].to
-00004730: 5f6e 756d 7079 2829 0a20 2020 2020 2020  _numpy().       
-00004740: 2066 6f72 206b 6579 2069 6e20 6461 7465   for key in date
-00004750: 5f64 6963 742e 6b65 7973 2829 3a0a 2020  _dict.keys():.  
-00004760: 2020 2020 2020 2020 2020 6461 7465 5f62            date_b
-00004770: 6567 696e 2c20 6461 7465 5f65 6e64 203d  egin, date_end =
-00004780: 2064 6174 655f 6469 6374 5b6b 6579 5d0a   date_dict[key].
-00004790: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-000047a0: 6579 2069 6e20 5b27 7472 6169 6e27 2c20  ey in ['train', 
-000047b0: 2768 6973 7427 5d3a 2023 20e5 9ca8 e58e  'hist']: # .....
-000047c0: 9fe6 9c89 6461 7465 5f65 6e64 e79a 84e5  ....date_end....
-000047d0: 9fba e7a1 80e4 b88a 2c20 e586 8de5 8ebb  ........, ......
-000047e0: e68e 8970 6164 6469 6e67 e5a4 a90a 2020  ...padding....  
-000047f0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-00004800: 756e 6971 7565 203d 206e 702e 756e 6971  unique = np.uniq
-00004810: 7565 2878 290a 2020 2020 2020 2020 2020  ue(x).          
-00004820: 2020 2020 2020 6461 7465 5f65 6e64 203d        date_end =
-00004830: 206e 702e 736f 7274 2878 5f75 6e69 7175   np.sort(x_uniqu
-00004840: 655b 785f 756e 6971 7565 203c 3d20 6461  e[x_unique <= da
-00004850: 7465 5f65 6e64 5d29 5b2d 2831 202b 2070  te_end])[-(1 + p
-00004860: 6164 6469 6e67 295d 0a20 2020 2020 2020  adding)].       
-00004870: 2020 2020 200a 2020 2020 2020 2020 2020       .          
-00004880: 2020 6d61 736b 203d 2020 2878 203e 3d20    mask =  (x >= 
-00004890: 6461 7465 5f62 6567 696e 2920 2620 2878  date_begin) & (x
-000048a0: 203c 3d20 6461 7465 5f65 6e64 290a 2020   <= date_end).  
-000048b0: 2020 2020 2020 2020 2020 6966 206b 6579            if key
-000048c0: 2021 3d20 2774 6573 7427 3a0a 2020 2020   != 'test':.    
-000048d0: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-000048e0: 2026 3d20 6d61 736b 5f6d 6173 6b2e 6173   &= mask_mask.as
-000048f0: 7479 7065 2862 6f6f 6c29 0a20 2020 2020  type(bool).     
-00004900: 2020 2020 2020 2064 6d2e 7365 745f 6d61         dm.set_ma
-00004910: 736b 286d 6173 6b2c 206d 6173 6b5f 6e61  sk(mask, mask_na
-00004920: 6d65 203d 206b 6579 290a 2020 2020 2020  me = key).      
-00004930: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
-00004940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004950: 2020 6966 206c 656e 2878 5b6d 6173 6b5d    if len(x[mask]
-00004960: 2920 3e20 303a 2070 7269 6e74 2866 275b  ) > 0: print(f'[
-00004970: 2b5d 206d 6173 6b5f 6e61 6d65 203d 207b  +] mask_name = {
-00004980: 6b65 793a 3c31 317d 7c20 7b78 5b6d 6173  key:<11}| {x[mas
-00004990: 6b5d 2e6d 696e 2829 7d20 2d3e 207b 785b  k].min()} -> {x[
-000049a0: 6d61 736b 5d2e 6d61 7828 297d 203d 207b  mask].max()} = {
-000049b0: 6d61 736b 2e73 756d 2829 7d27 290a 2020  mask.sum()}').  
-000049c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000049d0: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
-000049e0: 6d61 736b 5f6e 616d 6520 3d20 7b6b 6579  mask_name = {key
-000049f0: 3a3c 3131 7d7c 206c 656e 203d 2030 2729  :<11}| len = 0')
-00004a00: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00004a10: 2020 2320 7368 6966 745f 310a 2020 2020    # shift_1.    
-00004a20: 2020 2020 6966 2076 6572 626f 7365 3a20      if verbose: 
-00004a30: 7072 696e 7428 275b 696e 6974 5d20 3c2d  print('[init] <-
-00004a40: 2d2d 2d2d 2d2d 2d2d 2d20 7368 6966 745f  --------- shift_
-00004a50: 6920 2d2d 2d2d 2d2d 2d2d 2d2d 3e20 2729  i ----------> ')
-00004a60: 0a20 2020 2020 2020 2073 6869 6674 5f69  .        shift_i
-00004a70: 203d 206f 7468 6572 5f69 6e66 6f2e 6765   = other_info.ge
-00004a80: 7428 2773 6869 6674 5f69 272c 2031 290a  t('shift_i', 1).
-00004a90: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00004aa0: 7365 3a20 7072 696e 7428 6627 5b2b 5d20  se: print(f'[+] 
-00004ab0: 7368 6966 745f 6920 3d20 7b73 6869 6674  shift_i = {shift
-00004ac0: 5f69 7d27 290a 2020 2020 2020 2020 636f  _i}').        co
-00004ad0: 6c73 5f73 6869 6674 5f31 5f6e 6f74 203d  ls_shift_1_not =
-00004ae0: 205b 636f 6c5f 6964 2c20 636f 6c5f 7469   [col_id, col_ti
-00004af0: 642c 2063 6f6c 5f6c 6162 656c 5d20 2b20  d, col_label] + 
-00004b00: 636f 6c73 5f74 6964 202b 2063 6f6c 735f  cols_tid + cols_
-00004b10: 6c61 6265 6c20 2b20 636f 6c73 5f6d 6173  label + cols_mas
-00004b20: 6b20 2b20 5b6f 7468 6572 5f69 6e66 6f2e  k + [other_info.
-00004b30: 6765 7428 2763 6f6c 5f64 6174 6527 2c20  get('col_date', 
-00004b40: 4e6f 6e65 295d 0a20 2020 2020 2020 2063  None)].        c
-00004b50: 6f6c 735f 7368 6966 745f 315f 6e6f 7420  ols_shift_1_not 
-00004b60: 2b3d 206f 7468 6572 5f69 6e66 6f2e 6765  += other_info.ge
-00004b70: 7428 2763 6f6c 735f 7368 6966 745f 315f  t('cols_shift_1_
-00004b80: 6e6f 7427 2c20 5b5d 290a 2020 2020 2020  not', []).      
-00004b90: 2020 6f74 6865 725f 696e 666f 5b27 636f    other_info['co
-00004ba0: 6c73 5f73 6869 6674 5f31 5f6e 6f74 275d  ls_shift_1_not']
-00004bb0: 203d 2063 6f6c 735f 7368 6966 745f 315f   = cols_shift_1_
-00004bc0: 6e6f 740a 2020 2020 2020 2020 6966 2076  not.        if v
-00004bd0: 6572 626f 7365 3a20 7072 696e 7428 6627  erbose: print(f'
-00004be0: 5b2b 5d20 636f 6c73 5f73 6869 6674 5f31  [+] cols_shift_1
-00004bf0: 5f6e 6f74 203d 207b 636f 6c73 5f73 6869  _not = {cols_shi
-00004c00: 6674 5f31 5f6e 6f74 7d27 290a 2020 2020  ft_1_not}').    
-00004c10: 2020 2020 636f 6c73 5f73 6869 6674 5f31      cols_shift_1
-00004c20: 203d 205b 636f 6c20 666f 7220 636f 6c20   = [col for col 
-00004c30: 696e 2064 6d2e 6865 6164 2829 2e63 6f6c  in dm.head().col
-00004c40: 756d 6e73 2069 6620 636f 6c20 6e6f 7420  umns if col not 
-00004c50: 696e 2063 6f6c 735f 7368 6966 745f 315f  in cols_shift_1_
-00004c60: 6e6f 745d 0a20 2020 2020 2020 2069 6620  not].        if 
-00004c70: 7368 6966 745f 6920 213d 2030 3a20 646d  shift_i != 0: dm
-00004c80: 2e66 655f 676f 285b 6627 7b63 6f6c 7d20  .fe_go([f'{col} 
-00004c90: 3d20 726f 6c6c 2873 6869 6674 2c20 7b63  = roll(shift, {c
-00004ca0: 6f6c 5f69 647d 2c20 7b63 6f6c 7d2c 207b  ol_id}, {col}, {
-00004cb0: 636f 6c5f 7469 647d 2c20 7b73 6869 6674  col_tid}, {shift
-00004cc0: 5f69 7d29 2720 666f 7220 636f 6c20 696e  _i})' for col in
-00004cd0: 2063 6f6c 735f 7368 6966 745f 315d 2c20   cols_shift_1], 
-00004ce0: 7665 7262 6f73 653d 7665 7262 6f73 6529  verbose=verbose)
-00004cf0: 0a20 2020 2020 2020 2023 2064 6d2e 6665  .        # dm.fe
-00004d00: 5f67 6f28 5b66 2772 6f6c 6c28 7368 6966  _go([f'roll(shif
-00004d10: 742c 207b 636f 6c5f 6964 7d2c 207b 636f  t, {col_id}, {co
-00004d20: 6c7d 2c20 7b63 6f6c 5f74 6964 7d2c 2031  l}, {col_tid}, 1
-00004d30: 2927 2066 6f72 2063 6f6c 2069 6e20 636f  )' for col in co
-00004d40: 6c73 5f73 6869 6674 5f31 5d2c 206b 6565  ls_shift_1], kee
-00004d50: 705f 6e61 6d65 203d 2032 290a 2020 2020  p_name = 2).    
-00004d60: 2020 2020 7265 7475 726e 2064 6d0a 7a06      return dm.z.
-00004d70: 5c27 5c27 5c27 7a03 2727 27da 0177 2907  \'\'\'z.'''..w).
-00004d80: da02 6f73 da04 7061 7468 da07 6469 726e  ..os..path..dirn
-00004d90: 616d 65da 085f 5f66 696c 655f 5fda 0772  ame..__file__..r
-00004da0: 6570 6c61 6365 da04 6f70 656e da05 7772  eplace..open..wr
-00004db0: 6974 6529 04da 066f 7574 7075 745a 0b70  ite)...outputZ.p
-00004dc0: 6174 685f 6f75 7470 7574 da01 73da 0166  ath_output..s..f
-00004dd0: a900 720e 0000 00fa 4b62 7569 6c64 2f62  ..r.....Kbuild/b
-00004de0: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
-00004df0: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
-00004e00: 696e 677a 2f66 652f 7072 6570 6172 655f  ingz/fe/prepare_
-00004e10: 6461 7461 2f62 6173 655f 6461 7461 5f70  data/base_data_p
-00004e20: 792e 7079 da03 7275 6e04 0000 0073 1000  y.py..run....s..
-00004e30: 0000 0001 1401 047f 007f 007f 000d 0c01  ................
-00004e40: 0c01 7210 0000 00da 085f 5f6d 6169 6e5f  ..r......__main_
-00004e50: 5f7a 082d 2d6f 7574 7075 7454 2902 da04  _z.--outputT)...
-00004e60: 7479 7065 da08 7265 7175 6972 6564 290c  type..required).
-00004e70: 7204 0000 00da 0373 7973 7210 0000 00da  r......sysr.....
-00004e80: 085f 5f6e 616d 655f 5fda 0861 7267 7061  .__name__..argpa
-00004e90: 7273 65da 0e41 7267 756d 656e 7450 6172  rse..ArgumentPar
-00004ea0: 7365 72da 0670 6172 7365 72da 0c61 6464  ser..parser..add
-00004eb0: 5f61 7267 756d 656e 74da 0373 7472 da0a  _argument..str..
-00004ec0: 7061 7273 655f 6172 6773 da04 6172 6773  parse_args..args
-00004ed0: 720b 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
-00004ee0: 0e00 0000 720f 0000 00da 083c 6d6f 6475  ....r......<modu
-00004ef0: 6c65 3e02 0000 0073 1600 0000 0801 0801  le>....s........
-00004f00: 087f 007f 007f 0013 0801 0801 0801 1001  ................
-00004f10: 0801                                     ..
+00000f20: 2020 2020 2020 2020 656c 6966 2027 5747          elif 'WG
+00000f30: 5427 2069 6e20 6f70 3a20 0a20 2020 2020  T' in op: .     
+00000f40: 2020 2020 2020 2077 203d 205b 6e70 2e66         w = [np.f
+00000f50: 6c6f 6174 3332 2877 6929 2066 6f72 2077  loat32(wi) for w
+00000f60: 6920 696e 206f 702e 7370 6c69 7428 272c  i in op.split(',
+00000f70: 2729 5b31 3a5d 5d0a 2020 2020 2020 2020  ')[1:]].        
+00000f80: 2020 2020 6173 7365 7274 206c 656e 2877      assert len(w
+00000f90: 2920 3d3d 206c 656e 2863 6f6c 7329 2c20  ) == len(cols), 
+00000fa0: 6627 636f 6c73 203d 207b 636f 6c73 7d2c  f'cols = {cols},
+00000fb0: 2077 203d 207b 777d 270a 2020 2020 2020   w = {w}'.      
+00000fc0: 2020 2020 2020 7820 3d20 2864 665f 6c61        x = (df_la
+00000fd0: 6265 6c5f 6669 6e61 6c5b 636f 6c73 5d2e  bel_final[cols].
+00000fe0: 746f 5f6e 756d 7079 2829 202a 2077 292e  to_numpy() * w).
+00000ff0: 7375 6d28 6178 6973 203d 2031 290a 2020  sum(axis = 1).  
+00001000: 2020 2020 2020 656c 7365 3a20 0a20 2020        else: .   
+00001010: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00001020: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00001030: 6f72 2866 276c 6162 656c 5f66 726f 6d5f  or(f'label_from_
+00001040: 7374 7220 6572 726f 722c 206f 7020 3d20  str error, op = 
+00001050: 7b6f 707d 2729 0a20 2020 2020 2020 2064  {op}').        d
+00001060: 665f 6c61 6265 6c5f 6669 6e61 6c20 3d20  f_label_final = 
+00001070: 6466 5f6c 6162 656c 5f66 696e 616c 2e77  df_label_final.w
+00001080: 6974 685f 636f 6c75 6d6e 7328 706c 2e53  ith_columns(pl.S
+00001090: 6572 6965 7328 274c 4142 454c 5f46 524f  eries('LABEL_FRO
+000010a0: 4d5f 5354 5227 2c20 7829 290a 2020 2020  M_STR', x)).    
+000010b0: 636f 6c73 5f6c 6162 656c 203d 205b 636f  cols_label = [co
+000010c0: 6c20 666f 7220 636f 6c20 696e 2064 665f  l for col in df_
+000010d0: 6c61 6265 6c5f 6669 6e61 6c2e 636f 6c75  label_final.colu
+000010e0: 6d6e 7320 6966 2063 6f6c 206e 6f74 2069  mns if col not i
+000010f0: 6e20 636f 6c73 5f69 645d 2020 0a20 2020  n cols_id]  .   
+00001100: 2072 6574 7572 6e20 6466 5f6c 6162 656c   return df_label
+00001110: 5f66 696e 616c 2c20 636f 6c73 5f6c 6162  _final, cols_lab
+00001120: 656c 0a0a 6465 6620 6466 5f65 7870 616e  el..def df_expan
+00001130: 645f 4c5f 5228 6466 5f4c 2c20 6466 5f52  d_L_R(df_L, df_R
+00001140: 293a 0a20 2020 2064 6174 6573 5f68 6176  ):.    dates_hav
+00001150: 6520 3d20 6466 5f52 5b27 7472 6164 655f  e = df_R['trade_
+00001160: 6461 7465 275d 2e75 6e69 7175 6528 290a  date'].unique().
+00001170: 2020 2020 6461 7465 735f 746f 646f 203d      dates_todo =
+00001180: 2064 665f 4c5b 2774 7261 6465 5f64 6174   df_L['trade_dat
+00001190: 6527 5d2e 756e 6971 7565 2829 0a20 2020  e'].unique().   
+000011a0: 2064 6174 6573 5f74 6f64 6f20 3d20 6461   dates_todo = da
+000011b0: 7465 735f 746f 646f 5b64 6174 6573 5f74  tes_todo[dates_t
+000011c0: 6f64 6f20 3e20 6461 7465 735f 6861 7665  odo > dates_have
+000011d0: 5b2d 315d 5d0a 2020 2020 6466 5f52 5f6c  [-1]].    df_R_l
+000011e0: 6173 7420 3d20 6466 5f52 5b64 665f 525b  ast = df_R[df_R[
+000011f0: 2774 7261 6465 5f64 6174 6527 5d20 3d3d  'trade_date'] ==
+00001200: 2064 6174 6573 5f68 6176 655b 2d31 5d5d   dates_have[-1]]
+00001210: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
+00001220: 7020 3d20 5472 7565 290a 2020 2020 6966  p = True).    if
+00001230: 206c 656e 2864 6174 6573 5f74 6f64 6f29   len(dates_todo)
+00001240: 203d 3d20 303a 2072 6574 7572 6e20 6466   == 0: return df
+00001250: 5f52 0a20 2020 2064 665f 6e65 7874 5f6c  _R.    df_next_l
+00001260: 6973 7420 3d20 5b5d 200a 2020 2020 7072  ist = [] .    pr
+00001270: 696e 7428 6627 5b2b 5d20 6461 7465 735f  int(f'[+] dates_
+00001280: 746f 646f 203d 207b 6461 7465 735f 746f  todo = {dates_to
+00001290: 646f 7d27 290a 2020 2020 666f 7220 6461  do}').    for da
+000012a0: 7465 2069 6e20 6461 7465 735f 746f 646f  te in dates_todo
+000012b0: 3a0a 2020 2020 2020 2020 6466 5f6e 6578  :.        df_nex
+000012c0: 7420 3d20 6466 5f52 5f6c 6173 742e 636f  t = df_R_last.co
+000012d0: 7079 2829 0a20 2020 2020 2020 2064 665f  py().        df_
+000012e0: 6e65 7874 5b27 7472 6164 655f 6461 7465  next['trade_date
+000012f0: 275d 203d 2064 6174 650a 2020 2020 2020  '] = date.      
+00001300: 2020 6466 5f6e 6578 745f 6c69 7374 2e61    df_next_list.a
+00001310: 7070 656e 6428 6466 5f6e 6578 7429 0a20  ppend(df_next). 
+00001320: 2020 2064 665f 6e65 7874 203d 2070 642e     df_next = pd.
+00001330: 636f 6e63 6174 2864 665f 6e65 7874 5f6c  concat(df_next_l
+00001340: 6973 742c 2061 7869 7320 3d20 3029 2e72  ist, axis = 0).r
+00001350: 6573 6574 5f69 6e64 6578 2864 726f 7020  eset_index(drop 
+00001360: 3d20 5472 7565 290a 2020 2020 6466 5f52  = True).    df_R
+00001370: 203d 2070 642e 636f 6e63 6174 285b 6466   = pd.concat([df
+00001380: 5f52 2c20 6466 5f6e 6578 745d 2c20 6178  _R, df_next], ax
+00001390: 6973 203d 2030 2c20 736f 7274 203d 2046  is = 0, sort = F
+000013a0: 616c 7365 292e 7265 7365 745f 696e 6465  alse).reset_inde
+000013b0: 7828 6472 6f70 203d 2054 7275 6529 0a20  x(drop = True). 
+000013c0: 2020 2072 6574 7572 6e20 6466 5f52 0a0a     return df_R..
+000013d0: 6465 6620 6765 745f 6466 5f6d 6173 6b28  def get_df_mask(
+000013e0: 7061 7468 5f64 622c 2064 6d2c 2063 6f6c  path_db, dm, col
+000013f0: 5f74 6964 2c20 636f 6c5f 6964 2c20 7665  _tid, col_id, ve
+00001400: 7262 6f73 6520 3d20 5472 7565 293a 0a20  rbose = True):. 
+00001410: 2020 2064 6620 3d20 646d 2e67 6574 5f63     df = dm.get_c
+00001420: 6f6c 735f 7061 6e64 6173 285b 636f 6c5f  ols_pandas([col_
+00001430: 7469 642c 2063 6f6c 5f69 645d 202b 205b  tid, col_id] + [
+00001440: 276f 7065 6e27 2c20 2770 6374 5f63 6867  'open', 'pct_chg
+00001450: 275d 290a 2020 2020 6462 203d 2044 424d  ']).    db = DBM
+00001460: 6173 7465 7228 7061 7468 5f64 622c 2076  aster(path_db, v
+00001470: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
+00001480: 290a 2020 2020 6462 2e63 6f6e 6e65 6374  ).    db.connect
+00001490: 2829 0a0a 2020 2020 6b65 7973 203d 205b  ()..    keys = [
+000014a0: 636f 6c5f 7469 642c 2063 6f6c 5f69 645d  col_tid, col_id]
+000014b0: 0a20 2020 2064 665f 4c20 3d20 6466 5b6b  .    df_L = df[k
+000014c0: 6579 735d 0a20 2020 200a 2020 2020 2320  eys].    .    # 
+000014d0: 7072 696e 7428 275b 2b5d 2072 6561 6420  print('[+] read 
+000014e0: 6c69 7374 5f64 6174 6527 290a 2020 2020  list_date').    
+000014f0: 636f 6c20 3d20 276c 6973 745f 6461 7465  col = 'list_date
+00001500: 270a 2020 2020 6466 5f52 203d 2064 622e  '.    df_R = db.
+00001510: 7365 6c65 6374 2827 6466 5f6c 6973 745f  select('df_list_
+00001520: 6461 7465 272c 2063 6f6c 7320 3d20 5b63  date', cols = [c
+00001530: 6f6c 5f69 645d 202b 205b 636f 6c5d 290a  ol_id] + [col]).
+00001540: 2020 2020 6466 5f52 203d 2064 665f 525b      df_R = df_R[
+00001550: 6466 5f52 5b27 6c69 7374 5f64 6174 6527  df_R['list_date'
+00001560: 5d20 3e20 305d 2e72 6573 6574 5f69 6e64  ] > 0].reset_ind
+00001570: 6578 2864 726f 7020 3d20 5472 7565 290a  ex(drop = True).
+00001580: 2020 2020 735f 6c69 7374 5f64 6174 6520      s_list_date 
+00001590: 3d20 6d65 7267 6528 6466 5f4c 2c20 6466  = merge(df_L, df
+000015a0: 5f52 2c20 5b63 6f6c 5f69 645d 295b 636f  _R, [col_id])[co
+000015b0: 6c5d 2e74 6f5f 7061 6e64 6173 2829 0a20  l].to_pandas(). 
+000015c0: 2020 200a 2020 2020 2320 7072 696e 7428     .    # print(
+000015d0: 275b 2b5d 2072 6561 6420 735f 7374 2729  '[+] read s_st')
+000015e0: 0a20 2020 2063 6f6c 203d 2027 5354 270a  .    col = 'ST'.
+000015f0: 2020 2020 6466 5f52 203d 2064 622e 7365      df_R = db.se
+00001600: 6c65 6374 2827 6466 5f73 7427 2c20 636f  lect('df_st', co
+00001610: 6c73 203d 206b 6579 7320 2b20 5b63 6f6c  ls = keys + [col
+00001620: 5d29 0a20 2020 2064 665f 5220 3d20 6466  ]).    df_R = df
+00001630: 5f65 7870 616e 645f 4c5f 5228 6466 5f4c  _expand_L_R(df_L
+00001640: 2c20 6466 5f52 290a 2020 2020 735f 7374  , df_R).    s_st
+00001650: 203d 206d 6572 6765 2864 665f 4c2c 2064   = merge(df_L, d
+00001660: 665f 522c 206b 6579 7329 5b27 5354 275d  f_R, keys)['ST']
+00001670: 2e74 6f5f 7061 6e64 6173 2829 2e66 696c  .to_pandas().fil
+00001680: 6c6e 6128 3029 0a20 2020 200a 2020 2020  lna(0).    .    
+00001690: 2320 7072 696e 7428 275b 2b5d 2072 6561  # print('[+] rea
+000016a0: 6420 735f 7375 7327 290a 2020 2020 636f  d s_sus').    co
+000016b0: 6c20 3d20 2753 5553 270a 2020 2020 6466  l = 'SUS'.    df
+000016c0: 5f52 203d 2064 622e 7365 6c65 6374 2827  _R = db.select('
+000016d0: 6466 5f73 7573 272c 2063 6f6c 7320 3d20  df_sus', cols = 
+000016e0: 6b65 7973 202b 205b 636f 6c5d 290a 2020  keys + [col]).  
+000016f0: 2020 6466 5f52 203d 2064 665f 6578 7061    df_R = df_expa
+00001700: 6e64 5f4c 5f52 2864 665f 4c2c 2064 665f  nd_L_R(df_L, df_
+00001710: 5229 0a20 2020 2073 5f73 7573 203d 206d  R).    s_sus = m
+00001720: 6572 6765 2864 665f 4c2c 2064 665f 522c  erge(df_L, df_R,
+00001730: 206b 6579 7329 5b27 5355 5327 5d2e 746f   keys)['SUS'].to
+00001740: 5f70 616e 6461 7328 292e 6669 6c6c 6e61  _pandas().fillna
+00001750: 2830 290a 2020 2020 0a20 2020 2023 202d  (0).    .    # -
+00001760: 2d2d 2d2d 2d2d 2d2d 2d20 6466 5f6d 6173  --------- df_mas
+00001770: 6b20 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  k ----------.   
+00001780: 2023 2070 7269 6e74 2827 5b2b 5d20 6466   # print('[+] df
+00001790: 5f6d 6173 6b27 290a 2020 2020 6466 5f6d  _mask').    df_m
+000017a0: 6173 6b20 3d20 6466 5b6b 6579 7320 2b20  ask = df[keys + 
+000017b0: 5b27 6f70 656e 272c 2027 7063 745f 6368  ['open', 'pct_ch
+000017c0: 6727 5d5d 0a20 2020 2064 665f 6d61 736b  g']].    df_mask
+000017d0: 5b27 6c69 7374 5f64 6174 6527 5d20 3d20  ['list_date'] = 
+000017e0: 735f 6c69 7374 5f64 6174 650a 2020 2020  s_list_date.    
+000017f0: 6466 5f6d 6173 6b5b 2753 5427 5d20 3d20  df_mask['ST'] = 
+00001800: 735f 7374 0a20 2020 2064 665f 6d61 736b  s_st.    df_mask
+00001810: 5b27 5355 5327 5d20 3d20 735f 7375 730a  ['SUS'] = s_sus.
+00001820: 0a20 2020 2073 203d 2064 665f 6d61 736b  .    s = df_mask
+00001830: 5b63 6f6c 5f74 6964 5d2e 6472 6f70 5f64  [col_tid].drop_d
+00001840: 7570 6c69 6361 7465 7328 292e 7265 7365  uplicates().rese
+00001850: 745f 696e 6465 7828 6472 6f70 203d 2054  t_index(drop = T
+00001860: 7275 6529 0a20 2020 2064 6174 655f 6469  rue).    date_di
+00001870: 6374 5f31 203d 2064 6963 7428 7a69 7028  ct_1 = dict(zip(
+00001880: 732c 2070 642e 746f 5f64 6174 6574 696d  s, pd.to_datetim
+00001890: 6528 732c 2066 6f72 6d61 743d 2725 5925  e(s, format='%Y%
+000018a0: 6d25 6427 2929 290a 2020 2020 7320 3d20  m%d'))).    s = 
+000018b0: 6466 5f6d 6173 6b5b 276c 6973 745f 6461  df_mask['list_da
+000018c0: 7465 275d 2e64 726f 705f 6475 706c 6963  te'].drop_duplic
+000018d0: 6174 6573 2829 2e72 6573 6574 5f69 6e64  ates().reset_ind
+000018e0: 6578 2864 726f 7020 3d20 5472 7565 290a  ex(drop = True).
+000018f0: 2020 2020 6461 7465 5f64 6963 745f 3220      date_dict_2 
+00001900: 3d20 6469 6374 287a 6970 2873 2c20 7064  = dict(zip(s, pd
+00001910: 2e74 6f5f 6461 7465 7469 6d65 2873 2c20  .to_datetime(s, 
+00001920: 666f 726d 6174 3d27 2559 256d 2564 2729  format='%Y%m%d')
+00001930: 2929 0a0a 2020 2020 2320 6964 785f 7878  ))..    # idx_xx
+00001940: 780a 2020 2020 6964 785f 3230 203d 2028  x.    idx_20 = (
+00001950: 6466 5f6d 6173 6b5b 636f 6c5f 7469 645d  df_mask[col_tid]
+00001960: 2e6d 6170 2864 6174 655f 6469 6374 5f31  .map(date_dict_1
+00001970: 2920 2d20 6466 5f6d 6173 6b5b 276c 6973  ) - df_mask['lis
+00001980: 745f 6461 7465 275d 2e6d 6170 2864 6174  t_date'].map(dat
+00001990: 655f 6469 6374 5f32 2929 2e64 742e 6461  e_dict_2)).dt.da
+000019a0: 7973 203e 3d20 3230 0a20 2020 2069 6478  ys >= 20.    idx
+000019b0: 5f6e 616e 203d 207e 6466 5f6d 6173 6b5b  _nan = ~df_mask[
+000019c0: 276f 7065 6e27 5d2e 6973 6e75 6c6c 2829  'open'].isnull()
+000019d0: 0a20 2020 2069 6478 5f73 7420 3d20 6466  .    idx_st = df
+000019e0: 5f6d 6173 6b5b 2753 5427 5d20 3c3d 2030  _mask['ST'] <= 0
+000019f0: 0a20 2020 2069 6478 5f73 7573 203d 2064  .    idx_sus = d
+00001a00: 665f 6d61 736b 5b27 5355 5327 5d20 3c3d  f_mask['SUS'] <=
+00001a10: 2031 0a20 2020 200a 2020 2020 2320 2d2d   1.    .    # --
+00001a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001a80: 2d2d 0a20 2020 206e 616d 655f 6c69 7374  --.    name_list
+00001a90: 203d 205b 0a20 2020 2020 2020 2066 275f   = [.        f'_
+00001aa0: 5f54 454d 505f 615f 3120 3d20 726f 6c6c  _TEMP_a_1 = roll
+00001ab0: 2873 6869 6674 2c20 7b63 6f6c 5f69 647d  (shift, {col_id}
+00001ac0: 2c20 616d 6f75 6e74 2c20 7b63 6f6c 5f74  , amount, {col_t
+00001ad0: 6964 7d2c 2030 2927 2c0a 2020 2020 2020  id}, 0)',.      
+00001ae0: 2020 6627 5f5f 5445 4d50 5f61 5f32 203d    f'__TEMP_a_2 =
+00001af0: 2072 6f6c 6c28 7368 6966 742c 207b 636f   roll(shift, {co
+00001b00: 6c5f 6964 7d2c 2061 6d6f 756e 742c 207b  l_id}, amount, {
+00001b10: 636f 6c5f 7469 647d 2c20 3129 272c 0a20  col_tid}, 1)',. 
+00001b20: 2020 2020 2020 2066 275f 5f54 454d 505f         f'__TEMP_
+00001b30: 615f 3320 3d20 726f 6c6c 2873 6869 6674  a_3 = roll(shift
+00001b40: 2c20 7b63 6f6c 5f69 647d 2c20 616d 6f75  , {col_id}, amou
+00001b50: 6e74 2c20 7b63 6f6c 5f74 6964 7d2c 2032  nt, {col_tid}, 2
+00001b60: 2927 2c0a 2020 2020 2020 2020 0a20 2020  )',.        .   
+00001b70: 2020 2020 2066 275f 5f54 454d 505f 685f       f'__TEMP_h_
+00001b80: 3120 3d20 726f 6c6c 2873 6869 6674 2c20  1 = roll(shift, 
+00001b90: 7b63 6f6c 5f69 647d 2c20 6869 6768 2c20  {col_id}, high, 
+00001ba0: 7b63 6f6c 5f74 6964 7d2c 2030 2927 2c0a  {col_tid}, 0)',.
+00001bb0: 2020 2020 2020 2020 6627 5f5f 5445 4d50          f'__TEMP
+00001bc0: 5f68 5f32 203d 2072 6f6c 6c28 7368 6966  _h_2 = roll(shif
+00001bd0: 742c 207b 636f 6c5f 6964 7d2c 2068 6967  t, {col_id}, hig
+00001be0: 682c 207b 636f 6c5f 7469 647d 2c20 3129  h, {col_tid}, 1)
+00001bf0: 272c 0a20 2020 2020 2020 2066 275f 5f54  ',.        f'__T
+00001c00: 454d 505f 685f 3320 3d20 726f 6c6c 2873  EMP_h_3 = roll(s
+00001c10: 6869 6674 2c20 7b63 6f6c 5f69 647d 2c20  hift, {col_id}, 
+00001c20: 6869 6768 2c20 7b63 6f6c 5f74 6964 7d2c  high, {col_tid},
+00001c30: 2032 2927 2c0a 0a20 2020 2020 2020 2066   2)',..        f
+00001c40: 275f 5f54 454d 505f 6c5f 3120 3d20 726f  '__TEMP_l_1 = ro
+00001c50: 6c6c 2873 6869 6674 2c20 7b63 6f6c 5f69  ll(shift, {col_i
+00001c60: 647d 2c20 6c6f 772c 207b 636f 6c5f 7469  d}, low, {col_ti
+00001c70: 647d 2c20 3029 272c 0a20 2020 2020 2020  d}, 0)',.       
+00001c80: 2066 275f 5f54 454d 505f 6c5f 3220 3d20   f'__TEMP_l_2 = 
+00001c90: 726f 6c6c 2873 6869 6674 2c20 7b63 6f6c  roll(shift, {col
+00001ca0: 5f69 647d 2c20 6c6f 772c 207b 636f 6c5f  _id}, low, {col_
+00001cb0: 7469 647d 2c20 3129 272c 0a20 2020 2020  tid}, 1)',.     
+00001cc0: 2020 2066 275f 5f54 454d 505f 6c5f 3320     f'__TEMP_l_3 
+00001cd0: 3d20 726f 6c6c 2873 6869 6674 2c20 7b63  = roll(shift, {c
+00001ce0: 6f6c 5f69 647d 2c20 6c6f 772c 207b 636f  ol_id}, low, {co
+00001cf0: 6c5f 7469 647d 2c20 3229 272c 0a20 2020  l_tid}, 2)',.   
+00001d00: 205d 0a20 2020 2064 6d2e 6665 5f67 6f28   ].    dm.fe_go(
+00001d10: 6e61 6d65 5f6c 6973 742c 2076 6572 626f  name_list, verbo
+00001d20: 7365 203d 2046 616c 7365 290a 2020 2020  se = False).    
+00001d30: 6964 785f 6120 203d 2064 6d2e 6765 745f  idx_a  = dm.get_
+00001d40: 636f 6c5f 6e75 6d70 7928 275f 5f54 454d  col_numpy('__TEM
+00001d50: 505f 615f 3127 2920 3c3d 2035 6536 0a20  P_a_1') <= 5e6. 
+00001d60: 2020 2069 6478 5f61 2026 3d20 646d 2e67     idx_a &= dm.g
+00001d70: 6574 5f63 6f6c 5f6e 756d 7079 2827 5f5f  et_col_numpy('__
+00001d80: 5445 4d50 5f61 5f32 2729 203c 3d20 3565  TEMP_a_2') <= 5e
+00001d90: 360a 2020 2020 6964 785f 6120 263d 2064  6.    idx_a &= d
+00001da0: 6d2e 6765 745f 636f 6c5f 6e75 6d70 7928  m.get_col_numpy(
+00001db0: 275f 5f54 454d 505f 615f 3327 2920 3c3d  '__TEMP_a_3') <=
+00001dc0: 2035 6536 0a0a 2020 2020 6964 785f 696e   5e6..    idx_in
+00001dd0: 7472 615f 7265 7420 203d 206e 702e 6162  tra_ret  = np.ab
+00001de0: 7328 646d 2e67 6574 5f63 6f6c 5f6e 756d  s(dm.get_col_num
+00001df0: 7079 2827 5f5f 5445 4d50 5f68 5f31 2729  py('__TEMP_h_1')
+00001e00: 202f 2064 6d2e 6765 745f 636f 6c5f 6e75   / dm.get_col_nu
+00001e10: 6d70 7928 275f 5f54 454d 505f 6c5f 3127  mpy('__TEMP_l_1'
+00001e20: 2920 2d20 3129 203c 3d20 302e 3220 2f20  ) - 1) <= 0.2 / 
+00001e30: 3130 300a 2020 2020 6964 785f 696e 7472  100.    idx_intr
+00001e40: 615f 7265 7420 263d 206e 702e 6162 7328  a_ret &= np.abs(
+00001e50: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
+00001e60: 2827 5f5f 5445 4d50 5f68 5f32 2729 202f  ('__TEMP_h_2') /
+00001e70: 2064 6d2e 6765 745f 636f 6c5f 6e75 6d70   dm.get_col_nump
+00001e80: 7928 275f 5f54 454d 505f 6c5f 3227 2920  y('__TEMP_l_2') 
+00001e90: 2d20 3129 203c 3d20 302e 3220 2f20 3130  - 1) <= 0.2 / 10
+00001ea0: 300a 2020 2020 6964 785f 696e 7472 615f  0.    idx_intra_
+00001eb0: 7265 7420 263d 206e 702e 6162 7328 646d  ret &= np.abs(dm
+00001ec0: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
+00001ed0: 5f5f 5445 4d50 5f68 5f33 2729 202f 2064  __TEMP_h_3') / d
+00001ee0: 6d2e 6765 745f 636f 6c5f 6e75 6d70 7928  m.get_col_numpy(
+00001ef0: 275f 5f54 454d 505f 6c5f 3327 2920 2d20  '__TEMP_l_3') - 
+00001f00: 3129 203c 3d20 302e 3220 2f20 3130 300a  1) <= 0.2 / 100.
+00001f10: 0a20 2020 2069 6478 5f69 6e74 7261 5f64  .    idx_intra_d
+00001f20: 6966 2020 3d20 6e70 2e61 6273 2864 6d2e  if  = np.abs(dm.
+00001f30: 6765 745f 636f 6c5f 6e75 6d70 7928 275f  get_col_numpy('_
+00001f40: 5f54 454d 505f 685f 3127 2920 2d20 646d  _TEMP_h_1') - dm
+00001f50: 2e67 6574 5f63 6f6c 5f6e 756d 7079 2827  .get_col_numpy('
+00001f60: 5f5f 5445 4d50 5f6c 5f31 2729 202d 2030  __TEMP_l_1') - 0
+00001f70: 2920 3c3d 2030 2e30 340a 2020 2020 6964  ) <= 0.04.    id
+00001f80: 785f 696e 7472 615f 6469 6620 263d 206e  x_intra_dif &= n
+00001f90: 702e 6162 7328 646d 2e67 6574 5f63 6f6c  p.abs(dm.get_col
+00001fa0: 5f6e 756d 7079 2827 5f5f 5445 4d50 5f68  _numpy('__TEMP_h
+00001fb0: 5f32 2729 202d 2064 6d2e 6765 745f 636f  _2') - dm.get_co
+00001fc0: 6c5f 6e75 6d70 7928 275f 5f54 454d 505f  l_numpy('__TEMP_
+00001fd0: 6c5f 3227 2920 2d20 3029 203c 3d20 302e  l_2') - 0) <= 0.
+00001fe0: 3034 0a20 2020 2069 6478 5f69 6e74 7261  04.    idx_intra
+00001ff0: 5f64 6966 2026 3d20 6e70 2e61 6273 2864  _dif &= np.abs(d
+00002000: 6d2e 6765 745f 636f 6c5f 6e75 6d70 7928  m.get_col_numpy(
+00002010: 275f 5f54 454d 505f 685f 3327 2920 2d20  '__TEMP_h_3') - 
+00002020: 646d 2e67 6574 5f63 6f6c 5f6e 756d 7079  dm.get_col_numpy
+00002030: 2827 5f5f 5445 4d50 5f6c 5f33 2729 202d  ('__TEMP_l_3') -
+00002040: 2030 2920 3c3d 2030 2e30 340a 2020 2020   0) <= 0.04.    
+00002050: 646d 2e64 726f 7028 6e61 6d65 5f6c 6973  dm.drop(name_lis
+00002060: 742c 2076 6572 626f 7365 203d 2046 616c  t, verbose = Fal
+00002070: 7365 290a 2020 2020 6d61 736b 5f6b 6a79  se).    mask_kjy
+00002080: 5f74 7672 203d 207e 2869 6478 5f61 207c  _tvr = ~(idx_a |
+00002090: 2069 6478 5f69 6e74 7261 5f72 6574 207c   idx_intra_ret |
+000020a0: 2069 6478 5f69 6e74 7261 5f64 6966 290a   idx_intra_dif).
+000020b0: 0a20 2020 2023 2030 203d 2036 3078 7878  .    # 0 = 60xxx
+000020c0: 782e 5348 0a20 2020 2023 2031 203d 2030  x.SH.    # 1 = 0
+000020d0: 3078 7878 782e 535a 0a20 2020 2023 2032  0xxxx.SZ.    # 2
+000020e0: 203d 2033 3078 7878 782e 535a 0a20 2020   = 30xxxx.SZ.   
+000020f0: 2023 2033 203d 2036 3878 7878 782e 5348   # 3 = 68xxxx.SH
+00002100: 0a20 2020 2023 2034 203d 205b 342c 385d  .    # 4 = [4,8]
+00002110: 7878 7878 782e 424a 0a20 2020 2069 645f  xxxxx.BJ.    id_
+00002120: 6b20 3d20 6466 5b63 6f6c 5f69 645d 2e75  k = df[col_id].u
+00002130: 6e69 7175 6528 290a 2020 2020 6964 5f76  nique().    id_v
+00002140: 203d 2028 7064 2e53 6572 6965 7328 6964   = (pd.Series(id
+00002150: 5f6b 292e 6170 706c 7928 636f 6465 5f32  _k).apply(code_2
+00002160: 5f6d 6172 6b65 7429 203c 3d20 3329 0a20  _market) <= 3). 
+00002170: 2020 206d 6173 6b5f 6b6a 795f 6964 203d     mask_kjy_id =
+00002180: 2064 665b 636f 6c5f 6964 5d2e 6d61 7028   df[col_id].map(
+00002190: 6469 6374 287a 6970 2869 645f 6b2c 2069  dict(zip(id_k, i
+000021a0: 645f 7629 2929 203d 3d20 5472 7565 0a20  d_v))) == True. 
+000021b0: 2020 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d     # -----------
+000021c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000021d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000021e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000021f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002210: 2d2d 2d2d 2d2d 2d2d 2d0a 0a20 2020 2069  ---------..    i
+00002220: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
+00002230: 2827 5b2b 5d20 5354 2c20 4b4a 592c 205a  ('[+] ST, KJY, Z
+00002240: 4454 2c20 4d41 534b 2729 0a20 2020 2064  DT, MASK').    d
+00002250: 665f 6d61 736b 5b27 4d41 534b 5f53 5427  f_mask['MASK_ST'
+00002260: 5d20 3d20 2869 6478 5f73 7429 2e61 7374  ] = (idx_st).ast
+00002270: 7970 6528 6e70 2e69 6e74 3332 290a 0a20  ype(np.int32).. 
+00002280: 2020 2064 665f 6d61 736b 5b27 4d41 534b     df_mask['MASK
+00002290: 5f4b 4a59 275d 203d 2028 6964 785f 6e61  _KJY'] = (idx_na
+000022a0: 6e20 2620 6964 785f 3230 2026 2069 6478  n & idx_20 & idx
+000022b0: 5f73 7420 2620 6964 785f 7375 7329 2e61  _st & idx_sus).a
+000022c0: 7374 7970 6528 6e70 2e69 6e74 3332 290a  stype(np.int32).
+000022d0: 2020 2020 6966 2076 6572 626f 7365 3a20      if verbose: 
+000022e0: 7072 696e 7428 6622 5b2b 5d20 6466 5f6d  print(f"[+] df_m
+000022f0: 6173 6b5b 274d 4153 4b5f 4b4a 5927 5d2e  ask['MASK_KJY'].
+00002300: 7375 6d28 2920 3d20 7b64 665f 6d61 736b  sum() = {df_mask
+00002310: 5b27 4d41 534b 5f4b 4a59 275d 2e73 756d  ['MASK_KJY'].sum
+00002320: 2829 7d22 290a 2020 2020 2320 6466 5f6d  ()}").    # df_m
+00002330: 6173 6b5b 274d 4153 4b5f 4b4a 5927 5d20  ask['MASK_KJY'] 
+00002340: 3d20 2864 665f 6d61 736b 5b27 4d41 534b  = (df_mask['MASK
+00002350: 5f4b 4a59 275d 2026 206d 6173 6b5f 6b6a  _KJY'] & mask_kj
+00002360: 795f 7476 7229 2e61 7374 7970 6528 6e70  y_tvr).astype(np
+00002370: 2e69 6e74 3332 290a 2020 2020 6966 2076  .int32).    if v
+00002380: 6572 626f 7365 3a20 7072 696e 7428 6622  erbose: print(f"
+00002390: 5b2b 5d20 6466 5f6d 6173 6b5b 274d 4153  [+] df_mask['MAS
+000023a0: 4b5f 4b4a 5927 5d2e 7375 6d28 2920 3d20  K_KJY'].sum() = 
+000023b0: 7b64 665f 6d61 736b 5b27 4d41 534b 5f4b  {df_mask['MASK_K
+000023c0: 4a59 275d 2e73 756d 2829 7d2c 2061 6674  JY'].sum()}, aft
+000023d0: 6572 2026 3d20 6d61 736b 5f6b 6a79 5f74  er &= mask_kjy_t
+000023e0: 7672 2229 0a20 2020 2064 665f 6d61 736b  vr").    df_mask
+000023f0: 5b27 4d41 534b 5f4b 4a59 275d 203d 2028  ['MASK_KJY'] = (
+00002400: 6466 5f6d 6173 6b5b 274d 4153 4b5f 4b4a  df_mask['MASK_KJ
+00002410: 5927 5d20 2620 6d61 736b 5f6b 6a79 5f69  Y'] & mask_kjy_i
+00002420: 6429 2e61 7374 7970 6528 6e70 2e69 6e74  d).astype(np.int
+00002430: 3332 290a 2020 2020 6966 2076 6572 626f  32).    if verbo
+00002440: 7365 3a20 7072 696e 7428 6622 5b2b 5d20  se: print(f"[+] 
+00002450: 6466 5f6d 6173 6b5b 274d 4153 4b5f 4b4a  df_mask['MASK_KJ
+00002460: 5927 5d2e 7375 6d28 2920 3d20 7b64 665f  Y'].sum() = {df_
+00002470: 6d61 736b 5b27 4d41 534b 5f4b 4a59 275d  mask['MASK_KJY']
+00002480: 2e73 756d 2829 7d2c 2061 6674 6572 2026  .sum()}, after &
+00002490: 3d20 6d61 736b 5f6b 6a79 5f69 6422 290a  = mask_kjy_id").
+000024a0: 2020 2020 0a20 2020 206d 6173 6b5f 7a64      .    mask_zd
+000024b0: 745f 6e61 6e20 3d20 6466 5f6d 6173 6b5b  t_nan = df_mask[
+000024c0: 2770 6374 5f63 6867 275d 2e69 736e 756c  'pct_chg'].isnul
+000024d0: 6c28 2920 2320 7063 745f 6368 6720 6973  l() # pct_chg is
+000024e0: 206e 616e 2c20 6e6f 7420 7365 7420 666f   nan, not set fo
+000024f0: 7220 7a64 740a 2020 2020 6d61 736b 5f7a  r zdt.    mask_z
+00002500: 6474 5f31 3020 3d20 2869 6478 5f73 7420  dt_10 = (idx_st 
+00002510: 3d3d 2031 2920 2620 2864 665f 6d61 736b  == 1) & (df_mask
+00002520: 5b27 7063 745f 6368 6727 5d2e 6162 7328  ['pct_chg'].abs(
+00002530: 2920 3c3d 2039 2e35 3029 0a20 2020 206d  ) <= 9.50).    m
+00002540: 6173 6b5f 7a64 745f 7374 203d 2028 6964  ask_zdt_st = (id
+00002550: 785f 7374 203d 3d20 3029 2026 2028 6466  x_st == 0) & (df
+00002560: 5f6d 6173 6b5b 2770 6374 5f63 6867 275d  _mask['pct_chg']
+00002570: 2e61 6273 2829 203c 3d20 342e 3735 290a  .abs() <= 4.75).
+00002580: 2020 2020 6466 5f6d 6173 6b5b 274d 4153      df_mask['MAS
+00002590: 4b5f 5a44 5427 5d20 3d20 286d 6173 6b5f  K_ZDT'] = (mask_
+000025a0: 7a64 745f 3130 207c 206d 6173 6b5f 7a64  zdt_10 | mask_zd
+000025b0: 745f 7374 207c 206d 6173 6b5f 7a64 745f  t_st | mask_zdt_
+000025c0: 6e61 6e29 2e61 7374 7970 6528 6e70 2e69  nan).astype(np.i
+000025d0: 6e74 3332 290a 2020 2020 6466 5f6d 6173  nt32).    df_mas
+000025e0: 6b5b 274d 4153 4b27 5d20 3d20 6466 5f6d  k['MASK'] = df_m
+000025f0: 6173 6b5b 274d 4153 4b5f 4b4a 5927 5d20  ask['MASK_KJY'] 
+00002600: 2620 6466 5f6d 6173 6b5b 274d 4153 4b5f  & df_mask['MASK_
+00002610: 5a44 5427 5d0a 2020 2020 636f 6c73 5f6d  ZDT'].    cols_m
+00002620: 6173 6b20 3d20 5b27 4d41 534b 5f53 5427  ask = ['MASK_ST'
+00002630: 2c20 274d 4153 4b5f 4b4a 5927 2c20 274d  , 'MASK_KJY', 'M
+00002640: 4153 4b5f 5a44 5427 2c20 274d 4153 4b27  ASK_ZDT', 'MASK'
+00002650: 5d0a 2020 2020 6462 2e63 6c6f 7365 2829  ].    db.close()
+00002660: 0a20 2020 2072 6574 7572 6e20 6466 5f6d  .    return df_m
+00002670: 6173 6b2c 2063 6f6c 735f 6d61 736b 0a0a  ask, cols_mask..
+00002680: 636c 6173 7320 4261 7365 4461 7461 2829  class BaseData()
+00002690: 3a0a 2020 2020 6465 6620 6765 745f 6466  :.    def get_df
+000026a0: 2873 656c 662c 2070 6174 685f 696e 7075  (self, path_inpu
+000026b0: 742c 2064 6174 655f 6265 6769 6e2c 2064  t, date_begin, d
+000026c0: 6174 655f 656e 642c 206e 5f6a 6f62 7329  ate_end, n_jobs)
+000026d0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+000026e0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+000026f0: 726f 7228 2779 6f75 206e 6565 6420 746f  ror('you need to
+00002700: 2069 6d70 6c65 6d65 6e74 2067 6574 5f64   implement get_d
+00002710: 6628 2927 290a 0a20 2020 2064 6566 206c  f()')..    def l
+00002720: 6f61 6428 7365 6c66 2c20 6461 7461 5f63  oad(self, data_c
+00002730: 6f6e 6669 672c 2064 6620 3d20 4e6f 6e65  onfig, df = None
+00002740: 2c20 7665 7262 6f73 6520 3d20 5472 7565  , verbose = True
+00002750: 293a 0a20 2020 2020 2020 2023 2069 6e70  ):.        # inp
+00002760: 7574 0a20 2020 2020 2020 2070 6174 685f  ut.        path_
+00002770: 696e 7075 7420 3d20 434f 4e53 542e 5041  input = CONST.PA
+00002780: 5448 5f44 4154 410a 2020 2020 2020 2020  TH_DATA.        
+00002790: 6461 7465 5f64 6963 7420 3d20 6461 7461  date_dict = data
+000027a0: 5f63 6f6e 6669 675b 2764 6174 655f 6469  _config['date_di
+000027b0: 6374 275d 0a20 2020 2020 2020 206e 5f6a  ct'].        n_j
+000027c0: 6f62 7320 3d20 6461 7461 5f63 6f6e 6669  obs = data_confi
+000027d0: 675b 276e 5f6a 6f62 7327 5d0a 0a20 2020  g['n_jobs']..   
+000027e0: 2020 2020 2063 6f6c 735f 6469 6374 203d       cols_dict =
+000027f0: 2064 6174 615f 636f 6e66 6967 5b27 636f   data_config['co
+00002800: 6c73 5f64 6963 7427 5d0a 2020 2020 2020  ls_dict'].      
+00002810: 2020 6f74 6865 725f 696e 666f 203d 2064    other_info = d
+00002820: 6174 615f 636f 6e66 6967 5b27 6f74 6865  ata_config['othe
+00002830: 725f 696e 666f 275d 0a0a 2020 2020 2020  r_info']..      
+00002840: 2020 636f 6c5f 6964 203d 2063 6f6c 735f    col_id = cols_
+00002850: 6469 6374 5b27 636f 6c5f 6964 275d 0a20  dict['col_id']. 
+00002860: 2020 2020 2020 2063 6f6c 5f6c 6162 656c         col_label
+00002870: 203d 2063 6f6c 735f 6469 6374 5b27 636f   = cols_dict['co
+00002880: 6c5f 6c61 6265 6c27 5d0a 2020 2020 2020  l_label'].      
+00002890: 2020 636f 6c73 5f74 6964 203d 2063 6f6c    cols_tid = col
+000028a0: 735f 6469 6374 5b27 636f 6c73 5f74 6964  s_dict['cols_tid
+000028b0: 275d 0a20 2020 2020 2020 2063 6f6c 5f74  '].        col_t
+000028c0: 6964 203d 2063 6f6c 735f 6469 6374 5b27  id = cols_dict['
+000028d0: 636f 6c5f 7469 6427 5d0a 2020 2020 2020  col_tid'].      
+000028e0: 2020 0a20 2020 2020 2020 2023 2064 6d0a    .        # dm.
+000028f0: 2020 2020 2020 2020 6966 2064 6620 6973          if df is
+00002900: 204e 6f6e 653a 2064 6620 3d20 7365 6c66   None: df = self
+00002910: 2e67 6574 5f64 6628 7061 7468 5f69 6e70  .get_df(path_inp
+00002920: 7574 2c20 2a64 6174 655f 6469 6374 5b27  ut, *date_dict['
+00002930: 616c 6c27 5d2c 206e 5f6a 6f62 732c 2076  all'], n_jobs, v
+00002940: 6572 626f 7365 203d 206f 7468 6572 5f69  erbose = other_i
+00002950: 6e66 6f2e 6765 7428 2776 6572 626f 7365  nfo.get('verbose
+00002960: 272c 2054 7275 6529 2920 2320 6d61 736b  ', True)) # mask
+00002970: 5f61 6c6c 0a20 2020 2020 2020 2069 6620  _all.        if 
+00002980: 2744 6174 614d 6173 7465 7227 2069 6e20  'DataMaster' in 
+00002990: 7374 7228 7479 7065 2864 6629 293a 2064  str(type(df)): d
+000029a0: 6d20 3d20 6466 0a20 2020 2020 2020 2065  m = df.        e
+000029b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000029c0: 2064 662e 7265 7365 745f 696e 6465 7828   df.reset_index(
+000029d0: 6472 6f70 203d 2054 7275 652c 2069 6e70  drop = True, inp
+000029e0: 6c61 6365 203d 2054 7275 6529 2023 2054  lace = True) # T
+000029f0: 4f44 4f20 7265 7365 745f 696e 6465 780a  ODO reset_index.
+00002a00: 2020 2020 2020 2020 2020 2020 646d 203d              dm =
+00002a10: 2044 6174 614d 6173 7465 7228 6466 2c20   DataMaster(df, 
+00002a20: 7665 7262 6f73 6520 3d20 4661 6c73 652c  verbose = False,
+00002a30: 206b 6565 705f 7370 6163 6520 3d20 5472   keep_space = Tr
+00002a40: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+00002a50: 2320 646d 2e73 6f72 745f 7661 6c75 6573  # dm.sort_values
+00002a60: 2863 6f6c 735f 7469 6420 2b20 5b63 6f6c  (cols_tid + [col
+00002a70: 5f69 645d 2920 2320 736f 7274 2c20 544f  _id]) # sort, TO
+00002a80: 444f 0a20 2020 2020 2020 2064 6d2e 6665  DO.        dm.fe
+00002a90: 5f67 6f28 5b63 6f6c 5f74 6964 5d2c 2076  _go([col_tid], v
+00002aa0: 6572 626f 7365 203d 2046 616c 7365 290a  erbose = False).
+00002ab0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00002ac0: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
+00002ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002ae0: 2d20 6c61 6265 6c20 2d2d 2d2d 2d2d 2d2d  - label --------
+00002af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002b00: 2d2d 2d2d 2d2d 2054 4f44 4f0a 2020 2020  ------ TODO.    
+00002b10: 2020 2020 6966 2076 6572 626f 7365 3a20      if verbose: 
+00002b20: 7072 696e 7428 275b 696e 6974 5d20 3c2d  print('[init] <-
+00002b30: 2d2d 2d2d 2d2d 2d2d 2d20 6c61 6265 6c20  --------- label 
+00002b40: 2d2d 2d2d 2d2d 2d2d 2d2d 3e20 2729 0a20  ----------> '). 
+00002b50: 2020 2020 2020 2063 6f6c 203d 2066 2772         col = f'r
+00002b60: 6f6c 6c28 7368 6966 742c 207b 636f 6c5f  oll(shift, {col_
+00002b70: 6964 7d2c 2063 6c6f 7365 2c20 207b 636f  id}, close,  {co
+00002b80: 6c5f 7469 647d 2c20 3129 270a 2020 2020  l_tid}, 1)'.    
+00002b90: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
+00002ba0: 4144 4a20 3d20 6469 7628 7b63 6f6c 7d2c  ADJ = div({col},
+00002bb0: 2070 7265 5f63 6c6f 7365 2927 5d2c 2076   pre_close)'], v
+00002bc0: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
+00002bd0: 290a 2020 2020 2020 2020 646d 2e64 726f  ).        dm.dro
+00002be0: 7028 5b63 6f6c 5d2c 2076 6572 626f 7365  p([col], verbose
+00002bf0: 203d 2046 616c 7365 290a 2020 2020 2020   = False).      
+00002c00: 2020 2320 6261 7369 6320 636f 6c75 6d6e    # basic column
+00002c10: 730a 2020 2020 2020 2020 6e61 6d65 5f6c  s.        name_l
+00002c20: 6973 7420 3d20 5b0a 2020 2020 2020 2020  ist = [.        
+00002c30: 2020 2020 6627 7677 6170 203d 2064 6976      f'vwap = div
+00002c40: 2861 6d6f 756e 742c 2076 6f6c 2927 2c0a  (amount, vol)',.
+00002c50: 2020 2020 2020 2020 2020 2020 6627 6d65              f'me
+00002c60: 616e 203d 206d 6561 6e5f 6d28 6f70 656e  an = mean_m(open
+00002c70: 2c20 6869 6768 2c20 6c6f 772c 2063 6c6f  , high, low, clo
+00002c80: 7365 2927 2c0a 2020 2020 2020 2020 5d0a  se)',.        ].
+00002c90: 2020 2020 2020 2020 6966 2027 7477 6170          if 'twap
+00002ca0: 2720 6e6f 7420 696e 2064 6d2e 6865 6164  ' not in dm.head
+00002cb0: 2829 2e63 6f6c 756d 6e73 3a20 6e61 6d65  ().columns: name
+00002cc0: 5f6c 6973 7420 2b3d 205b 6627 7477 6170  _list += [f'twap
+00002cd0: 203d 206f 2876 7761 7029 275d 0a20 2020   = o(vwap)'].   
+00002ce0: 2020 2020 2064 6d2e 6665 5f67 6f28 6e61       dm.fe_go(na
+00002cf0: 6d65 5f6c 6973 742c 2076 6572 626f 7365  me_list, verbose
+00002d00: 203d 2046 616c 7365 290a 0a20 2020 2020   = False)..     
+00002d10: 2020 2023 2070 7265 5f78 7878 2c20 7878     # pre_xxx, xx
+00002d20: 785f 7265 740a 2020 2020 2020 2020 6e61  x_ret.        na
+00002d30: 6d65 5f6c 6973 7420 3d20 5b5d 0a20 2020  me_list = [].   
+00002d40: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
+00002d50: 5b27 7477 6170 272c 2027 7677 6170 272c  ['twap', 'vwap',
+00002d60: 2027 6f70 656e 272c 2027 636c 6f73 6527   'open', 'close'
+00002d70: 5d20 2b20 5b27 6d65 616e 275d 3a0a 2020  ] + ['mean']:.  
+00002d80: 2020 2020 2020 2020 2020 6966 2027 7072            if 'pr
+00002d90: 655f 7b63 6f6c 7d27 206e 6f74 2069 6e20  e_{col}' not in 
+00002da0: 646d 2e68 6561 6428 292e 636f 6c75 6d6e  dm.head().column
+00002db0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00002dc0: 2020 206e 616d 655f 6c69 7374 202b 3d20     name_list += 
+00002dd0: 5b66 2770 7265 5f7b 636f 6c7d 203d 2072  [f'pre_{col} = r
+00002de0: 6f6c 6c28 7368 6966 742c 207b 636f 6c5f  oll(shift, {col_
+00002df0: 6964 7d2c 207b 636f 6c7d 2c20 7b63 6f6c  id}, {col}, {col
+00002e00: 5f74 6964 7d2c 2031 2927 5d0a 2020 2020  _tid}, 1)'].    
+00002e10: 2020 2020 2020 2020 6e61 6d65 5f6c 6973          name_lis
+00002e20: 7420 2b3d 205b 6627 7b63 6f6c 7d5f 7265  t += [f'{col}_re
+00002e30: 7420 3d20 7265 7428 7072 655f 7b63 6f6c  t = ret(pre_{col
+00002e40: 7d2c 207b 636f 6c7d 2927 5d0a 2020 2020  }, {col})'].    
+00002e50: 2020 2020 646d 2e66 655f 676f 286e 616d      dm.fe_go(nam
+00002e60: 655f 6c69 7374 2c20 7665 7262 6f73 6520  e_list, verbose 
+00002e70: 3d20 4661 6c73 6529 2020 2020 2020 2020  = False)        
+00002e80: 0a0a 2020 2020 2020 2020 2320 6466 5f6c  ..        # df_l
+00002e90: 6162 656c 5f66 696e 616c 0a20 2020 2020  abel_final.     
+00002ea0: 2020 206c 6162 656c 5f66 726f 6d5f 7374     label_from_st
+00002eb0: 7220 3d20 6f74 6865 725f 696e 666f 2e67  r = other_info.g
+00002ec0: 6574 2827 6c61 6265 6c5f 6672 6f6d 5f73  et('label_from_s
+00002ed0: 7472 272c 2027 2729 0a20 2020 2020 2020  tr', '').       
+00002ee0: 2069 6620 6c65 6e28 6c61 6265 6c5f 6672   if len(label_fr
+00002ef0: 6f6d 5f73 7472 2920 3e20 303a 0a20 2020  om_str) > 0:.   
+00002f00: 2020 2020 2020 2020 2063 6f6c 5f6c 6162           col_lab
+00002f10: 656c 5f66 726f 6d20 3d20 274c 4142 454c  el_from = 'LABEL
+00002f20: 5f46 524f 4d5f 5354 5227 0a20 2020 2020  _FROM_STR'.     
+00002f30: 2020 2020 2020 2063 6f6c 5f6c 6162 656c         col_label
+00002f40: 5f61 7267 735f 6c69 7374 203d 206c 6162  _args_list = lab
+00002f50: 656c 5f66 726f 6d5f 7374 722e 7370 6c69  el_from_str.spli
+00002f60: 7428 275f 5f27 295b 313a 5d0a 2020 2020  t('__')[1:].    
+00002f70: 2020 2020 2020 2020 7061 6464 696e 6720          padding 
+00002f80: 3d20 6e70 2e6d 6178 285b 6e70 2e6d 6178  = np.max([np.max
+00002f90: 2864 6563 6f64 655f 6c61 6265 6c5f 6172  (decode_label_ar
+00002fa0: 6773 2878 295b 313a 335d 2920 666f 7220  gs(x)[1:3]) for 
+00002fb0: 7820 696e 2063 6f6c 5f6c 6162 656c 5f61  x in col_label_a
+00002fc0: 7267 735f 6c69 7374 5d29 0a20 2020 2020  rgs_list]).     
+00002fd0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00002fe0: 2020 2020 2063 6f6c 5f6c 6162 656c 5f66       col_label_f
+00002ff0: 726f 6d20 3d20 636f 6c5f 6c61 6265 6c5f  rom = col_label_
+00003000: 6172 6773 5f32 5f6e 616d 6528 6f74 6865  args_2_name(othe
+00003010: 725f 696e 666f 5b27 636f 6c5f 6c61 6265  r_info['col_labe
+00003020: 6c5f 6172 6773 275d 290a 2020 2020 2020  l_args']).      
+00003030: 2020 2020 2020 636f 6c5f 6c61 6265 6c5f        col_label_
+00003040: 6172 6773 5f6c 6973 7420 3d20 5b6f 7468  args_list = [oth
+00003050: 6572 5f69 6e66 6f5b 2763 6f6c 5f6c 6162  er_info['col_lab
+00003060: 656c 5f61 7267 7327 5d5d 0a20 2020 2020  el_args']].     
+00003070: 2020 2020 2020 2070 6164 6469 6e67 203d         padding =
+00003080: 206e 702e 6d61 7828 5b69 6e74 2878 2920   np.max([int(x) 
+00003090: 666f 7220 7820 696e 2063 6f6c 5f6c 6162  for x in col_lab
+000030a0: 656c 5f66 726f 6d2e 7370 6c69 7428 275f  el_from.split('_
+000030b0: 2729 5b32 3a34 5d5d 2920 2320 7061 6464  ')[2:4]]) # padd
+000030c0: 696e 6720 6b20 6461 7973 0a20 2020 2020  ing k days.     
+000030d0: 2020 2063 6f6c 5f6c 6162 656c 5f61 7267     col_label_arg
+000030e0: 735f 6c69 7374 202b 3d20 6f74 6865 725f  s_list += other_
+000030f0: 696e 666f 2e67 6574 2827 636f 6c5f 6c61  info.get('col_la
+00003100: 6265 6c5f 6172 6773 5f6c 6973 7427 2c20  bel_args_list', 
+00003110: 5b5d 290a 2020 2020 2020 2020 636f 6c5f  []).        col_
+00003120: 6c61 6265 6c5f 6172 6773 5f6c 6973 7420  label_args_list 
+00003130: 3d20 5b64 6563 6f64 655f 6c61 6265 6c5f  = [decode_label_
+00003140: 6172 6773 2878 2920 666f 7220 7820 696e  args(x) for x in
+00003150: 2063 6f6c 5f6c 6162 656c 5f61 7267 735f   col_label_args_
+00003160: 6c69 7374 5d0a 2020 2020 2020 2020 636f  list].        co
+00003170: 6c5f 6c61 6265 6c5f 6172 6773 5f6c 6973  l_label_args_lis
+00003180: 7420 3d20 6c69 7374 2870 642e 5365 7269  t = list(pd.Seri
+00003190: 6573 2863 6f6c 5f6c 6162 656c 5f61 7267  es(col_label_arg
+000031a0: 735f 6c69 7374 292e 6472 6f70 5f64 7570  s_list).drop_dup
+000031b0: 6c69 6361 7465 7328 2929 0a20 2020 2020  licates()).     
+000031c0: 2020 206f 7468 6572 5f69 6e66 6f5b 2763     other_info['c
+000031d0: 6f6c 5f6c 6162 656c 5f61 7267 735f 6c69  ol_label_args_li
+000031e0: 7374 275d 203d 2063 6f6c 5f6c 6162 656c  st'] = col_label
+000031f0: 5f61 7267 735f 6c69 7374 0a20 2020 2020  _args_list.     
+00003200: 2020 206f 7468 6572 5f69 6e66 6f5b 2763     other_info['c
+00003210: 6f6c 5f6c 6162 656c 5f66 726f 6d27 5d20  ol_label_from'] 
+00003220: 203d 2063 6f6c 5f6c 6162 656c 5f66 726f   = col_label_fro
+00003230: 6d0a 2020 2020 2020 2020 0a20 2020 2020  m.        .     
+00003240: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00003250: 7269 6e74 2866 275b 2b5d 206c 6162 656c  rint(f'[+] label
+00003260: 5f66 726f 6d5f 7374 7220 3d20 7b6c 6162  _from_str = {lab
+00003270: 656c 5f66 726f 6d5f 7374 727d 2c20 636f  el_from_str}, co
+00003280: 6c5f 6c61 6265 6c5f 6672 6f6d 203d 207b  l_label_from = {
+00003290: 636f 6c5f 6c61 6265 6c5f 6672 6f6d 7d27  col_label_from}'
+000032a0: 290a 2020 2020 2020 2020 6966 2076 6572  ).        if ver
+000032b0: 626f 7365 3a20 7072 696e 7428 6627 5b2b  bose: print(f'[+
+000032c0: 5d20 636f 6c5f 6c61 6265 6c5f 6172 6773  ] col_label_args
+000032d0: 5f6c 6973 7420 3d20 7b63 6f6c 5f6c 6162  _list = {col_lab
+000032e0: 656c 5f61 7267 735f 6c69 7374 7d27 290a  el_args_list}').
+000032f0: 0a20 2020 2020 2020 2063 6f6c 735f 7072  .        cols_pr
+00003300: 6963 6520 3d20 5b78 5b30 5d20 666f 7220  ice = [x[0] for 
+00003310: 7820 696e 2063 6f6c 5f6c 6162 656c 5f61  x in col_label_a
+00003320: 7267 735f 6c69 7374 5d20 2b20 5b78 5b2d  rgs_list] + [x[-
+00003330: 315d 2066 6f72 2078 2069 6e20 636f 6c5f  1] for x in col_
+00003340: 6c61 6265 6c5f 6172 6773 5f6c 6973 7420  label_args_list 
+00003350: 6966 2074 7970 6528 785b 2d31 5d29 2069  if type(x[-1]) i
+00003360: 7320 7374 725d 0a20 2020 2020 2020 2063  s str].        c
+00003370: 6f6c 735f 7072 6963 6520 3d20 6c69 7374  ols_price = list
+00003380: 2870 642e 5365 7269 6573 2863 6f6c 735f  (pd.Series(cols_
+00003390: 7072 6963 6529 2e64 726f 705f 6475 706c  price).drop_dupl
+000033a0: 6963 6174 6573 2829 290a 2020 2020 2020  icates()).      
+000033b0: 2020 6466 203d 2064 6d2e 6765 745f 636f    df = dm.get_co
+000033c0: 6c73 5f70 616e 6461 7328 5b63 6f6c 5f74  ls_pandas([col_t
+000033d0: 6964 2c20 636f 6c5f 6964 5d20 2b20 636f  id, col_id] + co
+000033e0: 6c73 5f70 7269 6365 202b 205b 2741 444a  ls_price + ['ADJ
+000033f0: 275d 290a 2020 2020 2020 2020 6466 5f6c  ']).        df_l
+00003400: 6162 656c 5f66 696e 616c 2c20 636f 6c73  abel_final, cols
+00003410: 5f6c 6162 656c 203d 2067 6574 5f64 665f  _label = get_df_
+00003420: 6c61 6265 6c5f 6669 6e61 6c28 6466 2c20  label_final(df, 
+00003430: 636f 6c5f 7469 642c 2063 6f6c 5f69 642c  col_tid, col_id,
+00003440: 2063 6f6c 735f 7072 6963 652c 2063 6f6c   cols_price, col
+00003450: 5f6c 6162 656c 5f61 7267 735f 6c69 7374  _label_args_list
+00003460: 2c20 6c61 6265 6c5f 6672 6f6d 5f73 7472  , label_from_str
+00003470: 2c20 7665 7262 6f73 6520 3d20 6f74 6865  , verbose = othe
+00003480: 725f 696e 666f 2e67 6574 2827 7665 7262  r_info.get('verb
+00003490: 6f73 6527 2c20 5472 7565 2929 0a20 2020  ose', True)).   
+000034a0: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
+000034b0: 636f 6c73 5f6c 6162 656c 3a20 646d 2e73  cols_label: dm.s
+000034c0: 6574 5f62 795f 636f 6c28 636f 6c2c 2064  et_by_col(col, d
+000034d0: 665f 6c61 6265 6c5f 6669 6e61 6c5b 636f  f_label_final[co
+000034e0: 6c5d 290a 2020 2020 2020 2020 636f 6c73  l]).        cols
+000034f0: 5f6c 6162 656c 202b 3d20 5b27 4c41 4245  _label += ['LABE
+00003500: 4c5f 5241 5727 5d0a 2020 2020 2020 2020  L_RAW'].        
+00003510: 6966 2027 6c61 6265 6c27 2069 6e20 646d  if 'label' in dm
+00003520: 2e68 6561 6428 292e 636f 6c75 6d6e 733a  .head().columns:
+00003530: 2063 6f6c 735f 6c61 6265 6c20 2b3d 205b   cols_label += [
+00003540: 276c 6162 656c 275d 0a20 2020 2020 2020  'label'].       
+00003550: 2064 6174 615f 636f 6e66 6967 5b27 636f   data_config['co
+00003560: 6c73 5f64 6963 7427 5d5b 2763 6f6c 735f  ls_dict']['cols_
+00003570: 6c61 6265 6c27 5d20 3d20 636f 6c73 5f6c  label'] = cols_l
+00003580: 6162 656c 0a20 2020 2020 2020 2069 6620  abel.        if 
+00003590: 7665 7262 6f73 653a 2070 7269 6e74 2866  verbose: print(f
+000035a0: 275b 2b5d 2063 6f6c 735f 6c61 6265 6c20  '[+] cols_label 
+000035b0: 3d20 7b63 6f6c 735f 6c61 6265 6c7d 2729  = {cols_label}')
+000035c0: 0a0a 2020 2020 2020 2020 2320 665f 6c61  ..        # f_la
+000035d0: 6265 6c5f 7072 650a 2020 2020 2020 2020  bel_pre.        
+000035e0: 665f 6c61 6265 6c5f 7072 6520 3d20 6f74  f_label_pre = ot
+000035f0: 6865 725f 696e 666f 2e67 6574 2827 665f  her_info.get('f_
+00003600: 6c61 6265 6c5f 7072 6527 2c20 4e6f 6e65  label_pre', None
+00003610: 290a 2020 2020 2020 2020 6966 2076 6572  ).        if ver
+00003620: 626f 7365 3a20 7072 696e 7428 6627 5b2b  bose: print(f'[+
+00003630: 5d20 665f 6c61 6265 6c5f 7072 6520 3d20  ] f_label_pre = 
+00003640: 7b66 5f6c 6162 656c 5f70 7265 7d2c 2063  {f_label_pre}, c
+00003650: 6f6c 5f6c 6162 656c 5f66 726f 6d20 3d20  ol_label_from = 
+00003660: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
+00003670: 2729 0a20 2020 2020 2020 2069 6620 665f  ').        if f_
+00003680: 6c61 6265 6c5f 7072 6520 3d3d 2027 6373  label_pre == 'cs
+00003690: 7a73 636f 7265 273a 2023 2066 5f6c 6162  zscore': # f_lab
+000036a0: 656c 5f70 7265 0a20 2020 2020 2020 2020  el_pre.         
+000036b0: 2020 2064 6d2e 6665 5f67 6f28 5b66 274c     dm.fe_go([f'L
+000036c0: 4142 454c 5f52 4157 203d 206f 287b 636f  ABEL_RAW = o({co
+000036d0: 6c5f 6c61 6265 6c5f 6672 6f6d 7d29 275d  l_label_from})']
+000036e0: 2c20 7665 7262 6f73 6520 3d20 7665 7262  , verbose = verb
+000036f0: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
+00003700: 2064 6d2e 6665 5f67 6f28 5b66 277b 636f   dm.fe_go([f'{co
+00003710: 6c5f 6c61 6265 6c7d 203d 2061 6767 287a  l_label} = agg(z
+00003720: 7363 6f72 652c 207b 636f 6c5f 7469 647d  score, {col_tid}
+00003730: 2c20 7b63 6f6c 5f6c 6162 656c 5f66 726f  , {col_label_fro
+00003740: 6d7d 2927 5d2c 2076 6572 626f 7365 203d  m})'], verbose =
+00003750: 2076 6572 626f 7365 2920 2320 544f 444f   verbose) # TODO
+00003760: 3f20 6d61 736b 203f 200a 2020 2020 2020  ? mask ? .      
+00003770: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00003780: 2020 2023 207a 7363 6f72 6520 666f 7220     # zscore for 
+00003790: 616c 6c20 4c41 4245 4c0a 2020 2020 2020  all LABEL.      
+000037a0: 2020 2020 2020 6e61 6d65 5f6c 6973 7420        name_list 
+000037b0: 3d20 5b66 2761 6767 287a 7363 6f72 652c  = [f'agg(zscore,
+000037c0: 207b 636f 6c5f 7469 647d 2c20 7b63 6f6c   {col_tid}, {col
+000037d0: 7d29 2720 666f 7220 636f 6c20 696e 2063  })' for col in c
+000037e0: 6f6c 735f 6c61 6265 6c20 6966 2063 6f6c  ols_label if col
+000037f0: 206e 6f74 2069 6e20 5b27 4c41 4245 4c5f   not in ['LABEL_
+00003800: 5241 5727 5d5d 0a20 2020 2020 2020 2020  RAW']].         
+00003810: 2020 2064 6d2e 6665 5f67 6f28 6e61 6d65     dm.fe_go(name
+00003820: 5f6c 6973 742c 2076 6572 626f 7365 203d  _list, verbose =
+00003830: 2076 6572 626f 7365 2c20 6b65 6570 5f6e   verbose, keep_n
+00003840: 616d 6520 3d20 3229 0a20 2020 2020 2020  ame = 2).       
+00003850: 2065 6c69 6620 665f 6c61 6265 6c5f 7072   elif f_label_pr
+00003860: 6520 3d3d 2027 6f72 6967 696e 273a 0a20  e == 'origin':. 
+00003870: 2020 2020 2020 2020 2020 2064 6d2e 6665             dm.fe
+00003880: 5f67 6f28 5b66 274c 4142 454c 5f52 4157  _go([f'LABEL_RAW
+00003890: 203d 206f 287b 636f 6c5f 6c61 6265 6c5f   = o({col_label_
+000038a0: 6672 6f6d 7d29 275d 2c20 7665 7262 6f73  from})'], verbos
+000038b0: 6520 3d20 7665 7262 6f73 6529 0a20 2020  e = verbose).   
+000038c0: 2020 2020 2020 2020 2064 6d2e 6665 5f67           dm.fe_g
+000038d0: 6f28 5b66 277b 636f 6c5f 6c61 6265 6c7d  o([f'{col_label}
+000038e0: 203d 206f 287b 636f 6c5f 6c61 6265 6c5f   = o({col_label_
+000038f0: 6672 6f6d 7d29 275d 2c20 7665 7262 6f73  from})'], verbos
+00003900: 6520 3d20 7665 7262 6f73 6529 0a20 2020  e = verbose).   
+00003910: 2020 2020 2065 6c69 6620 665f 6c61 6265       elif f_labe
+00003920: 6c5f 7072 6520 3d3d 2027 6578 6973 7427  l_pre == 'exist'
+00003930: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00003940: 2076 6572 626f 7365 3a20 7072 696e 7428   verbose: print(
+00003950: 6627 5b2b 5d20 7261 7720 6c61 6265 6c20  f'[+] raw label 
+00003960: 6672 6f6d 2064 6d2c 2028 7768 6963 6820  from dm, (which 
+00003970: 6d65 616e 2065 7869 7374 2074 6869 7320  mean exist this 
+00003980: 636f 6c75 6d6e 2c20 6c61 6265 6c29 2729  column, label)')
+00003990: 0a20 2020 2020 2020 2020 2020 2064 6d2e  .            dm.
+000039a0: 6665 5f67 6f28 5b66 274c 4142 454c 5f52  fe_go([f'LABEL_R
+000039b0: 4157 203d 206f 287b 636f 6c5f 6c61 6265  AW = o({col_labe
+000039c0: 6c7d 2927 5d2c 2076 6572 626f 7365 203d  l})'], verbose =
+000039d0: 2076 6572 626f 7365 290a 2020 2020 2020   verbose).      
+000039e0: 2020 2020 2020 6173 7365 7274 2063 6f6c        assert col
+000039f0: 5f6c 6162 656c 2069 6e20 646d 2e68 6561  _label in dm.hea
+00003a00: 6428 292e 636f 6c75 6d6e 732c 2027 636f  d().columns, 'co
+00003a10: 6c5f 6c61 6265 6c20 3d20 7b63 6f6c 5f6c  l_label = {col_l
+00003a20: 6162 656c 7d20 6e6f 7420 696e 2064 6d21  abel} not in dm!
+00003a30: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
+00003a40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00003a50: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00003a60: 4572 726f 7228 6627 5b2b 5d20 665f 6c61  Error(f'[+] f_la
+00003a70: 6265 6c5f 7072 6520 3d20 7b66 5f6c 6162  bel_pre = {f_lab
+00003a80: 656c 5f70 7265 7d27 290a 2020 2020 2020  el_pre}').      
+00003a90: 2020 2320 646d 2e73 6574 5f62 795f 636f    # dm.set_by_co
+00003aa0: 6c28 636f 6c5f 6c61 6265 6c2c 206e 702e  l(col_label, np.
+00003ab0: 636c 6970 2864 6d2e 6765 745f 636f 6c5f  clip(dm.get_col_
+00003ac0: 6e75 6d70 7928 636f 6c5f 6c61 6265 6c29  numpy(col_label)
+00003ad0: 2c20 2d31 302c 2031 3029 2920 2320 544f  , -10, 10)) # TO
+00003ae0: 444f 2063 6c69 700a 0a20 2020 2020 2020  DO clip..       
+00003af0: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
+00003b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003b10: 2d20 6d61 736b 202d 2d2d 2d2d 2d2d 2d2d  - mask ---------
+00003b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003b30: 2d2d 2d2d 2d20 544f 444f 0a20 2020 2020  ----- TODO.     
+00003b40: 2020 2023 2064 665f 6d61 736b 0a20 2020     # df_mask.   
+00003b50: 2020 2020 2069 6620 7665 7262 6f73 653a       if verbose:
+00003b60: 2070 7269 6e74 2827 5b69 6e69 745d 203c   print('[init] <
+00003b70: 2d2d 2d2d 2d2d 2d2d 2d2d 206d 6173 6b20  ---------- mask 
+00003b80: 202d 2d2d 2d2d 2d2d 2d2d 2d3e 2027 290a   ----------> ').
+00003b90: 2020 2020 2020 2020 7061 7468 5f64 6220          path_db 
+00003ba0: 3d20 6627 7b6f 732e 7061 7468 2e64 6972  = f'{os.path.dir
+00003bb0: 6e61 6d65 286f 732e 7061 7468 2e61 6273  name(os.path.abs
+00003bc0: 7061 7468 2870 6174 685f 696e 7075 7429  path(path_input)
+00003bd0: 297d 2f72 7a2e 6462 270a 2020 2020 2020  )}/rz.db'.      
+00003be0: 2020 6966 2076 6572 626f 7365 3a20 7072    if verbose: pr
+00003bf0: 696e 7428 6627 5b2b 5d20 7061 7468 5f64  int(f'[+] path_d
+00003c00: 6220 3d20 7b70 6174 685f 6462 7d27 290a  b = {path_db}').
+00003c10: 2020 2020 2020 2020 6966 206f 732e 7061          if os.pa
+00003c20: 7468 2e65 7869 7374 7328 7061 7468 5f64  th.exists(path_d
+00003c30: 6229 3a0a 2020 2020 2020 2020 2020 2020  b):.            
+00003c40: 6466 5f6d 6173 6b2c 2063 6f6c 735f 6d61  df_mask, cols_ma
+00003c50: 736b 203d 2067 6574 5f64 665f 6d61 736b  sk = get_df_mask
+00003c60: 2870 6174 685f 6462 2c20 646d 2c20 636f  (path_db, dm, co
+00003c70: 6c5f 7469 642c 2063 6f6c 5f69 642c 2076  l_tid, col_id, v
+00003c80: 6572 626f 7365 3d76 6572 626f 7365 290a  erbose=verbose).
+00003c90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00003ca0: 636f 6c20 696e 2063 6f6c 735f 6d61 736b  col in cols_mask
+00003cb0: 3a20 646d 2e73 6574 5f62 795f 636f 6c28  : dm.set_by_col(
+00003cc0: 636f 6c2c 2064 665f 6d61 736b 5b63 6f6c  col, df_mask[col
+00003cd0: 5d29 0a20 2020 2020 2020 2065 6c73 653a  ]).        else:
+00003ce0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00003cf0: 735f 6d61 736b 203d 2063 6f6c 735f 6d61  s_mask = cols_ma
+00003d00: 736b 203d 205b 274d 4153 4b5f 5354 272c  sk = ['MASK_ST',
+00003d10: 2027 4d41 534b 5f4b 4a59 272c 2027 4d41   'MASK_KJY', 'MA
+00003d20: 534b 5f5a 4454 272c 2027 4d41 534b 275d  SK_ZDT', 'MASK']
+00003d30: 0a20 2020 2020 2020 2064 6174 615f 636f  .        data_co
+00003d40: 6e66 6967 5b27 636f 6c73 5f64 6963 7427  nfig['cols_dict'
+00003d50: 5d5b 2763 6f6c 735f 6d61 736b 275d 203d  ]['cols_mask'] =
+00003d60: 2063 6f6c 735f 6d61 736b 0a20 2020 2020   cols_mask.     
+00003d70: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00003d80: 7269 6e74 2866 275b 2b5d 2063 6f6c 735f  rint(f'[+] cols_
+00003d90: 6d61 736b 203d 207b 636f 6c73 5f6d 6173  mask = {cols_mas
+00003da0: 6b7d 2729 0a0a 2020 2020 2020 2020 2320  k}')..        # 
+00003db0: 6b6a 7920 2620 7a64 740a 2020 2020 2020  kjy & zdt.      
+00003dc0: 2020 6578 6973 745f 6d61 736b 203d 2028    exist_mask = (
+00003dd0: 274d 4153 4b5f 4b4a 5927 2069 6e20 646d  'MASK_KJY' in dm
+00003de0: 2e68 6561 6428 292e 636f 6c75 6d6e 7329  .head().columns)
+00003df0: 2061 6e64 2028 274d 4153 4b5f 5a44 5427   and ('MASK_ZDT'
+00003e00: 2069 6e20 646d 2e68 6561 6428 292e 636f   in dm.head().co
+00003e10: 6c75 6d6e 7329 0a20 2020 2020 2020 2069  lumns).        i
+00003e20: 6620 6578 6973 745f 6d61 736b 206f 7220  f exist_mask or 
+00003e30: 6f73 2e70 6174 682e 6578 6973 7473 2870  os.path.exists(p
+00003e40: 6174 685f 6462 293a 0a20 2020 2020 2020  ath_db):.       
+00003e50: 2020 2020 2023 206d 6173 6b20 3d20 31e7       # mask = 1.
+00003e60: 9a84 2c20 6c61 6265 6c2e 6973 6e75 6c6c  .., label.isnull
+00003e70: 2829 e79a 842c 20e4 b8bb e8a6 81e6 98af  ()..., .........
+00003e80: e59b a0e4 b8ba e590 84e7 a78d e581 9ce7  ................
+00003e90: 898c e79a 84e6 8385 e586 b50a 2020 2020  ............    
+00003ea0: 2020 2020 2020 2020 6d61 736b 5f6b 6a79          mask_kjy
+00003eb0: 203d 2028 7e6e 702e 6973 6e61 6e28 646d   = (~np.isnan(dm
+00003ec0: 2e64 665f 6469 6374 5b27 5430 275d 5b63  .df_dict['T0'][c
+00003ed0: 6f6c 5f6c 6162 656c 5d2e 746f 5f6e 756d  ol_label].to_num
+00003ee0: 7079 2829 2929 2e61 7374 7970 6528 6e70  py())).astype(np
+00003ef0: 2e69 6e74 3332 2920 2320 e4bc 9ae5 afbc  .int32) # ......
+00003f00: e887 b4e4 b88d e590 8c6c 6162 656c e4b8  .........label..
+00003f10: 8de4 b880 e6a0 b72c 20e9 bb98 e8ae a46c  ......., ......l
+00003f20: 6162 656c e983 bde7 94a8 7878 782c 302c  abel......xxx,0,
+00003f30: 31e5 90a7 0a20 2020 2020 2020 2020 2020  1....           
+00003f40: 206d 6173 6b5f 6b6a 7920 263d 2064 6d2e   mask_kjy &= dm.
+00003f50: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
+00003f60: 4153 4b5f 4b4a 5927 5d2e 746f 5f6e 756d  ASK_KJY'].to_num
+00003f70: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
+00003f80: 2023 206d 6173 6b5f 6b6a 7920 3d20 646d   # mask_kjy = dm
+00003f90: 2e64 665f 6469 6374 5b27 5430 275d 5b27  .df_dict['T0']['
+00003fa0: 4d41 534b 5f4b 4a59 275d 2e74 6f5f 6e75  MASK_KJY'].to_nu
+00003fb0: 6d70 7928 290a 2020 2020 2020 2020 2020  mpy().          
+00003fc0: 2020 6d61 736b 5f7a 6474 203d 2064 6d2e    mask_zdt = dm.
+00003fd0: 6466 5f64 6963 745b 2754 3027 5d5b 274d  df_dict['T0']['M
+00003fe0: 4153 4b5f 5a44 5427 5d2e 746f 5f6e 756d  ASK_ZDT'].to_num
+00003ff0: 7079 2829 0a20 2020 2020 2020 2065 6c73  py().        els
+00004000: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+00004010: 6173 6b5f 6b6a 7920 3d20 287e 6e70 2e69  ask_kjy = (~np.i
+00004020: 736e 616e 2864 6d2e 6466 5f64 6963 745b  snan(dm.df_dict[
+00004030: 2754 3027 5d5b 636f 6c5f 6c61 6265 6c5d  'T0'][col_label]
+00004040: 2e74 6f5f 6e75 6d70 7928 2929 292e 6173  .to_numpy())).as
+00004050: 7479 7065 286e 702e 696e 7433 3229 0a20  type(np.int32). 
+00004060: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00004070: 6b6a 7920 263d 2028 7e6e 702e 6973 6e61  kjy &= (~np.isna
+00004080: 6e28 646d 2e64 665f 6469 6374 5b27 5430  n(dm.df_dict['T0
+00004090: 275d 5b27 6f70 656e 275d 2e74 6f5f 6e75  ']['open'].to_nu
+000040a0: 6d70 7928 2929 292e 6173 7479 7065 286e  mpy())).astype(n
+000040b0: 702e 696e 7433 3229 0a20 2020 2020 2020  p.int32).       
+000040c0: 2020 2020 2023 206d 6173 6b5f 6b6a 7920       # mask_kjy 
+000040d0: 3d20 287e 6e70 2e69 736e 616e 2864 6d2e  = (~np.isnan(dm.
+000040e0: 6466 5f64 6963 745b 2754 3027 5d5b 276f  df_dict['T0']['o
+000040f0: 7065 6e27 5d2e 746f 5f6e 756d 7079 2829  pen'].to_numpy()
+00004100: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
+00004110: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+00004120: 6d61 736b 5f7a 6474 203d 2064 6d2e 6765  mask_zdt = dm.ge
+00004130: 745f 636f 6c5f 6e75 6d70 7928 276d 6173  t_col_numpy('mas
+00004140: 6b27 2920 3d3d 2031 0a20 2020 2020 2020  k') == 1.       
+00004150: 2064 6d2e 7365 745f 6d61 736b 286d 6173   dm.set_mask(mas
+00004160: 6b5f 6b6a 792e 6173 7479 7065 286e 702e  k_kjy.astype(np.
+00004170: 696e 7433 3229 2c20 276b 6a79 2729 0a20  int32), 'kjy'). 
+00004180: 2020 2020 2020 2064 6d2e 7365 745f 6d61         dm.set_ma
+00004190: 736b 286d 6173 6b5f 7a64 742e 6173 7479  sk(mask_zdt.asty
+000041a0: 7065 286e 702e 696e 7433 3229 2c20 277a  pe(np.int32), 'z
+000041b0: 6474 2729 0a0a 2020 2020 2020 2020 2320  dt')..        # 
+000041c0: 6d61 736b 5f64 726f 700a 2020 2020 2020  mask_drop.      
+000041d0: 2020 6966 2046 616c 7365 2061 6e64 206f    if False and o
+000041e0: 732e 7061 7468 2e65 7869 7374 7328 7061  s.path.exists(pa
+000041f0: 7468 5f64 6229 3a0a 2020 2020 2020 2020  th_db):.        
+00004200: 2020 2020 646d 2e66 655f 676f 285b 6627      dm.fe_go([f'
+00004210: 6770 286d 6561 6e2c 207b 636f 6c5f 7469  gp(mean, {col_ti
+00004220: 647d 2c20 4c41 4245 4c5f 5241 5729 275d  d}, LABEL_RAW)']
+00004230: 290a 2020 2020 2020 2020 2020 2020 6466  ).            df
+00004240: 5f67 7020 3d20 646d 2e67 6574 5f63 6f6c  _gp = dm.get_col
+00004250: 735f 7061 6e64 6173 2864 665f 6e61 6d65  s_pandas(df_name
+00004260: 203d 2066 2754 302e 7b63 6f6c 5f74 6964   = f'T0.{col_tid
+00004270: 7d27 290a 2020 2020 2020 2020 2020 2020  }').            
+00004280: 6461 7465 5f64 726f 7020 3d20 6466 5f67  date_drop = df_g
+00004290: 705b 6466 5f67 705b 6627 6770 286d 6561  p[df_gp[f'gp(mea
+000042a0: 6e2c 207b 636f 6c5f 7469 647d 2c20 4c41  n, {col_tid}, LA
+000042b0: 4245 4c5f 5241 5729 275d 2e61 6273 2829  BEL_RAW)'].abs()
+000042c0: 203e 2030 2e30 335d 5b63 6f6c 5f74 6964   > 0.03][col_tid
+000042d0: 5d2e 7661 6c75 6573 0a20 2020 2020 2020  ].values.       
+000042e0: 2020 2020 2064 6174 655f 6472 6f70 203d       date_drop =
+000042f0: 2064 6174 655f 6472 6f70 5b64 6174 655f   date_drop[date_
+00004300: 6472 6f70 203c 3d20 6461 7465 5f64 6963  drop <= date_dic
+00004310: 745b 2761 6c6c 275d 5b31 5d5d 0a20 2020  t['all'][1]].   
+00004320: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+00004330: 275b 2b5d 2064 6174 655f 6472 6f70 203d  '[+] date_drop =
+00004340: 207b 6c65 6e28 6461 7465 5f64 726f 7029   {len(date_drop)
+00004350: 7d5c 6e64 6174 655f 6472 6f70 203d 205b  }\ndate_drop = [
+00004360: 7b22 2c20 222e 6a6f 696e 2873 7472 2878  {", ".join(str(x
+00004370: 2920 666f 7220 7820 696e 2064 6174 655f  ) for x in date_
+00004380: 6472 6f70 297d 5d27 290a 2020 2020 2020  drop)}]').      
+00004390: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
+000043a0: 3d20 287e 646d 2e67 6574 5f63 6f6c 5f70  = (~dm.get_col_p
+000043b0: 616e 6461 7328 636f 6c5f 7469 6429 2e69  andas(col_tid).i
+000043c0: 7369 6e28 7365 7428 6461 7465 5f64 726f  sin(set(date_dro
+000043d0: 7029 2929 2e76 616c 7565 730a 2020 2020  p))).values.    
+000043e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000043f0: 2020 2020 2020 6d61 736b 5f64 726f 7020        mask_drop 
+00004400: 3d20 6e70 2e6f 6e65 735f 6c69 6b65 286d  = np.ones_like(m
+00004410: 6173 6b5f 6b6a 7929 2e61 7374 7970 6528  ask_kjy).astype(
+00004420: 626f 6f6c 290a 2020 2020 2020 2020 2320  bool).        # 
+00004430: 6d61 736b 0a20 2020 2020 2020 206d 6173  mask.        mas
+00004440: 6b5f 6d61 736b 203d 206d 6173 6b5f 6b6a  k_mask = mask_kj
+00004450: 7920 2620 6d61 736b 5f7a 6474 0a20 2020  y & mask_zdt.   
+00004460: 2020 2020 206d 6173 6b5f 6d61 736b 2026       mask_mask &
+00004470: 3d20 6d61 736b 5f64 726f 700a 2020 2020  = mask_drop.    
+00004480: 2020 2020 646d 2e73 6574 5f6d 6173 6b28      dm.set_mask(
+00004490: 6d61 736b 5f6d 6173 6b2c 2027 6d61 736b  mask_mask, 'mask
+000044a0: 2729 0a20 2020 2020 2020 2064 6d2e 7365  ').        dm.se
+000044b0: 745f 6279 5f63 6f6c 2827 4d41 534b 272c  t_by_col('MASK',
+000044c0: 206d 6173 6b5f 6d61 736b 2920 2320 7570   mask_mask) # up
+000044d0: 6461 7465 206d 6173 6b0a 2020 2020 2020  date mask.      
+000044e0: 2020 6966 2076 6572 626f 7365 3a20 0a20    if verbose: . 
+000044f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00004500: 2866 275b 2b5d 206b 6a79 2020 3d20 7b6d  (f'[+] kjy  = {m
+00004510: 6173 6b5f 6b6a 792e 7375 6d28 297d 202f  ask_kjy.sum()} /
+00004520: 207b 6c65 6e28 6d61 736b 5f6b 6a79 297d   {len(mask_kjy)}
+00004530: 203d 207b 6d61 736b 5f6b 6a79 2e6d 6561   = {mask_kjy.mea
+00004540: 6e28 297d 2729 0a20 2020 2020 2020 2020  n()}').         
+00004550: 2020 2070 7269 6e74 2866 275b 2b5d 207a     print(f'[+] z
+00004560: 6474 2020 3d20 7b6d 6173 6b5f 7a64 742e  dt  = {mask_zdt.
+00004570: 7375 6d28 297d 202f 207b 6c65 6e28 6d61  sum()} / {len(ma
+00004580: 736b 5f7a 6474 297d 203d 207b 6d61 736b  sk_zdt)} = {mask
+00004590: 5f7a 6474 2e6d 6561 6e28 297d 2729 0a20  _zdt.mean()}'). 
+000045a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000045b0: 2866 275b 2b5d 206d 6173 6b20 3d20 7b6d  (f'[+] mask = {m
+000045c0: 6173 6b5f 6d61 736b 2e73 756d 2829 7d20  ask_mask.sum()} 
+000045d0: 2f20 7b6c 656e 286d 6173 6b5f 6d61 736b  / {len(mask_mask
+000045e0: 297d 203d 207b 6d61 736b 5f6d 6173 6b2e  )} = {mask_mask.
+000045f0: 6d65 616e 2829 7d27 290a 2020 2020 2020  mean()}').      
+00004600: 2020 0a20 2020 2020 2020 2023 2066 6f72    .        # for
+00004610: 2074 7261 696e 2076 616c 6964 2020 7465   train valid  te
+00004620: 7374 0a20 2020 2020 2020 2069 6620 2768  st.        if 'h
+00004630: 6973 7427 206e 6f74 2069 6e20 6461 7465  ist' not in date
+00004640: 5f64 6963 742e 6b65 7973 2829 3a0a 2020  _dict.keys():.  
+00004650: 2020 2020 2020 2020 2020 6966 2020 2027            if   '
+00004660: 7472 6169 6e27 2069 6e20 6461 7465 5f64  train' in date_d
+00004670: 6963 742e 6b65 7973 2829 3a20 6461 7465  ict.keys(): date
+00004680: 5f64 6963 745b 2768 6973 7427 5d20 3d20  _dict['hist'] = 
+00004690: 6461 7465 5f64 6963 745b 2774 7261 696e  date_dict['train
+000046a0: 275d 0a20 2020 2020 2020 2020 2020 2065  '].            e
+000046b0: 6c69 6620 276c 6f6f 6b27 2069 6e20 6461  lif 'look' in da
+000046c0: 7465 5f64 6963 742e 6b65 7973 2829 3a20  te_dict.keys(): 
+000046d0: 6461 7465 5f64 6963 745b 2768 6973 7427  date_dict['hist'
+000046e0: 5d20 3d20 6461 7465 5f64 6963 745b 276c  ] = date_dict['l
+000046f0: 6f6f 6b27 5d0a 2020 2020 2020 2020 2020  ook'].          
+00004700: 2020 656c 6966 2027 616c 6c27 2069 6e20    elif 'all' in 
+00004710: 6461 7465 5f64 6963 742e 6b65 7973 2829  date_dict.keys()
+00004720: 3a20 6461 7465 5f64 6963 745b 2768 6973  : date_dict['his
+00004730: 7427 5d20 3d20 6461 7465 5f64 6963 745b  t'] = date_dict[
+00004740: 2761 6c6c 275d 0a20 2020 2020 2020 2020  'all'].         
+00004750: 2020 2065 6c73 653a 2072 6169 7365 204e     else: raise N
+00004760: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00004770: 6f72 2866 2764 6174 655f 6469 6374 203d  or(f'date_dict =
+00004780: 207b 6461 7465 5f64 6963 747d 2c20 6e65   {date_dict}, ne
+00004790: 6564 2068 6973 7427 290a 2020 2020 2020  ed hist').      
+000047a0: 2020 6966 2076 6572 626f 7365 3a20 7072    if verbose: pr
+000047b0: 696e 7428 6627 5b2b 5d20 7061 6464 696e  int(f'[+] paddin
+000047c0: 6720 3d20 7b70 6164 6469 6e67 7d2c 2063  g = {padding}, c
+000047d0: 6f6c 5f6c 6162 656c 5f66 726f 6d20 3d20  ol_label_from = 
+000047e0: 7b63 6f6c 5f6c 6162 656c 5f66 726f 6d7d  {col_label_from}
+000047f0: 2729 0a20 2020 2020 2020 2078 203d 2064  ').        x = d
+00004800: 6d2e 6466 5f64 6963 745b 2754 3027 5d5b  m.df_dict['T0'][
+00004810: 636f 6c5f 7469 645d 2e74 6f5f 6e75 6d70  col_tid].to_nump
+00004820: 7928 290a 2020 2020 2020 2020 666f 7220  y().        for 
+00004830: 6b65 7920 696e 2064 6174 655f 6469 6374  key in date_dict
+00004840: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00004850: 2020 2020 2064 6174 655f 6265 6769 6e2c       date_begin,
+00004860: 2064 6174 655f 656e 6420 3d20 6461 7465   date_end = date
+00004870: 5f64 6963 745b 6b65 795d 0a20 2020 2020  _dict[key].     
+00004880: 2020 2020 2020 2069 6620 6b65 7920 696e         if key in
+00004890: 205b 2774 7261 696e 272c 2027 6869 7374   ['train', 'hist
+000048a0: 275d 3a20 2320 e59c a8e5 8e9f e69c 8964  ']: # .........d
+000048b0: 6174 655f 656e 64e7 9a84 e59f bae7 a180  ate_end.........
+000048c0: e4b8 8a2c 20e5 868d e58e bbe6 8e89 7061  ..., .........pa
+000048d0: 6464 696e 67e5 a4a9 0a20 2020 2020 2020  dding....       
+000048e0: 2020 2020 2020 2020 2078 5f75 6e69 7175           x_uniqu
+000048f0: 6520 3d20 6e70 2e75 6e69 7175 6528 7829  e = np.unique(x)
+00004900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004910: 2064 6174 655f 656e 6420 3d20 6e70 2e73   date_end = np.s
+00004920: 6f72 7428 785f 756e 6971 7565 5b78 5f75  ort(x_unique[x_u
+00004930: 6e69 7175 6520 3c3d 2064 6174 655f 656e  nique <= date_en
+00004940: 645d 295b 2d28 3120 2b20 7061 6464 696e  d])[-(1 + paddin
+00004950: 6729 5d0a 2020 2020 2020 2020 2020 2020  g)].            
+00004960: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+00004970: 6b20 3d20 2028 7820 3e3d 2064 6174 655f  k =  (x >= date_
+00004980: 6265 6769 6e29 2026 2028 7820 3c3d 2064  begin) & (x <= d
+00004990: 6174 655f 656e 6429 0a20 2020 2020 2020  ate_end).       
+000049a0: 2020 2020 2069 6620 6b65 7920 213d 2027       if key != '
+000049b0: 7465 7374 273a 0a20 2020 2020 2020 2020  test':.         
+000049c0: 2020 2020 2020 206d 6173 6b20 263d 206d         mask &= m
+000049d0: 6173 6b5f 6d61 736b 2e61 7374 7970 6528  ask_mask.astype(
+000049e0: 626f 6f6c 290a 2020 2020 2020 2020 2020  bool).          
+000049f0: 2020 646d 2e73 6574 5f6d 6173 6b28 6d61    dm.set_mask(ma
+00004a00: 736b 2c20 6d61 736b 5f6e 616d 6520 3d20  sk, mask_name = 
+00004a10: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+00004a20: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
+00004a30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00004a40: 6c65 6e28 785b 6d61 736b 5d29 203e 2030  len(x[mask]) > 0
+00004a50: 3a20 7072 696e 7428 6627 5b2b 5d20 6d61  : print(f'[+] ma
+00004a60: 736b 5f6e 616d 6520 3d20 7b6b 6579 3a3c  sk_name = {key:<
+00004a70: 3131 7d7c 207b 785b 6d61 736b 5d2e 6d69  11}| {x[mask].mi
+00004a80: 6e28 297d 202d 3e20 7b78 5b6d 6173 6b5d  n()} -> {x[mask]
+00004a90: 2e6d 6178 2829 7d20 3d20 7b6d 6173 6b2e  .max()} = {mask.
+00004aa0: 7375 6d28 297d 2729 0a20 2020 2020 2020  sum()}').       
+00004ab0: 2020 2020 2020 2020 2065 6c73 653a 2070           else: p
+00004ac0: 7269 6e74 2866 275b 2b5d 206d 6173 6b5f  rint(f'[+] mask_
+00004ad0: 6e61 6d65 203d 207b 6b65 793a 3c31 317d  name = {key:<11}
+00004ae0: 7c20 6c65 6e20 3d20 3027 290a 2020 2020  | len = 0').    
+00004af0: 2020 2020 0a20 2020 2020 2020 2023 2073      .        # s
+00004b00: 6869 6674 5f31 0a20 2020 2020 2020 2069  hift_1.        i
+00004b10: 6620 7665 7262 6f73 653a 2070 7269 6e74  f verbose: print
+00004b20: 2827 5b69 6e69 745d 203c 2d2d 2d2d 2d2d  ('[init] <------
+00004b30: 2d2d 2d2d 2073 6869 6674 5f69 202d 2d2d  ---- shift_i ---
+00004b40: 2d2d 2d2d 2d2d 2d3e 2027 290a 2020 2020  -------> ').    
+00004b50: 2020 2020 7368 6966 745f 6920 3d20 6f74      shift_i = ot
+00004b60: 6865 725f 696e 666f 2e67 6574 2827 7368  her_info.get('sh
+00004b70: 6966 745f 6927 2c20 3129 0a20 2020 2020  ift_i', 1).     
+00004b80: 2020 2069 6620 7665 7262 6f73 653a 2070     if verbose: p
+00004b90: 7269 6e74 2866 275b 2b5d 2073 6869 6674  rint(f'[+] shift
+00004ba0: 5f69 203d 207b 7368 6966 745f 697d 2729  _i = {shift_i}')
+00004bb0: 0a20 2020 2020 2020 2063 6f6c 735f 7368  .        cols_sh
+00004bc0: 6966 745f 315f 6e6f 7420 3d20 5b63 6f6c  ift_1_not = [col
+00004bd0: 5f69 642c 2063 6f6c 5f74 6964 2c20 636f  _id, col_tid, co
+00004be0: 6c5f 6c61 6265 6c5d 202b 2063 6f6c 735f  l_label] + cols_
+00004bf0: 7469 6420 2b20 636f 6c73 5f6c 6162 656c  tid + cols_label
+00004c00: 202b 2063 6f6c 735f 6d61 736b 202b 205b   + cols_mask + [
+00004c10: 6f74 6865 725f 696e 666f 2e67 6574 2827  other_info.get('
+00004c20: 636f 6c5f 6461 7465 272c 204e 6f6e 6529  col_date', None)
+00004c30: 5d0a 2020 2020 2020 2020 636f 6c73 5f73  ].        cols_s
+00004c40: 6869 6674 5f31 5f6e 6f74 202b 3d20 6f74  hift_1_not += ot
+00004c50: 6865 725f 696e 666f 2e67 6574 2827 636f  her_info.get('co
+00004c60: 6c73 5f73 6869 6674 5f31 5f6e 6f74 272c  ls_shift_1_not',
+00004c70: 205b 5d29 0a20 2020 2020 2020 206f 7468   []).        oth
+00004c80: 6572 5f69 6e66 6f5b 2763 6f6c 735f 7368  er_info['cols_sh
+00004c90: 6966 745f 315f 6e6f 7427 5d20 3d20 636f  ift_1_not'] = co
+00004ca0: 6c73 5f73 6869 6674 5f31 5f6e 6f74 0a20  ls_shift_1_not. 
+00004cb0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+00004cc0: 653a 2070 7269 6e74 2866 275b 2b5d 2063  e: print(f'[+] c
+00004cd0: 6f6c 735f 7368 6966 745f 315f 6e6f 7420  ols_shift_1_not 
+00004ce0: 3d20 7b63 6f6c 735f 7368 6966 745f 315f  = {cols_shift_1_
+00004cf0: 6e6f 747d 2729 0a20 2020 2020 2020 2063  not}').        c
+00004d00: 6f6c 735f 7368 6966 745f 3120 3d20 5b63  ols_shift_1 = [c
+00004d10: 6f6c 2066 6f72 2063 6f6c 2069 6e20 646d  ol for col in dm
+00004d20: 2e68 6561 6428 292e 636f 6c75 6d6e 7320  .head().columns 
+00004d30: 6966 2063 6f6c 206e 6f74 2069 6e20 636f  if col not in co
+00004d40: 6c73 5f73 6869 6674 5f31 5f6e 6f74 5d0a  ls_shift_1_not].
+00004d50: 2020 2020 2020 2020 6966 2073 6869 6674          if shift
+00004d60: 5f69 2021 3d20 303a 2064 6d2e 6665 5f67  _i != 0: dm.fe_g
+00004d70: 6f28 5b66 277b 636f 6c7d 203d 2072 6f6c  o([f'{col} = rol
+00004d80: 6c28 7368 6966 742c 207b 636f 6c5f 6964  l(shift, {col_id
+00004d90: 7d2c 207b 636f 6c7d 2c20 7b63 6f6c 5f74  }, {col}, {col_t
+00004da0: 6964 7d2c 207b 7368 6966 745f 697d 2927  id}, {shift_i})'
+00004db0: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
+00004dc0: 5f73 6869 6674 5f31 5d2c 2076 6572 626f  _shift_1], verbo
+00004dd0: 7365 3d76 6572 626f 7365 290a 2020 2020  se=verbose).    
+00004de0: 2020 2020 2320 646d 2e66 655f 676f 285b      # dm.fe_go([
+00004df0: 6627 726f 6c6c 2873 6869 6674 2c20 7b63  f'roll(shift, {c
+00004e00: 6f6c 5f69 647d 2c20 7b63 6f6c 7d2c 207b  ol_id}, {col}, {
+00004e10: 636f 6c5f 7469 647d 2c20 3129 2720 666f  col_tid}, 1)' fo
+00004e20: 7220 636f 6c20 696e 2063 6f6c 735f 7368  r col in cols_sh
+00004e30: 6966 745f 315d 2c20 6b65 6570 5f6e 616d  ift_1], keep_nam
+00004e40: 6520 3d20 3229 0a20 2020 2020 2020 2072  e = 2).        r
+00004e50: 6574 7572 6e20 646d 0a7a 065c 275c 275c  eturn dm.z.\'\'\
+00004e60: 277a 0327 2727 da01 7729 07da 026f 73da  'z.'''..w)...os.
+00004e70: 0470 6174 68da 0764 6972 6e61 6d65 da08  .path..dirname..
+00004e80: 5f5f 6669 6c65 5f5f da07 7265 706c 6163  __file__..replac
+00004e90: 65da 046f 7065 6eda 0577 7269 7465 2904  e..open..write).
+00004ea0: da06 6f75 7470 7574 5a0b 7061 7468 5f6f  ..outputZ.path_o
+00004eb0: 7574 7075 74da 0173 da01 66a9 0072 0e00  utput..s..f..r..
+00004ec0: 0000 fa4b 6275 696c 642f 6264 6973 742e  ...Kbuild/bdist.
+00004ed0: 6d61 636f 7378 2d31 302e 392d 7838 365f  macosx-10.9-x86_
+00004ee0: 3634 2f65 6767 2f72 756e 6e69 6e67 7a2f  64/egg/runningz/
+00004ef0: 6665 2f70 7265 7061 7265 5f64 6174 612f  fe/prepare_data/
+00004f00: 6261 7365 5f64 6174 615f 7079 2e70 79da  base_data_py.py.
+00004f10: 0372 756e 0400 0000 7310 0000 0000 0114  .run....s.......
+00004f20: 0104 7f00 7f00 7f00 120c 010c 0172 1000  .............r..
+00004f30: 0000 da08 5f5f 6d61 696e 5f5f 7a08 2d2d  ....__main__z.--
+00004f40: 6f75 7470 7574 5429 02da 0474 7970 65da  outputT)...type.
+00004f50: 0872 6571 7569 7265 6429 0c72 0400 0000  .required).r....
+00004f60: da03 7379 7372 1000 0000 da08 5f5f 6e61  ..sysr......__na
+00004f70: 6d65 5f5f da08 6172 6770 6172 7365 da0e  me__..argparse..
+00004f80: 4172 6775 6d65 6e74 5061 7273 6572 da06  ArgumentParser..
+00004f90: 7061 7273 6572 da0c 6164 645f 6172 6775  parser..add_argu
+00004fa0: 6d65 6e74 da03 7374 72da 0a70 6172 7365  ment..str..parse
+00004fb0: 5f61 7267 73da 0461 7267 7372 0b00 0000  _args..argsr....
+00004fc0: 720e 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
+00004fd0: 0f00 0000 da08 3c6d 6f64 756c 653e 0200  ......<module>..
+00004fe0: 0000 7316 0000 0008 0108 0108 7f00 7f00  ..s.............
+00004ff0: 7f00 1808 0108 0108 0110 0108 01         .............
```

## runningz/fe/prepare_data/basic_data_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 2480 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 b009 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 b009 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/status/status_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 16389 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 0540 0000  a.........Yf.@..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 0540 0000  a.........\f.@..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/fe/util/util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 14520 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 b838 0000  a.........Yf.8..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 b838 0000  a.........\f.8..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/nn/model_mlp.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sun Mar 31 15:37:13 2024 UTC, .py size: 11057 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 2983 0966 312b 0000  a.......)..f1+..
+00000000: 610d 0d0a 0000 0000 e794 5a66 312b 0000  a.........Zf1+..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 9800 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6401 6c04 5a05 6400 6401 6c06 5a07 6400  d.l.Z.d.d.l.Z.d.
 00000060: 6401 6c08 5a08 6400 6401 6c09 5a0a 6402  d.l.Z.d.d.l.Z.d.
 00000070: 6403 6c0b 6d0c 5a0c 0100 6402 6404 6c0d  d.l.m.Z...d.d.l.
```

## runningz/model/nn/model_mlp_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 11484 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 dc2c 0000  a.........Yf.,..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 dc2c 0000  a.........\f.,..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/nn/nn_util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 16653 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 0d41 0000  a.........Yf.A..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 0d41 0000  a.........\f.A..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/model/tree/model_cat.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Thu May  9 13:08:02 2024 UTC, .py size: 7528 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,294 +1,328 @@
-00000000: 610d 0d0a 0000 0000 b2ca 3c66 681d 0000  a.........<fh...
+00000000: 610d 0d0a 0000 0000 2197 5a66 1021 0000  a.......!.Zf.!..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 8c00 0000 6400  .....@...s....d.
+00000020: 0004 0000 0040 0000 0073 a000 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6401 6c04 5a05 6400 6401 6c06 5a07 6400  d.l.Z.d.d.l.Z.d.
 00000060: 6401 6c08 5a08 6402 6403 6c09 6d0a 5a0a  d.l.Z.d.d.l.m.Z.
 00000070: 0100 6402 6404 6c0b 6d0c 5a0c 6d0d 5a0d  ..d.d.l.m.Z.m.Z.
 00000080: 0100 6402 6405 6c0e 6d0f 5a0f 6d10 5a10  ..d.d.l.m.Z.m.Z.
 00000090: 6d11 5a11 0100 6402 6406 6c12 6d13 5a13  m.Z...d.d.l.m.Z.
-000000a0: 6d14 5a14 0100 4700 6407 6408 8400 6408  m.Z...G.d.d...d.
-000000b0: 650a 8303 5a15 6401 5300 2909 e900 0000  e...Z.d.S.).....
-000000c0: 004e e903 0000 0029 01da 0942 6173 654d  .N.....)...BaseM
-000000d0: 6f64 656c 2902 da0b 6765 745f 6d65 6d5f  odel)...get_mem_
-000000e0: 6375 72da 0b67 6574 5f6d 656d 5f6d 6178  cur..get_mem_max
-000000f0: 2903 da06 6e70 5f67 6574 da06 6e70 5f73  )...np_get..np_s
-00000100: 6574 da0c 6e70 5f73 6574 5f6f 7264 6572  et..np_set_order
-00000110: 2902 da07 6765 745f 616b 73da 0872 756e  )...get_aks..run
-00000120: 5f66 756e 6363 0000 0000 0000 0000 0000  _funcc..........
-00000130: 0000 0000 0000 0600 0000 0000 0000 7372  ..............sr
-00000140: 0000 0065 005a 0164 005a 0264 0164 0284  ...e.Z.d.Z.d.d..
-00000150: 005a 0364 1b87 0066 0164 0464 0584 095a  .Z.d...f.d.d...Z
-00000160: 0464 1c64 0664 0784 015a 0564 1d64 0b64  .d.d.d...Z.d.d.d
-00000170: 0c84 015a 0664 1e64 0f64 1084 015a 0764  ...Z.d.d.d...Z.d
-00000180: 1164 1284 005a 0864 1f87 0066 0164 1564  .d...Z.d...f.d.d
-00000190: 1684 095a 0987 0066 0164 1764 1884 085a  ...Z...f.d.d...Z
-000001a0: 0a87 0066 0164 1964 1a84 085a 0b87 0004  ...f.d.d...Z....
-000001b0: 005a 0c53 0029 20da 0843 4154 4d6f 6465  .Z.S.) ..CATMode
-000001c0: 6c63 0100 0000 0000 0000 0000 0000 0200  lc..............
-000001d0: 0000 0900 0000 4300 0000 7354 0000 0064  ......C...sT...d
-000001e0: 007d 017c 0064 0176 0072 2a64 0264 0364  .}.|.d.v.r*d.d.d
-000001f0: 0464 0464 0564 0664 0764 0864 099c 087d  .d.d.d.d.d.d...}
-00000200: 0164 0a7c 0164 0b3c 007c 0064 0c76 0072  .d.|.d.<.|.d.v.r
-00000210: 5064 0264 0364 0d64 0e64 0564 0664 0764  Pd.d.d.d.d.d.d.d
-00000220: 0864 099c 087d 0164 0a7c 0164 0b3c 007c  .d...}.d.|.d.<.|
-00000230: 0153 0029 0f4e 2901 5a08 7061 7261 6d73  .S.).N).Z.params
-00000240: 5f31 5a03 4350 5569 0903 0000 da04 524d  _1Z.CPUi......RM
-00000250: 5345 e93f 0000 0067 7b14 ae47 e17a 843f  SE.?...g{..G.z.?
-00000260: e908 0000 0067 9a99 9999 9999 c93f 2908  .....g.......?).
-00000270: 5a09 7461 736b 5f74 7970 655a 0b72 616e  Z.task_typeZ.ran
-00000280: 646f 6d5f 7365 6564 da0d 6c6f 7373 5f66  dom_seed..loss_f
-00000290: 756e 6374 696f 6e5a 0b65 7661 6c5f 6d65  unctionZ.eval_me
-000002a0: 7472 6963 5a0c 7468 7265 6164 5f63 6f75  tricZ.thread_cou
-000002b0: 6e74 5a0d 6c65 6172 6e69 6e67 5f72 6174  ntZ.learning_rat
-000002c0: 65da 0564 6570 7468 5a13 6261 6767 696e  e..depthZ.baggin
-000002d0: 675f 7465 6d70 6572 6174 7572 6569 f401  g_temperaturei..
-000002e0: 0000 da0c 6e5f 6573 7469 6d61 746f 7273  ....n_estimators
-000002f0: 2901 5a08 7061 7261 6d73 5f32 5a07 4c6f  ).Z.params_2Z.Lo
-00000300: 676c 6f73 735a 0550 5241 5543 a900 2902  glossZ.PRAUC..).
-00000310: da09 7061 7261 6d73 5f69 64da 0670 6172  ..params_id..par
-00000320: 616d 7372 1200 0000 7212 0000 00fa 4362  amsr....r.....Cb
-00000330: 7569 6c64 2f62 6469 7374 2e6d 6163 6f73  uild/bdist.macos
-00000340: 782d 3130 2e39 2d78 3836 5f36 342f 6567  x-10.9-x86_64/eg
-00000350: 672f 7275 6e6e 696e 677a 2f6d 6f64 656c  g/runningz/model
-00000360: 2f74 7265 652f 6d6f 6465 6c5f 6361 742e  /tree/model_cat.
-00000370: 7079 da0a 6765 745f 7061 7261 6d73 0f00  py..get_params..
-00000380: 0000 7330 0000 0000 0104 0108 0202 0202  ..s0............
-00000390: 0102 0102 0102 0102 0102 0102 f706 0d08  ................
-000003a0: 0108 0202 0202 0102 0102 0102 0102 0102  ................
-000003b0: 0102 f706 0d08 017a 1343 4154 4d6f 6465  .......z.CATMode
-000003c0: 6c2e 6765 745f 7061 7261 6d73 4e63 0200  l.get_paramsNc..
-000003d0: 0000 0000 0000 0000 0000 0200 0000 0300  ................
-000003e0: 0000 0300 0000 7310 0000 0074 0083 00a0  ......s....t....
-000003f0: 017c 01a1 0101 0064 0053 00a9 014e 2902  .|.....d.S...N).
-00000400: da05 7375 7065 72da 085f 5f69 6e69 745f  ..super..__init_
-00000410: 5f29 02da 0473 656c 66da 0a6d 6f64 656c  _)...self..model
-00000420: 5f6e 616d 65a9 01da 095f 5f63 6c61 7373  _name....__class
-00000430: 5f5f 7212 0000 0072 1500 0000 7219 0000  __r....r....r...
-00000440: 0031 0000 0073 0200 0000 0001 7a11 4341  .1...s......z.CA
-00000450: 544d 6f64 656c 2e5f 5f69 6e69 745f 5f63  TModel.__init__c
-00000460: 0400 0000 0000 0000 0000 0000 1100 0000  ................
-00000470: 0500 0000 4300 0000 7384 0200 007c 03a0  ....C...s....|..
-00000480: 0064 0164 00a1 027d 047c 0264 0075 0173  .d.d...}.|.d.u.s
-00000490: 207c 0464 0075 0173 204a 0082 017c 0464   |.d.u.s J...|.d
-000004a0: 0075 0172 3274 01a0 027c 04a1 017d 027c  .u.r2t...|...}.|
-000004b0: 03a0 0064 027c 0264 0319 00a1 027d 057c  ...d.|.d.....}.|
-000004c0: 057c 0364 023c 007c 057c 0264 033c 007c  .|.d.<.|.|.d.<.|
-000004d0: 006a 037c 0364 043c 007c 027c 0302 007c  .j.|.d.<.|.|...|
-000004e0: 005f 047c 005f 057c 03a0 0064 0564 06a1  ._.|._.|...d.d..
-000004f0: 027d 067c 03a0 0064 0764 08a1 027d 077c  .}.|...d.d...}.|
-00000500: 0772 be74 0664 097c 039b 009d 0264 0a64  .r.t.d.|.....d.d
-00000510: 0b8d 0201 0074 076a 08a0 09a1 0001 0074  .....t.j.......t
-00000520: 0664 0c7c 029b 009d 0264 0a64 0b8d 0201  .d.|.....d.d....
-00000530: 0074 076a 08a0 09a1 0001 007c 0164 0d19  .t.j.......|.d..
-00000540: 007c 0164 0e19 0002 007d 087d 0964 0f7c  .|.d.....}.}.d.|
-00000550: 01a0 0aa1 0076 0090 0172 0064 0f7c 01a0  .....v...r.d.|..
-00000560: 0aa1 0076 0090 0172 007c 0164 0f19 007c  ...v...r.|.d...|
-00000570: 0164 1019 0002 007d 0a7d 0b6e 2a7c 0164  .d.....}.}.n*|.d
-00000580: 0d19 0064 1164 0085 0219 00a0 0ba1 007c  ...d.d.........|
-00000590: 0164 0e19 0064 1164 0085 0219 00a0 0ba1  .d...d.d........
-000005a0: 0002 007d 0a7d 0b7c 03a0 0064 1264 0aa1  ...}.}.|...d.d..
-000005b0: 0290 0172 7c7c 0164 0d3d 007c 0164 0e3d  ...r||.d.=.|.d.=
-000005c0: 0074 0ca0 0da1 0001 0064 0f7c 01a0 0aa1  .t.......d.|....
-000005d0: 0076 0090 0172 7c64 107c 01a0 0aa1 0076  .v...r|d.|.....v
-000005e0: 0090 0172 7c7c 0164 0f3d 007c 0164 103d  ...r||.d.=.|.d.=
-000005f0: 0074 0ca0 0da1 0001 007c 0790 0172 d274  .t.......|...r.t
-00000600: 0664 137c 086a 0e9b 009d 0264 0a64 0b8d  .d.|.j.....d.d..
-00000610: 0201 0074 076a 08a0 09a1 0001 0074 0664  ...t.j.......t.d
-00000620: 147c 0a6a 0e9b 009d 0264 0a64 0b8d 0201  .|.j.....d.d....
-00000630: 0074 076a 08a0 09a1 0001 0074 0664 1583  .t.j.......t.d..
-00000640: 0101 0074 0f83 0074 1083 0066 0201 0074  ...t...t...f...t
-00000650: 11a0 1274 137c 0883 017c 09a1 027d 0c74  ...t.|...|...}.t
-00000660: 11a0 1274 137c 0a83 017c 0ba1 027d 0d7c  ...t.|...|...}.|
-00000670: 0790 0272 0c74 0664 1683 0101 0074 0f83  ...r.t.d.....t..
-00000680: 0074 1083 0066 0201 007e 087e 097e 0a7e  .t...f...~.~.~.~
-00000690: 0b74 0ca0 0da1 0001 007c 03a0 0064 1767  .t.......|...d.g
-000006a0: 00a1 027d 0e7c 0264 1819 0064 1976 0090  ...}.|.d...d.v..
-000006b0: 0272 3e74 116a 147d 0f6e 0674 116a 157d  .r>t.j.}.n.t.j.}
-000006c0: 0f7c 0f64 1a7c 0664 1b6b 0090 0272 5664  .|.d.|.d.k...rVd
-000006d0: 086e 027c 067c 0e64 1c8d 037d 107c 106a  .n.|.|.d...}.|.j
-000006e0: 1666 0069 007c 02a4 018e 0101 007c 10a0  .f.i.|.......|..
-000006f0: 177c 0ca1 0101 007c 107c 005f 187c 0053  .|.....|.|._.|.S
-00000700: 0029 1d4e 7213 0000 00da 076e 5f62 6f6f  .).Nr......n_boo
-00000710: 7374 7211 0000 0072 1b00 0000 da07 7665  str....r......ve
-00000720: 7262 6f73 65e9 6400 0000 da09 7368 6f77  rbose.d.....show
-00000730: 5f69 6e66 6f46 7a0d 5b2b 5d20 6b77 6172  _infoFz.[+] kwar
-00000740: 6773 203d 2054 2901 da05 666c 7573 687a  gs = T)...flushz
-00000750: 0d5b 2b5d 2070 6172 616d 7320 3d20 da07  .[+] params = ..
-00000760: 585f 7472 6169 6eda 0779 5f74 7261 696e  X_train..y_train
-00000770: da07 585f 7661 6c69 64da 0779 5f76 616c  ..X_valid..y_val
-00000780: 6964 69f6 ffff ff5a 0766 7265 655f 5879  idi....Z.free_Xy
-00000790: 7a14 5b2b 5d20 585f 7472 6169 6e2e 7368  z.[+] X_train.sh
-000007a0: 6170 6520 3d20 7a14 5b2b 5d20 585f 7661  ape = z.[+] X_va
-000007b0: 6c69 642e 7368 6170 6520 3d20 7a11 5b2b  lid.shape = z.[+
-000007c0: 5d20 6474 7261 696e 2062 6566 6f72 657a  ] dtrain beforez
-000007d0: 105b 2b5d 2064 7472 6169 6e20 6166 7465  .[+] dtrain afte
-000007e0: 72da 0c63 6174 5f66 6561 7475 7265 7372  r..cat_featuresr
-000007f0: 0f00 0000 2909 720c 0000 005a 094d 756c  ....).r....Z.Mul
-00000800: 7469 524d 5345 5a0b 5375 7276 6976 616c  tiRMSEZ.Survival
-00000810: 4166 745a 034d 4145 5a08 5175 616e 7469  AftZ.MAEZ.Quanti
-00000820: 6c65 5a0e 4c6f 674c 696e 5175 616e 7469  leZ.LogLinQuanti
-00000830: 6c65 5a07 506f 6973 736f 6e5a 044d 4150  leZ.PoissonZ.MAP
-00000840: 455a 024c 715a 0449 7465 7272 0100 0000  EZ.LqZ.Iterr....
-00000850: 2903 5a07 6f64 5f74 7970 6572 1f00 0000  ).Z.od_typer....
-00000860: 7227 0000 0029 19da 0367 6574 720b 0000  r'...)...getr...
-00000870: 0072 1600 0000 721b 0000 0072 1400 0000  .r....r....r....
-00000880: da06 6b77 6172 6773 da05 7072 696e 74da  ..kwargs..print.
-00000890: 0373 7973 da06 7374 646f 7574 7222 0000  .sys..stdoutr"..
-000008a0: 00da 046b 6579 73da 0463 6f70 79da 0267  ...keys..copy..g
-000008b0: 635a 0763 6f6c 6c65 6374 da05 7368 6170  cZ.collect..shap
-000008c0: 6572 0400 0000 7205 0000 00da 0863 6174  er....r......cat
-000008d0: 626f 6f73 74da 0450 6f6f 6c72 0800 0000  boost..Poolr....
-000008e0: da11 4361 7442 6f6f 7374 5265 6772 6573  ..CatBoostRegres
-000008f0: 736f 72da 1243 6174 426f 6f73 7443 6c61  sor..CatBoostCla
-00000900: 7373 6966 6965 725a 0a73 6574 5f70 6172  ssifierZ.set_par
-00000910: 616d 735a 0366 6974 da05 6d6f 6465 6c29  amsZ.fit..model)
-00000920: 1172 1a00 0000 5a07 5879 5f64 6963 7472  .r....Z.Xy_dictr
-00000930: 1400 0000 7229 0000 0072 1300 0000 721e  ....r)...r....r.
-00000940: 0000 0072 1f00 0000 7221 0000 0072 2300  ...r....r!...r#.
-00000950: 0000 7224 0000 0072 2500 0000 7226 0000  ..r$...r%...r&..
-00000960: 005a 0664 7472 6169 6e5a 0664 7661 6c69  .Z.dtrainZ.dvali
-00000970: 6472 2700 0000 da03 636c 7372 3500 0000  dr'.....clsr5...
-00000980: 7212 0000 0072 1200 0000 7215 0000 00da  r....r....r.....
-00000990: 0574 7261 696e 3400 0000 7354 0000 0000  .train4...sT....
-000009a0: 020c 0114 0112 0110 0108 0108 020a 010e  ................
-000009b0: 030c 010c 0104 011c 011c 0312 011c 0114  ................
-000009c0: 022a 010e 0114 011c 0114 0306 011e 011e  .*..............
-000009d0: 0114 0110 0110 011a 0110 030c 010e 0108  ................
-000009e0: 0206 0102 0202 0210 0102 fb06 0710 010a  ................
-000009f0: 0206 017a 0e43 4154 4d6f 6465 6c2e 7472  ...z.CATModel.tr
-00000a00: 6169 6e72 0e00 0000 e904 0000 0046 6305  ainr.........Fc.
-00000a10: 0000 0000 0000 0000 0000 0008 0000 0007  ................
-00000a20: 0000 0003 0000 0073 4c00 0000 7400 6a01  .......sL...t.j.
-00000a30: 7402 8800 8301 7400 6a03 6401 8d02 8902  t.....t.j.d.....
-00000a40: 8700 8701 8702 6603 6402 6403 8408 7d05  ......f.d.d...}.
-00000a50: 7404 7402 8800 8301 7c02 7c03 1400 8302  t.t.....|.|.....
-00000a60: 7d06 7405 7c05 7c06 7c02 6404 7c04 6405  }.t.|.|.|.d.|.d.
-00000a70: 8d05 7d07 8802 5300 2906 4e29 015a 0564  ..}...S.).N).Z.d
-00000a80: 7479 7065 6302 0000 0000 0000 0000 0000  typec...........
-00000a90: 0002 0000 0007 0000 0013 0000 0073 3200  .............s2.
-00000aa0: 0000 7c00 7c01 6b05 720c 6400 5300 8801  ..|.|.k.r.d.S...
-00000ab0: 6a00 a001 7402 a003 8800 7c00 7c01 8502  j...t.....|.|...
-00000ac0: 1900 a101 a101 8802 7c00 7c01 8502 3c00  ........|.|...<.
-00000ad0: 6400 5300 7217 0000 0029 0472 3500 0000  d.S.r....).r5...
-00000ae0: da07 7072 6564 6963 7472 3100 0000 7232  ..predictr1...r2
-00000af0: 0000 0029 02da 0270 31da 0270 32a9 03da  ...)...p1..p2...
-00000b00: 0158 721a 0000 005a 0679 5f70 7265 6472  .Xr....Z.y_predr
-00000b10: 1200 0000 7215 0000 00da 0672 7a5f 7275  ....r......rz_ru
-00000b20: 6e71 0000 0073 0400 0000 0001 0c01 7a23  nq...s........z#
-00000b30: 4341 544d 6f64 656c 2e72 7a5f 7072 6564  CATModel.rz_pred
-00000b40: 6963 742e 3c6c 6f63 616c 733e 2e72 7a5f  ict.<locals>.rz_
-00000b50: 7275 6e5a 0273 6d29 03da 066e 5f6a 6f62  runZ.sm)...n_job
-00000b60: 73da 046d 6f64 6572 1f00 0000 2906 da02  s..moder....)...
-00000b70: 6e70 da05 656d 7074 79da 036c 656e 5a07  np..empty..lenZ.
-00000b80: 666c 6f61 7433 3272 0900 0000 720a 0000  float32r....r...
-00000b90: 0029 0872 1a00 0000 723d 0000 0072 3f00  .).r....r=...r?.
-00000ba0: 0000 da06 6b74 696d 6573 721f 0000 0072  ....ktimesr....r
-00000bb0: 3e00 0000 5a03 616b 73da 015f 7212 0000  >...Z.aks.._r...
-00000bc0: 0072 3c00 0000 7215 0000 00da 0a72 7a5f  .r<...r......rz_
-00000bd0: 7072 6564 6963 746f 0000 0073 0a00 0000  predicto...s....
-00000be0: 0001 1401 1003 1201 1201 7a13 4341 544d  ..........z.CATM
-00000bf0: 6f64 656c 2e72 7a5f 7072 6564 6963 74da  odel.rz_predict.
-00000c00: 0372 6177 e9ff ffff ff63 0800 0000 0000  .raw.....c......
-00000c10: 0000 0000 0000 0800 0000 0600 0000 4300  ..............C.
-00000c20: 0000 7374 0000 0074 007c 0183 017d 017c  ..st...t.|...}.|
-00000c30: 0464 016b 0272 3e7c 0664 026b 0272 2e74  .d.k.r>|.d.k.r.t
-00000c40: 0174 0264 0374 037c 0183 0164 041a 0083  .t.d.t.|...d....
-00000c50: 0283 017d 067c 00a0 047c 017c 057c 067c  ...}.|...|.|.|.|
-00000c60: 07a1 0453 0064 0574 0574 067c 006a 0783  ...S.d.t.t.|.j..
-00000c70: 0183 0176 0072 627c 006a 07a0 0874 09a0  ...v.rb|.j...t..
-00000c80: 0a7c 01a1 01a1 0153 007c 006a 07a0 0b74  .|.....S.|.j...t
-00000c90: 09a0 0a7c 01a1 01a1 0153 0029 064e 5a02  ...|.....S.).NZ.
-00000ca0: 727a 7248 0000 00e9 0100 0000 6700 0000  rzrH........g...
-00000cb0: 00d0 1283 4172 3400 0000 290c 7208 0000  ....Ar4...).r...
-00000cc0: 00da 0369 6e74 da03 6d61 7872 4300 0000  ...int..maxrC...
-00000cd0: 7246 0000 00da 0373 7472 da04 7479 7065  rF.....str..type
-00000ce0: 7235 0000 005a 0d70 7265 6469 6374 5f70  r5...Z.predict_p
-00000cf0: 726f 6261 7231 0000 0072 3200 0000 7239  robar1...r2...r9
-00000d00: 0000 0029 0872 1a00 0000 723d 0000 0072  ...).r....r=...r
-00000d10: 1400 0000 7229 0000 00da 066d 6574 686f  ....r).....metho
-00000d20: 6472 3f00 0000 7244 0000 0072 1f00 0000  dr?...rD...r....
-00000d30: 7212 0000 0072 1200 0000 7215 0000 0072  r....r....r....r
-00000d40: 3900 0000 7800 0000 730e 0000 0000 0108  9...x...s.......
-00000d50: 0108 011e 0110 0112 0112 017a 1043 4154  ...........z.CAT
-00000d60: 4d6f 6465 6c2e 7072 6564 6963 7463 0100  Model.predictc..
-00000d70: 0000 0000 0000 0000 0000 0100 0000 0200  ................
-00000d80: 0000 4300 0000 730c 0000 0074 007c 006a  ..C...s....t.|.j
-00000d90: 016a 0283 0153 0072 1700 0000 2903 7243  .j...S.r....).rC
-00000da0: 0000 0072 3500 0000 5a0e 6665 6174 7572  ...r5...Z.featur
-00000db0: 655f 6e61 6d65 735f 2901 721a 0000 0072  e_names_).r....r
-00000dc0: 1200 0000 7212 0000 0072 1500 0000 da0e  ....r....r......
-00000dd0: 6765 745f 6e5f 6665 6174 7572 6573 8100  get_n_features..
-00000de0: 0000 7302 0000 0000 017a 1743 4154 4d6f  ..s......z.CATMo
-00000df0: 6465 6c2e 6765 745f 6e5f 6665 6174 7572  del.get_n_featur
-00000e00: 6573 e914 0000 00a9 0272 5000 0000 e90a  es.......rP.....
-00000e10: 0000 0063 0500 0000 0000 0000 0000 0000  ...c............
-00000e20: 0600 0000 0700 0000 0300 0000 731e 0000  ............s...
-00000e30: 007c 006a 006a 017d 0574 0283 006a 037c  .|.j.j.}.t...j.|
-00000e40: 057c 017c 027c 037c 0464 018d 0553 0029  .|.|.|.|.d...S.)
-00000e50: 024e 2901 da07 6669 6773 697a 6529 0472  .N)...figsize).r
-00000e60: 3500 0000 5a14 6665 6174 7572 655f 696d  5...Z.feature_im
-00000e70: 706f 7274 616e 6365 735f 7218 0000 005a  portances_r....Z
-00000e80: 0b5f 6765 745f 6466 5f69 6d70 2906 721a  ._get_df_imp).r.
-00000e90: 0000 005a 0863 6f6c 735f 6665 615a 0470  ...Z.cols_feaZ.p
-00000ea0: 6c6f 74da 016b 7253 0000 00da 0369 6d70  lot..krS.....imp
-00000eb0: 721c 0000 0072 1200 0000 7215 0000 00da  r....r....r.....
-00000ec0: 0a67 6574 5f64 665f 696d 7084 0000 0073  .get_df_imp....s
-00000ed0: 0400 0000 0001 0801 7a13 4341 544d 6f64  ........z.CATMod
-00000ee0: 656c 2e67 6574 5f64 665f 696d 7063 0200  el.get_df_impc..
-00000ef0: 0000 0000 0000 0000 0000 0200 0000 0400  ................
-00000f00: 0000 0300 0000 733a 0000 0074 00a0 0164  ......s:...t...d
-00000f10: 01a1 0101 0074 006a 027c 0164 0264 038d  .....t.j.|.d.d..
-00000f20: 0201 007c 006a 03a0 047c 019b 0064 049d  ...|.j...|...d..
-00000f30: 02a1 0101 0074 0583 00a0 067c 01a1 0101  .....t.....|....
-00000f40: 0064 0053 0029 054e 7a0d 726d 202d 7266  .d.S.).Nz.rm -rf
-00000f50: 207b 7061 7468 7d54 2901 da08 6578 6973   {path}T)...exis
-00000f60: 745f 6f6b fa0a 2f6d 6f64 656c 2e62 696e  t_ok../model.bin
-00000f70: 2907 da02 6f73 da06 7379 7374 656d da08  )...os..system..
-00000f80: 6d61 6b65 6469 7273 7235 0000 005a 0a73  makedirsr5...Z.s
-00000f90: 6176 655f 6d6f 6465 6c72 1800 0000 5a0b  ave_modelr....Z.
-00000fa0: 5f64 756d 705f 6f74 6865 72a9 0272 1a00  _dump_other..r..
-00000fb0: 0000 da04 7061 7468 721c 0000 0072 1200  ....pathr....r..
-00000fc0: 0000 7215 0000 00da 0464 756d 7088 0000  ..r......dump...
-00000fd0: 0073 0800 0000 0001 0a01 0e01 1201 7a0d  .s............z.
-00000fe0: 4341 544d 6f64 656c 2e64 756d 7063 0200  CATModel.dumpc..
-00000ff0: 0000 0000 0000 0000 0000 0200 0000 0300  ................
-00001000: 0000 0300 0000 7328 0000 0074 00a0 01a1  ......s(...t....
-00001010: 006a 027c 019b 0064 019d 0264 028d 017c  .j.|...d...d...|
-00001020: 005f 0374 0483 00a0 057c 01a1 0101 007c  ._.t.....|.....|
-00001030: 0053 0029 034e 7258 0000 0029 01da 0566  .S.).NrX...)...f
-00001040: 6e61 6d65 2906 7231 0000 0072 3300 0000  name).r1...r3...
-00001050: 5a0a 6c6f 6164 5f6d 6f64 656c 7235 0000  Z.load_modelr5..
-00001060: 0072 1800 0000 5a0b 5f6c 6f61 645f 6f74  .r....Z._load_ot
-00001070: 6865 7272 5c00 0000 721c 0000 0072 1200  herr\...r....r..
-00001080: 0000 7215 0000 00da 046c 6f61 648e 0000  ..r......load...
-00001090: 0073 0600 0000 0001 1801 0c01 7a0d 4341  .s..........z.CA
-000010a0: 544d 6f64 656c 2e6c 6f61 6429 014e 2902  TModel.load).N).
-000010b0: 4e4e 2903 720e 0000 0072 3800 0000 4629  NN).r....r8...F)
-000010c0: 064e 4e72 4700 0000 720e 0000 0072 4800  .NNrG...r....rH.
-000010d0: 0000 4629 044e 4672 5000 0000 7251 0000  ..F).NFrP...rQ..
-000010e0: 0029 0dda 085f 5f6e 616d 655f 5fda 0a5f  .)...__name__.._
-000010f0: 5f6d 6f64 756c 655f 5fda 0c5f 5f71 7561  _module__..__qua
-00001100: 6c6e 616d 655f 5f72 1600 0000 7219 0000  lname__r....r...
-00001110: 0072 3700 0000 7246 0000 0072 3900 0000  .r7...rF...r9...
-00001120: 724f 0000 0072 5600 0000 725e 0000 0072  rO...rV...r^...r
-00001130: 6000 0000 da0d 5f5f 636c 6173 7363 656c  `.....__classcel
-00001140: 6c5f 5f72 1200 0000 7212 0000 0072 1c00  l__r....r....r..
-00001150: 0000 7215 0000 0072 0b00 0000 0e00 0000  ..r....r........
-00001160: 7312 0000 0008 0108 220e 030a 3b0a 090a  s......."...;...
-00001170: 0908 030e 040c 0672 0b00 0000 2916 722b  .......r....).r+
-00001180: 0000 0072 5900 0000 722f 0000 00da 0670  ...rY...r/.....p
-00001190: 7375 7469 6cda 056e 756d 7079 7241 0000  sutil..numpyrA..
-000011a0: 00da 0670 616e 6461 73da 0270 6472 3100  ...pandas..pdr1.
-000011b0: 0000 5a0a 6d6f 6465 6c2e 6261 7365 7203  ..Z.model.baser.
-000011c0: 0000 005a 0975 7469 6c2e 7574 696c 7204  ...Z.util.utilr.
-000011d0: 0000 0072 0500 0000 5a0e 7574 696c 2e6e  ...r....Z.util.n
-000011e0: 7079 5f6e 756d 6261 7206 0000 0072 0700  py_numbar....r..
-000011f0: 0000 7208 0000 005a 0875 7469 6c2e 7275  ..r....Z.util.ru
-00001200: 6e72 0900 0000 720a 0000 0072 0b00 0000  nr....r....r....
-00001210: 7212 0000 0072 1200 0000 7212 0000 0072  r....r....r....r
-00001220: 1500 0000 da08 3c6d 6f64 756c 653e 0100  ......<module>..
-00001230: 0000 731a 0000 0008 0108 0108 0108 0108  ..s.............
-00001240: 0108 0108 010c 0110 0114 0110 0310 7f00  ................
-00001250: 06                                       .
+000000a0: 6d14 5a14 0100 6402 6407 6c0e 6d15 5a15  m.Z...d.d.l.m.Z.
+000000b0: 6d16 5a16 6d17 5a17 0100 4700 6408 6409  m.Z.m.Z...G.d.d.
+000000c0: 8400 6409 650a 8303 5a18 6401 5300 290a  ..d.e...Z.d.S.).
+000000d0: e900 0000 004e e903 0000 0029 01da 0942  .....N.....)...B
+000000e0: 6173 654d 6f64 656c 2902 da0b 6765 745f  aseModel)...get_
+000000f0: 6d65 6d5f 6375 72da 0b67 6574 5f6d 656d  mem_cur..get_mem
+00000100: 5f6d 6178 2903 da06 6e70 5f67 6574 da06  _max)...np_get..
+00000110: 6e70 5f73 6574 da0c 6e70 5f73 6574 5f6f  np_set..np_set_o
+00000120: 7264 6572 2902 da07 6765 745f 616b 73da  rder)...get_aks.
+00000130: 0872 756e 5f66 756e 6329 03da 156e 705f  .run_func)...np_
+00000140: 696e 665f 6173 5f6e 616e 5f69 6e70 6c61  inf_as_nan_inpla
+00000150: 6365 da11 6e70 5f66 696c 6c5f 765f 696e  ce..np_fill_v_in
+00000160: 706c 6163 65da 176e 705f 636c 6970 5f6d  place..np_clip_m
+00000170: 696e 5f6d 6178 5f69 6e70 6c61 6365 6300  in_max_inplacec.
+00000180: 0000 0000 0000 0000 0000 0000 0000 0004  ................
+00000190: 0000 0000 0000 0073 7200 0000 6500 5a01  .......sr...e.Z.
+000001a0: 6400 5a02 6401 6402 8400 5a03 641b 8700  d.Z.d.d...Z.d...
+000001b0: 6601 6405 6406 8409 5a04 641c 6407 6408  f.d.d...Z.d.d.d.
+000001c0: 8401 5a05 641d 640c 640d 8401 5a06 641e  ..Z.d.d.d...Z.d.
+000001d0: 640f 6410 8401 5a07 6411 6412 8400 5a08  d.d...Z.d.d...Z.
+000001e0: 641f 8700 6601 6415 6416 8409 5a09 8700  d...f.d.d...Z...
+000001f0: 6601 6417 6418 8408 5a0a 8700 6601 6419  f.d.d...Z...f.d.
+00000200: 641a 8408 5a0b 8700 0400 5a0c 5300 2920  d...Z.....Z.S.) 
+00000210: da08 4341 544d 6f64 656c 6301 0000 0000  ..CATModelc.....
+00000220: 0000 0000 0000 0002 0000 0009 0000 0043  ...............C
+00000230: 0000 0073 5400 0000 6400 7d01 7c00 6401  ...sT...d.}.|.d.
+00000240: 7600 722a 6402 6403 6404 6404 6405 6406  v.r*d.d.d.d.d.d.
+00000250: 6407 6408 6409 9c08 7d01 640a 7c01 640b  d.d.d...}.d.|.d.
+00000260: 3c00 7c00 640c 7600 7250 6402 6403 640d  <.|.d.v.rPd.d.d.
+00000270: 640e 6405 6406 6407 6408 6409 9c08 7d01  d.d.d.d.d.d...}.
+00000280: 640a 7c01 640b 3c00 7c01 5300 290f 4e29  d.|.d.<.|.S.).N)
+00000290: 015a 0870 6172 616d 735f 315a 0343 5055  .Z.params_1Z.CPU
+000002a0: 6909 0300 00da 0452 4d53 45e9 3f00 0000  i......RMSE.?...
+000002b0: 677b 14ae 47e1 7a84 3fe9 0800 0000 679a  g{..G.z.?.....g.
+000002c0: 9999 9999 99c9 3f29 085a 0974 6173 6b5f  ......?).Z.task_
+000002d0: 7479 7065 5a0b 7261 6e64 6f6d 5f73 6565  typeZ.random_see
+000002e0: 64da 0d6c 6f73 735f 6675 6e63 7469 6f6e  d..loss_function
+000002f0: 5a0b 6576 616c 5f6d 6574 7269 63da 0c74  Z.eval_metric..t
+00000300: 6872 6561 645f 636f 756e 745a 0d6c 6561  hread_countZ.lea
+00000310: 726e 696e 675f 7261 7465 da05 6465 7074  rning_rate..dept
+00000320: 685a 1362 6167 6769 6e67 5f74 656d 7065  hZ.bagging_tempe
+00000330: 7261 7475 7265 69f4 0100 00da 0c6e 5f65  raturei......n_e
+00000340: 7374 696d 6174 6f72 7329 015a 0870 6172  stimators).Z.par
+00000350: 616d 735f 325a 074c 6f67 6c6f 7373 5a05  ams_2Z.LoglossZ.
+00000360: 5052 4155 43a9 0029 02da 0970 6172 616d  PRAUC..)...param
+00000370: 735f 6964 da06 7061 7261 6d73 7216 0000  s_id..paramsr...
+00000380: 0072 1600 0000 fa43 6275 696c 642f 6264  .r.....Cbuild/bd
+00000390: 6973 742e 6d61 636f 7378 2d31 302e 392d  ist.macosx-10.9-
+000003a0: 7838 365f 3634 2f65 6767 2f72 756e 6e69  x86_64/egg/runni
+000003b0: 6e67 7a2f 6d6f 6465 6c2f 7472 6565 2f6d  ngz/model/tree/m
+000003c0: 6f64 656c 5f63 6174 2e70 79da 0a67 6574  odel_cat.py..get
+000003d0: 5f70 6172 616d 7310 0000 0073 3000 0000  _params....s0...
+000003e0: 0001 0401 0802 0202 0201 0201 0201 0201  ................
+000003f0: 0201 0201 02f7 060d 0801 0802 0202 0201  ................
+00000400: 0201 0201 0201 0201 0201 02f7 060d 0801  ................
+00000410: 7a13 4341 544d 6f64 656c 2e67 6574 5f70  z.CATModel.get_p
+00000420: 6172 616d 734e e90a 0000 0063 0400 0000  aramsN.....c....
+00000430: 0000 0000 0000 0000 0400 0000 0300 0000  ................
+00000440: 0300 0000 731c 0000 0074 0083 00a0 017c  ....s....t.....|
+00000450: 01a1 0101 007c 027c 005f 027c 037c 005f  .....|.|._.|.|._
+00000460: 0364 0053 00a9 014e 2904 da05 7375 7065  .d.S...N)...supe
+00000470: 72da 085f 5f69 6e69 745f 5fda 0766 5f6c  r..__init__..f_l
+00000480: 6162 656c da04 636c 6970 2904 da04 7365  abel..clip)...se
+00000490: 6c66 da0a 6d6f 6465 6c5f 6e61 6d65 721f  lf..model_namer.
+000004a0: 0000 0072 2000 0000 a901 da09 5f5f 636c  ...r .......__cl
+000004b0: 6173 735f 5f72 1600 0000 7219 0000 0072  ass__r....r....r
+000004c0: 1e00 0000 3200 0000 7306 0000 0000 010c  ....2...s.......
+000004d0: 0106 017a 1143 4154 4d6f 6465 6c2e 5f5f  ...z.CATModel.__
+000004e0: 696e 6974 5f5f 6304 0000 0000 0000 0000  init__c.........
+000004f0: 0000 0011 0000 0006 0000 0043 0000 0073  ...........C...s
+00000500: ba02 0000 7c03 a000 6401 6400 a102 7d04  ....|...d.d...}.
+00000510: 7c02 6400 7501 7320 7c04 6400 7501 7320  |.d.u.s |.d.u.s 
+00000520: 4a00 8201 7c04 6400 7501 7232 7401 a002  J...|.d.u.r2t...
+00000530: 7c04 a101 7d02 7c03 a000 6402 7c02 6403  |...}.|...d.|.d.
+00000540: 1900 a102 7d05 7c05 7c03 6402 3c00 7c05  ....}.|.|.d.<.|.
+00000550: 7c02 6403 3c00 7c00 6a03 7c03 6404 3c00  |.d.<.|.j.|.d.<.
+00000560: 7c02 7c03 0200 7c00 5f04 7c00 5f05 7c03  |.|...|._.|._.|.
+00000570: a000 6405 6406 a102 7d06 7c03 a000 6407  ..d.d...}.|...d.
+00000580: 6408 a102 7d07 7c07 72be 7406 6409 7c03  d...}.|.r.t.d.|.
+00000590: 9b00 9d02 640a 640b 8d02 0100 7407 6a08  ....d.d.....t.j.
+000005a0: a009 a100 0100 7406 640c 7c02 9b00 9d02  ......t.d.|.....
+000005b0: 640a 640b 8d02 0100 7407 6a08 a009 a100  d.d.....t.j.....
+000005c0: 0100 7c01 640d 1900 7c01 640e 1900 0200  ..|.d...|.d.....
+000005d0: 7d08 7d09 640f 7c01 a00a a100 7600 9001  }.}.d.|.....v...
+000005e0: 7200 640f 7c01 a00a a100 7600 9001 7200  r.d.|.....v...r.
+000005f0: 7c01 640f 1900 7c01 6410 1900 0200 7d0a  |.d...|.d.....}.
+00000600: 7d0b 6e2a 7c01 640d 1900 6411 6400 8502  }.n*|.d...d.d...
+00000610: 1900 a00b a100 7c01 640e 1900 6411 6400  ......|.d...d.d.
+00000620: 8502 1900 a00b a100 0200 7d0a 7d0b 7c03  ..........}.}.|.
+00000630: a000 6412 640a a102 9001 727c 7c01 640d  ..d.d.....r||.d.
+00000640: 3d00 7c01 640e 3d00 740c a00d a100 0100  =.|.d.=.t.......
+00000650: 640f 7c01 a00a a100 7600 9001 727c 6410  d.|.....v...r|d.
+00000660: 7c01 a00a a100 7600 9001 727c 7c01 640f  |.....v...r||.d.
+00000670: 3d00 7c01 6410 3d00 740c a00d a100 0100  =.|.d.=.t.......
+00000680: 7c00 6a0e 6400 7501 9001 72b2 740f 7c09  |.j.d.u...r.t.|.
+00000690: 6413 7c00 6a10 1400 7c00 6a10 8303 7d09  d.|.j...|.j...}.
+000006a0: 7411 a012 7411 a012 7c09 7c00 6a10 1700  t...t...|.|.j...
+000006b0: a101 a101 7d09 7c07 9002 7208 7406 6414  ....}.|...r.t.d.
+000006c0: 7c08 6a13 9b00 9d02 640a 640b 8d02 0100  |.j.....d.d.....
+000006d0: 7407 6a08 a009 a100 0100 7406 6415 7c0a  t.j.......t.d.|.
+000006e0: 6a13 9b00 9d02 640a 640b 8d02 0100 7407  j.....d.d.....t.
+000006f0: 6a08 a009 a100 0100 7406 6416 8301 0100  j.......t.d.....
+00000700: 7414 8300 7415 8300 6602 0100 7416 a017  t...t...f...t...
+00000710: 7418 7c08 8301 7c09 a102 7d0c 7416 a017  t.|...|...}.t...
+00000720: 7418 7c0a 8301 7c0b a102 7d0d 7c07 9002  t.|...|...}.|...
+00000730: 7242 7406 6417 8301 0100 7414 8300 7415  rBt.d.....t...t.
+00000740: 8300 6602 0100 7e08 7e09 7e0a 7e0b 740c  ..f...~.~.~.~.t.
+00000750: a00d a100 0100 7c03 a000 6418 6700 a102  ......|...d.g...
+00000760: 7d0e 7c02 6419 1900 641a 7600 9002 7274  }.|.d...d.v...rt
+00000770: 7416 6a19 7d0f 6e06 7416 6a1a 7d0f 7c0f  t.j.}.n.t.j.}.|.
+00000780: 641b 7c06 641c 6b00 9002 728c 6408 6e02  d.|.d.k...r.d.n.
+00000790: 7c06 7c0e 641d 8d03 7d10 7c10 6a1b 6600  |.|.d...}.|.j.f.
+000007a0: 6900 7c02 a401 8e01 0100 7c10 a01c 7c0c  i.|.......|...|.
+000007b0: a101 0100 7c10 7c00 5f1d 7c00 5300 291e  ....|.|._.|.S.).
+000007c0: 4e72 1700 0000 da07 6e5f 626f 6f73 7472  Nr......n_boostr
+000007d0: 1500 0000 7222 0000 00da 0776 6572 626f  ....r".....verbo
+000007e0: 7365 e964 0000 00da 0973 686f 775f 696e  se.d.....show_in
+000007f0: 666f 467a 0d5b 2b5d 206b 7761 7267 7320  foFz.[+] kwargs 
+00000800: 3d20 5429 01da 0566 6c75 7368 7a0d 5b2b  = T)...flushz.[+
+00000810: 5d20 7061 7261 6d73 203d 20da 0758 5f74  ] params = ..X_t
+00000820: 7261 696e da07 795f 7472 6169 6eda 0758  rain..y_train..X
+00000830: 5f76 616c 6964 da07 795f 7661 6c69 6469  _valid..y_validi
+00000840: f6ff ffff 5a07 6672 6565 5f58 79e9 ffff  ....Z.free_Xy...
+00000850: ffff 7a14 5b2b 5d20 585f 7472 6169 6e2e  ..z.[+] X_train.
+00000860: 7368 6170 6520 3d20 7a14 5b2b 5d20 585f  shape = z.[+] X_
+00000870: 7661 6c69 642e 7368 6170 6520 3d20 7a11  valid.shape = z.
+00000880: 5b2b 5d20 6474 7261 696e 2062 6566 6f72  [+] dtrain befor
+00000890: 657a 105b 2b5d 2064 7472 6169 6e20 6166  ez.[+] dtrain af
+000008a0: 7465 72da 0c63 6174 5f66 6561 7475 7265  ter..cat_feature
+000008b0: 7372 1200 0000 2909 720f 0000 005a 094d  sr....).r....Z.M
+000008c0: 756c 7469 524d 5345 5a0b 5375 7276 6976  ultiRMSEZ.Surviv
+000008d0: 616c 4166 745a 034d 4145 5a08 5175 616e  alAftZ.MAEZ.Quan
+000008e0: 7469 6c65 5a0e 4c6f 674c 696e 5175 616e  tileZ.LogLinQuan
+000008f0: 7469 6c65 5a07 506f 6973 736f 6e5a 044d  tileZ.PoissonZ.M
+00000900: 4150 455a 024c 715a 0449 7465 7272 0100  APEZ.LqZ.Iterr..
+00000910: 0000 2903 5a07 6f64 5f74 7970 6572 2600  ..).Z.od_typer&.
+00000920: 0000 722f 0000 0029 1eda 0367 6574 720e  ..r/...)...getr.
+00000930: 0000 0072 1a00 0000 7222 0000 0072 1800  ...r....r"...r..
+00000940: 0000 da06 6b77 6172 6773 da05 7072 696e  ....kwargs..prin
+00000950: 74da 0373 7973 da06 7374 646f 7574 7229  t..sys..stdoutr)
+00000960: 0000 00da 046b 6579 73da 0463 6f70 79da  .....keys..copy.
+00000970: 0267 635a 0763 6f6c 6c65 6374 721f 0000  .gcZ.collectr...
+00000980: 0072 0d00 0000 7220 0000 00da 026e 70da  .r....r .....np.
+00000990: 056c 6f67 3170 da05 7368 6170 6572 0400  .log1p..shaper..
+000009a0: 0000 7205 0000 00da 0863 6174 626f 6f73  ..r......catboos
+000009b0: 74da 0450 6f6f 6c72 0800 0000 da11 4361  t..Poolr......Ca
+000009c0: 7442 6f6f 7374 5265 6772 6573 736f 72da  tBoostRegressor.
+000009d0: 1243 6174 426f 6f73 7443 6c61 7373 6966  .CatBoostClassif
+000009e0: 6965 725a 0a73 6574 5f70 6172 616d 735a  ierZ.set_paramsZ
+000009f0: 0366 6974 da05 6d6f 6465 6c29 1172 2100  .fit..model).r!.
+00000a00: 0000 5a07 5879 5f64 6963 7472 1800 0000  ..Z.Xy_dictr....
+00000a10: 7231 0000 0072 1700 0000 7225 0000 0072  r1...r....r%...r
+00000a20: 2600 0000 7228 0000 0072 2a00 0000 722b  &...r(...r*...r+
+00000a30: 0000 0072 2c00 0000 722d 0000 005a 0664  ...r,...r-...Z.d
+00000a40: 7472 6169 6e5a 0664 7661 6c69 6472 2f00  trainZ.dvalidr/.
+00000a50: 0000 da03 636c 7372 3f00 0000 7216 0000  ....clsr?...r...
+00000a60: 0072 1600 0000 7219 0000 00da 0574 7261  .r....r......tra
+00000a70: 696e 3700 0000 735a 0000 0000 020c 0114  in7...sZ........
+00000a80: 0112 0110 0108 0108 020a 010e 030c 010c  ................
+00000a90: 0104 011c 011c 0312 011c 0114 022a 010e  .............*..
+00000aa0: 0114 011c 0114 030c 0114 0116 0306 011e  ................
+00000ab0: 011e 0114 0110 0110 011a 0110 030c 010e  ................
+00000ac0: 0108 0206 0102 0202 0210 0102 fb06 0710  ................
+00000ad0: 010a 0206 017a 0e43 4154 4d6f 6465 6c2e  .....z.CATModel.
+00000ae0: 7472 6169 6e72 2e00 0000 7211 0000 0046  trainr....r....F
+00000af0: 6306 0000 0000 0000 0000 0000 0009 0000  c...............
+00000b00: 0007 0000 0003 0000 0073 8000 0000 7c04  .........s....|.
+00000b10: 6401 6b02 721e 7400 7401 6402 7402 8800  d.k.r.t.t.d.t...
+00000b20: 8301 6403 1a00 8302 8301 7d04 8801 6404  ..d.......}...d.
+00000b30: 6b01 722e 8802 6a03 6a04 6e02 8801 8901  k.r...j.j.n.....
+00000b40: 7405 6a06 7402 8800 8301 7405 6a07 6405  t.j.t.....t.j.d.
+00000b50: 8d02 8903 8700 8701 8702 8703 6604 6406  ............f.d.
+00000b60: 6407 8408 7d06 7408 7402 8800 8301 7c03  d...}.t.t.....|.
+00000b70: 7c04 1400 8302 7d07 7409 7c06 7c07 7c03  |.....}.t.|.|.|.
+00000b80: 6408 7c05 6409 8d05 7d08 8803 5300 290a  d.|.d...}...S.).
+00000b90: 4e72 2e00 0000 e901 0000 0067 0000 0000  Nr.........g....
+00000ba0: d012 8341 7201 0000 0029 015a 0564 7479  ...Ar....).Z.dty
+00000bb0: 7065 6302 0000 0000 0000 0000 0000 0002  pec.............
+00000bc0: 0000 0006 0000 0013 0000 0073 3600 0000  ...........s6...
+00000bd0: 7c00 7c01 6b05 720c 6400 5300 8802 6a00  |.|.k.r.d.S...j.
+00000be0: 6a01 7402 a003 8800 7c00 7c01 8502 1900  j.t.....|.|.....
+00000bf0: a101 8801 6401 8d02 8803 7c00 7c01 8502  ....d.....|.|...
+00000c00: 3c00 6400 5300 2902 4e29 01da 096e 7472  <.d.S.).N)...ntr
+00000c10: 6565 5f65 6e64 2904 723f 0000 00da 0770  ee_end).r?.....p
+00000c20: 7265 6469 6374 723b 0000 0072 3c00 0000  redictr;...r<...
+00000c30: 2902 da02 7031 da02 7032 a904 da01 5872  )...p1..p2....Xr
+00000c40: 2500 0000 7221 0000 00da 0679 5f70 7265  %...r!.....y_pre
+00000c50: 6472 1600 0000 7219 0000 00da 0672 7a5f  dr....r......rz_
+00000c60: 7275 6e7c 0000 0073 0400 0000 0001 0c01  run|...s........
+00000c70: 7a23 4341 544d 6f64 656c 2e72 7a5f 7072  z#CATModel.rz_pr
+00000c80: 6564 6963 742e 3c6c 6f63 616c 733e 2e72  edict.<locals>.r
+00000c90: 7a5f 7275 6e5a 0273 6d29 03da 066e 5f6a  z_runZ.sm)...n_j
+00000ca0: 6f62 73da 046d 6f64 6572 2600 0000 290a  obs..moder&...).
+00000cb0: da03 696e 74da 036d 6178 da03 6c65 6e72  ..int..max..lenr
+00000cc0: 3f00 0000 da0b 7472 6565 5f63 6f75 6e74  ?.....tree_count
+00000cd0: 5f72 3800 0000 da05 656d 7074 795a 0766  _r8.....emptyZ.f
+00000ce0: 6c6f 6174 3332 7209 0000 0072 0a00 0000  loat32r....r....
+00000cf0: 2909 7221 0000 0072 4800 0000 7225 0000  ).r!...rH...r%..
+00000d00: 0072 4b00 0000 da06 6b74 696d 6573 7226  .rK.....ktimesr&
+00000d10: 0000 0072 4a00 0000 5a03 616b 73da 015f  ...rJ...Z.aks.._
+00000d20: 7216 0000 0072 4700 0000 7219 0000 00da  r....rG...r.....
+00000d30: 0a72 7a5f 7072 6564 6963 7477 0000 0073  .rz_predictw...s
+00000d40: 0e00 0000 0001 1e01 1402 1401 1203 1201  ................
+00000d50: 1201 7a13 4341 544d 6f64 656c 2e72 7a5f  ..z.CATModel.rz_
+00000d60: 7072 6564 6963 74da 0372 6177 6305 0000  predict..rawc...
+00000d70: 0000 0000 0000 0000 000a 0000 0007 0000  ................
+00000d80: 0043 0000 0073 d400 0000 7400 7c01 8301  .C...s....t.|...
+00000d90: 7d01 7c03 a001 6401 7c04 6402 6b02 721a  }.|...d.|.d.k.r.
+00000da0: 6403 6e0a 7402 a003 a100 6404 1800 a102  d.n.t.....d.....
+00000db0: 7d05 7c03 a001 6405 6406 a102 7d06 7c03  }.|...d.d...}.|.
+00000dc0: a001 6407 7c00 6a04 6a05 a102 7d07 7c03  ..d.|.j.j...}.|.
+00000dd0: a001 6408 6409 a102 7d08 7c04 6402 6b02  ..d.d...}.|.d.k.
+00000de0: 726c 7c00 a006 7c01 7c07 7c05 7c06 7c08  rl|...|.|.|.|.|.
+00000df0: a105 7d09 6e44 640a 7407 7408 7c00 6a04  ..}.nDd.t.t.|.j.
+00000e00: 8301 8301 7600 7298 7c00 6a04 6a09 740a  ....v.r.|.j.j.t.
+00000e10: a00b 7c01 a101 7c05 7c07 640b 8d03 7d09  ..|...|.|.d...}.
+00000e20: 6e18 7c00 6a04 6a0c 740a a00b 7c01 a101  n.|.j.j.t...|...
+00000e30: 7c05 7c07 640b 8d03 7d09 7c00 6a0d 6400  |.|.d...}.|.j.d.
+00000e40: 7501 72d0 740e a00f 740e a00f 7c09 a101  u.r.t...t...|...
+00000e50: a101 7c00 6a10 1800 7d09 7c09 5300 290c  ..|.j...}.|.S.).
+00000e60: 4e72 4b00 0000 5a02 727a 7211 0000 0072  NrK...Z.rzr....r
+00000e70: 4200 0000 7252 0000 0072 2e00 0000 7225  B...rR...r....r%
+00000e80: 0000 0072 2600 0000 4672 3e00 0000 2902  ...r&...Fr>...).
+00000e90: 7213 0000 0072 4300 0000 2911 7208 0000  r....rC...).r...
+00000ea0: 0072 3000 0000 da06 7073 7574 696c da09  .r0.....psutil..
+00000eb0: 6370 755f 636f 756e 7472 3f00 0000 7250  cpu_countr?...rP
+00000ec0: 0000 0072 5400 0000 da03 7374 72da 0474  ...rT.....str..t
+00000ed0: 7970 655a 0d70 7265 6469 6374 5f70 726f  ypeZ.predict_pro
+00000ee0: 6261 723b 0000 0072 3c00 0000 7244 0000  bar;...r<...rD..
+00000ef0: 0072 1f00 0000 7238 0000 00da 0565 7870  .r....r8.....exp
+00000f00: 6d31 7220 0000 0029 0a72 2100 0000 7248  m1r ...).r!...rH
+00000f10: 0000 0072 1800 0000 7231 0000 00da 066d  ...r....r1.....m
+00000f20: 6574 686f 6472 4b00 0000 7252 0000 0072  ethodrK...rR...r
+00000f30: 2500 0000 7226 0000 0072 4900 0000 7216  %...r&...rI...r.
+00000f40: 0000 0072 1600 0000 7219 0000 0072 4400  ...r....r....rD.
+00000f50: 0000 8300 0000 7318 0000 0000 0108 0120  ......s........ 
+00000f60: 010c 0110 010c 0108 0114 0212 011a 0218  ................
+00000f70: 0120 017a 1043 4154 4d6f 6465 6c2e 7072  . .z.CATModel.pr
+00000f80: 6564 6963 7463 0100 0000 0000 0000 0000  edictc..........
+00000f90: 0000 0100 0000 0200 0000 4300 0000 730c  ..........C...s.
+00000fa0: 0000 0074 007c 006a 016a 0283 0153 0072  ...t.|.j.j...S.r
+00000fb0: 1c00 0000 2903 724f 0000 0072 3f00 0000  ....).rO...r?...
+00000fc0: 5a0e 6665 6174 7572 655f 6e61 6d65 735f  Z.feature_names_
+00000fd0: 2901 7221 0000 0072 1600 0000 7216 0000  ).r!...r....r...
+00000fe0: 0072 1900 0000 da0e 6765 745f 6e5f 6665  .r......get_n_fe
+00000ff0: 6174 7572 6573 9300 0000 7302 0000 0000  atures....s.....
+00001000: 017a 1743 4154 4d6f 6465 6c2e 6765 745f  .z.CATModel.get_
+00001010: 6e5f 6665 6174 7572 6573 e914 0000 00a9  n_features......
+00001020: 0272 5d00 0000 721b 0000 0063 0500 0000  .r]...r....c....
+00001030: 0000 0000 0000 0000 0600 0000 0700 0000  ................
+00001040: 0300 0000 731e 0000 007c 006a 006a 017d  ....s....|.j.j.}
+00001050: 0574 0283 006a 037c 057c 017c 027c 037c  .t...j.|.|.|.|.|
+00001060: 0464 018d 0553 0029 024e 2901 da07 6669  .d...S.).N)...fi
+00001070: 6773 697a 6529 0472 3f00 0000 5a14 6665  gsize).r?...Z.fe
+00001080: 6174 7572 655f 696d 706f 7274 616e 6365  ature_importance
+00001090: 735f 721d 0000 005a 0b5f 6765 745f 6466  s_r....Z._get_df
+000010a0: 5f69 6d70 2906 7221 0000 005a 0863 6f6c  _imp).r!...Z.col
+000010b0: 735f 6665 615a 0470 6c6f 74da 016b 725f  s_feaZ.plot..kr_
+000010c0: 0000 00da 0369 6d70 7223 0000 0072 1600  .....impr#...r..
+000010d0: 0000 7219 0000 00da 0a67 6574 5f64 665f  ..r......get_df_
+000010e0: 696d 7096 0000 0073 0400 0000 0001 0801  imp....s........
+000010f0: 7a13 4341 544d 6f64 656c 2e67 6574 5f64  z.CATModel.get_d
+00001100: 665f 696d 7063 0200 0000 0000 0000 0000  f_impc..........
+00001110: 0000 0200 0000 0400 0000 0300 0000 733a  ..............s:
+00001120: 0000 0074 00a0 0164 01a1 0101 0074 006a  ...t...d.....t.j
+00001130: 027c 0164 0264 038d 0201 007c 006a 03a0  .|.d.d.....|.j..
+00001140: 047c 019b 0064 049d 02a1 0101 0074 0583  .|...d.......t..
+00001150: 00a0 067c 01a1 0101 0064 0053 0029 054e  ...|.....d.S.).N
+00001160: 7a0d 726d 202d 7266 207b 7061 7468 7d54  z.rm -rf {path}T
+00001170: 2901 da08 6578 6973 745f 6f6b fa0a 2f6d  )...exist_ok../m
+00001180: 6f64 656c 2e62 696e 2907 da02 6f73 da06  odel.bin)...os..
+00001190: 7379 7374 656d da08 6d61 6b65 6469 7273  system..makedirs
+000011a0: 723f 0000 005a 0a73 6176 655f 6d6f 6465  r?...Z.save_mode
+000011b0: 6c72 1d00 0000 5a0b 5f64 756d 705f 6f74  lr....Z._dump_ot
+000011c0: 6865 72a9 0272 2100 0000 da04 7061 7468  her..r!.....path
+000011d0: 7223 0000 0072 1600 0000 7219 0000 00da  r#...r....r.....
+000011e0: 0464 756d 709a 0000 0073 0800 0000 0001  .dump....s......
+000011f0: 0a01 0e01 1201 7a0d 4341 544d 6f64 656c  ......z.CATModel
+00001200: 2e64 756d 7063 0200 0000 0000 0000 0000  .dumpc..........
+00001210: 0000 0200 0000 0300 0000 0300 0000 7328  ..............s(
+00001220: 0000 0074 00a0 01a1 006a 027c 019b 0064  ...t.....j.|...d
+00001230: 019d 0264 028d 017c 005f 0374 0483 00a0  ...d...|._.t....
+00001240: 057c 01a1 0101 007c 0053 0029 034e 7264  .|.....|.S.).Nrd
+00001250: 0000 0029 01da 0566 6e61 6d65 2906 723b  ...)...fname).r;
+00001260: 0000 0072 3d00 0000 5a0a 6c6f 6164 5f6d  ...r=...Z.load_m
+00001270: 6f64 656c 723f 0000 0072 1d00 0000 5a0b  odelr?...r....Z.
+00001280: 5f6c 6f61 645f 6f74 6865 7272 6800 0000  _load_otherrh...
+00001290: 7223 0000 0072 1600 0000 7219 0000 00da  r#...r....r.....
+000012a0: 046c 6f61 64a0 0000 0073 0600 0000 0001  .load....s......
+000012b0: 1801 0c01 7a0d 4341 544d 6f64 656c 2e6c  ....z.CATModel.l
+000012c0: 6f61 6429 034e 4e72 1b00 0000 2902 4e4e  oad).NNr....).NN
+000012d0: 2904 722e 0000 0072 1100 0000 722e 0000  ).r....r....r...
+000012e0: 0046 2903 4e4e 7255 0000 0029 044e 4672  .F).NNrU...).NFr
+000012f0: 5d00 0000 725e 0000 0029 0dda 085f 5f6e  ]...r^...)...__n
+00001300: 616d 655f 5fda 0a5f 5f6d 6f64 756c 655f  ame__..__module_
+00001310: 5fda 0c5f 5f71 7561 6c6e 616d 655f 5f72  _..__qualname__r
+00001320: 1a00 0000 721e 0000 0072 4100 0000 7254  ....r....rA...rT
+00001330: 0000 0072 4400 0000 725c 0000 0072 6200  ...rD...r\...rb.
+00001340: 0000 726a 0000 0072 6c00 0000 da0d 5f5f  ..rj...rl.....__
+00001350: 636c 6173 7363 656c 6c5f 5f72 1600 0000  classcell__r....
+00001360: 7216 0000 0072 2300 0000 7219 0000 0072  r....r#...r....r
+00001370: 0e00 0000 0f00 0000 7312 0000 0008 0108  ........s.......
+00001380: 220e 050a 400a 0c0a 1008 030e 040c 0672  "...@..........r
+00001390: 0e00 0000 2919 7233 0000 0072 6500 0000  ....).r3...re...
+000013a0: 7237 0000 0072 5600 0000 da05 6e75 6d70  r7...rV.....nump
+000013b0: 7972 3800 0000 da06 7061 6e64 6173 da02  yr8.....pandas..
+000013c0: 7064 723b 0000 005a 0a6d 6f64 656c 2e62  pdr;...Z.model.b
+000013d0: 6173 6572 0300 0000 5a09 7574 696c 2e75  aser....Z.util.u
+000013e0: 7469 6c72 0400 0000 7205 0000 005a 0e75  tilr....r....Z.u
+000013f0: 7469 6c2e 6e70 795f 6e75 6d62 6172 0600  til.npy_numbar..
+00001400: 0000 7207 0000 0072 0800 0000 5a08 7574  ..r....r....Z.ut
+00001410: 696c 2e72 756e 7209 0000 0072 0a00 0000  il.runr....r....
+00001420: 720b 0000 0072 0c00 0000 720d 0000 0072  r....r....r....r
+00001430: 0e00 0000 7216 0000 0072 1600 0000 7216  ....r....r....r.
+00001440: 0000 0072 1900 0000 da08 3c6d 6f64 756c  ...r......<modul
+00001450: 653e 0100 0000 731c 0000 0008 0108 0108  e>....s.........
+00001460: 0108 0108 0108 0108 010c 0110 0114 0110  ................
+00001470: 0114 0310 7f00 17                        .......
```

## runningz/model/tree/model_cat_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 7955 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 131f 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 bb22 0000  a.........\f."..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 616e 1d00  ..d.S.).N../an..
+00000100: 0100 6400 5300 2906 4efa 012f 6116 2100  ..d.S.).N../a.!.
 00000110: 0069 6d70 6f72 7420 7379 730a 696d 706f  .import sys.impo
 00000120: 7274 206f 730a 696d 706f 7274 2067 630a  rt os.import gc.
 00000130: 696d 706f 7274 2070 7375 7469 6c0a 696d  import psutil.im
 00000140: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
 00000150: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
 00000160: 7320 7064 0a69 6d70 6f72 7420 6361 7462  s pd.import catb
 00000170: 6f6f 7374 0a66 726f 6d20 2e2e 2e6d 6f64  oost.from ...mod
@@ -29,486 +29,544 @@
 000001c0: 6574 5f6d 656d 5f6d 6178 0a66 726f 6d20  et_mem_max.from 
 000001d0: 2e2e 2e75 7469 6c2e 6e70 795f 6e75 6d62  ...util.npy_numb
 000001e0: 6120 696d 706f 7274 206e 705f 6765 742c  a import np_get,
 000001f0: 206e 705f 7365 742c 206e 705f 7365 745f   np_set, np_set_
 00000200: 6f72 6465 720a 6672 6f6d 202e 2e2e 7574  order.from ...ut
 00000210: 696c 2e72 756e 2069 6d70 6f72 7420 6765  il.run import ge
 00000220: 745f 616b 732c 2072 756e 5f66 756e 630a  t_aks, run_func.
-00000230: 0a0a 636c 6173 7320 4341 544d 6f64 656c  ..class CATModel
-00000240: 2842 6173 654d 6f64 656c 293a 0a20 2020  (BaseModel):.   
-00000250: 2064 6566 2067 6574 5f70 6172 616d 7328   def get_params(
-00000260: 7061 7261 6d73 5f69 6429 3a0a 2020 2020  params_id):.    
-00000270: 2020 2020 7061 7261 6d73 203d 204e 6f6e      params = Non
-00000280: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
-00000290: 616d 735f 6964 2069 6e20 5b27 7061 7261  ams_id in ['para
-000002a0: 6d73 5f31 275d 3a0a 2020 2020 2020 2020  ms_1']:.        
-000002b0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-000002c0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000002d0: 7461 736b 5f74 7970 6527 3a20 2743 5055  task_type': 'CPU
-000002e0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-000002f0: 2020 2023 2027 6465 7669 6365 7327 3a20     # 'devices': 
-00000300: 2730 3a31 3a32 3a33 272c 0a20 2020 2020  '0:1:2:3',.     
-00000310: 2020 2020 2020 2020 2020 2027 7261 6e64             'rand
-00000320: 6f6d 5f73 6565 6427 3a20 3737 372c 0a20  om_seed': 777,. 
-00000330: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000340: 6c6f 7373 5f66 756e 6374 696f 6e27 3a20  loss_function': 
-00000350: 2752 4d53 4527 2c0a 2020 2020 2020 2020  'RMSE',.        
-00000360: 2020 2020 2020 2020 2765 7661 6c5f 6d65          'eval_me
-00000370: 7472 6963 273a 2027 524d 5345 272c 0a20  tric': 'RMSE',. 
-00000380: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000390: 7468 7265 6164 5f63 6f75 6e74 273a 2036  thread_count': 6
-000003a0: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
-000003b0: 2020 2027 6c65 6172 6e69 6e67 5f72 6174     'learning_rat
-000003c0: 6527 3a20 302e 3031 2c0a 2020 2020 2020  e': 0.01,.      
-000003d0: 2020 2020 2020 2020 2020 2764 6570 7468            'depth
-000003e0: 273a 2038 2c0a 2020 2020 2020 2020 2020  ': 8,.          
-000003f0: 2020 2020 2020 2762 6167 6769 6e67 5f74        'bagging_t
-00000400: 656d 7065 7261 7475 7265 273a 2030 2e32  emperature': 0.2
-00000410: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00000420: 2020 2320 2772 6567 5f6c 616d 6264 6127    # 'reg_lambda'
-00000430: 3a36 342c 0a20 2020 2020 2020 2020 2020  :64,.           
-00000440: 2020 2020 2023 2027 6d69 6e5f 6461 7461       # 'min_data
-00000450: 5f69 6e5f 6c65 6166 273a 2031 3032 342c  _in_leaf': 1024,
-00000460: 2020 2320 6e6f 7420 776f 726b 2066 6f72    # not work for
-00000470: 2063 7075 2076 6572 7369 6f6e 0a20 2020   cpu version.   
-00000480: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00000490: 2020 2020 2020 2070 6172 616d 735b 276e         params['n
-000004a0: 5f65 7374 696d 6174 6f72 7327 5d20 3d20  _estimators'] = 
-000004b0: 3530 300a 2020 2020 2020 2020 6966 2070  500.        if p
-000004c0: 6172 616d 735f 6964 2069 6e20 5b27 7061  arams_id in ['pa
-000004d0: 7261 6d73 5f32 275d 3a0a 2020 2020 2020  rams_2']:.      
-000004e0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-000004f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000500: 2027 7461 736b 5f74 7970 6527 3a20 2743   'task_type': 'C
-00000510: 5055 272c 0a20 2020 2020 2020 2020 2020  PU',.           
-00000520: 2020 2020 2023 2027 6465 7669 6365 7327       # 'devices'
-00000530: 3a20 2730 3a31 3a32 3a33 272c 0a20 2020  : '0:1:2:3',.   
-00000540: 2020 2020 2020 2020 2020 2020 2027 7261               'ra
-00000550: 6e64 6f6d 5f73 6565 6427 3a20 3737 372c  ndom_seed': 777,
-00000560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000570: 2027 6c6f 7373 5f66 756e 6374 696f 6e27   'loss_function'
-00000580: 3a20 274c 6f67 6c6f 7373 272c 0a20 2020  : 'Logloss',.   
-00000590: 2020 2020 2020 2020 2020 2020 2027 6576               'ev
-000005a0: 616c 5f6d 6574 7269 6327 3a20 2750 5241  al_metric': 'PRA
-000005b0: 5543 272c 0a20 2020 2020 2020 2020 2020  UC',.           
-000005c0: 2020 2020 2027 7468 7265 6164 5f63 6f75       'thread_cou
-000005d0: 6e74 273a 2036 332c 0a20 2020 2020 2020  nt': 63,.       
-000005e0: 2020 2020 2020 2020 2027 6c65 6172 6e69           'learni
-000005f0: 6e67 5f72 6174 6527 3a20 302e 3031 2c0a  ng_rate': 0.01,.
-00000600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000610: 2764 6570 7468 273a 2038 2c0a 2020 2020  'depth': 8,.    
-00000620: 2020 2020 2020 2020 2020 2020 2762 6167              'bag
-00000630: 6769 6e67 5f74 656d 7065 7261 7475 7265  ging_temperature
-00000640: 273a 2030 2e32 2c0a 2020 2020 2020 2020  ': 0.2,.        
-00000650: 2020 2020 2020 2020 2320 2772 6567 5f6c          # 'reg_l
-00000660: 616d 6264 6127 3a36 342c 0a20 2020 2020  ambda':64,.     
-00000670: 2020 2020 2020 2020 2020 2023 2027 6d69             # 'mi
-00000680: 6e5f 6461 7461 5f69 6e5f 6c65 6166 273a  n_data_in_leaf':
-00000690: 2031 3032 342c 2020 2320 6e6f 7420 776f   1024,  # not wo
-000006a0: 726b 2066 6f72 2063 7075 2076 6572 7369  rk for cpu versi
-000006b0: 6f6e 0a20 2020 2020 2020 2020 2020 207d  on.            }
-000006c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000006d0: 616d 735b 276e 5f65 7374 696d 6174 6f72  ams['n_estimator
-000006e0: 7327 5d20 3d20 3530 300a 2020 2020 2020  s'] = 500.      
-000006f0: 2020 7265 7475 726e 2070 6172 616d 730a    return params.
-00000700: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00000710: 5f28 7365 6c66 2c20 6d6f 6465 6c5f 6e61  _(self, model_na
-00000720: 6d65 203d 204e 6f6e 6529 3a0a 2020 2020  me = None):.    
-00000730: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
-00000740: 6974 5f5f 286d 6f64 656c 5f6e 616d 6529  it__(model_name)
-00000750: 0a0a 2020 2020 6465 6620 7472 6169 6e28  ..    def train(
-00000760: 7365 6c66 2c20 5879 5f64 6963 742c 2070  self, Xy_dict, p
-00000770: 6172 616d 7320 3d20 4e6f 6e65 2c20 6b77  arams = None, kw
-00000780: 6172 6773 203d 204e 6f6e 6529 3a0a 2020  args = None):.  
-00000790: 2020 2020 2020 2320 7061 7261 6d73 0a20        # params. 
-000007a0: 2020 2020 2020 2070 6172 616d 735f 6964         params_id
-000007b0: 203d 206b 7761 7267 732e 6765 7428 2770   = kwargs.get('p
-000007c0: 6172 616d 735f 6964 272c 204e 6f6e 6529  arams_id', None)
-000007d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000007e0: 7061 7261 6d73 2069 7320 6e6f 7420 4e6f  params is not No
-000007f0: 6e65 206f 7220 7061 7261 6d73 5f69 6420  ne or params_id 
-00000800: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-00000810: 2020 2020 6966 2070 6172 616d 735f 6964      if params_id
-00000820: 2069 7320 6e6f 7420 4e6f 6e65 3a20 7061   is not None: pa
-00000830: 7261 6d73 203d 2043 4154 4d6f 6465 6c2e  rams = CATModel.
-00000840: 6765 745f 7061 7261 6d73 2870 6172 616d  get_params(param
-00000850: 735f 6964 290a 2020 2020 2020 2020 6e5f  s_id).        n_
-00000860: 626f 6f73 7420 3d20 6b77 6172 6773 2e67  boost = kwargs.g
-00000870: 6574 2827 6e5f 626f 6f73 7427 2c20 7061  et('n_boost', pa
-00000880: 7261 6d73 5b27 6e5f 6573 7469 6d61 746f  rams['n_estimato
-00000890: 7273 275d 290a 2020 2020 2020 2020 6b77  rs']).        kw
-000008a0: 6172 6773 5b27 6e5f 626f 6f73 7427 5d20  args['n_boost'] 
-000008b0: 3d20 6e5f 626f 6f73 740a 2020 2020 2020  = n_boost.      
-000008c0: 2020 7061 7261 6d73 5b27 6e5f 6573 7469    params['n_esti
-000008d0: 6d61 746f 7273 275d 203d 206e 5f62 6f6f  mators'] = n_boo
-000008e0: 7374 0a20 2020 2020 2020 2023 2064 656c  st.        # del
-000008f0: 2070 6172 616d 735b 276e 5f65 7374 696d   params['n_estim
-00000900: 6174 6f72 7327 5d0a 2020 2020 2020 2020  ators'].        
-00000910: 6b77 6172 6773 5b27 6d6f 6465 6c5f 6e61  kwargs['model_na
-00000920: 6d65 275d 203d 2073 656c 662e 6d6f 6465  me'] = self.mode
-00000930: 6c5f 6e61 6d65 0a20 2020 2020 2020 2073  l_name.        s
-00000940: 656c 662e 7061 7261 6d73 2c20 7365 6c66  elf.params, self
-00000950: 2e6b 7761 7267 7320 3d20 7061 7261 6d73  .kwargs = params
-00000960: 2c20 6b77 6172 6773 0a20 2020 2020 2020  , kwargs.       
-00000970: 200a 2020 2020 2020 2020 2320 6b77 6167   .        # kwag
-00000980: 7273 0a20 2020 2020 2020 2076 6572 626f  rs.        verbo
-00000990: 7365 203d 206b 7761 7267 732e 6765 7428  se = kwargs.get(
-000009a0: 2776 6572 626f 7365 272c 2031 3030 290a  'verbose', 100).
-000009b0: 2020 2020 2020 2020 7368 6f77 5f69 6e66          show_inf
-000009c0: 6f20 3d20 6b77 6172 6773 2e67 6574 2827  o = kwargs.get('
-000009d0: 7368 6f77 5f69 6e66 6f27 2c20 4661 6c73  show_info', Fals
-000009e0: 6529 0a20 2020 2020 2020 2069 6620 7368  e).        if sh
-000009f0: 6f77 5f69 6e66 6f3a 0a20 2020 2020 2020  ow_info:.       
-00000a00: 2020 2020 2070 7269 6e74 2866 275b 2b5d       print(f'[+]
-00000a10: 206b 7761 7267 7320 3d20 7b6b 7761 7267   kwargs = {kwarg
-00000a20: 737d 272c 2066 6c75 7368 3d54 7275 6529  s}', flush=True)
-00000a30: 3b20 7379 732e 7374 646f 7574 2e66 6c75  ; sys.stdout.flu
-00000a40: 7368 2829 0a20 2020 2020 2020 2020 2020  sh().           
-00000a50: 2070 7269 6e74 2866 275b 2b5d 2070 6172   print(f'[+] par
-00000a60: 616d 7320 3d20 7b70 6172 616d 737d 272c  ams = {params}',
-00000a70: 2066 6c75 7368 3d54 7275 6529 3b20 7379   flush=True); sy
-00000a80: 732e 7374 646f 7574 2e66 6c75 7368 2829  s.stdout.flush()
-00000a90: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00000aa0: 2020 2320 585f 7472 6169 6e0a 2020 2020    # X_train.    
-00000ab0: 2020 2020 585f 7472 6169 6e2c 2079 5f74      X_train, y_t
-00000ac0: 7261 696e 203d 2058 795f 6469 6374 5b27  rain = Xy_dict['
-00000ad0: 585f 7472 6169 6e27 5d2c 2058 795f 6469  X_train'], Xy_di
-00000ae0: 6374 5b27 795f 7472 6169 6e27 5d0a 2020  ct['y_train'].  
-00000af0: 2020 2020 2020 6966 2027 585f 7661 6c69        if 'X_vali
-00000b00: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
-00000b10: 7973 2829 2061 6e64 2027 585f 7661 6c69  ys() and 'X_vali
-00000b20: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
-00000b30: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00000b40: 2020 585f 7661 6c69 642c 2079 5f76 616c    X_valid, y_val
-00000b50: 6964 203d 2058 795f 6469 6374 5b27 585f  id = Xy_dict['X_
-00000b60: 7661 6c69 6427 5d2c 2058 795f 6469 6374  valid'], Xy_dict
-00000b70: 5b27 795f 7661 6c69 6427 5d0a 2020 2020  ['y_valid'].    
-00000b80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00000b90: 2020 2020 2020 585f 7661 6c69 642c 2079        X_valid, y
-00000ba0: 5f76 616c 6964 203d 2058 795f 6469 6374  _valid = Xy_dict
-00000bb0: 5b27 585f 7472 6169 6e27 5d5b 2d31 303a  ['X_train'][-10:
-00000bc0: 5d2e 636f 7079 2829 2c20 5879 5f64 6963  ].copy(), Xy_dic
-00000bd0: 745b 2779 5f74 7261 696e 275d 5b2d 3130  t['y_train'][-10
-00000be0: 3a5d 2e63 6f70 7928 290a 2020 2020 2020  :].copy().      
-00000bf0: 2020 6966 206b 7761 7267 732e 6765 7428    if kwargs.get(
-00000c00: 2766 7265 655f 5879 272c 2054 7275 6529  'free_Xy', True)
-00000c10: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
-00000c20: 6c20 5879 5f64 6963 745b 2758 5f74 7261  l Xy_dict['X_tra
-00000c30: 696e 275d 2c20 5879 5f64 6963 745b 2779  in'], Xy_dict['y
-00000c40: 5f74 7261 696e 275d 3b20 6763 2e63 6f6c  _train']; gc.col
-00000c50: 6c65 6374 2829 0a20 2020 2020 2020 2020  lect().         
-00000c60: 2020 2069 6620 2758 5f76 616c 6964 2720     if 'X_valid' 
-00000c70: 696e 2058 795f 6469 6374 2e6b 6579 7328  in Xy_dict.keys(
-00000c80: 2920 616e 6420 2779 5f76 616c 6964 2720  ) and 'y_valid' 
-00000c90: 696e 2058 795f 6469 6374 2e6b 6579 7328  in Xy_dict.keys(
-00000ca0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00000cb0: 2020 2064 656c 2058 795f 6469 6374 5b27     del Xy_dict['
-00000cc0: 585f 7661 6c69 6427 5d2c 2058 795f 6469  X_valid'], Xy_di
-00000cd0: 6374 5b27 795f 7661 6c69 6427 5d3b 2067  ct['y_valid']; g
-00000ce0: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
-00000cf0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00000d00: 2023 2064 7472 6169 6e0a 2020 2020 2020   # dtrain.      
-00000d10: 2020 6966 2073 686f 775f 696e 666f 3a0a    if show_info:.
-00000d20: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00000d30: 7428 6627 5b2b 5d20 585f 7472 6169 6e2e  t(f'[+] X_train.
-00000d40: 7368 6170 6520 3d20 7b58 5f74 7261 696e  shape = {X_train
-00000d50: 2e73 6861 7065 7d27 2c20 666c 7573 683d  .shape}', flush=
-00000d60: 5472 7565 293b 2073 7973 2e73 7464 6f75  True); sys.stdou
-00000d70: 742e 666c 7573 6828 290a 2020 2020 2020  t.flush().      
-00000d80: 2020 2020 2020 7072 696e 7428 6627 5b2b        print(f'[+
-00000d90: 5d20 585f 7661 6c69 642e 7368 6170 6520  ] X_valid.shape 
-00000da0: 3d20 7b58 5f76 616c 6964 2e73 6861 7065  = {X_valid.shape
-00000db0: 7d27 2c20 666c 7573 683d 5472 7565 293b  }', flush=True);
-00000dc0: 2073 7973 2e73 7464 6f75 742e 666c 7573   sys.stdout.flus
-00000dd0: 6828 290a 2020 2020 2020 2020 2020 2020  h().            
-00000de0: 7072 696e 7428 6627 5b2b 5d20 6474 7261  print(f'[+] dtra
-00000df0: 696e 2062 6566 6f72 6527 293b 2067 6574  in before'); get
-00000e00: 5f6d 656d 5f63 7572 2829 2c20 6765 745f  _mem_cur(), get_
-00000e10: 6d65 6d5f 6d61 7828 290a 2020 2020 2020  mem_max().      
-00000e20: 2020 6474 7261 696e 203d 2063 6174 626f    dtrain = catbo
-00000e30: 6f73 742e 506f 6f6c 286e 705f 7365 745f  ost.Pool(np_set_
-00000e40: 6f72 6465 7228 585f 7472 6169 6e29 2c20  order(X_train), 
-00000e50: 795f 7472 6169 6e29 0a20 2020 2020 2020  y_train).       
-00000e60: 2064 7661 6c69 6420 3d20 6361 7462 6f6f   dvalid = catboo
-00000e70: 7374 2e50 6f6f 6c28 6e70 5f73 6574 5f6f  st.Pool(np_set_o
-00000e80: 7264 6572 2858 5f76 616c 6964 292c 2079  rder(X_valid), y
-00000e90: 5f76 616c 6964 290a 2020 2020 2020 2020  _valid).        
-00000ea0: 6966 2073 686f 775f 696e 666f 3a20 7072  if show_info: pr
-00000eb0: 696e 7428 275b 2b5d 2064 7472 6169 6e20  int('[+] dtrain 
-00000ec0: 6166 7465 7227 293b 2067 6574 5f6d 656d  after'); get_mem
-00000ed0: 5f63 7572 2829 2c20 6765 745f 6d65 6d5f  _cur(), get_mem_
-00000ee0: 6d61 7828 290a 2020 2020 2020 2020 6465  max().        de
-00000ef0: 6c20 585f 7472 6169 6e2c 2079 5f74 7261  l X_train, y_tra
-00000f00: 696e 2c20 585f 7661 6c69 642c 2079 5f76  in, X_valid, y_v
-00000f10: 616c 6964 3b20 6763 2e63 6f6c 6c65 6374  alid; gc.collect
-00000f20: 2829 0a0a 2020 2020 2020 2020 2320 7472  ()..        # tr
-00000f30: 6169 6e0a 2020 2020 2020 2020 6361 745f  ain.        cat_
-00000f40: 6665 6174 7572 6573 203d 206b 7761 7267  features = kwarg
-00000f50: 732e 6765 7428 2763 6174 5f66 6561 7475  s.get('cat_featu
-00000f60: 7265 7327 2c20 5b5d 290a 2020 2020 2020  res', []).      
-00000f70: 2020 6966 2070 6172 616d 735b 276c 6f73    if params['los
-00000f80: 735f 6675 6e63 7469 6f6e 275d 2069 6e20  s_function'] in 
-00000f90: 5b27 524d 5345 272c 2027 4d75 6c74 6952  ['RMSE', 'MultiR
-00000fa0: 4d53 4527 2c20 2753 7572 7669 7661 6c41  MSE', 'SurvivalA
-00000fb0: 6674 272c 2027 4d41 4527 2c20 2751 7561  ft', 'MAE', 'Qua
-00000fc0: 6e74 696c 6527 2c20 274c 6f67 4c69 6e51  ntile', 'LogLinQ
-00000fd0: 7561 6e74 696c 6527 2c20 2750 6f69 7373  uantile', 'Poiss
-00000fe0: 6f6e 272c 2027 4d41 5045 272c 2027 4c71  on', 'MAPE', 'Lq
-00000ff0: 275d 3a0a 2020 2020 2020 2020 2020 2020  ']:.            
-00001000: 636c 7320 3d20 6361 7462 6f6f 7374 2e43  cls = catboost.C
-00001010: 6174 426f 6f73 7452 6567 7265 7373 6f72  atBoostRegressor
-00001020: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00001030: 2020 2020 2020 2020 2020 2063 6c73 203d             cls =
-00001040: 2063 6174 626f 6f73 742e 4361 7442 6f6f   catboost.CatBoo
-00001050: 7374 436c 6173 7369 6669 6572 0a20 2020  stClassifier.   
-00001060: 2020 2020 206d 6f64 656c 203d 2063 6c73       model = cls
-00001070: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00001080: 2020 2020 2020 2320 6e75 6d5f 626f 6f73        # num_boos
-00001090: 745f 726f 756e 6420 3d20 6e5f 626f 6f73  t_round = n_boos
-000010a0: 742c 200a 2020 2020 2020 2020 2020 2020  t, .            
-000010b0: 2020 2020 2020 2020 6f64 5f74 7970 6520          od_type 
-000010c0: 3d20 2749 7465 7227 2c0a 2020 2020 2020  = 'Iter',.      
-000010d0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000010e0: 6561 726c 795f 7374 6f70 7069 6e67 5f72  early_stopping_r
-000010f0: 6f75 6e64 7320 3d20 3130 302c 200a 2020  ounds = 100, .  
-00001100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001110: 2020 7665 7262 6f73 6520 3d20 4661 6c73    verbose = Fals
-00001120: 6520 6966 2076 6572 626f 7365 203c 2030  e if verbose < 0
-00001130: 2065 6c73 6520 7665 7262 6f73 652c 0a20   else verbose,. 
-00001140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001150: 2020 2063 6174 5f66 6561 7475 7265 7320     cat_features 
-00001160: 3d20 6361 745f 6665 6174 7572 6573 2c0a  = cat_features,.
-00001170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001180: 290a 2020 2020 2020 2020 6d6f 6465 6c2e  ).        model.
-00001190: 7365 745f 7061 7261 6d73 282a 2a70 6172  set_params(**par
-000011a0: 616d 7329 0a20 2020 2020 2020 206d 6f64  ams).        mod
-000011b0: 656c 2e66 6974 2864 7472 6169 6e29 0a20  el.fit(dtrain). 
-000011c0: 2020 2020 2020 2023 206d 6f64 656c 2e66         # model.f
-000011d0: 6974 2864 7472 6169 6e2c 2065 7661 6c5f  it(dtrain, eval_
-000011e0: 7365 743d 5b64 7661 6c69 645d 290a 2020  set=[dvalid]).  
-000011f0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-00001200: 203d 206d 6f64 656c 0a20 2020 2020 2020   = model.       
-00001210: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00001220: 2020 6465 6620 727a 5f70 7265 6469 6374    def rz_predict
-00001230: 2873 656c 662c 2058 2c20 6e5f 6a6f 6273  (self, X, n_jobs
-00001240: 203d 2038 2c20 6b74 696d 6573 203d 2034   = 8, ktimes = 4
-00001250: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
-00001260: 6529 3a0a 2020 2020 2020 2020 795f 7072  e):.        y_pr
-00001270: 6564 203d 206e 702e 656d 7074 7928 6c65  ed = np.empty(le
-00001280: 6e28 5829 2c20 6474 7970 6520 3d20 6e70  n(X), dtype = np
-00001290: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
-000012a0: 2020 6465 6620 727a 5f72 756e 2870 312c    def rz_run(p1,
-000012b0: 2070 3229 3a0a 2020 2020 2020 2020 2020   p2):.          
-000012c0: 2020 6966 2070 3120 3e3d 2070 323a 2072    if p1 >= p2: r
-000012d0: 6574 7572 6e0a 2020 2020 2020 2020 2020  eturn.          
-000012e0: 2020 795f 7072 6564 5b70 313a 7032 5d20    y_pred[p1:p2] 
-000012f0: 3d20 7365 6c66 2e6d 6f64 656c 2e70 7265  = self.model.pre
-00001300: 6469 6374 2863 6174 626f 6f73 742e 506f  dict(catboost.Po
-00001310: 6f6c 2858 5b70 313a 7032 5d29 290a 2020  ol(X[p1:p2])).  
-00001320: 2020 2020 2020 616b 7320 3d20 6765 745f        aks = get_
-00001330: 616b 7328 6c65 6e28 5829 2c20 6e5f 6a6f  aks(len(X), n_jo
-00001340: 6273 202a 206b 7469 6d65 7329 0a20 2020  bs * ktimes).   
-00001350: 2020 2020 205f 203d 2072 756e 5f66 756e       _ = run_fun
-00001360: 6328 727a 5f72 756e 2c20 616b 732c 206e  c(rz_run, aks, n
-00001370: 5f6a 6f62 7320 3d20 6e5f 6a6f 6273 2c20  _jobs = n_jobs, 
-00001380: 6d6f 6465 203d 2027 736d 272c 2076 6572  mode = 'sm', ver
-00001390: 626f 7365 203d 2076 6572 626f 7365 290a  bose = verbose).
-000013a0: 2020 2020 2020 2020 7265 7475 726e 2079          return y
-000013b0: 5f70 7265 640a 0a20 2020 2064 6566 2070  _pred..    def p
-000013c0: 7265 6469 6374 2873 656c 662c 2058 2c20  redict(self, X, 
-000013d0: 7061 7261 6d73 203d 204e 6f6e 652c 206b  params = None, k
-000013e0: 7761 7267 7320 3d20 4e6f 6e65 2c20 6d65  wargs = None, me
-000013f0: 7468 6f64 203d 2027 7261 7727 2c20 6e5f  thod = 'raw', n_
-00001400: 6a6f 6273 203d 2038 2c20 6b74 696d 6573  jobs = 8, ktimes
-00001410: 203d 202d 312c 2076 6572 626f 7365 203d   = -1, verbose =
-00001420: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
-00001430: 2058 203d 206e 705f 7365 745f 6f72 6465   X = np_set_orde
-00001440: 7228 5829 0a20 2020 2020 2020 2069 6620  r(X).        if 
-00001450: 6d65 7468 6f64 203d 3d20 2772 7a27 3a20  method == 'rz': 
-00001460: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00001470: 6b74 696d 6573 203d 3d20 2d31 3a20 6b74  ktimes == -1: kt
-00001480: 696d 6573 203d 2069 6e74 286d 6178 2831  imes = int(max(1
-00001490: 2c20 6c65 6e28 5829 202f 2f20 2834 6537  , len(X) // (4e7
-000014a0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-000014b0: 7265 7475 726e 2073 656c 662e 727a 5f70  return self.rz_p
-000014c0: 7265 6469 6374 2858 2c20 6e5f 6a6f 6273  redict(X, n_jobs
-000014d0: 2c20 6b74 696d 6573 2c20 7665 7262 6f73  , ktimes, verbos
-000014e0: 6529 0a20 2020 2020 2020 2069 6620 2743  e).        if 'C
-000014f0: 6174 426f 6f73 7443 6c61 7373 6966 6965  atBoostClassifie
-00001500: 7227 2069 6e20 7374 7228 7479 7065 2873  r' in str(type(s
-00001510: 656c 662e 6d6f 6465 6c29 293a 0a20 2020  elf.model)):.   
-00001520: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00001530: 7365 6c66 2e6d 6f64 656c 2e70 7265 6469  self.model.predi
-00001540: 6374 5f70 726f 6261 2863 6174 626f 6f73  ct_proba(catboos
-00001550: 742e 506f 6f6c 2858 2929 0a20 2020 2020  t.Pool(X)).     
-00001560: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00001570: 6f64 656c 2e70 7265 6469 6374 2863 6174  odel.predict(cat
-00001580: 626f 6f73 742e 506f 6f6c 2858 2929 0a0a  boost.Pool(X))..
-00001590: 2020 2020 6465 6620 6765 745f 6e5f 6665      def get_n_fe
-000015a0: 6174 7572 6573 2873 656c 6629 3a0a 2020  atures(self):.  
-000015b0: 2020 2020 2020 7265 7475 726e 206c 656e        return len
-000015c0: 2873 656c 662e 6d6f 6465 6c2e 6665 6174  (self.model.feat
-000015d0: 7572 655f 6e61 6d65 735f 290a 0a20 2020  ure_names_)..   
-000015e0: 2064 6566 2067 6574 5f64 665f 696d 7028   def get_df_imp(
-000015f0: 7365 6c66 2c20 636f 6c73 5f66 6561 203d  self, cols_fea =
-00001600: 204e 6f6e 652c 2070 6c6f 7420 3d20 4661   None, plot = Fa
-00001610: 6c73 652c 206b 203d 2032 302c 2066 6967  lse, k = 20, fig
-00001620: 7369 7a65 203d 2028 3230 2c20 3130 2929  size = (20, 10))
-00001630: 3a0a 2020 2020 2020 2020 696d 7020 3d20  :.        imp = 
-00001640: 7365 6c66 2e6d 6f64 656c 2e66 6561 7475  self.model.featu
-00001650: 7265 5f69 6d70 6f72 7461 6e63 6573 5f0a  re_importances_.
-00001660: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00001670: 7570 6572 2829 2e5f 6765 745f 6466 5f69  uper()._get_df_i
-00001680: 6d70 2869 6d70 2c20 636f 6c73 5f66 6561  mp(imp, cols_fea
-00001690: 2c20 706c 6f74 2c20 6b2c 2066 6967 7369  , plot, k, figsi
-000016a0: 7a65 203d 2066 6967 7369 7a65 290a 2020  ze = figsize).  
-000016b0: 2020 0a20 2020 2064 6566 2064 756d 7028    .    def dump(
-000016c0: 7365 6c66 2c20 7061 7468 293a 0a20 2020  self, path):.   
-000016d0: 2020 2020 206f 732e 7379 7374 656d 2827       os.system('
-000016e0: 726d 202d 7266 207b 7061 7468 7d27 290a  rm -rf {path}').
-000016f0: 2020 2020 2020 2020 6f73 2e6d 616b 6564          os.maked
-00001700: 6972 7328 7061 7468 2c20 6578 6973 745f  irs(path, exist_
-00001710: 6f6b 203d 2054 7275 6529 0a20 2020 2020  ok = True).     
-00001720: 2020 2073 656c 662e 6d6f 6465 6c2e 7361     self.model.sa
-00001730: 7665 5f6d 6f64 656c 2866 277b 7061 7468  ve_model(f'{path
-00001740: 7d2f 6d6f 6465 6c2e 6269 6e27 290a 2020  }/model.bin').  
-00001750: 2020 2020 2020 7375 7065 7228 292e 5f64        super()._d
-00001760: 756d 705f 6f74 6865 7228 7061 7468 290a  ump_other(path).
-00001770: 2020 2020 0a20 2020 2064 6566 206c 6f61      .    def loa
-00001780: 6428 7365 6c66 2c20 7061 7468 293a 0a20  d(self, path):. 
-00001790: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-000017a0: 6c20 3d20 6361 7462 6f6f 7374 2e43 6174  l = catboost.Cat
-000017b0: 426f 6f73 7452 6567 7265 7373 6f72 2829  BoostRegressor()
-000017c0: 2e6c 6f61 645f 6d6f 6465 6c28 666e 616d  .load_model(fnam
-000017d0: 6520 3d20 6627 7b70 6174 687d 2f6d 6f64  e = f'{path}/mod
-000017e0: 656c 2e62 696e 2729 0a20 2020 2020 2020  el.bin').       
-000017f0: 2073 7570 6572 2829 2e5f 6c6f 6164 5f6f   super()._load_o
-00001800: 7468 6572 2870 6174 6829 0a20 2020 2020  ther(path).     
-00001810: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
-00001820: 5c27 5c27 5c27 0a2f 5573 6572 732f 7275  \'\'\'./Users/ru
-00001830: 6e6e 696e 677a 2f61 6e61 636f 6e64 6133  nningz/anaconda3
-00001840: 2f65 6e76 732f 7079 3339 2f6c 6962 2f70  /envs/py39/lib/p
-00001850: 7974 686f 6e33 2e39 2f73 6974 652d 7061  ython3.9/site-pa
-00001860: 636b 6167 6573 2f6c 6967 6874 6762 6d2f  ckages/lightgbm/
-00001870: 5f5f 696e 6974 5f5f 2e70 7920 332e 332e  __init__.py 3.3.
-00001880: 350a 2f55 7365 7273 2f72 756e 6e69 6e67  5./Users/running
-00001890: 7a2f 616e 6163 6f6e 6461 332f 656e 7673  z/anaconda3/envs
-000018a0: 2f70 7933 392f 6c69 622f 7079 7468 6f6e  /py39/lib/python
-000018b0: 332e 392f 7369 7465 2d70 6163 6b61 6765  3.9/site-package
-000018c0: 732f 6361 7462 6f6f 7374 2f5f 5f69 6e69  s/catboost/__ini
-000018d0: 745f 5f2e 7079 2031 2e31 2e31 0a5b 2b5d  t__.py 1.1.1.[+]
-000018e0: 2074 7261 696e 0a5b 3230 3233 2f30 332f   train.[2023/03/
-000018f0: 3138 2031 343a 3438 3a35 325d 206d 656d  18 14:48:52] mem
-00001900: 5f63 7572 203d 2034 2e30 3047 4220 3d20  _cur = 4.00GB = 
-00001910: 342c 3239 302c 3736 302c 3730 340a 5b32  4,290,760,704.[2
-00001920: 3032 332f 3033 2f31 3820 3134 3a34 383a  023/03/18 14:48:
-00001930: 3532 5d20 6d65 6d5f 6d61 7820 3d20 342e  52] mem_max = 4.
-00001940: 3030 4742 203d 2034 2c32 3930 2c37 3630  00GB = 4,290,760
-00001950: 2c37 3034 0a5b 2b5d 206d 6f64 656c 5f6e  ,704.[+] model_n
-00001960: 616d 6520 3d20 4341 544d 6f64 656c 0a5b  ame = CATModel.[
-00001970: 2b5d 206b 7761 7267 7320 3d20 7b27 7061  +] kwargs = {'pa
-00001980: 7261 6d73 5f69 6427 3a20 2770 6172 616d  rams_id': 'param
-00001990: 735f 3127 2c20 276e 5f62 6f6f 7374 273a  s_1', 'n_boost':
-000019a0: 2031 302c 2027 7368 6f77 5f69 6e66 6f27   10, 'show_info'
-000019b0: 3a20 5472 7565 2c20 2766 7265 655f 5879  : True, 'free_Xy
-000019c0: 273a 2054 7275 657d 0a5b 2b5d 2070 6172  ': True}.[+] par
-000019d0: 616d 7320 3d20 7b27 7461 736b 5f74 7970  ams = {'task_typ
-000019e0: 6527 3a20 2743 5055 272c 2027 7261 6e64  e': 'CPU', 'rand
-000019f0: 6f6d 5f73 6565 6427 3a20 3432 2c20 276c  om_seed': 42, 'l
-00001a00: 6f73 735f 6675 6e63 7469 6f6e 273a 2027  oss_function': '
-00001a10: 524d 5345 272c 2027 6576 616c 5f6d 6574  RMSE', 'eval_met
-00001a20: 7269 6327 3a20 2752 4d53 4527 2c20 2774  ric': 'RMSE', 't
-00001a30: 6872 6561 645f 636f 756e 7427 3a20 3332  hread_count': 32
-00001a40: 2c20 276c 6561 726e 696e 675f 7261 7465  , 'learning_rate
-00001a50: 273a 2030 2e30 312c 2027 6465 7074 6827  ': 0.01, 'depth'
-00001a60: 3a20 382c 2027 6261 6767 696e 675f 7465  : 8, 'bagging_te
-00001a70: 6d70 6572 6174 7572 6527 3a20 302e 327d  mperature': 0.2}
-00001a80: 0a5b 2b5d 2058 5f74 7261 696e 2e73 6861  .[+] X_train.sha
-00001a90: 7065 203d 2028 3130 3030 3030 3030 2c20  pe = (10000000, 
-00001aa0: 3130 3029 0a5b 2b5d 2058 5f76 616c 6964  100).[+] X_valid
-00001ab0: 2e73 6861 7065 203d 2028 3130 2c20 3130  .shape = (10, 10
-00001ac0: 3029 0a5b 2b5d 2062 6566 6f72 650a 5b32  0).[+] before.[2
-00001ad0: 3032 332f 3033 2f31 3820 3134 3a34 383a  023/03/18 14:48:
-00001ae0: 3532 5d20 6d65 6d5f 6375 7220 3d20 342e  52] mem_cur = 4.
-00001af0: 3030 4742 203d 2034 2c32 3930 2c37 3630  00GB = 4,290,760
-00001b00: 2c37 3034 0a5b 3230 3233 2f30 332f 3138  ,704.[2023/03/18
-00001b10: 2031 343a 3438 3a35 325d 206d 656d 5f6d   14:48:52] mem_m
-00001b20: 6178 203d 2034 2e30 3047 4220 3d20 342c  ax = 4.00GB = 4,
-00001b30: 3239 302c 3736 302c 3730 340a 5b2b 5d20  290,760,704.[+] 
-00001b40: 6166 7465 6572 0a5b 3230 3233 2f30 332f  afteer.[2023/03/
-00001b50: 3138 2031 343a 3439 3a30 305d 206d 656d  18 14:49:00] mem
-00001b60: 5f63 7572 203d 2036 2e33 3847 4220 3d20  _cur = 6.38GB = 
-00001b70: 362c 3835 332c 3835 372c 3238 300a 5b32  6,853,857,280.[2
-00001b80: 3032 332f 3033 2f31 3820 3134 3a34 393a  023/03/18 14:49:
-00001b90: 3030 5d20 6d65 6d5f 6d61 7820 3d20 362e  00] mem_max = 6.
-00001ba0: 3435 4742 203d 2036 2c39 3230 2c34 3435  45GB = 6,920,445
-00001bb0: 2c39 3532 0a54 4242 2057 6172 6e69 6e67  ,952.TBB Warning
-00001bc0: 3a20 5468 6520 6e75 6d62 6572 206f 6620  : The number of 
-00001bd0: 776f 726b 6572 7320 6973 2063 7572 7265  workers is curre
-00001be0: 6e74 6c79 206c 696d 6974 6564 2074 6f20  ntly limited to 
-00001bf0: 372e 2054 6865 2072 6571 7565 7374 2066  7. The request f
-00001c00: 6f72 2033 3120 776f 726b 6572 7320 6973  or 31 workers is
-00001c10: 2069 676e 6f72 6564 2e20 4675 7274 6865   ignored. Furthe
-00001c20: 7220 7265 7175 6573 7473 2066 6f72 206d  r requests for m
-00001c30: 6f72 6520 776f 726b 6572 7320 7769 6c6c  ore workers will
-00001c40: 2062 6520 7369 6c65 6e74 6c79 2069 676e   be silently ign
-00001c50: 6f72 6564 2075 6e74 696c 2074 6865 206c  ored until the l
-00001c60: 696d 6974 2063 6861 6e67 6573 2e0a 0a30  imit changes...0
-00001c70: 3a20 2020 2020 206c 6561 726e 3a20 302e  :      learn: 0.
-00001c80: 3238 3836 3839 3120 2020 2020 2020 2074  2886891        t
-00001c90: 6f74 616c 3a20 312e 3635 7320 2020 2072  otal: 1.65s    r
-00001ca0: 656d 6169 6e69 6e67 3a20 3134 2e39 730a  emaining: 14.9s.
-00001cb0: 393a 2020 2020 2020 6c65 6172 6e3a 2030  9:      learn: 0
-00001cc0: 2e32 3838 3638 3832 2020 2020 2020 2020  .2886882        
-00001cd0: 746f 7461 6c3a 2031 342e 3473 2020 2020  total: 14.4s    
-00001ce0: 7265 6d61 696e 696e 673a 2030 7573 0a5b  remaining: 0us.[
-00001cf0: 2b5d 2070 7265 6469 6374 0a5b 3230 3233  +] predict.[2023
-00001d00: 2f30 332f 3138 2031 343a 3439 3a34 305d  /03/18 14:49:40]
-00001d10: 206d 656d 5f63 7572 203d 2034 2e38 3147   mem_cur = 4.81G
-00001d20: 4220 3d20 352c 3136 322c 3237 382c 3931  B = 5,162,278,91
-00001d30: 320a 5b32 3032 332f 3033 2f31 3820 3134  2.[2023/03/18 14
-00001d40: 3a34 393a 3430 5d20 6d65 6d5f 6d61 7820  :49:40] mem_max 
-00001d50: 3d20 362e 3537 4742 203d 2037 2c30 3534  = 6.57GB = 7,054
-00001d60: 2c38 3032 2c39 3434 0a30 2e32 3435 3532  ,802,944.0.24552
-00001d70: 3139 3437 3038 3831 3738 3638 0a5b 2b5d  194708817868.[+]
-00001d80: 2067 6574 5f64 665f 696d 700a 2020 2020   get_df_imp.    
-00001d90: 2020 2020 696d 7020 636f 6c0a 3020 2030      imp col.0  0
-00001da0: 2e30 3030 3030 3020 2078 300a 3120 2030  .000000  x0.1  0
-00001db0: 2e30 3030 3030 3020 2078 310a 3220 2033  .000000  x1.2  3
-00001dc0: 2e39 3233 3431 3820 2078 320a 3320 2030  .923418  x2.3  0
-00001dd0: 2e30 3030 3030 3020 2078 330a 3420 2030  .000000  x3.4  0
-00001de0: 2e30 3030 3030 3020 2078 340a 5b2b 5d20  .000000  x4.[+] 
-00001df0: 6475 6d70 0a5b 2b5d 206c 6f61 640a 302e  dump.[+] load.0.
-00001e00: 300a 5b2b 5d20 446f 6e65 0a5b 3230 3233  0.[+] Done.[2023
-00001e10: 2f30 332f 3138 2031 343a 3439 3a34 305d  /03/18 14:49:40]
-00001e20: 206d 656d 5f63 7572 203d 2034 2e34 3447   mem_cur = 4.44G
-00001e30: 4220 3d20 342c 3736 332c 3338 312c 3736  B = 4,763,381,76
-00001e40: 300a 5b32 3032 332f 3033 2f31 3820 3134  0.[2023/03/18 14
-00001e50: 3a34 393a 3430 5d20 6d65 6d5f 6d61 7820  :49:40] mem_max 
-00001e60: 3d20 362e 3537 4742 203d 2037 2c30 3534  = 6.57GB = 7,054
-00001e70: 2c38 3032 2c39 3434 0a5c 275c 275c 277a  ,802,944.\'\'\'z
-00001e80: 065c 275c 275c 277a 0327 2727 da01 7729  .\'\'\'z.'''..w)
-00001e90: 07da 026f 73da 0470 6174 68da 0764 6972  ...os..path..dir
-00001ea0: 6e61 6d65 da08 5f5f 6669 6c65 5f5f da07  name..__file__..
-00001eb0: 7265 706c 6163 65da 046f 7065 6eda 0577  replace..open..w
-00001ec0: 7269 7465 2904 da06 6f75 7470 7574 5a0b  rite)...outputZ.
-00001ed0: 7061 7468 5f6f 7574 7075 74da 0173 da01  path_output..s..
-00001ee0: 66a9 0072 0e00 0000 fa46 6275 696c 642f  f..r.....Fbuild/
-00001ef0: 6264 6973 742e 6d61 636f 7378 2d31 302e  bdist.macosx-10.
-00001f00: 392d 7838 365f 3634 2f65 6767 2f72 756e  9-x86_64/egg/run
-00001f10: 6e69 6e67 7a2f 6d6f 6465 6c2f 7472 6565  ningz/model/tree
-00001f20: 2f6d 6f64 656c 5f63 6174 5f70 792e 7079  /model_cat_py.py
-00001f30: da03 7275 6e04 0000 0073 0c00 0000 0001  ..run....s......
-00001f40: 1401 047f 003a 0c01 0c01 7210 0000 00da  .....:....r.....
-00001f50: 085f 5f6d 6169 6e5f 5f7a 082d 2d6f 7574  .__main__z.--out
-00001f60: 7075 7454 2902 da04 7479 7065 da08 7265  putT)...type..re
-00001f70: 7175 6972 6564 290c 7204 0000 00da 0373  quired).r......s
-00001f80: 7973 7210 0000 00da 085f 5f6e 616d 655f  ysr......__name_
-00001f90: 5fda 0861 7267 7061 7273 65da 0e41 7267  _..argparse..Arg
-00001fa0: 756d 656e 7450 6172 7365 72da 0670 6172  umentParser..par
-00001fb0: 7365 72da 0c61 6464 5f61 7267 756d 656e  ser..add_argumen
-00001fc0: 74da 0373 7472 da0a 7061 7273 655f 6172  t..str..parse_ar
-00001fd0: 6773 da04 6172 6773 720b 0000 0072 0e00  gs..argsr....r..
-00001fe0: 0000 720e 0000 0072 0e00 0000 720f 0000  ..r....r....r...
-00001ff0: 00da 083c 6d6f 6475 6c65 3e02 0000 0073  ...<module>....s
-00002000: 1200 0000 0801 0801 087f 0040 0801 0801  ...........@....
-00002010: 0801 1001 0801                           ......
+00000230: 6672 6f6d 202e 2e2e 7574 696c 2e6e 7079  from ...util.npy
+00000240: 5f6e 756d 6261 2069 6d70 6f72 7420 6e70  _numba import np
+00000250: 5f69 6e66 5f61 735f 6e61 6e5f 696e 706c  _inf_as_nan_inpl
+00000260: 6163 652c 206e 705f 6669 6c6c 5f76 5f69  ace, np_fill_v_i
+00000270: 6e70 6c61 6365 2c20 6e70 5f63 6c69 705f  nplace, np_clip_
+00000280: 6d69 6e5f 6d61 785f 696e 706c 6163 650a  min_max_inplace.
+00000290: 0a0a 636c 6173 7320 4341 544d 6f64 656c  ..class CATModel
+000002a0: 2842 6173 654d 6f64 656c 293a 0a20 2020  (BaseModel):.   
+000002b0: 2064 6566 2067 6574 5f70 6172 616d 7328   def get_params(
+000002c0: 7061 7261 6d73 5f69 6429 3a0a 2020 2020  params_id):.    
+000002d0: 2020 2020 7061 7261 6d73 203d 204e 6f6e      params = Non
+000002e0: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
+000002f0: 616d 735f 6964 2069 6e20 5b27 7061 7261  ams_id in ['para
+00000300: 6d73 5f31 275d 3a0a 2020 2020 2020 2020  ms_1']:.        
+00000310: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+00000320: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00000330: 7461 736b 5f74 7970 6527 3a20 2743 5055  task_type': 'CPU
+00000340: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00000350: 2020 2023 2027 6465 7669 6365 7327 3a20     # 'devices': 
+00000360: 2730 3a31 3a32 3a33 272c 0a20 2020 2020  '0:1:2:3',.     
+00000370: 2020 2020 2020 2020 2020 2027 7261 6e64             'rand
+00000380: 6f6d 5f73 6565 6427 3a20 3737 372c 0a20  om_seed': 777,. 
+00000390: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000003a0: 6c6f 7373 5f66 756e 6374 696f 6e27 3a20  loss_function': 
+000003b0: 2752 4d53 4527 2c0a 2020 2020 2020 2020  'RMSE',.        
+000003c0: 2020 2020 2020 2020 2765 7661 6c5f 6d65          'eval_me
+000003d0: 7472 6963 273a 2027 524d 5345 272c 0a20  tric': 'RMSE',. 
+000003e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000003f0: 7468 7265 6164 5f63 6f75 6e74 273a 2036  thread_count': 6
+00000400: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
+00000410: 2020 2027 6c65 6172 6e69 6e67 5f72 6174     'learning_rat
+00000420: 6527 3a20 302e 3031 2c0a 2020 2020 2020  e': 0.01,.      
+00000430: 2020 2020 2020 2020 2020 2764 6570 7468            'depth
+00000440: 273a 2038 2c0a 2020 2020 2020 2020 2020  ': 8,.          
+00000450: 2020 2020 2020 2762 6167 6769 6e67 5f74        'bagging_t
+00000460: 656d 7065 7261 7475 7265 273a 2030 2e32  emperature': 0.2
+00000470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00000480: 2020 2320 2772 6567 5f6c 616d 6264 6127    # 'reg_lambda'
+00000490: 3a36 342c 0a20 2020 2020 2020 2020 2020  :64,.           
+000004a0: 2020 2020 2023 2027 6d69 6e5f 6461 7461       # 'min_data
+000004b0: 5f69 6e5f 6c65 6166 273a 2031 3032 342c  _in_leaf': 1024,
+000004c0: 2020 2320 6e6f 7420 776f 726b 2066 6f72    # not work for
+000004d0: 2063 7075 2076 6572 7369 6f6e 0a20 2020   cpu version.   
+000004e0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+000004f0: 2020 2020 2020 2070 6172 616d 735b 276e         params['n
+00000500: 5f65 7374 696d 6174 6f72 7327 5d20 3d20  _estimators'] = 
+00000510: 3530 300a 2020 2020 2020 2020 6966 2070  500.        if p
+00000520: 6172 616d 735f 6964 2069 6e20 5b27 7061  arams_id in ['pa
+00000530: 7261 6d73 5f32 275d 3a0a 2020 2020 2020  rams_2']:.      
+00000540: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+00000550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000560: 2027 7461 736b 5f74 7970 6527 3a20 2743   'task_type': 'C
+00000570: 5055 272c 0a20 2020 2020 2020 2020 2020  PU',.           
+00000580: 2020 2020 2023 2027 6465 7669 6365 7327       # 'devices'
+00000590: 3a20 2730 3a31 3a32 3a33 272c 0a20 2020  : '0:1:2:3',.   
+000005a0: 2020 2020 2020 2020 2020 2020 2027 7261               'ra
+000005b0: 6e64 6f6d 5f73 6565 6427 3a20 3737 372c  ndom_seed': 777,
+000005c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000005d0: 2027 6c6f 7373 5f66 756e 6374 696f 6e27   'loss_function'
+000005e0: 3a20 274c 6f67 6c6f 7373 272c 0a20 2020  : 'Logloss',.   
+000005f0: 2020 2020 2020 2020 2020 2020 2027 6576               'ev
+00000600: 616c 5f6d 6574 7269 6327 3a20 2750 5241  al_metric': 'PRA
+00000610: 5543 272c 0a20 2020 2020 2020 2020 2020  UC',.           
+00000620: 2020 2020 2027 7468 7265 6164 5f63 6f75       'thread_cou
+00000630: 6e74 273a 2036 332c 0a20 2020 2020 2020  nt': 63,.       
+00000640: 2020 2020 2020 2020 2027 6c65 6172 6e69           'learni
+00000650: 6e67 5f72 6174 6527 3a20 302e 3031 2c0a  ng_rate': 0.01,.
+00000660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000670: 2764 6570 7468 273a 2038 2c0a 2020 2020  'depth': 8,.    
+00000680: 2020 2020 2020 2020 2020 2020 2762 6167              'bag
+00000690: 6769 6e67 5f74 656d 7065 7261 7475 7265  ging_temperature
+000006a0: 273a 2030 2e32 2c0a 2020 2020 2020 2020  ': 0.2,.        
+000006b0: 2020 2020 2020 2020 2320 2772 6567 5f6c          # 'reg_l
+000006c0: 616d 6264 6127 3a36 342c 0a20 2020 2020  ambda':64,.     
+000006d0: 2020 2020 2020 2020 2020 2023 2027 6d69             # 'mi
+000006e0: 6e5f 6461 7461 5f69 6e5f 6c65 6166 273a  n_data_in_leaf':
+000006f0: 2031 3032 342c 2020 2320 6e6f 7420 776f   1024,  # not wo
+00000700: 726b 2066 6f72 2063 7075 2076 6572 7369  rk for cpu versi
+00000710: 6f6e 0a20 2020 2020 2020 2020 2020 207d  on.            }
+00000720: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00000730: 616d 735b 276e 5f65 7374 696d 6174 6f72  ams['n_estimator
+00000740: 7327 5d20 3d20 3530 300a 2020 2020 2020  s'] = 500.      
+00000750: 2020 7265 7475 726e 2070 6172 616d 730a    return params.
+00000760: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00000770: 5f28 7365 6c66 2c20 6d6f 6465 6c5f 6e61  _(self, model_na
+00000780: 6d65 203d 204e 6f6e 652c 2066 5f6c 6162  me = None, f_lab
+00000790: 656c 203d 204e 6f6e 652c 2063 6c69 7020  el = None, clip 
+000007a0: 3d20 3130 293a 0a20 2020 2020 2020 2073  = 10):.        s
+000007b0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+000007c0: 6d6f 6465 6c5f 6e61 6d65 290a 2020 2020  model_name).    
+000007d0: 2020 2020 7365 6c66 2e66 5f6c 6162 656c      self.f_label
+000007e0: 203d 2066 5f6c 6162 656c 0a20 2020 2020   = f_label.     
+000007f0: 2020 2073 656c 662e 636c 6970 203d 2063     self.clip = c
+00000800: 6c69 700a 0a20 2020 2064 6566 2074 7261  lip..    def tra
+00000810: 696e 2873 656c 662c 2058 795f 6469 6374  in(self, Xy_dict
+00000820: 2c20 7061 7261 6d73 203d 204e 6f6e 652c  , params = None,
+00000830: 206b 7761 7267 7320 3d20 4e6f 6e65 293a   kwargs = None):
+00000840: 0a20 2020 2020 2020 2023 2070 6172 616d  .        # param
+00000850: 730a 2020 2020 2020 2020 7061 7261 6d73  s.        params
+00000860: 5f69 6420 3d20 6b77 6172 6773 2e67 6574  _id = kwargs.get
+00000870: 2827 7061 7261 6d73 5f69 6427 2c20 4e6f  ('params_id', No
+00000880: 6e65 290a 2020 2020 2020 2020 6173 7365  ne).        asse
+00000890: 7274 2070 6172 616d 7320 6973 206e 6f74  rt params is not
+000008a0: 204e 6f6e 6520 6f72 2070 6172 616d 735f   None or params_
+000008b0: 6964 2069 7320 6e6f 7420 4e6f 6e65 0a20  id is not None. 
+000008c0: 2020 2020 2020 2069 6620 7061 7261 6d73         if params
+000008d0: 5f69 6420 6973 206e 6f74 204e 6f6e 653a  _id is not None:
+000008e0: 2070 6172 616d 7320 3d20 4341 544d 6f64   params = CATMod
+000008f0: 656c 2e67 6574 5f70 6172 616d 7328 7061  el.get_params(pa
+00000900: 7261 6d73 5f69 6429 0a20 2020 2020 2020  rams_id).       
+00000910: 206e 5f62 6f6f 7374 203d 206b 7761 7267   n_boost = kwarg
+00000920: 732e 6765 7428 276e 5f62 6f6f 7374 272c  s.get('n_boost',
+00000930: 2070 6172 616d 735b 276e 5f65 7374 696d   params['n_estim
+00000940: 6174 6f72 7327 5d29 0a20 2020 2020 2020  ators']).       
+00000950: 206b 7761 7267 735b 276e 5f62 6f6f 7374   kwargs['n_boost
+00000960: 275d 203d 206e 5f62 6f6f 7374 0a20 2020  '] = n_boost.   
+00000970: 2020 2020 2070 6172 616d 735b 276e 5f65       params['n_e
+00000980: 7374 696d 6174 6f72 7327 5d20 3d20 6e5f  stimators'] = n_
+00000990: 626f 6f73 740a 2020 2020 2020 2020 2320  boost.        # 
+000009a0: 6465 6c20 7061 7261 6d73 5b27 6e5f 6573  del params['n_es
+000009b0: 7469 6d61 746f 7273 275d 0a20 2020 2020  timators'].     
+000009c0: 2020 206b 7761 7267 735b 276d 6f64 656c     kwargs['model
+000009d0: 5f6e 616d 6527 5d20 3d20 7365 6c66 2e6d  _name'] = self.m
+000009e0: 6f64 656c 5f6e 616d 650a 2020 2020 2020  odel_name.      
+000009f0: 2020 7365 6c66 2e70 6172 616d 732c 2073    self.params, s
+00000a00: 656c 662e 6b77 6172 6773 203d 2070 6172  elf.kwargs = par
+00000a10: 616d 732c 206b 7761 7267 730a 2020 2020  ams, kwargs.    
+00000a20: 2020 2020 0a20 2020 2020 2020 2023 206b      .        # k
+00000a30: 7761 6772 730a 2020 2020 2020 2020 7665  wagrs.        ve
+00000a40: 7262 6f73 6520 3d20 6b77 6172 6773 2e67  rbose = kwargs.g
+00000a50: 6574 2827 7665 7262 6f73 6527 2c20 3130  et('verbose', 10
+00000a60: 3029 0a20 2020 2020 2020 2073 686f 775f  0).        show_
+00000a70: 696e 666f 203d 206b 7761 7267 732e 6765  info = kwargs.ge
+00000a80: 7428 2773 686f 775f 696e 666f 272c 2046  t('show_info', F
+00000a90: 616c 7365 290a 2020 2020 2020 2020 6966  alse).        if
+00000aa0: 2073 686f 775f 696e 666f 3a0a 2020 2020   show_info:.    
+00000ab0: 2020 2020 2020 2020 7072 696e 7428 6627          print(f'
+00000ac0: 5b2b 5d20 6b77 6172 6773 203d 207b 6b77  [+] kwargs = {kw
+00000ad0: 6172 6773 7d27 2c20 666c 7573 683d 5472  args}', flush=Tr
+00000ae0: 7565 293b 2073 7973 2e73 7464 6f75 742e  ue); sys.stdout.
+00000af0: 666c 7573 6828 290a 2020 2020 2020 2020  flush().        
+00000b00: 2020 2020 7072 696e 7428 6627 5b2b 5d20      print(f'[+] 
+00000b10: 7061 7261 6d73 203d 207b 7061 7261 6d73  params = {params
+00000b20: 7d27 2c20 666c 7573 683d 5472 7565 293b  }', flush=True);
+00000b30: 2073 7973 2e73 7464 6f75 742e 666c 7573   sys.stdout.flus
+00000b40: 6828 290a 2020 2020 2020 2020 0a20 2020  h().        .   
+00000b50: 2020 2020 2023 2058 5f74 7261 696e 0a20       # X_train. 
+00000b60: 2020 2020 2020 2058 5f74 7261 696e 2c20         X_train, 
+00000b70: 795f 7472 6169 6e20 3d20 5879 5f64 6963  y_train = Xy_dic
+00000b80: 745b 2758 5f74 7261 696e 275d 2c20 5879  t['X_train'], Xy
+00000b90: 5f64 6963 745b 2779 5f74 7261 696e 275d  _dict['y_train']
+00000ba0: 0a20 2020 2020 2020 2069 6620 2758 5f76  .        if 'X_v
+00000bb0: 616c 6964 2720 696e 2058 795f 6469 6374  alid' in Xy_dict
+00000bc0: 2e6b 6579 7328 2920 616e 6420 2758 5f76  .keys() and 'X_v
+00000bd0: 616c 6964 2720 696e 2058 795f 6469 6374  alid' in Xy_dict
+00000be0: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00000bf0: 2020 2020 2058 5f76 616c 6964 2c20 795f       X_valid, y_
+00000c00: 7661 6c69 6420 3d20 5879 5f64 6963 745b  valid = Xy_dict[
+00000c10: 2758 5f76 616c 6964 275d 2c20 5879 5f64  'X_valid'], Xy_d
+00000c20: 6963 745b 2779 5f76 616c 6964 275d 0a20  ict['y_valid']. 
+00000c30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00000c40: 2020 2020 2020 2020 2058 5f76 616c 6964           X_valid
+00000c50: 2c20 795f 7661 6c69 6420 3d20 5879 5f64  , y_valid = Xy_d
+00000c60: 6963 745b 2758 5f74 7261 696e 275d 5b2d  ict['X_train'][-
+00000c70: 3130 3a5d 2e63 6f70 7928 292c 2058 795f  10:].copy(), Xy_
+00000c80: 6469 6374 5b27 795f 7472 6169 6e27 5d5b  dict['y_train'][
+00000c90: 2d31 303a 5d2e 636f 7079 2829 0a20 2020  -10:].copy().   
+00000ca0: 2020 2020 2069 6620 6b77 6172 6773 2e67       if kwargs.g
+00000cb0: 6574 2827 6672 6565 5f58 7927 2c20 5472  et('free_Xy', Tr
+00000cc0: 7565 293a 0a20 2020 2020 2020 2020 2020  ue):.           
+00000cd0: 2064 656c 2058 795f 6469 6374 5b27 585f   del Xy_dict['X_
+00000ce0: 7472 6169 6e27 5d2c 2058 795f 6469 6374  train'], Xy_dict
+00000cf0: 5b27 795f 7472 6169 6e27 5d3b 2067 632e  ['y_train']; gc.
+00000d00: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00000d10: 2020 2020 2020 6966 2027 585f 7661 6c69        if 'X_vali
+00000d20: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
+00000d30: 7973 2829 2061 6e64 2027 795f 7661 6c69  ys() and 'y_vali
+00000d40: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
+00000d50: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00000d60: 2020 2020 2020 6465 6c20 5879 5f64 6963        del Xy_dic
+00000d70: 745b 2758 5f76 616c 6964 275d 2c20 5879  t['X_valid'], Xy
+00000d80: 5f64 6963 745b 2779 5f76 616c 6964 275d  _dict['y_valid']
+00000d90: 3b20 6763 2e63 6f6c 6c65 6374 2829 0a0a  ; gc.collect()..
+00000da0: 2020 2020 2020 2020 2320 7072 6520 666f          # pre fo
+00000db0: 7220 790a 2020 2020 2020 2020 6966 2073  r y.        if s
+00000dc0: 656c 662e 665f 6c61 6265 6c20 6973 206e  elf.f_label is n
+00000dd0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00000de0: 2020 2020 2079 5f74 7261 696e 203d 206e       y_train = n
+00000df0: 705f 636c 6970 5f6d 696e 5f6d 6178 5f69  p_clip_min_max_i
+00000e00: 6e70 6c61 6365 2879 5f74 7261 696e 2c20  nplace(y_train, 
+00000e10: 2d31 202a 2073 656c 662e 636c 6970 2c20  -1 * self.clip, 
+00000e20: 7365 6c66 2e63 6c69 7029 0a20 2020 2020  self.clip).     
+00000e30: 2020 2020 2020 2079 5f74 7261 696e 203d         y_train =
+00000e40: 206e 702e 6c6f 6731 7028 6e70 2e6c 6f67   np.log1p(np.log
+00000e50: 3170 2879 5f74 7261 696e 202b 2073 656c  1p(y_train + sel
+00000e60: 662e 636c 6970 2929 0a0a 2020 2020 2020  f.clip))..      
+00000e70: 2020 2320 6474 7261 696e 0a20 2020 2020    # dtrain.     
+00000e80: 2020 2069 6620 7368 6f77 5f69 6e66 6f3a     if show_info:
+00000e90: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00000ea0: 6e74 2866 275b 2b5d 2058 5f74 7261 696e  nt(f'[+] X_train
+00000eb0: 2e73 6861 7065 203d 207b 585f 7472 6169  .shape = {X_trai
+00000ec0: 6e2e 7368 6170 657d 272c 2066 6c75 7368  n.shape}', flush
+00000ed0: 3d54 7275 6529 3b20 7379 732e 7374 646f  =True); sys.stdo
+00000ee0: 7574 2e66 6c75 7368 2829 0a20 2020 2020  ut.flush().     
+00000ef0: 2020 2020 2020 2070 7269 6e74 2866 275b         print(f'[
+00000f00: 2b5d 2058 5f76 616c 6964 2e73 6861 7065  +] X_valid.shape
+00000f10: 203d 207b 585f 7661 6c69 642e 7368 6170   = {X_valid.shap
+00000f20: 657d 272c 2066 6c75 7368 3d54 7275 6529  e}', flush=True)
+00000f30: 3b20 7379 732e 7374 646f 7574 2e66 6c75  ; sys.stdout.flu
+00000f40: 7368 2829 0a20 2020 2020 2020 2020 2020  sh().           
+00000f50: 2070 7269 6e74 2866 275b 2b5d 2064 7472   print(f'[+] dtr
+00000f60: 6169 6e20 6265 666f 7265 2729 3b20 6765  ain before'); ge
+00000f70: 745f 6d65 6d5f 6375 7228 292c 2067 6574  t_mem_cur(), get
+00000f80: 5f6d 656d 5f6d 6178 2829 0a20 2020 2020  _mem_max().     
+00000f90: 2020 2064 7472 6169 6e20 3d20 6361 7462     dtrain = catb
+00000fa0: 6f6f 7374 2e50 6f6f 6c28 6e70 5f73 6574  oost.Pool(np_set
+00000fb0: 5f6f 7264 6572 2858 5f74 7261 696e 292c  _order(X_train),
+00000fc0: 2079 5f74 7261 696e 290a 2020 2020 2020   y_train).      
+00000fd0: 2020 6476 616c 6964 203d 2063 6174 626f    dvalid = catbo
+00000fe0: 6f73 742e 506f 6f6c 286e 705f 7365 745f  ost.Pool(np_set_
+00000ff0: 6f72 6465 7228 585f 7661 6c69 6429 2c20  order(X_valid), 
+00001000: 795f 7661 6c69 6429 0a20 2020 2020 2020  y_valid).       
+00001010: 2069 6620 7368 6f77 5f69 6e66 6f3a 2070   if show_info: p
+00001020: 7269 6e74 2827 5b2b 5d20 6474 7261 696e  rint('[+] dtrain
+00001030: 2061 6674 6572 2729 3b20 6765 745f 6d65   after'); get_me
+00001040: 6d5f 6375 7228 292c 2067 6574 5f6d 656d  m_cur(), get_mem
+00001050: 5f6d 6178 2829 0a20 2020 2020 2020 2064  _max().        d
+00001060: 656c 2058 5f74 7261 696e 2c20 795f 7472  el X_train, y_tr
+00001070: 6169 6e2c 2058 5f76 616c 6964 2c20 795f  ain, X_valid, y_
+00001080: 7661 6c69 643b 2067 632e 636f 6c6c 6563  valid; gc.collec
+00001090: 7428 290a 0a20 2020 2020 2020 2023 2074  t()..        # t
+000010a0: 7261 696e 0a20 2020 2020 2020 2063 6174  rain.        cat
+000010b0: 5f66 6561 7475 7265 7320 3d20 6b77 6172  _features = kwar
+000010c0: 6773 2e67 6574 2827 6361 745f 6665 6174  gs.get('cat_feat
+000010d0: 7572 6573 272c 205b 5d29 0a20 2020 2020  ures', []).     
+000010e0: 2020 2069 6620 7061 7261 6d73 5b27 6c6f     if params['lo
+000010f0: 7373 5f66 756e 6374 696f 6e27 5d20 696e  ss_function'] in
+00001100: 205b 2752 4d53 4527 2c20 274d 756c 7469   ['RMSE', 'Multi
+00001110: 524d 5345 272c 2027 5375 7276 6976 616c  RMSE', 'Survival
+00001120: 4166 7427 2c20 274d 4145 272c 2027 5175  Aft', 'MAE', 'Qu
+00001130: 616e 7469 6c65 272c 2027 4c6f 674c 696e  antile', 'LogLin
+00001140: 5175 616e 7469 6c65 272c 2027 506f 6973  Quantile', 'Pois
+00001150: 736f 6e27 2c20 274d 4150 4527 2c20 274c  son', 'MAPE', 'L
+00001160: 7127 5d3a 0a20 2020 2020 2020 2020 2020  q']:.           
+00001170: 2063 6c73 203d 2063 6174 626f 6f73 742e   cls = catboost.
+00001180: 4361 7442 6f6f 7374 5265 6772 6573 736f  CatBoostRegresso
+00001190: 720a 2020 2020 2020 2020 656c 7365 3a0a  r.        else:.
+000011a0: 2020 2020 2020 2020 2020 2020 636c 7320              cls 
+000011b0: 3d20 6361 7462 6f6f 7374 2e43 6174 426f  = catboost.CatBo
+000011c0: 6f73 7443 6c61 7373 6966 6965 720a 2020  ostClassifier.  
+000011d0: 2020 2020 2020 6d6f 6465 6c20 3d20 636c        model = cl
+000011e0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+000011f0: 2020 2020 2020 2023 206e 756d 5f62 6f6f         # num_boo
+00001200: 7374 5f72 6f75 6e64 203d 206e 5f62 6f6f  st_round = n_boo
+00001210: 7374 2c20 0a20 2020 2020 2020 2020 2020  st, .           
+00001220: 2020 2020 2020 2020 206f 645f 7479 7065           od_type
+00001230: 203d 2027 4974 6572 272c 0a20 2020 2020   = 'Iter',.     
+00001240: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00001250: 2065 6172 6c79 5f73 746f 7070 696e 675f   early_stopping_
+00001260: 726f 756e 6473 203d 2031 3030 2c20 0a20  rounds = 100, . 
+00001270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001280: 2020 2076 6572 626f 7365 203d 2046 616c     verbose = Fal
+00001290: 7365 2069 6620 7665 7262 6f73 6520 3c20  se if verbose < 
+000012a0: 3020 656c 7365 2076 6572 626f 7365 2c0a  0 else verbose,.
+000012b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000012c0: 2020 2020 6361 745f 6665 6174 7572 6573      cat_features
+000012d0: 203d 2063 6174 5f66 6561 7475 7265 732c   = cat_features,
+000012e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000012f0: 2029 0a20 2020 2020 2020 206d 6f64 656c   ).        model
+00001300: 2e73 6574 5f70 6172 616d 7328 2a2a 7061  .set_params(**pa
+00001310: 7261 6d73 290a 2020 2020 2020 2020 6d6f  rams).        mo
+00001320: 6465 6c2e 6669 7428 6474 7261 696e 290a  del.fit(dtrain).
+00001330: 2020 2020 2020 2020 2320 6d6f 6465 6c2e          # model.
+00001340: 6669 7428 6474 7261 696e 2c20 6576 616c  fit(dtrain, eval
+00001350: 5f73 6574 3d5b 6476 616c 6964 5d29 0a20  _set=[dvalid]). 
+00001360: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
+00001370: 6c20 3d20 6d6f 6465 6c0a 2020 2020 2020  l = model.      
+00001380: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+00001390: 2020 2064 6566 2072 7a5f 7072 6564 6963     def rz_predic
+000013a0: 7428 7365 6c66 2c20 582c 206e 5f62 6f6f  t(self, X, n_boo
+000013b0: 7374 203d 202d 312c 206e 5f6a 6f62 7320  st = -1, n_jobs 
+000013c0: 3d20 382c 206b 7469 6d65 7320 3d20 2d31  = 8, ktimes = -1
+000013d0: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
+000013e0: 6529 3a0a 2020 2020 2020 2020 6966 206b  e):.        if k
+000013f0: 7469 6d65 7320 3d3d 202d 313a 206b 7469  times == -1: kti
+00001400: 6d65 7320 3d20 696e 7428 6d61 7828 312c  mes = int(max(1,
+00001410: 206c 656e 2858 2920 2f2f 2028 3465 3729   len(X) // (4e7)
+00001420: 2929 0a20 2020 2020 2020 206e 5f62 6f6f  )).        n_boo
+00001430: 7374 203d 2073 656c 662e 6d6f 6465 6c2e  st = self.model.
+00001440: 7472 6565 5f63 6f75 6e74 5f20 6966 206e  tree_count_ if n
+00001450: 5f62 6f6f 7374 203c 3d20 3020 656c 7365  _boost <= 0 else
+00001460: 206e 5f62 6f6f 7374 0a20 2020 2020 2020   n_boost.       
+00001470: 200a 2020 2020 2020 2020 795f 7072 6564   .        y_pred
+00001480: 203d 206e 702e 656d 7074 7928 6c65 6e28   = np.empty(len(
+00001490: 5829 2c20 6474 7970 6520 3d20 6e70 2e66  X), dtype = np.f
+000014a0: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+000014b0: 6465 6620 727a 5f72 756e 2870 312c 2070  def rz_run(p1, p
+000014c0: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+000014d0: 6966 2070 3120 3e3d 2070 323a 2072 6574  if p1 >= p2: ret
+000014e0: 7572 6e0a 2020 2020 2020 2020 2020 2020  urn.            
+000014f0: 795f 7072 6564 5b70 313a 7032 5d20 3d20  y_pred[p1:p2] = 
+00001500: 7365 6c66 2e6d 6f64 656c 2e70 7265 6469  self.model.predi
+00001510: 6374 2863 6174 626f 6f73 742e 506f 6f6c  ct(catboost.Pool
+00001520: 2858 5b70 313a 7032 5d29 2c20 6e74 7265  (X[p1:p2]), ntre
+00001530: 655f 656e 6420 3d20 6e5f 626f 6f73 7429  e_end = n_boost)
+00001540: 0a20 2020 2020 2020 2061 6b73 203d 2067  .        aks = g
+00001550: 6574 5f61 6b73 286c 656e 2858 292c 206e  et_aks(len(X), n
+00001560: 5f6a 6f62 7320 2a20 6b74 696d 6573 290a  _jobs * ktimes).
+00001570: 2020 2020 2020 2020 5f20 3d20 7275 6e5f          _ = run_
+00001580: 6675 6e63 2872 7a5f 7275 6e2c 2061 6b73  func(rz_run, aks
+00001590: 2c20 6e5f 6a6f 6273 203d 206e 5f6a 6f62  , n_jobs = n_job
+000015a0: 732c 206d 6f64 6520 3d20 2773 6d27 2c20  s, mode = 'sm', 
+000015b0: 7665 7262 6f73 6520 3d20 7665 7262 6f73  verbose = verbos
+000015c0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+000015d0: 6e20 795f 7072 6564 0a0a 2020 2020 6465  n y_pred..    de
+000015e0: 6620 7072 6564 6963 7428 7365 6c66 2c20  f predict(self, 
+000015f0: 582c 2070 6172 616d 7320 3d20 4e6f 6e65  X, params = None
+00001600: 2c20 6b77 6172 6773 203d 204e 6f6e 652c  , kwargs = None,
+00001610: 206d 6574 686f 6420 3d20 2772 6177 2729   method = 'raw')
+00001620: 3a0a 2020 2020 2020 2020 5820 3d20 6e70  :.        X = np
+00001630: 5f73 6574 5f6f 7264 6572 2858 290a 2020  _set_order(X).  
+00001640: 2020 2020 2020 6e5f 6a6f 6273 203d 206b        n_jobs = k
+00001650: 7761 7267 732e 6765 7428 276e 5f6a 6f62  wargs.get('n_job
+00001660: 7327 2c20 3820 6966 206d 6574 686f 6420  s', 8 if method 
+00001670: 3d3d 2027 727a 2720 656c 7365 2070 7375  == 'rz' else psu
+00001680: 7469 6c2e 6370 755f 636f 756e 7428 2920  til.cpu_count() 
+00001690: 2d20 3129 0a20 2020 2020 2020 206b 7469  - 1).        kti
+000016a0: 6d65 7320 3d20 6b77 6172 6773 2e67 6574  mes = kwargs.get
+000016b0: 2827 6b74 696d 6573 272c 202d 3129 0a20  ('ktimes', -1). 
+000016c0: 2020 2020 2020 206e 5f62 6f6f 7374 203d         n_boost =
+000016d0: 206b 7761 7267 732e 6765 7428 276e 5f62   kwargs.get('n_b
+000016e0: 6f6f 7374 272c 2073 656c 662e 6d6f 6465  oost', self.mode
+000016f0: 6c2e 7472 6565 5f63 6f75 6e74 5f29 0a20  l.tree_count_). 
+00001700: 2020 2020 2020 2076 6572 626f 7365 203d         verbose =
+00001710: 206b 7761 7267 732e 6765 7428 2776 6572   kwargs.get('ver
+00001720: 626f 7365 272c 2046 616c 7365 290a 2020  bose', False).  
+00001730: 2020 2020 2020 6966 206d 6574 686f 6420        if method 
+00001740: 3d3d 2027 727a 273a 200a 2020 2020 2020  == 'rz': .      
+00001750: 2020 2020 2020 795f 7072 6564 203d 2073        y_pred = s
+00001760: 656c 662e 727a 5f70 7265 6469 6374 2858  elf.rz_predict(X
+00001770: 2c20 6e5f 626f 6f73 742c 206e 5f6a 6f62  , n_boost, n_job
+00001780: 732c 206b 7469 6d65 732c 2076 6572 626f  s, ktimes, verbo
+00001790: 7365 290a 2020 2020 2020 2020 656c 7365  se).        else
+000017a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000017b0: 2027 4361 7442 6f6f 7374 436c 6173 7369   'CatBoostClassi
+000017c0: 6669 6572 2720 696e 2073 7472 2874 7970  fier' in str(typ
+000017d0: 6528 7365 6c66 2e6d 6f64 656c 2929 3a0a  e(self.model)):.
+000017e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000017f0: 795f 7072 6564 203d 2073 656c 662e 6d6f  y_pred = self.mo
+00001800: 6465 6c2e 7072 6564 6963 745f 7072 6f62  del.predict_prob
+00001810: 6128 6361 7462 6f6f 7374 2e50 6f6f 6c28  a(catboost.Pool(
+00001820: 5829 2c20 7468 7265 6164 5f63 6f75 6e74  X), thread_count
+00001830: 203d 206e 5f6a 6f62 732c 206e 7472 6565   = n_jobs, ntree
+00001840: 5f65 6e64 203d 206e 5f62 6f6f 7374 290a  _end = n_boost).
+00001850: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00001860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00001870: 2020 795f 7072 6564 203d 2073 656c 662e    y_pred = self.
+00001880: 6d6f 6465 6c2e 7072 6564 6963 7428 6361  model.predict(ca
+00001890: 7462 6f6f 7374 2e50 6f6f 6c28 5829 2c20  tboost.Pool(X), 
+000018a0: 7468 7265 6164 5f63 6f75 6e74 203d 206e  thread_count = n
+000018b0: 5f6a 6f62 732c 206e 7472 6565 5f65 6e64  _jobs, ntree_end
+000018c0: 203d 206e 5f62 6f6f 7374 290a 2020 2020   = n_boost).    
+000018d0: 2020 2020 6966 2073 656c 662e 665f 6c61      if self.f_la
+000018e0: 6265 6c20 6973 206e 6f74 204e 6f6e 653a  bel is not None:
+000018f0: 2079 5f70 7265 6420 3d20 6e70 2e65 7870   y_pred = np.exp
+00001900: 6d31 286e 702e 6578 706d 3128 795f 7072  m1(np.expm1(y_pr
+00001910: 6564 2929 202d 2073 656c 662e 636c 6970  ed)) - self.clip
+00001920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001930: 795f 7072 6564 0a0a 2020 2020 6465 6620  y_pred..    def 
+00001940: 6765 745f 6e5f 6665 6174 7572 6573 2873  get_n_features(s
+00001950: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00001960: 7475 726e 206c 656e 2873 656c 662e 6d6f  turn len(self.mo
+00001970: 6465 6c2e 6665 6174 7572 655f 6e61 6d65  del.feature_name
+00001980: 735f 290a 0a20 2020 2064 6566 2067 6574  s_)..    def get
+00001990: 5f64 665f 696d 7028 7365 6c66 2c20 636f  _df_imp(self, co
+000019a0: 6c73 5f66 6561 203d 204e 6f6e 652c 2070  ls_fea = None, p
+000019b0: 6c6f 7420 3d20 4661 6c73 652c 206b 203d  lot = False, k =
+000019c0: 2032 302c 2066 6967 7369 7a65 203d 2028   20, figsize = (
+000019d0: 3230 2c20 3130 2929 3a0a 2020 2020 2020  20, 10)):.      
+000019e0: 2020 696d 7020 3d20 7365 6c66 2e6d 6f64    imp = self.mod
+000019f0: 656c 2e66 6561 7475 7265 5f69 6d70 6f72  el.feature_impor
+00001a00: 7461 6e63 6573 5f0a 2020 2020 2020 2020  tances_.        
+00001a10: 7265 7475 726e 2073 7570 6572 2829 2e5f  return super()._
+00001a20: 6765 745f 6466 5f69 6d70 2869 6d70 2c20  get_df_imp(imp, 
+00001a30: 636f 6c73 5f66 6561 2c20 706c 6f74 2c20  cols_fea, plot, 
+00001a40: 6b2c 2066 6967 7369 7a65 203d 2066 6967  k, figsize = fig
+00001a50: 7369 7a65 290a 2020 2020 0a20 2020 2064  size).    .    d
+00001a60: 6566 2064 756d 7028 7365 6c66 2c20 7061  ef dump(self, pa
+00001a70: 7468 293a 0a20 2020 2020 2020 206f 732e  th):.        os.
+00001a80: 7379 7374 656d 2827 726d 202d 7266 207b  system('rm -rf {
+00001a90: 7061 7468 7d27 290a 2020 2020 2020 2020  path}').        
+00001aa0: 6f73 2e6d 616b 6564 6972 7328 7061 7468  os.makedirs(path
+00001ab0: 2c20 6578 6973 745f 6f6b 203d 2054 7275  , exist_ok = Tru
+00001ac0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00001ad0: 6d6f 6465 6c2e 7361 7665 5f6d 6f64 656c  model.save_model
+00001ae0: 2866 277b 7061 7468 7d2f 6d6f 6465 6c2e  (f'{path}/model.
+00001af0: 6269 6e27 290a 2020 2020 2020 2020 7375  bin').        su
+00001b00: 7065 7228 292e 5f64 756d 705f 6f74 6865  per()._dump_othe
+00001b10: 7228 7061 7468 290a 2020 2020 0a20 2020  r(path).    .   
+00001b20: 2064 6566 206c 6f61 6428 7365 6c66 2c20   def load(self, 
+00001b30: 7061 7468 293a 0a20 2020 2020 2020 2073  path):.        s
+00001b40: 656c 662e 6d6f 6465 6c20 3d20 6361 7462  elf.model = catb
+00001b50: 6f6f 7374 2e43 6174 426f 6f73 7452 6567  oost.CatBoostReg
+00001b60: 7265 7373 6f72 2829 2e6c 6f61 645f 6d6f  ressor().load_mo
+00001b70: 6465 6c28 666e 616d 6520 3d20 6627 7b70  del(fname = f'{p
+00001b80: 6174 687d 2f6d 6f64 656c 2e62 696e 2729  ath}/model.bin')
+00001b90: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
+00001ba0: 2e5f 6c6f 6164 5f6f 7468 6572 2870 6174  ._load_other(pat
+00001bb0: 6829 0a20 2020 2020 2020 2072 6574 7572  h).        retur
+00001bc0: 6e20 7365 6c66 0a0a 5c27 5c27 5c27 0a2f  n self..\'\'\'./
+00001bd0: 5573 6572 732f 7275 6e6e 696e 677a 2f61  Users/runningz/a
+00001be0: 6e61 636f 6e64 6133 2f65 6e76 732f 7079  naconda3/envs/py
+00001bf0: 3339 2f6c 6962 2f70 7974 686f 6e33 2e39  39/lib/python3.9
+00001c00: 2f73 6974 652d 7061 636b 6167 6573 2f6c  /site-packages/l
+00001c10: 6967 6874 6762 6d2f 5f5f 696e 6974 5f5f  ightgbm/__init__
+00001c20: 2e70 7920 332e 332e 350a 2f55 7365 7273  .py 3.3.5./Users
+00001c30: 2f72 756e 6e69 6e67 7a2f 616e 6163 6f6e  /runningz/anacon
+00001c40: 6461 332f 656e 7673 2f70 7933 392f 6c69  da3/envs/py39/li
+00001c50: 622f 7079 7468 6f6e 332e 392f 7369 7465  b/python3.9/site
+00001c60: 2d70 6163 6b61 6765 732f 6361 7462 6f6f  -packages/catboo
+00001c70: 7374 2f5f 5f69 6e69 745f 5f2e 7079 2031  st/__init__.py 1
+00001c80: 2e31 2e31 0a5b 2b5d 2074 7261 696e 0a5b  .1.1.[+] train.[
+00001c90: 3230 3233 2f30 332f 3138 2031 343a 3438  2023/03/18 14:48
+00001ca0: 3a35 325d 206d 656d 5f63 7572 203d 2034  :52] mem_cur = 4
+00001cb0: 2e30 3047 4220 3d20 342c 3239 302c 3736  .00GB = 4,290,76
+00001cc0: 302c 3730 340a 5b32 3032 332f 3033 2f31  0,704.[2023/03/1
+00001cd0: 3820 3134 3a34 383a 3532 5d20 6d65 6d5f  8 14:48:52] mem_
+00001ce0: 6d61 7820 3d20 342e 3030 4742 203d 2034  max = 4.00GB = 4
+00001cf0: 2c32 3930 2c37 3630 2c37 3034 0a5b 2b5d  ,290,760,704.[+]
+00001d00: 206d 6f64 656c 5f6e 616d 6520 3d20 4341   model_name = CA
+00001d10: 544d 6f64 656c 0a5b 2b5d 206b 7761 7267  TModel.[+] kwarg
+00001d20: 7320 3d20 7b27 7061 7261 6d73 5f69 6427  s = {'params_id'
+00001d30: 3a20 2770 6172 616d 735f 3127 2c20 276e  : 'params_1', 'n
+00001d40: 5f62 6f6f 7374 273a 2031 302c 2027 7368  _boost': 10, 'sh
+00001d50: 6f77 5f69 6e66 6f27 3a20 5472 7565 2c20  ow_info': True, 
+00001d60: 2766 7265 655f 5879 273a 2054 7275 657d  'free_Xy': True}
+00001d70: 0a5b 2b5d 2070 6172 616d 7320 3d20 7b27  .[+] params = {'
+00001d80: 7461 736b 5f74 7970 6527 3a20 2743 5055  task_type': 'CPU
+00001d90: 272c 2027 7261 6e64 6f6d 5f73 6565 6427  ', 'random_seed'
+00001da0: 3a20 3432 2c20 276c 6f73 735f 6675 6e63  : 42, 'loss_func
+00001db0: 7469 6f6e 273a 2027 524d 5345 272c 2027  tion': 'RMSE', '
+00001dc0: 6576 616c 5f6d 6574 7269 6327 3a20 2752  eval_metric': 'R
+00001dd0: 4d53 4527 2c20 2774 6872 6561 645f 636f  MSE', 'thread_co
+00001de0: 756e 7427 3a20 3332 2c20 276c 6561 726e  unt': 32, 'learn
+00001df0: 696e 675f 7261 7465 273a 2030 2e30 312c  ing_rate': 0.01,
+00001e00: 2027 6465 7074 6827 3a20 382c 2027 6261   'depth': 8, 'ba
+00001e10: 6767 696e 675f 7465 6d70 6572 6174 7572  gging_temperatur
+00001e20: 6527 3a20 302e 327d 0a5b 2b5d 2058 5f74  e': 0.2}.[+] X_t
+00001e30: 7261 696e 2e73 6861 7065 203d 2028 3130  rain.shape = (10
+00001e40: 3030 3030 3030 2c20 3130 3029 0a5b 2b5d  000000, 100).[+]
+00001e50: 2058 5f76 616c 6964 2e73 6861 7065 203d   X_valid.shape =
+00001e60: 2028 3130 2c20 3130 3029 0a5b 2b5d 2062   (10, 100).[+] b
+00001e70: 6566 6f72 650a 5b32 3032 332f 3033 2f31  efore.[2023/03/1
+00001e80: 3820 3134 3a34 383a 3532 5d20 6d65 6d5f  8 14:48:52] mem_
+00001e90: 6375 7220 3d20 342e 3030 4742 203d 2034  cur = 4.00GB = 4
+00001ea0: 2c32 3930 2c37 3630 2c37 3034 0a5b 3230  ,290,760,704.[20
+00001eb0: 3233 2f30 332f 3138 2031 343a 3438 3a35  23/03/18 14:48:5
+00001ec0: 325d 206d 656d 5f6d 6178 203d 2034 2e30  2] mem_max = 4.0
+00001ed0: 3047 4220 3d20 342c 3239 302c 3736 302c  0GB = 4,290,760,
+00001ee0: 3730 340a 5b2b 5d20 6166 7465 6572 0a5b  704.[+] afteer.[
+00001ef0: 3230 3233 2f30 332f 3138 2031 343a 3439  2023/03/18 14:49
+00001f00: 3a30 305d 206d 656d 5f63 7572 203d 2036  :00] mem_cur = 6
+00001f10: 2e33 3847 4220 3d20 362c 3835 332c 3835  .38GB = 6,853,85
+00001f20: 372c 3238 300a 5b32 3032 332f 3033 2f31  7,280.[2023/03/1
+00001f30: 3820 3134 3a34 393a 3030 5d20 6d65 6d5f  8 14:49:00] mem_
+00001f40: 6d61 7820 3d20 362e 3435 4742 203d 2036  max = 6.45GB = 6
+00001f50: 2c39 3230 2c34 3435 2c39 3532 0a54 4242  ,920,445,952.TBB
+00001f60: 2057 6172 6e69 6e67 3a20 5468 6520 6e75   Warning: The nu
+00001f70: 6d62 6572 206f 6620 776f 726b 6572 7320  mber of workers 
+00001f80: 6973 2063 7572 7265 6e74 6c79 206c 696d  is currently lim
+00001f90: 6974 6564 2074 6f20 372e 2054 6865 2072  ited to 7. The r
+00001fa0: 6571 7565 7374 2066 6f72 2033 3120 776f  equest for 31 wo
+00001fb0: 726b 6572 7320 6973 2069 676e 6f72 6564  rkers is ignored
+00001fc0: 2e20 4675 7274 6865 7220 7265 7175 6573  . Further reques
+00001fd0: 7473 2066 6f72 206d 6f72 6520 776f 726b  ts for more work
+00001fe0: 6572 7320 7769 6c6c 2062 6520 7369 6c65  ers will be sile
+00001ff0: 6e74 6c79 2069 676e 6f72 6564 2075 6e74  ntly ignored unt
+00002000: 696c 2074 6865 206c 696d 6974 2063 6861  il the limit cha
+00002010: 6e67 6573 2e0a 0a30 3a20 2020 2020 206c  nges...0:      l
+00002020: 6561 726e 3a20 302e 3238 3836 3839 3120  earn: 0.2886891 
+00002030: 2020 2020 2020 2074 6f74 616c 3a20 312e         total: 1.
+00002040: 3635 7320 2020 2072 656d 6169 6e69 6e67  65s    remaining
+00002050: 3a20 3134 2e39 730a 393a 2020 2020 2020  : 14.9s.9:      
+00002060: 6c65 6172 6e3a 2030 2e32 3838 3638 3832  learn: 0.2886882
+00002070: 2020 2020 2020 2020 746f 7461 6c3a 2031          total: 1
+00002080: 342e 3473 2020 2020 7265 6d61 696e 696e  4.4s    remainin
+00002090: 673a 2030 7573 0a5b 2b5d 2070 7265 6469  g: 0us.[+] predi
+000020a0: 6374 0a5b 3230 3233 2f30 332f 3138 2031  ct.[2023/03/18 1
+000020b0: 343a 3439 3a34 305d 206d 656d 5f63 7572  4:49:40] mem_cur
+000020c0: 203d 2034 2e38 3147 4220 3d20 352c 3136   = 4.81GB = 5,16
+000020d0: 322c 3237 382c 3931 320a 5b32 3032 332f  2,278,912.[2023/
+000020e0: 3033 2f31 3820 3134 3a34 393a 3430 5d20  03/18 14:49:40] 
+000020f0: 6d65 6d5f 6d61 7820 3d20 362e 3537 4742  mem_max = 6.57GB
+00002100: 203d 2037 2c30 3534 2c38 3032 2c39 3434   = 7,054,802,944
+00002110: 0a30 2e32 3435 3532 3139 3437 3038 3831  .0.2455219470881
+00002120: 3738 3638 0a5b 2b5d 2067 6574 5f64 665f  7868.[+] get_df_
+00002130: 696d 700a 2020 2020 2020 2020 696d 7020  imp.        imp 
+00002140: 636f 6c0a 3020 2030 2e30 3030 3030 3020  col.0  0.000000 
+00002150: 2078 300a 3120 2030 2e30 3030 3030 3020   x0.1  0.000000 
+00002160: 2078 310a 3220 2033 2e39 3233 3431 3820   x1.2  3.923418 
+00002170: 2078 320a 3320 2030 2e30 3030 3030 3020   x2.3  0.000000 
+00002180: 2078 330a 3420 2030 2e30 3030 3030 3020   x3.4  0.000000 
+00002190: 2078 340a 5b2b 5d20 6475 6d70 0a5b 2b5d   x4.[+] dump.[+]
+000021a0: 206c 6f61 640a 302e 300a 5b2b 5d20 446f   load.0.0.[+] Do
+000021b0: 6e65 0a5b 3230 3233 2f30 332f 3138 2031  ne.[2023/03/18 1
+000021c0: 343a 3439 3a34 305d 206d 656d 5f63 7572  4:49:40] mem_cur
+000021d0: 203d 2034 2e34 3447 4220 3d20 342c 3736   = 4.44GB = 4,76
+000021e0: 332c 3338 312c 3736 300a 5b32 3032 332f  3,381,760.[2023/
+000021f0: 3033 2f31 3820 3134 3a34 393a 3430 5d20  03/18 14:49:40] 
+00002200: 6d65 6d5f 6d61 7820 3d20 362e 3537 4742  mem_max = 6.57GB
+00002210: 203d 2037 2c30 3534 2c38 3032 2c39 3434   = 7,054,802,944
+00002220: 0a5c 275c 275c 277a 065c 275c 275c 277a  .\'\'\'z.\'\'\'z
+00002230: 0327 2727 da01 7729 07da 026f 73da 0470  .'''..w)...os..p
+00002240: 6174 68da 0764 6972 6e61 6d65 da08 5f5f  ath..dirname..__
+00002250: 6669 6c65 5f5f da07 7265 706c 6163 65da  file__..replace.
+00002260: 046f 7065 6eda 0577 7269 7465 2904 da06  .open..write)...
+00002270: 6f75 7470 7574 5a0b 7061 7468 5f6f 7574  outputZ.path_out
+00002280: 7075 74da 0173 da01 66a9 0072 0e00 0000  put..s..f..r....
+00002290: fa46 6275 696c 642f 6264 6973 742e 6d61  .Fbuild/bdist.ma
+000022a0: 636f 7378 2d31 302e 392d 7838 365f 3634  cosx-10.9-x86_64
+000022b0: 2f65 6767 2f72 756e 6e69 6e67 7a2f 6d6f  /egg/runningz/mo
+000022c0: 6465 6c2f 7472 6565 2f6d 6f64 656c 5f63  del/tree/model_c
+000022d0: 6174 5f70 792e 7079 da03 7275 6e04 0000  at_py.py..run...
+000022e0: 0073 0c00 0000 0001 1401 047f 004c 0c01  .s...........L..
+000022f0: 0c01 7210 0000 00da 085f 5f6d 6169 6e5f  ..r......__main_
+00002300: 5f7a 082d 2d6f 7574 7075 7454 2902 da04  _z.--outputT)...
+00002310: 7479 7065 da08 7265 7175 6972 6564 290c  type..required).
+00002320: 7204 0000 00da 0373 7973 7210 0000 00da  r......sysr.....
+00002330: 085f 5f6e 616d 655f 5fda 0861 7267 7061  .__name__..argpa
+00002340: 7273 65da 0e41 7267 756d 656e 7450 6172  rse..ArgumentPar
+00002350: 7365 72da 0670 6172 7365 72da 0c61 6464  ser..parser..add
+00002360: 5f61 7267 756d 656e 74da 0373 7472 da0a  _argument..str..
+00002370: 7061 7273 655f 6172 6773 da04 6172 6773  parse_args..args
+00002380: 720b 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
+00002390: 0e00 0000 720f 0000 00da 083c 6d6f 6475  ....r......<modu
+000023a0: 6c65 3e02 0000 0073 1200 0000 0801 0801  le>....s........
+000023b0: 087f 0052 0801 0801 0801 1001 0801       ...R..........
```

## runningz/model/tree/model_lgb.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri Apr 26 12:04:19 2024 UTC, .py size: 11483 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 4398 2b66 db2c 0000  a.......C.+f.,..
+00000000: 610d 0d0a 0000 0000 ec95 5a66 ab2d 0000  a.........Zf.-..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 d400 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6401 6c04 5a05 6400 6401 6c06 5a07 6400  d.l.Z.d.d.l.Z.d.
 00000060: 6401 6c08 5a09 6402 6403 6c0a 6d0b 5a0b  d.l.Z.d.d.l.m.Z.
 00000070: 0100 6402 6404 6c0c 6d0d 5a0d 6d0e 5a0e  ..d.d.l.m.Z.m.Z.
@@ -123,399 +123,406 @@
 000007a0: 7227 0000 00da 0177 5a07 6772 6164 5f6c  r'.....wZ.grad_l
 000007b0: 325a 0768 6573 735f 6c32 5a08 6772 6164  2Z.hess_l2Z.grad
 000007c0: 5f62 6365 5a08 6865 7373 5f62 6365 722a  _bceZ.hess_bcer*
 000007d0: 0000 0072 2b00 0000 7210 0000 0072 1000  ...r+...r....r..
 000007e0: 0000 7211 0000 00da 0466 6f62 6a43 0000  ..r......fobjC..
 000007f0: 0073 0e00 0000 0001 0801 0e01 0e01 0c01  .s..............
 00000800: 0c01 1801 7231 0000 0063 0000 0000 0000  ....r1...c......
-00000810: 0000 0000 0000 0000 0000 0400 0000 0000  ................
+00000810: 0000 0000 0000 0000 0000 0500 0000 0000  ................
 00000820: 0000 7372 0000 0065 005a 0164 005a 0264  ..sr...e.Z.d.Z.d
-00000830: 1a64 0464 0584 015a 0364 0664 0784 005a  .d.d...Z.d.d...Z
-00000840: 0464 1b87 0066 0164 0964 0a84 095a 0564  .d...f.d.d...Z.d
-00000850: 1c64 0b64 0c84 015a 0664 1d64 0d64 0e84  .d.d...Z.d.d.d..
-00000860: 015a 0764 0f64 1084 005a 0864 1e87 0066  .Z.d.d...Z.d...f
-00000870: 0164 1464 1584 095a 0987 0066 0164 1664  .d.d...Z...f.d.d
-00000880: 1784 085a 0a87 0066 0164 1864 1984 085a  ...Z...f.d.d...Z
-00000890: 0b87 0004 005a 0c53 0029 1fda 084c 4742  .....Z.S.)...LGB
+00000830: 1b64 0564 0684 015a 0364 0764 0884 005a  .d.d...Z.d.d...Z
+00000840: 0464 1c87 0066 0164 0a64 0b84 095a 0564  .d...f.d.d...Z.d
+00000850: 1d64 0c64 0d84 015a 0664 1e64 0e64 0f84  .d.d...Z.d.d.d..
+00000860: 015a 0764 1064 1184 005a 0864 1f87 0066  .Z.d.d...Z.d...f
+00000870: 0164 1564 1684 095a 0987 0066 0164 1764  .d.d...Z...f.d.d
+00000880: 1884 085a 0a87 0066 0164 1964 1a84 085a  ...Z...f.d.d...Z
+00000890: 0b87 0004 005a 0c53 0029 20da 084c 4742  .....Z.S.) ..LGB
 000008a0: 4d6f 6465 6ce9 3f42 0f00 e920 0000 0072  Model.?B... ...r
-000008b0: 1d00 0000 6306 0000 0000 0000 0000 0000  ....c...........
-000008c0: 0009 0000 0005 0000 0003 0000 0073 9800  .............s..
-000008d0: 0000 7400 8802 8301 7401 6a02 6a03 7500  ..t.....t.j.j.u.
-000008e0: 7214 8802 6e04 8802 6a04 8902 7405 8803  r...n...j...t...
-000008f0: 8802 a006 a100 8302 8903 8701 8703 6602  ..............f.
-00000900: 6401 6402 8408 7407 6403 8803 8801 8303  d.d...t.d.......
-00000910: 4400 8301 7d06 8700 8701 8702 8703 8704  D...}...........
-00000920: 6605 6404 6402 8408 7407 6403 8803 8801  f.d.d...t.d.....
-00000930: 8303 4400 8301 7d07 7408 6a09 7c07 6403  ..D...}.t.j.|.d.
-00000940: 6405 8d02 7d08 7c05 6406 7501 7290 7408  d...}.|.d.u.r.t.
-00000950: a00a 7408 a00a 7c08 a101 a101 6407 1800  ..t...|.....d...
-00000960: 7d08 7c06 7c08 6602 5300 2908 6158 0200  }.|.|.f.S.).aX..
-00000970: 000a 2020 2020 2020 2020 626f 6f73 745f  ..        boost_
-00000980: 6c69 7374 2c20 795f 7072 6564 5f62 6f6f  list, y_pred_boo
-00000990: 7374 203d 206d 6f64 656c 5f70 7265 6469  st = model_predi
-000009a0: 6374 286d 6f64 656c 2c20 582c 206b 203d  ct(model, X, k =
-000009b0: 2035 302c 206e 5f6a 6f62 7320 3d20 3429   50, n_jobs = 4)
-000009c0: 0a0a 2020 2020 2020 2020 6465 6620 6d6f  ..        def mo
-000009d0: 6465 6c5f 7072 6564 6963 7428 6d6f 6465  del_predict(mode
-000009e0: 6c2c 2058 5f74 6573 742c 206e 203d 2039  l, X_test, n = 9
-000009f0: 3939 3939 392c 206b 203d 2039 3939 3939  99999, k = 99999
-00000a00: 392c 206e 5f6a 6f62 7320 3d20 3332 293a  9, n_jobs = 32):
-00000a10: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-00000a20: 656c 203d 206d 6f64 656c 2069 6620 7479  el = model if ty
-00000a30: 7065 286d 6f64 656c 2920 6973 206c 6762  pe(model) is lgb
-00000a40: 2e62 6173 6963 2e42 6f6f 7374 6572 2065  .basic.Booster e
-00000a50: 6c73 6520 6d6f 6465 6c2e 6d6f 6465 6c0a  lse model.model.
-00000a60: 2020 2020 2020 2020 2020 2020 6e20 3d20              n = 
-00000a70: 6d69 6e28 6e2c 206d 6f64 656c 2e6e 756d  min(n, model.num
-00000a80: 5f74 7265 6573 2829 290a 2020 2020 2020  _trees()).      
-00000a90: 2020 2020 2020 626f 6f73 745f 6c69 7374        boost_list
-00000aa0: 203d 205b 6d69 6e28 6e2c 2078 202b 206b   = [min(n, x + k
-00000ab0: 2920 666f 7220 7820 696e 2072 616e 6765  ) for x in range
-00000ac0: 2830 2c20 6e2c 206b 295d 0a20 2020 2020  (0, n, k)].     
-00000ad0: 2020 2020 2020 2079 7320 3d20 5b6d 6f64         ys = [mod
-00000ae0: 656c 2e70 7265 6469 6374 2858 5f74 6573  el.predict(X_tes
-00000af0: 742c 2073 7461 7274 5f69 7465 7261 7469  t, start_iterati
-00000b00: 6f6e 203d 2069 2c20 6e75 6d5f 6974 6572  on = i, num_iter
-00000b10: 6174 696f 6e20 3d20 6d69 6e28 6b2c 206e  ation = min(k, n
-00000b20: 202d 2069 292c 200a 2020 2020 2020 2020   - i), .        
-00000b30: 2020 2020 2020 2020 6e5f 6a6f 6273 203d          n_jobs =
-00000b40: 206e 5f6a 6f62 7329 2066 6f72 2069 2069   n_jobs) for i i
-00000b50: 6e20 7261 6e67 6528 302c 206e 2c20 6b29  n range(0, n, k)
-00000b60: 5d0a 2020 2020 2020 2020 2020 2020 795f  ].            y_
-00000b70: 7072 6564 5f62 6f6f 7374 203d 206e 702e  pred_boost = np.
-00000b80: 6375 6d73 756d 2879 732c 2061 7869 7320  cumsum(ys, axis 
-00000b90: 3d20 3029 0a20 2020 2020 2020 2020 2020  = 0).           
-00000ba0: 2072 6574 7572 6e20 626f 6f73 745f 6c69   return boost_li
-00000bb0: 7374 2c20 795f 7072 6564 5f62 6f6f 7374  st, y_pred_boost
-00000bc0: 0a20 2020 2020 2020 2063 0100 0000 0000  .        c......
-00000bd0: 0000 0000 0000 0200 0000 0600 0000 1300  ................
-00000be0: 0000 731a 0000 0067 007c 005d 127d 0174  ..s....g.|.].}.t
-00000bf0: 0088 017c 0188 0017 0083 0291 0271 0453  ...|.........q.S
-00000c00: 0072 1000 0000 2901 da03 6d69 6e29 02da  .r....)...min)..
-00000c10: 022e 3072 0f00 0000 2902 da01 6bda 016e  ..0r....)...k..n
-00000c20: 7210 0000 0072 1100 0000 da0a 3c6c 6973  r....r......<lis
-00000c30: 7463 6f6d 703e 5d00 0000 f300 0000 007a  tcomp>]........z
-00000c40: 2a4c 4742 4d6f 6465 6c2e 6d6f 6465 6c5f  *LGBModel.model_
-00000c50: 7072 6564 6963 742e 3c6c 6f63 616c 733e  predict.<locals>
-00000c60: 2e3c 6c69 7374 636f 6d70 3e72 0100 0000  .<listcomp>r....
-00000c70: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00000c80: 0009 0000 0013 0000 0073 2800 0000 6700  .........s(...g.
-00000c90: 7c00 5d20 7d01 8802 6a00 8800 7c01 7401  |.] }...j...|.t.
-00000ca0: 8801 8803 7c01 1800 8302 8804 6400 8d04  ....|.......d...
-00000cb0: 9102 7104 5300 2901 2903 5a0f 7374 6172  ..q.S.).).Z.star
-00000cc0: 745f 6974 6572 6174 696f 6e5a 0d6e 756d  t_iterationZ.num
-00000cd0: 5f69 7465 7261 7469 6f6e da06 6e5f 6a6f  _iteration..n_jo
-00000ce0: 6273 2902 da07 7072 6564 6963 7472 3500  bs)...predictr5.
-00000cf0: 0000 2902 7236 0000 00da 0169 a905 da06  ..).r6.....i....
-00000d00: 585f 7465 7374 7237 0000 00da 056d 6f64  X_testr7.....mod
-00000d10: 656c 7238 0000 0072 3b00 0000 7210 0000  elr8...r;...r...
-00000d20: 0072 1100 0000 7239 0000 005e 0000 0073  .r....r9...^...s
-00000d30: 0800 0000 0601 02ff 1401 02ff 2901 5a04  ............).Z.
-00000d40: 6178 6973 4ee7 0000 0000 0000 2440 290b  axisN.......$@).
-00000d50: da04 7479 7065 da03 6c67 625a 0562 6173  ..type..lgbZ.bas
-00000d60: 6963 da07 426f 6f73 7465 7272 4000 0000  ic..Boosterr@...
-00000d70: 7235 0000 005a 096e 756d 5f74 7265 6573  r5...Z.num_trees
-00000d80: da05 7261 6e67 6572 0c00 0000 5a06 6375  ..ranger....Z.cu
-00000d90: 6d73 756d da05 6578 706d 3129 0972 4000  msum..expm1).r@.
-00000da0: 0000 723f 0000 0072 3800 0000 7237 0000  ..r?...r8...r7..
-00000db0: 0072 3b00 0000 da07 665f 6c61 6265 6c5a  .r;.....f_labelZ
-00000dc0: 0a62 6f6f 7374 5f6c 6973 745a 0279 735a  .boost_listZ.ysZ
-00000dd0: 0c79 5f70 7265 645f 626f 6f73 7472 1000  .y_pred_boostr..
-00000de0: 0000 723e 0000 0072 1100 0000 da0d 6d6f  ..r>...r......mo
-00000df0: 6465 6c5f 7072 6564 6963 744e 0000 0073  del_predictN...s
-00000e00: 1200 0000 000d 1a01 0e01 1c01 1201 0aff  ................
-00000e10: 0602 0e01 1c01 7a16 4c47 424d 6f64 656c  ......z.LGBModel
-00000e20: 2e6d 6f64 656c 5f70 7265 6469 6374 6301  .model_predictc.
-00000e30: 0000 0000 0000 0000 0000 0002 0000 000f  ................
-00000e40: 0000 0043 0000 0073 dc00 0000 7c00 6401  ...C...s....|.d.
-00000e50: 7600 722c 6402 6403 6404 6405 6406 6407  v.r,d.d.d.d.d.d.
-00000e60: 6408 6406 6409 6409 640a 9c0a 7d01 640b  d.d.d.d.d...}.d.
-00000e70: 7c01 640c 3c00 6eac 7c00 640d 7600 726a  |.d.<.n.|.d.v.rj
-00000e80: 6402 6403 6404 6405 6406 6407 6408 6406  d.d.d.d.d.d.d.d.
-00000e90: 6409 6409 640e 640f 9c0b 7d01 640b 7c01  d.d.d.d...}.d.|.
-00000ea0: 640c 3c00 7c00 6410 7600 72d8 6411 7c01  d.<.|.d.v.r.d.|.
-00000eb0: 640c 3c00 6e6e 7c00 6412 7600 729e 6402  d.<.nn|.d.v.r.d.
-00000ec0: 6403 6404 6405 6406 6407 6413 6406 6414  d.d.d.d.d.d.d.d.
-00000ed0: 6415 6416 6417 6418 6419 641a 9c0e 7d01  d.d.d.d.d.d...}.
-00000ee0: 640b 7c01 640c 3c00 6e3a 7c00 641b 7600  d.|.d.<.n:|.d.v.
-00000ef0: 72ca 6402 641c 641d 6405 6406 6407 6408  r.d.d.d.d.d.d.d.
-00000f00: 6406 6409 6409 640a 9c0a 7d01 6411 7c01  d.d.d.d...}.d.|.
-00000f10: 640c 3c00 6e0e 7400 641e 7c00 9b00 9d02  d.<.n.t.d.|.....
-00000f20: 8301 8201 7c01 5300 291f 4e29 015a 0870  ....|.S.).N).Z.p
-00000f30: 6172 616d 735f 3169 0903 0000 5a0a 7265  arams_1i....Z.re
-00000f40: 6772 6573 7369 6f6e 5a04 726d 7365 e93f  gressionZ.rmse.?
-00000f50: 0000 00e9 ffff ffff 7221 0000 00e9 ff00  ........r!......
-00000f60: 0000 722f 0000 0029 0ada 0473 6565 64da  ..r/...)...seed.
-00000f70: 096f 626a 6563 7469 7665 da06 6d65 7472  .objective..metr
-00000f80: 6963 723b 0000 00da 0976 6572 626f 7369  icr;.....verbosi
-00000f90: 7479 da0d 6c65 6172 6e69 6e67 5f72 6174  ty..learning_rat
-00000fa0: 65da 0a6e 756d 5f6c 6561 7665 73da 096d  e..num_leaves..m
-00000fb0: 6178 5f64 6570 7468 da10 6665 6174 7572  ax_depth..featur
-00000fc0: 655f 6672 6163 7469 6f6e da10 6261 6767  e_fraction..bagg
-00000fd0: 696e 675f 6672 6163 7469 6f6e 69dc 0500  ing_fractioni...
-00000fe0: 00da 0c6e 5f65 7374 696d 6174 6f72 7329  ...n_estimators)
-00000ff0: 025a 0c70 6172 616d 735f 6578 7472 61da  .Z.params_extra.
-00001000: 0b70 6172 616d 735f 6661 7374 5429 0b72  .params_fastT).r
-00001010: 4c00 0000 724d 0000 0072 4e00 0000 723b  L...rM...rN...r;
-00001020: 0000 0072 4f00 0000 7250 0000 0072 5100  ...rO...rP...rQ.
-00001030: 0000 7252 0000 0072 5300 0000 7254 0000  ..rR...rS...rT..
-00001040: 005a 0b65 7874 7261 5f74 7265 6573 2901  .Z.extra_trees).
-00001050: 7256 0000 00e9 6400 0000 2901 5a08 7061  rV....d...).Z.pa
-00001060: 7261 6d73 5f32 6900 0800 0067 cdcc cccc  rams_2i....g....
-00001070: cccc e43f 67cd cccc cccc ccec 3f67 fa7e  ...?g.......?g.~
-00001080: 6abc 7493 683f e98c 0000 0067 9a99 9999  j.t.h?.....g....
-00001090: 9999 e93f 6733 3333 3333 33d3 3f29 0e72  ...?g333333.?).r
-000010a0: 4c00 0000 724d 0000 0072 4e00 0000 723b  L...rM...rN...r;
-000010b0: 0000 0072 4f00 0000 7250 0000 0072 5100  ...rO...rP...rQ.
-000010c0: 0000 7252 0000 0072 5300 0000 7254 0000  ..rR...rS...rT..
-000010d0: 005a 106d 696e 5f63 6869 6c64 5f77 6569  .Z.min_child_wei
-000010e0: 6768 745a 106d 696e 5f64 6174 615f 696e  ghtZ.min_data_in
-000010f0: 5f6c 6561 665a 0972 6567 5f61 6c70 6861  _leafZ.reg_alpha
-00001100: 5a0a 7265 675f 6c61 6d62 6461 2901 5a0a  Z.reg_lambda).Z.
-00001110: 7061 7261 6d73 5f61 6476 da06 6269 6e61  params_adv..bina
-00001120: 7279 5a03 6175 637a 105b 2b5d 2070 6172  ryZ.aucz.[+] par
-00001130: 616d 735f 6964 203d 2029 01da 134e 6f74  ams_id = )...Not
-00001140: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00001150: 2902 da09 7061 7261 6d73 5f69 64da 0670  )...params_id..p
-00001160: 6172 616d 7372 1000 0000 7210 0000 0072  aramsr....r....r
-00001170: 1100 0000 da0a 6765 745f 7061 7261 6d73  ......get_params
-00001180: 6400 0000 737a 0000 0000 0108 0202 0102  d...sz..........
+000008b0: 1d00 0000 7223 0000 0063 0700 0000 0000  ....r#...c......
+000008c0: 0000 0000 0000 0a00 0000 0500 0000 0300  ................
+000008d0: 0000 7398 0000 0074 0088 0283 0174 016a  ..s....t.....t.j
+000008e0: 026a 0375 0072 1488 026e 0488 026a 0489  .j.u.r...n...j..
+000008f0: 0274 0588 0388 02a0 06a1 0083 0289 0387  .t..............
+00000900: 0187 0366 0264 0164 0284 0874 0764 0388  ...f.d.d...t.d..
+00000910: 0388 0183 0344 0083 017d 0787 0087 0187  .....D...}......
+00000920: 0287 0387 0466 0564 0464 0284 0874 0764  .....f.d.d...t.d
+00000930: 0388 0388 0183 0344 0083 017d 0874 086a  .......D...}.t.j
+00000940: 097c 0864 0364 058d 027d 097c 0564 0675  .|.d.d...}.|.d.u
+00000950: 0172 9074 08a0 0a74 08a0 0a7c 09a1 01a1  .r.t...t...|....
+00000960: 017c 0618 007d 097c 077c 0966 0253 0029  .|...}.|.|.f.S.)
+00000970: 0761 5802 0000 0a20 2020 2020 2020 2062  .aX....        b
+00000980: 6f6f 7374 5f6c 6973 742c 2079 5f70 7265  oost_list, y_pre
+00000990: 645f 626f 6f73 7420 3d20 6d6f 6465 6c5f  d_boost = model_
+000009a0: 7072 6564 6963 7428 6d6f 6465 6c2c 2058  predict(model, X
+000009b0: 2c20 6b20 3d20 3530 2c20 6e5f 6a6f 6273  , k = 50, n_jobs
+000009c0: 203d 2034 290a 0a20 2020 2020 2020 2064   = 4)..        d
+000009d0: 6566 206d 6f64 656c 5f70 7265 6469 6374  ef model_predict
+000009e0: 286d 6f64 656c 2c20 585f 7465 7374 2c20  (model, X_test, 
+000009f0: 6e20 3d20 3939 3939 3939 2c20 6b20 3d20  n = 999999, k = 
+00000a00: 3939 3939 3939 2c20 6e5f 6a6f 6273 203d  999999, n_jobs =
+00000a10: 2033 3229 3a0a 2020 2020 2020 2020 2020   32):.          
+00000a20: 2020 6d6f 6465 6c20 3d20 6d6f 6465 6c20    model = model 
+00000a30: 6966 2074 7970 6528 6d6f 6465 6c29 2069  if type(model) i
+00000a40: 7320 6c67 622e 6261 7369 632e 426f 6f73  s lgb.basic.Boos
+00000a50: 7465 7220 656c 7365 206d 6f64 656c 2e6d  ter else model.m
+00000a60: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
+00000a70: 206e 203d 206d 696e 286e 2c20 6d6f 6465   n = min(n, mode
+00000a80: 6c2e 6e75 6d5f 7472 6565 7328 2929 0a20  l.num_trees()). 
+00000a90: 2020 2020 2020 2020 2020 2062 6f6f 7374             boost
+00000aa0: 5f6c 6973 7420 3d20 5b6d 696e 286e 2c20  _list = [min(n, 
+00000ab0: 7820 2b20 6b29 2066 6f72 2078 2069 6e20  x + k) for x in 
+00000ac0: 7261 6e67 6528 302c 206e 2c20 6b29 5d0a  range(0, n, k)].
+00000ad0: 2020 2020 2020 2020 2020 2020 7973 203d              ys =
+00000ae0: 205b 6d6f 6465 6c2e 7072 6564 6963 7428   [model.predict(
+00000af0: 585f 7465 7374 2c20 7374 6172 745f 6974  X_test, start_it
+00000b00: 6572 6174 696f 6e20 3d20 692c 206e 756d  eration = i, num
+00000b10: 5f69 7465 7261 7469 6f6e 203d 206d 696e  _iteration = min
+00000b20: 286b 2c20 6e20 2d20 6929 2c20 0a20 2020  (k, n - i), .   
+00000b30: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+00000b40: 6f62 7320 3d20 6e5f 6a6f 6273 2920 666f  obs = n_jobs) fo
+00000b50: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
+00000b60: 6e2c 206b 295d 0a20 2020 2020 2020 2020  n, k)].         
+00000b70: 2020 2079 5f70 7265 645f 626f 6f73 7420     y_pred_boost 
+00000b80: 3d20 6e70 2e63 756d 7375 6d28 7973 2c20  = np.cumsum(ys, 
+00000b90: 6178 6973 203d 2030 290a 2020 2020 2020  axis = 0).      
+00000ba0: 2020 2020 2020 7265 7475 726e 2062 6f6f        return boo
+00000bb0: 7374 5f6c 6973 742c 2079 5f70 7265 645f  st_list, y_pred_
+00000bc0: 626f 6f73 740a 2020 2020 2020 2020 6301  boost.        c.
+00000bd0: 0000 0000 0000 0000 0000 0002 0000 0006  ................
+00000be0: 0000 0013 0000 0073 1a00 0000 6700 7c00  .......s....g.|.
+00000bf0: 5d12 7d01 7400 8801 7c01 8800 1700 8302  ].}.t...|.......
+00000c00: 9102 7104 5300 7210 0000 0029 01da 036d  ..q.S.r....)...m
+00000c10: 696e 2902 da02 2e30 720f 0000 0029 02da  in)....0r....)..
+00000c20: 016b da01 6e72 1000 0000 7211 0000 00da  .k..nr....r.....
+00000c30: 0a3c 6c69 7374 636f 6d70 3e5d 0000 00f3  .<listcomp>]....
+00000c40: 0000 0000 7a2a 4c47 424d 6f64 656c 2e6d  ....z*LGBModel.m
+00000c50: 6f64 656c 5f70 7265 6469 6374 2e3c 6c6f  odel_predict.<lo
+00000c60: 6361 6c73 3e2e 3c6c 6973 7463 6f6d 703e  cals>.<listcomp>
+00000c70: 7201 0000 0063 0100 0000 0000 0000 0000  r....c..........
+00000c80: 0000 0200 0000 0900 0000 1300 0000 7328  ..............s(
+00000c90: 0000 0067 007c 005d 207d 0188 026a 0088  ...g.|.] }...j..
+00000ca0: 007c 0174 0188 0188 037c 0118 0083 0288  .|.t.....|......
+00000cb0: 0464 008d 0491 0271 0453 0029 0129 035a  .d.....q.S.).).Z
+00000cc0: 0f73 7461 7274 5f69 7465 7261 7469 6f6e  .start_iteration
+00000cd0: da0d 6e75 6d5f 6974 6572 6174 696f 6eda  ..num_iteration.
+00000ce0: 066e 5f6a 6f62 7329 02da 0770 7265 6469  .n_jobs)...predi
+00000cf0: 6374 7235 0000 0029 0272 3600 0000 da01  ctr5...).r6.....
+00000d00: 69a9 05da 0658 5f74 6573 7472 3700 0000  i....X_testr7...
+00000d10: da05 6d6f 6465 6c72 3800 0000 723c 0000  ..modelr8...r<..
+00000d20: 0072 1000 0000 7211 0000 0072 3900 0000  .r....r....r9...
+00000d30: 5e00 0000 7308 0000 0006 0102 ff14 0102  ^...s...........
+00000d40: ff29 015a 0461 7869 734e 290b da04 7479  .).Z.axisN)...ty
+00000d50: 7065 da03 6c67 625a 0562 6173 6963 da07  pe..lgbZ.basic..
+00000d60: 426f 6f73 7465 7272 4100 0000 7235 0000  BoosterrA...r5..
+00000d70: 005a 096e 756d 5f74 7265 6573 da05 7261  .Z.num_trees..ra
+00000d80: 6e67 6572 0c00 0000 5a06 6375 6d73 756d  nger....Z.cumsum
+00000d90: da05 6578 706d 3129 0a72 4100 0000 7240  ..expm1).rA...r@
+00000da0: 0000 0072 3800 0000 7237 0000 0072 3c00  ...r8...r7...r<.
+00000db0: 0000 da07 665f 6c61 6265 6cda 0463 6c69  ....f_label..cli
+00000dc0: 705a 0a62 6f6f 7374 5f6c 6973 745a 0279  pZ.boost_listZ.y
+00000dd0: 735a 0c79 5f70 7265 645f 626f 6f73 7472  sZ.y_pred_boostr
+00000de0: 1000 0000 723f 0000 0072 1100 0000 da0d  ....r?...r......
+00000df0: 6d6f 6465 6c5f 7072 6564 6963 744e 0000  model_predictN..
+00000e00: 0073 1200 0000 000d 1a01 0e01 1c01 1201  .s..............
+00000e10: 0aff 0602 0e01 1c01 7a16 4c47 424d 6f64  ........z.LGBMod
+00000e20: 656c 2e6d 6f64 656c 5f70 7265 6469 6374  el.model_predict
+00000e30: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00000e40: 000f 0000 0043 0000 0073 dc00 0000 7c00  .....C...s....|.
+00000e50: 6401 7600 722c 6402 6403 6404 6405 6406  d.v.r,d.d.d.d.d.
+00000e60: 6407 6408 6406 6409 6409 640a 9c0a 7d01  d.d.d.d.d.d...}.
+00000e70: 640b 7c01 640c 3c00 6eac 7c00 640d 7600  d.|.d.<.n.|.d.v.
+00000e80: 726a 6402 6403 6404 6405 6406 6407 6408  rjd.d.d.d.d.d.d.
+00000e90: 6406 6409 6409 640e 640f 9c0b 7d01 640b  d.d.d.d.d...}.d.
+00000ea0: 7c01 640c 3c00 7c00 6410 7600 72d8 6411  |.d.<.|.d.v.r.d.
+00000eb0: 7c01 640c 3c00 6e6e 7c00 6412 7600 729e  |.d.<.nn|.d.v.r.
+00000ec0: 6402 6403 6404 6405 6406 6407 6413 6406  d.d.d.d.d.d.d.d.
+00000ed0: 6414 6415 6416 6417 6418 6419 641a 9c0e  d.d.d.d.d.d.d...
+00000ee0: 7d01 640b 7c01 640c 3c00 6e3a 7c00 641b  }.d.|.d.<.n:|.d.
+00000ef0: 7600 72ca 6402 641c 641d 6405 6406 6407  v.r.d.d.d.d.d.d.
+00000f00: 6408 6406 6409 6409 640a 9c0a 7d01 6411  d.d.d.d.d...}.d.
+00000f10: 7c01 640c 3c00 6e0e 7400 641e 7c00 9b00  |.d.<.n.t.d.|...
+00000f20: 9d02 8301 8201 7c01 5300 291f 4e29 015a  ......|.S.).N).Z
+00000f30: 0870 6172 616d 735f 3169 0903 0000 5a0a  .params_1i....Z.
+00000f40: 7265 6772 6573 7369 6f6e 5a04 726d 7365  regressionZ.rmse
+00000f50: e93f 0000 00e9 ffff ffff 7221 0000 00e9  .?........r!....
+00000f60: ff00 0000 722f 0000 0029 0ada 0473 6565  ....r/...)...see
+00000f70: 64da 096f 626a 6563 7469 7665 da06 6d65  d..objective..me
+00000f80: 7472 6963 723c 0000 00da 0976 6572 626f  tricr<.....verbo
+00000f90: 7369 7479 da0d 6c65 6172 6e69 6e67 5f72  sity..learning_r
+00000fa0: 6174 65da 0a6e 756d 5f6c 6561 7665 73da  ate..num_leaves.
+00000fb0: 096d 6178 5f64 6570 7468 da10 6665 6174  .max_depth..feat
+00000fc0: 7572 655f 6672 6163 7469 6f6e da10 6261  ure_fraction..ba
+00000fd0: 6767 696e 675f 6672 6163 7469 6f6e 69dc  gging_fractioni.
+00000fe0: 0500 00da 0c6e 5f65 7374 696d 6174 6f72  .....n_estimator
+00000ff0: 7329 025a 0c70 6172 616d 735f 6578 7472  s).Z.params_extr
+00001000: 61da 0b70 6172 616d 735f 6661 7374 5429  a..params_fastT)
+00001010: 0b72 4d00 0000 724e 0000 0072 4f00 0000  .rM...rN...rO...
+00001020: 723c 0000 0072 5000 0000 7251 0000 0072  r<...rP...rQ...r
+00001030: 5200 0000 7253 0000 0072 5400 0000 7255  R...rS...rT...rU
+00001040: 0000 005a 0b65 7874 7261 5f74 7265 6573  ...Z.extra_trees
+00001050: 2901 7257 0000 00e9 6400 0000 2901 5a08  ).rW....d...).Z.
+00001060: 7061 7261 6d73 5f32 6900 0800 0067 cdcc  params_2i....g..
+00001070: cccc cccc e43f 67cd cccc cccc ccec 3f67  .....?g.......?g
+00001080: fa7e 6abc 7493 683f e98c 0000 0067 9a99  .~j.t.h?.....g..
+00001090: 9999 9999 e93f 6733 3333 3333 33d3 3f29  .....?g333333.?)
+000010a0: 0e72 4d00 0000 724e 0000 0072 4f00 0000  .rM...rN...rO...
+000010b0: 723c 0000 0072 5000 0000 7251 0000 0072  r<...rP...rQ...r
+000010c0: 5200 0000 7253 0000 0072 5400 0000 7255  R...rS...rT...rU
+000010d0: 0000 005a 106d 696e 5f63 6869 6c64 5f77  ...Z.min_child_w
+000010e0: 6569 6768 745a 106d 696e 5f64 6174 615f  eightZ.min_data_
+000010f0: 696e 5f6c 6561 665a 0972 6567 5f61 6c70  in_leafZ.reg_alp
+00001100: 6861 5a0a 7265 675f 6c61 6d62 6461 2901  haZ.reg_lambda).
+00001110: 5a0a 7061 7261 6d73 5f61 6476 da06 6269  Z.params_adv..bi
+00001120: 6e61 7279 5a03 6175 637a 105b 2b5d 2070  naryZ.aucz.[+] p
+00001130: 6172 616d 735f 6964 203d 2029 01da 134e  arams_id = )...N
+00001140: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00001150: 6f72 2902 da09 7061 7261 6d73 5f69 64da  or)...params_id.
+00001160: 0670 6172 616d 7372 1000 0000 7210 0000  .paramsr....r...
+00001170: 0072 1100 0000 da0a 6765 745f 7061 7261  .r......get_para
+00001180: 6d73 6400 0000 737a 0000 0000 0108 0202  msd...sz........
 00001190: 0102 0102 0102 0102 0102 0102 0102 0102  ................
-000011a0: f606 0c0a 0208 0202 0102 0102 0102 0102  ................
-000011b0: 0102 0102 0102 0102 0102 0102 f506 0d08  ................
-000011c0: 0108 010a 0208 0202 0102 0102 0102 0102  ................
+000011a0: 0102 f606 0c0a 0208 0202 0102 0102 0102  ................
+000011b0: 0102 0102 0102 0102 0102 0102 0102 f506  ................
+000011c0: 0d08 0108 010a 0208 0202 0102 0102 0102  ................
 000011d0: 0102 0102 0102 0102 0102 0102 0102 0102  ................
-000011e0: 0102 f206 100a 0208 0202 0102 0102 0102  ................
-000011f0: 0102 0102 0102 0102 0102 0102 f606 0c0a  ................
-00001200: 020e 017a 134c 4742 4d6f 6465 6c2e 6765  ...z.LGBModel.ge
-00001210: 745f 7061 7261 6d73 4e63 0300 0000 0000  t_paramsNc......
-00001220: 0000 0000 0000 0300 0000 0300 0000 0300  ................
-00001230: 0000 7316 0000 0074 0083 00a0 017c 01a1  ..s....t.....|..
-00001240: 0101 007c 027c 005f 0264 0053 0072 1b00  ...|.|._.d.S.r..
-00001250: 0000 2903 da05 7375 7065 72da 085f 5f69  ..)...super..__i
-00001260: 6e69 745f 5f72 4700 0000 2903 da04 7365  nit__rG...)...se
-00001270: 6c66 da0a 6d6f 6465 6c5f 6e61 6d65 7247  lf..model_namerG
-00001280: 0000 00a9 01da 095f 5f63 6c61 7373 5f5f  .......__class__
-00001290: 7210 0000 0072 1100 0000 725f 0000 00ab  r....r....r_....
-000012a0: 0000 0073 0400 0000 0001 0c01 7a11 4c47  ...s........z.LG
-000012b0: 424d 6f64 656c 2e5f 5f69 6e69 745f 5f63  BModel.__init__c
-000012c0: 0400 0000 0000 0000 0000 0000 1000 0000  ................
-000012d0: 0c00 0000 4300 0000 7318 0300 007c 03a0  ....C...s....|..
-000012e0: 0064 0164 02a1 027d 047c 0264 0275 0173  .d.d...}.|.d.u.s
-000012f0: 207c 0464 0275 0173 204a 0082 017c 0464   |.d.u.s J...|.d
-00001300: 0275 0172 3274 01a0 027c 04a1 017d 027c  .u.r2t...|...}.|
-00001310: 03a0 0064 037c 0264 0419 00a1 027d 057c  ...d.|.d.....}.|
-00001320: 057c 0364 033c 007c 057c 0264 043c 007c  .|.d.<.|.|.d.<.|
-00001330: 006a 037c 0364 053c 007c 027c 0302 007c  .j.|.d.<.|.|...|
-00001340: 005f 047c 005f 057c 03a0 0064 0664 07a1  ._.|._.|...d.d..
-00001350: 027d 067c 03a0 0064 0864 09a1 027d 077c  .}.|...d.d...}.|
-00001360: 0772 be74 0664 0a7c 039b 009d 0264 0b64  .r.t.d.|.....d.d
-00001370: 0c8d 0201 0074 076a 08a0 09a1 0001 0074  .....t.j.......t
-00001380: 0664 0d7c 029b 009d 0264 0b64 0c8d 0201  .d.|.....d.d....
-00001390: 0074 076a 08a0 09a1 0001 007c 0164 0e19  .t.j.......|.d..
-000013a0: 007c 0164 0f19 0002 007d 087d 0964 107c  .|.d.....}.}.d.|
-000013b0: 01a0 0aa1 0076 0090 0172 0064 107c 01a0  .....v...r.d.|..
-000013c0: 0aa1 0076 0090 0172 007c 0164 1019 007c  ...v...r.|.d...|
-000013d0: 0164 1119 0002 007d 0a7d 0b6e 2a7c 0164  .d.....}.}.n*|.d
-000013e0: 0e19 0064 1264 0285 0219 00a0 0ba1 007c  ...d.d.........|
-000013f0: 0164 0f19 0064 1264 0285 0219 00a0 0ba1  .d...d.d........
-00001400: 0002 007d 0a7d 0b7c 03a0 0064 1364 0ba1  ...}.}.|...d.d..
-00001410: 0290 0172 867c 0164 0e3d 007c 0164 0f3d  ...r.|.d.=.|.d.=
-00001420: 0074 0ca0 0da1 0001 0064 107c 01a0 0aa1  .t.......d.|....
-00001430: 0076 0090 0172 7c64 117c 01a0 0aa1 0076  .v...r|d.|.....v
-00001440: 0090 0172 7c7c 0164 103d 007c 0164 113d  ...r||.d.=.|.d.=
-00001450: 0074 0ca0 0da1 0001 007e 0174 0ca0 0da1  .t.......~.t....
-00001460: 0001 007c 006a 0e64 0275 0190 0172 b274  ...|.j.d.u...r.t
-00001470: 0f7c 0964 1464 1583 037d 0974 10a0 1174  .|.d.d...}.t...t
-00001480: 10a0 117c 0964 1517 00a1 01a1 017d 097c  ...|.d.......}.|
-00001490: 0790 0272 0874 0664 167c 086a 129b 009d  ...r.t.d.|.j....
-000014a0: 0264 0b64 0c8d 0201 0074 076a 08a0 09a1  .d.d.....t.j....
-000014b0: 0001 0074 0664 177c 0a6a 129b 009d 0264  ...t.d.|.j.....d
+000011e0: 0102 0102 f206 100a 0208 0202 0102 0102  ................
+000011f0: 0102 0102 0102 0102 0102 0102 0102 f606  ................
+00001200: 0c0a 020e 017a 134c 4742 4d6f 6465 6c2e  .....z.LGBModel.
+00001210: 6765 745f 7061 7261 6d73 4e63 0400 0000  get_paramsNc....
+00001220: 0000 0000 0000 0000 0400 0000 0300 0000  ................
+00001230: 0300 0000 731c 0000 0074 0083 00a0 017c  ....s....t.....|
+00001240: 01a1 0101 007c 027c 005f 027c 037c 005f  .....|.|._.|.|._
+00001250: 0364 0053 0072 1b00 0000 2904 da05 7375  .d.S.r....)...su
+00001260: 7065 72da 085f 5f69 6e69 745f 5f72 4700  per..__init__rG.
+00001270: 0000 7248 0000 0029 04da 0473 656c 66da  ..rH...)...self.
+00001280: 0a6d 6f64 656c 5f6e 616d 6572 4700 0000  .model_namerG...
+00001290: 7248 0000 00a9 01da 095f 5f63 6c61 7373  rH.......__class
+000012a0: 5f5f 7210 0000 0072 1100 0000 7260 0000  __r....r....r`..
+000012b0: 00ab 0000 0073 0600 0000 0001 0c01 0601  .....s..........
+000012c0: 7a11 4c47 424d 6f64 656c 2e5f 5f69 6e69  z.LGBModel.__ini
+000012d0: 745f 5f63 0400 0000 0000 0000 0000 0000  t__c............
+000012e0: 1000 0000 0c00 0000 4300 0000 7322 0300  ........C...s"..
+000012f0: 007c 03a0 0064 0164 02a1 027d 047c 0264  .|...d.d...}.|.d
+00001300: 0275 0173 207c 0464 0275 0173 204a 0082  .u.s |.d.u.s J..
+00001310: 017c 0464 0275 0172 3274 01a0 027c 04a1  .|.d.u.r2t...|..
+00001320: 017d 027c 03a0 0064 037c 0264 0419 00a1  .}.|...d.|.d....
+00001330: 027d 057c 057c 0364 033c 007c 057c 0264  .}.|.|.d.<.|.|.d
+00001340: 043c 007c 006a 037c 0364 053c 007c 027c  .<.|.j.|.d.<.|.|
+00001350: 0302 007c 005f 047c 005f 057c 03a0 0064  ...|._.|._.|...d
+00001360: 0664 07a1 027d 067c 03a0 0064 0864 09a1  .d...}.|...d.d..
+00001370: 027d 077c 0772 be74 0664 0a7c 039b 009d  .}.|.r.t.d.|....
+00001380: 0264 0b64 0c8d 0201 0074 076a 08a0 09a1  .d.d.....t.j....
+00001390: 0001 0074 0664 0d7c 029b 009d 0264 0b64  ...t.d.|.....d.d
+000013a0: 0c8d 0201 0074 076a 08a0 09a1 0001 007c  .....t.j.......|
+000013b0: 0164 0e19 007c 0164 0f19 0002 007d 087d  .d...|.d.....}.}
+000013c0: 0964 107c 01a0 0aa1 0076 0090 0172 0064  .d.|.....v...r.d
+000013d0: 107c 01a0 0aa1 0076 0090 0172 007c 0164  .|.....v...r.|.d
+000013e0: 1019 007c 0164 1119 0002 007d 0a7d 0b6e  ...|.d.....}.}.n
+000013f0: 2a7c 0164 0e19 0064 1264 0285 0219 00a0  *|.d...d.d......
+00001400: 0ba1 007c 0164 0f19 0064 1264 0285 0219  ...|.d...d.d....
+00001410: 00a0 0ba1 0002 007d 0a7d 0b7c 03a0 0064  .......}.}.|...d
+00001420: 1364 0ba1 0290 0172 867c 0164 0e3d 007c  .d.....r.|.d.=.|
+00001430: 0164 0f3d 0074 0ca0 0da1 0001 0064 107c  .d.=.t.......d.|
+00001440: 01a0 0aa1 0076 0090 0172 7c64 117c 01a0  .....v...r|d.|..
+00001450: 0aa1 0076 0090 0172 7c7c 0164 103d 007c  ...v...r||.d.=.|
+00001460: 0164 113d 0074 0ca0 0da1 0001 007e 0174  .d.=.t.......~.t
+00001470: 0ca0 0da1 0001 007c 006a 0e64 0275 0190  .......|.j.d.u..
+00001480: 0172 bc74 0f7c 0964 147c 006a 1014 007c  .r.t.|.d.|.j...|
+00001490: 006a 1083 037d 0974 11a0 1274 11a0 127c  .j...}.t...t...|
+000014a0: 097c 006a 1017 00a1 01a1 017d 097c 0790  .|.j.......}.|..
+000014b0: 0272 1274 0664 157c 086a 139b 009d 0264  .r.t.d.|.j.....d
 000014c0: 0b64 0c8d 0201 0074 076a 08a0 09a1 0001  .d.....t.j......
-000014d0: 0074 0664 1883 0101 0074 1383 0074 1483  .t.d.....t...t..
-000014e0: 0066 0201 0074 15a0 167c 087c 09a1 027d  .f...t...|.|...}
-000014f0: 0c74 15a0 167c 0a7c 0ba1 027d 0d7c 0790  .t...|.|...}.|..
-00001500: 0272 3a74 0664 1983 0101 0074 1383 0074  .r:t.d.....t...t
-00001510: 1483 0066 0201 007e 087e 097e 0a7e 0b74  ...f...~.~.~.~.t
-00001520: 0ca0 0da1 0001 007c 03a0 0064 1a64 02a1  .......|...d.d..
-00001530: 027d 0e7c 0e64 0275 0090 0272 8e74 156a  .}.|.d.u...r.t.j
-00001540: 177c 027c 0c7c 0d67 0174 15a0 187c 067c  .|.|.|.g.t...|.|
-00001550: 0664 1b6b 0490 0272 8064 0b6e 0264 09a1  .d.k...r.d.n.d..
-00001560: 0267 0164 1c8d 047d 0f6e 807a 3674 156a  .g.d...}.n.z6t.j
-00001570: 177c 027c 0c7c 0d67 0174 15a0 187c 067c  .|.|.|.g.t...|.|
-00001580: 0664 1b6b 0490 0272 b064 0b6e 0264 09a1  .d.k...r.d.n.d..
-00001590: 0267 0174 197c 0e83 0164 1d8d 057d 0f57  .g.t.|...d...}.W
-000015a0: 006e 4801 0001 0001 0074 156a 1769 007c  .nH......t.j.i.|
-000015b0: 02a5 0164 1e74 197c 0e83 0169 01a5 017c  ...d.t.|...i...|
-000015c0: 0c7c 0d67 0174 15a0 187c 067c 0664 1b6b  .|.g.t...|.|.d.k
-000015d0: 0490 0272 fc64 0b6e 0264 09a1 0267 0164  ...r.d.n.d...g.d
-000015e0: 1c8d 047d 0f59 006e 0230 007c 0f7c 005f  ...}.Y.n.0.|.|._
-000015f0: 1a7c 0053 0029 1f61 a001 0000 0a20 2020  .|.S.).a.....   
-00001600: 2020 2020 2066 726f 6d20 7275 6e6e 696e       from runnin
-00001610: 677a 2e6d 6f64 656c 2069 6d70 6f72 7420  gz.model import 
-00001620: 4c47 424d 6f64 656c 0a20 2020 2020 2020  LGBModel.       
-00001630: 206d 6f64 656c 203d 204c 4742 4d6f 6465   model = LGBMode
-00001640: 6c28 290a 2020 2020 2020 2020 7061 7261  l().        para
-00001650: 6d73 203d 2072 7a2e 6f70 742e 6f70 745f  ms = rz.opt.opt_
-00001660: 7261 6e64 6f6d 2e67 6574 5f70 6172 616d  random.get_param
-00001670: 735f 6c67 6228 290a 2020 2020 2020 2020  s_lgb().        
-00001680: 2320 7061 7261 6d73 203d 204c 4742 4d6f  # params = LGBMo
-00001690: 6465 6c2e 6765 745f 7061 7261 6d73 2827  del.get_params('
-000016a0: 7061 7261 6d73 5f31 2729 0a20 2020 2020  params_1').     
-000016b0: 2020 200a 2020 2020 2020 2020 5879 5f64     .        Xy_d
-000016c0: 6963 7420 3d20 7b27 585f 7472 6169 6e27  ict = {'X_train'
-000016d0: 3a20 585f 7472 6169 6e2c 2027 795f 7472  : X_train, 'y_tr
-000016e0: 6169 6e27 3a20 795f 7472 6169 6e7d 0a20  ain': y_train}. 
-000016f0: 2020 2020 2020 2023 2064 656c 2058 5f74         # del X_t
-00001700: 7261 696e 2c20 795f 7472 6169 6e3b 2067  rain, y_train; g
-00001710: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
-00001720: 2020 2020 6d6f 6465 6c2e 7472 6169 6e28      model.train(
-00001730: 7b27 585f 7472 6169 6e27 3a20 585f 7472  {'X_train': X_tr
-00001740: 6169 6e2c 2027 795f 7472 6169 6e27 3a20  ain, 'y_train': 
-00001750: 795f 7472 6169 6e7d 2c20 7061 7261 6d73  y_train}, params
-00001760: 203d 2070 6172 616d 732c 206b 7761 7267   = params, kwarg
-00001770: 733d 7b27 6672 6565 5879 273a 2046 616c  s={'freeXy': Fal
-00001780: 7365 2c20 2776 6572 626f 7365 273a 2035  se, 'verbose': 5
-00001790: 307d 290a 2020 2020 2020 2020 725b 0000  0}).        r[..
-000017a0: 004e da07 6e5f 626f 6f73 7472 5500 0000  .N..n_boostrU...
-000017b0: 7261 0000 00da 0776 6572 626f 7365 7257  ra.....verboserW
-000017c0: 0000 00da 0973 686f 775f 696e 666f 467a  .....show_infoFz
-000017d0: 0d5b 2b5d 206b 7761 7267 7320 3d20 5429  .[+] kwargs = T)
-000017e0: 01da 0566 6c75 7368 7a0d 5b2b 5d20 7061  ...flushz.[+] pa
-000017f0: 7261 6d73 203d 20da 0758 5f74 7261 696e  rams = ..X_train
-00001800: da07 795f 7472 6169 6eda 0758 5f76 616c  ..y_train..X_val
-00001810: 6964 da07 795f 7661 6c69 6469 f6ff ffff  id..y_validi....
-00001820: 5a07 6672 6565 5f58 7967 0000 0000 0000  Z.free_Xyg......
-00001830: 24c0 7241 0000 007a 145b 2b5d 2058 5f74  $.rA...z.[+] X_t
-00001840: 7261 696e 2e73 6861 7065 203d 207a 145b  rain.shape = z.[
-00001850: 2b5d 2058 5f76 616c 6964 2e73 6861 7065  +] X_valid.shape
-00001860: 203d 207a 115b 2b5d 2064 7472 6169 6e20   = z.[+] dtrain 
-00001870: 6265 666f 7265 7a10 5b2b 5d20 6474 7261  beforez.[+] dtra
-00001880: 696e 2061 6674 6572 7231 0000 0072 0100  in afterr1...r..
-00001890: 0000 2902 da0a 7661 6c69 645f 7365 7473  ..)...valid_sets
-000018a0: da09 6361 6c6c 6261 636b 7329 0372 6c00  ..callbacks).rl.
-000018b0: 0000 726d 0000 0072 3100 0000 724d 0000  ..rm...r1...rM..
-000018c0: 0029 1bda 0367 6574 7232 0000 0072 5d00  .)...getr2...r].
-000018d0: 0000 7261 0000 0072 5c00 0000 da06 6b77  ..ra...r\.....kw
-000018e0: 6172 6773 da05 7072 696e 74da 0373 7973  args..print..sys
-000018f0: da06 7374 646f 7574 7267 0000 00da 046b  ..stdoutrg.....k
-00001900: 6579 73da 0463 6f70 79da 0267 635a 0763  eys..copy..gcZ.c
-00001910: 6f6c 6c65 6374 7247 0000 0072 0800 0000  ollectrG...r....
-00001920: 720c 0000 0072 1d00 0000 da05 7368 6170  r....r......shap
-00001930: 6572 0400 0000 7205 0000 0072 4300 0000  er....r....rC...
-00001940: 5a07 4461 7461 7365 74da 0574 7261 696e  Z.Dataset..train
-00001950: 5a0e 6c6f 675f 6576 616c 7561 7469 6f6e  Z.log_evaluation
-00001960: da04 6576 616c 7240 0000 0029 1072 6000  ..evalr@...).r`.
-00001970: 0000 5a07 5879 5f64 6963 7472 5c00 0000  ..Z.Xy_dictr\...
-00001980: 726f 0000 0072 5b00 0000 7264 0000 0072  ro...r[...rd...r
-00001990: 6500 0000 7266 0000 0072 6800 0000 7269  e...rf...rh...ri
-000019a0: 0000 0072 6a00 0000 726b 0000 005a 0664  ...rj...rk...Z.d
-000019b0: 7472 6169 6e5a 0664 7661 6c69 645a 0866  trainZ.dvalidZ.f
-000019c0: 6f62 6a5f 7374 7272 4000 0000 7210 0000  obj_strr@...r...
-000019d0: 0072 1000 0000 7211 0000 0072 7700 0000  .r....r....rw...
-000019e0: af00 0000 7374 0000 0000 0d0c 0114 0112  ....st..........
-000019f0: 0110 0108 0108 020a 010e 030c 010c 0104  ................
-00001a00: 011c 011c 0312 011c 0114 022a 010e 0114  ...........*....
-00001a10: 011c 0114 010a 030c 010c 0114 0306 011e  ................
-00001a20: 011e 0114 010c 010c 011a 0110 030c 010a  ................
-00001a30: 0104 0102 0102 0104 011a fc08 0702 0104  ................
-00001a40: 0102 0102 0204 011a 0106 fa0a 0806 0104  ................
-00001a50: 0112 0102 0104 011a fc0c 0606 017a 0e4c  .............z.L
-00001a60: 4742 4d6f 6465 6c2e 7472 6169 6e63 0400  GBModel.trainc..
-00001a70: 0000 0000 0000 0000 0000 0500 0000 0500  ................
-00001a80: 0000 4300 0000 733a 0000 007c 006a 006a  ..C...s:...|.j.j
-00001a90: 017c 0174 02a0 03a1 0064 0118 0064 028d  .|.t.....d...d..
-00001aa0: 027d 047c 006a 0464 0075 0172 3674 05a0  .}.|.j.d.u.r6t..
-00001ab0: 0674 05a0 067c 04a1 01a1 0164 0318 007d  .t...|.....d...}
-00001ac0: 047c 0453 0029 044e 720a 0000 0029 0172  .|.S.).Nr....).r
-00001ad0: 3b00 0000 7241 0000 0029 0772 4000 0000  ;...rA...).r@...
-00001ae0: 723c 0000 00da 0670 7375 7469 6cda 0963  r<.....psutil..c
-00001af0: 7075 5f63 6f75 6e74 7247 0000 0072 0c00  pu_countrG...r..
-00001b00: 0000 7246 0000 0029 0572 6000 0000 da01  ..rF...).r`.....
-00001b10: 5872 5c00 0000 726f 0000 005a 0679 5f70  Xr\...ro...Z.y_p
-00001b20: 7265 6472 1000 0000 7210 0000 0072 1100  redr....r....r..
-00001b30: 0000 723c 0000 0005 0100 0073 0600 0000  ..r<.......s....
-00001b40: 0001 1801 1e01 7a10 4c47 424d 6f64 656c  ......z.LGBModel
-00001b50: 2e70 7265 6469 6374 6301 0000 0000 0000  .predictc.......
-00001b60: 0000 0000 0001 0000 0003 0000 0043 0000  .............C..
-00001b70: 0073 0e00 0000 7400 7c00 6a01 a002 a100  .s....t.|.j.....
-00001b80: 8301 5300 721b 0000 0029 03da 036c 656e  ..S.r....)...len
-00001b90: 7240 0000 005a 0c66 6561 7475 7265 5f6e  r@...Z.feature_n
-00001ba0: 616d 6529 0172 6000 0000 7210 0000 0072  ame).r`...r....r
-00001bb0: 1000 0000 7211 0000 00da 0e67 6574 5f6e  ....r......get_n
-00001bc0: 5f66 6561 7475 7265 730a 0100 0073 0200  _features....s..
-00001bd0: 0000 0001 7a17 4c47 424d 6f64 656c 2e67  ....z.LGBModel.g
-00001be0: 6574 5f6e 5f66 6561 7475 7265 7346 e914  et_n_featuresF..
-00001bf0: 0000 00a9 0272 7e00 0000 7223 0000 0063  .....r~...r#...c
-00001c00: 0500 0000 0000 0000 0000 0000 0600 0000  ................
-00001c10: 0700 0000 0300 0000 7324 0000 007c 006a  ........s$...|.j
-00001c20: 006a 0164 0164 028d 017d 0574 0283 006a  .j.d.d...}.t...j
-00001c30: 037c 057c 017c 027c 037c 0464 038d 0553  .|.|.|.|.|.d...S
-00001c40: 0029 044e 5a04 6761 696e 2901 5a0f 696d  .).NZ.gain).Z.im
-00001c50: 706f 7274 616e 6365 5f74 7970 6529 01da  portance_type)..
-00001c60: 0766 6967 7369 7a65 2904 7240 0000 005a  .figsize).r@...Z
-00001c70: 1266 6561 7475 7265 5f69 6d70 6f72 7461  .feature_importa
-00001c80: 6e63 6572 5e00 0000 5a0b 5f67 6574 5f64  ncer^...Z._get_d
-00001c90: 665f 696d 7029 0672 6000 0000 5a08 636f  f_imp).r`...Z.co
-00001ca0: 6c73 5f66 6561 5a04 706c 6f74 7237 0000  ls_feaZ.plotr7..
-00001cb0: 0072 8000 0000 da03 696d 7072 6200 0000  .r......imprb...
-00001cc0: 7210 0000 0072 1100 0000 da0a 6765 745f  r....r......get_
-00001cd0: 6466 5f69 6d70 0d01 0000 7304 0000 0000  df_imp....s.....
-00001ce0: 010e 017a 134c 4742 4d6f 6465 6c2e 6765  ...z.LGBModel.ge
-00001cf0: 745f 6466 5f69 6d70 6302 0000 0000 0000  t_df_impc.......
-00001d00: 0000 0000 0002 0000 0004 0000 0003 0000  ................
-00001d10: 0073 3a00 0000 7400 a001 6401 a101 0100  .s:...t...d.....
-00001d20: 7400 6a02 7c01 6402 6403 8d02 0100 7c00  t.j.|.d.d.....|.
-00001d30: 6a03 a004 7c01 9b00 6404 9d02 a101 0100  j...|...d.......
-00001d40: 7405 8300 a006 7c01 a101 0100 6400 5300  t.....|.....d.S.
-00001d50: 2905 4e7a 0d72 6d20 2d72 6620 7b70 6174  ).Nz.rm -rf {pat
-00001d60: 687d 5429 01da 0865 7869 7374 5f6f 6bfa  h}T)...exist_ok.
-00001d70: 0a2f 6d6f 6465 6c2e 6269 6e29 07da 026f  ./model.bin)...o
-00001d80: 73da 0673 7973 7465 6dda 086d 616b 6564  s..system..maked
-00001d90: 6972 7372 4000 0000 5a0a 7361 7665 5f6d  irsr@...Z.save_m
-00001da0: 6f64 656c 725e 0000 005a 0b5f 6475 6d70  odelr^...Z._dump
-00001db0: 5f6f 7468 6572 a902 7260 0000 00da 0470  _other..r`.....p
-00001dc0: 6174 6872 6200 0000 7210 0000 0072 1100  athrb...r....r..
-00001dd0: 0000 da04 6475 6d70 1101 0000 7308 0000  ....dump....s...
-00001de0: 0000 010a 010e 0112 017a 0d4c 4742 4d6f  .........z.LGBMo
-00001df0: 6465 6c2e 6475 6d70 6302 0000 0000 0000  del.dumpc.......
-00001e00: 0000 0000 0002 0000 0003 0000 0003 0000  ................
-00001e10: 0073 2400 0000 7400 6a01 7c01 9b00 6401  .s$...t.j.|...d.
-00001e20: 9d02 6402 8d01 7c00 5f02 7403 8300 a004  ..d...|._.t.....
-00001e30: 7c01 a101 0100 7c00 5300 2903 4e72 8400  |.....|.S.).Nr..
-00001e40: 0000 2901 5a0a 6d6f 6465 6c5f 6669 6c65  ..).Z.model_file
-00001e50: 2905 7243 0000 0072 4400 0000 7240 0000  ).rC...rD...r@..
-00001e60: 0072 5e00 0000 5a0b 5f6c 6f61 645f 6f74  .r^...Z._load_ot
-00001e70: 6865 7272 8800 0000 7262 0000 0072 1000  herr....rb...r..
-00001e80: 0000 7211 0000 00da 046c 6f61 6417 0100  ..r......load...
-00001e90: 0073 0600 0000 0001 1401 0c01 7a0d 4c47  .s..........z.LG
-00001ea0: 424d 6f64 656c 2e6c 6f61 6429 0472 3300  BModel.load).r3.
-00001eb0: 0000 7233 0000 0072 3400 0000 721d 0000  ..r3...r4...r...
-00001ec0: 0029 024e 721d 0000 0029 024e 4e29 024e  .).Nr....).NN).N
-00001ed0: 4e29 044e 4672 7e00 0000 727f 0000 0029  N).NFr~...r....)
-00001ee0: 0dda 085f 5f6e 616d 655f 5fda 0a5f 5f6d  ...__name__..__m
-00001ef0: 6f64 756c 655f 5fda 0c5f 5f71 7561 6c6e  odule__..__qualn
-00001f00: 616d 655f 5f72 4800 0000 725d 0000 0072  ame__rH...r]...r
-00001f10: 5f00 0000 7277 0000 0072 3c00 0000 727d  _...rw...r<...r}
-00001f20: 0000 0072 8200 0000 728a 0000 0072 8b00  ...r....r....r..
-00001f30: 0000 da0d 5f5f 636c 6173 7363 656c 6c5f  ....__classcell_
-00001f40: 5f72 1000 0000 7210 0000 0072 6200 0000  _r....r....rb...
-00001f50: 7211 0000 0072 3200 0000 4d00 0000 7312  r....r2...M...s.
-00001f60: 0000 0008 010a 1608 470e 040a 560a 0508  ........G...V...
-00001f70: 030e 040c 0672 3200 0000 291d 7271 0000  .....r2...).rq..
-00001f80: 0072 8500 0000 7275 0000 0072 7900 0000  .r....ru...ry...
-00001f90: da05 6e75 6d70 7972 0c00 0000 da06 7061  ..numpyr......pa
-00001fa0: 6e64 6173 da02 7064 5a08 6c69 6768 7467  ndas..pdZ.lightg
-00001fb0: 626d 7243 0000 005a 0a6d 6f64 656c 2e62  bmrC...Z.model.b
-00001fc0: 6173 6572 0300 0000 5a09 7574 696c 2e75  aser....Z.util.u
-00001fd0: 7469 6c72 0400 0000 7205 0000 005a 0e75  tilr....r....Z.u
-00001fe0: 7469 6c2e 6e70 795f 6e75 6d62 6172 0600  til.npy_numbar..
-00001ff0: 0000 7207 0000 0072 0800 0000 7212 0000  ..r....r....r...
-00002000: 0072 1300 0000 721a 0000 0072 1e00 0000  .r....r....r....
-00002010: 721f 0000 0072 2000 0000 722d 0000 0072  r....r ...r-...r
-00002020: 2e00 0000 7231 0000 0072 3200 0000 7210  ....r1...r2...r.
-00002030: 0000 0072 1000 0000 7210 0000 0072 1100  ...r....r....r..
-00002040: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
-00002050: 732e 0000 0008 0108 0108 0108 0108 0108  s...............
-00002060: 0108 010c 0110 0114 0308 0108 0208 0308  ................
-00002070: 0408 0808 0308 0308 0808 1008 0608 0a10  ................
-00002080: 7f00 50                                  ..P
+000014d0: 0074 0664 167c 0a6a 139b 009d 0264 0b64  .t.d.|.j.....d.d
+000014e0: 0c8d 0201 0074 076a 08a0 09a1 0001 0074  .....t.j.......t
+000014f0: 0664 1783 0101 0074 1483 0074 1583 0066  .d.....t...t...f
+00001500: 0201 0074 16a0 177c 087c 09a1 027d 0c74  ...t...|.|...}.t
+00001510: 16a0 177c 0a7c 0ba1 027d 0d7c 0790 0272  ...|.|...}.|...r
+00001520: 4474 0664 1883 0101 0074 1483 0074 1583  Dt.d.....t...t..
+00001530: 0066 0201 007e 087e 097e 0a7e 0b74 0ca0  .f...~.~.~.~.t..
+00001540: 0da1 0001 007c 03a0 0064 1964 02a1 027d  .....|...d.d...}
+00001550: 0e7c 0e64 0275 0090 0272 9874 166a 187c  .|.d.u...r.t.j.|
+00001560: 027c 0c7c 0d67 0174 16a0 197c 067c 0664  .|.|.g.t...|.|.d
+00001570: 1a6b 0490 0272 8a64 0b6e 0264 09a1 0267  .k...r.d.n.d...g
+00001580: 0164 1b8d 047d 0f6e 807a 3674 166a 187c  .d...}.n.z6t.j.|
+00001590: 027c 0c7c 0d67 0174 16a0 197c 067c 0664  .|.|.g.t...|.|.d
+000015a0: 1a6b 0490 0272 ba64 0b6e 0264 09a1 0267  .k...r.d.n.d...g
+000015b0: 0174 1a7c 0e83 0164 1c8d 057d 0f57 006e  .t.|...d...}.W.n
+000015c0: 4801 0001 0001 0074 166a 1869 007c 02a5  H......t.j.i.|..
+000015d0: 0164 1d74 1a7c 0e83 0169 01a5 017c 0c7c  .d.t.|...i...|.|
+000015e0: 0d67 0174 16a0 197c 067c 0664 1a6b 0490  .g.t...|.|.d.k..
+000015f0: 0372 0664 0b6e 0264 09a1 0267 0164 1b8d  .r.d.n.d...g.d..
+00001600: 047d 0f59 006e 0230 007c 0f7c 005f 1b7c  .}.Y.n.0.|.|._.|
+00001610: 0053 0029 1e61 a001 0000 0a20 2020 2020  .S.).a.....     
+00001620: 2020 2066 726f 6d20 7275 6e6e 696e 677a     from runningz
+00001630: 2e6d 6f64 656c 2069 6d70 6f72 7420 4c47  .model import LG
+00001640: 424d 6f64 656c 0a20 2020 2020 2020 206d  BModel.        m
+00001650: 6f64 656c 203d 204c 4742 4d6f 6465 6c28  odel = LGBModel(
+00001660: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
+00001670: 203d 2072 7a2e 6f70 742e 6f70 745f 7261   = rz.opt.opt_ra
+00001680: 6e64 6f6d 2e67 6574 5f70 6172 616d 735f  ndom.get_params_
+00001690: 6c67 6228 290a 2020 2020 2020 2020 2320  lgb().        # 
+000016a0: 7061 7261 6d73 203d 204c 4742 4d6f 6465  params = LGBMode
+000016b0: 6c2e 6765 745f 7061 7261 6d73 2827 7061  l.get_params('pa
+000016c0: 7261 6d73 5f31 2729 0a20 2020 2020 2020  rams_1').       
+000016d0: 200a 2020 2020 2020 2020 5879 5f64 6963   .        Xy_dic
+000016e0: 7420 3d20 7b27 585f 7472 6169 6e27 3a20  t = {'X_train': 
+000016f0: 585f 7472 6169 6e2c 2027 795f 7472 6169  X_train, 'y_trai
+00001700: 6e27 3a20 795f 7472 6169 6e7d 0a20 2020  n': y_train}.   
+00001710: 2020 2020 2023 2064 656c 2058 5f74 7261       # del X_tra
+00001720: 696e 2c20 795f 7472 6169 6e3b 2067 632e  in, y_train; gc.
+00001730: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00001740: 2020 6d6f 6465 6c2e 7472 6169 6e28 7b27    model.train({'
+00001750: 585f 7472 6169 6e27 3a20 585f 7472 6169  X_train': X_trai
+00001760: 6e2c 2027 795f 7472 6169 6e27 3a20 795f  n, 'y_train': y_
+00001770: 7472 6169 6e7d 2c20 7061 7261 6d73 203d  train}, params =
+00001780: 2070 6172 616d 732c 206b 7761 7267 733d   params, kwargs=
+00001790: 7b27 6672 6565 5879 273a 2046 616c 7365  {'freeXy': False
+000017a0: 2c20 2776 6572 626f 7365 273a 2035 307d  , 'verbose': 50}
+000017b0: 290a 2020 2020 2020 2020 725c 0000 004e  ).        r\...N
+000017c0: da07 6e5f 626f 6f73 7472 5600 0000 7262  ..n_boostrV...rb
+000017d0: 0000 00da 0776 6572 626f 7365 7258 0000  .....verboserX..
+000017e0: 00da 0973 686f 775f 696e 666f 467a 0d5b  ...show_infoFz.[
+000017f0: 2b5d 206b 7761 7267 7320 3d20 5429 01da  +] kwargs = T)..
+00001800: 0566 6c75 7368 7a0d 5b2b 5d20 7061 7261  .flushz.[+] para
+00001810: 6d73 203d 20da 0758 5f74 7261 696e da07  ms = ..X_train..
+00001820: 795f 7472 6169 6eda 0758 5f76 616c 6964  y_train..X_valid
+00001830: da07 795f 7661 6c69 6469 f6ff ffff 5a07  ..y_validi....Z.
+00001840: 6672 6565 5f58 7972 4b00 0000 7a14 5b2b  free_XyrK...z.[+
+00001850: 5d20 585f 7472 6169 6e2e 7368 6170 6520  ] X_train.shape 
+00001860: 3d20 7a14 5b2b 5d20 585f 7661 6c69 642e  = z.[+] X_valid.
+00001870: 7368 6170 6520 3d20 7a11 5b2b 5d20 6474  shape = z.[+] dt
+00001880: 7261 696e 2062 6566 6f72 657a 105b 2b5d  rain beforez.[+]
+00001890: 2064 7472 6169 6e20 6166 7465 7272 3100   dtrain afterr1.
+000018a0: 0000 7201 0000 0029 02da 0a76 616c 6964  ..r....)...valid
+000018b0: 5f73 6574 73da 0963 616c 6c62 6163 6b73  _sets..callbacks
+000018c0: 2903 726d 0000 0072 6e00 0000 7231 0000  ).rm...rn...r1..
+000018d0: 0072 4e00 0000 291c da03 6765 7472 3200  .rN...)...getr2.
+000018e0: 0000 725e 0000 0072 6200 0000 725d 0000  ..r^...rb...r]..
+000018f0: 00da 066b 7761 7267 73da 0570 7269 6e74  ...kwargs..print
+00001900: da03 7379 73da 0673 7464 6f75 7472 6800  ..sys..stdoutrh.
+00001910: 0000 da04 6b65 7973 da04 636f 7079 da02  ....keys..copy..
+00001920: 6763 5a07 636f 6c6c 6563 7472 4700 0000  gcZ.collectrG...
+00001930: 7208 0000 0072 4800 0000 720c 0000 0072  r....rH...r....r
+00001940: 1d00 0000 da05 7368 6170 6572 0400 0000  ......shaper....
+00001950: 7205 0000 0072 4300 0000 5a07 4461 7461  r....rC...Z.Data
+00001960: 7365 74da 0574 7261 696e 5a0e 6c6f 675f  set..trainZ.log_
+00001970: 6576 616c 7561 7469 6f6e da04 6576 616c  evaluation..eval
+00001980: 7241 0000 0029 1072 6100 0000 5a07 5879  rA...).ra...Z.Xy
+00001990: 5f64 6963 7472 5d00 0000 7270 0000 0072  _dictr]...rp...r
+000019a0: 5c00 0000 7265 0000 0072 6600 0000 7267  \...re...rf...rg
+000019b0: 0000 0072 6900 0000 726a 0000 0072 6b00  ...ri...rj...rk.
+000019c0: 0000 726c 0000 005a 0664 7472 6169 6e5a  ..rl...Z.dtrainZ
+000019d0: 0664 7661 6c69 645a 0866 6f62 6a5f 7374  .dvalidZ.fobj_st
+000019e0: 7272 4100 0000 7210 0000 0072 1000 0000  rrA...r....r....
+000019f0: 7211 0000 0072 7800 0000 b000 0000 7374  r....rx.......st
+00001a00: 0000 0000 0d0c 0114 0112 0110 0108 0108  ................
+00001a10: 020a 010e 030c 010c 0104 011c 011c 0312  ................
+00001a20: 011c 0114 022a 010e 0114 011c 0114 010a  .....*..........
+00001a30: 030c 0114 0116 0306 011e 011e 0114 010c  ................
+00001a40: 010c 011a 0110 030c 010a 0104 0102 0102  ................
+00001a50: 0104 011a fc08 0702 0104 0102 0102 0204  ................
+00001a60: 011a 0106 fa0a 0806 0104 0112 0102 0104  ................
+00001a70: 011a fc0c 0606 017a 0e4c 4742 4d6f 6465  .......z.LGBMode
+00001a80: 6c2e 7472 6169 6e63 0400 0000 0000 0000  l.trainc........
+00001a90: 0000 0000 0700 0000 0500 0000 4300 0000  ............C...
+00001aa0: 735c 0000 007c 03a0 0064 0174 01a0 02a1  s\...|...d.t....
+00001ab0: 0064 0218 00a1 027d 047c 03a0 0064 037c  .d.....}.|...d.|
+00001ac0: 006a 03a0 04a1 00a1 027d 057c 006a 036a  .j.......}.|.j.j
+00001ad0: 057c 017c 047c 0564 048d 037d 067c 006a  .|.|.|.d...}.|.j
+00001ae0: 0664 0075 0172 5874 07a0 0874 07a0 087c  .d.u.rXt...t...|
+00001af0: 06a1 01a1 017c 006a 0918 007d 067c 0653  .....|.j...}.|.S
+00001b00: 0029 054e 723c 0000 0072 0a00 0000 7265  .).Nr<...r....re
+00001b10: 0000 0029 0272 3c00 0000 723b 0000 0029  ...).r<...r;...)
+00001b20: 0a72 6f00 0000 da06 7073 7574 696c da09  .ro.....psutil..
+00001b30: 6370 755f 636f 756e 7472 4100 0000 5a0b  cpu_countrA...Z.
+00001b40: 6e75 6d5f 6665 6174 7572 6572 3d00 0000  num_featurer=...
+00001b50: 7247 0000 0072 0c00 0000 7246 0000 0072  rG...r....rF...r
+00001b60: 4800 0000 2907 7261 0000 00da 0158 725d  H...).ra.....Xr]
+00001b70: 0000 0072 7000 0000 723c 0000 0072 6500  ...rp...r<...re.
+00001b80: 0000 5a06 795f 7072 6564 7210 0000 0072  ..Z.y_predr....r
+00001b90: 1000 0000 7211 0000 0072 3d00 0000 0601  ....r....r=.....
+00001ba0: 0000 730a 0000 0000 0114 0112 0112 0120  ..s............ 
+00001bb0: 017a 104c 4742 4d6f 6465 6c2e 7072 6564  .z.LGBModel.pred
+00001bc0: 6963 7463 0100 0000 0000 0000 0000 0000  ictc............
+00001bd0: 0100 0000 0300 0000 4300 0000 730e 0000  ........C...s...
+00001be0: 0074 007c 006a 01a0 02a1 0083 0153 0072  .t.|.j.......S.r
+00001bf0: 1b00 0000 2903 da03 6c65 6e72 4100 0000  ....)...lenrA...
+00001c00: 5a0c 6665 6174 7572 655f 6e61 6d65 2901  Z.feature_name).
+00001c10: 7261 0000 0072 1000 0000 7210 0000 0072  ra...r....r....r
+00001c20: 1100 0000 da0e 6765 745f 6e5f 6665 6174  ......get_n_feat
+00001c30: 7572 6573 0d01 0000 7302 0000 0000 017a  ures....s......z
+00001c40: 174c 4742 4d6f 6465 6c2e 6765 745f 6e5f  .LGBModel.get_n_
+00001c50: 6665 6174 7572 6573 46e9 1400 0000 a902  featuresF.......
+00001c60: 727f 0000 0072 2300 0000 6305 0000 0000  r....r#...c.....
+00001c70: 0000 0000 0000 0006 0000 0007 0000 0003  ................
+00001c80: 0000 0073 2400 0000 7c00 6a00 6a01 6401  ...s$...|.j.j.d.
+00001c90: 6402 8d01 7d05 7402 8300 6a03 7c05 7c01  d...}.t...j.|.|.
+00001ca0: 7c02 7c03 7c04 6403 8d05 5300 2904 4e5a  |.|.|.d...S.).NZ
+00001cb0: 0467 6169 6e29 015a 0f69 6d70 6f72 7461  .gain).Z.importa
+00001cc0: 6e63 655f 7479 7065 2901 da07 6669 6773  nce_type)...figs
+00001cd0: 697a 6529 0472 4100 0000 5a12 6665 6174  ize).rA...Z.feat
+00001ce0: 7572 655f 696d 706f 7274 616e 6365 725f  ure_importancer_
+00001cf0: 0000 005a 0b5f 6765 745f 6466 5f69 6d70  ...Z._get_df_imp
+00001d00: 2906 7261 0000 005a 0863 6f6c 735f 6665  ).ra...Z.cols_fe
+00001d10: 615a 0470 6c6f 7472 3700 0000 7281 0000  aZ.plotr7...r...
+00001d20: 00da 0369 6d70 7263 0000 0072 1000 0000  ...imprc...r....
+00001d30: 7211 0000 00da 0a67 6574 5f64 665f 696d  r......get_df_im
+00001d40: 7010 0100 0073 0400 0000 0001 0e01 7a13  p....s........z.
+00001d50: 4c47 424d 6f64 656c 2e67 6574 5f64 665f  LGBModel.get_df_
+00001d60: 696d 7063 0200 0000 0000 0000 0000 0000  impc............
+00001d70: 0200 0000 0400 0000 0300 0000 733a 0000  ............s:..
+00001d80: 0074 00a0 0164 01a1 0101 0074 006a 027c  .t...d.....t.j.|
+00001d90: 0164 0264 038d 0201 007c 006a 03a0 047c  .d.d.....|.j...|
+00001da0: 019b 0064 049d 02a1 0101 0074 0583 00a0  ...d.......t....
+00001db0: 067c 01a1 0101 0064 0053 0029 054e 7a0d  .|.....d.S.).Nz.
+00001dc0: 726d 202d 7266 207b 7061 7468 7d54 2901  rm -rf {path}T).
+00001dd0: da08 6578 6973 745f 6f6b fa0a 2f6d 6f64  ..exist_ok../mod
+00001de0: 656c 2e62 696e 2907 da02 6f73 da06 7379  el.bin)...os..sy
+00001df0: 7374 656d da08 6d61 6b65 6469 7273 7241  stem..makedirsrA
+00001e00: 0000 005a 0a73 6176 655f 6d6f 6465 6c72  ...Z.save_modelr
+00001e10: 5f00 0000 5a0b 5f64 756d 705f 6f74 6865  _...Z._dump_othe
+00001e20: 72a9 0272 6100 0000 da04 7061 7468 7263  r..ra.....pathrc
+00001e30: 0000 0072 1000 0000 7211 0000 00da 0464  ...r....r......d
+00001e40: 756d 7014 0100 0073 0800 0000 0001 0a01  ump....s........
+00001e50: 0e01 1201 7a0d 4c47 424d 6f64 656c 2e64  ....z.LGBModel.d
+00001e60: 756d 7063 0200 0000 0000 0000 0000 0000  umpc............
+00001e70: 0200 0000 0300 0000 0300 0000 7324 0000  ............s$..
+00001e80: 0074 006a 017c 019b 0064 019d 0264 028d  .t.j.|...d...d..
+00001e90: 017c 005f 0274 0383 00a0 047c 01a1 0101  .|._.t.....|....
+00001ea0: 007c 0053 0029 034e 7285 0000 0029 015a  .|.S.).Nr....).Z
+00001eb0: 0a6d 6f64 656c 5f66 696c 6529 0572 4300  .model_file).rC.
+00001ec0: 0000 7244 0000 0072 4100 0000 725f 0000  ..rD...rA...r_..
+00001ed0: 005a 0b5f 6c6f 6164 5f6f 7468 6572 7289  .Z._load_otherr.
+00001ee0: 0000 0072 6300 0000 7210 0000 0072 1100  ...rc...r....r..
+00001ef0: 0000 da04 6c6f 6164 1a01 0000 7306 0000  ....load....s...
+00001f00: 0000 0114 010c 017a 0d4c 4742 4d6f 6465  .......z.LGBMode
+00001f10: 6c2e 6c6f 6164 2905 7233 0000 0072 3300  l.load).r3...r3.
+00001f20: 0000 7234 0000 0072 1d00 0000 7223 0000  ..r4...r....r#..
+00001f30: 0029 034e 721d 0000 0072 2300 0000 2902  .).Nr....r#...).
+00001f40: 4e4e 2902 4e4e 2904 4e46 727f 0000 0072  NN).NN).NFr....r
+00001f50: 8000 0000 290d da08 5f5f 6e61 6d65 5f5f  ....)...__name__
+00001f60: da0a 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f  ..__module__..__
+00001f70: 7175 616c 6e61 6d65 5f5f 7249 0000 0072  qualname__rI...r
+00001f80: 5e00 0000 7260 0000 0072 7800 0000 723d  ^...r`...rx...r=
+00001f90: 0000 0072 7e00 0000 7283 0000 0072 8b00  ...r~...r....r..
+00001fa0: 0000 728c 0000 00da 0d5f 5f63 6c61 7373  ..r......__class
+00001fb0: 6365 6c6c 5f5f 7210 0000 0072 1000 0000  cell__r....r....
+00001fc0: 7263 0000 0072 1100 0000 7232 0000 004d  rc...r....r2...M
+00001fd0: 0000 0073 1200 0000 0801 0a16 0847 0e05  ...s.........G..
+00001fe0: 0a56 0a07 0803 0e04 0c06 7232 0000 0029  .V........r2...)
+00001ff0: 1d72 7200 0000 7286 0000 0072 7600 0000  .rr...r....rv...
+00002000: 727a 0000 00da 056e 756d 7079 720c 0000  rz.....numpyr...
+00002010: 00da 0670 616e 6461 73da 0270 645a 086c  ...pandas..pdZ.l
+00002020: 6967 6874 6762 6d72 4300 0000 5a0a 6d6f  ightgbmrC...Z.mo
+00002030: 6465 6c2e 6261 7365 7203 0000 005a 0975  del.baser....Z.u
+00002040: 7469 6c2e 7574 696c 7204 0000 0072 0500  til.utilr....r..
+00002050: 0000 5a0e 7574 696c 2e6e 7079 5f6e 756d  ..Z.util.npy_num
+00002060: 6261 7206 0000 0072 0700 0000 7208 0000  bar....r....r...
+00002070: 0072 1200 0000 7213 0000 0072 1a00 0000  .r....r....r....
+00002080: 721e 0000 0072 1f00 0000 7220 0000 0072  r....r....r ...r
+00002090: 2d00 0000 722e 0000 0072 3100 0000 7232  -...r....r1...r2
+000020a0: 0000 0072 1000 0000 7210 0000 0072 1000  ...r....r....r..
+000020b0: 0000 7211 0000 00da 083c 6d6f 6475 6c65  ..r......<module
+000020c0: 3e01 0000 0073 2e00 0000 0801 0801 0801  >....s..........
+000020d0: 0801 0801 0801 0801 0c01 1001 1403 0801  ................
+000020e0: 0802 0803 0804 0808 0803 0803 0808 0810  ................
+000020f0: 0806 080a 107f 0053                      .......S
```

## runningz/model/tree/model_lgb_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 11922 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 922e 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 622f 0000  a.........\fb/..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 61ed 2c00  ..d.S.).N../a.,.
+00000100: 0100 6400 5300 2906 4efa 012f 61bd 2d00  ..d.S.).N../a.-.
 00000110: 0069 6d70 6f72 7420 7379 730a 696d 706f  .import sys.impo
 00000120: 7274 206f 730a 696d 706f 7274 2067 630a  rt os.import gc.
 00000130: 696d 706f 7274 2070 7375 7469 6c0a 696d  import psutil.im
 00000140: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
 00000150: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
 00000160: 7320 7064 0a69 6d70 6f72 7420 6c69 6768  s pd.import ligh
 00000170: 7467 626d 2061 7320 6c67 620a 6672 6f6d  tgbm as lgb.from
@@ -126,637 +126,650 @@
 000007d0: 6e64 0a0a 636c 6173 7320 4c47 424d 6f64  nd..class LGBMod
 000007e0: 656c 2842 6173 654d 6f64 656c 293a 0a20  el(BaseModel):. 
 000007f0: 2020 2064 6566 206d 6f64 656c 5f70 7265     def model_pre
 00000800: 6469 6374 286d 6f64 656c 2c20 585f 7465  dict(model, X_te
 00000810: 7374 2c20 6e20 3d20 3939 3939 3939 2c20  st, n = 999999, 
 00000820: 6b20 3d20 3939 3939 3939 2c20 6e5f 6a6f  k = 999999, n_jo
 00000830: 6273 203d 2033 322c 2066 5f6c 6162 656c  bs = 32, f_label
-00000840: 203d 2027 6c6f 6731 7027 293a 0a20 2020   = 'log1p'):.   
-00000850: 2020 2020 205c 275c 275c 270a 2020 2020       \'\'\'.    
-00000860: 2020 2020 626f 6f73 745f 6c69 7374 2c20      boost_list, 
-00000870: 795f 7072 6564 5f62 6f6f 7374 203d 206d  y_pred_boost = m
-00000880: 6f64 656c 5f70 7265 6469 6374 286d 6f64  odel_predict(mod
-00000890: 656c 2c20 582c 206b 203d 2035 302c 206e  el, X, k = 50, n
-000008a0: 5f6a 6f62 7320 3d20 3429 0a0a 2020 2020  _jobs = 4)..    
-000008b0: 2020 2020 6465 6620 6d6f 6465 6c5f 7072      def model_pr
-000008c0: 6564 6963 7428 6d6f 6465 6c2c 2058 5f74  edict(model, X_t
-000008d0: 6573 742c 206e 203d 2039 3939 3939 392c  est, n = 999999,
-000008e0: 206b 203d 2039 3939 3939 392c 206e 5f6a   k = 999999, n_j
-000008f0: 6f62 7320 3d20 3332 293a 0a20 2020 2020  obs = 32):.     
-00000900: 2020 2020 2020 206d 6f64 656c 203d 206d         model = m
-00000910: 6f64 656c 2069 6620 7479 7065 286d 6f64  odel if type(mod
-00000920: 656c 2920 6973 206c 6762 2e62 6173 6963  el) is lgb.basic
-00000930: 2e42 6f6f 7374 6572 2065 6c73 6520 6d6f  .Booster else mo
-00000940: 6465 6c2e 6d6f 6465 6c0a 2020 2020 2020  del.model.      
-00000950: 2020 2020 2020 6e20 3d20 6d69 6e28 6e2c        n = min(n,
-00000960: 206d 6f64 656c 2e6e 756d 5f74 7265 6573   model.num_trees
-00000970: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-00000980: 626f 6f73 745f 6c69 7374 203d 205b 6d69  boost_list = [mi
-00000990: 6e28 6e2c 2078 202b 206b 2920 666f 7220  n(n, x + k) for 
-000009a0: 7820 696e 2072 616e 6765 2830 2c20 6e2c  x in range(0, n,
-000009b0: 206b 295d 0a20 2020 2020 2020 2020 2020   k)].           
-000009c0: 2079 7320 3d20 5b6d 6f64 656c 2e70 7265   ys = [model.pre
-000009d0: 6469 6374 2858 5f74 6573 742c 2073 7461  dict(X_test, sta
-000009e0: 7274 5f69 7465 7261 7469 6f6e 203d 2069  rt_iteration = i
-000009f0: 2c20 6e75 6d5f 6974 6572 6174 696f 6e20  , num_iteration 
-00000a00: 3d20 6d69 6e28 6b2c 206e 202d 2069 292c  = min(k, n - i),
-00000a10: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-00000a20: 2020 6e5f 6a6f 6273 203d 206e 5f6a 6f62    n_jobs = n_job
-00000a30: 7329 2066 6f72 2069 2069 6e20 7261 6e67  s) for i in rang
-00000a40: 6528 302c 206e 2c20 6b29 5d0a 2020 2020  e(0, n, k)].    
-00000a50: 2020 2020 2020 2020 795f 7072 6564 5f62          y_pred_b
-00000a60: 6f6f 7374 203d 206e 702e 6375 6d73 756d  oost = np.cumsum
-00000a70: 2879 732c 2061 7869 7320 3d20 3029 0a20  (ys, axis = 0). 
-00000a80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00000a90: 6e20 626f 6f73 745f 6c69 7374 2c20 795f  n boost_list, y_
-00000aa0: 7072 6564 5f62 6f6f 7374 0a20 2020 2020  pred_boost.     
-00000ab0: 2020 205c 275c 275c 270a 2020 2020 2020     \'\'\'.      
-00000ac0: 2020 6d6f 6465 6c20 3d20 6d6f 6465 6c20    model = model 
-00000ad0: 6966 2074 7970 6528 6d6f 6465 6c29 2069  if type(model) i
-00000ae0: 7320 6c67 622e 6261 7369 632e 426f 6f73  s lgb.basic.Boos
-00000af0: 7465 7220 656c 7365 206d 6f64 656c 2e6d  ter else model.m
-00000b00: 6f64 656c 0a20 2020 2020 2020 206e 203d  odel.        n =
-00000b10: 206d 696e 286e 2c20 6d6f 6465 6c2e 6e75   min(n, model.nu
-00000b20: 6d5f 7472 6565 7328 2929 0a20 2020 2020  m_trees()).     
-00000b30: 2020 2062 6f6f 7374 5f6c 6973 7420 3d20     boost_list = 
-00000b40: 5b6d 696e 286e 2c20 7820 2b20 6b29 2066  [min(n, x + k) f
-00000b50: 6f72 2078 2069 6e20 7261 6e67 6528 302c  or x in range(0,
-00000b60: 206e 2c20 6b29 5d0a 2020 2020 2020 2020   n, k)].        
-00000b70: 7973 203d 205b 6d6f 6465 6c2e 7072 6564  ys = [model.pred
-00000b80: 6963 7428 585f 7465 7374 2c20 7374 6172  ict(X_test, star
-00000b90: 745f 6974 6572 6174 696f 6e20 3d20 692c  t_iteration = i,
-00000ba0: 206e 756d 5f69 7465 7261 7469 6f6e 203d   num_iteration =
-00000bb0: 206d 696e 286b 2c20 6e20 2d20 6929 2c20   min(k, n - i), 
-00000bc0: 0a20 2020 2020 2020 2020 2020 206e 5f6a  .            n_j
-00000bd0: 6f62 7320 3d20 6e5f 6a6f 6273 2920 666f  obs = n_jobs) fo
-00000be0: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
-00000bf0: 6e2c 206b 295d 0a20 2020 2020 2020 2079  n, k)].        y
-00000c00: 5f70 7265 645f 626f 6f73 7420 3d20 6e70  _pred_boost = np
-00000c10: 2e63 756d 7375 6d28 7973 2c20 6178 6973  .cumsum(ys, axis
-00000c20: 203d 2030 290a 2020 2020 2020 2020 6966   = 0).        if
-00000c30: 2066 5f6c 6162 656c 2069 7320 6e6f 7420   f_label is not 
-00000c40: 4e6f 6e65 3a20 795f 7072 6564 5f62 6f6f  None: y_pred_boo
-00000c50: 7374 203d 206e 702e 6578 706d 3128 6e70  st = np.expm1(np
-00000c60: 2e65 7870 6d31 2879 5f70 7265 645f 626f  .expm1(y_pred_bo
-00000c70: 6f73 7429 2920 2d20 3130 2e30 0a20 2020  ost)) - 10.0.   
-00000c80: 2020 2020 2072 6574 7572 6e20 626f 6f73       return boos
-00000c90: 745f 6c69 7374 2c20 795f 7072 6564 5f62  t_list, y_pred_b
-00000ca0: 6f6f 7374 0a0a 2020 2020 6465 6620 6765  oost..    def ge
-00000cb0: 745f 7061 7261 6d73 2870 6172 616d 735f  t_params(params_
-00000cc0: 6964 293a 0a20 2020 2020 2020 2069 6620  id):.        if 
-00000cd0: 7061 7261 6d73 5f69 6420 696e 205b 2770  params_id in ['p
-00000ce0: 6172 616d 735f 3127 5d3a 0a20 2020 2020  arams_1']:.     
-00000cf0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00000d00: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00000d10: 2020 2773 6565 6427 3a20 3737 372c 0a20    'seed': 777,. 
-00000d20: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000d30: 6f62 6a65 6374 6976 6527 3a20 2772 6567  objective': 'reg
-00000d40: 7265 7373 696f 6e27 2c0a 2020 2020 2020  ression',.      
-00000d50: 2020 2020 2020 2020 2020 276d 6574 7269            'metri
-00000d60: 6327 3a20 2772 6d73 6527 2c0a 2020 2020  c': 'rmse',.    
-00000d70: 2020 2020 2020 2020 2020 2020 226e 5f6a              "n_j
-00000d80: 6f62 7322 3a20 3633 2c0a 2020 2020 2020  obs": 63,.      
-00000d90: 2020 2020 2020 2020 2020 2776 6572 626f            'verbo
-00000da0: 7369 7479 273a 202d 312c 0a20 2020 2020  sity': -1,.     
-00000db0: 2020 2020 2020 2020 2020 2027 6c65 6172             'lear
-00000dc0: 6e69 6e67 5f72 6174 6527 3a20 302e 3031  ning_rate': 0.01
-00000dd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00000de0: 2020 276e 756d 5f6c 6561 7665 7327 3a20    'num_leaves': 
-00000df0: 3235 352c 0a20 2020 2020 2020 2020 2020  255,.           
-00000e00: 2020 2020 2027 6d61 785f 6465 7074 6827       'max_depth'
-00000e10: 3a20 2d31 2c0a 2020 2020 2020 2020 2020  : -1,.          
-00000e20: 2020 2020 2020 2766 6561 7475 7265 5f66        'feature_f
-00000e30: 7261 6374 696f 6e27 3a20 302e 352c 0a20  raction': 0.5,. 
-00000e40: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000e50: 6261 6767 696e 675f 6672 6163 7469 6f6e  bagging_fraction
-00000e60: 273a 2030 2e35 2c0a 2020 2020 2020 2020  ': 0.5,.        
-00000e70: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00000e80: 2020 7061 7261 6d73 5b27 6e5f 6573 7469    params['n_esti
-00000e90: 6d61 746f 7273 275d 203d 2031 3530 300a  mators'] = 1500.
-00000ea0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00000eb0: 2020 2020 2065 6c69 6620 7061 7261 6d73       elif params
-00000ec0: 5f69 6420 696e 205b 2770 6172 616d 735f  _id in ['params_
-00000ed0: 6578 7472 6127 2c20 2770 6172 616d 735f  extra', 'params_
-00000ee0: 6661 7374 275d 3a0a 2020 2020 2020 2020  fast']:.        
-00000ef0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00000f00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000f10: 7365 6564 273a 2037 3737 2c0a 2020 2020  seed': 777,.    
-00000f20: 2020 2020 2020 2020 2020 2020 276f 626a              'obj
-00000f30: 6563 7469 7665 273a 2027 7265 6772 6573  ective': 'regres
-00000f40: 7369 6f6e 272c 0a20 2020 2020 2020 2020  sion',.         
-00000f50: 2020 2020 2020 2027 6d65 7472 6963 273a         'metric':
-00000f60: 2027 726d 7365 272c 0a20 2020 2020 2020   'rmse',.       
-00000f70: 2020 2020 2020 2020 2022 6e5f 6a6f 6273           "n_jobs
-00000f80: 223a 2036 332c 0a20 2020 2020 2020 2020  ": 63,.         
-00000f90: 2020 2020 2020 2027 7665 7262 6f73 6974         'verbosit
-00000fa0: 7927 3a20 2d31 2c0a 2020 2020 2020 2020  y': -1,.        
-00000fb0: 2020 2020 2020 2020 276c 6561 726e 696e          'learnin
-00000fc0: 675f 7261 7465 273a 2030 2e30 312c 0a20  g_rate': 0.01,. 
-00000fd0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00000fe0: 6e75 6d5f 6c65 6176 6573 273a 2032 3535  num_leaves': 255
-00000ff0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001000: 2020 276d 6178 5f64 6570 7468 273a 202d    'max_depth': -
-00001010: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00001020: 2020 2027 6665 6174 7572 655f 6672 6163     'feature_frac
-00001030: 7469 6f6e 273a 2030 2e35 2c0a 2020 2020  tion': 0.5,.    
-00001040: 2020 2020 2020 2020 2020 2020 2762 6167              'bag
-00001050: 6769 6e67 5f66 7261 6374 696f 6e27 3a20  ging_fraction': 
-00001060: 302e 352c 0a20 2020 2020 2020 2020 2020  0.5,.           
-00001070: 2020 2020 2027 6578 7472 615f 7472 6565       'extra_tree
-00001080: 7327 3a20 5472 7565 2c0a 2020 2020 2020  s': True,.      
-00001090: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000010a0: 2020 2020 7061 7261 6d73 5b27 6e5f 6573      params['n_es
-000010b0: 7469 6d61 746f 7273 275d 203d 2031 3530  timators'] = 150
-000010c0: 300a 2020 2020 2020 2020 2020 2020 6966  0.            if
-000010d0: 2070 6172 616d 735f 6964 2069 6e20 5b27   params_id in ['
-000010e0: 7061 7261 6d73 5f66 6173 7427 5d3a 0a20  params_fast']:. 
-000010f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00001100: 6172 616d 735b 276e 5f65 7374 696d 6174  arams['n_estimat
-00001110: 6f72 7327 5d20 3d20 3130 300a 0a20 2020  ors'] = 100..   
-00001120: 2020 2020 2065 6c69 6620 7061 7261 6d73       elif params
-00001130: 5f69 6420 696e 205b 2770 6172 616d 735f  _id in ['params_
-00001140: 3227 5d3a 0a20 2020 2020 2020 2020 2020  2']:.           
-00001150: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-00001160: 2020 2020 2020 2020 2020 2020 2773 6565              'see
-00001170: 6427 3a20 3737 372c 0a20 2020 2020 2020  d': 777,.       
-00001180: 2020 2020 2020 2020 2027 6f62 6a65 6374           'object
-00001190: 6976 6527 3a20 2772 6567 7265 7373 696f  ive': 'regressio
-000011a0: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
-000011b0: 2020 2020 276d 6574 7269 6327 3a20 2772      'metric': 'r
-000011c0: 6d73 6527 2c0a 2020 2020 2020 2020 2020  mse',.          
-000011d0: 2020 2020 2020 226e 5f6a 6f62 7322 3a20        "n_jobs": 
-000011e0: 3633 2c0a 2020 2020 2020 2020 2020 2020  63,.            
-000011f0: 2020 2020 2776 6572 626f 7369 7479 273a      'verbosity':
-00001200: 202d 312c 0a20 2020 2020 2020 2020 2020   -1,.           
-00001210: 2020 2020 2027 6c65 6172 6e69 6e67 5f72       'learning_r
-00001220: 6174 6527 3a20 302e 3031 2c0a 2020 2020  ate': 0.01,.    
-00001230: 2020 2020 2020 2020 2020 2020 276e 756d              'num
-00001240: 5f6c 6561 7665 7327 3a20 3230 3438 2c0a  _leaves': 2048,.
-00001250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001260: 276d 6178 5f64 6570 7468 273a 202d 312c  'max_depth': -1,
-00001270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001280: 2027 6665 6174 7572 655f 6672 6163 7469   'feature_fracti
-00001290: 6f6e 273a 2030 2e36 352c 0a20 2020 2020  on': 0.65,.     
-000012a0: 2020 2020 2020 2020 2020 2027 6261 6767             'bagg
-000012b0: 696e 675f 6672 6163 7469 6f6e 273a 2030  ing_fraction': 0
-000012c0: 2e39 2c0a 2020 2020 2020 2020 2020 2020  .9,.            
-000012d0: 2020 2020 276d 696e 5f63 6869 6c64 5f77      'min_child_w
-000012e0: 6569 6768 7427 3a20 302e 3030 332c 0a20  eight': 0.003,. 
-000012f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00001300: 6d69 6e5f 6461 7461 5f69 6e5f 6c65 6166  min_data_in_leaf
-00001310: 273a 2031 3430 2c0a 2020 2020 2020 2020  ': 140,.        
-00001320: 2020 2020 2020 2020 2772 6567 5f61 6c70          'reg_alp
-00001330: 6861 273a 2030 2e38 2c0a 2020 2020 2020  ha': 0.8,.      
-00001340: 2020 2020 2020 2020 2020 2772 6567 5f6c            'reg_l
-00001350: 616d 6264 6127 3a20 302e 332c 0a20 2020  ambda': 0.3,.   
-00001360: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00001370: 2020 2020 2020 2070 6172 616d 735b 276e         params['n
-00001380: 5f65 7374 696d 6174 6f72 7327 5d20 3d20  _estimators'] = 
-00001390: 3135 3030 0a20 2020 2020 2020 200a 2020  1500.        .  
-000013a0: 2020 2020 2020 656c 6966 2070 6172 616d        elif param
-000013b0: 735f 6964 2069 6e20 5b27 7061 7261 6d73  s_id in ['params
-000013c0: 5f61 6476 275d 3a0a 2020 2020 2020 2020  _adv']:.        
-000013d0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-000013e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000013f0: 7365 6564 273a 2037 3737 2c0a 2020 2020  seed': 777,.    
-00001400: 2020 2020 2020 2020 2020 2020 276f 626a              'obj
-00001410: 6563 7469 7665 273a 2027 6269 6e61 7279  ective': 'binary
-00001420: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00001430: 2020 2027 6d65 7472 6963 273a 2027 6175     'metric': 'au
-00001440: 6327 2c0a 2020 2020 2020 2020 2020 2020  c',.            
-00001450: 2020 2020 226e 5f6a 6f62 7322 3a20 3633      "n_jobs": 63
-00001460: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001470: 2020 2776 6572 626f 7369 7479 273a 202d    'verbosity': -
-00001480: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00001490: 2020 2027 6c65 6172 6e69 6e67 5f72 6174     'learning_rat
-000014a0: 6527 3a20 302e 3031 2c0a 2020 2020 2020  e': 0.01,.      
-000014b0: 2020 2020 2020 2020 2020 276e 756d 5f6c            'num_l
-000014c0: 6561 7665 7327 3a20 3235 352c 0a20 2020  eaves': 255,.   
-000014d0: 2020 2020 2020 2020 2020 2020 2027 6d61               'ma
-000014e0: 785f 6465 7074 6827 3a20 2d31 2c0a 2020  x_depth': -1,.  
-000014f0: 2020 2020 2020 2020 2020 2020 2020 2766                'f
-00001500: 6561 7475 7265 5f66 7261 6374 696f 6e27  eature_fraction'
-00001510: 3a20 302e 352c 0a20 2020 2020 2020 2020  : 0.5,.         
-00001520: 2020 2020 2020 2027 6261 6767 696e 675f         'bagging_
-00001530: 6672 6163 7469 6f6e 273a 2030 2e35 2c0a  fraction': 0.5,.
-00001540: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00001550: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00001560: 5b27 6e5f 6573 7469 6d61 746f 7273 275d  ['n_estimators']
-00001570: 203d 2031 3030 0a20 2020 2020 2020 2065   = 100.        e
-00001580: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00001590: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-000015a0: 656e 7465 6445 7272 6f72 2866 275b 2b5d  entedError(f'[+]
-000015b0: 2070 6172 616d 735f 6964 203d 207b 7061   params_id = {pa
-000015c0: 7261 6d73 5f69 647d 2729 0a20 2020 2020  rams_id}').     
-000015d0: 2020 2072 6574 7572 6e20 7061 7261 6d73     return params
-000015e0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-000015f0: 5f5f 2873 656c 662c 206d 6f64 656c 5f6e  __(self, model_n
-00001600: 616d 6520 3d20 4e6f 6e65 2c20 665f 6c61  ame = None, f_la
-00001610: 6265 6c20 3d20 276c 6f67 3170 2729 3a0a  bel = 'log1p'):.
-00001620: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00001630: 5f5f 696e 6974 5f5f 286d 6f64 656c 5f6e  __init__(model_n
-00001640: 616d 6529 0a20 2020 2020 2020 2073 656c  ame).        sel
-00001650: 662e 665f 6c61 6265 6c20 3d20 665f 6c61  f.f_label = f_la
-00001660: 6265 6c0a 0a20 2020 2064 6566 2074 7261  bel..    def tra
-00001670: 696e 2873 656c 662c 2058 795f 6469 6374  in(self, Xy_dict
-00001680: 2c20 7061 7261 6d73 203d 204e 6f6e 652c  , params = None,
-00001690: 206b 7761 7267 7320 3d20 4e6f 6e65 293a   kwargs = None):
-000016a0: 0a20 2020 2020 2020 205c 275c 275c 270a  .        \'\'\'.
-000016b0: 2020 2020 2020 2020 6672 6f6d 2072 756e          from run
-000016c0: 6e69 6e67 7a2e 6d6f 6465 6c20 696d 706f  ningz.model impo
-000016d0: 7274 204c 4742 4d6f 6465 6c0a 2020 2020  rt LGBModel.    
-000016e0: 2020 2020 6d6f 6465 6c20 3d20 4c47 424d      model = LGBM
-000016f0: 6f64 656c 2829 0a20 2020 2020 2020 2070  odel().        p
-00001700: 6172 616d 7320 3d20 727a 2e6f 7074 2e6f  arams = rz.opt.o
-00001710: 7074 5f72 616e 646f 6d2e 6765 745f 7061  pt_random.get_pa
-00001720: 7261 6d73 5f6c 6762 2829 0a20 2020 2020  rams_lgb().     
-00001730: 2020 2023 2070 6172 616d 7320 3d20 4c47     # params = LG
-00001740: 424d 6f64 656c 2e67 6574 5f70 6172 616d  BModel.get_param
-00001750: 7328 2770 6172 616d 735f 3127 290a 2020  s('params_1').  
-00001760: 2020 2020 2020 0a20 2020 2020 2020 2058        .        X
-00001770: 795f 6469 6374 203d 207b 2758 5f74 7261  y_dict = {'X_tra
-00001780: 696e 273a 2058 5f74 7261 696e 2c20 2779  in': X_train, 'y
-00001790: 5f74 7261 696e 273a 2079 5f74 7261 696e  _train': y_train
-000017a0: 7d0a 2020 2020 2020 2020 2320 6465 6c20  }.        # del 
-000017b0: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-000017c0: 3b20 6763 2e63 6f6c 6c65 6374 2829 0a20  ; gc.collect(). 
-000017d0: 2020 2020 2020 206d 6f64 656c 2e74 7261         model.tra
-000017e0: 696e 287b 2758 5f74 7261 696e 273a 2058  in({'X_train': X
-000017f0: 5f74 7261 696e 2c20 2779 5f74 7261 696e  _train, 'y_train
-00001800: 273a 2079 5f74 7261 696e 7d2c 2070 6172  ': y_train}, par
-00001810: 616d 7320 3d20 7061 7261 6d73 2c20 6b77  ams = params, kw
-00001820: 6172 6773 3d7b 2766 7265 6558 7927 3a20  args={'freeXy': 
-00001830: 4661 6c73 652c 2027 7665 7262 6f73 6527  False, 'verbose'
-00001840: 3a20 3530 7d29 0a20 2020 2020 2020 205c  : 50}).        \
-00001850: 275c 275c 270a 2020 2020 2020 2020 0a20  '\'\'.        . 
-00001860: 2020 2020 2020 2023 2070 6172 616d 730a         # params.
-00001870: 2020 2020 2020 2020 7061 7261 6d73 5f69          params_i
-00001880: 6420 3d20 6b77 6172 6773 2e67 6574 2827  d = kwargs.get('
-00001890: 7061 7261 6d73 5f69 6427 2c20 4e6f 6e65  params_id', None
-000018a0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-000018b0: 2070 6172 616d 7320 6973 206e 6f74 204e   params is not N
-000018c0: 6f6e 6520 6f72 2070 6172 616d 735f 6964  one or params_id
-000018d0: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
-000018e0: 2020 2020 2069 6620 7061 7261 6d73 5f69       if params_i
-000018f0: 6420 6973 206e 6f74 204e 6f6e 653a 2070  d is not None: p
-00001900: 6172 616d 7320 3d20 4c47 424d 6f64 656c  arams = LGBModel
-00001910: 2e67 6574 5f70 6172 616d 7328 7061 7261  .get_params(para
-00001920: 6d73 5f69 6429 0a20 2020 2020 2020 206e  ms_id).        n
-00001930: 5f62 6f6f 7374 203d 206b 7761 7267 732e  _boost = kwargs.
-00001940: 6765 7428 276e 5f62 6f6f 7374 272c 2070  get('n_boost', p
-00001950: 6172 616d 735b 276e 5f65 7374 696d 6174  arams['n_estimat
-00001960: 6f72 7327 5d29 0a20 2020 2020 2020 206b  ors']).        k
-00001970: 7761 7267 735b 276e 5f62 6f6f 7374 275d  wargs['n_boost']
-00001980: 203d 206e 5f62 6f6f 7374 0a20 2020 2020   = n_boost.     
-00001990: 2020 2070 6172 616d 735b 276e 5f65 7374     params['n_est
-000019a0: 696d 6174 6f72 7327 5d20 3d20 6e5f 626f  imators'] = n_bo
-000019b0: 6f73 740a 2020 2020 2020 2020 2320 6465  ost.        # de
-000019c0: 6c20 7061 7261 6d73 5b27 6e5f 6573 7469  l params['n_esti
-000019d0: 6d61 746f 7273 275d 0a20 2020 2020 2020  mators'].       
-000019e0: 206b 7761 7267 735b 276d 6f64 656c 5f6e   kwargs['model_n
-000019f0: 616d 6527 5d20 3d20 7365 6c66 2e6d 6f64  ame'] = self.mod
-00001a00: 656c 5f6e 616d 650a 2020 2020 2020 2020  el_name.        
-00001a10: 7365 6c66 2e70 6172 616d 732c 2073 656c  self.params, sel
-00001a20: 662e 6b77 6172 6773 203d 2070 6172 616d  f.kwargs = param
-00001a30: 732c 206b 7761 7267 730a 2020 2020 2020  s, kwargs.      
-00001a40: 2020 0a20 2020 2020 2020 2023 206b 7761    .        # kwa
-00001a50: 6772 730a 2020 2020 2020 2020 7665 7262  grs.        verb
-00001a60: 6f73 6520 3d20 6b77 6172 6773 2e67 6574  ose = kwargs.get
-00001a70: 2827 7665 7262 6f73 6527 2c20 3130 3029  ('verbose', 100)
-00001a80: 0a20 2020 2020 2020 2073 686f 775f 696e  .        show_in
-00001a90: 666f 203d 206b 7761 7267 732e 6765 7428  fo = kwargs.get(
-00001aa0: 2773 686f 775f 696e 666f 272c 2046 616c  'show_info', Fal
-00001ab0: 7365 290a 2020 2020 2020 2020 6966 2073  se).        if s
-00001ac0: 686f 775f 696e 666f 3a0a 2020 2020 2020  how_info:.      
-00001ad0: 2020 2020 2020 7072 696e 7428 6627 5b2b        print(f'[+
-00001ae0: 5d20 6b77 6172 6773 203d 207b 6b77 6172  ] kwargs = {kwar
-00001af0: 6773 7d27 2c20 666c 7573 683d 5472 7565  gs}', flush=True
-00001b00: 293b 2073 7973 2e73 7464 6f75 742e 666c  ); sys.stdout.fl
-00001b10: 7573 6828 290a 2020 2020 2020 2020 2020  ush().          
-00001b20: 2020 7072 696e 7428 6627 5b2b 5d20 7061    print(f'[+] pa
-00001b30: 7261 6d73 203d 207b 7061 7261 6d73 7d27  rams = {params}'
-00001b40: 2c20 666c 7573 683d 5472 7565 293b 2073  , flush=True); s
-00001b50: 7973 2e73 7464 6f75 742e 666c 7573 6828  ys.stdout.flush(
-00001b60: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-00001b70: 2020 2023 2058 5f74 7261 696e 0a20 2020     # X_train.   
-00001b80: 2020 2020 2058 5f74 7261 696e 2c20 795f       X_train, y_
-00001b90: 7472 6169 6e20 3d20 5879 5f64 6963 745b  train = Xy_dict[
-00001ba0: 2758 5f74 7261 696e 275d 2c20 5879 5f64  'X_train'], Xy_d
-00001bb0: 6963 745b 2779 5f74 7261 696e 275d 0a20  ict['y_train']. 
-00001bc0: 2020 2020 2020 2069 6620 2758 5f76 616c         if 'X_val
-00001bd0: 6964 2720 696e 2058 795f 6469 6374 2e6b  id' in Xy_dict.k
-00001be0: 6579 7328 2920 616e 6420 2758 5f76 616c  eys() and 'X_val
-00001bf0: 6964 2720 696e 2058 795f 6469 6374 2e6b  id' in Xy_dict.k
-00001c00: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
-00001c10: 2020 2058 5f76 616c 6964 2c20 795f 7661     X_valid, y_va
-00001c20: 6c69 6420 3d20 5879 5f64 6963 745b 2758  lid = Xy_dict['X
-00001c30: 5f76 616c 6964 275d 2c20 5879 5f64 6963  _valid'], Xy_dic
-00001c40: 745b 2779 5f76 616c 6964 275d 0a20 2020  t['y_valid'].   
-00001c50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00001c60: 2020 2020 2020 2058 5f76 616c 6964 2c20         X_valid, 
-00001c70: 795f 7661 6c69 6420 3d20 5879 5f64 6963  y_valid = Xy_dic
-00001c80: 745b 2758 5f74 7261 696e 275d 5b2d 3130  t['X_train'][-10
-00001c90: 3a5d 2e63 6f70 7928 292c 2058 795f 6469  :].copy(), Xy_di
-00001ca0: 6374 5b27 795f 7472 6169 6e27 5d5b 2d31  ct['y_train'][-1
-00001cb0: 303a 5d2e 636f 7079 2829 0a20 2020 2020  0:].copy().     
-00001cc0: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
-00001cd0: 2827 6672 6565 5f58 7927 2c20 5472 7565  ('free_Xy', True
-00001ce0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00001cf0: 656c 2058 795f 6469 6374 5b27 585f 7472  el Xy_dict['X_tr
-00001d00: 6169 6e27 5d2c 2058 795f 6469 6374 5b27  ain'], Xy_dict['
-00001d10: 795f 7472 6169 6e27 5d3b 2067 632e 636f  y_train']; gc.co
-00001d20: 6c6c 6563 7428 290a 2020 2020 2020 2020  llect().        
-00001d30: 2020 2020 6966 2027 585f 7661 6c69 6427      if 'X_valid'
-00001d40: 2069 6e20 5879 5f64 6963 742e 6b65 7973   in Xy_dict.keys
-00001d50: 2829 2061 6e64 2027 795f 7661 6c69 6427  () and 'y_valid'
-00001d60: 2069 6e20 5879 5f64 6963 742e 6b65 7973   in Xy_dict.keys
-00001d70: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00001d80: 2020 2020 6465 6c20 5879 5f64 6963 745b      del Xy_dict[
-00001d90: 2758 5f76 616c 6964 275d 2c20 5879 5f64  'X_valid'], Xy_d
-00001da0: 6963 745b 2779 5f76 616c 6964 275d 3b20  ict['y_valid']; 
-00001db0: 6763 2e63 6f6c 6c65 6374 2829 0a20 2020  gc.collect().   
-00001dc0: 2020 2020 2020 2020 2064 656c 2058 795f           del Xy_
-00001dd0: 6469 6374 3b20 6763 2e63 6f6c 6c65 6374  dict; gc.collect
-00001de0: 2829 0a0a 2020 2020 2020 2020 2320 7072  ()..        # pr
-00001df0: 6520 666f 7220 790a 2020 2020 2020 2020  e for y.        
-00001e00: 6966 2073 656c 662e 665f 6c61 6265 6c20  if self.f_label 
-00001e10: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00001e20: 2020 2020 2020 2020 2079 5f74 7261 696e           y_train
-00001e30: 203d 206e 705f 636c 6970 5f6d 696e 5f6d   = np_clip_min_m
-00001e40: 6178 5f69 6e70 6c61 6365 2879 5f74 7261  ax_inplace(y_tra
-00001e50: 696e 2c20 2d31 302e 302c 2031 302e 3029  in, -10.0, 10.0)
-00001e60: 0a20 2020 2020 2020 2020 2020 2079 5f74  .            y_t
-00001e70: 7261 696e 203d 206e 702e 6c6f 6731 7028  rain = np.log1p(
-00001e80: 6e70 2e6c 6f67 3170 2879 5f74 7261 696e  np.log1p(y_train
-00001e90: 202b 2031 302e 3029 2920 2020 200a 0a20   + 10.0))    .. 
-00001ea0: 2020 2020 2020 2023 2064 7472 6169 6e0a         # dtrain.
-00001eb0: 2020 2020 2020 2020 6966 2073 686f 775f          if show_
-00001ec0: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
-00001ed0: 2020 7072 696e 7428 6627 5b2b 5d20 585f    print(f'[+] X_
-00001ee0: 7472 6169 6e2e 7368 6170 6520 3d20 7b58  train.shape = {X
-00001ef0: 5f74 7261 696e 2e73 6861 7065 7d27 2c20  _train.shape}', 
-00001f00: 666c 7573 683d 5472 7565 293b 2073 7973  flush=True); sys
-00001f10: 2e73 7464 6f75 742e 666c 7573 6828 290a  .stdout.flush().
-00001f20: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00001f30: 7428 6627 5b2b 5d20 585f 7661 6c69 642e  t(f'[+] X_valid.
-00001f40: 7368 6170 6520 3d20 7b58 5f76 616c 6964  shape = {X_valid
-00001f50: 2e73 6861 7065 7d27 2c20 666c 7573 683d  .shape}', flush=
-00001f60: 5472 7565 293b 2073 7973 2e73 7464 6f75  True); sys.stdou
-00001f70: 742e 666c 7573 6828 290a 2020 2020 2020  t.flush().      
-00001f80: 2020 2020 2020 7072 696e 7428 6627 5b2b        print(f'[+
-00001f90: 5d20 6474 7261 696e 2062 6566 6f72 6527  ] dtrain before'
-00001fa0: 293b 2067 6574 5f6d 656d 5f63 7572 2829  ); get_mem_cur()
-00001fb0: 2c20 6765 745f 6d65 6d5f 6d61 7828 290a  , get_mem_max().
-00001fc0: 2020 2020 2020 2020 6474 7261 696e 203d          dtrain =
-00001fd0: 206c 6762 2e44 6174 6173 6574 2858 5f74   lgb.Dataset(X_t
-00001fe0: 7261 696e 2c20 795f 7472 6169 6e29 0a20  rain, y_train). 
-00001ff0: 2020 2020 2020 2064 7661 6c69 6420 3d20         dvalid = 
-00002000: 6c67 622e 4461 7461 7365 7428 585f 7661  lgb.Dataset(X_va
-00002010: 6c69 642c 2079 5f76 616c 6964 290a 2020  lid, y_valid).  
-00002020: 2020 2020 2020 6966 2073 686f 775f 696e        if show_in
-00002030: 666f 3a20 7072 696e 7428 275b 2b5d 2064  fo: print('[+] d
-00002040: 7472 6169 6e20 6166 7465 7227 293b 2067  train after'); g
-00002050: 6574 5f6d 656d 5f63 7572 2829 2c20 6765  et_mem_cur(), ge
-00002060: 745f 6d65 6d5f 6d61 7828 290a 2020 2020  t_mem_max().    
-00002070: 2020 2020 6465 6c20 585f 7472 6169 6e2c      del X_train,
-00002080: 2079 5f74 7261 696e 2c20 585f 7661 6c69   y_train, X_vali
-00002090: 642c 2079 5f76 616c 6964 3b20 6763 2e63  d, y_valid; gc.c
-000020a0: 6f6c 6c65 6374 2829 0a20 2020 2020 2020  ollect().       
-000020b0: 200a 2020 2020 2020 2020 2320 7472 6169   .        # trai
-000020c0: 6e0a 2020 2020 2020 2020 666f 626a 5f73  n.        fobj_s
-000020d0: 7472 203d 206b 7761 7267 732e 6765 7428  tr = kwargs.get(
-000020e0: 2766 6f62 6a27 2c20 4e6f 6e65 290a 2020  'fobj', None).  
-000020f0: 2020 2020 2020 6966 2066 6f62 6a5f 7374        if fobj_st
-00002100: 7220 6973 204e 6f6e 653a 0a20 2020 2020  r is None:.     
-00002110: 2020 2020 2020 206d 6f64 656c 203d 206c         model = l
-00002120: 6762 2e74 7261 696e 280a 2020 2020 2020  gb.train(.      
-00002130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002140: 2020 7061 7261 6d73 2c20 0a20 2020 2020    params, .     
-00002150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002160: 2020 2064 7472 6169 6e2c 200a 2020 2020     dtrain, .    
+00000840: 203d 2027 6c6f 6731 7027 2c20 636c 6970   = 'log1p', clip
+00000850: 203d 2031 3029 3a0a 2020 2020 2020 2020   = 10):.        
+00000860: 5c27 5c27 5c27 0a20 2020 2020 2020 2062  \'\'\'.        b
+00000870: 6f6f 7374 5f6c 6973 742c 2079 5f70 7265  oost_list, y_pre
+00000880: 645f 626f 6f73 7420 3d20 6d6f 6465 6c5f  d_boost = model_
+00000890: 7072 6564 6963 7428 6d6f 6465 6c2c 2058  predict(model, X
+000008a0: 2c20 6b20 3d20 3530 2c20 6e5f 6a6f 6273  , k = 50, n_jobs
+000008b0: 203d 2034 290a 0a20 2020 2020 2020 2064   = 4)..        d
+000008c0: 6566 206d 6f64 656c 5f70 7265 6469 6374  ef model_predict
+000008d0: 286d 6f64 656c 2c20 585f 7465 7374 2c20  (model, X_test, 
+000008e0: 6e20 3d20 3939 3939 3939 2c20 6b20 3d20  n = 999999, k = 
+000008f0: 3939 3939 3939 2c20 6e5f 6a6f 6273 203d  999999, n_jobs =
+00000900: 2033 3229 3a0a 2020 2020 2020 2020 2020   32):.          
+00000910: 2020 6d6f 6465 6c20 3d20 6d6f 6465 6c20    model = model 
+00000920: 6966 2074 7970 6528 6d6f 6465 6c29 2069  if type(model) i
+00000930: 7320 6c67 622e 6261 7369 632e 426f 6f73  s lgb.basic.Boos
+00000940: 7465 7220 656c 7365 206d 6f64 656c 2e6d  ter else model.m
+00000950: 6f64 656c 0a20 2020 2020 2020 2020 2020  odel.           
+00000960: 206e 203d 206d 696e 286e 2c20 6d6f 6465   n = min(n, mode
+00000970: 6c2e 6e75 6d5f 7472 6565 7328 2929 0a20  l.num_trees()). 
+00000980: 2020 2020 2020 2020 2020 2062 6f6f 7374             boost
+00000990: 5f6c 6973 7420 3d20 5b6d 696e 286e 2c20  _list = [min(n, 
+000009a0: 7820 2b20 6b29 2066 6f72 2078 2069 6e20  x + k) for x in 
+000009b0: 7261 6e67 6528 302c 206e 2c20 6b29 5d0a  range(0, n, k)].
+000009c0: 2020 2020 2020 2020 2020 2020 7973 203d              ys =
+000009d0: 205b 6d6f 6465 6c2e 7072 6564 6963 7428   [model.predict(
+000009e0: 585f 7465 7374 2c20 7374 6172 745f 6974  X_test, start_it
+000009f0: 6572 6174 696f 6e20 3d20 692c 206e 756d  eration = i, num
+00000a00: 5f69 7465 7261 7469 6f6e 203d 206d 696e  _iteration = min
+00000a10: 286b 2c20 6e20 2d20 6929 2c20 0a20 2020  (k, n - i), .   
+00000a20: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
+00000a30: 6f62 7320 3d20 6e5f 6a6f 6273 2920 666f  obs = n_jobs) fo
+00000a40: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
+00000a50: 6e2c 206b 295d 0a20 2020 2020 2020 2020  n, k)].         
+00000a60: 2020 2079 5f70 7265 645f 626f 6f73 7420     y_pred_boost 
+00000a70: 3d20 6e70 2e63 756d 7375 6d28 7973 2c20  = np.cumsum(ys, 
+00000a80: 6178 6973 203d 2030 290a 2020 2020 2020  axis = 0).      
+00000a90: 2020 2020 2020 7265 7475 726e 2062 6f6f        return boo
+00000aa0: 7374 5f6c 6973 742c 2079 5f70 7265 645f  st_list, y_pred_
+00000ab0: 626f 6f73 740a 2020 2020 2020 2020 5c27  boost.        \'
+00000ac0: 5c27 5c27 0a20 2020 2020 2020 206d 6f64  \'\'.        mod
+00000ad0: 656c 203d 206d 6f64 656c 2069 6620 7479  el = model if ty
+00000ae0: 7065 286d 6f64 656c 2920 6973 206c 6762  pe(model) is lgb
+00000af0: 2e62 6173 6963 2e42 6f6f 7374 6572 2065  .basic.Booster e
+00000b00: 6c73 6520 6d6f 6465 6c2e 6d6f 6465 6c0a  lse model.model.
+00000b10: 2020 2020 2020 2020 6e20 3d20 6d69 6e28          n = min(
+00000b20: 6e2c 206d 6f64 656c 2e6e 756d 5f74 7265  n, model.num_tre
+00000b30: 6573 2829 290a 2020 2020 2020 2020 626f  es()).        bo
+00000b40: 6f73 745f 6c69 7374 203d 205b 6d69 6e28  ost_list = [min(
+00000b50: 6e2c 2078 202b 206b 2920 666f 7220 7820  n, x + k) for x 
+00000b60: 696e 2072 616e 6765 2830 2c20 6e2c 206b  in range(0, n, k
+00000b70: 295d 0a20 2020 2020 2020 2079 7320 3d20  )].        ys = 
+00000b80: 5b6d 6f64 656c 2e70 7265 6469 6374 2858  [model.predict(X
+00000b90: 5f74 6573 742c 2073 7461 7274 5f69 7465  _test, start_ite
+00000ba0: 7261 7469 6f6e 203d 2069 2c20 6e75 6d5f  ration = i, num_
+00000bb0: 6974 6572 6174 696f 6e20 3d20 6d69 6e28  iteration = min(
+00000bc0: 6b2c 206e 202d 2069 292c 200a 2020 2020  k, n - i), .    
+00000bd0: 2020 2020 2020 2020 6e5f 6a6f 6273 203d          n_jobs =
+00000be0: 206e 5f6a 6f62 7329 2066 6f72 2069 2069   n_jobs) for i i
+00000bf0: 6e20 7261 6e67 6528 302c 206e 2c20 6b29  n range(0, n, k)
+00000c00: 5d0a 2020 2020 2020 2020 795f 7072 6564  ].        y_pred
+00000c10: 5f62 6f6f 7374 203d 206e 702e 6375 6d73  _boost = np.cums
+00000c20: 756d 2879 732c 2061 7869 7320 3d20 3029  um(ys, axis = 0)
+00000c30: 0a20 2020 2020 2020 2069 6620 665f 6c61  .        if f_la
+00000c40: 6265 6c20 6973 206e 6f74 204e 6f6e 653a  bel is not None:
+00000c50: 2079 5f70 7265 645f 626f 6f73 7420 3d20   y_pred_boost = 
+00000c60: 6e70 2e65 7870 6d31 286e 702e 6578 706d  np.expm1(np.expm
+00000c70: 3128 795f 7072 6564 5f62 6f6f 7374 2929  1(y_pred_boost))
+00000c80: 202d 2063 6c69 700a 2020 2020 2020 2020   - clip.        
+00000c90: 7265 7475 726e 2062 6f6f 7374 5f6c 6973  return boost_lis
+00000ca0: 742c 2079 5f70 7265 645f 626f 6f73 740a  t, y_pred_boost.
+00000cb0: 0a20 2020 2064 6566 2067 6574 5f70 6172  .    def get_par
+00000cc0: 616d 7328 7061 7261 6d73 5f69 6429 3a0a  ams(params_id):.
+00000cd0: 2020 2020 2020 2020 6966 2070 6172 616d          if param
+00000ce0: 735f 6964 2069 6e20 5b27 7061 7261 6d73  s_id in ['params
+00000cf0: 5f31 275d 3a0a 2020 2020 2020 2020 2020  _1']:.          
+00000d00: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00000d10: 2020 2020 2020 2020 2020 2020 2027 7365               'se
+00000d20: 6564 273a 2037 3737 2c0a 2020 2020 2020  ed': 777,.      
+00000d30: 2020 2020 2020 2020 2020 276f 626a 6563            'objec
+00000d40: 7469 7665 273a 2027 7265 6772 6573 7369  tive': 'regressi
+00000d50: 6f6e 272c 0a20 2020 2020 2020 2020 2020  on',.           
+00000d60: 2020 2020 2027 6d65 7472 6963 273a 2027       'metric': '
+00000d70: 726d 7365 272c 0a20 2020 2020 2020 2020  rmse',.         
+00000d80: 2020 2020 2020 2022 6e5f 6a6f 6273 223a         "n_jobs":
+00000d90: 2036 332c 0a20 2020 2020 2020 2020 2020   63,.           
+00000da0: 2020 2020 2027 7665 7262 6f73 6974 7927       'verbosity'
+00000db0: 3a20 2d31 2c0a 2020 2020 2020 2020 2020  : -1,.          
+00000dc0: 2020 2020 2020 276c 6561 726e 696e 675f        'learning_
+00000dd0: 7261 7465 273a 2030 2e30 312c 0a20 2020  rate': 0.01,.   
+00000de0: 2020 2020 2020 2020 2020 2020 2027 6e75               'nu
+00000df0: 6d5f 6c65 6176 6573 273a 2032 3535 2c0a  m_leaves': 255,.
+00000e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000e10: 276d 6178 5f64 6570 7468 273a 202d 312c  'max_depth': -1,
+00000e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000e30: 2027 6665 6174 7572 655f 6672 6163 7469   'feature_fracti
+00000e40: 6f6e 273a 2030 2e35 2c0a 2020 2020 2020  on': 0.5,.      
+00000e50: 2020 2020 2020 2020 2020 2762 6167 6769            'baggi
+00000e60: 6e67 5f66 7261 6374 696f 6e27 3a20 302e  ng_fraction': 0.
+00000e70: 352c 0a20 2020 2020 2020 2020 2020 207d  5,.            }
+00000e80: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00000e90: 616d 735b 276e 5f65 7374 696d 6174 6f72  ams['n_estimator
+00000ea0: 7327 5d20 3d20 3135 3030 0a20 2020 2020  s'] = 1500.     
+00000eb0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00000ec0: 656c 6966 2070 6172 616d 735f 6964 2069  elif params_id i
+00000ed0: 6e20 5b27 7061 7261 6d73 5f65 7874 7261  n ['params_extra
+00000ee0: 272c 2027 7061 7261 6d73 5f66 6173 7427  ', 'params_fast'
+00000ef0: 5d3a 0a20 2020 2020 2020 2020 2020 2070  ]:.            p
+00000f00: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+00000f10: 2020 2020 2020 2020 2020 2773 6565 6427            'seed'
+00000f20: 3a20 3737 372c 0a20 2020 2020 2020 2020  : 777,.         
+00000f30: 2020 2020 2020 2027 6f62 6a65 6374 6976         'objectiv
+00000f40: 6527 3a20 2772 6567 7265 7373 696f 6e27  e': 'regression'
+00000f50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00000f60: 2020 276d 6574 7269 6327 3a20 2772 6d73    'metric': 'rms
+00000f70: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+00000f80: 2020 2020 226e 5f6a 6f62 7322 3a20 3633      "n_jobs": 63
+00000f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00000fa0: 2020 2776 6572 626f 7369 7479 273a 202d    'verbosity': -
+00000fb0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+00000fc0: 2020 2027 6c65 6172 6e69 6e67 5f72 6174     'learning_rat
+00000fd0: 6527 3a20 302e 3031 2c0a 2020 2020 2020  e': 0.01,.      
+00000fe0: 2020 2020 2020 2020 2020 276e 756d 5f6c            'num_l
+00000ff0: 6561 7665 7327 3a20 3235 352c 0a20 2020  eaves': 255,.   
+00001000: 2020 2020 2020 2020 2020 2020 2027 6d61               'ma
+00001010: 785f 6465 7074 6827 3a20 2d31 2c0a 2020  x_depth': -1,.  
+00001020: 2020 2020 2020 2020 2020 2020 2020 2766                'f
+00001030: 6561 7475 7265 5f66 7261 6374 696f 6e27  eature_fraction'
+00001040: 3a20 302e 352c 0a20 2020 2020 2020 2020  : 0.5,.         
+00001050: 2020 2020 2020 2027 6261 6767 696e 675f         'bagging_
+00001060: 6672 6163 7469 6f6e 273a 2030 2e35 2c0a  fraction': 0.5,.
+00001070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001080: 2765 7874 7261 5f74 7265 6573 273a 2054  'extra_trees': T
+00001090: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+000010a0: 207d 0a20 2020 2020 2020 2020 2020 2070   }.            p
+000010b0: 6172 616d 735b 276e 5f65 7374 696d 6174  arams['n_estimat
+000010c0: 6f72 7327 5d20 3d20 3135 3030 0a20 2020  ors'] = 1500.   
+000010d0: 2020 2020 2020 2020 2069 6620 7061 7261           if para
+000010e0: 6d73 5f69 6420 696e 205b 2770 6172 616d  ms_id in ['param
+000010f0: 735f 6661 7374 275d 3a0a 2020 2020 2020  s_fast']:.      
+00001100: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00001110: 5b27 6e5f 6573 7469 6d61 746f 7273 275d  ['n_estimators']
+00001120: 203d 2031 3030 0a0a 2020 2020 2020 2020   = 100..        
+00001130: 656c 6966 2070 6172 616d 735f 6964 2069  elif params_id i
+00001140: 6e20 5b27 7061 7261 6d73 5f32 275d 3a0a  n ['params_2']:.
+00001150: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00001160: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00001170: 2020 2020 2020 2027 7365 6564 273a 2037         'seed': 7
+00001180: 3737 2c0a 2020 2020 2020 2020 2020 2020  77,.            
+00001190: 2020 2020 276f 626a 6563 7469 7665 273a      'objective':
+000011a0: 2027 7265 6772 6573 7369 6f6e 272c 0a20   'regression',. 
+000011b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000011c0: 6d65 7472 6963 273a 2027 726d 7365 272c  metric': 'rmse',
+000011d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000011e0: 2022 6e5f 6a6f 6273 223a 2036 332c 0a20   "n_jobs": 63,. 
+000011f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00001200: 7665 7262 6f73 6974 7927 3a20 2d31 2c0a  verbosity': -1,.
+00001210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001220: 276c 6561 726e 696e 675f 7261 7465 273a  'learning_rate':
+00001230: 2030 2e30 312c 0a20 2020 2020 2020 2020   0.01,.         
+00001240: 2020 2020 2020 2027 6e75 6d5f 6c65 6176         'num_leav
+00001250: 6573 273a 2032 3034 382c 0a20 2020 2020  es': 2048,.     
+00001260: 2020 2020 2020 2020 2020 2027 6d61 785f             'max_
+00001270: 6465 7074 6827 3a20 2d31 2c0a 2020 2020  depth': -1,.    
+00001280: 2020 2020 2020 2020 2020 2020 2766 6561              'fea
+00001290: 7475 7265 5f66 7261 6374 696f 6e27 3a20  ture_fraction': 
+000012a0: 302e 3635 2c0a 2020 2020 2020 2020 2020  0.65,.          
+000012b0: 2020 2020 2020 2762 6167 6769 6e67 5f66        'bagging_f
+000012c0: 7261 6374 696f 6e27 3a20 302e 392c 0a20  raction': 0.9,. 
+000012d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000012e0: 6d69 6e5f 6368 696c 645f 7765 6967 6874  min_child_weight
+000012f0: 273a 2030 2e30 3033 2c0a 2020 2020 2020  ': 0.003,.      
+00001300: 2020 2020 2020 2020 2020 276d 696e 5f64            'min_d
+00001310: 6174 615f 696e 5f6c 6561 6627 3a20 3134  ata_in_leaf': 14
+00001320: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00001330: 2020 2027 7265 675f 616c 7068 6127 3a20     'reg_alpha': 
+00001340: 302e 382c 0a20 2020 2020 2020 2020 2020  0.8,.           
+00001350: 2020 2020 2027 7265 675f 6c61 6d62 6461       'reg_lambda
+00001360: 273a 2030 2e33 2c0a 2020 2020 2020 2020  ': 0.3,.        
+00001370: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00001380: 2020 7061 7261 6d73 5b27 6e5f 6573 7469    params['n_esti
+00001390: 6d61 746f 7273 275d 203d 2031 3530 300a  mators'] = 1500.
+000013a0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+000013b0: 2065 6c69 6620 7061 7261 6d73 5f69 6420   elif params_id 
+000013c0: 696e 205b 2770 6172 616d 735f 6164 7627  in ['params_adv'
+000013d0: 5d3a 0a20 2020 2020 2020 2020 2020 2070  ]:.            p
+000013e0: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+000013f0: 2020 2020 2020 2020 2020 2773 6565 6427            'seed'
+00001400: 3a20 3737 372c 0a20 2020 2020 2020 2020  : 777,.         
+00001410: 2020 2020 2020 2027 6f62 6a65 6374 6976         'objectiv
+00001420: 6527 3a20 2762 696e 6172 7927 2c0a 2020  e': 'binary',.  
+00001430: 2020 2020 2020 2020 2020 2020 2020 276d                'm
+00001440: 6574 7269 6327 3a20 2761 7563 272c 0a20  etric': 'auc',. 
+00001450: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00001460: 6e5f 6a6f 6273 223a 2036 332c 0a20 2020  n_jobs": 63,.   
+00001470: 2020 2020 2020 2020 2020 2020 2027 7665               've
+00001480: 7262 6f73 6974 7927 3a20 2d31 2c0a 2020  rbosity': -1,.  
+00001490: 2020 2020 2020 2020 2020 2020 2020 276c                'l
+000014a0: 6561 726e 696e 675f 7261 7465 273a 2030  earning_rate': 0
+000014b0: 2e30 312c 0a20 2020 2020 2020 2020 2020  .01,.           
+000014c0: 2020 2020 2027 6e75 6d5f 6c65 6176 6573       'num_leaves
+000014d0: 273a 2032 3535 2c0a 2020 2020 2020 2020  ': 255,.        
+000014e0: 2020 2020 2020 2020 276d 6178 5f64 6570          'max_dep
+000014f0: 7468 273a 202d 312c 0a20 2020 2020 2020  th': -1,.       
+00001500: 2020 2020 2020 2020 2027 6665 6174 7572           'featur
+00001510: 655f 6672 6163 7469 6f6e 273a 2030 2e35  e_fraction': 0.5
+00001520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001530: 2020 2762 6167 6769 6e67 5f66 7261 6374    'bagging_fract
+00001540: 696f 6e27 3a20 302e 352c 0a20 2020 2020  ion': 0.5,.     
+00001550: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00001560: 2020 2020 2070 6172 616d 735b 276e 5f65       params['n_e
+00001570: 7374 696d 6174 6f72 7327 5d20 3d20 3130  stimators'] = 10
+00001580: 300a 2020 2020 2020 2020 656c 7365 3a0a  0.        else:.
+00001590: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000015a0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+000015b0: 4572 726f 7228 6627 5b2b 5d20 7061 7261  Error(f'[+] para
+000015c0: 6d73 5f69 6420 3d20 7b70 6172 616d 735f  ms_id = {params_
+000015d0: 6964 7d27 290a 2020 2020 2020 2020 7265  id}').        re
+000015e0: 7475 726e 2070 6172 616d 730a 0a20 2020  turn params..   
+000015f0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00001600: 6c66 2c20 6d6f 6465 6c5f 6e61 6d65 203d  lf, model_name =
+00001610: 204e 6f6e 652c 2066 5f6c 6162 656c 203d   None, f_label =
+00001620: 2027 6c6f 6731 7027 2c20 636c 6970 203d   'log1p', clip =
+00001630: 2031 3029 3a0a 2020 2020 2020 2020 7375   10):.        su
+00001640: 7065 7228 292e 5f5f 696e 6974 5f5f 286d  per().__init__(m
+00001650: 6f64 656c 5f6e 616d 6529 0a20 2020 2020  odel_name).     
+00001660: 2020 2073 656c 662e 665f 6c61 6265 6c20     self.f_label 
+00001670: 3d20 665f 6c61 6265 6c0a 2020 2020 2020  = f_label.      
+00001680: 2020 7365 6c66 2e63 6c69 7020 3d20 636c    self.clip = cl
+00001690: 6970 0a0a 2020 2020 6465 6620 7472 6169  ip..    def trai
+000016a0: 6e28 7365 6c66 2c20 5879 5f64 6963 742c  n(self, Xy_dict,
+000016b0: 2070 6172 616d 7320 3d20 4e6f 6e65 2c20   params = None, 
+000016c0: 6b77 6172 6773 203d 204e 6f6e 6529 3a0a  kwargs = None):.
+000016d0: 2020 2020 2020 2020 5c27 5c27 5c27 0a20          \'\'\'. 
+000016e0: 2020 2020 2020 2066 726f 6d20 7275 6e6e         from runn
+000016f0: 696e 677a 2e6d 6f64 656c 2069 6d70 6f72  ingz.model impor
+00001700: 7420 4c47 424d 6f64 656c 0a20 2020 2020  t LGBModel.     
+00001710: 2020 206d 6f64 656c 203d 204c 4742 4d6f     model = LGBMo
+00001720: 6465 6c28 290a 2020 2020 2020 2020 7061  del().        pa
+00001730: 7261 6d73 203d 2072 7a2e 6f70 742e 6f70  rams = rz.opt.op
+00001740: 745f 7261 6e64 6f6d 2e67 6574 5f70 6172  t_random.get_par
+00001750: 616d 735f 6c67 6228 290a 2020 2020 2020  ams_lgb().      
+00001760: 2020 2320 7061 7261 6d73 203d 204c 4742    # params = LGB
+00001770: 4d6f 6465 6c2e 6765 745f 7061 7261 6d73  Model.get_params
+00001780: 2827 7061 7261 6d73 5f31 2729 0a20 2020  ('params_1').   
+00001790: 2020 2020 200a 2020 2020 2020 2020 5879       .        Xy
+000017a0: 5f64 6963 7420 3d20 7b27 585f 7472 6169  _dict = {'X_trai
+000017b0: 6e27 3a20 585f 7472 6169 6e2c 2027 795f  n': X_train, 'y_
+000017c0: 7472 6169 6e27 3a20 795f 7472 6169 6e7d  train': y_train}
+000017d0: 0a20 2020 2020 2020 2023 2064 656c 2058  .        # del X
+000017e0: 5f74 7261 696e 2c20 795f 7472 6169 6e3b  _train, y_train;
+000017f0: 2067 632e 636f 6c6c 6563 7428 290a 2020   gc.collect().  
+00001800: 2020 2020 2020 6d6f 6465 6c2e 7472 6169        model.trai
+00001810: 6e28 7b27 585f 7472 6169 6e27 3a20 585f  n({'X_train': X_
+00001820: 7472 6169 6e2c 2027 795f 7472 6169 6e27  train, 'y_train'
+00001830: 3a20 795f 7472 6169 6e7d 2c20 7061 7261  : y_train}, para
+00001840: 6d73 203d 2070 6172 616d 732c 206b 7761  ms = params, kwa
+00001850: 7267 733d 7b27 6672 6565 5879 273a 2046  rgs={'freeXy': F
+00001860: 616c 7365 2c20 2776 6572 626f 7365 273a  alse, 'verbose':
+00001870: 2035 307d 290a 2020 2020 2020 2020 5c27   50}).        \'
+00001880: 5c27 5c27 0a20 2020 2020 2020 200a 2020  \'\'.        .  
+00001890: 2020 2020 2020 2320 7061 7261 6d73 0a20        # params. 
+000018a0: 2020 2020 2020 2070 6172 616d 735f 6964         params_id
+000018b0: 203d 206b 7761 7267 732e 6765 7428 2770   = kwargs.get('p
+000018c0: 6172 616d 735f 6964 272c 204e 6f6e 6529  arams_id', None)
+000018d0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000018e0: 7061 7261 6d73 2069 7320 6e6f 7420 4e6f  params is not No
+000018f0: 6e65 206f 7220 7061 7261 6d73 5f69 6420  ne or params_id 
+00001900: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00001910: 2020 2020 6966 2070 6172 616d 735f 6964      if params_id
+00001920: 2069 7320 6e6f 7420 4e6f 6e65 3a20 7061   is not None: pa
+00001930: 7261 6d73 203d 204c 4742 4d6f 6465 6c2e  rams = LGBModel.
+00001940: 6765 745f 7061 7261 6d73 2870 6172 616d  get_params(param
+00001950: 735f 6964 290a 2020 2020 2020 2020 6e5f  s_id).        n_
+00001960: 626f 6f73 7420 3d20 6b77 6172 6773 2e67  boost = kwargs.g
+00001970: 6574 2827 6e5f 626f 6f73 7427 2c20 7061  et('n_boost', pa
+00001980: 7261 6d73 5b27 6e5f 6573 7469 6d61 746f  rams['n_estimato
+00001990: 7273 275d 290a 2020 2020 2020 2020 6b77  rs']).        kw
+000019a0: 6172 6773 5b27 6e5f 626f 6f73 7427 5d20  args['n_boost'] 
+000019b0: 3d20 6e5f 626f 6f73 740a 2020 2020 2020  = n_boost.      
+000019c0: 2020 7061 7261 6d73 5b27 6e5f 6573 7469    params['n_esti
+000019d0: 6d61 746f 7273 275d 203d 206e 5f62 6f6f  mators'] = n_boo
+000019e0: 7374 0a20 2020 2020 2020 2023 2064 656c  st.        # del
+000019f0: 2070 6172 616d 735b 276e 5f65 7374 696d   params['n_estim
+00001a00: 6174 6f72 7327 5d0a 2020 2020 2020 2020  ators'].        
+00001a10: 6b77 6172 6773 5b27 6d6f 6465 6c5f 6e61  kwargs['model_na
+00001a20: 6d65 275d 203d 2073 656c 662e 6d6f 6465  me'] = self.mode
+00001a30: 6c5f 6e61 6d65 0a20 2020 2020 2020 2073  l_name.        s
+00001a40: 656c 662e 7061 7261 6d73 2c20 7365 6c66  elf.params, self
+00001a50: 2e6b 7761 7267 7320 3d20 7061 7261 6d73  .kwargs = params
+00001a60: 2c20 6b77 6172 6773 0a20 2020 2020 2020  , kwargs.       
+00001a70: 200a 2020 2020 2020 2020 2320 6b77 6167   .        # kwag
+00001a80: 7273 0a20 2020 2020 2020 2076 6572 626f  rs.        verbo
+00001a90: 7365 203d 206b 7761 7267 732e 6765 7428  se = kwargs.get(
+00001aa0: 2776 6572 626f 7365 272c 2031 3030 290a  'verbose', 100).
+00001ab0: 2020 2020 2020 2020 7368 6f77 5f69 6e66          show_inf
+00001ac0: 6f20 3d20 6b77 6172 6773 2e67 6574 2827  o = kwargs.get('
+00001ad0: 7368 6f77 5f69 6e66 6f27 2c20 4661 6c73  show_info', Fals
+00001ae0: 6529 0a20 2020 2020 2020 2069 6620 7368  e).        if sh
+00001af0: 6f77 5f69 6e66 6f3a 0a20 2020 2020 2020  ow_info:.       
+00001b00: 2020 2020 2070 7269 6e74 2866 275b 2b5d       print(f'[+]
+00001b10: 206b 7761 7267 7320 3d20 7b6b 7761 7267   kwargs = {kwarg
+00001b20: 737d 272c 2066 6c75 7368 3d54 7275 6529  s}', flush=True)
+00001b30: 3b20 7379 732e 7374 646f 7574 2e66 6c75  ; sys.stdout.flu
+00001b40: 7368 2829 0a20 2020 2020 2020 2020 2020  sh().           
+00001b50: 2070 7269 6e74 2866 275b 2b5d 2070 6172   print(f'[+] par
+00001b60: 616d 7320 3d20 7b70 6172 616d 737d 272c  ams = {params}',
+00001b70: 2066 6c75 7368 3d54 7275 6529 3b20 7379   flush=True); sy
+00001b80: 732e 7374 646f 7574 2e66 6c75 7368 2829  s.stdout.flush()
+00001b90: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00001ba0: 2020 2320 585f 7472 6169 6e0a 2020 2020    # X_train.    
+00001bb0: 2020 2020 585f 7472 6169 6e2c 2079 5f74      X_train, y_t
+00001bc0: 7261 696e 203d 2058 795f 6469 6374 5b27  rain = Xy_dict['
+00001bd0: 585f 7472 6169 6e27 5d2c 2058 795f 6469  X_train'], Xy_di
+00001be0: 6374 5b27 795f 7472 6169 6e27 5d0a 2020  ct['y_train'].  
+00001bf0: 2020 2020 2020 6966 2027 585f 7661 6c69        if 'X_vali
+00001c00: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
+00001c10: 7973 2829 2061 6e64 2027 585f 7661 6c69  ys() and 'X_vali
+00001c20: 6427 2069 6e20 5879 5f64 6963 742e 6b65  d' in Xy_dict.ke
+00001c30: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00001c40: 2020 585f 7661 6c69 642c 2079 5f76 616c    X_valid, y_val
+00001c50: 6964 203d 2058 795f 6469 6374 5b27 585f  id = Xy_dict['X_
+00001c60: 7661 6c69 6427 5d2c 2058 795f 6469 6374  valid'], Xy_dict
+00001c70: 5b27 795f 7661 6c69 6427 5d0a 2020 2020  ['y_valid'].    
+00001c80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00001c90: 2020 2020 2020 585f 7661 6c69 642c 2079        X_valid, y
+00001ca0: 5f76 616c 6964 203d 2058 795f 6469 6374  _valid = Xy_dict
+00001cb0: 5b27 585f 7472 6169 6e27 5d5b 2d31 303a  ['X_train'][-10:
+00001cc0: 5d2e 636f 7079 2829 2c20 5879 5f64 6963  ].copy(), Xy_dic
+00001cd0: 745b 2779 5f74 7261 696e 275d 5b2d 3130  t['y_train'][-10
+00001ce0: 3a5d 2e63 6f70 7928 290a 2020 2020 2020  :].copy().      
+00001cf0: 2020 6966 206b 7761 7267 732e 6765 7428    if kwargs.get(
+00001d00: 2766 7265 655f 5879 272c 2054 7275 6529  'free_Xy', True)
+00001d10: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+00001d20: 6c20 5879 5f64 6963 745b 2758 5f74 7261  l Xy_dict['X_tra
+00001d30: 696e 275d 2c20 5879 5f64 6963 745b 2779  in'], Xy_dict['y
+00001d40: 5f74 7261 696e 275d 3b20 6763 2e63 6f6c  _train']; gc.col
+00001d50: 6c65 6374 2829 0a20 2020 2020 2020 2020  lect().         
+00001d60: 2020 2069 6620 2758 5f76 616c 6964 2720     if 'X_valid' 
+00001d70: 696e 2058 795f 6469 6374 2e6b 6579 7328  in Xy_dict.keys(
+00001d80: 2920 616e 6420 2779 5f76 616c 6964 2720  ) and 'y_valid' 
+00001d90: 696e 2058 795f 6469 6374 2e6b 6579 7328  in Xy_dict.keys(
+00001da0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00001db0: 2020 2064 656c 2058 795f 6469 6374 5b27     del Xy_dict['
+00001dc0: 585f 7661 6c69 6427 5d2c 2058 795f 6469  X_valid'], Xy_di
+00001dd0: 6374 5b27 795f 7661 6c69 6427 5d3b 2067  ct['y_valid']; g
+00001de0: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
+00001df0: 2020 2020 2020 2020 6465 6c20 5879 5f64          del Xy_d
+00001e00: 6963 743b 2067 632e 636f 6c6c 6563 7428  ict; gc.collect(
+00001e10: 290a 0a20 2020 2020 2020 2023 2070 7265  )..        # pre
+00001e20: 2066 6f72 2079 0a20 2020 2020 2020 2069   for y.        i
+00001e30: 6620 7365 6c66 2e66 5f6c 6162 656c 2069  f self.f_label i
+00001e40: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00001e50: 2020 2020 2020 2020 795f 7472 6169 6e20          y_train 
+00001e60: 3d20 6e70 5f63 6c69 705f 6d69 6e5f 6d61  = np_clip_min_ma
+00001e70: 785f 696e 706c 6163 6528 795f 7472 6169  x_inplace(y_trai
+00001e80: 6e2c 202d 3120 2a20 7365 6c66 2e63 6c69  n, -1 * self.cli
+00001e90: 702c 2073 656c 662e 636c 6970 290a 2020  p, self.clip).  
+00001ea0: 2020 2020 2020 2020 2020 795f 7472 6169            y_trai
+00001eb0: 6e20 3d20 6e70 2e6c 6f67 3170 286e 702e  n = np.log1p(np.
+00001ec0: 6c6f 6731 7028 795f 7472 6169 6e20 2b20  log1p(y_train + 
+00001ed0: 7365 6c66 2e63 6c69 7029 2920 2020 200a  self.clip))    .
+00001ee0: 0a20 2020 2020 2020 2023 2064 7472 6169  .        # dtrai
+00001ef0: 6e0a 2020 2020 2020 2020 6966 2073 686f  n.        if sho
+00001f00: 775f 696e 666f 3a0a 2020 2020 2020 2020  w_info:.        
+00001f10: 2020 2020 7072 696e 7428 6627 5b2b 5d20      print(f'[+] 
+00001f20: 585f 7472 6169 6e2e 7368 6170 6520 3d20  X_train.shape = 
+00001f30: 7b58 5f74 7261 696e 2e73 6861 7065 7d27  {X_train.shape}'
+00001f40: 2c20 666c 7573 683d 5472 7565 293b 2073  , flush=True); s
+00001f50: 7973 2e73 7464 6f75 742e 666c 7573 6828  ys.stdout.flush(
+00001f60: 290a 2020 2020 2020 2020 2020 2020 7072  ).            pr
+00001f70: 696e 7428 6627 5b2b 5d20 585f 7661 6c69  int(f'[+] X_vali
+00001f80: 642e 7368 6170 6520 3d20 7b58 5f76 616c  d.shape = {X_val
+00001f90: 6964 2e73 6861 7065 7d27 2c20 666c 7573  id.shape}', flus
+00001fa0: 683d 5472 7565 293b 2073 7973 2e73 7464  h=True); sys.std
+00001fb0: 6f75 742e 666c 7573 6828 290a 2020 2020  out.flush().    
+00001fc0: 2020 2020 2020 2020 7072 696e 7428 6627          print(f'
+00001fd0: 5b2b 5d20 6474 7261 696e 2062 6566 6f72  [+] dtrain befor
+00001fe0: 6527 293b 2067 6574 5f6d 656d 5f63 7572  e'); get_mem_cur
+00001ff0: 2829 2c20 6765 745f 6d65 6d5f 6d61 7828  (), get_mem_max(
+00002000: 290a 2020 2020 2020 2020 6474 7261 696e  ).        dtrain
+00002010: 203d 206c 6762 2e44 6174 6173 6574 2858   = lgb.Dataset(X
+00002020: 5f74 7261 696e 2c20 795f 7472 6169 6e29  _train, y_train)
+00002030: 0a20 2020 2020 2020 2064 7661 6c69 6420  .        dvalid 
+00002040: 3d20 6c67 622e 4461 7461 7365 7428 585f  = lgb.Dataset(X_
+00002050: 7661 6c69 642c 2079 5f76 616c 6964 290a  valid, y_valid).
+00002060: 2020 2020 2020 2020 6966 2073 686f 775f          if show_
+00002070: 696e 666f 3a20 7072 696e 7428 275b 2b5d  info: print('[+]
+00002080: 2064 7472 6169 6e20 6166 7465 7227 293b   dtrain after');
+00002090: 2067 6574 5f6d 656d 5f63 7572 2829 2c20   get_mem_cur(), 
+000020a0: 6765 745f 6d65 6d5f 6d61 7828 290a 2020  get_mem_max().  
+000020b0: 2020 2020 2020 6465 6c20 585f 7472 6169        del X_trai
+000020c0: 6e2c 2079 5f74 7261 696e 2c20 585f 7661  n, y_train, X_va
+000020d0: 6c69 642c 2079 5f76 616c 6964 3b20 6763  lid, y_valid; gc
+000020e0: 2e63 6f6c 6c65 6374 2829 0a20 2020 2020  .collect().     
+000020f0: 2020 200a 2020 2020 2020 2020 2320 7472     .        # tr
+00002100: 6169 6e0a 2020 2020 2020 2020 666f 626a  ain.        fobj
+00002110: 5f73 7472 203d 206b 7761 7267 732e 6765  _str = kwargs.ge
+00002120: 7428 2766 6f62 6a27 2c20 4e6f 6e65 290a  t('fobj', None).
+00002130: 2020 2020 2020 2020 6966 2066 6f62 6a5f          if fobj_
+00002140: 7374 7220 6973 204e 6f6e 653a 0a20 2020  str is None:.   
+00002150: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+00002160: 206c 6762 2e74 7261 696e 280a 2020 2020   lgb.train(.    
 00002170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002180: 2020 2020 7661 6c69 645f 7365 7473 203d      valid_sets =
-00002190: 205b 6476 616c 6964 5d2c 200a 2020 2020   [dvalid], .    
-000021a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021b0: 2020 2020 6361 6c6c 6261 636b 7320 3d20      callbacks = 
-000021c0: 5b6c 6762 2e6c 6f67 5f65 7661 6c75 6174  [lgb.log_evaluat
-000021d0: 696f 6e28 7665 7262 6f73 652c 2054 7275  ion(verbose, Tru
-000021e0: 6520 6966 2076 6572 626f 7365 203e 2030  e if verbose > 0
-000021f0: 2065 6c73 6520 4661 6c73 6529 5d2c 0a20   else False)],. 
-00002200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002210: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-00002220: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-00002230: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00002240: 2020 2020 6d6f 6465 6c20 3d20 6c67 622e      model = lgb.
-00002250: 7472 6169 6e28 0a20 2020 2020 2020 2020  train(.         
-00002260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002270: 2020 2070 6172 616d 732c 200a 2020 2020     params, .    
-00002280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002290: 2020 2020 2020 2020 6474 7261 696e 2c20          dtrain, 
-000022a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000022b0: 2020 2020 2020 2020 2020 2020 2023 206e               # n
-000022c0: 756d 5f62 6f6f 7374 5f72 6f75 6e64 203d  um_boost_round =
-000022d0: 206e 5f62 6f6f 7374 2c0a 2020 2020 2020   n_boost,.      
-000022e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022f0: 2020 2020 2020 7661 6c69 645f 7365 7473        valid_sets
-00002300: 203d 205b 6476 616c 6964 5d2c 200a 2020   = [dvalid], .  
-00002310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002320: 2020 2020 2020 2020 2020 6361 6c6c 6261            callba
-00002330: 636b 7320 3d20 5b6c 6762 2e6c 6f67 5f65  cks = [lgb.log_e
-00002340: 7661 6c75 6174 696f 6e28 7665 7262 6f73  valuation(verbos
-00002350: 652c 2054 7275 6520 6966 2076 6572 626f  e, True if verbo
-00002360: 7365 203e 2030 2065 6c73 6520 4661 6c73  se > 0 else Fals
-00002370: 6529 5d2c 0a20 2020 2020 2020 2020 2020  e)],.           
-00002380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002390: 2066 6f62 6a20 3d20 6576 616c 2866 6f62   fobj = eval(fob
-000023a0: 6a5f 7374 7229 2c0a 2020 2020 2020 2020  j_str),.        
-000023b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000023c0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-000023d0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
-000023e0: 2020 2020 2020 6d6f 6465 6c20 3d20 6c67        model = lg
-000023f0: 622e 7472 6169 6e28 0a20 2020 2020 2020  b.train(.       
-00002400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002410: 2020 2020 207b 2a2a 7061 7261 6d73 2c20       {**params, 
-00002420: 276f 626a 6563 7469 7665 273a 2065 7661  'objective': eva
-00002430: 6c28 666f 626a 5f73 7472 297d 2c0a 2020  l(fobj_str)},.  
+00002180: 2020 2020 7061 7261 6d73 2c20 0a20 2020      params, .   
+00002190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021a0: 2020 2020 2064 7472 6169 6e2c 200a 2020       dtrain, .  
+000021b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021c0: 2020 2020 2020 7661 6c69 645f 7365 7473        valid_sets
+000021d0: 203d 205b 6476 616c 6964 5d2c 200a 2020   = [dvalid], .  
+000021e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021f0: 2020 2020 2020 6361 6c6c 6261 636b 7320        callbacks 
+00002200: 3d20 5b6c 6762 2e6c 6f67 5f65 7661 6c75  = [lgb.log_evalu
+00002210: 6174 696f 6e28 7665 7262 6f73 652c 2054  ation(verbose, T
+00002220: 7275 6520 6966 2076 6572 626f 7365 203e  rue if verbose >
+00002230: 2030 2065 6c73 6520 4661 6c73 6529 5d2c   0 else False)],
+00002240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002250: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00002260: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00002270: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00002280: 2020 2020 2020 6d6f 6465 6c20 3d20 6c67        model = lg
+00002290: 622e 7472 6169 6e28 0a20 2020 2020 2020  b.train(.       
+000022a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000022b0: 2020 2020 2070 6172 616d 732c 200a 2020       params, .  
+000022c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000022d0: 2020 2020 2020 2020 2020 6474 7261 696e            dtrain
+000022e0: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+000022f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00002300: 206e 756d 5f62 6f6f 7374 5f72 6f75 6e64   num_boost_round
+00002310: 203d 206e 5f62 6f6f 7374 2c0a 2020 2020   = n_boost,.    
+00002320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002330: 2020 2020 2020 2020 7661 6c69 645f 7365          valid_se
+00002340: 7473 203d 205b 6476 616c 6964 5d2c 200a  ts = [dvalid], .
+00002350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002360: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
+00002370: 6261 636b 7320 3d20 5b6c 6762 2e6c 6f67  backs = [lgb.log
+00002380: 5f65 7661 6c75 6174 696f 6e28 7665 7262  _evaluation(verb
+00002390: 6f73 652c 2054 7275 6520 6966 2076 6572  ose, True if ver
+000023a0: 626f 7365 203e 2030 2065 6c73 6520 4661  bose > 0 else Fa
+000023b0: 6c73 6529 5d2c 0a20 2020 2020 2020 2020  lse)],.         
+000023c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000023d0: 2020 2066 6f62 6a20 3d20 6576 616c 2866     fobj = eval(f
+000023e0: 6f62 6a5f 7374 7229 2c0a 2020 2020 2020  obj_str),.      
+000023f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002400: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00002410: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+00002420: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
+00002430: 6c67 622e 7472 6169 6e28 0a20 2020 2020  lgb.train(.     
 00002440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002450: 2020 2020 2020 2020 2020 6474 7261 696e            dtrain
-00002460: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-00002470: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00002480: 616c 6964 5f73 6574 7320 3d20 5b64 7661  alid_sets = [dva
-00002490: 6c69 645d 2c20 0a20 2020 2020 2020 2020  lid], .         
-000024a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024b0: 2020 2063 616c 6c62 6163 6b73 203d 205b     callbacks = [
-000024c0: 6c67 622e 6c6f 675f 6576 616c 7561 7469  lgb.log_evaluati
-000024d0: 6f6e 2876 6572 626f 7365 2c20 5472 7565  on(verbose, True
-000024e0: 2069 6620 7665 7262 6f73 6520 3e20 3020   if verbose > 0 
-000024f0: 656c 7365 2046 616c 7365 295d 2c0a 2020  else False)],.  
-00002500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002510: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00002520: 7365 6c66 2e6d 6f64 656c 203d 206d 6f64  self.model = mod
-00002530: 656c 0a20 2020 2020 2020 2072 6574 7572  el.        retur
-00002540: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-00002550: 7072 6564 6963 7428 7365 6c66 2c20 582c  predict(self, X,
-00002560: 2070 6172 616d 7320 3d20 4e6f 6e65 2c20   params = None, 
-00002570: 6b77 6172 6773 203d 204e 6f6e 6529 3a0a  kwargs = None):.
-00002580: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
-00002590: 2073 656c 662e 6d6f 6465 6c2e 7072 6564   self.model.pred
-000025a0: 6963 7428 582c 206e 5f6a 6f62 7320 3d20  ict(X, n_jobs = 
-000025b0: 7073 7574 696c 2e63 7075 5f63 6f75 6e74  psutil.cpu_count
-000025c0: 2829 202d 2031 290a 2020 2020 2020 2020  () - 1).        
-000025d0: 6966 2073 656c 662e 665f 6c61 6265 6c20  if self.f_label 
-000025e0: 6973 206e 6f74 204e 6f6e 653a 2079 5f70  is not None: y_p
-000025f0: 7265 6420 3d20 6e70 2e65 7870 6d31 286e  red = np.expm1(n
-00002600: 702e 6578 706d 3128 795f 7072 6564 2929  p.expm1(y_pred))
-00002610: 202d 2031 302e 300a 2020 2020 2020 2020   - 10.0.        
-00002620: 7265 7475 726e 2079 5f70 7265 640a 0a20  return y_pred.. 
-00002630: 2020 2064 6566 2067 6574 5f6e 5f66 6561     def get_n_fea
-00002640: 7475 7265 7328 7365 6c66 293a 0a20 2020  tures(self):.   
-00002650: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
-00002660: 7365 6c66 2e6d 6f64 656c 2e66 6561 7475  self.model.featu
-00002670: 7265 5f6e 616d 6528 2929 0a0a 2020 2020  re_name())..    
-00002680: 6465 6620 6765 745f 6466 5f69 6d70 2873  def get_df_imp(s
-00002690: 656c 662c 2063 6f6c 735f 6665 6120 3d20  elf, cols_fea = 
-000026a0: 4e6f 6e65 2c20 706c 6f74 203d 2046 616c  None, plot = Fal
-000026b0: 7365 2c20 6b20 3d20 3230 2c20 6669 6773  se, k = 20, figs
-000026c0: 697a 6520 3d20 2832 302c 2031 3029 293a  ize = (20, 10)):
-000026d0: 0a20 2020 2020 2020 2069 6d70 203d 2073  .        imp = s
-000026e0: 656c 662e 6d6f 6465 6c2e 6665 6174 7572  elf.model.featur
-000026f0: 655f 696d 706f 7274 616e 6365 2869 6d70  e_importance(imp
-00002700: 6f72 7461 6e63 655f 7479 7065 203d 2027  ortance_type = '
-00002710: 6761 696e 2729 0a20 2020 2020 2020 2072  gain').        r
-00002720: 6574 7572 6e20 7375 7065 7228 292e 5f67  eturn super()._g
-00002730: 6574 5f64 665f 696d 7028 696d 702c 2063  et_df_imp(imp, c
-00002740: 6f6c 735f 6665 612c 2070 6c6f 742c 206b  ols_fea, plot, k
-00002750: 2c20 6669 6773 697a 6520 3d20 6669 6773  , figsize = figs
-00002760: 697a 6529 0a0a 2020 2020 6465 6620 6475  ize)..    def du
-00002770: 6d70 2873 656c 662c 2070 6174 6829 3a0a  mp(self, path):.
-00002780: 2020 2020 2020 2020 6f73 2e73 7973 7465          os.syste
-00002790: 6d28 2772 6d20 2d72 6620 7b70 6174 687d  m('rm -rf {path}
-000027a0: 2729 0a20 2020 2020 2020 206f 732e 6d61  ').        os.ma
-000027b0: 6b65 6469 7273 2870 6174 682c 2065 7869  kedirs(path, exi
-000027c0: 7374 5f6f 6b20 3d20 5472 7565 290a 2020  st_ok = True).  
-000027d0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
-000027e0: 2e73 6176 655f 6d6f 6465 6c28 6627 7b70  .save_model(f'{p
-000027f0: 6174 687d 2f6d 6f64 656c 2e62 696e 2729  ath}/model.bin')
-00002800: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-00002810: 2e5f 6475 6d70 5f6f 7468 6572 2870 6174  ._dump_other(pat
-00002820: 6829 0a20 2020 200a 2020 2020 6465 6620  h).    .    def 
-00002830: 6c6f 6164 2873 656c 662c 2070 6174 6829  load(self, path)
-00002840: 3a0a 2020 2020 2020 2020 7365 6c66 2e6d  :.        self.m
-00002850: 6f64 656c 203d 206c 6762 2e42 6f6f 7374  odel = lgb.Boost
-00002860: 6572 286d 6f64 656c 5f66 696c 6520 3d20  er(model_file = 
-00002870: 6627 7b70 6174 687d 2f6d 6f64 656c 2e62  f'{path}/model.b
-00002880: 696e 2729 0a20 2020 2020 2020 2073 7570  in').        sup
-00002890: 6572 2829 2e5f 6c6f 6164 5f6f 7468 6572  er()._load_other
-000028a0: 2870 6174 6829 0a20 2020 2020 2020 2072  (path).        r
-000028b0: 6574 7572 6e20 7365 6c66 0a0a 5c27 5c27  eturn self..\'\'
-000028c0: 5c27 0a2f 5573 6572 732f 7275 6e6e 696e  \'./Users/runnin
-000028d0: 677a 2f61 6e61 636f 6e64 6133 2f65 6e76  gz/anaconda3/env
-000028e0: 732f 7079 3339 2f6c 6962 2f70 7974 686f  s/py39/lib/pytho
-000028f0: 6e33 2e39 2f73 6974 652d 7061 636b 6167  n3.9/site-packag
-00002900: 6573 2f6c 6967 6874 6762 6d2f 5f5f 696e  es/lightgbm/__in
-00002910: 6974 5f5f 2e70 7920 332e 332e 350a 2f55  it__.py 3.3.5./U
-00002920: 7365 7273 2f72 756e 6e69 6e67 7a2f 616e  sers/runningz/an
-00002930: 6163 6f6e 6461 332f 656e 7673 2f70 7933  aconda3/envs/py3
-00002940: 392f 6c69 622f 7079 7468 6f6e 332e 392f  9/lib/python3.9/
-00002950: 7369 7465 2d70 6163 6b61 6765 732f 6361  site-packages/ca
-00002960: 7462 6f6f 7374 2f5f 5f69 6e69 745f 5f2e  tboost/__init__.
-00002970: 7079 2031 2e31 2e31 0a5b 2b5d 2074 7261  py 1.1.1.[+] tra
-00002980: 696e 0a5b 3230 3233 2f30 332f 3138 2031  in.[2023/03/18 1
-00002990: 343a 3437 3a32 385d 206d 656d 5f63 7572  4:47:28] mem_cur
-000029a0: 203d 2034 2e30 3047 4220 3d20 342c 3239   = 4.00GB = 4,29
-000029b0: 302c 3330 312c 3935 320a 5b32 3032 332f  0,301,952.[2023/
-000029c0: 3033 2f31 3820 3134 3a34 373a 3238 5d20  03/18 14:47:28] 
-000029d0: 6d65 6d5f 6d61 7820 3d20 342e 3030 4742  mem_max = 4.00GB
-000029e0: 203d 2034 2c32 3930 2c33 3031 2c39 3532   = 4,290,301,952
-000029f0: 0a6d 6f64 656c 5f6e 616d 6520 3d20 4c47  .model_name = LG
-00002a00: 424d 6f64 656c 0a5b 2b5d 206b 7761 7267  BModel.[+] kwarg
-00002a10: 7320 3d20 7b27 7061 7261 6d73 5f69 6427  s = {'params_id'
-00002a20: 3a20 2770 6172 616d 735f 3127 2c20 276e  : 'params_1', 'n
-00002a30: 5f62 6f6f 7374 273a 2031 302c 2027 7368  _boost': 10, 'sh
-00002a40: 6f77 5f69 6e66 6f27 3a20 5472 7565 2c20  ow_info': True, 
-00002a50: 2766 7265 655f 5879 273a 2054 7275 657d  'free_Xy': True}
-00002a60: 0a5b 2b5d 2070 6172 616d 7320 3d20 7b27  .[+] params = {'
-00002a70: 7365 6564 273a 2037 3737 2c20 276f 626a  seed': 777, 'obj
-00002a80: 6563 7469 7665 273a 2027 7265 6772 6573  ective': 'regres
-00002a90: 7369 6f6e 272c 2027 6d65 7472 6963 273a  sion', 'metric':
-00002aa0: 2027 726d 7365 272c 2027 6e5f 6a6f 6273   'rmse', 'n_jobs
-00002ab0: 273a 2036 332c 2027 7665 7262 6f73 6974  ': 63, 'verbosit
-00002ac0: 7927 3a20 2d31 2c20 276c 6561 726e 696e  y': -1, 'learnin
-00002ad0: 675f 7261 7465 273a 2030 2e30 312c 2027  g_rate': 0.01, '
-00002ae0: 6e75 6d5f 6c65 6176 6573 273a 2032 3535  num_leaves': 255
-00002af0: 2c20 276d 6178 5f64 6570 7468 273a 202d  , 'max_depth': -
-00002b00: 312c 2027 6665 6174 7572 655f 6672 6163  1, 'feature_frac
-00002b10: 7469 6f6e 273a 2030 2e35 2c20 2762 6167  tion': 0.5, 'bag
-00002b20: 6769 6e67 5f66 7261 6374 696f 6e27 3a20  ging_fraction': 
-00002b30: 302e 357d 0a5b 2b5d 2058 5f74 7261 696e  0.5}.[+] X_train
-00002b40: 2e73 6861 7065 203d 2028 3130 3030 3030  .shape = (100000
-00002b50: 3030 2c20 3130 3029 0a5b 2b5d 2058 5f76  00, 100).[+] X_v
-00002b60: 616c 6964 2e73 6861 7065 203d 2028 3130  alid.shape = (10
-00002b70: 2c20 3130 3029 0a5b 2b5d 2062 6566 6f72  , 100).[+] befor
-00002b80: 650a 5b32 3032 332f 3033 2f31 3820 3134  e.[2023/03/18 14
-00002b90: 3a34 373a 3238 5d20 6d65 6d5f 6375 7220  :47:28] mem_cur 
-00002ba0: 3d20 342e 3030 4742 203d 2034 2c32 3930  = 4.00GB = 4,290
-00002bb0: 2c33 3031 2c39 3532 0a5b 3230 3233 2f30  ,301,952.[2023/0
-00002bc0: 332f 3138 2031 343a 3437 3a32 385d 206d  3/18 14:47:28] m
-00002bd0: 656d 5f6d 6178 203d 2034 2e30 3047 4220  em_max = 4.00GB 
-00002be0: 3d20 342c 3239 302c 3330 312c 3935 320a  = 4,290,301,952.
-00002bf0: 5b2b 5d20 6166 7465 6572 0a5b 3230 3233  [+] afteer.[2023
-00002c00: 2f30 332f 3138 2031 343a 3437 3a32 385d  /03/18 14:47:28]
-00002c10: 206d 656d 5f63 7572 203d 2034 2e30 3047   mem_cur = 4.00G
-00002c20: 4220 3d20 342c 3239 302c 3330 312c 3935  B = 4,290,301,95
-00002c30: 320a 5b32 3032 332f 3033 2f31 3820 3134  2.[2023/03/18 14
-00002c40: 3a34 373a 3238 5d20 6d65 6d5f 6d61 7820  :47:28] mem_max 
-00002c50: 3d20 342e 3030 4742 203d 2034 2c32 3930  = 4.00GB = 4,290
-00002c60: 2c33 3031 2c39 3532 0a5b 2b5d 2070 7265  ,301,952.[+] pre
-00002c70: 6469 6374 0a5b 3230 3233 2f30 332f 3138  dict.[2023/03/18
-00002c80: 2031 343a 3438 3a30 365d 206d 656d 5f63   14:48:06] mem_c
-00002c90: 7572 203d 2031 2e31 3747 4220 3d20 312c  ur = 1.17GB = 1,
-00002ca0: 3235 352c 3631 322c 3431 360a 5b32 3032  255,612,416.[202
-00002cb0: 332f 3033 2f31 3820 3134 3a34 383a 3036  3/03/18 14:48:06
-00002cc0: 5d20 6d65 6d5f 6d61 7820 3d20 352e 3438  ] mem_max = 5.48
-00002cd0: 4742 203d 2035 2c38 3832 2c37 3635 2c33  GB = 5,882,765,3
-00002ce0: 3132 0a30 2e32 3435 3530 3639 3330 3433  12.0.24550693043
-00002cf0: 3939 3031 360a 5b2b 5d20 6765 745f 6466  99016.[+] get_df
-00002d00: 5f69 6d70 0a20 2020 2020 2020 2020 696d  _imp.         im
-00002d10: 7020 636f 6c0a 3020 2032 322e 3339 3630  p col.0  22.3960
-00002d20: 3630 2020 7830 0a31 2020 3232 2e39 3734  60  x0.1  22.974
-00002d30: 3637 3420 2078 310a 3220 2031 372e 3633  674  x1.2  17.63
-00002d40: 3437 3135 2020 7832 0a33 2020 2039 2e35  4715  x2.3   9.5
-00002d50: 3139 3536 3420 2078 330a 3420 2032 352e  19564  x3.4  25.
-00002d60: 3230 3332 3939 2020 7834 0a5b 2b5d 2064  203299  x4.[+] d
-00002d70: 756d 700a 5b2b 5d20 6c6f 6164 0a30 2e30  ump.[+] load.0.0
-00002d80: 0a5b 2b5d 2044 6f6e 650a 5b32 3032 332f  .[+] Done.[2023/
-00002d90: 3033 2f31 3820 3134 3a34 383a 3036 5d20  03/18 14:48:06] 
-00002da0: 6d65 6d5f 6375 7220 3d20 312e 3138 4742  mem_cur = 1.18GB
-00002db0: 203d 2031 2c32 3632 2c39 3732 2c39 3238   = 1,262,972,928
-00002dc0: 0a5b 3230 3233 2f30 332f 3138 2031 343a  .[2023/03/18 14:
-00002dd0: 3438 3a30 365d 206d 656d 5f6d 6178 203d  48:06] mem_max =
-00002de0: 2035 2e34 3847 4220 3d20 352c 3838 322c   5.48GB = 5,882,
-00002df0: 3736 352c 3331 320a 5c27 5c27 5c27 7a06  765,312.\'\'\'z.
-00002e00: 5c27 5c27 5c27 7a03 2727 27da 0177 2907  \'\'\'z.'''..w).
-00002e10: da02 6f73 da04 7061 7468 da07 6469 726e  ..os..path..dirn
-00002e20: 616d 65da 085f 5f66 696c 655f 5fda 0772  ame..__file__..r
-00002e30: 6570 6c61 6365 da04 6f70 656e da05 7772  eplace..open..wr
-00002e40: 6974 6529 04da 066f 7574 7075 745a 0b70  ite)...outputZ.p
-00002e50: 6174 685f 6f75 7470 7574 da01 73da 0166  ath_output..s..f
-00002e60: a900 720e 0000 00fa 4662 7569 6c64 2f62  ..r.....Fbuild/b
-00002e70: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
-00002e80: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
-00002e90: 696e 677a 2f6d 6f64 656c 2f74 7265 652f  ingz/model/tree/
-00002ea0: 6d6f 6465 6c5f 6c67 625f 7079 2e70 79da  model_lgb_py.py.
-00002eb0: 0372 756e 0400 0000 730e 0000 0000 0114  .run....s.......
-00002ec0: 0104 7f00 7f00 400c 010c 0172 1000 0000  ......@....r....
-00002ed0: da08 5f5f 6d61 696e 5f5f 7a08 2d2d 6f75  ..__main__z.--ou
-00002ee0: 7470 7574 5429 02da 0474 7970 65da 0872  tputT)...type..r
-00002ef0: 6571 7569 7265 6429 0c72 0400 0000 da03  equired).r......
-00002f00: 7379 7372 1000 0000 da08 5f5f 6e61 6d65  sysr......__name
-00002f10: 5f5f da08 6172 6770 6172 7365 da0e 4172  __..argparse..Ar
-00002f20: 6775 6d65 6e74 5061 7273 6572 da06 7061  gumentParser..pa
-00002f30: 7273 6572 da0c 6164 645f 6172 6775 6d65  rser..add_argume
-00002f40: 6e74 da03 7374 72da 0a70 6172 7365 5f61  nt..str..parse_a
-00002f50: 7267 73da 0461 7267 7372 0b00 0000 720e  rgs..argsr....r.
-00002f60: 0000 0072 0e00 0000 720e 0000 0072 0f00  ...r....r....r..
-00002f70: 0000 da08 3c6d 6f64 756c 653e 0200 0000  ....<module>....
-00002f80: 7314 0000 0008 0108 0108 7f00 7f00 4608  s.............F.
-00002f90: 0108 0108 0110 0108 01                   .........
+00002450: 2020 2020 2020 207b 2a2a 7061 7261 6d73         {**params
+00002460: 2c20 276f 626a 6563 7469 7665 273a 2065  , 'objective': e
+00002470: 7661 6c28 666f 626a 5f73 7472 297d 2c0a  val(fobj_str)},.
+00002480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002490: 2020 2020 2020 2020 2020 2020 6474 7261              dtra
+000024a0: 696e 2c20 0a20 2020 2020 2020 2020 2020  in, .           
+000024b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000024c0: 2076 616c 6964 5f73 6574 7320 3d20 5b64   valid_sets = [d
+000024d0: 7661 6c69 645d 2c20 0a20 2020 2020 2020  valid], .       
+000024e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000024f0: 2020 2020 2063 616c 6c62 6163 6b73 203d       callbacks =
+00002500: 205b 6c67 622e 6c6f 675f 6576 616c 7561   [lgb.log_evalua
+00002510: 7469 6f6e 2876 6572 626f 7365 2c20 5472  tion(verbose, Tr
+00002520: 7565 2069 6620 7665 7262 6f73 6520 3e20  ue if verbose > 
+00002530: 3020 656c 7365 2046 616c 7365 295d 2c0a  0 else False)],.
+00002540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002550: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002560: 2020 7365 6c66 2e6d 6f64 656c 203d 206d    self.model = m
+00002570: 6f64 656c 0a20 2020 2020 2020 2072 6574  odel.        ret
+00002580: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+00002590: 6620 7072 6564 6963 7428 7365 6c66 2c20  f predict(self, 
+000025a0: 582c 2070 6172 616d 7320 3d20 4e6f 6e65  X, params = None
+000025b0: 2c20 6b77 6172 6773 203d 204e 6f6e 6529  , kwargs = None)
+000025c0: 3a0a 2020 2020 2020 2020 6e5f 6a6f 6273  :.        n_jobs
+000025d0: 203d 206b 7761 7267 732e 6765 7428 276e   = kwargs.get('n
+000025e0: 5f6a 6f62 7327 2c20 7073 7574 696c 2e63  _jobs', psutil.c
+000025f0: 7075 5f63 6f75 6e74 2829 202d 2031 290a  pu_count() - 1).
+00002600: 2020 2020 2020 2020 6e5f 626f 6f73 7420          n_boost 
+00002610: 3d20 6b77 6172 6773 2e67 6574 2827 6e5f  = kwargs.get('n_
+00002620: 626f 6f73 7427 2c20 7365 6c66 2e6d 6f64  boost', self.mod
+00002630: 656c 2e6e 756d 5f66 6561 7475 7265 2829  el.num_feature()
+00002640: 290a 2020 2020 2020 2020 795f 7072 6564  ).        y_pred
+00002650: 203d 2073 656c 662e 6d6f 6465 6c2e 7072   = self.model.pr
+00002660: 6564 6963 7428 582c 206e 5f6a 6f62 7320  edict(X, n_jobs 
+00002670: 3d20 6e5f 6a6f 6273 2c20 6e75 6d5f 6974  = n_jobs, num_it
+00002680: 6572 6174 696f 6e20 3d20 6e5f 626f 6f73  eration = n_boos
+00002690: 7429 0a20 2020 2020 2020 2069 6620 7365  t).        if se
+000026a0: 6c66 2e66 5f6c 6162 656c 2069 7320 6e6f  lf.f_label is no
+000026b0: 7420 4e6f 6e65 3a20 795f 7072 6564 203d  t None: y_pred =
+000026c0: 206e 702e 6578 706d 3128 6e70 2e65 7870   np.expm1(np.exp
+000026d0: 6d31 2879 5f70 7265 6429 2920 2d20 7365  m1(y_pred)) - se
+000026e0: 6c66 2e63 6c69 700a 2020 2020 2020 2020  lf.clip.        
+000026f0: 7265 7475 726e 2079 5f70 7265 640a 0a20  return y_pred.. 
+00002700: 2020 2064 6566 2067 6574 5f6e 5f66 6561     def get_n_fea
+00002710: 7475 7265 7328 7365 6c66 293a 0a20 2020  tures(self):.   
+00002720: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+00002730: 7365 6c66 2e6d 6f64 656c 2e66 6561 7475  self.model.featu
+00002740: 7265 5f6e 616d 6528 2929 0a0a 2020 2020  re_name())..    
+00002750: 6465 6620 6765 745f 6466 5f69 6d70 2873  def get_df_imp(s
+00002760: 656c 662c 2063 6f6c 735f 6665 6120 3d20  elf, cols_fea = 
+00002770: 4e6f 6e65 2c20 706c 6f74 203d 2046 616c  None, plot = Fal
+00002780: 7365 2c20 6b20 3d20 3230 2c20 6669 6773  se, k = 20, figs
+00002790: 697a 6520 3d20 2832 302c 2031 3029 293a  ize = (20, 10)):
+000027a0: 0a20 2020 2020 2020 2069 6d70 203d 2073  .        imp = s
+000027b0: 656c 662e 6d6f 6465 6c2e 6665 6174 7572  elf.model.featur
+000027c0: 655f 696d 706f 7274 616e 6365 2869 6d70  e_importance(imp
+000027d0: 6f72 7461 6e63 655f 7479 7065 203d 2027  ortance_type = '
+000027e0: 6761 696e 2729 0a20 2020 2020 2020 2072  gain').        r
+000027f0: 6574 7572 6e20 7375 7065 7228 292e 5f67  eturn super()._g
+00002800: 6574 5f64 665f 696d 7028 696d 702c 2063  et_df_imp(imp, c
+00002810: 6f6c 735f 6665 612c 2070 6c6f 742c 206b  ols_fea, plot, k
+00002820: 2c20 6669 6773 697a 6520 3d20 6669 6773  , figsize = figs
+00002830: 697a 6529 0a0a 2020 2020 6465 6620 6475  ize)..    def du
+00002840: 6d70 2873 656c 662c 2070 6174 6829 3a0a  mp(self, path):.
+00002850: 2020 2020 2020 2020 6f73 2e73 7973 7465          os.syste
+00002860: 6d28 2772 6d20 2d72 6620 7b70 6174 687d  m('rm -rf {path}
+00002870: 2729 0a20 2020 2020 2020 206f 732e 6d61  ').        os.ma
+00002880: 6b65 6469 7273 2870 6174 682c 2065 7869  kedirs(path, exi
+00002890: 7374 5f6f 6b20 3d20 5472 7565 290a 2020  st_ok = True).  
+000028a0: 2020 2020 2020 7365 6c66 2e6d 6f64 656c        self.model
+000028b0: 2e73 6176 655f 6d6f 6465 6c28 6627 7b70  .save_model(f'{p
+000028c0: 6174 687d 2f6d 6f64 656c 2e62 696e 2729  ath}/model.bin')
+000028d0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
+000028e0: 2e5f 6475 6d70 5f6f 7468 6572 2870 6174  ._dump_other(pat
+000028f0: 6829 0a20 2020 200a 2020 2020 6465 6620  h).    .    def 
+00002900: 6c6f 6164 2873 656c 662c 2070 6174 6829  load(self, path)
+00002910: 3a0a 2020 2020 2020 2020 7365 6c66 2e6d  :.        self.m
+00002920: 6f64 656c 203d 206c 6762 2e42 6f6f 7374  odel = lgb.Boost
+00002930: 6572 286d 6f64 656c 5f66 696c 6520 3d20  er(model_file = 
+00002940: 6627 7b70 6174 687d 2f6d 6f64 656c 2e62  f'{path}/model.b
+00002950: 696e 2729 0a20 2020 2020 2020 2073 7570  in').        sup
+00002960: 6572 2829 2e5f 6c6f 6164 5f6f 7468 6572  er()._load_other
+00002970: 2870 6174 6829 0a20 2020 2020 2020 2072  (path).        r
+00002980: 6574 7572 6e20 7365 6c66 0a0a 5c27 5c27  eturn self..\'\'
+00002990: 5c27 0a2f 5573 6572 732f 7275 6e6e 696e  \'./Users/runnin
+000029a0: 677a 2f61 6e61 636f 6e64 6133 2f65 6e76  gz/anaconda3/env
+000029b0: 732f 7079 3339 2f6c 6962 2f70 7974 686f  s/py39/lib/pytho
+000029c0: 6e33 2e39 2f73 6974 652d 7061 636b 6167  n3.9/site-packag
+000029d0: 6573 2f6c 6967 6874 6762 6d2f 5f5f 696e  es/lightgbm/__in
+000029e0: 6974 5f5f 2e70 7920 332e 332e 350a 2f55  it__.py 3.3.5./U
+000029f0: 7365 7273 2f72 756e 6e69 6e67 7a2f 616e  sers/runningz/an
+00002a00: 6163 6f6e 6461 332f 656e 7673 2f70 7933  aconda3/envs/py3
+00002a10: 392f 6c69 622f 7079 7468 6f6e 332e 392f  9/lib/python3.9/
+00002a20: 7369 7465 2d70 6163 6b61 6765 732f 6361  site-packages/ca
+00002a30: 7462 6f6f 7374 2f5f 5f69 6e69 745f 5f2e  tboost/__init__.
+00002a40: 7079 2031 2e31 2e31 0a5b 2b5d 2074 7261  py 1.1.1.[+] tra
+00002a50: 696e 0a5b 3230 3233 2f30 332f 3138 2031  in.[2023/03/18 1
+00002a60: 343a 3437 3a32 385d 206d 656d 5f63 7572  4:47:28] mem_cur
+00002a70: 203d 2034 2e30 3047 4220 3d20 342c 3239   = 4.00GB = 4,29
+00002a80: 302c 3330 312c 3935 320a 5b32 3032 332f  0,301,952.[2023/
+00002a90: 3033 2f31 3820 3134 3a34 373a 3238 5d20  03/18 14:47:28] 
+00002aa0: 6d65 6d5f 6d61 7820 3d20 342e 3030 4742  mem_max = 4.00GB
+00002ab0: 203d 2034 2c32 3930 2c33 3031 2c39 3532   = 4,290,301,952
+00002ac0: 0a6d 6f64 656c 5f6e 616d 6520 3d20 4c47  .model_name = LG
+00002ad0: 424d 6f64 656c 0a5b 2b5d 206b 7761 7267  BModel.[+] kwarg
+00002ae0: 7320 3d20 7b27 7061 7261 6d73 5f69 6427  s = {'params_id'
+00002af0: 3a20 2770 6172 616d 735f 3127 2c20 276e  : 'params_1', 'n
+00002b00: 5f62 6f6f 7374 273a 2031 302c 2027 7368  _boost': 10, 'sh
+00002b10: 6f77 5f69 6e66 6f27 3a20 5472 7565 2c20  ow_info': True, 
+00002b20: 2766 7265 655f 5879 273a 2054 7275 657d  'free_Xy': True}
+00002b30: 0a5b 2b5d 2070 6172 616d 7320 3d20 7b27  .[+] params = {'
+00002b40: 7365 6564 273a 2037 3737 2c20 276f 626a  seed': 777, 'obj
+00002b50: 6563 7469 7665 273a 2027 7265 6772 6573  ective': 'regres
+00002b60: 7369 6f6e 272c 2027 6d65 7472 6963 273a  sion', 'metric':
+00002b70: 2027 726d 7365 272c 2027 6e5f 6a6f 6273   'rmse', 'n_jobs
+00002b80: 273a 2036 332c 2027 7665 7262 6f73 6974  ': 63, 'verbosit
+00002b90: 7927 3a20 2d31 2c20 276c 6561 726e 696e  y': -1, 'learnin
+00002ba0: 675f 7261 7465 273a 2030 2e30 312c 2027  g_rate': 0.01, '
+00002bb0: 6e75 6d5f 6c65 6176 6573 273a 2032 3535  num_leaves': 255
+00002bc0: 2c20 276d 6178 5f64 6570 7468 273a 202d  , 'max_depth': -
+00002bd0: 312c 2027 6665 6174 7572 655f 6672 6163  1, 'feature_frac
+00002be0: 7469 6f6e 273a 2030 2e35 2c20 2762 6167  tion': 0.5, 'bag
+00002bf0: 6769 6e67 5f66 7261 6374 696f 6e27 3a20  ging_fraction': 
+00002c00: 302e 357d 0a5b 2b5d 2058 5f74 7261 696e  0.5}.[+] X_train
+00002c10: 2e73 6861 7065 203d 2028 3130 3030 3030  .shape = (100000
+00002c20: 3030 2c20 3130 3029 0a5b 2b5d 2058 5f76  00, 100).[+] X_v
+00002c30: 616c 6964 2e73 6861 7065 203d 2028 3130  alid.shape = (10
+00002c40: 2c20 3130 3029 0a5b 2b5d 2062 6566 6f72  , 100).[+] befor
+00002c50: 650a 5b32 3032 332f 3033 2f31 3820 3134  e.[2023/03/18 14
+00002c60: 3a34 373a 3238 5d20 6d65 6d5f 6375 7220  :47:28] mem_cur 
+00002c70: 3d20 342e 3030 4742 203d 2034 2c32 3930  = 4.00GB = 4,290
+00002c80: 2c33 3031 2c39 3532 0a5b 3230 3233 2f30  ,301,952.[2023/0
+00002c90: 332f 3138 2031 343a 3437 3a32 385d 206d  3/18 14:47:28] m
+00002ca0: 656d 5f6d 6178 203d 2034 2e30 3047 4220  em_max = 4.00GB 
+00002cb0: 3d20 342c 3239 302c 3330 312c 3935 320a  = 4,290,301,952.
+00002cc0: 5b2b 5d20 6166 7465 6572 0a5b 3230 3233  [+] afteer.[2023
+00002cd0: 2f30 332f 3138 2031 343a 3437 3a32 385d  /03/18 14:47:28]
+00002ce0: 206d 656d 5f63 7572 203d 2034 2e30 3047   mem_cur = 4.00G
+00002cf0: 4220 3d20 342c 3239 302c 3330 312c 3935  B = 4,290,301,95
+00002d00: 320a 5b32 3032 332f 3033 2f31 3820 3134  2.[2023/03/18 14
+00002d10: 3a34 373a 3238 5d20 6d65 6d5f 6d61 7820  :47:28] mem_max 
+00002d20: 3d20 342e 3030 4742 203d 2034 2c32 3930  = 4.00GB = 4,290
+00002d30: 2c33 3031 2c39 3532 0a5b 2b5d 2070 7265  ,301,952.[+] pre
+00002d40: 6469 6374 0a5b 3230 3233 2f30 332f 3138  dict.[2023/03/18
+00002d50: 2031 343a 3438 3a30 365d 206d 656d 5f63   14:48:06] mem_c
+00002d60: 7572 203d 2031 2e31 3747 4220 3d20 312c  ur = 1.17GB = 1,
+00002d70: 3235 352c 3631 322c 3431 360a 5b32 3032  255,612,416.[202
+00002d80: 332f 3033 2f31 3820 3134 3a34 383a 3036  3/03/18 14:48:06
+00002d90: 5d20 6d65 6d5f 6d61 7820 3d20 352e 3438  ] mem_max = 5.48
+00002da0: 4742 203d 2035 2c38 3832 2c37 3635 2c33  GB = 5,882,765,3
+00002db0: 3132 0a30 2e32 3435 3530 3639 3330 3433  12.0.24550693043
+00002dc0: 3939 3031 360a 5b2b 5d20 6765 745f 6466  99016.[+] get_df
+00002dd0: 5f69 6d70 0a20 2020 2020 2020 2020 696d  _imp.         im
+00002de0: 7020 636f 6c0a 3020 2032 322e 3339 3630  p col.0  22.3960
+00002df0: 3630 2020 7830 0a31 2020 3232 2e39 3734  60  x0.1  22.974
+00002e00: 3637 3420 2078 310a 3220 2031 372e 3633  674  x1.2  17.63
+00002e10: 3437 3135 2020 7832 0a33 2020 2039 2e35  4715  x2.3   9.5
+00002e20: 3139 3536 3420 2078 330a 3420 2032 352e  19564  x3.4  25.
+00002e30: 3230 3332 3939 2020 7834 0a5b 2b5d 2064  203299  x4.[+] d
+00002e40: 756d 700a 5b2b 5d20 6c6f 6164 0a30 2e30  ump.[+] load.0.0
+00002e50: 0a5b 2b5d 2044 6f6e 650a 5b32 3032 332f  .[+] Done.[2023/
+00002e60: 3033 2f31 3820 3134 3a34 383a 3036 5d20  03/18 14:48:06] 
+00002e70: 6d65 6d5f 6375 7220 3d20 312e 3138 4742  mem_cur = 1.18GB
+00002e80: 203d 2031 2c32 3632 2c39 3732 2c39 3238   = 1,262,972,928
+00002e90: 0a5b 3230 3233 2f30 332f 3138 2031 343a  .[2023/03/18 14:
+00002ea0: 3438 3a30 365d 206d 656d 5f6d 6178 203d  48:06] mem_max =
+00002eb0: 2035 2e34 3847 4220 3d20 352c 3838 322c   5.48GB = 5,882,
+00002ec0: 3736 352c 3331 320a 5c27 5c27 5c27 7a06  765,312.\'\'\'z.
+00002ed0: 5c27 5c27 5c27 7a03 2727 27da 0177 2907  \'\'\'z.'''..w).
+00002ee0: da02 6f73 da04 7061 7468 da07 6469 726e  ..os..path..dirn
+00002ef0: 616d 65da 085f 5f66 696c 655f 5fda 0772  ame..__file__..r
+00002f00: 6570 6c61 6365 da04 6f70 656e da05 7772  eplace..open..wr
+00002f10: 6974 6529 04da 066f 7574 7075 745a 0b70  ite)...outputZ.p
+00002f20: 6174 685f 6f75 7470 7574 da01 73da 0166  ath_output..s..f
+00002f30: a900 720e 0000 00fa 4662 7569 6c64 2f62  ..r.....Fbuild/b
+00002f40: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
+00002f50: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
+00002f60: 696e 677a 2f6d 6f64 656c 2f74 7265 652f  ingz/model/tree/
+00002f70: 6d6f 6465 6c5f 6c67 625f 7079 2e70 79da  model_lgb_py.py.
+00002f80: 0372 756e 0400 0000 730e 0000 0000 0114  .run....s.......
+00002f90: 0104 7f00 7f00 430c 010c 0172 1000 0000  ......C....r....
+00002fa0: da08 5f5f 6d61 696e 5f5f 7a08 2d2d 6f75  ..__main__z.--ou
+00002fb0: 7470 7574 5429 02da 0474 7970 65da 0872  tputT)...type..r
+00002fc0: 6571 7569 7265 6429 0c72 0400 0000 da03  equired).r......
+00002fd0: 7379 7372 1000 0000 da08 5f5f 6e61 6d65  sysr......__name
+00002fe0: 5f5f da08 6172 6770 6172 7365 da0e 4172  __..argparse..Ar
+00002ff0: 6775 6d65 6e74 5061 7273 6572 da06 7061  gumentParser..pa
+00003000: 7273 6572 da0c 6164 645f 6172 6775 6d65  rser..add_argume
+00003010: 6e74 da03 7374 72da 0a70 6172 7365 5f61  nt..str..parse_a
+00003020: 7267 73da 0461 7267 7372 0b00 0000 720e  rgs..argsr....r.
+00003030: 0000 0072 0e00 0000 720e 0000 0072 0f00  ...r....r....r..
+00003040: 0000 da08 3c6d 6f64 756c 653e 0200 0000  ....<module>....
+00003050: 7314 0000 0008 0108 0108 7f00 7f00 4908  s.............I.
+00003060: 0108 0108 0110 0108 01                   .........
```

## runningz/opt/opt_random_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 9412 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 c424 0000  a.........Yf.$..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 c424 0000  a.........\f.$..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_dates_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 1250 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 e204 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 e204 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_labels_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 2801 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 f10a 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 f10a 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_main_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 21224 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 e852 0000  a.........Yf.R..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 e852 0000  a.........\f.R..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_run_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 1747 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 d306 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 d306 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/res_seeds_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 935 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 a703 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 a703 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/config/res_config_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 3667 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 530e 0000  a.........YfS...
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 530e 0000  a.........\fS...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/er/pooler_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 23172 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 845a 0000  a.........Yf.Z..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 845a 0000  a.........\f.Z..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/res/util/util_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 2316 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 0c09 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 0c09 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/util/code.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sun Apr  7 03:46:31 2024 UTC, .py size: 44034 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,10 +1,10 @@
-00000000: 610d 0d0a 0000 0000 1717 1266 02ac 0000  a..........f....
+00000000: 610d 0d0a 0000 0000 c998 5a66 bbb5 0000  a.........Zf....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0002 0000 0040 0000 0073 2c01 0000 6400  .....@...s,...d.
+00000020: 0002 0000 0040 0000 0073 3401 0000 6400  .....@...s4...d.
 00000030: 6401 8400 5a00 6402 6403 8400 5a01 6404  d...Z.d.d...Z.d.
 00000040: 6405 8400 5a02 6406 6407 8400 5a03 6408  d...Z.d.d...Z.d.
 00000050: 6409 8400 5a04 640a 640b 8400 5a05 640c  d...Z.d.d...Z.d.
 00000060: 640d 8400 5a06 640e 640f 8400 5a07 6410  d...Z.d.d...Z.d.
 00000070: 6411 8400 5a08 6412 6413 8400 5a09 6414  d...Z.d.d...Z.d.
 00000080: 6415 8400 5a0a 6416 6417 8400 5a0b 6418  d...Z.d.d...Z.d.
 00000090: 6419 8400 5a0c 641a 641b 8400 5a0d 641c  d...Z.d.d...Z.d.
@@ -15,2895 +15,3055 @@
 000000e0: 642d 8400 5a16 642e 642f 8400 5a17 6430  d-..Z.d.d/..Z.d0
 000000f0: 6431 8400 5a18 6432 6433 8400 5a19 6434  d1..Z.d2d3..Z.d4
 00000100: 6435 8400 5a1a 6436 6437 8400 5a1b 6438  d5..Z.d6d7..Z.d8
 00000110: 6439 8400 5a1c 643a 643b 8400 5a1d 643c  d9..Z.d:d;..Z.d<
 00000120: 643d 8400 5a1e 643e 643f 8400 5a1f 6440  d=..Z.d>d?..Z.d@
 00000130: 6441 8400 5a20 6442 6443 8400 5a21 6444  dA..Z dBdC..Z!dD
 00000140: 6445 8400 5a22 6446 6447 8400 5a23 6448  dE..Z"dFdG..Z#dH
-00000150: 6449 8400 5a24 644a 5300 294b 6300 0000  dI..Z$dJS.)Kc...
-00000160: 0000 0000 0000 0000 0000 0000 0001 0000  ................
-00000170: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
-00000180: 4e61 d805 0000 0a20 2020 2023 2066 756c  Na.....    # ful
-00000190: 6c20 7363 7265 656e 0a20 2020 2066 726f  l screen.    fro
-000001a0: 6d20 4950 7974 686f 6e2e 6469 7370 6c61  m IPython.displa
-000001b0: 7920 696d 706f 7274 2064 6973 706c 6179  y import display
-000001c0: 2c20 4854 4d4c 0a20 2020 2064 6973 706c  , HTML.    displ
-000001d0: 6179 2848 544d 4c28 223c 7374 796c 653e  ay(HTML("<style>
-000001e0: 2e63 6f6e 7461 696e 6572 207b 7769 6474  .container {widt
-000001f0: 683a 3830 253b 7d20 3c2f 7374 796c 653e  h:80%;} </style>
-00000200: 2229 2920 0a20 2020 2064 6973 706c 6179  ")) .    display
-00000210: 2848 544d 4c28 223c 7374 796c 653e 2e74  (HTML("<style>.t
-00000220: 6f63 7b20 6d61 7267 696e 2d74 6f70 3a20  oc{ margin-top: 
-00000230: 3130 3070 783b 7d20 3c2f 7374 796c 653e  100px;} </style>
-00000240: 2229 290a 0a20 2020 2023 2064 6972 0a20  "))..    # dir. 
-00000250: 2020 2069 6d70 6f72 7420 6f73 0a20 2020     import os.   
-00000260: 206f 732e 6368 6469 7228 272f 5573 6572   os.chdir('/User
-00000270: 732f 7275 6e6e 696e 677a 2f70 726f 6a65  s/runningz/proje
-00000280: 6374 2f72 756e 6e69 6e67 7a2f 2729 0a20  ct/runningz/'). 
-00000290: 2020 2070 7269 6e74 286f 732e 6765 7463     print(os.getc
-000002a0: 7764 2829 290a 0a20 2020 2023 2070 6174  wd())..    # pat
-000002b0: 680a 2020 2020 696d 706f 7274 2073 7973  h.    import sys
-000002c0: 0a20 2020 2073 7973 2e70 6174 682e 696e  .    sys.path.in
-000002d0: 7365 7274 2830 2c20 272e 2729 0a20 2020  sert(0, '.').   
-000002e0: 2073 7973 2e70 6174 682e 696e 7365 7274   sys.path.insert
-000002f0: 2830 2c20 6f73 2e70 6174 682e 6162 7370  (0, os.path.absp
-00000300: 6174 6828 272e 2e2f 2729 290a 0a20 2020  ath('../'))..   
-00000310: 2023 2062 6173 6963 0a20 2020 2069 6d70   # basic.    imp
-00000320: 6f72 7420 6f73 0a20 2020 206f 732e 656e  ort os.    os.en
-00000330: 7669 726f 6e5b 2772 7a5f 746f 6b65 6e27  viron['rz_token'
-00000340: 5d20 3d20 2738 3736 6238 3536 6632 3032  ] = '876b856f202
-00000350: 3331 3233 3127 0a20 2020 2069 6d70 6f72  31231'.    impor
-00000360: 7420 7275 6e6e 696e 677a 2061 7320 727a  t runningz as rz
-00000370: 3b20 7072 696e 7428 727a 2e5f 5f66 696c  ; print(rz.__fil
-00000380: 655f 5f2c 2072 7a2e 5f5f 7665 7273 696f  e__, rz.__versio
-00000390: 6e5f 5f29 0a20 2020 2069 6d70 6f72 7420  n__).    import 
-000003a0: 636f 7079 0a20 2020 2069 6d70 6f72 7420  copy.    import 
-000003b0: 6763 0a20 2020 2069 6d70 6f72 7420 7469  gc.    import ti
-000003c0: 6d65 0a20 2020 2069 6d70 6f72 7420 6461  me.    import da
-000003d0: 7465 7469 6d65 0a20 2020 2069 6d70 6f72  tetime.    impor
-000003e0: 7420 7363 6970 790a 2020 2020 696d 706f  t scipy.    impo
-000003f0: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00000400: 2020 2069 6d70 6f72 7420 7061 6e64 6173     import pandas
-00000410: 2061 7320 7064 0a20 2020 2069 6d70 6f72   as pd.    impor
-00000420: 7420 706f 6c61 7273 2061 7320 706c 0a20  t polars as pl. 
-00000430: 2020 2066 726f 6d20 7471 646d 2e6e 6f74     from tqdm.not
-00000440: 6562 6f6f 6b20 696d 706f 7274 2074 7164  ebook import tqd
-00000450: 6d0a 0a20 2020 2023 206d 6f64 656c 0a20  m..    # model. 
-00000460: 2020 2069 6d70 6f72 7420 6c69 6768 7467     import lightg
-00000470: 626d 2061 7320 6c67 620a 2020 2020 696d  bm as lgb.    im
-00000480: 706f 7274 2078 6762 6f6f 7374 2061 7320  port xgboost as 
-00000490: 7867 620a 2020 2020 696d 706f 7274 2063  xgb.    import c
-000004a0: 6174 626f 6f73 7420 6173 2063 6174 0a0a  atboost as cat..
-000004b0: 2020 2020 2320 706c 6f74 0a20 2020 2069      # plot.    i
-000004c0: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
-000004d0: 2e70 7970 6c6f 7420 6173 2070 6c74 0a20  .pyplot as plt. 
-000004e0: 2020 2069 6d70 6f72 7420 7365 6162 6f72     import seabor
-000004f0: 6e20 6173 2073 6e73 0a20 2020 2069 6d70  n as sns.    imp
-00000500: 6f72 7420 7761 726e 696e 6773 0a20 2020  ort warnings.   
-00000510: 2077 6172 6e69 6e67 732e 6669 6c74 6572   warnings.filter
-00000520: 7761 726e 696e 6773 2827 6967 6e6f 7265  warnings('ignore
-00000530: 2729 0a20 2020 2025 6d61 7470 6c6f 746c  ').    %matplotl
-00000540: 6962 2069 6e6c 696e 650a 2020 2020 706c  ib inline.    pl
-00000550: 742e 7263 5061 7261 6d73 5b27 6669 6775  t.rcParams['figu
-00000560: 7265 2e66 6967 7369 7a65 275d 203d 2028  re.figsize'] = (
-00000570: 3130 2c20 3529 0a20 2020 2069 6d70 6f72  10, 5).    impor
-00000580: 7420 4950 7974 686f 6e0a 2020 2020 6465  t IPython.    de
-00000590: 6620 7573 655f 7376 675f 6469 7370 6c61  f use_svg_displa
-000005a0: 7928 293a 0a20 2020 2020 2020 2049 5079  y():.        IPy
-000005b0: 7468 6f6e 2e64 6973 706c 6179 2e73 6574  thon.display.set
-000005c0: 5f6d 6174 706c 6f74 6c69 625f 666f 726d  _matplotlib_form
-000005d0: 6174 7328 2773 7667 2729 0a20 2020 2023  ats('svg').    #
-000005e0: 2075 7365 5f73 7667 5f64 6973 706c 6179   use_svg_display
-000005f0: 2829 0a0a 2020 2020 2320 7365 745f 6f70  ()..    # set_op
-00000600: 7469 6f6e 0a20 2020 2070 642e 7365 745f  tion.    pd.set_
-00000610: 6f70 7469 6f6e 2827 6469 7370 6c61 792e  option('display.
-00000620: 6d61 785f 636f 6c75 6d6e 7327 2c20 4e6f  max_columns', No
-00000630: 6e65 290a 2020 2020 7064 2e73 6574 5f6f  ne).    pd.set_o
-00000640: 7074 696f 6e28 2764 6973 706c 6179 2e6d  ption('display.m
-00000650: 6178 5f72 6f77 7327 2c20 4e6f 6e65 290a  ax_rows', None).
-00000660: 2020 2020 7064 2e73 6574 5f6f 7074 696f      pd.set_optio
-00000670: 6e28 2764 6973 706c 6179 2e77 6964 7468  n('display.width
-00000680: 272c 2031 3030 290a 2020 2020 7064 2e73  ', 100).    pd.s
-00000690: 6574 5f6f 7074 696f 6e28 2765 7870 616e  et_option('expan
-000006a0: 645f 6672 616d 655f 7265 7072 272c 2046  d_frame_repr', F
-000006b0: 616c 7365 290a 2020 2020 7064 2e73 6574  alse).    pd.set
-000006c0: 5f6f 7074 696f 6e28 2764 6973 706c 6179  _option('display
-000006d0: 2e66 6c6f 6174 5f66 6f72 6d61 7427 2c20  .float_format', 
-000006e0: 6c61 6d62 6461 2078 203a 2027 252e 3666  lambda x : '%.6f
-000006f0: 2720 2520 7829 0a20 2020 206e 702e 7365  ' % x).    np.se
-00000700: 745f 7072 696e 746f 7074 696f 6e73 2870  t_printoptions(p
-00000710: 7265 6369 7369 6f6e 3d36 2c20 7468 7265  recision=6, thre
-00000720: 7368 6f6c 643d 3130 3030 302c 206c 696e  shold=10000, lin
-00000730: 6577 6964 7468 3d31 3030 2c20 6564 6765  ewidth=100, edge
-00000740: 6974 656d 733d 3939 392c 2073 7570 7072  items=999, suppr
-00000750: 6573 733d 5472 7565 290a 2020 2020 a900  ess=True).    ..
-00000760: 7201 0000 0072 0100 0000 7201 0000 00fa  r....r....r.....
-00000770: 3862 7569 6c64 2f62 6469 7374 2e6d 6163  8build/bdist.mac
-00000780: 6f73 782d 3130 2e39 2d78 3836 5f36 342f  osx-10.9-x86_64/
-00000790: 6567 672f 7275 6e6e 696e 677a 2f75 7469  egg/runningz/uti
-000007a0: 6c2f 636f 6465 2e70 79da 0c69 6d70 6f72  l/code.py..impor
-000007b0: 745f 6261 7369 6303 0000 0073 0200 0000  t_basic....s....
-000007c0: 0001 7203 0000 0063 0000 0000 0000 0000  ..r....c........
-000007d0: 0000 0000 0000 0000 0100 0000 4300 0000  ............C...
-000007e0: 7304 0000 0064 0153 0029 024e 7a4a 0a20  s....d.S.).NzJ. 
-000007f0: 2020 2021 7069 7020 696e 7374 616c 6c20     !pip install 
-00000800: 2d69 2068 7474 7073 3a2f 2f70 7970 692e  -i https://pypi.
-00000810: 7475 6e61 2e74 7369 6e67 6875 612e 6564  tuna.tsinghua.ed
-00000820: 752e 636e 2f73 696d 706c 6520 6770 7573  u.cn/simple gpus
-00000830: 7461 740a 2020 2020 7201 0000 0072 0100  tat.    r....r..
-00000840: 0000 7201 0000 0072 0100 0000 7202 0000  ..r....r....r...
-00000850: 00da 0a70 6970 5f69 6e74 616c 6c3c 0000  ...pip_intall<..
-00000860: 0073 0200 0000 0001 7204 0000 0063 0000  .s......r....c..
-00000870: 0000 0000 0000 0000 0000 0000 0000 0100  ................
-00000880: 0000 4300 0000 7304 0000 0064 0153 0029  ..C...s....d.S.)
-00000890: 024e 610b 0200 000a 2020 2020 696d 706f  .Na.....    impo
-000008a0: 7274 206c 6f67 6769 6e67 0a20 2020 2066  rt logging.    f
-000008b0: 6f72 6d61 745f 7374 7220 3d20 2725 2861  ormat_str = '%(a
-000008c0: 7363 7469 6d65 2973 5b25 286c 6576 656c  sctime)s[%(level
-000008d0: 6e61 6d65 2973 5d25 2866 696c 656e 616d  name)s]%(filenam
-000008e0: 6529 733a 2528 6c69 6e65 6e6f 2964 202d  e)s:%(lineno)d -
-000008f0: 3e20 2528 6d65 7373 6167 6529 7327 0a20  > %(message)s'. 
-00000900: 2020 206c 6f67 6769 6e67 2e62 6173 6963     logging.basic
-00000910: 436f 6e66 6967 280a 2020 2020 2020 2020  Config(.        
-00000920: 6c65 7665 6c20 3d20 6c6f 6767 696e 672e  level = logging.
-00000930: 494e 464f 2c20 2320 6f6e 6c79 206c 6f67  INFO, # only log
-00000940: 6769 6e67 203e 3d20 6c6f 6767 696e 672e  ging >= logging.
-00000950: 494e 464f 206d 6573 7361 6765 0a20 2020  INFO message.   
-00000960: 2020 2020 2066 6f72 6d61 7420 3d20 666f       format = fo
-00000970: 726d 6174 5f73 7472 2c20 0a20 2020 2020  rmat_str, .     
-00000980: 2020 2064 6174 6566 6d74 3d27 2559 2d25     datefmt='%Y-%
-00000990: 6d2d 2564 2025 483a 254d 3a25 5327 2c20  m-%d %H:%M:%S', 
-000009a0: 0a20 2020 2020 2020 2066 696c 656e 616d  .        filenam
-000009b0: 653d 2774 6573 742e 6c6f 6727 2c20 0a20  e='test.log', . 
-000009c0: 2020 2020 2020 2023 2066 696c 656d 6f64         # filemod
-000009d0: 653d 2777 272c 0a20 2020 2020 2020 2066  e='w',.        f
-000009e0: 696c 656d 6f64 653d 2761 272c 0a20 2020  ilemode='a',.   
-000009f0: 2029 0a20 2020 206c 6f67 6765 7220 3d20   ).    logger = 
-00000a00: 6c6f 6767 696e 672e 6765 744c 6f67 6765  logging.getLogge
-00000a10: 7228 5f5f 6e61 6d65 5f5f 290a 0a0a 2020  r(__name__)...  
-00000a20: 2020 7072 696e 7428 6c6f 6767 696e 672e    print(logging.
-00000a30: 4445 4255 4729 2020 2023 2031 300a 2020  DEBUG)   # 10.  
-00000a40: 2020 7072 696e 7428 6c6f 6767 696e 672e    print(logging.
-00000a50: 494e 464f 2920 2020 2023 2032 300a 2020  INFO)    # 20.  
-00000a60: 2020 7072 696e 7428 6c6f 6767 696e 672e    print(logging.
-00000a70: 5741 524e 494e 4729 2023 2033 300a 2020  WARNING) # 30.  
-00000a80: 2020 7072 696e 7428 6c6f 6767 696e 672e    print(logging.
-00000a90: 4641 5441 4c29 2020 2023 2035 300a 2020  FATAL)   # 50.  
-00000aa0: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
-00000ab0: 0072 0100 0000 7202 0000 00da 076c 6f67  .r....r......log
-00000ac0: 6769 6e67 4100 0000 7302 0000 0000 0172  gingA...s......r
-00000ad0: 0500 0000 6300 0000 0000 0000 0000 0000  ....c...........
-00000ae0: 0000 0000 0001 0000 0043 0000 0073 0400  .........C...s..
-00000af0: 0000 6401 5300 2902 4e75 e901 0000 0a20  ..d.S.).Nu..... 
-00000b00: 2020 2070 7269 6e74 285f 5f66 696c 655f     print(__file_
-00000b10: 5f29 2023 20e5 bd93 e589 8de6 9687 e4bb  _) # ...........
-00000b20: b60a 2020 2020 696d 706f 7274 206f 7320  ..    import os 
-00000b30: 0a20 2020 2070 7269 6e74 286f 732e 6765  .    print(os.ge
-00000b40: 7463 7764 2829 2920 2320 e689 a7e8 a18c  tcwd()) # ......
-00000b50: e79a 84e4 b8bb e8b7 afe5 be84 0a20 2020  .............   
-00000b60: 2069 6d70 6f72 7420 7379 730a 2020 2020   import sys.    
-00000b70: 7072 696e 7428 7379 732e 7061 7468 290a  print(sys.path).
-00000b80: 2020 2020 696d 706f 7274 206f 730a 2020      import os.  
-00000b90: 2020 6465 6620 6765 745f 7079 5f66 696c    def get_py_fil
-00000ba0: 6573 2870 6174 6829 3a0a 2020 2020 2020  es(path):.      
-00000bb0: 2020 7079 5f66 696c 6573 203d 205b 5d0a    py_files = [].
-00000bc0: 2020 2020 2020 2020 666f 7220 726f 6f74          for root
-00000bd0: 2c20 6469 7273 2c20 6669 6c65 7320 696e  , dirs, files in
-00000be0: 206f 732e 7761 6c6b 2870 6174 6829 3a0a   os.walk(path):.
-00000bf0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00000c00: 6669 6c65 2069 6e20 6669 6c65 733a 0a20  file in files:. 
-00000c10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00000c20: 6620 6669 6c65 2e65 6e64 7377 6974 6828  f file.endswith(
-00000c30: 272e 7079 2729 3a0a 2020 2020 2020 2020  '.py'):.        
-00000c40: 2020 2020 2020 2020 2020 2020 2320 7079              # py
-00000c50: 5f66 696c 6573 2e61 7070 656e 6428 6f73  _files.append(os
-00000c60: 2e70 6174 682e 6a6f 696e 2872 6f6f 742c  .path.join(root,
-00000c70: 2066 696c 6529 290a 2020 2020 2020 2020   file)).        
-00000c80: 2020 2020 2020 2020 2020 2020 7079 5f66              py_f
-00000c90: 696c 6573 2e61 7070 656e 6428 6669 6c65  iles.append(file
-00000ca0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00000cb0: 2070 795f 6669 6c65 730a 2020 2020 7079   py_files.    py
-00000cc0: 5f66 696c 6573 203d 2067 6574 5f70 795f  _files = get_py_
-00000cd0: 6669 6c65 7328 6f73 2e67 6574 6377 6428  files(os.getcwd(
-00000ce0: 2929 0a20 2020 2072 0100 0000 7201 0000  )).    r....r...
-00000cf0: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-00000d00: da09 7761 6c6b 5f70 6174 6856 0000 0073  ..walk_pathV...s
-00000d10: 0200 0000 0001 7206 0000 0063 0000 0000  ......r....c....
-00000d20: 0000 0000 0000 0000 0000 0000 0100 0000  ................
-00000d30: 4300 0000 7304 0000 0064 0153 0029 024e  C...s....d.S.).N
-00000d40: 7a98 0a20 2020 2021 7069 7020 696e 7374  z..    !pip inst
-00000d50: 616c 6c20 7461 6275 6c61 7465 0a20 2020  all tabulate.   
-00000d60: 2066 726f 6d20 7461 6275 6c61 7465 2069   from tabulate i
-00000d70: 6d70 6f72 7420 7461 6275 6c61 7465 0a20  mport tabulate. 
-00000d80: 2020 2070 7269 6e74 2874 6162 756c 6174     print(tabulat
-00000d90: 6528 6466 5f67 702c 2068 6561 6465 7273  e(df_gp, headers
-00000da0: 203d 2064 665f 6770 2e63 6f6c 756d 6e73   = df_gp.columns
-00000db0: 2c20 7461 626c 6566 6d74 3d22 6772 6964  , tablefmt="grid
-00000dc0: 222c 2066 6c6f 6174 666d 7420 3d20 272e  ", floatfmt = '.
-00000dd0: 3466 2729 290a 2020 2020 7201 0000 0072  4f')).    r....r
-00000de0: 0100 0000 7201 0000 0072 0100 0000 7202  ....r....r....r.
-00000df0: 0000 00da 0773 686f 775f 6466 6900 0000  .....show_dfi...
-00000e00: 7302 0000 0000 0172 0700 0000 6300 0000  s......r....c...
-00000e10: 0000 0000 0000 0000 0000 0000 0001 0000  ................
-00000e20: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
-00000e30: 4e7a 530a 2020 2020 2020 2020 7761 7463  NzS.        watc
-00000e40: 6820 2263 6174 202f 7072 6f63 2f63 7075  h "cat /proc/cpu
-00000e50: 696e 666f 207c 2067 7265 7020 2d69 204d  info | grep -i M
-00000e60: 487a 207c 206e 6c20 7c20 736f 7274 202d  Hz | nl | sort -
-00000e70: 726b 3320 7c20 6865 6164 202d 6e20 3332  rk3 | head -n 32
-00000e80: 220a 2020 2020 7201 0000 0072 0100 0000  ".    r....r....
-00000e90: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
-00000ea0: 0873 686f 775f 6370 7570 0000 0073 0200  .show_cpup...s..
-00000eb0: 0000 0001 7208 0000 0063 0000 0000 0000  ....r....c......
-00000ec0: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
-00000ed0: 0000 7304 0000 0064 0153 0029 024e 61b3  ..s....d.S.).Na.
-00000ee0: 0200 000a 6672 6f6d 2073 6b6c 6561 726e  ....from sklearn
-00000ef0: 2e6c 696e 6561 725f 6d6f 6465 6c20 696d  .linear_model im
-00000f00: 706f 7274 204c 696e 6561 7252 6567 7265  port LinearRegre
-00000f10: 7373 696f 6e0a 696d 706f 7274 206e 756d  ssion.import num
-00000f20: 7079 2061 7320 6e70 0a6e 702e 7261 6e64  py as np.np.rand
-00000f30: 6f6d 2e73 6565 6428 3432 290a 0a58 203d  om.seed(42)..X =
-00000f40: 206e 702e 7261 6e64 6f6d 2e72 616e 6428   np.random.rand(
-00000f50: 3530 3030 2c20 3130 290a 7920 3d20 6e70  5000, 10).y = np
-00000f60: 2e72 616e 646f 6d2e 7261 6e64 2835 3030  .random.rand(500
-00000f70: 3029 0a23 2058 5b3a 2c20 305d 203d 2031  0).# X[:, 0] = 1
-00000f80: 0a0a 7265 6720 3d20 4c69 6e65 6172 5265  ..reg = LinearRe
-00000f90: 6772 6573 7369 6f6e 2866 6974 5f69 6e74  gression(fit_int
-00000fa0: 6572 6365 7074 203d 2046 616c 7365 292e  ercept = False).
-00000fb0: 6669 7428 582c 2079 290a 5720 3d20 7265  fit(X, y).W = re
-00000fc0: 672e 636f 6566 5f0a 5b6e 702e 636f 7628  g.coef_.[np.cov(
-00000fd0: 7920 2d20 5820 4020 572c 2058 5b3a 2c20  y - X @ W, X[:, 
-00000fe0: 695d 295b 302c 2031 5d20 666f 7220 6920  i])[0, 1] for i 
-00000ff0: 696e 2072 616e 6765 2858 2e73 6861 7065  in range(X.shape
-00001000: 5b31 5d29 5d20 2320 6e6f 7420 7a65 726f  [1])] # not zero
-00001010: 0a0a 2320 7265 6720 3d20 4c69 6e65 6172  ..# reg = Linear
-00001020: 5265 6772 6573 7369 6f6e 2866 6974 5f69  Regression(fit_i
-00001030: 6e74 6572 6365 7074 203d 2054 7275 6529  ntercept = True)
-00001040: 2e66 6974 2858 2c20 7929 0a23 2057 203d  .fit(X, y).# W =
-00001050: 2072 6567 2e63 6f65 665f 0a23 205b 6e70   reg.coef_.# [np
-00001060: 2e63 6f76 2879 202d 2058 2e64 6f74 2857  .cov(y - X.dot(W
-00001070: 292c 2058 5b3a 2c20 695d 295b 302c 2031  ), X[:, i])[0, 1
-00001080: 5d20 666f 7220 6920 696e 2072 616e 6765  ] for i in range
-00001090: 2858 2e73 6861 7065 5b31 5d29 5d20 2320  (X.shape[1])] # 
-000010a0: 7a65 726f 0a0a 2320 5820 3d20 2858 202d  zero..# X = (X -
-000010b0: 2058 2e6d 6561 6e28 6178 6973 2020 3d20   X.mean(axis  = 
-000010c0: 302c 206b 6565 7064 696d 7320 3d20 5472  0, keepdims = Tr
-000010d0: 7565 2929 202f 2020 582e 7374 6428 6178  ue)) /  X.std(ax
-000010e0: 6973 2020 3d20 302c 206b 6565 7064 696d  is  = 0, keepdim
-000010f0: 7320 3d20 5472 7565 290a 2320 7265 6720  s = True).# reg 
-00001100: 3d20 4c69 6e65 6172 5265 6772 6573 7369  = LinearRegressi
-00001110: 6f6e 2866 6974 5f69 6e74 6572 6365 7074  on(fit_intercept
-00001120: 203d 2046 616c 7365 292e 6669 7428 582c   = False).fit(X,
-00001130: 2079 290a 2320 5720 3d20 7265 672e 636f   y).# W = reg.co
-00001140: 6566 5f0a 2320 5b6e 702e 636f 7628 7920  ef_.# [np.cov(y 
-00001150: 2d20 582e 646f 7428 5729 2c20 585b 3a2c  - X.dot(W), X[:,
-00001160: 2069 5d29 5b30 2c20 315d 2066 6f72 2069   i])[0, 1] for i
-00001170: 2069 6e20 7261 6e67 6528 582e 7368 6170   in range(X.shap
-00001180: 655b 315d 295d 2023 207a 6572 6f20 2020  e[1])] # zero   
-00001190: 200a 2020 2020 7201 0000 0072 0100 0000   .    r....r....
-000011a0: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
-000011b0: 0867 6574 5f72 6573 6475 0000 0073 0200  .get_resdu...s..
-000011c0: 0000 0001 7209 0000 0063 0000 0000 0000  ....r....c......
-000011d0: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
-000011e0: 0000 7304 0000 0064 0153 0029 024e 7532  ..s....d.S.).Nu2
-000011f0: 0300 000a 696d 706f 7274 206f 730a 696d  ....import os.im
-00001200: 706f 7274 2073 6875 7469 6c0a 0a64 6566  port shutil..def
-00001210: 2073 6370 5f67 7265 7028 7372 632c 2064   scp_grep(src, d
-00001220: 7374 293a 0a20 2020 2066 6f72 2072 6f6f  st):.    for roo
-00001230: 742c 2064 6972 732c 2066 696c 6573 2069  t, dirs, files i
-00001240: 6e20 6f73 2e77 616c 6b28 7372 632c 2074  n os.walk(src, t
-00001250: 6f70 646f 776e 203d 2054 7275 6529 3a0a  opdown = True):.
-00001260: 2020 2020 2020 2020 7265 6c5f 6469 7220          rel_dir 
-00001270: 3d20 6f73 2e70 6174 682e 7265 6c70 6174  = os.path.relpat
-00001280: 6828 726f 6f74 2c20 7372 6329 0a20 2020  h(root, src).   
-00001290: 2020 2020 2064 7374 5f64 6972 203d 206f       dst_dir = o
-000012a0: 732e 7061 7468 2e6a 6f69 6e28 6473 742c  s.path.join(dst,
-000012b0: 2072 656c 5f64 6972 290a 2020 2020 2020   rel_dir).      
-000012c0: 2020 0a20 2020 2020 2020 2069 6620 6e6f    .        if no
-000012d0: 7420 6f73 2e70 6174 682e 6578 6973 7473  t os.path.exists
-000012e0: 2864 7374 5f64 6972 293a 0a20 2020 2020  (dst_dir):.     
-000012f0: 2020 2020 2020 2069 6620 2746 4954 2720         if 'FIT' 
-00001300: 6e6f 7420 696e 2064 7374 5f64 6972 3a20  not in dst_dir: 
-00001310: 636f 6e74 696e 7565 3b20 2320 6578 636c  continue; # excl
-00001320: 7564 650a 2020 2020 2020 2020 2020 2020  ude.            
-00001330: 6f73 2e6d 616b 6564 6972 7328 6473 745f  os.makedirs(dst_
-00001340: 6469 722c 2065 7869 7374 5f6f 6b20 3d20  dir, exist_ok = 
-00001350: 5472 7565 290a 2020 2020 2020 2020 0a20  True).        . 
-00001360: 2020 2020 2020 2066 6f72 2066 696c 6520         for file 
-00001370: 696e 2066 696c 6573 3a0a 2020 2020 2020  in files:.      
-00001380: 2020 2020 2020 7372 635f 6469 725f 6669        src_dir_fi
-00001390: 6c65 203d 206f 732e 7061 7468 2e6a 6f69  le = os.path.joi
-000013a0: 6e28 726f 6f74 2c20 6669 6c65 290a 2020  n(root, file).  
-000013b0: 2020 2020 2020 2020 2020 6966 2027 4649            if 'FI
-000013c0: 5427 206e 6f74 2069 6e20 7372 635f 6469  T' not in src_di
-000013d0: 725f 6669 6c65 3a20 636f 6e74 696e 7565  r_file: continue
-000013e0: 3b20 2320 6578 636c 7564 650a 2020 2020  ; # exclude.    
-000013f0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00001400: 2020 2020 2020 2020 2064 7374 5f64 6972           dst_dir
-00001410: 5f66 696c 6520 3d20 6f73 2e70 6174 682e  _file = os.path.
-00001420: 6a6f 696e 2864 7374 5f64 6972 2c20 6669  join(dst_dir, fi
-00001430: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-00001440: 6966 206e 6f74 206f 732e 7061 7468 2e65  if not os.path.e
-00001450: 7869 7374 7328 6473 745f 6469 725f 6669  xists(dst_dir_fi
-00001460: 6c65 293a 2020 2320 e5a6 82e6 9e9c e696  le):  # ........
-00001470: 87e4 bbb6 e4b8 8de5 ad98 e59c a8ef bc8c  ................
-00001480: e588 99e5 a48d e588 b60a 2020 2020 2020  ..........      
-00001490: 2020 2020 2020 2020 2020 7368 7574 696c            shutil
-000014a0: 2e63 6f70 7928 7372 635f 6469 725f 6669  .copy(src_dir_fi
-000014b0: 6c65 2c20 6473 745f 6469 725f 6669 6c65  le, dst_dir_file
-000014c0: 290a 0a73 7263 203d 2027 2f68 6f6d 652f  )..src = '/home/
-000014d0: 7278 2f70 726f 6a65 6374 5f30 3430 342f  rx/project_0404/
-000014e0: 7069 7065 6c69 6e65 2f6f 7574 7075 7427  pipeline/output'
-000014f0: 0a64 7374 203d 2027 2f68 6f6d 652f 7075  .dst = '/home/pu
-00001500: 626c 6963 2f72 6573 756c 742f 6861 6861  blic/result/haha
-00001510: 270a 7363 705f 6772 6570 2873 7263 2c20  '.scp_grep(src, 
-00001520: 6473 7429 0a72 0100 0000 7201 0000 0072  dst).r....r....r
-00001530: 0100 0000 7201 0000 0072 0200 0000 da09  ....r....r......
-00001540: 636f 7079 5f67 7265 708d 0000 0073 0200  copy_grep....s..
-00001550: 0000 0001 720a 0000 0063 0000 0000 0000  ....r....c......
-00001560: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
-00001570: 0000 7304 0000 0064 0153 0029 024e 61c6  ..s....d.S.).Na.
-00001580: 0300 000a 2020 2020 696d 706f 7274 2073  ....    import s
-00001590: 7973 0a20 2020 2073 7973 2e61 7267 7620  ys.    sys.argv 
-000015a0: 3d20 5b0a 2020 2020 2020 2020 276d 6169  = [.        'mai
-000015b0: 6e2e 7079 272c 200a 2020 2020 2020 2020  n.py', .        
-000015c0: 276c 6762 272c 200a 2020 2020 2020 2020  'lgb', .        
-000015d0: 272d 2d6c 6162 656c 272c 2027 6c61 6265  '--label', 'labe
-000015e0: 6c2e 6e70 7927 2c20 0a20 2020 2020 2020  l.npy', .       
-000015f0: 2027 2d2d 6e61 6d65 272c 2027 4e41 4d45   '--name', 'NAME
-00001600: 272c 200a 2020 2020 2020 2020 272d 2d6c  ', .        '--l
-00001610: 7227 2c20 2730 2e31 272c 200a 2020 2020  r', '0.1', .    
-00001620: 2020 2020 272d 2d6e 5f62 6f6f 7374 272c      '--n_boost',
-00001630: 2027 3130 3027 2c0a 2020 2020 2020 2020   '100',.        
-00001640: 272d 2d64 6562 7567 272c 2023 2731 272c  '--debug', #'1',
-00001650: 2732 272c 0a20 2020 2020 2020 2027 2d2d  '2',.        '--
-00001660: 6c61 7374 272c 2027 4c41 5354 272c 0a20  last', 'LAST',. 
-00001670: 2020 205d 0a0a 2020 2020 696d 706f 7274     ]..    import
-00001680: 2061 7267 7061 7273 650a 2020 2020 7061   argparse.    pa
-00001690: 7273 6572 203d 2061 7267 7061 7273 652e  rser = argparse.
-000016a0: 4172 6775 6d65 6e74 5061 7273 6572 2829  ArgumentParser()
-000016b0: 0a20 2020 2070 6172 7365 722e 6164 645f  .    parser.add_
-000016c0: 6172 6775 6d65 6e74 2827 6273 7427 2c20  argument('bst', 
-000016d0: 6368 6f69 6365 733d 5b27 6c67 6227 2c20  choices=['lgb', 
-000016e0: 2778 6762 272c 2027 6361 7427 5d29 2023  'xgb', 'cat']) #
-000016f0: 206f 7264 6572 200a 2020 2020 7061 7273   order .    pars
-00001700: 6572 2e61 6464 5f61 7267 756d 656e 7428  er.add_argument(
-00001710: 272d 2d6c 6162 656c 272c 2074 7970 6520  '--label', type 
-00001720: 3d20 7374 722c 2072 6571 7569 7265 643d  = str, required=
-00001730: 5472 7565 2920 2320 7265 7175 6972 6564  True) # required
-00001740: 0a20 2020 2070 6172 7365 722e 6164 645f  .    parser.add_
-00001750: 6172 6775 6d65 6e74 2827 2d2d 6e61 6d65  argument('--name
-00001760: 272c 2074 7970 653d 7374 722c 2064 6566  ', type=str, def
-00001770: 6175 6c74 3d27 6465 6275 6727 2920 2023  ault='debug')  #
-00001780: 2073 7472 0a20 2020 2070 6172 7365 722e   str.    parser.
-00001790: 6164 645f 6172 6775 6d65 6e74 2827 2d2d  add_argument('--
-000017a0: 6c72 272c 2074 7970 653d 666c 6f61 742c  lr', type=float,
-000017b0: 2064 6566 6175 6c74 3d30 2e30 3129 2020   default=0.01)  
-000017c0: 2020 2023 2066 6c6f 6174 0a20 2020 2070     # float.    p
-000017d0: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
-000017e0: 6e74 2827 2d2d 6e5f 626f 6f73 7427 2c20  nt('--n_boost', 
-000017f0: 7479 7065 3d69 6e74 2c20 6465 6661 756c  type=int, defaul
-00001800: 743d 3130 3030 2920 2023 2069 6e74 0a20  t=1000)  # int. 
-00001810: 2020 2070 6172 7365 722e 6164 645f 6172     parser.add_ar
-00001820: 6775 6d65 6e74 2827 2d2d 6465 6275 6727  gument('--debug'
-00001830: 2c20 6e61 7267 733d 272a 272c 2064 6566  , nargs='*', def
-00001840: 6175 6c74 3d5b 5d2c 2068 656c 703d 2768  ault=[], help='h
-00001850: 656c 7020 696e 666f 2729 2023 2061 6e79  elp info') # any
-00001860: 206e 756d 6265 7220 6f66 0a20 2020 2070   number of.    p
-00001870: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
-00001880: 6e74 2827 2d2d 6c61 7374 272c 2074 7970  nt('--last', typ
-00001890: 653d 7374 722c 2064 6566 6175 6c74 3d27  e=str, default='
-000018a0: 6c61 7374 2729 0a20 2020 2061 7267 7320  last').    args 
-000018b0: 3d20 7061 7273 6572 2e70 6172 7365 5f61  = parser.parse_a
-000018c0: 7267 7328 290a 2020 2020 7072 696e 7428  rgs().    print(
-000018d0: 6172 6773 290a 2020 2020 2320 4e61 6d65  args).    # Name
-000018e0: 7370 6163 6528 6273 743d 276c 6762 272c  space(bst='lgb',
-000018f0: 206c 6162 656c 3d27 6c61 6265 6c2e 6e70   label='label.np
-00001900: 7927 2c20 6e61 6d65 3d27 4e41 4d45 272c  y', name='NAME',
-00001910: 206c 723d 302e 312c 206e 5f62 6f6f 7374   lr=0.1, n_boost
-00001920: 3d31 3030 2c20 6465 6275 673d 5b27 3127  =100, debug=['1'
-00001930: 2c20 2732 275d 2c20 6c61 7374 3d27 4c41  , '2'], last='LA
-00001940: 5354 2729 0a20 2020 2072 0100 0000 7201  ST').    r....r.
-00001950: 0000 0072 0100 0000 7201 0000 0072 0200  ...r....r....r..
-00001960: 0000 da0a 7061 7273 655f 6172 6773 a900  ....parse_args..
-00001970: 0000 7302 0000 0000 0172 0b00 0000 6300  ..s......r....c.
-00001980: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-00001990: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
-000019a0: 2902 4e61 c30a 0000 0a20 2020 2070 6174  ).Na.....    pat
-000019b0: 685f 696e 7075 7420 3d20 272e 2e2e 270a  h_input = '...'.
-000019c0: 2020 2020 6461 7461 5f6e 616d 6520 3d20      data_name = 
-000019d0: 2764 6174 612e 6e70 7927 0a20 2020 206d  'data.npy'.    m
-000019e0: 6173 6b5f 6e61 6d65 203d 2027 6d61 736b  ask_name = 'mask
-000019f0: 2e6e 7079 270a 2020 2020 7061 7468 5f6c  .npy'.    path_l
-00001a00: 6162 656c 203d 2066 277b 7061 7468 5f69  abel = f'{path_i
-00001a10: 6e70 7574 7d2f 6c61 6265 6c73 2e6e 7079  nput}/labels.npy
-00001a20: 270a 2020 2020 7472 6169 6e5f 7031 7032  '.    train_p1p2
-00001a30: 203d 205b 302c 2033 305d 0a20 2020 2074   = [0, 30].    t
-00001a40: 6573 745f 7031 7032 203d 205b 3330 2c20  est_p1p2 = [30, 
-00001a50: 3530 5d0a 2020 2020 7061 6464 696e 6720  50].    padding 
-00001a60: 3d20 310a 0a20 2020 2023 2070 6164 6469  = 1..    # paddi
-00001a70: 6e67 2061 6e64 2070 3170 320a 2020 2020  ng and p1p2.    
-00001a80: 6966 2070 6164 6469 6e67 203d 3d20 313a  if padding == 1:
-00001a90: 0a20 2020 2020 2020 2079 5f69 6478 203d  .        y_idx =
-00001aa0: 2030 0a20 2020 2065 6c69 6620 7061 6464   0.    elif padd
-00001ab0: 696e 6720 3d3d 2035 3a0a 2020 2020 2020  ing == 5:.      
-00001ac0: 2020 795f 6964 7820 3d20 310a 2020 2020    y_idx = 1.    
-00001ad0: 656c 6966 2070 6164 6469 6e67 203d 3d20  elif padding == 
-00001ae0: 3230 3a0a 2020 2020 2020 2020 795f 6964  20:.        y_id
-00001af0: 7820 3d20 320a 2020 2020 7472 6169 6e5f  x = 2.    train_
-00001b00: 7031 7032 5b31 5d20 2d3d 2070 6164 6469  p1p2[1] -= paddi
-00001b10: 6e67 0a20 2020 2074 7261 696e 5f70 3170  ng.    train_p1p
-00001b20: 3220 3d20 5b78 2025 206e 2066 6f72 2078  2 = [x % n for x
-00001b30: 2069 6e20 7472 6169 6e5f 7031 7032 5d0a   in train_p1p2].
-00001b40: 2020 2020 7465 7374 5f70 3170 3220 3d20      test_p1p2 = 
-00001b50: 5b78 2025 206e 2066 6f72 2078 2069 6e20  [x % n for x in 
-00001b60: 7465 7374 5f70 3170 325d 0a20 2020 2069  test_p1p2].    i
-00001b70: 6620 7465 7374 5f70 3170 325b 315d 203d  f test_p1p2[1] =
-00001b80: 3d20 303a 2074 6573 745f 7031 7032 5b31  = 0: test_p1p2[1
-00001b90: 5d20 3d20 6e0a 2020 2020 7472 6169 6e5f  ] = n.    train_
-00001ba0: 7031 7032 5b30 5d20 3d20 6d61 7828 302c  p1p2[0] = max(0,
-00001bb0: 2074 7261 696e 5f70 3170 325b 305d 290a   train_p1p2[0]).
-00001bc0: 0a20 2020 2023 2064 6174 6120 7368 6170  .    # data shap
-00001bd0: 650a 2020 2020 7072 696e 7428 275b 2b5d  e.    print('[+]
-00001be0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00001bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d20  --------------- 
-00001c00: 696e 666f 202d 2d2d 2d2d 2d2d 2d2d 2d2d  info -----------
+00000150: 6449 8400 5a24 644a 644b 8400 5a25 644c  dI..Z$dJdK..Z%dL
+00000160: 5300 294d 6300 0000 0000 0000 0000 0000  S.)Mc...........
+00000170: 0000 0000 0001 0000 0043 0000 0073 0400  .........C...s..
+00000180: 0000 6401 5300 2902 4e61 d805 0000 0a20  ..d.S.).Na..... 
+00000190: 2020 2023 2066 756c 6c20 7363 7265 656e     # full screen
+000001a0: 0a20 2020 2066 726f 6d20 4950 7974 686f  .    from IPytho
+000001b0: 6e2e 6469 7370 6c61 7920 696d 706f 7274  n.display import
+000001c0: 2064 6973 706c 6179 2c20 4854 4d4c 0a20   display, HTML. 
+000001d0: 2020 2064 6973 706c 6179 2848 544d 4c28     display(HTML(
+000001e0: 223c 7374 796c 653e 2e63 6f6e 7461 696e  "<style>.contain
+000001f0: 6572 207b 7769 6474 683a 3830 253b 7d20  er {width:80%;} 
+00000200: 3c2f 7374 796c 653e 2229 2920 0a20 2020  </style>")) .   
+00000210: 2064 6973 706c 6179 2848 544d 4c28 223c   display(HTML("<
+00000220: 7374 796c 653e 2e74 6f63 7b20 6d61 7267  style>.toc{ marg
+00000230: 696e 2d74 6f70 3a20 3130 3070 783b 7d20  in-top: 100px;} 
+00000240: 3c2f 7374 796c 653e 2229 290a 0a20 2020  </style>"))..   
+00000250: 2023 2064 6972 0a20 2020 2069 6d70 6f72   # dir.    impor
+00000260: 7420 6f73 0a20 2020 206f 732e 6368 6469  t os.    os.chdi
+00000270: 7228 272f 5573 6572 732f 7275 6e6e 696e  r('/Users/runnin
+00000280: 677a 2f70 726f 6a65 6374 2f72 756e 6e69  gz/project/runni
+00000290: 6e67 7a2f 2729 0a20 2020 2070 7269 6e74  ngz/').    print
+000002a0: 286f 732e 6765 7463 7764 2829 290a 0a20  (os.getcwd()).. 
+000002b0: 2020 2023 2070 6174 680a 2020 2020 696d     # path.    im
+000002c0: 706f 7274 2073 7973 0a20 2020 2073 7973  port sys.    sys
+000002d0: 2e70 6174 682e 696e 7365 7274 2830 2c20  .path.insert(0, 
+000002e0: 272e 2729 0a20 2020 2073 7973 2e70 6174  '.').    sys.pat
+000002f0: 682e 696e 7365 7274 2830 2c20 6f73 2e70  h.insert(0, os.p
+00000300: 6174 682e 6162 7370 6174 6828 272e 2e2f  ath.abspath('../
+00000310: 2729 290a 0a20 2020 2023 2062 6173 6963  '))..    # basic
+00000320: 0a20 2020 2069 6d70 6f72 7420 6f73 0a20  .    import os. 
+00000330: 2020 206f 732e 656e 7669 726f 6e5b 2772     os.environ['r
+00000340: 7a5f 746f 6b65 6e27 5d20 3d20 2738 3736  z_token'] = '876
+00000350: 6238 3536 6632 3032 3331 3233 3127 0a20  b856f20231231'. 
+00000360: 2020 2069 6d70 6f72 7420 7275 6e6e 696e     import runnin
+00000370: 677a 2061 7320 727a 3b20 7072 696e 7428  gz as rz; print(
+00000380: 727a 2e5f 5f66 696c 655f 5f2c 2072 7a2e  rz.__file__, rz.
+00000390: 5f5f 7665 7273 696f 6e5f 5f29 0a20 2020  __version__).   
+000003a0: 2069 6d70 6f72 7420 636f 7079 0a20 2020   import copy.   
+000003b0: 2069 6d70 6f72 7420 6763 0a20 2020 2069   import gc.    i
+000003c0: 6d70 6f72 7420 7469 6d65 0a20 2020 2069  mport time.    i
+000003d0: 6d70 6f72 7420 6461 7465 7469 6d65 0a20  mport datetime. 
+000003e0: 2020 2069 6d70 6f72 7420 7363 6970 790a     import scipy.
+000003f0: 2020 2020 696d 706f 7274 206e 756d 7079      import numpy
+00000400: 2061 7320 6e70 0a20 2020 2069 6d70 6f72   as np.    impor
+00000410: 7420 7061 6e64 6173 2061 7320 7064 0a20  t pandas as pd. 
+00000420: 2020 2069 6d70 6f72 7420 706f 6c61 7273     import polars
+00000430: 2061 7320 706c 0a20 2020 2066 726f 6d20   as pl.    from 
+00000440: 7471 646d 2e6e 6f74 6562 6f6f 6b20 696d  tqdm.notebook im
+00000450: 706f 7274 2074 7164 6d0a 0a20 2020 2023  port tqdm..    #
+00000460: 206d 6f64 656c 0a20 2020 2069 6d70 6f72   model.    impor
+00000470: 7420 6c69 6768 7467 626d 2061 7320 6c67  t lightgbm as lg
+00000480: 620a 2020 2020 696d 706f 7274 2078 6762  b.    import xgb
+00000490: 6f6f 7374 2061 7320 7867 620a 2020 2020  oost as xgb.    
+000004a0: 696d 706f 7274 2063 6174 626f 6f73 7420  import catboost 
+000004b0: 6173 2063 6174 0a0a 2020 2020 2320 706c  as cat..    # pl
+000004c0: 6f74 0a20 2020 2069 6d70 6f72 7420 6d61  ot.    import ma
+000004d0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+000004e0: 6173 2070 6c74 0a20 2020 2069 6d70 6f72  as plt.    impor
+000004f0: 7420 7365 6162 6f72 6e20 6173 2073 6e73  t seaborn as sns
+00000500: 0a20 2020 2069 6d70 6f72 7420 7761 726e  .    import warn
+00000510: 696e 6773 0a20 2020 2077 6172 6e69 6e67  ings.    warning
+00000520: 732e 6669 6c74 6572 7761 726e 696e 6773  s.filterwarnings
+00000530: 2827 6967 6e6f 7265 2729 0a20 2020 2025  ('ignore').    %
+00000540: 6d61 7470 6c6f 746c 6962 2069 6e6c 696e  matplotlib inlin
+00000550: 650a 2020 2020 706c 742e 7263 5061 7261  e.    plt.rcPara
+00000560: 6d73 5b27 6669 6775 7265 2e66 6967 7369  ms['figure.figsi
+00000570: 7a65 275d 203d 2028 3130 2c20 3529 0a20  ze'] = (10, 5). 
+00000580: 2020 2069 6d70 6f72 7420 4950 7974 686f     import IPytho
+00000590: 6e0a 2020 2020 6465 6620 7573 655f 7376  n.    def use_sv
+000005a0: 675f 6469 7370 6c61 7928 293a 0a20 2020  g_display():.   
+000005b0: 2020 2020 2049 5079 7468 6f6e 2e64 6973       IPython.dis
+000005c0: 706c 6179 2e73 6574 5f6d 6174 706c 6f74  play.set_matplot
+000005d0: 6c69 625f 666f 726d 6174 7328 2773 7667  lib_formats('svg
+000005e0: 2729 0a20 2020 2023 2075 7365 5f73 7667  ').    # use_svg
+000005f0: 5f64 6973 706c 6179 2829 0a0a 2020 2020  _display()..    
+00000600: 2320 7365 745f 6f70 7469 6f6e 0a20 2020  # set_option.   
+00000610: 2070 642e 7365 745f 6f70 7469 6f6e 2827   pd.set_option('
+00000620: 6469 7370 6c61 792e 6d61 785f 636f 6c75  display.max_colu
+00000630: 6d6e 7327 2c20 4e6f 6e65 290a 2020 2020  mns', None).    
+00000640: 7064 2e73 6574 5f6f 7074 696f 6e28 2764  pd.set_option('d
+00000650: 6973 706c 6179 2e6d 6178 5f72 6f77 7327  isplay.max_rows'
+00000660: 2c20 4e6f 6e65 290a 2020 2020 7064 2e73  , None).    pd.s
+00000670: 6574 5f6f 7074 696f 6e28 2764 6973 706c  et_option('displ
+00000680: 6179 2e77 6964 7468 272c 2031 3030 290a  ay.width', 100).
+00000690: 2020 2020 7064 2e73 6574 5f6f 7074 696f      pd.set_optio
+000006a0: 6e28 2765 7870 616e 645f 6672 616d 655f  n('expand_frame_
+000006b0: 7265 7072 272c 2046 616c 7365 290a 2020  repr', False).  
+000006c0: 2020 7064 2e73 6574 5f6f 7074 696f 6e28    pd.set_option(
+000006d0: 2764 6973 706c 6179 2e66 6c6f 6174 5f66  'display.float_f
+000006e0: 6f72 6d61 7427 2c20 6c61 6d62 6461 2078  ormat', lambda x
+000006f0: 203a 2027 252e 3666 2720 2520 7829 0a20   : '%.6f' % x). 
+00000700: 2020 206e 702e 7365 745f 7072 696e 746f     np.set_printo
+00000710: 7074 696f 6e73 2870 7265 6369 7369 6f6e  ptions(precision
+00000720: 3d36 2c20 7468 7265 7368 6f6c 643d 3130  =6, threshold=10
+00000730: 3030 302c 206c 696e 6577 6964 7468 3d31  000, linewidth=1
+00000740: 3030 2c20 6564 6765 6974 656d 733d 3939  00, edgeitems=99
+00000750: 392c 2073 7570 7072 6573 733d 5472 7565  9, suppress=True
+00000760: 290a 2020 2020 a900 7201 0000 0072 0100  ).    ..r....r..
+00000770: 0000 7201 0000 00fa 3862 7569 6c64 2f62  ..r.....8build/b
+00000780: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
+00000790: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
+000007a0: 696e 677a 2f75 7469 6c2f 636f 6465 2e70  ingz/util/code.p
+000007b0: 79da 0c69 6d70 6f72 745f 6261 7369 6303  y..import_basic.
+000007c0: 0000 0073 0200 0000 0001 7203 0000 0063  ...s......r....c
+000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000007e0: 0100 0000 4300 0000 7304 0000 0064 0153  ....C...s....d.S
+000007f0: 0029 024e 7a4a 0a20 2020 2021 7069 7020  .).NzJ.    !pip 
+00000800: 696e 7374 616c 6c20 2d69 2068 7474 7073  install -i https
+00000810: 3a2f 2f70 7970 692e 7475 6e61 2e74 7369  ://pypi.tuna.tsi
+00000820: 6e67 6875 612e 6564 752e 636e 2f73 696d  nghua.edu.cn/sim
+00000830: 706c 6520 6770 7573 7461 740a 2020 2020  ple gpustat.    
+00000840: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
+00000850: 0100 0000 7202 0000 00da 0a70 6970 5f69  ....r......pip_i
+00000860: 6e74 616c 6c3c 0000 0073 0200 0000 0001  ntall<...s......
+00000870: 7204 0000 0063 0000 0000 0000 0000 0000  r....c..........
+00000880: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
+00000890: 0000 0064 0153 0029 024e 610b 0200 000a  ...d.S.).Na.....
+000008a0: 2020 2020 696d 706f 7274 206c 6f67 6769      import loggi
+000008b0: 6e67 0a20 2020 2066 6f72 6d61 745f 7374  ng.    format_st
+000008c0: 7220 3d20 2725 2861 7363 7469 6d65 2973  r = '%(asctime)s
+000008d0: 5b25 286c 6576 656c 6e61 6d65 2973 5d25  [%(levelname)s]%
+000008e0: 2866 696c 656e 616d 6529 733a 2528 6c69  (filename)s:%(li
+000008f0: 6e65 6e6f 2964 202d 3e20 2528 6d65 7373  neno)d -> %(mess
+00000900: 6167 6529 7327 0a20 2020 206c 6f67 6769  age)s'.    loggi
+00000910: 6e67 2e62 6173 6963 436f 6e66 6967 280a  ng.basicConfig(.
+00000920: 2020 2020 2020 2020 6c65 7665 6c20 3d20          level = 
+00000930: 6c6f 6767 696e 672e 494e 464f 2c20 2320  logging.INFO, # 
+00000940: 6f6e 6c79 206c 6f67 6769 6e67 203e 3d20  only logging >= 
+00000950: 6c6f 6767 696e 672e 494e 464f 206d 6573  logging.INFO mes
+00000960: 7361 6765 0a20 2020 2020 2020 2066 6f72  sage.        for
+00000970: 6d61 7420 3d20 666f 726d 6174 5f73 7472  mat = format_str
+00000980: 2c20 0a20 2020 2020 2020 2064 6174 6566  , .        datef
+00000990: 6d74 3d27 2559 2d25 6d2d 2564 2025 483a  mt='%Y-%m-%d %H:
+000009a0: 254d 3a25 5327 2c20 0a20 2020 2020 2020  %M:%S', .       
+000009b0: 2066 696c 656e 616d 653d 2774 6573 742e   filename='test.
+000009c0: 6c6f 6727 2c20 0a20 2020 2020 2020 2023  log', .        #
+000009d0: 2066 696c 656d 6f64 653d 2777 272c 0a20   filemode='w',. 
+000009e0: 2020 2020 2020 2066 696c 656d 6f64 653d         filemode=
+000009f0: 2761 272c 0a20 2020 2029 0a20 2020 206c  'a',.    ).    l
+00000a00: 6f67 6765 7220 3d20 6c6f 6767 696e 672e  ogger = logging.
+00000a10: 6765 744c 6f67 6765 7228 5f5f 6e61 6d65  getLogger(__name
+00000a20: 5f5f 290a 0a0a 2020 2020 7072 696e 7428  __)...    print(
+00000a30: 6c6f 6767 696e 672e 4445 4255 4729 2020  logging.DEBUG)  
+00000a40: 2023 2031 300a 2020 2020 7072 696e 7428   # 10.    print(
+00000a50: 6c6f 6767 696e 672e 494e 464f 2920 2020  logging.INFO)   
+00000a60: 2023 2032 300a 2020 2020 7072 696e 7428   # 20.    print(
+00000a70: 6c6f 6767 696e 672e 5741 524e 494e 4729  logging.WARNING)
+00000a80: 2023 2033 300a 2020 2020 7072 696e 7428   # 30.    print(
+00000a90: 6c6f 6767 696e 672e 4641 5441 4c29 2020  logging.FATAL)  
+00000aa0: 2023 2035 300a 2020 2020 7201 0000 0072   # 50.    r....r
+00000ab0: 0100 0000 7201 0000 0072 0100 0000 7202  ....r....r....r.
+00000ac0: 0000 00da 076c 6f67 6769 6e67 4100 0000  .....loggingA...
+00000ad0: 7302 0000 0000 0172 0500 0000 6300 0000  s......r....c...
+00000ae0: 0000 0000 0000 0000 0000 0000 0001 0000  ................
+00000af0: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
+00000b00: 4e75 e901 0000 0a20 2020 2070 7269 6e74  Nu.....    print
+00000b10: 285f 5f66 696c 655f 5f29 2023 20e5 bd93  (__file__) # ...
+00000b20: e589 8de6 9687 e4bb b60a 2020 2020 696d  ..........    im
+00000b30: 706f 7274 206f 7320 0a20 2020 2070 7269  port os .    pri
+00000b40: 6e74 286f 732e 6765 7463 7764 2829 2920  nt(os.getcwd()) 
+00000b50: 2320 e689 a7e8 a18c e79a 84e4 b8bb e8b7  # ..............
+00000b60: afe5 be84 0a20 2020 2069 6d70 6f72 7420  .....    import 
+00000b70: 7379 730a 2020 2020 7072 696e 7428 7379  sys.    print(sy
+00000b80: 732e 7061 7468 290a 2020 2020 696d 706f  s.path).    impo
+00000b90: 7274 206f 730a 2020 2020 6465 6620 6765  rt os.    def ge
+00000ba0: 745f 7079 5f66 696c 6573 2870 6174 6829  t_py_files(path)
+00000bb0: 3a0a 2020 2020 2020 2020 7079 5f66 696c  :.        py_fil
+00000bc0: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00000bd0: 666f 7220 726f 6f74 2c20 6469 7273 2c20  for root, dirs, 
+00000be0: 6669 6c65 7320 696e 206f 732e 7761 6c6b  files in os.walk
+00000bf0: 2870 6174 6829 3a0a 2020 2020 2020 2020  (path):.        
+00000c00: 2020 2020 666f 7220 6669 6c65 2069 6e20      for file in 
+00000c10: 6669 6c65 733a 0a20 2020 2020 2020 2020  files:.         
+00000c20: 2020 2020 2020 2069 6620 6669 6c65 2e65         if file.e
+00000c30: 6e64 7377 6974 6828 272e 7079 2729 3a0a  ndswith('.py'):.
+00000c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c50: 2020 2020 2320 7079 5f66 696c 6573 2e61      # py_files.a
+00000c60: 7070 656e 6428 6f73 2e70 6174 682e 6a6f  ppend(os.path.jo
+00000c70: 696e 2872 6f6f 742c 2066 696c 6529 290a  in(root, file)).
+00000c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c90: 2020 2020 7079 5f66 696c 6573 2e61 7070      py_files.app
+00000ca0: 656e 6428 6669 6c65 290a 2020 2020 2020  end(file).      
+00000cb0: 2020 7265 7475 726e 2070 795f 6669 6c65    return py_file
+00000cc0: 730a 2020 2020 7079 5f66 696c 6573 203d  s.    py_files =
+00000cd0: 2067 6574 5f70 795f 6669 6c65 7328 6f73   get_py_files(os
+00000ce0: 2e67 6574 6377 6428 2929 0a20 2020 2072  .getcwd()).    r
+00000cf0: 0100 0000 7201 0000 0072 0100 0000 7201  ....r....r....r.
+00000d00: 0000 0072 0200 0000 da09 7761 6c6b 5f70  ...r......walk_p
+00000d10: 6174 6856 0000 0073 0200 0000 0001 7206  athV...s......r.
+00000d20: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
+00000d30: 0000 0000 0100 0000 4300 0000 7304 0000  ........C...s...
+00000d40: 0064 0153 0029 024e 7a98 0a20 2020 2021  .d.S.).Nz..    !
+00000d50: 7069 7020 696e 7374 616c 6c20 7461 6275  pip install tabu
+00000d60: 6c61 7465 0a20 2020 2066 726f 6d20 7461  late.    from ta
+00000d70: 6275 6c61 7465 2069 6d70 6f72 7420 7461  bulate import ta
+00000d80: 6275 6c61 7465 0a20 2020 2070 7269 6e74  bulate.    print
+00000d90: 2874 6162 756c 6174 6528 6466 5f67 702c  (tabulate(df_gp,
+00000da0: 2068 6561 6465 7273 203d 2064 665f 6770   headers = df_gp
+00000db0: 2e63 6f6c 756d 6e73 2c20 7461 626c 6566  .columns, tablef
+00000dc0: 6d74 3d22 6772 6964 222c 2066 6c6f 6174  mt="grid", float
+00000dd0: 666d 7420 3d20 272e 3466 2729 290a 2020  fmt = '.4f')).  
+00000de0: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
+00000df0: 0072 0100 0000 7202 0000 00da 0773 686f  .r....r......sho
+00000e00: 775f 6466 6900 0000 7302 0000 0000 0172  w_dfi...s......r
+00000e10: 0700 0000 6300 0000 0000 0000 0000 0000  ....c...........
+00000e20: 0000 0000 0001 0000 0043 0000 0073 0400  .........C...s..
+00000e30: 0000 6401 5300 2902 4e7a 530a 2020 2020  ..d.S.).NzS.    
+00000e40: 2020 2020 7761 7463 6820 2263 6174 202f      watch "cat /
+00000e50: 7072 6f63 2f63 7075 696e 666f 207c 2067  proc/cpuinfo | g
+00000e60: 7265 7020 2d69 204d 487a 207c 206e 6c20  rep -i MHz | nl 
+00000e70: 7c20 736f 7274 202d 726b 3320 7c20 6865  | sort -rk3 | he
+00000e80: 6164 202d 6e20 3332 220a 2020 2020 7201  ad -n 32".    r.
+00000e90: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
+00000ea0: 0000 7202 0000 00da 0873 686f 775f 6370  ..r......show_cp
+00000eb0: 7570 0000 0073 0200 0000 0001 7208 0000  up...s......r...
+00000ec0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+00000ed0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+00000ee0: 0153 0029 024e 61b3 0200 000a 6672 6f6d  .S.).Na.....from
+00000ef0: 2073 6b6c 6561 726e 2e6c 696e 6561 725f   sklearn.linear_
+00000f00: 6d6f 6465 6c20 696d 706f 7274 204c 696e  model import Lin
+00000f10: 6561 7252 6567 7265 7373 696f 6e0a 696d  earRegression.im
+00000f20: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+00000f30: 0a6e 702e 7261 6e64 6f6d 2e73 6565 6428  .np.random.seed(
+00000f40: 3432 290a 0a58 203d 206e 702e 7261 6e64  42)..X = np.rand
+00000f50: 6f6d 2e72 616e 6428 3530 3030 2c20 3130  om.rand(5000, 10
+00000f60: 290a 7920 3d20 6e70 2e72 616e 646f 6d2e  ).y = np.random.
+00000f70: 7261 6e64 2835 3030 3029 0a23 2058 5b3a  rand(5000).# X[:
+00000f80: 2c20 305d 203d 2031 0a0a 7265 6720 3d20  , 0] = 1..reg = 
+00000f90: 4c69 6e65 6172 5265 6772 6573 7369 6f6e  LinearRegression
+00000fa0: 2866 6974 5f69 6e74 6572 6365 7074 203d  (fit_intercept =
+00000fb0: 2046 616c 7365 292e 6669 7428 582c 2079   False).fit(X, y
+00000fc0: 290a 5720 3d20 7265 672e 636f 6566 5f0a  ).W = reg.coef_.
+00000fd0: 5b6e 702e 636f 7628 7920 2d20 5820 4020  [np.cov(y - X @ 
+00000fe0: 572c 2058 5b3a 2c20 695d 295b 302c 2031  W, X[:, i])[0, 1
+00000ff0: 5d20 666f 7220 6920 696e 2072 616e 6765  ] for i in range
+00001000: 2858 2e73 6861 7065 5b31 5d29 5d20 2320  (X.shape[1])] # 
+00001010: 6e6f 7420 7a65 726f 0a0a 2320 7265 6720  not zero..# reg 
+00001020: 3d20 4c69 6e65 6172 5265 6772 6573 7369  = LinearRegressi
+00001030: 6f6e 2866 6974 5f69 6e74 6572 6365 7074  on(fit_intercept
+00001040: 203d 2054 7275 6529 2e66 6974 2858 2c20   = True).fit(X, 
+00001050: 7929 0a23 2057 203d 2072 6567 2e63 6f65  y).# W = reg.coe
+00001060: 665f 0a23 205b 6e70 2e63 6f76 2879 202d  f_.# [np.cov(y -
+00001070: 2058 2e64 6f74 2857 292c 2058 5b3a 2c20   X.dot(W), X[:, 
+00001080: 695d 295b 302c 2031 5d20 666f 7220 6920  i])[0, 1] for i 
+00001090: 696e 2072 616e 6765 2858 2e73 6861 7065  in range(X.shape
+000010a0: 5b31 5d29 5d20 2320 7a65 726f 0a0a 2320  [1])] # zero..# 
+000010b0: 5820 3d20 2858 202d 2058 2e6d 6561 6e28  X = (X - X.mean(
+000010c0: 6178 6973 2020 3d20 302c 206b 6565 7064  axis  = 0, keepd
+000010d0: 696d 7320 3d20 5472 7565 2929 202f 2020  ims = True)) /  
+000010e0: 582e 7374 6428 6178 6973 2020 3d20 302c  X.std(axis  = 0,
+000010f0: 206b 6565 7064 696d 7320 3d20 5472 7565   keepdims = True
+00001100: 290a 2320 7265 6720 3d20 4c69 6e65 6172  ).# reg = Linear
+00001110: 5265 6772 6573 7369 6f6e 2866 6974 5f69  Regression(fit_i
+00001120: 6e74 6572 6365 7074 203d 2046 616c 7365  ntercept = False
+00001130: 292e 6669 7428 582c 2079 290a 2320 5720  ).fit(X, y).# W 
+00001140: 3d20 7265 672e 636f 6566 5f0a 2320 5b6e  = reg.coef_.# [n
+00001150: 702e 636f 7628 7920 2d20 582e 646f 7428  p.cov(y - X.dot(
+00001160: 5729 2c20 585b 3a2c 2069 5d29 5b30 2c20  W), X[:, i])[0, 
+00001170: 315d 2066 6f72 2069 2069 6e20 7261 6e67  1] for i in rang
+00001180: 6528 582e 7368 6170 655b 315d 295d 2023  e(X.shape[1])] #
+00001190: 207a 6572 6f20 2020 200a 2020 2020 7201   zero    .    r.
+000011a0: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
+000011b0: 0000 7202 0000 00da 0867 6574 5f72 6573  ..r......get_res
+000011c0: 6475 0000 0073 0200 0000 0001 7209 0000  du...s......r...
+000011d0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+000011e0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+000011f0: 0153 0029 024e 7532 0300 000a 696d 706f  .S.).Nu2....impo
+00001200: 7274 206f 730a 696d 706f 7274 2073 6875  rt os.import shu
+00001210: 7469 6c0a 0a64 6566 2073 6370 5f67 7265  til..def scp_gre
+00001220: 7028 7372 632c 2064 7374 293a 0a20 2020  p(src, dst):.   
+00001230: 2066 6f72 2072 6f6f 742c 2064 6972 732c   for root, dirs,
+00001240: 2066 696c 6573 2069 6e20 6f73 2e77 616c   files in os.wal
+00001250: 6b28 7372 632c 2074 6f70 646f 776e 203d  k(src, topdown =
+00001260: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
+00001270: 7265 6c5f 6469 7220 3d20 6f73 2e70 6174  rel_dir = os.pat
+00001280: 682e 7265 6c70 6174 6828 726f 6f74 2c20  h.relpath(root, 
+00001290: 7372 6329 0a20 2020 2020 2020 2064 7374  src).        dst
+000012a0: 5f64 6972 203d 206f 732e 7061 7468 2e6a  _dir = os.path.j
+000012b0: 6f69 6e28 6473 742c 2072 656c 5f64 6972  oin(dst, rel_dir
+000012c0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+000012d0: 2020 2069 6620 6e6f 7420 6f73 2e70 6174     if not os.pat
+000012e0: 682e 6578 6973 7473 2864 7374 5f64 6972  h.exists(dst_dir
+000012f0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00001300: 6620 2746 4954 2720 6e6f 7420 696e 2064  f 'FIT' not in d
+00001310: 7374 5f64 6972 3a20 636f 6e74 696e 7565  st_dir: continue
+00001320: 3b20 2320 6578 636c 7564 650a 2020 2020  ; # exclude.    
+00001330: 2020 2020 2020 2020 6f73 2e6d 616b 6564          os.maked
+00001340: 6972 7328 6473 745f 6469 722c 2065 7869  irs(dst_dir, exi
+00001350: 7374 5f6f 6b20 3d20 5472 7565 290a 2020  st_ok = True).  
+00001360: 2020 2020 2020 0a20 2020 2020 2020 2066        .        f
+00001370: 6f72 2066 696c 6520 696e 2066 696c 6573  or file in files
+00001380: 3a0a 2020 2020 2020 2020 2020 2020 7372  :.            sr
+00001390: 635f 6469 725f 6669 6c65 203d 206f 732e  c_dir_file = os.
+000013a0: 7061 7468 2e6a 6f69 6e28 726f 6f74 2c20  path.join(root, 
+000013b0: 6669 6c65 290a 2020 2020 2020 2020 2020  file).          
+000013c0: 2020 6966 2027 4649 5427 206e 6f74 2069    if 'FIT' not i
+000013d0: 6e20 7372 635f 6469 725f 6669 6c65 3a20  n src_dir_file: 
+000013e0: 636f 6e74 696e 7565 3b20 2320 6578 636c  continue; # excl
+000013f0: 7564 650a 2020 2020 2020 2020 2020 2020  ude.            
+00001400: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+00001410: 2064 7374 5f64 6972 5f66 696c 6520 3d20   dst_dir_file = 
+00001420: 6f73 2e70 6174 682e 6a6f 696e 2864 7374  os.path.join(dst
+00001430: 5f64 6972 2c20 6669 6c65 290a 2020 2020  _dir, file).    
+00001440: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
+00001450: 732e 7061 7468 2e65 7869 7374 7328 6473  s.path.exists(ds
+00001460: 745f 6469 725f 6669 6c65 293a 2020 2320  t_dir_file):  # 
+00001470: e5a6 82e6 9e9c e696 87e4 bbb6 e4b8 8de5  ................
+00001480: ad98 e59c a8ef bc8c e588 99e5 a48d e588  ................
+00001490: b60a 2020 2020 2020 2020 2020 2020 2020  ..              
+000014a0: 2020 7368 7574 696c 2e63 6f70 7928 7372    shutil.copy(sr
+000014b0: 635f 6469 725f 6669 6c65 2c20 6473 745f  c_dir_file, dst_
+000014c0: 6469 725f 6669 6c65 290a 0a73 7263 203d  dir_file)..src =
+000014d0: 2027 2f68 6f6d 652f 7278 2f70 726f 6a65   '/home/rx/proje
+000014e0: 6374 5f30 3430 342f 7069 7065 6c69 6e65  ct_0404/pipeline
+000014f0: 2f6f 7574 7075 7427 0a64 7374 203d 2027  /output'.dst = '
+00001500: 2f68 6f6d 652f 7075 626c 6963 2f72 6573  /home/public/res
+00001510: 756c 742f 6861 6861 270a 7363 705f 6772  ult/haha'.scp_gr
+00001520: 6570 2873 7263 2c20 6473 7429 0a72 0100  ep(src, dst).r..
+00001530: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00001540: 0072 0200 0000 da09 636f 7079 5f67 7265  .r......copy_gre
+00001550: 708d 0000 0073 0200 0000 0001 720a 0000  p....s......r...
+00001560: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+00001570: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+00001580: 0153 0029 024e 61c6 0300 000a 2020 2020  .S.).Na.....    
+00001590: 696d 706f 7274 2073 7973 0a20 2020 2073  import sys.    s
+000015a0: 7973 2e61 7267 7620 3d20 5b0a 2020 2020  ys.argv = [.    
+000015b0: 2020 2020 276d 6169 6e2e 7079 272c 200a      'main.py', .
+000015c0: 2020 2020 2020 2020 276c 6762 272c 200a          'lgb', .
+000015d0: 2020 2020 2020 2020 272d 2d6c 6162 656c          '--label
+000015e0: 272c 2027 6c61 6265 6c2e 6e70 7927 2c20  ', 'label.npy', 
+000015f0: 0a20 2020 2020 2020 2027 2d2d 6e61 6d65  .        '--name
+00001600: 272c 2027 4e41 4d45 272c 200a 2020 2020  ', 'NAME', .    
+00001610: 2020 2020 272d 2d6c 7227 2c20 2730 2e31      '--lr', '0.1
+00001620: 272c 200a 2020 2020 2020 2020 272d 2d6e  ', .        '--n
+00001630: 5f62 6f6f 7374 272c 2027 3130 3027 2c0a  _boost', '100',.
+00001640: 2020 2020 2020 2020 272d 2d64 6562 7567          '--debug
+00001650: 272c 2023 2731 272c 2732 272c 0a20 2020  ', #'1','2',.   
+00001660: 2020 2020 2027 2d2d 6c61 7374 272c 2027       '--last', '
+00001670: 4c41 5354 272c 0a20 2020 205d 0a0a 2020  LAST',.    ]..  
+00001680: 2020 696d 706f 7274 2061 7267 7061 7273    import argpars
+00001690: 650a 2020 2020 7061 7273 6572 203d 2061  e.    parser = a
+000016a0: 7267 7061 7273 652e 4172 6775 6d65 6e74  rgparse.Argument
+000016b0: 5061 7273 6572 2829 0a20 2020 2070 6172  Parser().    par
+000016c0: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+000016d0: 2827 6273 7427 2c20 6368 6f69 6365 733d  ('bst', choices=
+000016e0: 5b27 6c67 6227 2c20 2778 6762 272c 2027  ['lgb', 'xgb', '
+000016f0: 6361 7427 5d29 2023 206f 7264 6572 200a  cat']) # order .
+00001700: 2020 2020 7061 7273 6572 2e61 6464 5f61      parser.add_a
+00001710: 7267 756d 656e 7428 272d 2d6c 6162 656c  rgument('--label
+00001720: 272c 2074 7970 6520 3d20 7374 722c 2072  ', type = str, r
+00001730: 6571 7569 7265 643d 5472 7565 2920 2320  equired=True) # 
+00001740: 7265 7175 6972 6564 0a20 2020 2070 6172  required.    par
+00001750: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00001760: 2827 2d2d 6e61 6d65 272c 2074 7970 653d  ('--name', type=
+00001770: 7374 722c 2064 6566 6175 6c74 3d27 6465  str, default='de
+00001780: 6275 6727 2920 2023 2073 7472 0a20 2020  bug')  # str.   
+00001790: 2070 6172 7365 722e 6164 645f 6172 6775   parser.add_argu
+000017a0: 6d65 6e74 2827 2d2d 6c72 272c 2074 7970  ment('--lr', typ
+000017b0: 653d 666c 6f61 742c 2064 6566 6175 6c74  e=float, default
+000017c0: 3d30 2e30 3129 2020 2020 2023 2066 6c6f  =0.01)     # flo
+000017d0: 6174 0a20 2020 2070 6172 7365 722e 6164  at.    parser.ad
+000017e0: 645f 6172 6775 6d65 6e74 2827 2d2d 6e5f  d_argument('--n_
+000017f0: 626f 6f73 7427 2c20 7479 7065 3d69 6e74  boost', type=int
+00001800: 2c20 6465 6661 756c 743d 3130 3030 2920  , default=1000) 
+00001810: 2023 2069 6e74 0a20 2020 2070 6172 7365   # int.    parse
+00001820: 722e 6164 645f 6172 6775 6d65 6e74 2827  r.add_argument('
+00001830: 2d2d 6465 6275 6727 2c20 6e61 7267 733d  --debug', nargs=
+00001840: 272a 272c 2064 6566 6175 6c74 3d5b 5d2c  '*', default=[],
+00001850: 2068 656c 703d 2768 656c 7020 696e 666f   help='help info
+00001860: 2729 2023 2061 6e79 206e 756d 6265 7220  ') # any number 
+00001870: 6f66 0a20 2020 2070 6172 7365 722e 6164  of.    parser.ad
+00001880: 645f 6172 6775 6d65 6e74 2827 2d2d 6c61  d_argument('--la
+00001890: 7374 272c 2074 7970 653d 7374 722c 2064  st', type=str, d
+000018a0: 6566 6175 6c74 3d27 6c61 7374 2729 0a20  efault='last'). 
+000018b0: 2020 2061 7267 7320 3d20 7061 7273 6572     args = parser
+000018c0: 2e70 6172 7365 5f61 7267 7328 290a 2020  .parse_args().  
+000018d0: 2020 7072 696e 7428 6172 6773 290a 2020    print(args).  
+000018e0: 2020 2320 4e61 6d65 7370 6163 6528 6273    # Namespace(bs
+000018f0: 743d 276c 6762 272c 206c 6162 656c 3d27  t='lgb', label='
+00001900: 6c61 6265 6c2e 6e70 7927 2c20 6e61 6d65  label.npy', name
+00001910: 3d27 4e41 4d45 272c 206c 723d 302e 312c  ='NAME', lr=0.1,
+00001920: 206e 5f62 6f6f 7374 3d31 3030 2c20 6465   n_boost=100, de
+00001930: 6275 673d 5b27 3127 2c20 2732 275d 2c20  bug=['1', '2'], 
+00001940: 6c61 7374 3d27 4c41 5354 2729 0a20 2020  last='LAST').   
+00001950: 2072 0100 0000 7201 0000 0072 0100 0000   r....r....r....
+00001960: 7201 0000 0072 0200 0000 da0a 7061 7273  r....r......pars
+00001970: 655f 6172 6773 a900 0000 7302 0000 0000  e_args....s.....
+00001980: 0172 0b00 0000 6300 0000 0000 0000 0000  .r....c.........
+00001990: 0000 0000 0000 0001 0000 0043 0000 0073  ...........C...s
+000019a0: 0400 0000 6401 5300 2902 4e61 c30a 0000  ....d.S.).Na....
+000019b0: 0a20 2020 2070 6174 685f 696e 7075 7420  .    path_input 
+000019c0: 3d20 272e 2e2e 270a 2020 2020 6461 7461  = '...'.    data
+000019d0: 5f6e 616d 6520 3d20 2764 6174 612e 6e70  _name = 'data.np
+000019e0: 7927 0a20 2020 206d 6173 6b5f 6e61 6d65  y'.    mask_name
+000019f0: 203d 2027 6d61 736b 2e6e 7079 270a 2020   = 'mask.npy'.  
+00001a00: 2020 7061 7468 5f6c 6162 656c 203d 2066    path_label = f
+00001a10: 277b 7061 7468 5f69 6e70 7574 7d2f 6c61  '{path_input}/la
+00001a20: 6265 6c73 2e6e 7079 270a 2020 2020 7472  bels.npy'.    tr
+00001a30: 6169 6e5f 7031 7032 203d 205b 302c 2033  ain_p1p2 = [0, 3
+00001a40: 305d 0a20 2020 2074 6573 745f 7031 7032  0].    test_p1p2
+00001a50: 203d 205b 3330 2c20 3530 5d0a 2020 2020   = [30, 50].    
+00001a60: 7061 6464 696e 6720 3d20 310a 0a20 2020  padding = 1..   
+00001a70: 2023 2070 6164 6469 6e67 2061 6e64 2070   # padding and p
+00001a80: 3170 320a 2020 2020 6966 2070 6164 6469  1p2.    if paddi
+00001a90: 6e67 203d 3d20 313a 0a20 2020 2020 2020  ng == 1:.       
+00001aa0: 2079 5f69 6478 203d 2030 0a20 2020 2065   y_idx = 0.    e
+00001ab0: 6c69 6620 7061 6464 696e 6720 3d3d 2035  lif padding == 5
+00001ac0: 3a0a 2020 2020 2020 2020 795f 6964 7820  :.        y_idx 
+00001ad0: 3d20 310a 2020 2020 656c 6966 2070 6164  = 1.    elif pad
+00001ae0: 6469 6e67 203d 3d20 3230 3a0a 2020 2020  ding == 20:.    
+00001af0: 2020 2020 795f 6964 7820 3d20 320a 2020      y_idx = 2.  
+00001b00: 2020 7472 6169 6e5f 7031 7032 5b31 5d20    train_p1p2[1] 
+00001b10: 2d3d 2070 6164 6469 6e67 0a20 2020 2074  -= padding.    t
+00001b20: 7261 696e 5f70 3170 3220 3d20 5b78 2025  rain_p1p2 = [x %
+00001b30: 206e 2066 6f72 2078 2069 6e20 7472 6169   n for x in trai
+00001b40: 6e5f 7031 7032 5d0a 2020 2020 7465 7374  n_p1p2].    test
+00001b50: 5f70 3170 3220 3d20 5b78 2025 206e 2066  _p1p2 = [x % n f
+00001b60: 6f72 2078 2069 6e20 7465 7374 5f70 3170  or x in test_p1p
+00001b70: 325d 0a20 2020 2069 6620 7465 7374 5f70  2].    if test_p
+00001b80: 3170 325b 315d 203d 3d20 303a 2074 6573  1p2[1] == 0: tes
+00001b90: 745f 7031 7032 5b31 5d20 3d20 6e0a 2020  t_p1p2[1] = n.  
+00001ba0: 2020 7472 6169 6e5f 7031 7032 5b30 5d20    train_p1p2[0] 
+00001bb0: 3d20 6d61 7828 302c 2074 7261 696e 5f70  = max(0, train_p
+00001bc0: 3170 325b 305d 290a 0a20 2020 2023 2064  1p2[0])..    # d
+00001bd0: 6174 6120 7368 6170 650a 2020 2020 7072  ata shape.    pr
+00001be0: 696e 7428 275b 2b5d 202d 2d2d 2d2d 2d2d  int('[+] -------
+00001bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001c00: 2d2d 2d2d 2d2d 2d20 696e 666f 202d 2d2d  ------- info ---
 00001c10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001c20: 2d2d 2d20 2729 0a20 2020 2070 6174 685f  --- ').    path_
-00001c30: 6461 7461 203d 2066 277b 7061 7468 5f69  data = f'{path_i
-00001c40: 6e70 7574 7d2f 7b64 6174 615f 6e61 6d65  nput}/{data_name
-00001c50: 7d27 0a20 2020 2064 6174 615f 7368 6170  }'.    data_shap
-00001c60: 6520 3d20 727a 2e75 7469 6c2e 6e70 792e  e = rz.util.npy.
-00001c70: 7265 6164 5f6e 7079 5f68 6561 6465 7228  read_npy_header(
-00001c80: 7061 7468 5f64 6174 6129 5b30 5d0a 2020  path_data)[0].  
-00001c90: 2020 7072 696e 7428 6627 5b2b 5d20 7368    print(f'[+] sh
-00001ca0: 6170 655f 616c 6c20 203d 207b 6461 7461  ape_all  = {data
-00001cb0: 5f73 6861 7065 7d2c 206d 656d 203d 207b  _shape}, mem = {
-00001cc0: 6e70 2e70 726f 6428 6461 7461 5f73 6861  np.prod(data_sha
-00001cd0: 7065 2920 2a20 343a 2c2e 3066 7d27 290a  pe) * 4:,.0f}').
-00001ce0: 0a20 2020 2023 206d 6173 6b0a 2020 2020  .    # mask.    
-00001cf0: 7061 7468 5f6d 6173 6b20 3d20 6627 7b70  path_mask = f'{p
-00001d00: 6174 685f 696e 7075 747d 2f7b 6d61 736b  ath_input}/{mask
-00001d10: 5f6e 616d 657d 270a 2020 2020 6d61 736b  _name}'.    mask
-00001d20: 203d 206e 702e 6c6f 6164 2870 6174 685f   = np.load(path_
-00001d30: 6d61 736b 290a 2020 2020 6e20 3d20 6c65  mask).    n = le
-00001d40: 6e28 6d61 736b 290a 2020 2020 6d61 736b  n(mask).    mask
-00001d50: 5f72 6174 696f 203d 206e 702e 6e61 6e73  _ratio = np.nans
-00001d60: 756d 286d 6173 6b29 202f 206e 702e 7072  um(mask) / np.pr
-00001d70: 6f64 286d 6173 6b2e 7368 6170 6529 0a20  od(mask.shape). 
-00001d80: 2020 206d 656d 5f6d 6178 203d 2032 5f30     mem_max = 2_0
-00001d90: 3030 5f30 3030 5f30 3030 0a20 2020 206d  00_000_000.    m
-00001da0: 656d 5f6f 6e65 5f74 6920 3d20 6e70 2e70  em_one_ti = np.p
-00001db0: 726f 6428 6461 7461 5f73 6861 7065 5b2d  rod(data_shape[-
-00001dc0: 323a 5d29 202a 2034 202a 206d 6173 6b5f  2:]) * 4 * mask_
-00001dd0: 7261 7469 6f0a 2020 2020 6e5f 7469 5f74  ratio.    n_ti_t
-00001de0: 7261 696e 203d 2069 6e74 286d 656d 5f6d  rain = int(mem_m
-00001df0: 6178 202f 206d 656d 5f6f 6e65 5f74 6920  ax / mem_one_ti 
-00001e00: 2f2f 2031 3030 202a 2031 3030 290a 2020  // 100 * 100).  
-00001e10: 2020 7072 696e 7428 6627 5b2b 5d20 6d61    print(f'[+] ma
-00001e20: 736b 5f72 6174 696f 203d 207b 6d61 736b  sk_ratio = {mask
-00001e30: 5f72 6174 696f 3a2e 3466 7d2c 204d 454d  _ratio:.4f}, MEM
-00001e40: 5f4d 4158 203d 207b 6d65 6d5f 6d61 783a  _MAX = {mem_max:
-00001e50: 2c2e 3066 7d2c 206e 5f74 695f 7472 6169  ,.0f}, n_ti_trai
-00001e60: 6e20 3d20 7b6e 5f74 695f 7472 6169 6e7d  n = {n_ti_train}
-00001e70: 2729 0a0a 2020 2020 2320 6d61 736b 2c20  ')..    # mask, 
-00001e80: 7472 6169 6e2c 2074 6573 740a 2020 2020  train, test.    
-00001e90: 7072 696e 7428 275b 2b5d 202d 2d2d 2d2d  print('[+] -----
-00001ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001eb0: 2d2d 2d2d 2d2d 2d2d 2d20 6d61 736b 202d  --------- mask -
-00001ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d20 2729  ------------- ')
-00001ee0: 0a20 2020 206d 6173 6b5f 7472 6169 6e20  .    mask_train 
-00001ef0: 3d20 6d61 736b 5b74 7261 696e 5f70 3170  = mask[train_p1p
-00001f00: 325b 305d 3a20 7472 6169 6e5f 7031 7032  2[0]: train_p1p2
-00001f10: 5b31 5d5d 0a20 2020 206d 6173 6b5f 7465  [1]].    mask_te
-00001f20: 7374 203d 206d 6173 6b5b 7465 7374 5f70  st = mask[test_p
-00001f30: 3170 325b 305d 3a20 7465 7374 5f70 3170  1p2[0]: test_p1p
-00001f40: 325b 315d 5d0a 2020 2020 6e5f 616c 6c2c  2[1]].    n_all,
-00001f50: 206e 5f74 7261 696e 2c20 6e5f 7465 7374   n_train, n_test
-00001f60: 203d 2069 6e74 286e 702e 6e61 6e73 756d   = int(np.nansum
-00001f70: 286d 6173 6b29 292c 2069 6e74 286e 702e  (mask)), int(np.
-00001f80: 6e61 6e73 756d 286d 6173 6b5f 7472 6169  nansum(mask_trai
-00001f90: 6e29 292c 2069 6e74 286e 702e 6e61 6e73  n)), int(np.nans
-00001fa0: 756d 286d 6173 6b5f 7465 7374 2929 0a20  um(mask_test)). 
-00001fb0: 2020 2070 7269 6e74 2866 275b 2b5d 2070     print(f'[+] p
-00001fc0: 6164 6469 6e67 2020 2020 3d20 7b70 6164  adding    = {pad
-00001fd0: 6469 6e67 7d2c 2079 5f69 6478 203d 207b  ding}, y_idx = {
-00001fe0: 795f 6964 787d 2027 290a 2020 2020 7072  y_idx} ').    pr
-00001ff0: 696e 7428 6627 5b2b 5d20 7472 6169 6e5f  int(f'[+] train_
-00002000: 7031 7032 203d 207b 7472 6169 6e5f 7031  p1p2 = {train_p1
-00002010: 7032 7d2c 2074 6573 745f 7031 7032 203d  p2}, test_p1p2 =
-00002020: 207b 7465 7374 5f70 3170 327d 2729 0a20   {test_p1p2}'). 
-00002030: 2020 2070 7269 6e74 2866 275b 2b5d 206d     print(f'[+] m
-00002040: 6173 6b3a 616c 6c20 2020 3d20 7b6d 6173  ask:all   = {mas
-00002050: 6b2e 7368 6170 657d 203d 207b 6e5f 616c  k.shape} = {n_al
-00002060: 6c7d 2729 0a20 2020 2070 7269 6e74 2866  l}').    print(f
-00002070: 275b 2b5d 206d 6173 6b3a 7472 6169 6e20  '[+] mask:train 
-00002080: 3d20 7b6d 6173 6b5f 7472 6169 6e2e 7368  = {mask_train.sh
-00002090: 6170 657d 203d 207b 6e5f 7472 6169 6e7d  ape} = {n_train}
-000020a0: 2c20 7465 7374 203d 207b 6d61 736b 5f74  , test = {mask_t
-000020b0: 6573 742e 7368 6170 657d 203d 207b 6e5f  est.shape} = {n_
-000020c0: 7465 7374 7d27 290a 2020 2020 727a 2e67  test}').    rz.g
-000020d0: 6574 5f6d 656d 5f63 7572 2829 2c20 727a  et_mem_cur(), rz
-000020e0: 2e67 6574 5f6d 656d 5f6d 6178 2829 3b0a  .get_mem_max();.
-000020f0: 0a20 2020 2023 206c 6f61 6420 582c 2079  .    # load X, y
-00002100: 0a20 2020 2070 7269 6e74 2827 5b2b 5d20  .    print('[+] 
-00002110: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2058  -------------- X
-00002130: 2c20 7920 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  , y ------------
+00001c20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d20 2729 0a20  ----------- '). 
+00001c30: 2020 2070 6174 685f 6461 7461 203d 2066     path_data = f
+00001c40: 277b 7061 7468 5f69 6e70 7574 7d2f 7b64  '{path_input}/{d
+00001c50: 6174 615f 6e61 6d65 7d27 0a20 2020 2064  ata_name}'.    d
+00001c60: 6174 615f 7368 6170 6520 3d20 727a 2e75  ata_shape = rz.u
+00001c70: 7469 6c2e 6e70 792e 7265 6164 5f6e 7079  til.npy.read_npy
+00001c80: 5f68 6561 6465 7228 7061 7468 5f64 6174  _header(path_dat
+00001c90: 6129 5b30 5d0a 2020 2020 7072 696e 7428  a)[0].    print(
+00001ca0: 6627 5b2b 5d20 7368 6170 655f 616c 6c20  f'[+] shape_all 
+00001cb0: 203d 207b 6461 7461 5f73 6861 7065 7d2c   = {data_shape},
+00001cc0: 206d 656d 203d 207b 6e70 2e70 726f 6428   mem = {np.prod(
+00001cd0: 6461 7461 5f73 6861 7065 2920 2a20 343a  data_shape) * 4:
+00001ce0: 2c2e 3066 7d27 290a 0a20 2020 2023 206d  ,.0f}')..    # m
+00001cf0: 6173 6b0a 2020 2020 7061 7468 5f6d 6173  ask.    path_mas
+00001d00: 6b20 3d20 6627 7b70 6174 685f 696e 7075  k = f'{path_inpu
+00001d10: 747d 2f7b 6d61 736b 5f6e 616d 657d 270a  t}/{mask_name}'.
+00001d20: 2020 2020 6d61 736b 203d 206e 702e 6c6f      mask = np.lo
+00001d30: 6164 2870 6174 685f 6d61 736b 290a 2020  ad(path_mask).  
+00001d40: 2020 6e20 3d20 6c65 6e28 6d61 736b 290a    n = len(mask).
+00001d50: 2020 2020 6d61 736b 5f72 6174 696f 203d      mask_ratio =
+00001d60: 206e 702e 6e61 6e73 756d 286d 6173 6b29   np.nansum(mask)
+00001d70: 202f 206e 702e 7072 6f64 286d 6173 6b2e   / np.prod(mask.
+00001d80: 7368 6170 6529 0a20 2020 206d 656d 5f6d  shape).    mem_m
+00001d90: 6178 203d 2032 5f30 3030 5f30 3030 5f30  ax = 2_000_000_0
+00001da0: 3030 0a20 2020 206d 656d 5f6f 6e65 5f74  00.    mem_one_t
+00001db0: 6920 3d20 6e70 2e70 726f 6428 6461 7461  i = np.prod(data
+00001dc0: 5f73 6861 7065 5b2d 323a 5d29 202a 2034  _shape[-2:]) * 4
+00001dd0: 202a 206d 6173 6b5f 7261 7469 6f0a 2020   * mask_ratio.  
+00001de0: 2020 6e5f 7469 5f74 7261 696e 203d 2069    n_ti_train = i
+00001df0: 6e74 286d 656d 5f6d 6178 202f 206d 656d  nt(mem_max / mem
+00001e00: 5f6f 6e65 5f74 6920 2f2f 2031 3030 202a  _one_ti // 100 *
+00001e10: 2031 3030 290a 2020 2020 7072 696e 7428   100).    print(
+00001e20: 6627 5b2b 5d20 6d61 736b 5f72 6174 696f  f'[+] mask_ratio
+00001e30: 203d 207b 6d61 736b 5f72 6174 696f 3a2e   = {mask_ratio:.
+00001e40: 3466 7d2c 204d 454d 5f4d 4158 203d 207b  4f}, MEM_MAX = {
+00001e50: 6d65 6d5f 6d61 783a 2c2e 3066 7d2c 206e  mem_max:,.0f}, n
+00001e60: 5f74 695f 7472 6169 6e20 3d20 7b6e 5f74  _ti_train = {n_t
+00001e70: 695f 7472 6169 6e7d 2729 0a0a 2020 2020  i_train}')..    
+00001e80: 2320 6d61 736b 2c20 7472 6169 6e2c 2074  # mask, train, t
+00001e90: 6573 740a 2020 2020 7072 696e 7428 275b  est.    print('[
+00001ea0: 2b5d 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  +] -------------
+00001eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001ec0: 2d20 6d61 736b 202d 2d2d 2d2d 2d2d 2d2d  - mask ---------
+00001ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001ee0: 2d2d 2d2d 2d20 2729 0a20 2020 206d 6173  ----- ').    mas
+00001ef0: 6b5f 7472 6169 6e20 3d20 6d61 736b 5b74  k_train = mask[t
+00001f00: 7261 696e 5f70 3170 325b 305d 3a20 7472  rain_p1p2[0]: tr
+00001f10: 6169 6e5f 7031 7032 5b31 5d5d 0a20 2020  ain_p1p2[1]].   
+00001f20: 206d 6173 6b5f 7465 7374 203d 206d 6173   mask_test = mas
+00001f30: 6b5b 7465 7374 5f70 3170 325b 305d 3a20  k[test_p1p2[0]: 
+00001f40: 7465 7374 5f70 3170 325b 315d 5d0a 2020  test_p1p2[1]].  
+00001f50: 2020 6e5f 616c 6c2c 206e 5f74 7261 696e    n_all, n_train
+00001f60: 2c20 6e5f 7465 7374 203d 2069 6e74 286e  , n_test = int(n
+00001f70: 702e 6e61 6e73 756d 286d 6173 6b29 292c  p.nansum(mask)),
+00001f80: 2069 6e74 286e 702e 6e61 6e73 756d 286d   int(np.nansum(m
+00001f90: 6173 6b5f 7472 6169 6e29 292c 2069 6e74  ask_train)), int
+00001fa0: 286e 702e 6e61 6e73 756d 286d 6173 6b5f  (np.nansum(mask_
+00001fb0: 7465 7374 2929 0a20 2020 2070 7269 6e74  test)).    print
+00001fc0: 2866 275b 2b5d 2070 6164 6469 6e67 2020  (f'[+] padding  
+00001fd0: 2020 3d20 7b70 6164 6469 6e67 7d2c 2079    = {padding}, y
+00001fe0: 5f69 6478 203d 207b 795f 6964 787d 2027  _idx = {y_idx} '
+00001ff0: 290a 2020 2020 7072 696e 7428 6627 5b2b  ).    print(f'[+
+00002000: 5d20 7472 6169 6e5f 7031 7032 203d 207b  ] train_p1p2 = {
+00002010: 7472 6169 6e5f 7031 7032 7d2c 2074 6573  train_p1p2}, tes
+00002020: 745f 7031 7032 203d 207b 7465 7374 5f70  t_p1p2 = {test_p
+00002030: 3170 327d 2729 0a20 2020 2070 7269 6e74  1p2}').    print
+00002040: 2866 275b 2b5d 206d 6173 6b3a 616c 6c20  (f'[+] mask:all 
+00002050: 2020 3d20 7b6d 6173 6b2e 7368 6170 657d    = {mask.shape}
+00002060: 203d 207b 6e5f 616c 6c7d 2729 0a20 2020   = {n_all}').   
+00002070: 2070 7269 6e74 2866 275b 2b5d 206d 6173   print(f'[+] mas
+00002080: 6b3a 7472 6169 6e20 3d20 7b6d 6173 6b5f  k:train = {mask_
+00002090: 7472 6169 6e2e 7368 6170 657d 203d 207b  train.shape} = {
+000020a0: 6e5f 7472 6169 6e7d 2c20 7465 7374 203d  n_train}, test =
+000020b0: 207b 6d61 736b 5f74 6573 742e 7368 6170   {mask_test.shap
+000020c0: 657d 203d 207b 6e5f 7465 7374 7d27 290a  e} = {n_test}').
+000020d0: 2020 2020 727a 2e67 6574 5f6d 656d 5f63      rz.get_mem_c
+000020e0: 7572 2829 2c20 727a 2e67 6574 5f6d 656d  ur(), rz.get_mem
+000020f0: 5f6d 6178 2829 3b0a 0a20 2020 2023 206c  _max();..    # l
+00002100: 6f61 6420 582c 2079 0a20 2020 2070 7269  oad X, y.    pri
+00002110: 6e74 2827 5b2b 5d20 2d2d 2d2d 2d2d 2d2d  nt('[+] --------
+00002120: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002130: 2d2d 2d2d 2d2d 2058 2c20 7920 2d2d 2d2d  ------ X, y ----
 00002140: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002150: 2d2d 2027 290a 2020 2020 6964 785f 7472  -- ').    idx_tr
-00002160: 6169 6e20 3d20 727a 2e75 7469 6c2e 6e70  ain = rz.util.np
-00002170: 792e 6d61 736b 5f32 5f69 6478 286d 6173  y.mask_2_idx(mas
-00002180: 6b29 5b74 7261 696e 5f70 3170 325b 305d  k)[train_p1p2[0]
-00002190: 3a20 7472 6169 6e5f 7031 7032 5b31 5d5d  : train_p1p2[1]]
-000021a0: 5b6d 6173 6b5f 7472 6169 6e20 3d3d 2031  [mask_train == 1
-000021b0: 5d0a 2020 2020 585f 7472 6169 6e20 3d20  ].    X_train = 
-000021c0: 727a 2e75 7469 6c2e 6e70 792e 6c6f 6164  rz.util.npy.load
-000021d0: 5f6e 7079 5f69 6478 2870 6174 685f 6461  _npy_idx(path_da
-000021e0: 7461 2c20 6964 785f 7472 6169 6e2e 7261  ta, idx_train.ra
-000021f0: 7665 6c28 292c 2063 6f6c 7320 3d20 4e6f  vel(), cols = No
-00002200: 6e65 2c20 7665 7262 6f73 6520 3d20 5472  ne, verbose = Tr
-00002210: 7565 290a 2020 2020 795f 7472 6169 6e20  ue).    y_train 
-00002220: 3d20 727a 2e75 7469 6c2e 6e70 792e 6c6f  = rz.util.npy.lo
-00002230: 6164 5f6e 7079 5f69 6478 2870 6174 685f  ad_npy_idx(path_
-00002240: 6461 7461 2c20 6964 785f 7472 6169 6e2e  data, idx_train.
-00002250: 7261 7665 6c28 292c 2063 6f6c 7320 3d20  ravel(), cols = 
-00002260: 5b79 5f69 6478 5d2c 2076 6572 626f 7365  [y_idx], verbose
-00002270: 203d 2046 616c 7365 290a 2020 2020 6964   = False).    id
-00002280: 785f 7465 7374 203d 2072 7a2e 7574 696c  x_test = rz.util
-00002290: 2e6e 7079 2e6d 6173 6b5f 325f 6964 7828  .npy.mask_2_idx(
-000022a0: 6d61 736b 295b 7465 7374 5f70 3170 325b  mask)[test_p1p2[
-000022b0: 305d 3a20 7465 7374 5f70 3170 325b 315d  0]: test_p1p2[1]
-000022c0: 5d5b 6d61 736b 5f74 6573 7420 3d3d 2031  ][mask_test == 1
-000022d0: 5d0a 2020 2020 585f 7465 7374 203d 2072  ].    X_test = r
-000022e0: 7a2e 7574 696c 2e6e 7079 2e6c 6f61 645f  z.util.npy.load_
-000022f0: 6e70 795f 6964 7828 7061 7468 5f64 6174  npy_idx(path_dat
-00002300: 612c 2069 6478 5f74 6573 742e 7261 7665  a, idx_test.rave
-00002310: 6c28 292c 2063 6f6c 7320 3d20 4e6f 6e65  l(), cols = None
-00002320: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
-00002330: 6529 0a20 2020 2079 5f74 6573 7420 3d20  e).    y_test = 
-00002340: 727a 2e75 7469 6c2e 6e70 792e 6c6f 6164  rz.util.npy.load
-00002350: 5f6e 7079 5f69 6478 2870 6174 685f 6461  _npy_idx(path_da
-00002360: 7461 2c20 6964 785f 7465 7374 2e72 6176  ta, idx_test.rav
-00002370: 656c 2829 2c20 636f 6c73 203d 205b 795f  el(), cols = [y_
-00002380: 6964 785d 2c20 7665 7262 6f73 6520 3d20  idx], verbose = 
-00002390: 4661 6c73 6529 0a20 2020 2070 7269 6e74  False).    print
-000023a0: 2866 275b 2b5d 2058 5f74 7261 696e 203d  (f'[+] X_train =
-000023b0: 207b 585f 7472 6169 6e2e 7368 6170 657d   {X_train.shape}
-000023c0: 2c20 6d65 6d20 3d20 7b6e 702e 7072 6f64  , mem = {np.prod
-000023d0: 2858 5f74 7261 696e 2e73 6861 7065 2920  (X_train.shape) 
-000023e0: 2a20 343a 2c2e 3066 7d27 290a 2020 2020  * 4:,.0f}').    
-000023f0: 7072 696e 7428 6627 5b2b 5d20 585f 7465  print(f'[+] X_te
-00002400: 7374 2020 3d20 7b58 5f74 6573 742e 7368  st  = {X_test.sh
-00002410: 6170 657d 2c20 6d65 6d20 3d20 7b6e 702e  ape}, mem = {np.
-00002420: 7072 6f64 2858 5f74 6573 742e 7368 6170  prod(X_test.shap
-00002430: 6529 202a 2034 3a2c 2e30 667d 2729 0a20  e) * 4:,.0f}'). 
-00002440: 2020 2072 7a2e 6765 745f 6d65 6d5f 6375     rz.get_mem_cu
-00002450: 7228 292c 2072 7a2e 6765 745f 6d65 6d5f  r(), rz.get_mem_
-00002460: 6d61 7828 293b 0a20 2020 2072 0100 0000  max();.    r....
-00002470: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-00002480: 0200 0000 da09 7265 6164 5f64 6174 61c5  ......read_data.
-00002490: 0000 0073 0200 0000 0001 720c 0000 0063  ...s......r....c
-000024a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000024b0: 0100 0000 4300 0000 7304 0000 0064 0153  ....C...s....d.S
-000024c0: 0029 024e 6174 0b00 000a 2020 2020 636c  .).Nat....    cl
-000024d0: 6173 7320 4261 7365 4461 7461 2829 3a0a  ass BaseData():.
-000024e0: 2020 2020 2020 2020 6465 6620 6765 745f          def get_
-000024f0: 6466 2873 656c 662c 2070 6174 685f 696e  df(self, path_in
-00002500: 7075 742c 2064 6174 655f 6265 6769 6e2c  put, date_begin,
-00002510: 2064 6174 655f 656e 642c 206e 5f6a 6f62   date_end, n_job
-00002520: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00002530: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00002540: 6e74 6564 4572 726f 7228 2779 6f75 206e  ntedError('you n
-00002550: 6565 6420 746f 2069 6d70 6c65 6d65 6e74  eed to implement
-00002560: 2067 6574 5f64 6628 2927 290a 0a20 2020   get_df()')..   
-00002570: 2020 2020 2064 6566 206c 6f61 6428 7365       def load(se
-00002580: 6c66 2c20 6e5f 6a6f 6273 203d 2034 2c20  lf, n_jobs = 4, 
-00002590: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-000025a0: 2020 2020 2020 2023 2069 6e70 7574 0a20         # input. 
-000025b0: 2020 2020 2020 2020 2020 2070 6174 685f             path_
-000025c0: 696e 7075 7420 3d20 6b77 6172 6773 5b27  input = kwargs['
-000025d0: 7061 7468 5f69 6e70 7574 275d 0a20 2020  path_input'].   
-000025e0: 2020 2020 2020 2020 2064 6174 655f 6469           date_di
-000025f0: 6374 203d 206b 7761 7267 735b 2764 6174  ct = kwargs['dat
-00002600: 655f 6469 6374 275d 0a20 2020 2020 2020  e_dict'].       
-00002610: 2020 2020 2063 6f6c 735f 6469 6374 203d       cols_dict =
-00002620: 206b 7761 7267 735b 2763 6f6c 735f 6469   kwargs['cols_di
-00002630: 6374 275d 0a20 2020 2020 2020 2020 2020  ct'].           
-00002640: 200a 2020 2020 2020 2020 2020 2020 636f   .            co
-00002650: 6c5f 6964 203d 2063 6f6c 735f 6469 6374  l_id = cols_dict
-00002660: 5b27 636f 6c5f 6964 275d 0a20 2020 2020  ['col_id'].     
-00002670: 2020 2020 2020 2063 6f6c 5f6c 6162 656c         col_label
-00002680: 203d 2063 6f6c 735f 6469 6374 5b27 636f   = cols_dict['co
-00002690: 6c5f 6c61 6265 6c27 5d0a 2020 2020 2020  l_label'].      
-000026a0: 2020 2020 2020 636f 6c73 5f74 6964 203d        cols_tid =
-000026b0: 2063 6f6c 735f 6469 6374 5b27 636f 6c73   cols_dict['cols
-000026c0: 5f74 6964 275d 0a20 2020 2020 2020 2020  _tid'].         
-000026d0: 2020 2069 6620 6c65 6e28 636f 6c73 5f74     if len(cols_t
-000026e0: 6964 2920 3d3d 2031 3a0a 2020 2020 2020  id) == 1:.      
-000026f0: 2020 2020 2020 2020 2020 636f 6c5f 7469            col_ti
-00002700: 6420 3d20 636f 6c73 5f74 6964 5b30 5d0a  d = cols_tid[0].
-00002710: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00002720: 3a20 2020 0a20 2020 2020 2020 2020 2020  :   .           
-00002730: 2020 2020 2063 6f6c 5f74 6964 203d 2066       col_tid = f
-00002740: 2278 287b 272c 2027 2e6a 6f69 6e28 636f  "x({', '.join(co
-00002750: 6c73 5f74 6964 297d 2922 0a0a 2020 2020  ls_tid)})"..    
-00002760: 2020 2020 2020 2020 2320 646d 0a20 2020          # dm.   
-00002770: 2020 2020 2020 2020 2064 6620 3d20 7365           df = se
-00002780: 6c66 2e67 6574 5f64 6628 7061 7468 5f69  lf.get_df(path_i
-00002790: 6e70 7574 2c20 2a64 6174 655f 6469 6374  nput, *date_dict
-000027a0: 5b27 616c 6c27 5d2c 206e 5f6a 6f62 7329  ['all'], n_jobs)
-000027b0: 0a20 2020 2020 2020 2020 2020 2064 6d20  .            dm 
-000027c0: 3d20 4461 7461 4d61 7374 6572 2864 662c  = DataMaster(df,
-000027d0: 2076 6572 626f 7365 203d 2046 616c 7365   verbose = False
-000027e0: 2c20 6b65 6570 5f73 7061 6365 203d 2054  , keep_space = T
-000027f0: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-00002800: 2064 6d2e 736f 7274 5f76 616c 7565 7328   dm.sort_values(
-00002810: 636f 6c73 5f74 6964 202b 205b 636f 6c5f  cols_tid + [col_
-00002820: 6964 5d29 0a20 2020 2020 2020 2020 2020  id]).           
-00002830: 2064 6d2e 6665 5f67 6f28 5b63 6f6c 5f74   dm.fe_go([col_t
-00002840: 6964 5d2c 2076 6572 626f 7365 203d 2046  id], verbose = F
-00002850: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00002860: 2020 0a20 2020 2020 2020 2020 2020 2023    .            #
-00002870: 206c 6162 656c 0a20 2020 2020 2020 2020   label.         
-00002880: 2020 206e 616d 655f 6c69 7374 203d 205b     name_list = [
-00002890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000028a0: 2066 2776 7761 7020 3d20 6469 7628 616d   f'vwap = div(am
-000028b0: 6f75 6e74 2c20 766f 6c29 272c 0a20 2020  ount, vol)',.   
-000028c0: 2020 2020 2020 2020 2020 2020 2066 2770               f'p
-000028d0: 7265 5f76 7761 7020 3d20 726f 6c6c 2873  re_vwap = roll(s
-000028e0: 6869 6674 2c20 7b63 6f6c 5f69 647d 2c20  hift, {col_id}, 
-000028f0: 7677 6170 2c20 7b63 6f6c 5f74 6964 7d2c  vwap, {col_tid},
-00002900: 2031 2927 2c0a 2020 2020 2020 2020 2020   1)',.          
-00002910: 2020 2020 2020 6627 7677 6170 5f72 6574        f'vwap_ret
-00002920: 203d 2072 6574 2870 7265 5f76 7761 702c   = ret(pre_vwap,
-00002930: 2076 7761 7029 272c 0a20 2020 2020 2020   vwap)',.       
-00002940: 2020 2020 2020 2020 2066 277b 636f 6c5f           f'{col_
-00002950: 6c61 6265 6c7d 203d 2072 6f6c 6c28 7368  label} = roll(sh
-00002960: 6966 742c 207b 636f 6c5f 6964 7d2c 2076  ift, {col_id}, v
-00002970: 7761 705f 7265 742c 207b 636f 6c5f 7469  wap_ret, {col_ti
-00002980: 647d 2c20 2d31 2927 2c0a 2020 2020 2020  d}, -1)',.      
-00002990: 2020 2020 2020 2020 2020 2320 276c 6162            # 'lab
-000029a0: 656c 5f72 6177 203d 206f 286c 6162 656c  el_raw = o(label
-000029b0: 2927 2c0a 2020 2020 2020 2020 2020 2020  )',.            
-000029c0: 2020 2020 6627 7b63 6f6c 5f6c 6162 656c      f'{col_label
-000029d0: 7d20 3d20 6167 6728 7a73 636f 7265 2c20  } = agg(zscore, 
-000029e0: 7b63 6f6c 5f74 6964 7d2c 207b 636f 6c5f  {col_tid}, {col_
-000029f0: 6c61 6265 6c7d 2927 2023 206d 6173 6b0a  label})' # mask.
-00002a00: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00002a10: 2020 2020 2020 2020 2020 646d 2e66 655f            dm.fe_
-00002a20: 676f 286e 616d 655f 6c69 7374 2c20 7665  go(name_list, ve
-00002a30: 7262 6f73 6520 3d20 4661 6c73 6529 0a0a  rbose = False)..
-00002a40: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
-00002a50: 736b 0a20 2020 2020 2020 2020 2020 206d  sk.            m
-00002a60: 6173 6b5f 7a64 7420 3d20 646d 2e64 665f  ask_zdt = dm.df_
-00002a70: 6469 6374 5b27 5430 275d 5b27 7063 745f  dict['T0']['pct_
-00002a80: 6368 6727 5d2e 746f 5f70 616e 6461 7328  chg'].to_pandas(
-00002a90: 292e 6162 7328 2920 3c20 392e 3835 0a20  ).abs() < 9.85. 
-00002aa0: 2020 2020 2020 2020 2020 2064 6d2e 7365             dm.se
-00002ab0: 745f 6d61 736b 286d 6173 6b5f 7a64 742c  t_mask(mask_zdt,
-00002ac0: 2027 7a64 7427 290a 2020 2020 2020 2020   'zdt').        
-00002ad0: 2020 2020 6d61 736b 5f61 6c6c 203d 2028      mask_all = (
-00002ae0: 7e6e 702e 6973 6e61 6e28 646d 2e64 665f  ~np.isnan(dm.df_
-00002af0: 6469 6374 5b27 5430 275d 5b63 6f6c 5f6c  dict['T0'][col_l
-00002b00: 6162 656c 5d2e 746f 5f6e 756d 7079 2829  abel].to_numpy()
-00002b10: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
-00002b20: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
-00002b30: 646d 2e73 6574 5f6d 6173 6b28 6d61 736b  dm.set_mask(mask
-00002b40: 5f61 6c6c 2c20 2761 6c6c 2729 0a20 2020  _all, 'all').   
-00002b50: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
-00002b60: 275b 2b5d 207a 6474 203d 207b 6d61 736b  '[+] zdt = {mask
-00002b70: 5f7a 6474 2e73 756d 2829 7d20 2f20 7b6c  _zdt.sum()} / {l
-00002b80: 656e 286d 6173 6b5f 7a64 7429 7d2c 207a  en(mask_zdt)}, z
-00002b90: 6474 5f72 6174 696f 203d 207b 6d61 736b  dt_ratio = {mask
-00002ba0: 5f7a 6474 2e73 756d 2829 202f 206c 656e  _zdt.sum() / len
-00002bb0: 286d 6173 6b5f 7a64 7429 7d27 290a 2020  (mask_zdt)}').  
-00002bc0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00002bd0: 6627 5b2b 5d20 616c 6c20 3d20 7b6d 6173  f'[+] all = {mas
-00002be0: 6b5f 616c 6c2e 7375 6d28 297d 202f 207b  k_all.sum()} / {
-00002bf0: 6c65 6e28 6d61 736b 5f61 6c6c 297d 2c20  len(mask_all)}, 
-00002c00: 616c 6c5f 7261 7469 6f20 3d20 7b6d 6173  all_ratio = {mas
-00002c10: 6b5f 616c 6c2e 7375 6d28 2920 2f20 6c65  k_all.sum() / le
-00002c20: 6e28 6d61 736b 5f61 6c6c 297d 2729 0a20  n(mask_all)}'). 
-00002c30: 2020 2020 2020 2020 2020 2078 203d 2064             x = d
-00002c40: 6d2e 6466 5f64 6963 745b 2754 3027 5d5b  m.df_dict['T0'][
-00002c50: 636f 6c5f 7469 645d 2e74 6f5f 6e75 6d70  col_tid].to_nump
-00002c60: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
-00002c70: 666f 7220 6b65 7920 696e 2073 6f72 7465  for key in sorte
-00002c80: 6428 6461 7465 5f64 6963 742e 6b65 7973  d(date_dict.keys
-00002c90: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-00002ca0: 2020 2020 2064 6174 655f 6265 6769 6e2c       date_begin,
-00002cb0: 2064 6174 655f 656e 6420 3d20 6461 7465   date_end = date
-00002cc0: 5f64 6963 745b 6b65 795d 0a20 2020 2020  _dict[key].     
-00002cd0: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-00002ce0: 7920 3d3d 2027 7472 6169 6e27 3a0a 2020  y == 'train':.  
-00002cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d00: 2020 6d61 736b 203d 2020 2878 203e 3d20    mask =  (x >= 
-00002d10: 6461 7465 5f62 6567 696e 2920 2620 2878  date_begin) & (x
-00002d20: 203c 2064 6174 655f 656e 6429 2023 2064   < date_end) # d
-00002d30: 726f 7020 3120 6461 790a 2020 2020 2020  rop 1 day.      
-00002d40: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00002d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d60: 2020 2020 6d61 736b 203d 2020 2878 203e      mask =  (x >
-00002d70: 3d20 6461 7465 5f62 6567 696e 2920 2620  = date_begin) & 
-00002d80: 2878 203c 3d20 6461 7465 5f65 6e64 290a  (x <= date_end).
-00002d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002da0: 2069 6620 6b65 7920 213d 2027 7465 7374   if key != 'test
-00002db0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00002dc0: 2020 2020 2020 206d 6173 6b20 263d 206d         mask &= m
-00002dd0: 6173 6b5f 616c 6c2e 6173 7479 7065 2862  ask_all.astype(b
-00002de0: 6f6f 6c29 0a20 2020 2020 2020 2020 2020  ool).           
-00002df0: 2020 2020 2020 2020 206d 6173 6b20 263d           mask &=
-00002e00: 206d 6173 6b5f 7a64 742e 6173 7479 7065   mask_zdt.astype
-00002e10: 2862 6f6f 6c29 0a20 2020 2020 2020 2020  (bool).         
-00002e20: 2020 2020 2020 2064 6d2e 7365 745f 6d61         dm.set_ma
-00002e30: 736b 286d 6173 6b2c 206d 6173 6b5f 6e61  sk(mask, mask_na
-00002e40: 6d65 203d 206b 6579 290a 2020 2020 2020  me = key).      
-00002e50: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00002e60: 2878 5b6d 6173 6b5d 2920 3e20 303a 0a20  (x[mask]) > 0:. 
-00002e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e80: 2020 2070 7269 6e74 2866 275b 2b5d 206d     print(f'[+] m
-00002e90: 6173 6b5f 6e61 6d65 203d 207b 6b65 793a  ask_name = {key:
-00002ea0: 3c31 317d 7c20 7b78 5b6d 6173 6b5d 2e6d  <11}| {x[mask].m
-00002eb0: 696e 2829 7d20 2d3e 207b 785b 6d61 736b  in()} -> {x[mask
-00002ec0: 5d2e 6d61 7828 297d 203d 207b 6d61 736b  ].max()} = {mask
-00002ed0: 2e73 756d 2829 7d27 290a 2020 2020 2020  .sum()}').      
-00002ee0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00002ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f00: 2020 2020 7072 696e 7428 6627 5b2b 5d20      print(f'[+] 
-00002f10: 6d61 736b 5f6e 616d 6520 3d20 7b6b 6579  mask_name = {key
-00002f20: 3a3c 3131 7d7c 206c 656e 203d 2030 2729  :<11}| len = 0')
-00002f30: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00002f40: 7368 6966 745f 310a 2020 2020 2020 2020  shift_1.        
-00002f50: 2020 2020 636f 6c73 5f73 6869 6674 5f31      cols_shift_1
-00002f60: 203d 205b 636f 6c20 666f 7220 636f 6c20   = [col for col 
-00002f70: 696e 2064 6d2e 6865 6164 2829 2e63 6f6c  in dm.head().col
-00002f80: 756d 6e73 2069 6620 636f 6c20 6e6f 7420  umns if col not 
-00002f90: 696e 205b 636f 6c5f 6964 2c20 636f 6c5f  in [col_id, col_
-00002fa0: 7469 642c 2063 6f6c 5f6c 6162 656c 5d20  tid, col_label] 
-00002fb0: 2b20 636f 6c73 5f74 6964 5d0a 2020 2020  + cols_tid].    
-00002fc0: 2020 2020 2020 2020 646d 2e66 655f 676f          dm.fe_go
-00002fd0: 285b 6627 7b63 6f6c 7d20 3d20 726f 6c6c  ([f'{col} = roll
-00002fe0: 2873 6869 6674 2c20 7473 5f63 6f64 652c  (shift, ts_code,
-00002ff0: 207b 636f 6c7d 2c20 7472 6164 655f 6461   {col}, trade_da
-00003000: 7465 2c20 3129 2720 666f 7220 636f 6c20  te, 1)' for col 
-00003010: 696e 2063 6f6c 735f 7368 6966 745f 315d  in cols_shift_1]
-00003020: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00003030: 6574 7572 6e20 646d 0a20 2020 2072 0100  eturn dm.    r..
-00003040: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
-00003050: 0072 0200 0000 da0d 7072 6570 726f 6365  .r......preproce
-00003060: 7373 696e 6704 0100 0073 0200 0000 0001  ssing....s......
-00003070: 720d 0000 0063 0000 0000 0000 0000 0000  r....c..........
-00003080: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
-00003090: 0000 0064 0153 0029 024e 61d6 0400 000a  ...d.S.).Na.....
-000030a0: 6465 6620 6765 745f 6466 5f6c 6162 656c  def get_df_label
-000030b0: 5f66 696e 616c 2864 662c 2063 6f6c 5f74  _final(df, col_t
-000030c0: 6964 2c20 636f 6c5f 6964 2c20 636f 6c73  id, col_id, cols
-000030d0: 5f70 7269 6365 2c20 6932 6a5f 6c69 7374  _price, i2j_list
-000030e0: 293a 0a20 2020 2063 6f6c 735f 6964 203d  ):.    cols_id =
-000030f0: 205b 636f 6c5f 7469 642c 2063 6f6c 5f69   [col_tid, col_i
-00003100: 645d 0a20 2020 2069 645f 6c69 7374 203d  d].    id_list =
-00003110: 205b 6e70 2e73 6f72 7428 6466 5b63 6f6c   [np.sort(df[col
-00003120: 5d2e 756e 6971 7565 2829 2920 666f 7220  ].unique()) for 
-00003130: 636f 6c20 696e 2063 6f6c 735f 6964 5d0a  col in cols_id].
-00003140: 2020 2020 7368 6170 6520 3d20 5b6c 656e      shape = [len
-00003150: 2878 2920 666f 7220 7820 696e 2069 645f  (x) for x in id_
-00003160: 6c69 7374 5d0a 2020 2020 6466 5f69 645f  list].    df_id_
-00003170: 616c 6c20 3d20 6765 745f 6466 5f69 645f  all = get_df_id_
-00003180: 616c 6c28 6964 5f6c 6973 742c 2063 6f6c  all(id_list, col
-00003190: 735f 6964 203d 2063 6f6c 735f 6964 290a  s_id = cols_id).
-000031a0: 2020 2020 6466 5f69 645f 616c 6c20 3d20      df_id_all = 
-000031b0: 6466 5f69 645f 616c 6c2e 6173 7479 7065  df_id_all.astype
-000031c0: 2864 665b 636f 6c73 5f69 645d 2e64 7479  (df[cols_id].dty
-000031d0: 7065 732e 746f 5f64 6963 7428 2929 0a0a  pes.to_dict())..
-000031e0: 2020 2020 5f64 665f 4c20 3d20 706c 2e66      _df_L = pl.f
-000031f0: 726f 6d5f 7061 6e64 6173 2864 665f 6964  rom_pandas(df_id
-00003200: 5f61 6c6c 290a 2020 2020 5f64 665f 5220  _all).    _df_R 
-00003210: 3d20 706c 2e66 726f 6d5f 7061 6e64 6173  = pl.from_pandas
-00003220: 2864 665b 636f 6c73 5f69 6420 2b20 636f  (df[cols_id + co
-00003230: 6c73 5f70 7269 6365 5d29 0a20 2020 2064  ls_price]).    d
-00003240: 665f 4c5f 5220 3d20 5f64 665f 4c2e 6a6f  f_L_R = _df_L.jo
-00003250: 696e 285f 6466 5f52 2c20 6f6e 203d 2063  in(_df_R, on = c
-00003260: 6f6c 735f 6964 2c20 686f 7720 3d20 276c  ols_id, how = 'l
-00003270: 6566 7427 290a 0a20 2020 205f 6466 5f4c  eft')..    _df_L
-00003280: 3220 3d20 5f64 665f 4c5b 636f 6c73 5f69  2 = _df_L[cols_i
-00003290: 645d 0a20 2020 2066 6f72 2063 6f6c 2069  d].    for col i
-000032a0: 6e20 636f 6c73 5f70 7269 6365 3a0a 2020  n cols_price:.  
-000032b0: 2020 2020 2020 6120 3d20 6e70 2e61 7363        a = np.asc
-000032c0: 6f6e 7469 6775 6f75 7361 7272 6179 2864  ontiguousarray(d
-000032d0: 665f 4c5f 525b 636f 6c5d 2e74 6f5f 6e75  f_L_R[col].to_nu
-000032e0: 6d70 7928 292e 7265 7368 6170 6528 7368  mpy().reshape(sh
-000032f0: 6170 6529 290a 2020 2020 2020 2020 666f  ape)).        fo
-00003300: 7220 2869 2c20 6a29 2069 6e20 6932 6a5f  r (i, j) in i2j_
-00003310: 6c69 7374 3a0a 2020 2020 2020 2020 2020  list:.          
-00003320: 2020 615f 6920 3d20 6765 745f 615f 7368    a_i = get_a_sh
-00003330: 6966 7428 612c 202d 3120 2a20 6929 0a20  ift(a, -1 * i). 
-00003340: 2020 2020 2020 2020 2020 2061 5f6a 203d             a_j =
-00003350: 2067 6574 5f61 5f73 6869 6674 2861 2c20   get_a_shift(a, 
-00003360: 2d31 202a 206a 290a 2020 2020 2020 2020  -1 * j).        
-00003370: 2020 2020 615f 6932 6a20 3d20 615f 6a20      a_i2j = a_j 
-00003380: 2f20 615f 6920 2d20 310a 2020 2020 2020  / a_i - 1.      
-00003390: 2020 2020 2020 615f 6932 6a5b 7e6e 702e        a_i2j[~np.
-000033a0: 6973 6669 6e69 7465 2861 5f69 326a 295d  isfinite(a_i2j)]
-000033b0: 203d 206e 702e 6e61 6e0a 2020 2020 2020   = np.nan.      
-000033c0: 2020 2020 2020 2320 6e61 6d65 203d 2066        # name = f
-000033d0: 274c 4142 454c 5f7b 636f 6c5b 305d 2e75  'LABEL_{col[0].u
-000033e0: 7070 6572 2829 7d7b 697d 5f7b 636f 6c5b  pper()}{i}_{col[
-000033f0: 305d 2e75 7070 6572 2829 7d7b 6a7d 270a  0].upper()}{j}'.
-00003400: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00003410: 203d 2066 274c 4142 454c 5f7b 636f 6c7d   = f'LABEL_{col}
-00003420: 5f7b 697d 5f7b 6a7d 270a 2020 2020 2020  _{i}_{j}'.      
-00003430: 2020 2020 2020 5f64 665f 4c32 203d 205f        _df_L2 = _
-00003440: 6466 5f4c 322e 7769 7468 5f63 6f6c 756d  df_L2.with_colum
-00003450: 6e73 2870 6c2e 5365 7269 6573 286e 616d  ns(pl.Series(nam
-00003460: 652c 2061 5f69 326a 2e72 6176 656c 2829  e, a_i2j.ravel()
-00003470: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00003480: 3332 2929 290a 0a20 2020 205f 6466 5f52  32)))..    _df_R
-00003490: 3220 3d20 5f64 665f 525b 636f 6c73 5f69  2 = _df_R[cols_i
-000034a0: 645d 0a20 2020 205f 6466 5f52 325f 4c32  d].    _df_R2_L2
-000034b0: 203d 205f 6466 5f52 322e 6a6f 696e 285f   = _df_R2.join(_
-000034c0: 6466 5f4c 322c 206f 6e20 3d20 636f 6c73  df_L2, on = cols
-000034d0: 5f69 642c 2068 6f77 203d 2027 6c65 6674  _id, how = 'left
-000034e0: 2729 0a20 2020 2063 6f6c 735f 6c61 6265  ').    cols_labe
-000034f0: 6c20 3d20 5b63 6f6c 2066 6f72 2063 6f6c  l = [col for col
-00003500: 2069 6e20 5f64 665f 5232 5f4c 322e 636f   in _df_R2_L2.co
-00003510: 6c75 6d6e 7320 6966 2063 6f6c 206e 6f74  lumns if col not
-00003520: 2069 6e20 636f 6c73 5f69 645d 2020 0a20   in cols_id]  . 
-00003530: 2020 2064 665f 6c61 6265 6c5f 6669 6e61     df_label_fina
-00003540: 6c20 3d20 5f64 665f 5232 5f4c 320a 2020  l = _df_R2_L2.  
-00003550: 2020 7265 7475 726e 2064 665f 6c61 6265    return df_labe
-00003560: 6c5f 6669 6e61 6c2c 2063 6f6c 735f 6c61  l_final, cols_la
-00003570: 6265 6c0a 0a72 0100 0000 7201 0000 0072  bel..r....r....r
-00003580: 0100 0000 7201 0000 0072 0200 0000 da09  ....r....r......
-00003590: 7072 655f 6c61 6265 6c48 0100 0073 0200  pre_labelH...s..
-000035a0: 0000 0001 720e 0000 0063 0000 0000 0000  ....r....c......
-000035b0: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
-000035c0: 0000 7304 0000 0064 0153 0029 024e 6122  ..s....d.S.).Na"
-000035d0: 0500 000a 2020 2020 2320 727a 2e6c 6762  ....    # rz.lgb
-000035e0: 0a20 2020 2069 6d70 6f72 7420 6c69 6768  .    import ligh
-000035f0: 7467 626d 2061 7320 6c67 623b 2070 7269  tgbm as lgb; pri
-00003600: 6e74 286c 6762 2e5f 5f76 6572 7369 6f6e  nt(lgb.__version
-00003610: 5f5f 2c20 6c67 622e 5f5f 6669 6c65 5f5f  __, lgb.__file__
-00003620: 290a 2020 2020 6672 6f6d 2072 756e 6e69  ).    from runni
-00003630: 6e67 7a2e 6d6f 6465 6c2e 7465 7374 5f6d  ngz.model.test_m
-00003640: 6f64 656c 5f61 6c6c 2069 6d70 6f72 7420  odel_all import 
-00003650: 6765 745f 7265 6772 6573 7369 6f6e 5f64  get_regression_d
-00003660: 6174 610a 2020 2020 585f 7472 6169 6e2c  ata.    X_train,
-00003670: 2079 5f74 7261 696e 2c20 585f 7661 6c69   y_train, X_vali
-00003680: 642c 2079 5f76 616c 6964 203d 2067 6574  d, y_valid = get
-00003690: 5f72 6567 7265 7373 696f 6e5f 6461 7461  _regression_data
-000036a0: 286e 203d 2031 6534 2c20 6d20 3d20 3130  (n = 1e4, m = 10
-000036b0: 302c 2073 6565 6420 3d20 3432 2c20 6e5f  0, seed = 42, n_
-000036c0: 7661 6c69 6420 3d20 3130 3029 0a0a 2020  valid = 100)..  
-000036d0: 2020 6d6f 6465 6c20 3d20 727a 2e6d 6f64    model = rz.mod
-000036e0: 656c 2e74 7265 652e 4c47 424d 6f64 656c  el.tree.LGBModel
-000036f0: 2829 0a20 2020 2070 6172 616d 7320 3d20  ().    params = 
-00003700: 727a 2e6f 7074 2e6f 7074 5f72 616e 646f  rz.opt.opt_rando
-00003710: 6d2e 6765 745f 7061 7261 6d73 5f6c 6762  m.get_params_lgb
-00003720: 2829 0a20 2020 2023 2070 6172 616d 7320  ().    # params 
-00003730: 3d20 4c47 424d 6f64 656c 2e67 6574 5f70  = LGBModel.get_p
-00003740: 6172 616d 7328 2770 6172 616d 735f 3127  arams('params_1'
-00003750: 290a 2020 2020 5879 5f64 6963 7420 3d20  ).    Xy_dict = 
-00003760: 7b27 585f 7472 6169 6e27 3a20 585f 7472  {'X_train': X_tr
-00003770: 6169 6e2c 2027 795f 7472 6169 6e27 3a20  ain, 'y_train': 
-00003780: 795f 7472 6169 6e7d 0a20 2020 2023 2064  y_train}.    # d
-00003790: 656c 2058 5f74 7261 696e 2c20 795f 7472  el X_train, y_tr
-000037a0: 6169 6e3b 2067 632e 636f 6c6c 6563 7428  ain; gc.collect(
-000037b0: 290a 2020 2020 6d6f 6465 6c2e 7472 6169  ).    model.trai
-000037c0: 6e28 7b27 585f 7472 6169 6e27 3a20 585f  n({'X_train': X_
-000037d0: 7472 6169 6e2c 2027 795f 7472 6169 6e27  train, 'y_train'
-000037e0: 3a20 795f 7472 6169 6e7d 2c20 7061 7261  : y_train}, para
-000037f0: 6d73 203d 2070 6172 616d 732c 206b 7761  ms = params, kwa
-00003800: 7267 733d 7b27 6672 6565 5879 273a 2046  rgs={'freeXy': F
-00003810: 616c 7365 2c20 2776 6572 626f 7365 273a  alse, 'verbose':
-00003820: 2035 307d 290a 2020 2020 6d6f 6465 6c2e   50}).    model.
-00003830: 6475 6d70 2866 277b 7061 7468 5f6f 7574  dump(f'{path_out
-00003840: 7075 747d 2f6d 6f64 656c 2e62 696e 2729  put}/model.bin')
-00003850: 0a20 2020 206d 6f64 656c 203d 2072 7a2e  .    model = rz.
-00003860: 6d6f 6465 6c2e 7472 6565 2e4c 4742 4d6f  model.tree.LGBMo
-00003870: 6465 6c28 292e 6c6f 6164 2866 277b 7061  del().load(f'{pa
-00003880: 7468 5f6f 7574 7075 747d 2f6d 6f64 656c  th_output}/model
-00003890: 2e62 696e 2729 0a20 2020 2079 5f70 7265  .bin').    y_pre
-000038a0: 6420 3d20 6d6f 6465 6c2e 7072 6564 6963  d = model.predic
-000038b0: 7428 5829 0a0a 2020 2020 2320 6c67 620a  t(X)..    # lgb.
-000038c0: 2020 2020 2320 696e 6974 5f73 636f 7265      # init_score
-000038d0: 0a20 2020 2064 7472 6169 6e20 3d20 6c67  .    dtrain = lg
-000038e0: 622e 4461 7461 7365 7428 585f 7472 6169  b.Dataset(X_trai
-000038f0: 6e2c 2079 5f74 7261 696e 2c20 7765 6967  n, y_train, weig
-00003900: 6874 203d 204e 6f6e 652c 2069 6e69 745f  ht = None, init_
-00003910: 7363 6f72 6520 3d20 4e6f 6e65 290a 2020  score = None).  
-00003920: 2020 2320 6465 6c20 585f 7472 6169 6e2c    # del X_train,
-00003930: 2079 5f74 7261 696e 3b20 6763 2e63 6f6c   y_train; gc.col
-00003940: 6c65 6374 2829 0a20 2020 2023 2076 6572  lect().    # ver
-00003950: 626f 7365 203d 2035 300a 2020 2020 6d6f  bose = 50.    mo
-00003960: 6465 6c20 3d20 6c67 622e 7472 6169 6e28  del = lgb.train(
-00003970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003980: 2070 6172 616d 732c 200a 2020 2020 2020   params, .      
-00003990: 2020 2020 2020 2020 2020 6474 7261 696e            dtrain
-000039a0: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-000039b0: 2020 2023 2076 616c 6964 5f73 6574 7320     # valid_sets 
-000039c0: 3d20 5b64 7661 6c69 645d 2c20 0a20 2020  = [dvalid], .   
-000039d0: 2020 2020 2020 2020 2020 2020 2023 2063               # c
-000039e0: 616c 6c62 6163 6b73 203d 205b 6c67 622e  allbacks = [lgb.
-000039f0: 6c6f 675f 6576 616c 7561 7469 6f6e 2876  log_evaluation(v
-00003a00: 6572 626f 7365 2c20 5472 7565 2069 6620  erbose, True if 
-00003a10: 7665 7262 6f73 6520 3e20 3020 656c 7365  verbose > 0 else
-00003a20: 2046 616c 7365 295d 2c0a 2020 2020 2020   False)],.      
-00003a30: 2020 2020 2020 2020 2020 2320 696e 6974            # init
-00003a40: 5f6d 6f64 656c 203d 206d 6f64 656c 5f62  _model = model_b
-00003a50: 6173 652c 0a20 2020 2020 2020 2020 2020  ase,.           
-00003a60: 2029 0a20 2020 206d 6f64 656c 2e73 6176   ).    model.sav
-00003a70: 655f 6d6f 6465 6c28 6627 7b70 6174 685f  e_model(f'{path_
-00003a80: 6f75 7470 7574 7d2f 6d6f 6465 6c2e 6269  output}/model.bi
-00003a90: 6e27 290a 2020 2020 6d6f 6465 6c20 3d20  n').    model = 
-00003aa0: 6c67 622e 426f 6f73 7465 7228 6d6f 6465  lgb.Booster(mode
-00003ab0: 6c5f 6669 6c65 3d66 277b 7061 7468 5f6f  l_file=f'{path_o
-00003ac0: 7574 7075 747d 2f6d 6f64 656c 2e62 696e  utput}/model.bin
-00003ad0: 2729 0a20 2020 2079 5f70 7265 6420 3d20  ').    y_pred = 
-00003ae0: 6d6f 6465 6c2e 7072 6564 6963 7428 5829  model.predict(X)
-00003af0: 0a20 2020 2072 0100 0000 7201 0000 0072  .    r....r....r
-00003b00: 0100 0000 7201 0000 0072 0200 0000 da0b  ....r....r......
-00003b10: 7472 6169 6e5f 6d6f 6465 6c69 0100 0073  train_modeli...s
-00003b20: 0200 0000 0001 720f 0000 0063 0000 0000  ......r....c....
-00003b30: 0000 0000 0000 0000 0000 0000 0100 0000  ................
-00003b40: 4300 0000 7304 0000 0064 0153 0029 024e  C...s....d.S.).N
-00003b50: 6176 0300 000a 2020 2020 6465 6620 665f  av....    def f_
-00003b60: 6d61 6769 635f 6c61 6265 6c28 792c 206d  magic_label(y, m
-00003b70: 6167 6963 5f6c 6162 656c 2c20 7665 7262  agic_label, verb
-00003b80: 6f73 6520 3d20 4661 6c73 6529 3a0a 2020  ose = False):.  
-00003b90: 2020 2020 2020 6966 206d 6167 6963 5f6c        if magic_l
-00003ba0: 6162 656c 2069 6e20 5b4e 6f6e 652c 2027  abel in [None, '
-00003bb0: 4e6f 6e65 275d 3a20 7265 7475 726e 2079  None']: return y
-00003bc0: 0a20 2020 2020 2020 206d 6574 686f 642c  .        method,
-00003bd0: 2077 203d 206d 6167 6963 5f6c 6162 656c   w = magic_label
-00003be0: 2e73 706c 6974 2827 2c27 290a 2020 2020  .split(',').    
-00003bf0: 2020 2020 7720 3d20 666c 6f61 7428 7729      w = float(w)
-00003c00: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-00003c10: 6f64 2069 6e20 5b27 6c6f 6727 2c20 2765  od in ['log', 'e
-00003c20: 7870 275d 3a0a 2020 2020 2020 2020 2020  xp']:.          
-00003c30: 2020 795f 7261 7720 3d20 792e 636f 7079    y_raw = y.copy
-00003c40: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00003c50: 6967 6e20 3d20 6e70 2e77 6865 7265 2879  ign = np.where(y
-00003c60: 203e 3d20 302c 2031 2c20 2d31 290a 2020   >= 0, 1, -1).  
-00003c70: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
-00003c80: 7920 3e20 300a 2020 2020 2020 2020 2020  y > 0.          
-00003c90: 2020 6966 206d 6574 686f 6420 3d3d 2027    if method == '
-00003ca0: 6c6f 6727 3a0a 2020 2020 2020 2020 2020  log':.          
-00003cb0: 2020 2020 2020 795b 6964 785d 203d 2073        y[idx] = s
-00003cc0: 6967 6e5b 6964 785d 202a 206e 702e 6c6f  ign[idx] * np.lo
-00003cd0: 6731 3028 3120 2b20 6e70 2e61 6273 2879  g10(1 + np.abs(y
-00003ce0: 5b69 6478 5d29 290a 2020 2020 2020 2020  [idx])).        
-00003cf0: 2020 2020 656c 6966 206d 6574 686f 6420      elif method 
-00003d00: 3d3d 2027 6578 7027 3a0a 2020 2020 2020  == 'exp':.      
-00003d10: 2020 2020 2020 2020 2020 795b 6964 785d            y[idx]
-00003d20: 203d 2073 6967 6e5b 6964 785d 202a 206e   = sign[idx] * n
-00003d30: 702e 6578 7028 302e 3031 202a 206e 702e  p.exp(0.01 * np.
-00003d40: 6162 7328 795b 6964 785d 2929 0a20 2020  abs(y[idx])).   
-00003d50: 2020 2020 2020 2020 2079 203d 2077 202a           y = w *
-00003d60: 2079 5f72 6177 202b 2028 3120 2d20 7729   y_raw + (1 - w)
-00003d70: 202a 2079 0a20 2020 2020 2020 2020 2020   * y.           
-00003d80: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
-00003d90: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00003da0: 6e74 2866 275b 2b5d 206d 6167 6963 5f6c  nt(f'[+] magic_l
-00003db0: 6162 656c 203d 207b 6d61 6769 635f 6c61  abel = {magic_la
-00003dc0: 6265 6c7d 2729 0a20 2020 2020 2020 2072  bel}').        r
-00003dd0: 6574 7572 6e20 790a 0a20 2020 2064 6566  eturn y..    def
-00003de0: 2072 756e 5f6d 6167 6963 5f6c 6162 656c   run_magic_label
-00003df0: 2879 2c20 6d61 6769 635f 6c61 6265 6c20  (y, magic_label 
-00003e00: 3d20 4e6f 6e65 293a 0a20 2020 2020 2020  = None):.       
-00003e10: 2069 6620 6d61 6769 635f 6c61 6265 6c20   if magic_label 
-00003e20: 696e 205b 4e6f 6e65 2c20 274e 6f6e 6527  in [None, 'None'
-00003e30: 5d3a 2072 6574 7572 6e20 790a 2020 2020  ]: return y.    
-00003e40: 2020 2020 666f 7220 6d61 6769 635f 6c61      for magic_la
-00003e50: 6265 6c5f 6920 696e 206d 6167 6963 5f6c  bel_i in magic_l
-00003e60: 6162 656c 2e73 706c 6974 2827 3a27 295b  abel.split(':')[
-00003e70: 313a 5d3a 0a20 2020 2020 2020 2020 2020  1:]:.           
-00003e80: 2079 203d 2066 5f6d 6167 6963 5f6c 6162   y = f_magic_lab
-00003e90: 656c 2879 2c20 6d61 6769 635f 6c61 6265  el(y, magic_labe
-00003ea0: 6c5f 692c 2076 6572 626f 7365 203d 2046  l_i, verbose = F
-00003eb0: 616c 7365 290a 2020 2020 2020 2020 7265  alse).        re
-00003ec0: 7475 726e 2079 0a20 2020 2072 0100 0000  turn y.    r....
-00003ed0: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-00003ee0: 0200 0000 da0e 706f 7374 7072 6f63 6573  ......postproces
-00003ef0: 7369 6e67 8b01 0000 7302 0000 0000 0172  sing....s......r
-00003f00: 1000 0000 6300 0000 0000 0000 0000 0000  ....c...........
-00003f10: 0000 0000 0001 0000 0043 0000 0073 0400  .........C...s..
-00003f20: 0000 6401 5300 2902 4e61 6503 0000 0a20  ..d.S.).Nae.... 
-00003f30: 2020 2064 6566 2067 6574 5f64 665f 6963     def get_df_ic
-00003f40: 2864 6d2c 2079 5f70 7265 642c 206e 616d  (dm, y_pred, nam
-00003f50: 655f 6c69 7374 203d 204e 6f6e 6529 3a0a  e_list = None):.
-00003f60: 2020 2020 2020 2020 646d 2e73 6574 5f62          dm.set_b
-00003f70: 795f 636f 6c28 2770 7265 6427 2c20 795f  y_col('pred', y_
-00003f80: 7072 6564 2e72 6573 6861 7065 282d 3129  pred.reshape(-1)
-00003f90: 290a 2020 2020 2020 2020 6966 206e 616d  ).        if nam
-00003fa0: 655f 6c69 7374 2069 7320 4e6f 6e65 3a0a  e_list is None:.
-00003fb0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00003fc0: 5f6c 6973 7420 3d20 5b0a 2020 2020 2020  _list = [.      
-00003fd0: 2020 2020 2020 2020 2020 2769 6320 3d20            'ic = 
-00003fe0: 6770 2869 632c 2074 6964 2c20 6c61 6265  gp(ic, tid, labe
-00003ff0: 6c2c 2070 7265 642c 206d 6173 6b3d 6d61  l, pred, mask=ma
-00004000: 736b 2927 2c0a 2020 2020 2020 2020 2020  sk)',.          
-00004010: 2020 2020 2020 2769 6370 6d20 3d20 6770        'icpm = gp
-00004020: 2869 6370 6d2c 2074 6964 2c20 6c61 6265  (icpm, tid, labe
-00004030: 6c2c 2070 7265 642c 206d 6173 6b3d 6d61  l, pred, mask=ma
-00004040: 736b 2927 2c0a 2020 2020 2020 2020 2020  sk)',.          
-00004050: 2020 2020 2020 2769 6370 6d67 203d 2067        'icpmg = g
-00004060: 7028 6963 706d 672c 2074 6964 2c20 6c61  p(icpmg, tid, la
-00004070: 6265 6c2c 2070 7265 642c 206d 6173 6b3d  bel, pred, mask=
-00004080: 6d61 736b 2927 2c0a 2020 2020 2020 2020  mask)',.        
-00004090: 2020 2020 5d0a 2020 2020 2020 2020 646d      ].        dm
-000040a0: 2e66 655f 676f 286e 616d 655f 6c69 7374  .fe_go(name_list
-000040b0: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
-000040c0: 6529 0a20 2020 2020 2020 2063 6f6c 7320  e).        cols 
-000040d0: 3d20 646d 2e6e 616d 655f 6c69 7374 5f32  = dm.name_list_2
-000040e0: 5f63 6f6c 7328 6e61 6d65 5f6c 6973 7429  _cols(name_list)
-000040f0: 0a20 2020 2020 2020 2064 665f 6963 203d  .        df_ic =
-00004100: 2064 6d2e 6765 745f 636f 6c73 5f70 616e   dm.get_cols_pan
-00004110: 6461 7328 636f 6c73 2c20 6466 5f6e 616d  das(cols, df_nam
-00004120: 6520 3d20 2754 302e 7469 6427 290a 2020  e = 'T0.tid').  
-00004130: 2020 2020 2020 646d 2e64 726f 7028 6e61        dm.drop(na
-00004140: 6d65 5f6c 6973 742c 2076 6572 626f 7365  me_list, verbose
-00004150: 203d 2046 616c 7365 290a 2020 2020 2020   = False).      
-00004160: 2020 7265 7475 726e 2064 665f 6963 0a0a    return df_ic..
-00004170: 2020 2020 6466 5f69 6420 3d20 727a 2e75      df_id = rz.u
-00004180: 7469 6c2e 6e70 792e 6765 745f 6466 5f69  til.npy.get_df_i
-00004190: 645f 616c 6c28 5b72 616e 6765 2878 2920  d_all([range(x) 
-000041a0: 666f 7220 7820 696e 206d 6173 6b5f 7465  for x in mask_te
-000041b0: 7374 5f72 6177 2e73 6861 7065 5d2c 2063  st_raw.shape], c
-000041c0: 6f6c 735f 6964 203d 205b 2774 6964 272c  ols_id = ['tid',
-000041d0: 2027 6964 275d 290a 2020 2020 646d 203d   'id']).    dm =
-000041e0: 2072 7a2e 4461 7461 4d61 7374 6572 2864   rz.DataMaster(d
-000041f0: 665f 6964 290a 2020 2020 646d 2e73 6574  f_id).    dm.set
-00004200: 5f6d 6173 6b28 6d61 736b 5f74 6573 745f  _mask(mask_test_
-00004210: 7261 772e 7265 7368 6170 6528 2d31 292c  raw.reshape(-1),
-00004220: 2027 6d61 736b 2729 0a20 2020 2064 6d2e   'mask').    dm.
-00004230: 7365 745f 6279 5f63 6f6c 2827 6c61 6265  set_by_col('labe
-00004240: 6c27 2c20 795f 7465 7374 5f72 6177 2e72  l', y_test_raw.r
-00004250: 6573 6861 7065 282d 3129 290a 0a20 2020  eshape(-1))..   
-00004260: 2064 665f 6963 203d 2067 6574 5f64 665f   df_ic = get_df_
-00004270: 6963 2864 6d2c 2079 5f70 7265 6429 232e  ic(dm, y_pred)#.
-00004280: 6d65 616e 2861 7869 7320 3d20 3029 0a20  mean(axis = 0). 
-00004290: 2020 2072 0100 0000 7201 0000 0072 0100     r....r....r..
-000042a0: 0000 7201 0000 0072 0200 0000 da07 6361  ..r....r......ca
-000042b0: 6c63 5f69 63a5 0100 0073 0200 0000 0001  lc_ic....s......
-000042c0: 7211 0000 0063 0000 0000 0000 0000 0000  r....c..........
-000042d0: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
-000042e0: 0000 0064 0153 0029 024e 754f 1400 000a  ...d.S.).NuO....
-000042f0: 696d 706f 7274 206f 730a 6f73 2e63 6864  import os.os.chd
-00004300: 6972 2827 2e2e 2f2e 2e2f 2729 0a70 7269  ir('../../').pri
-00004310: 6e74 2866 275b 2b5d 2063 7764 203d 207b  nt(f'[+] cwd = {
-00004320: 6f73 2e67 6574 6377 6428 297d 2c20 5f5f  os.getcwd()}, __
-00004330: 6669 6c65 5f5f 203d 207b 5f5f 6669 6c65  file__ = {__file
-00004340: 5f5f 2069 6620 225f 5f66 696c 655f 5f22  __ if "__file__"
-00004350: 2069 6e20 7661 7273 2829 2065 6c73 6520   in vars() else 
-00004360: 4e6f 6e65 7d27 290a 0a69 6d70 6f72 7420  None}')..import 
-00004370: 7379 730a 7379 732e 7061 7468 2e69 6e73  sys.sys.path.ins
-00004380: 6572 7428 302c 206f 732e 7061 7468 2e61  ert(0, os.path.a
-00004390: 6273 7061 7468 2827 2e2f 2729 290a 696d  bspath('./')).im
-000043a0: 706f 7274 206c 6967 6874 6762 6d20 6173  port lightgbm as
-000043b0: 206c 6762 3b20 7072 696e 7428 6c67 622e   lgb; print(lgb.
-000043c0: 5f5f 7665 7273 696f 6e5f 5f2c 206c 6762  __version__, lgb
-000043d0: 2e5f 5f66 696c 655f 5f29 0a23 2073 7973  .__file__).# sys
-000043e0: 2e70 6174 682e 696e 7365 7274 2830 2c20  .path.insert(0, 
-000043f0: 272f 5573 6572 732f 7275 6e6e 696e 677a  '/Users/runningz
-00004400: 2f70 726f 6a65 6374 2f72 756e 6e69 6e67  /project/running
-00004410: 7a2f 2729 0a69 6d70 6f72 7420 6e75 6d70  z/').import nump
-00004420: 7920 6173 206e 700a 696d 706f 7274 2070  y as np.import p
-00004430: 616e 6461 7320 6173 2070 640a 696d 706f  andas as pd.impo
-00004440: 7274 2072 756e 6e69 6e67 7a20 6173 2072  rt runningz as r
-00004450: 7a0a 6672 6f6d 2072 756e 6e69 6e67 7a2e  z.from runningz.
-00004460: 7574 696c 2e63 6c73 7320 696d 706f 7274  util.clss import
-00004470: 2067 6574 5f73 7562 636c 6173 735f 6279   get_subclass_by
-00004480: 5f6e 616d 650a 6672 6f6d 2072 756e 6e69  _name.from runni
-00004490: 6e67 7a2e 6665 2e70 7265 7061 7265 5f64  ngz.fe.prepare_d
-000044a0: 6174 612e 6261 7369 635f 6461 7461 2069  ata.basic_data i
-000044b0: 6d70 6f72 7420 2a0a 6672 6f6d 2072 756e  mport *.from run
-000044c0: 6e69 6e67 7a2e 6665 2e75 7469 6c2e 7574  ningz.fe.util.ut
-000044d0: 696c 2069 6d70 6f72 7420 7375 6273 616d  il import subsam
-000044e0: 706c 652c 2067 6574 5f74 7261 696e 5f76  ple, get_train_v
-000044f0: 616c 6964 2c20 6765 745f 6466 5f69 630a  alid, get_df_ic.
-00004500: 6672 6f6d 2072 756e 6e69 6e67 7a2e 6d6f  from runningz.mo
-00004510: 6465 6c2e 7472 6565 2069 6d70 6f72 7420  del.tree import 
-00004520: 4c47 424d 6f64 656c 2061 7320 4d6f 6465  LGBModel as Mode
-00004530: 6c0a 6672 6f6d 2072 756e 6e69 6e67 7a2e  l.from runningz.
-00004540: 7574 696c 2e75 7469 6c20 696d 706f 7274  util.util import
-00004550: 206d 795f 7072 696e 7420 6173 2070 7269   my_print as pri
-00004560: 6e74 0a66 726f 6d20 7275 6e6e 696e 677a  nt.from runningz
-00004570: 2e75 7469 6c2e 7574 696c 2069 6d70 6f72  .util.util impor
-00004580: 7420 6469 6374 5f32 5f73 7472 0a43 4f4e  t dict_2_str.CON
-00004590: 5354 2e4d 595f 5052 494e 5420 3d20 4661  ST.MY_PRINT = Fa
-000045a0: 6c73 650a 727a 2e54 494d 4552 2829 0a0a  lse.rz.TIMER()..
-000045b0: 2320 7061 7468 5f64 6963 7420 3d20 272f  # path_dict = '/
-000045c0: 5573 6572 732f 7275 6e6e 696e 677a 2f70  Users/runningz/p
-000045d0: 726f 6a65 6374 2f72 756e 6e69 6e67 7a2f  roject/runningz/
-000045e0: 7275 6e6e 696e 677a 2f66 652f 5f63 6163  runningz/fe/_cac
-000045f0: 6865 5f2f 3230 3233 3037 3239 2f44 4542  he_/20230729/DEB
-00004600: 5547 5f32 3032 3330 3732 395f 3136 3030  UG_20230729_1600
-00004610: 3332 5f30 2e32 3333 315f 3135 312e 6469  32_0.2331_151.di
-00004620: 6374 270a 2320 7061 7468 5f64 6174 6120  ct'.# path_data 
-00004630: 3d20 272f 5573 6572 732f 7275 6e6e 696e  = '/Users/runnin
-00004640: 677a 2f70 726f 6a65 6374 2f72 756e 6e69  gz/project/runni
-00004650: 6e67 7a2f 7275 6e6e 696e 677a 2f66 652f  ngz/runningz/fe/
-00004660: 5f63 6163 6865 5f2f 3230 3233 3037 3239  _cache_/20230729
-00004670: 2f44 4542 5547 2e64 6174 615f 636f 6e66  /DEBUG.data_conf
-00004680: 6967 270a 0a70 6174 685f 6469 6374 203d  ig'..path_dict =
-00004690: 2027 2f68 6f6d 652f 7278 2f70 726f 6a65   '/home/rx/proje
-000046a0: 6374 2f72 756e 6e69 6e67 7a2f 6665 2f5f  ct/runningz/fe/_
-000046b0: 6361 6368 655f 2f32 3032 3330 3732 392f  cache_/20230729/
-000046c0: 4445 4255 475f 3230 3233 3037 3330 5f30  DEBUG_20230730_0
-000046d0: 3934 3734 355f 302e 3236 3533 5f34 3337  94745_0.2653_437
-000046e0: 2e64 6963 7427 0a70 6174 685f 6461 7461  .dict'.path_data
-000046f0: 203d 2027 2f68 6f6d 652f 7278 2f70 726f   = '/home/rx/pro
-00004700: 6a65 6374 2f72 756e 6e69 6e67 7a2f 6665  ject/runningz/fe
-00004710: 2f5f 6361 6368 655f 2f32 3032 3330 3732  /_cache_/2023072
-00004720: 392f 4445 4255 472e 6461 7461 5f63 6f6e  9/DEBUG.data_con
-00004730: 6669 6727 0a70 6174 685f 6469 6374 5f6f  fig'.path_dict_o
-00004740: 7468 6572 203d 205b 0a20 2020 2027 2f68  ther = [.    '/h
-00004750: 6f6d 652f 7278 2f70 726f 6a65 6374 2f72  ome/rx/project/r
-00004760: 756e 6e69 6e67 7a2f 6665 2f5f 6361 6368  unningz/fe/_cach
-00004770: 655f 2f32 3032 3330 3733 302f 6f70 656e  e_/20230730/open
-00004780: 5f30 5f31 5f32 3032 3330 3733 305f 3135  _0_1_20230730_15
-00004790: 3237 3037 5f30 2e33 3038 365f 3330 382e  2707_0.3086_308.
-000047a0: 6469 6374 272c 0a20 2020 2027 2f68 6f6d  dict',.    '/hom
-000047b0: 652f 7278 2f70 726f 6a65 6374 2f72 756e  e/rx/project/run
-000047c0: 6e69 6e67 7a2f 6665 2f5f 6361 6368 655f  ningz/fe/_cache_
-000047d0: 2f32 3032 3330 3733 302f 636c 6f73 655f  /20230730/close_
-000047e0: 305f 315f 3230 3233 3037 3330 5f32 3132  0_1_20230730_212
-000047f0: 3530 335f 302e 3038 3839 5f32 3335 2e64  503_0.0889_235.d
-00004800: 6963 7427 2c0a 5d0a 666f 7220 7020 696e  ict',.].for p in
-00004810: 2070 6174 685f 6469 6374 5f6f 7468 6572   path_dict_other
-00004820: 3a0a 2020 2020 727a 2e6c 6f61 645f 6a73  :.    rz.load_js
-00004830: 6f6e 2870 290a 0a23 202d 2d2d 2d2d 2d2d  on(p)..# -------
-00004840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004860: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 636f  -------------.co
-000048a0: 6c73 5f64 6963 745f 696e 6974 203d 2072  ls_dict_init = r
-000048b0: 7a2e 6c6f 6164 5f6a 736f 6e28 7061 7468  z.load_json(path
-000048c0: 5f64 6963 7429 0a64 6174 615f 636f 6e66  _dict).data_conf
-000048d0: 6967 203d 2072 7a2e 4449 4354 2872 7a2e  ig = rz.DICT(rz.
-000048e0: 6c6f 6164 5f6a 736f 6e28 7061 7468 5f64  load_json(path_d
-000048f0: 6174 6129 290a 0a23 2064 6174 615f 636f  ata))..# data_co
-00004900: 6e66 6967 5b27 6461 7465 5f64 6963 7427  nfig['date_dict'
-00004910: 5d5b 2761 6c6c 275d 5b30 5d20 2020 3d20  ]['all'][0]   = 
-00004920: 3230 3130 3031 3031 0a23 2064 6174 615f  20100101.# data_
-00004930: 636f 6e66 6967 5b27 6461 7465 5f64 6963  config['date_dic
-00004940: 7427 5d5b 2774 7261 696e 275d 5b30 5d20  t']['train'][0] 
-00004950: 3d20 3230 3130 3031 3031 0a23 2064 6174  = 20100101.# dat
-00004960: 615f 636f 6e66 6967 5b27 6461 7465 5f64  a_config['date_d
-00004970: 6963 7427 5d5b 2768 6973 7427 5d5b 305d  ict']['hist'][0]
-00004980: 203d 2032 3031 3030 3130 310a 6461 7465   = 20100101.date
-00004990: 5f64 6963 7420 3d20 7b0a 2020 2020 2761  _dict = {.    'a
-000049a0: 6c6c 273a 2020 2020 205b 3230 3137 3031  ll':     [201701
-000049b0: 3031 2c20 3230 3139 3132 3331 5d2c 0a20  01, 20191231],. 
-000049c0: 2020 2027 6869 7374 273a 2020 2020 5b32     'hist':    [2
-000049d0: 3031 3730 3130 312c 2032 3031 3831 3233  0170101, 2018123
-000049e0: 315d 2c0a 2020 2020 2774 7261 696e 273a  1],.    'train':
-000049f0: 2020 205b 3230 3137 3031 3031 2c20 3230     [20170101, 20
-00004a00: 3138 3132 3331 5d2c 0a20 2020 2027 7465  181231],.    'te
-00004a10: 7374 273a 2020 2020 5b32 3031 3930 3130  st':    [2019010
-00004a20: 312c 2032 3031 3931 3233 315d 2c20 2320  1, 20191231], # 
-00004a30: e4bf 9de7 9599 e6b6 a8e8 b78c e581 9ce5  ................
-00004a40: 928c 6e61 6ee7 9a84 0a20 2020 2027 7661  ..nan....    'va
-00004a50: 6c69 6427 3a20 2020 5b32 3031 3930 3130  lid':   [2019010
-00004a60: 312c 2032 3031 3931 3233 315d 2c20 2320  1, 20191231], # 
-00004a70: 7661 6c69 64e6 98af e58e bbe6 8e89 e6b6  valid...........
-00004a80: a8e8 b78c e581 9ce5 928c 6e61 6ee7 9a84  ..........nan...
-00004a90: 0a20 2020 2027 7661 6c69 645f 3127 3a20  .    'valid_1': 
-00004aa0: 5b32 3031 3930 3130 312c 2032 3031 3930  [20190101, 20190
-00004ab0: 3633 315d 2c20 2320 7661 6c69 64e6 98af  631], # valid...
-00004ac0: e58e bbe6 8e89 e6b6 a8e8 b78c e581 9ce5  ................
-00004ad0: 928c 6e61 6ee7 9a84 0a20 2020 2027 7661  ..nan....    'va
-00004ae0: 6c69 645f 3227 3a20 5b32 3031 3930 3730  lid_2': [2019070
-00004af0: 312c 2032 3031 3931 3233 315d 2c20 2320  1, 20191231], # 
-00004b00: 7661 6c69 64e6 98af e58e bbe6 8e89 e6b6  valid...........
-00004b10: a8e8 b78c e581 9ce5 928c 6e61 6ee7 9a84  ..........nan...
-00004b20: 0a7d 0a66 6f72 206b 6579 2069 6e20 6461  .}.for key in da
-00004b30: 7465 5f64 6963 743a 0a20 2020 2064 6174  te_dict:.    dat
-00004b40: 655f 6469 6374 5b6b 6579 5d20 3d20 5b69  e_dict[key] = [i
-00004b50: 6e74 2878 2920 666f 7220 7820 696e 2028  nt(x) for x in (
-00004b60: 6e70 2e61 7272 6179 2864 6174 655f 6469  np.array(date_di
-00004b70: 6374 5b6b 6579 5d29 202b 2030 3030 3030  ct[key]) + 00000
-00004b80: 295d 0a64 6174 615f 636f 6e66 6967 5b27  )].data_config['
-00004b90: 6461 7465 5f64 6963 7427 5d20 3d20 6461  date_dict'] = da
-00004ba0: 7465 5f64 6963 740a 7072 696e 7428 6469  te_dict.print(di
-00004bb0: 6374 5f32 5f73 7472 2864 6174 615f 636f  ct_2_str(data_co
-00004bc0: 6e66 6967 2929 0a0a 0a63 6f6c 5f69 6420  nfig))...col_id 
-00004bd0: 3d20 636f 6c73 5f64 6963 745f 696e 6974  = cols_dict_init
-00004be0: 5b27 636f 6c5f 6964 275d 0a63 6f6c 5f6c  ['col_id'].col_l
-00004bf0: 6162 656c 203d 2063 6f6c 735f 6469 6374  abel = cols_dict
-00004c00: 5f69 6e69 745b 2763 6f6c 5f6c 6162 656c  _init['col_label
-00004c10: 275d 0a63 6f6c 5f74 6964 203d 2063 6f6c  '].col_tid = col
-00004c20: 735f 6469 6374 5f69 6e69 745b 2763 6f6c  s_dict_init['col
-00004c30: 5f74 6964 275d 0a63 6f6c 735f 7469 6420  _tid'].cols_tid 
-00004c40: 3d20 636f 6c73 5f64 6963 745f 696e 6974  = cols_dict_init
-00004c50: 5b27 636f 6c73 5f74 6964 275d 0a63 6f6c  ['cols_tid'].col
-00004c60: 735f 6665 6120 3d20 636f 6c73 5f64 6963  s_fea = cols_dic
-00004c70: 745f 696e 6974 5b27 636f 6c73 5f66 6561  t_init['cols_fea
-00004c80: 275d 0a63 6f6c 735f 6e6f 7420 3d20 2063  '].cols_not =  c
-00004c90: 6f6c 735f 6469 6374 5f69 6e69 745b 2763  ols_dict_init['c
-00004ca0: 6f6c 735f 6e6f 7427 5d20 2b20 636f 6c73  ols_not'] + cols
-00004cb0: 5f64 6963 745f 696e 6974 5b27 636f 6c73  _dict_init['cols
-00004cc0: 5f6c 6162 656c 275d 202b 205b 636f 6c5f  _label'] + [col_
-00004cd0: 7469 642c 2063 6f6c 5f6c 6162 656c 5d20  tid, col_label] 
-00004ce0: 2b20 636f 6c73 5f74 6964 0a70 7269 6e74  + cols_tid.print
-00004cf0: 2863 6f6c 5f69 642c 2063 6f6c 5f6c 6162  (col_id, col_lab
-00004d00: 656c 2c20 636f 6c5f 7469 642c 2063 6f6c  el, col_tid, col
-00004d10: 735f 7469 6429 0a0a 7072 696e 7428 275b  s_tid)..print('[
-00004d20: 696e 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d  init] <---------
-00004d30: 2d20 7265 6164 5f64 6174 6120 202d 2d2d  - read_data  ---
-00004d40: 2d2d 2d2d 2d2d 3e20 2729 0a64 6d20 3d20  ------> ').dm = 
-00004d50: 6765 745f 7375 6263 6c61 7373 5f62 795f  get_subclass_by_
-00004d60: 6e61 6d65 2842 6173 6544 6174 612c 2064  name(BaseData, d
-00004d70: 6174 615f 636f 6e66 6967 2e64 6174 615f  ata_config.data_
-00004d80: 7265 6164 6572 2928 292e 6c6f 6164 2864  reader)().load(d
-00004d90: 6174 615f 636f 6e66 6967 290a 7072 696e  ata_config).prin
-00004da0: 7428 6627 5b2b 5d20 646d 2e73 6861 7065  t(f'[+] dm.shape
-00004db0: 2829 203d 207b 646d 2e73 6861 7065 2829  () = {dm.shape()
-00004dc0: 7d27 290a 6966 2046 616c 7365 3a0a 2020  }').if False:.  
-00004dd0: 2020 7072 696e 7428 275b 696e 6974 5d20    print('[init] 
-00004de0: 3c2d 2d2d 2d2d 2d2d 2d2d 2d20 7375 6273  <---------- subs
-00004df0: 616d 706c 6520 202d 2d2d 2d2d 2d2d 2d2d  ample  ---------
-00004e00: 3e20 2729 0a20 2020 2073 7562 7361 6d70  > ').    subsamp
-00004e10: 6c65 2864 6d2c 2070 6374 203d 2030 2e31  le(dm, pct = 0.1
-00004e20: 290a 2020 2020 7072 696e 7428 6627 5b2b  ).    print(f'[+
-00004e30: 5d20 646d 2e73 6861 7065 2829 203d 207b  ] dm.shape() = {
-00004e40: 646d 2e73 6861 7065 2829 7d27 290a 2020  dm.shape()}').  
-00004e50: 2020 0a70 7269 6e74 2827 5b69 6e69 745d    .print('[init]
-00004e60: 203c 2d2d 2d2d 2d2d 2d2d 2d2d 2066 655f   <---------- fe_
-00004e70: 676f 202d 2d2d 2d2d 2d2d 2d2d 2d3e 2729  go ---------->')
-00004e80: 0a64 6d2e 6665 5f67 6f28 636f 6c73 5f64  .dm.fe_go(cols_d
-00004e90: 6963 745f 696e 6974 5b27 6e61 6d65 5f6c  ict_init['name_l
-00004ea0: 6973 745f 6261 7369 6327 5d29 200a 646d  ist_basic']) .dm
-00004eb0: 2e66 655f 676f 2863 6f6c 735f 6469 6374  .fe_go(cols_dict
-00004ec0: 5f69 6e69 745b 2763 6f6c 735f 6665 6127  _init['cols_fea'
-00004ed0: 5d29 0a0a 666f 7220 7069 2c20 7061 7468  ])..for pi, path
-00004ee0: 2069 6e20 656e 756d 6572 6174 6528 7061   in enumerate(pa
-00004ef0: 7468 5f64 6963 745f 6f74 6865 7229 3a0a  th_dict_other):.
-00004f00: 2020 2020 7072 696e 7428 6627 5b69 6e69      print(f'[ini
-00004f10: 745d 203c 2d2d 2d2d 2d2d 2d2d 2d2d 2066  t] <---------- f
-00004f20: 655f 676f 5f7b 7069 7d20 2d2d 2d2d 2d2d  e_go_{pi} ------
-00004f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f40: 2d2d 2d2d 2d2d 2d2d 3e27 290a 2020 2020  -------->').    
-00004f50: 6469 6374 5f6f 7468 6572 203d 2072 7a2e  dict_other = rz.
-00004f60: 6c6f 6164 5f6a 736f 6e28 7061 7468 290a  load_json(path).
-00004f70: 2020 2020 636f 6c73 5f6e 6f74 202b 3d20      cols_not += 
-00004f80: 2064 6963 745f 6f74 6865 725b 2763 6f6c   dict_other['col
-00004f90: 735f 6e6f 7427 5d20 2b20 6469 6374 5f6f  s_not'] + dict_o
-00004fa0: 7468 6572 5b27 636f 6c73 5f6c 6162 656c  ther['cols_label
-00004fb0: 275d 0a20 2020 2064 6d2e 6665 5f67 6f28  '].    dm.fe_go(
-00004fc0: 6469 6374 5f6f 7468 6572 5b27 6e61 6d65  dict_other['name
-00004fd0: 5f6c 6973 745f 6261 7369 6327 5d29 200a  _list_basic']) .
-00004fe0: 2020 2020 646d 2e66 655f 676f 2864 6963      dm.fe_go(dic
-00004ff0: 745f 6f74 6865 725b 2763 6f6c 735f 6665  t_other['cols_fe
-00005000: 6127 5d29 0a0a 2320 2d2d 2d2d 2d2d 2d2d  a'])..# --------
-00005010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a70 7269  ------------.pri
-00005070: 6e74 2827 5b69 6e69 745d 203c 2d2d 2d2d  nt('[init] <----
-00005080: 2d2d 2d2d 2d2d 2067 6574 5f64 6174 6120  ------ get_data 
-00005090: 202d 2d2d 2d2d 2d2d 2d2d 2d3e 2729 0a63   ---------->').c
-000050a0: 6f6c 7320 3d20 5b78 2066 6f72 2078 2069  ols = [x for x i
-000050b0: 6e20 646d 2e68 6561 6428 292e 636f 6c75  n dm.head().colu
-000050c0: 6d6e 7320 6966 2078 206e 6f74 2069 6e20  mns if x not in 
-000050d0: 636f 6c73 5f6e 6f74 5d0a 636f 6c73 5f66  cols_not].cols_f
-000050e0: 6561 203d 2064 6d2e 636f 6c73 5f69 735f  ea = dm.cols_is_
-000050f0: 6e75 6d62 6572 2863 6f6c 7329 0a63 6f6c  number(cols).col
-00005100: 735f 6665 6120 3d20 5b78 2066 6f72 2078  s_fea = [x for x
-00005110: 2069 6e20 636f 6c73 5f66 6561 2069 6620   in cols_fea if 
-00005120: 727a 2e44 6174 614d 6173 7465 7228 292e  rz.DataMaster().
-00005130: 6e61 6d65 722e 6765 745f 6465 6570 2878  namer.get_deep(x
-00005140: 2920 3c3d 2037 5d0a 636f 6c73 5f66 6561  ) <= 7].cols_fea
-00005150: 203d 205b 7820 666f 7220 7820 696e 2063   = [x for x in c
-00005160: 6f6c 735f 6665 6120 6966 2072 7a2e 4461  ols_fea if rz.Da
-00005170: 7461 4d61 7374 6572 2829 2e6e 616d 6572  taMaster().namer
-00005180: 2e67 6574 5f77 696e 646f 7728 7829 203c  .get_window(x) <
-00005190: 3d20 3135 305d 0a63 6f6c 735f 6665 615f  = 150].cols_fea_
-000051a0: 6465 6570 203d 205b 727a 2e44 6174 614d  deep = [rz.DataM
-000051b0: 6173 7465 7228 292e 6e61 6d65 722e 6765  aster().namer.ge
-000051c0: 745f 6465 6570 2878 2920 666f 7220 7820  t_deep(x) for x 
-000051d0: 696e 2063 6f6c 735f 6665 615d 0a70 7269  in cols_fea].pri
-000051e0: 6e74 2866 275b 2b5d 2064 6565 705f 7663  nt(f'[+] deep_vc
-000051f0: 203d 200a 7b70 642e 5365 7269 6573 2863   = .{pd.Series(c
-00005200: 6f6c 735f 6665 615f 6465 6570 292e 7661  ols_fea_deep).va
-00005210: 6c75 655f 636f 756e 7473 2829 2e73 6f72  lue_counts().sor
-00005220: 745f 696e 6465 7828 292e 746f 5f73 7472  t_index().to_str
-00005230: 696e 6728 297d 2729 0a63 6f6c 735f 6665  ing()}').cols_fe
-00005240: 615f 7769 6e64 6f77 203d 205b 727a 2e44  a_window = [rz.D
-00005250: 6174 614d 6173 7465 7228 292e 6e61 6d65  ataMaster().name
-00005260: 722e 6765 745f 7769 6e64 6f77 2878 2920  r.get_window(x) 
-00005270: 666f 7220 7820 696e 2063 6f6c 735f 6665  for x in cols_fe
-00005280: 615d 0a70 7269 6e74 2866 275b 2b5d 2077  a].print(f'[+] w
-00005290: 696e 646f 775f 7663 203d 200a 7b70 642e  indow_vc = .{pd.
-000052a0: 5365 7269 6573 2863 6f6c 735f 6665 615f  Series(cols_fea_
-000052b0: 7769 6e64 6f77 292e 7661 6c75 655f 636f  window).value_co
-000052c0: 756e 7473 2829 2e73 6f72 745f 696e 6465  unts().sort_inde
-000052d0: 7828 292e 746f 5f73 7472 696e 6728 297d  x().to_string()}
-000052e0: 2729 0a58 5f74 7261 696e 2c20 795f 7472  ').X_train, y_tr
-000052f0: 6169 6e2c 2058 5f76 616c 6964 2c20 795f  ain, X_valid, y_
-00005300: 7661 6c69 6420 3d20 6765 745f 7472 6169  valid = get_trai
-00005310: 6e5f 7661 6c69 6428 646d 2c20 636f 6c73  n_valid(dm, cols
-00005320: 5f66 6561 2c20 636f 6c5f 6c61 6265 6c2c  _fea, col_label,
-00005330: 206e 5f6a 6f62 7320 3d20 3429 0a0a 7072   n_jobs = 4)..pr
-00005340: 696e 7428 275b 696e 6974 5d20 3c2d 2d2d  int('[init] <---
-00005350: 2d2d 2d2d 2d2d 2d20 6d6f 6465 6c20 2d2d  ------- model --
-00005360: 2d2d 2d2d 2d2d 2d2d 3e27 290a 7061 7261  -------->').para
-00005370: 6d73 203d 204d 6f64 656c 2e67 6574 5f70  ms = Model.get_p
-00005380: 6172 616d 7328 2770 6172 616d 735f 3227  arams('params_2'
-00005390: 290a 7061 7261 6d73 5b27 6e5f 6573 7469  ).params['n_esti
-000053a0: 6d61 746f 7273 275d 203d 2031 3530 300a  mators'] = 1500.
-000053b0: 7072 696e 7428 6627 5b2b 5d20 7061 7261  print(f'[+] para
-000053c0: 6d73 203d 207b 7061 7261 6d73 7d27 290a  ms = {params}').
-000053d0: 6d6f 6465 6c20 3d20 4d6f 6465 6c28 290a  model = Model().
-000053e0: 727a 2e54 494d 4552 2829 0a6d 6f64 656c  rz.TIMER().model
-000053f0: 2e74 7261 696e 287b 2758 5f74 7261 696e  .train({'X_train
-00005400: 273a 2058 5f74 7261 696e 2c20 2779 5f74  ': X_train, 'y_t
-00005410: 7261 696e 273a 2079 5f74 7261 696e 2c20  rain': y_train, 
-00005420: 0a20 2020 2020 2020 2020 2020 2020 2758  .             'X
-00005430: 5f76 616c 6964 273a 2058 5f76 616c 6964  _valid': X_valid
-00005440: 2c20 2779 5f76 616c 6964 273a 2079 5f76  , 'y_valid': y_v
-00005450: 616c 6964 7d2c 200a 2020 2020 2020 2020  alid}, .        
-00005460: 2020 2020 7061 7261 6d73 203d 207b 2a2a      params = {**
-00005470: 7061 7261 6d73 7d2c 206b 7761 7267 7320  params}, kwargs 
-00005480: 3d20 7b27 7665 7262 6f73 6527 3a20 3530  = {'verbose': 50
-00005490: 7d29 0a72 7a2e 5449 4d45 5228 290a 6466  }).rz.TIMER().df
-000054a0: 5f69 6d70 203d 206d 6f64 656c 2e67 6574  _imp = model.get
-000054b0: 5f64 665f 696d 7028 636f 6c73 5f66 6561  _df_imp(cols_fea
-000054c0: 2c20 706c 6f74 203d 2054 7275 652c 206b  , plot = True, k
-000054d0: 203d 2033 3029 0a0a 7072 696e 7428 275b   = 30)..print('[
-000054e0: 696e 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d  init] <---------
-000054f0: 2d20 7363 6f72 6520 2d2d 2d2d 2d2d 2d2d  - score --------
-00005500: 2d2d 3e27 290a 6d61 736b 5f6e 616d 6520  -->').mask_name 
-00005510: 3d20 2776 616c 6964 270a 6d61 736b 203d  = 'valid'.mask =
-00005520: 2064 6d2e 6d61 736b 6572 2e6d 6173 6b5f   dm.masker.mask_
-00005530: 4449 4354 5b6d 6173 6b5f 6e61 6d65 5d5b  DICT[mask_name][
-00005540: 646d 2e6d 6173 6b65 722e 6964 785f 4449  dm.masker.idx_DI
-00005550: 4354 5b6d 6173 6b5f 6e61 6d65 5d5d 0a64  CT[mask_name]].d
-00005560: 6d5f 6920 3d20 727a 2e44 6174 614d 6173  m_i = rz.DataMas
-00005570: 7465 7228 646d 2e67 6574 5f63 6f6c 735f  ter(dm.get_cols_
-00005580: 7061 6e64 6173 285b 636f 6c5f 7469 642c  pandas([col_tid,
-00005590: 2063 6f6c 5f6c 6162 656c 5d2c 206d 6173   col_label], mas
-000055a0: 6b5f 6e61 6d65 203d 206d 6173 6b5f 6e61  k_name = mask_na
-000055b0: 6d65 2929 0a64 6d5f 692e 7365 745f 6d61  me)).dm_i.set_ma
-000055c0: 736b 286d 6173 6b2c 206d 6173 6b5f 6e61  sk(mask, mask_na
-000055d0: 6d65 290a 0a79 5f70 7265 645f 6c69 7374  me)..y_pred_list
-000055e0: 203d 204d 6f64 656c 2e6d 6f64 656c 5f70   = Model.model_p
-000055f0: 7265 6469 6374 286d 6f64 656c 2c20 585f  redict(model, X_
-00005600: 7661 6c69 642c 206b 203d 2031 3030 290a  valid, k = 100).
-00005610: 666f 7220 692c 2079 5f70 7265 6420 696e  for i, y_pred in
-00005620: 207a 6970 282a 795f 7072 6564 5f6c 6973   zip(*y_pred_lis
-00005630: 7429 3a0a 2020 2020 6466 5f69 6320 3d20  t):.    df_ic = 
-00005640: 6765 745f 6466 5f69 6328 646d 5f69 2c20  get_df_ic(dm_i, 
-00005650: 795f 7072 6564 2c20 636f 6c5f 7469 6420  y_pred, col_tid 
-00005660: 3d20 636f 6c5f 7469 642c 206d 6173 6b5f  = col_tid, mask_
-00005670: 6e61 6d65 203d 206d 6173 6b5f 6e61 6d65  name = mask_name
-00005680: 290a 2020 2020 735f 6963 203d 2064 665f  ).    s_ic = df_
-00005690: 6963 2e6d 6561 6e28 6178 6973 203d 2030  ic.mean(axis = 0
-000056a0: 290a 2020 2020 7374 725f 7363 6f72 6520  ).    str_score 
-000056b0: 3d20 272c 2027 2e6a 6f69 6e28 6627 7b6b  = ', '.join(f'{k
-000056c0: 7d3d 7b76 3a2e 3666 7d27 2066 6f72 206b  }={v:.6f}' for k
-000056d0: 2c20 7620 696e 2073 5f69 632e 746f 5f64  , v in s_ic.to_d
-000056e0: 6963 7428 292e 6974 656d 7328 2929 0a20  ict().items()). 
-000056f0: 2020 2070 7269 6e74 2866 275b 693d 7b69     print(f'[i={i
-00005700: 3a30 3364 7d5d 207b 7374 725f 7363 6f72  :03d}] {str_scor
-00005710: 657d 2729 0a72 7a2e 5449 4d45 5228 290a  e}').rz.TIMER().
-00005720: 6466 5f69 632e 746f 5f63 7376 2827 6466  df_ic.to_csv('df
-00005730: 5f69 632e 6373 7627 290a 2020 2020 7201  _ic.csv').    r.
-00005740: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
-00005750: 0000 7202 0000 00da 0d6d 6169 6e5f 7069  ..r......main_pi
-00005760: 7065 6c69 6e65 be01 0000 7302 0000 0000  peline....s.....
-00005770: 0172 1200 0000 6300 0000 0000 0000 0000  .r....c.........
-00005780: 0000 0000 0000 0001 0000 0043 0000 0073  ...........C...s
-00005790: 0400 0000 6401 5300 2902 4e7a 980a 6466  ....d.S.).Nz..df
-000057a0: 5f66 655f 7265 706f 7274 203d 2072 7a2e  _fe_report = rz.
-000057b0: 636f 7265 2e65 722e 6e61 6d65 722e 4e61  core.er.namer.Na
-000057c0: 6d65 7228 292e 6765 745f 6466 5f66 655f  mer().get_df_fe_
-000057d0: 7265 706f 7274 286e 616d 655f 6c69 7374  report(name_list
-000057e0: 290a 7663 5f64 6963 7420 3d20 727a 2e63  ).vc_dict = rz.c
-000057f0: 6f72 652e 6572 2e6e 616d 6572 2e4e 616d  ore.er.namer.Nam
-00005800: 6572 2829 2e73 686f 775f 6466 5f66 655f  er().show_df_fe_
-00005810: 7265 706f 7274 2864 665f 6665 5f72 6570  report(df_fe_rep
-00005820: 6f72 742c 206b 203d 2031 3029 2020 2020  ort, k = 10)    
-00005830: 0a20 2020 2072 0100 0000 7201 0000 0072  .    r....r....r
-00005840: 0100 0000 7201 0000 0072 0200 0000 da0c  ....r....r......
-00005850: 6466 5f66 655f 7265 706f 7274 3a02 0000  df_fe_report:...
-00005860: 7302 0000 0000 0172 1300 0000 6300 0000  s......r....c...
-00005870: 0000 0000 0000 0000 0000 0000 0001 0000  ................
-00005880: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
-00005890: 4e61 8e02 0000 0a64 6d31 203d 2072 7a2e  Na.....dm1 = rz.
-000058a0: 6c6f 6164 5f64 6d28 272f 686f 6d65 2f70  load_dm('/home/p
-000058b0: 7562 6c69 632f 6461 7461 2f6f 7574 7075  ublic/data/outpu
-000058c0: 742f 3230 3234 3031 3131 5f76 325f 3238  t/20240111_v2_28
-000058d0: 395f 6d6c 702f 4645 2f64 6d2e 727a 2729  9_mlp/FE/dm.rz')
-000058e0: 0a64 6d32 203d 2072 7a2e 6c6f 6164 5f64  .dm2 = rz.load_d
-000058f0: 6d28 272f 686f 6d65 2f70 7562 6c69 632f  m('/home/public/
-00005900: 6461 7461 2f6f 7574 7075 742f 3230 3234  data/output/2024
-00005910: 3031 3131 5f76 325f 3238 395f 6d6c 705f  0111_v2_289_mlp_
-00005920: 6465 6275 672f 4645 2f64 6d2e 727a 2729  debug/FE/dm.rz')
-00005930: 0a0a 6461 7465 5f64 6562 7567 203d 2032  ..date_debug = 2
-00005940: 3032 3430 3131 310a 646d 312e 7365 745f  0240111.dm1.set_
-00005950: 6d61 736b 2864 6d31 2e67 6574 5f63 6f6c  mask(dm1.get_col
-00005960: 5f6e 756d 7079 2827 7472 6164 655f 6461  _numpy('trade_da
-00005970: 7465 2729 203d 3d20 6461 7465 5f64 6562  te') == date_deb
-00005980: 7567 2c20 2743 4d50 2729 0a64 6d32 2e73  ug, 'CMP').dm2.s
-00005990: 6574 5f6d 6173 6b28 646d 322e 6765 745f  et_mask(dm2.get_
-000059a0: 636f 6c5f 6e75 6d70 7928 2774 7261 6465  col_numpy('trade
-000059b0: 5f64 6174 6527 2920 3d3d 2064 6174 655f  _date') == date_
-000059c0: 6465 6275 672c 2027 434d 5027 290a 0a66  debug, 'CMP')..f
-000059d0: 6f72 2063 692c 2063 6f6c 2069 6e20 656e  or ci, col in en
-000059e0: 756d 6572 6174 6528 7471 646d 2864 6d31  umerate(tqdm(dm1
-000059f0: 2e68 6561 6428 292e 636f 6c75 6d6e 7329  .head().columns)
-00005a00: 293a 0a20 2020 2073 3120 3d20 646d 312e  ):.    s1 = dm1.
-00005a10: 6765 745f 636f 6c5f 7061 6e64 6173 2863  get_col_pandas(c
-00005a20: 6f6c 2c20 6d61 736b 5f6e 616d 653d 2743  ol, mask_name='C
-00005a30: 4d50 2729 0a20 2020 2073 3220 3d20 646d  MP').    s2 = dm
-00005a40: 322e 6765 745f 636f 6c5f 7061 6e64 6173  2.get_col_pandas
-00005a50: 2863 6f6c 2c20 6d61 736b 5f6e 616d 653d  (col, mask_name=
-00005a60: 2743 4d50 2729 0a20 2020 2063 6f72 722c  'CMP').    corr,
-00005a70: 2064 6966 665f 6162 732c 2064 6966 665f   diff_abs, diff_
-00005a80: 636e 7420 3d20 636d 705f 3273 2873 312c  cnt = cmp_2s(s1,
-00005a90: 2073 3229 0a20 2020 2069 6620 6469 6666   s2).    if diff
-00005aa0: 5f61 6273 203e 2031 652d 363a 0a20 2020  _abs > 1e-6:.   
-00005ab0: 2020 2020 2070 7269 6e74 2866 275b 7b63       print(f'[{c
-00005ac0: 693a 3034 647d 5d20 636f 7272 203d 207b  i:04d}] corr = {
-00005ad0: 636f 7272 3a2e 3666 7d2c 2064 6966 665f  corr:.6f}, diff_
-00005ae0: 6162 7320 3d20 7b64 6966 665f 6162 733a  abs = {diff_abs:
-00005af0: 2e36 667d 2c20 6469 6666 5f63 6e74 203d  .6f}, diff_cnt =
-00005b00: 207b 6469 6666 5f63 6e74 7d20 7c20 7b64   {diff_cnt} | {d
-00005b10: 7479 7065 3a3c 367d 207c 207b 636f 6c7d  type:<6} | {col}
-00005b20: 2729 0a0a 7201 0000 0072 0100 0000 7201  ')..r....r....r.
-00005b30: 0000 0072 0100 0000 7202 0000 00da 0666  ...r....r......f
-00005b40: 655f 636d 7040 0200 0073 0200 0000 0001  e_cmp@...s......
-00005b50: 7214 0000 0063 0000 0000 0000 0000 0000  r....c..........
-00005b60: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
-00005b70: 0000 0064 0153 0029 024e 613a 0200 000a  ...d.S.).Na:....
-00005b80: 696d 706f 7274 2072 756e 6e69 6e67 7a20  import runningz 
-00005b90: 6173 2072 7a0a 0a4e 2c20 4d20 3d20 3130  as rz..N, M = 10
-00005ba0: 3030 302c 2031 300a 2320 4e2c 204d 203d  000, 10.# N, M =
-00005bb0: 2031 3030 3030 3030 302c 2031 3030 2023   10000000, 100 #
-00005bc0: 2036 7320 666f 7220 6669 7420 2b20 7072   6s for fit + pr
-00005bd0: 6564 6963 740a 5820 3d20 727a 2e75 7469  edict.X = rz.uti
-00005be0: 6c2e 6e70 795f 6e75 6d62 612e 6e70 5f72  l.npy_numba.np_r
-00005bf0: 616e 646f 6d5f 7261 6e64 6f6d 2828 4e2c  andom_random((N,
-00005c00: 204d 2929 0a79 203d 2072 7a2e 7574 696c   M)).y = rz.util
-00005c10: 2e6e 7079 5f6e 756d 6261 2e6e 705f 7261  .npy_numba.np_ra
-00005c20: 6e64 6f6d 5f72 616e 646f 6d28 4e29 0a0a  ndom_random(N)..
-00005c30: 2320 585b 5820 3c20 302e 355d 203d 206e  # X[X < 0.5] = n
-00005c40: 702e 6e61 6e0a 5820 3d20 727a 2e75 7469  p.nan.X = rz.uti
-00005c50: 6c2e 6e70 795f 6e75 6d62 612e 6e70 5f7a  l.npy_numba.np_z
-00005c60: 7363 6f72 6528 5829 0a58 203d 2072 7a2e  score(X).X = rz.
-00005c70: 7574 696c 2e6e 7079 5f6e 756d 6261 2e6e  util.npy_numba.n
-00005c80: 705f 6669 6c6c 5f76 5f69 6e70 6c61 6365  p_fill_v_inplace
-00005c90: 2858 2c20 3029 0a58 203d 2072 7a2e 7574  (X, 0).X = rz.ut
-00005ca0: 696c 2e6e 7079 5f6e 756d 6261 2e6e 705f  il.npy_numba.np_
-00005cb0: 7365 745f 6f72 6465 7228 5829 0a0a 6672  set_order(X)..fr
-00005cc0: 6f6d 2073 6b6c 6561 726e 2e6c 696e 6561  om sklearn.linea
-00005cd0: 725f 6d6f 6465 6c20 696d 706f 7274 204c  r_model import L
-00005ce0: 696e 6561 7252 6567 7265 7373 696f 6e0a  inearRegression.
-00005cf0: 7265 6720 3d20 4c69 6e65 6172 5265 6772  reg = LinearRegr
-00005d00: 6573 7369 6f6e 2863 6f70 795f 5820 3d20  ession(copy_X = 
-00005d10: 4661 6c73 652c 2066 6974 5f69 6e74 6572  False, fit_inter
-00005d20: 6365 7074 203d 2046 616c 7365 2c20 6e5f  cept = False, n_
-00005d30: 6a6f 6273 203d 202d 3129 2e66 6974 2858  jobs = -1).fit(X
-00005d40: 2c20 7929 200a 795f 7072 6564 203d 2072  , y) .y_pred = r
-00005d50: 6567 2e70 7265 6469 6374 2858 290a 2320  eg.predict(X).# 
-00005d60: 7072 696e 7428 6e70 2e61 7272 6179 285b  print(np.array([
-00005d70: 6e70 2e63 6f72 7263 6f65 6628 7920 2d20  np.corrcoef(y - 
-00005d80: 795f 7072 6564 2c20 585b 3a2c 2069 5d29  y_pred, X[:, i])
-00005d90: 5b30 2c20 315d 2066 6f72 2069 2069 6e20  [0, 1] for i in 
-00005da0: 7261 6e67 6528 582e 7368 6170 655b 315d  range(X.shape[1]
-00005db0: 295d 2929 0a20 2020 2072 0100 0000 7201  )])).    r....r.
-00005dc0: 0000 0072 0100 0000 7201 0000 0072 0200  ...r....r....r..
-00005dd0: 0000 da02 6c72 5202 0000 7302 0000 0000  ....lrR...s.....
-00005de0: 0172 1500 0000 6300 0000 0000 0000 0000  .r....c.........
-00005df0: 0000 0000 0000 0001 0000 0043 0000 0073  ...........C...s
-00005e00: 0400 0000 6401 5300 2902 4e7a 0b0a 2020  ....d.S.).Nz..  
-00005e10: 2020 0a0a 2020 2020 7201 0000 0072 0100    ..    r....r..
-00005e20: 0000 7201 0000 0072 0100 0000 7202 0000  ..r....r....r...
-00005e30: 00da 046c 6172 7366 0200 0073 0200 0000  ...larsf...s....
-00005e40: 0001 7216 0000 0063 0000 0000 0000 0000  ..r....c........
-00005e50: 0000 0000 0000 0000 0100 0000 4300 0000  ............C...
-00005e60: 7304 0000 0064 0153 0029 024e 7af4 0a66  s....d.S.).Nz..f
-00005e70: 726f 6d20 736b 6c65 6172 6e2e 6461 7461  rom sklearn.data
-00005e80: 7365 7473 2069 6d70 6f72 7420 6d61 6b65  sets import make
-00005e90: 5f72 6567 7265 7373 696f 6e0a 582c 2079  _regression.X, y
-00005ea0: 203d 206d 616b 655f 7265 6772 6573 7369   = make_regressi
-00005eb0: 6f6e 286e 5f73 616d 706c 6573 203d 2031  on(n_samples = 1
-00005ec0: 3030 3030 2c20 6e5f 6665 6174 7572 6573  0000, n_features
-00005ed0: 203d 2031 3030 2c20 7261 6e64 6f6d 5f73   = 100, random_s
-00005ee0: 7461 7465 203d 2034 322c 206e 5f69 6e66  tate = 42, n_inf
-00005ef0: 6f72 6d61 7469 7665 203d 2038 302c 206e  ormative = 80, n
-00005f00: 6f69 7365 203d 2031 3029 0a58 203d 2028  oise = 10).X = (
-00005f10: 5820 2d20 6e70 2e6d 6561 6e28 582c 2061  X - np.mean(X, a
-00005f20: 7869 7320 3d20 312c 206b 6565 7064 696d  xis = 1, keepdim
-00005f30: 7320 3d20 5472 7565 2929 202f 206e 702e  s = True)) / np.
-00005f40: 7374 6428 582c 2061 7869 7320 3d20 312c  std(X, axis = 1,
-00005f50: 206b 6565 7064 696d 7320 3d20 5472 7565   keepdims = True
-00005f60: 290a 7201 0000 0072 0100 0000 7201 0000  ).r....r....r...
-00005f70: 0072 0100 0000 7202 0000 00da 0d67 6574  .r....r......get
-00005f80: 5f74 6573 745f 6461 7461 6d02 0000 7302  _test_datam...s.
-00005f90: 0000 0000 0172 1700 0000 6300 0000 0000  .....r....c.....
-00005fa0: 0000 0000 0000 0000 0000 0001 0000 0043  ...............C
-00005fb0: 0000 0073 0400 0000 6401 5300 2902 4e7a  ...s....d.S.).Nz
-00005fc0: 3e0a 2020 2020 706c 742e 6d69 6e6f 7274  >.    plt.minort
-00005fd0: 6963 6b73 5f6f 6e28 290a 2020 2020 706c  icks_on().    pl
-00005fe0: 742e 6772 6964 2854 7275 652c 2077 6869  t.grid(True, whi
-00005ff0: 6368 3d27 626f 7468 2729 0a20 2020 2072  ch='both').    r
-00006000: 0100 0000 7201 0000 0072 0100 0000 7201  ....r....r....r.
-00006010: 0000 0072 0200 0000 da04 706c 6f74 7502  ...r......plotu.
-00006020: 0000 7302 0000 0000 0172 1800 0000 6300  ..s......r....c.
-00006030: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-00006040: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
-00006050: 2902 4e61 1d01 0000 0a20 2020 2023 2021  ).Na.....    # !
-00006060: 7069 7020 696e 7374 616c 6c20 6d69 7373  pip install miss
-00006070: 696e 676e 6f0a 2020 2020 696d 706f 7274  ingno.    import
-00006080: 206d 6973 7369 6e67 6e6f 2061 7320 6d73   missingno as ms
-00006090: 6e6f 0a20 2020 2023 206d 736e 6f2e 6d61  no.    # msno.ma
-000060a0: 7472 6978 2874 7261 696e 2e73 616d 706c  trix(train.sampl
-000060b0: 6528 3130 3030 3029 290a 2020 2020 2320  e(10000)).    # 
-000060c0: 6d73 6e6f 2e6d 6174 7269 7828 7465 7374  msno.matrix(test
-000060d0: 2e73 616d 706c 6528 3130 3030 3029 290a  .sample(10000)).
-000060e0: 2020 2020 2320 6d73 6e6f 2e62 6172 2874      # msno.bar(t
-000060f0: 7261 696e 2e73 616d 706c 6528 3130 3030  rain.sample(1000
-00006100: 3029 290a 2020 2020 2320 6d73 6e6f 2e62  0)).    # msno.b
-00006110: 6172 2874 6573 742e 7361 6d70 6c65 2831  ar(test.sample(1
-00006120: 3030 3030 2929 0a20 2020 2023 206d 736e  0000)).    # msn
-00006130: 6f2e 6865 6174 6d61 7028 7472 6169 6e2e  o.heatmap(train.
-00006140: 7361 6d70 6c65 2831 3030 3030 2929 0a20  sample(10000)). 
-00006150: 2020 2023 206d 736e 6f2e 6465 6e64 726f     # msno.dendro
-00006160: 6772 616d 2863 6f6c 6c69 7369 6f6e 7329  gram(collisions)
-00006170: 0a20 2020 2072 0100 0000 7201 0000 0072  .    r....r....r
-00006180: 0100 0000 7201 0000 0072 0200 0000 da08  ....r....r......
-00006190: 706c 6f74 5f6e 616e 7b02 0000 7302 0000  plot_nan{...s...
-000061a0: 0000 0172 1900 0000 6300 0000 0000 0000  ...r....c.......
-000061b0: 0000 0000 0000 0000 0001 0000 0043 0000  .............C..
-000061c0: 0073 0400 0000 6401 5300 2902 4e7a a30a  .s....d.S.).Nz..
-000061d0: 2020 2020 2320 2170 6970 2069 6e73 7461      # !pip insta
-000061e0: 6c6c 2070 616e 6461 735f 7072 6f66 696c  ll pandas_profil
-000061f0: 696e 670a 2020 2020 696d 706f 7274 2070  ing.    import p
-00006200: 616e 6461 735f 7072 6f66 696c 696e 670a  andas_profiling.
-00006210: 2020 2020 7066 7220 3d20 7061 6e64 6173      pfr = pandas
-00006220: 5f70 726f 6669 6c69 6e67 2e50 726f 6669  _profiling.Profi
-00006230: 6c65 5265 706f 7274 2874 7261 696e 290a  leReport(train).
-00006240: 2020 2020 7072 6f66 2e74 6f5f 6669 6c65      prof.to_file
-00006250: 286f 7574 7075 745f 6669 6c65 3d27 6175  (output_file='au
-00006260: 746f 5f45 4441 2e68 746d 6c27 290a 2020  to_EDA.html').  
-00006270: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
-00006280: 0072 0100 0000 7202 0000 00da 0870 6c6f  .r....r......plo
-00006290: 745f 6564 6187 0200 0073 0200 0000 0001  t_eda....s......
-000062a0: 721a 0000 0063 0000 0000 0000 0000 0000  r....c..........
-000062b0: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
-000062c0: 0000 0064 0153 0029 024e 6182 0700 000a  ...d.S.).Na.....
-000062d0: 2020 2020 2320 6675 6c6c 2073 6372 6565      # full scree
-000062e0: 6e20 7769 6474 6820 6f66 204a 7570 7974  n width of Jupyt
-000062f0: 6572 206e 6f74 6562 6f6f 6b0a 2020 2020  er notebook.    
-00006300: 6672 6f6d 2049 5079 7468 6f6e 2e63 6f72  from IPython.cor
-00006310: 652e 6469 7370 6c61 7920 696d 706f 7274  e.display import
-00006320: 2064 6973 706c 6179 2c20 4854 4d4c 0a20   display, HTML. 
-00006330: 2020 2064 6973 706c 6179 2848 544d 4c28     display(HTML(
-00006340: 223c 7374 796c 653e 2e63 6f6e 7461 696e  "<style>.contain
-00006350: 6572 207b 2077 6964 7468 3a31 3030 2520  er { width:100% 
-00006360: 2169 6d70 6f72 7461 6e74 3b20 7d3c 2f73  !important; }</s
-00006370: 7479 6c65 3e22 2929 200a 0a20 2020 2069  tyle>")) ..    i
-00006380: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
-00006390: 2e70 7970 6c6f 7420 6173 2070 6c74 0a20  .pyplot as plt. 
-000063a0: 2020 2069 6d70 6f72 7420 7365 6162 6f72     import seabor
-000063b0: 6e20 6173 2073 6e73 0a20 2020 2069 6d70  n as sns.    imp
-000063c0: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
-000063d0: 2020 2020 696d 706f 7274 2070 616e 6461      import panda
-000063e0: 7320 6173 2070 640a 2020 2020 6e70 2e73  s as pd.    np.s
-000063f0: 6574 5f70 7269 6e74 6f70 7469 6f6e 7328  et_printoptions(
-00006400: 7375 7070 7265 7373 3d54 7275 6529 0a0a  suppress=True)..
-00006410: 2020 2020 6465 6620 6765 745f 6578 7065      def get_expe
-00006420: 6374 5f73 636f 7265 2878 2c20 6120 3d20  ct_score(x, a = 
-00006430: 312c 2062 203d 2031 2c20 6320 3d20 3029  1, b = 1, c = 0)
-00006440: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00006450: 2061 202f 2028 3120 2b20 3130 202a 2a20   a / (1 + 10 ** 
-00006460: 282d 3120 2a20 2078 202f 2062 2929 202b  (-1 *  x / b)) +
-00006470: 630a 0a20 2020 2023 2067 6170 2074 6f20  c..    # gap to 
-00006480: 7769 6e20 0a20 2020 2078 203d 206e 702e  win .    x = np.
-00006490: 6c69 6e73 7061 6365 282d 3132 3030 2c20  linspace(-1200, 
-000064a0: 3132 3030 2c20 3130 3129 0a20 2020 2079  1200, 101).    y
-000064b0: 203d 2067 6574 5f65 7870 6563 745f 7363   = get_expect_sc
-000064c0: 6f72 6528 782c 2062 203d 2034 3030 290a  ore(x, b = 400).
-000064d0: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
-000064e0: 6967 7369 7a65 3d28 3130 2c20 3529 290a  igsize=(10, 5)).
-000064f0: 2020 2020 706c 742e 706c 6f74 2878 2c20      plt.plot(x, 
-00006500: 7929 0a20 2020 2070 6c74 2e6d 696e 6f72  y).    plt.minor
-00006510: 7469 636b 735f 6f6e 2829 0a20 2020 2070  ticks_on().    p
-00006520: 6c74 2e67 7269 6428 5472 7565 2c20 7768  lt.grid(True, wh
-00006530: 6963 6820 3d20 2762 6f74 6827 290a 2020  ich = 'both').  
-00006540: 2020 706c 742e 796c 6162 656c 2827 6578    plt.ylabel('ex
-00006550: 7065 6374 2073 636f 7265 2025 272c 2020  pect score %',  
-00006560: 666f 6e74 7369 7a65 203d 2031 3529 0a20  fontsize = 15). 
-00006570: 2020 2070 6c74 2e78 6c61 6265 6c28 2767     plt.xlabel('g
-00006580: 6170 272c 2066 6f6e 7473 697a 6520 3d20  ap', fontsize = 
-00006590: 3135 290a 2020 2020 706c 742e 7368 6f77  15).    plt.show
-000065a0: 2829 0a0a 2020 2020 2320 775f 7363 6f72  ()..    # w_scor
-000065b0: 650a 2020 2020 7820 3d20 6e70 2e6c 696e  e.    x = np.lin
-000065c0: 7370 6163 6528 3830 302c 2032 3030 302c  space(800, 2000,
-000065d0: 2031 3031 290a 2020 2020 7920 3d20 6765   101).    y = ge
-000065e0: 745f 6578 7065 6374 5f73 636f 7265 282d  t_expect_score(-
-000065f0: 2878 202d 2031 3230 3029 2c20 6120 3d20  (x - 1200), a = 
-00006600: 3332 2c20 6220 3d20 3430 302c 2063 203d  32, b = 400, c =
-00006610: 2031 3629 0a20 2020 2070 6c74 2e66 6967   16).    plt.fig
-00006620: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
-00006630: 2035 2929 0a20 2020 2070 6c74 2e70 6c6f   5)).    plt.plo
-00006640: 7428 782c 2079 290a 2020 2020 706c 742e  t(x, y).    plt.
-00006650: 6d69 6e6f 7274 6963 6b73 5f6f 6e28 290a  minorticks_on().
-00006660: 2020 2020 706c 742e 6772 6964 2854 7275      plt.grid(Tru
-00006670: 652c 2077 6869 6368 203d 2027 626f 7468  e, which = 'both
-00006680: 2729 0a20 2020 2070 6c74 2e79 6c61 6265  ').    plt.ylabe
-00006690: 6c28 276b 272c 2020 666f 6e74 7369 7a65  l('k',  fontsize
-000066a0: 203d 2031 3529 0a20 2020 2070 6c74 2e78   = 15).    plt.x
-000066b0: 6c61 6265 6c28 2773 636f 7265 272c 2066  label('score', f
-000066c0: 6f6e 7473 697a 6520 3d20 3135 290a 2020  ontsize = 15).  
-000066d0: 2020 706c 742e 7368 6f77 2829 0a0a 2020    plt.show()..  
-000066e0: 2020 2320 775f 6761 700a 2020 2020 7820    # w_gap.    x 
-000066f0: 3d20 6e70 2e6c 696e 7370 6163 6528 2d31  = np.linspace(-1
-00006700: 3230 302c 2031 3230 302c 2032 3529 0a20  200, 1200, 25). 
-00006710: 2020 2079 203d 2028 3130 202a 2a20 2878     y = (10 ** (x
-00006720: 202f 2031 3630 3029 290a 2020 2020 706c   / 1600)).    pl
-00006730: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
-00006740: 3d28 3130 2c20 3529 290a 2020 2020 706c  =(10, 5)).    pl
-00006750: 742e 706c 6f74 2878 2c20 7929 0a20 2020  t.plot(x, y).   
-00006760: 2070 6c74 2e6d 696e 6f72 7469 636b 735f   plt.minorticks_
-00006770: 6f6e 2829 0a20 2020 2070 6c74 2e67 7269  on().    plt.gri
-00006780: 6428 5472 7565 2c20 7768 6963 6820 3d20  d(True, which = 
-00006790: 2762 6f74 6827 290a 2020 2020 706c 742e  'both').    plt.
-000067a0: 796c 6162 656c 2827 6b5f 6761 7027 2c20  ylabel('k_gap', 
-000067b0: 2066 6f6e 7473 697a 6520 3d20 3135 290a   fontsize = 15).
-000067c0: 2020 2020 706c 742e 786c 6162 656c 2827      plt.xlabel('
-000067d0: 6761 7027 2c20 666f 6e74 7369 7a65 203d  gap', fontsize =
-000067e0: 2031 3529 0a20 2020 2070 6c74 2e73 686f   15).    plt.sho
-000067f0: 7728 290a 0a20 2020 2023 2077 0a20 2020  w()..    # w.   
-00006800: 2078 203d 206e 702e 6c69 6e73 7061 6365   x = np.linspace
-00006810: 2838 3030 2c20 3230 3030 2c20 3235 290a  (800, 2000, 25).
-00006820: 2020 2020 7920 3d20 6e70 2e6c 696e 7370      y = np.linsp
-00006830: 6163 6528 3830 302c 2032 3030 302c 2032  ace(800, 2000, 2
-00006840: 3529 5b3a 3a2d 315d 0a20 2020 2058 2c20  5)[::-1].    X, 
-00006850: 5920 3d20 6e70 2e6d 6573 6867 7269 6428  Y = np.meshgrid(
-00006860: 782c 2079 290a 2020 2020 7769 6a20 3d20  x, y).    wij = 
-00006870: 3130 202a 2a20 2828 5920 2d20 5829 202f  10 ** ((Y - X) /
-00006880: 2031 3230 3029 0a20 2020 2077 6920 3d20   1200).    wi = 
-00006890: 6765 745f 6578 7065 6374 5f73 636f 7265  get_expect_score
-000068a0: 282d 2858 202d 2031 3230 3029 2c20 6120  (-(X - 1200), a 
-000068b0: 3d20 3332 2c20 6220 3d20 3430 302c 2063  = 32, b = 400, c
-000068c0: 203d 2031 3629 0a20 2020 205a 203d 2077   = 16).    Z = w
-000068d0: 696a 202a 2077 690a 0a20 2020 2066 2c20  ij * wi..    f, 
-000068e0: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
-000068f0: 7328 6669 6773 697a 653d 2833 302c 2031  s(figsize=(30, 1
-00006900: 3229 290a 2020 2020 736e 732e 6865 6174  2)).    sns.heat
-00006910: 6d61 7028 5a2c 206c 696e 6577 6964 7468  map(Z, linewidth
-00006920: 7320 3d20 302e 352c 2061 7820 3d20 6178  s = 0.5, ax = ax
-00006930: 2c20 616e 6e6f 7420 3d20 5472 7565 2c20  , annot = True, 
-00006940: 666d 743d 222e 3066 2229 3b0a 2020 2020  fmt=".0f");.    
-00006950: 706c 742e 7874 6963 6b73 2874 6963 6b73  plt.xticks(ticks
-00006960: 203d 206e 702e 6172 616e 6765 286c 656e   = np.arange(len
-00006970: 2878 2929 2c20 6c61 6265 6c73 203d 206c  (x)), labels = l
-00006980: 6973 7428 7829 2c20 726f 7461 7469 6f6e  ist(x), rotation
-00006990: 3d27 7665 7274 6963 616c 2729 0a20 2020  ='vertical').   
-000069a0: 2070 6c74 2e79 7469 636b 7328 7469 636b   plt.yticks(tick
-000069b0: 7320 3d20 6e70 2e61 7261 6e67 6528 6c65  s = np.arange(le
-000069c0: 6e28 7929 292c 206c 6162 656c 7320 3d20  n(y)), labels = 
-000069d0: 6c69 7374 2879 292c 2072 6f74 6174 696f  list(y), rotatio
-000069e0: 6e3d 2768 6f72 697a 6f6e 7461 6c27 290a  n='horizontal').
-000069f0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-00006a00: 6f74 6865 7227 2c20 2066 6f6e 7473 697a  other',  fontsiz
-00006a10: 6520 3d20 3135 290a 2020 2020 706c 742e  e = 15).    plt.
-00006a20: 786c 6162 656c 2827 7365 6c66 272c 2066  xlabel('self', f
-00006a30: 6f6e 7473 697a 6520 3d20 3135 290a 2020  ontsize = 15).  
-00006a40: 2020 706c 742e 7368 6f77 2829 0a20 2020    plt.show().   
-00006a50: 2072 0100 0000 7201 0000 0072 0100 0000   r....r....r....
-00006a60: 7201 0000 0072 0200 0000 da07 706c 6f74  r....r......plot
-00006a70: 5f70 6b8f 0200 0073 0200 0000 0001 721b  _pk....s......r.
-00006a80: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
-00006a90: 0000 0000 0100 0000 4300 0000 7304 0000  ........C...s...
-00006aa0: 0064 0153 0029 024e 758a 0500 000a 2020  .d.S.).Nu.....  
-00006ab0: 2020 696d 706f 7274 206d 6174 706c 6f74    import matplot
-00006ac0: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-00006ad0: 740a 2020 2020 696d 706f 7274 2073 6561  t.    import sea
-00006ae0: 626f 726e 2061 7320 736e 730a 2020 2020  born as sns.    
-00006af0: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00006b00: 6e70 0a20 2020 2069 6d70 6f72 7420 7061  np.    import pa
-00006b10: 6e64 6173 2061 7320 7064 0a0a 2020 2020  ndas as pd..    
-00006b20: 7820 3d20 6e70 2e6c 696e 7370 6163 6528  x = np.linspace(
-00006b30: 302c 2031 2c20 3130 3129 0a20 2020 2079  0, 1, 101).    y
-00006b40: 203d 205b 3120 2f20 2830 2e35 202b 2030   = [1 / (0.5 + 0
-00006b50: 2e35 202a 2078 6929 202a 2a20 302e 3520  .5 * xi) ** 0.5 
-00006b60: 2d20 3120 666f 7220 7869 2069 6e20 785d  - 1 for xi in x]
-00006b70: 0a20 2020 2070 6c74 2e66 6967 7572 6528  .    plt.figure(
-00006b80: 6669 6773 697a 653d 2831 302c 2035 2929  figsize=(10, 5))
-00006b90: 0a20 2020 2070 6c74 2e70 6c6f 7428 782c  .    plt.plot(x,
-00006ba0: 2079 290a 2020 2020 706c 742e 6d69 6e6f   y).    plt.mino
-00006bb0: 7274 6963 6b73 5f6f 6e28 290a 2020 2020  rticks_on().    
-00006bc0: 706c 742e 6772 6964 2854 7275 652c 2077  plt.grid(True, w
-00006bd0: 6869 6368 203d 2027 626f 7468 2729 0a20  hich = 'both'). 
-00006be0: 2020 2070 6c74 2e79 6c61 6265 6c28 2769     plt.ylabel('i
-00006bf0: 6d70 726f 7665 6d65 6e74 2025 272c 2020  mprovement %',  
-00006c00: 666f 6e74 7369 7a65 203d 2031 3529 0a20  fontsize = 15). 
-00006c10: 2020 2070 6c74 2e78 6c61 6265 6c28 2763     plt.xlabel('c
-00006c20: 6f72 7227 2c20 666f 6e74 7369 7a65 203d  orr', fontsize =
-00006c30: 2031 3529 0a20 2020 2070 6c74 2e73 686f   15).    plt.sho
-00006c40: 7728 290a 0a0a 2020 2020 696d 706f 7274  w()...    import
-00006c50: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-00006c60: 6f74 2061 7320 706c 740a 2020 2020 696d  ot as plt.    im
-00006c70: 706f 7274 2073 6561 626f 726e 2061 7320  port seaborn as 
-00006c80: 736e 730a 2020 2020 696d 706f 7274 206e  sns.    import n
-00006c90: 756d 7079 2061 7320 6e70 0a20 2020 2069  umpy as np.    i
-00006ca0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-00006cb0: 7064 0a0a 2020 2020 2320 e79b b8e5 85b3  pd..    # ......
-00006cc0: e680 a72c 2030 7e31 e5b8 a6e6 9da5 e79a  ..., 0~1........
-00006cd0: 84e6 8f90 e58d 870a 2020 2020 7820 3d20  ........    x = 
-00006ce0: 6e70 2e6c 696e 7370 6163 6528 302c 2031  np.linspace(0, 1
-00006cf0: 2c20 3231 290a 2020 2020 696d 7072 6f76  , 21).    improv
-00006d00: 656d 656e 7420 3d20 6e70 2e61 7272 6179  ement = np.array
-00006d10: 285b 3120 2f20 2830 2e35 202b 2030 2e35  ([1 / (0.5 + 0.5
-00006d20: 202a 2078 6929 202a 2a20 302e 3520 2d20   * xi) ** 0.5 - 
-00006d30: 3120 666f 7220 7869 2069 6e20 785d 290a  1 for xi in x]).
-00006d40: 0a20 2020 2023 20e8 9e8d e590 88e5 afb9  .    # .........
-00006d50: e8b1 a1e7 9a84 4943 0a20 2020 2069 6320  ......IC.    ic 
-00006d60: 3d20 302e 3037 0a20 2020 2069 635f 6c69  = 0.07.    ic_li
-00006d70: 7374 203d 2069 6320 2b20 6e70 2e6c 696e  st = ic + np.lin
-00006d80: 7370 6163 6528 302c 2032 302c 2032 3129  space(0, 20, 21)
-00006d90: 202f 2031 6533 202d 2031 652d 320a 2020   / 1e3 - 1e-2.  
-00006da0: 2020 6963 5f6c 6973 7420 3d20 6963 5f6c    ic_list = ic_l
-00006db0: 6973 745b 3a3a 2d31 5d0a 0a20 2020 2023  ist[::-1]..    #
-00006dc0: 20e5 928c e6af 8fe4 b880 e4b8 aa49 43e8   ............IC.
-00006dd0: 9e8d e590 882c 20e4 b88d e590 8ce7 9bb8  ....., .........
-00006de0: e585 b3e6 80a7 2c20 e5be 97e5 88b0 e89e  ......, ........
-00006df0: 8de5 9088 e590 8ee7 9a84 4943 0a20 2020  ..........IC.   
-00006e00: 2065 6e5f 6c69 7374 203d 205b 5d0a 2020   en_list = [].  
-00006e10: 2020 666f 7220 6963 5f69 2069 6e20 6963    for ic_i in ic
-00006e20: 5f6c 6973 743a 0a20 2020 2020 2020 2065  _list:.        e
-00006e30: 6e5f 6920 3d20 2869 6320 2b20 6963 5f69  n_i = (ic + ic_i
-00006e40: 2920 2f20 3220 2a20 2831 202b 2069 6d70  ) / 2 * (1 + imp
-00006e50: 726f 7665 6d65 6e74 290a 2020 2020 2020  rovement).      
-00006e60: 2020 656e 5f6c 6973 742e 6170 7065 6e64    en_list.append
-00006e70: 2865 6e5f 6929 0a20 2020 2061 5f65 6e20  (en_i).    a_en 
-00006e80: 3d20 6e70 2e76 7374 6163 6b28 656e 5f6c  = np.vstack(en_l
-00006e90: 6973 7429 2020 2020 0a0a 2020 2020 662c  ist)    ..    f,
-00006ea0: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-00006eb0: 7473 2866 6967 7369 7a65 3d28 3230 2c20  ts(figsize=(20, 
-00006ec0: 3132 2929 0a20 2020 2073 6e73 2e68 6561  12)).    sns.hea
-00006ed0: 746d 6170 2861 5f65 6e2c 206c 696e 6577  tmap(a_en, linew
-00006ee0: 6964 7468 7320 3d20 302e 352c 2061 7820  idths = 0.5, ax 
-00006ef0: 3d20 6178 2c20 616e 6e6f 7420 3d20 5472  = ax, annot = Tr
-00006f00: 7565 2c20 666d 743d 222e 3466 2229 3b0a  ue, fmt=".4f");.
-00006f10: 2020 2020 706c 742e 7874 6963 6b73 2874      plt.xticks(t
-00006f20: 6963 6b73 203d 206e 702e 6172 616e 6765  icks = np.arange
-00006f30: 2832 3129 2c20 6c61 6265 6c73 203d 205b  (21), labels = [
-00006f40: 6627 7b69 3a2e 3266 7d27 666f 7220 6920  f'{i:.2f}'for i 
-00006f50: 696e 2078 5d2c 2072 6f74 6174 696f 6e3d  in x], rotation=
-00006f60: 2776 6572 7469 6361 6c27 290a 2020 2020  'vertical').    
-00006f70: 706c 742e 7974 6963 6b73 2874 6963 6b73  plt.yticks(ticks
-00006f80: 203d 206e 702e 6172 616e 6765 2832 3129   = np.arange(21)
-00006f90: 2c20 6c61 6265 6c73 203d 205b 6627 7b69  , labels = [f'{i
-00006fa0: 3a2e 3466 7d27 666f 7220 6920 696e 2069  :.4f}'for i in i
-00006fb0: 635f 6c69 7374 5d2c 2072 6f74 6174 696f  c_list], rotatio
-00006fc0: 6e3d 2768 6f72 697a 6f6e 7461 6c27 290a  n='horizontal').
-00006fd0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-00006fe0: 6f74 6865 7220 4943 203d 2027 2c20 2066  other IC = ',  f
-00006ff0: 6f6e 7473 697a 6520 3d20 3135 290a 2020  ontsize = 15).  
-00007000: 2020 706c 742e 786c 6162 656c 2827 636f    plt.xlabel('co
-00007010: 7272 272c 2066 6f6e 7473 697a 6520 3d20  rr', fontsize = 
-00007020: 3135 290a 2020 2020 706c 742e 7368 6f77  15).    plt.show
-00007030: 2829 0a20 2020 2072 0100 0000 7201 0000  ().    r....r...
-00007040: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-00007050: da0d 706c 6f74 5f65 6e73 656d 626c 65d0  ..plot_ensemble.
-00007060: 0200 0073 0200 0000 0001 721c 0000 0063  ...s......r....c
-00007070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007080: 0100 0000 4300 0000 7304 0000 0064 0153  ....C...s....d.S
-00007090: 0029 024e 75e2 0100 000a 2020 2020 736e  .).Nu.....    sn
-000070a0: 732e 4661 6365 7447 7269 6428 7472 6169  s.FacetGrid(trai
-000070b0: 6e2c 2068 7565 3d22 5441 5247 4554 222c  n, hue="TARGET",
-000070c0: 2073 697a 653d 3629 2020 2020 2020 2020   size=6)        
-000070d0: 202e 6d61 7028 736e 732e 6b64 6570 6c6f   .map(sns.kdeplo
-000070e0: 742c 2022 7661 7233 3622 2920 2020 2020  t, "var36")     
-000070f0: 2020 2020 2e61 6464 5f6c 6567 656e 6428      .add_legend(
-00007100: 290a 2020 2020 2020 2020 706c 742e 7469  ).        plt.ti
-00007110: 746c 6528 2749 6620 7661 7233 3620 6973  tle('If var36 is
-00007120: 2030 2c31 2c32 206f 7220 3320 3d3e 206c   0,1,2 or 3 => l
-00007130: 6573 7320 756e 6861 7070 7920 6375 7374  ess unhappy cust
-00007140: 6f6d 6572 7327 293b 0a0a 2020 2020 6466  omers');..    df
-00007150: 203d 2074 7261 696e 2e63 6f70 7928 290a   = train.copy().
-00007160: 2020 2020 7663 203d 2064 665b 2763 5f30      vc = df['c_0
-00007170: 275d 2e76 616c 7565 5f63 6f75 6e74 7328  '].value_counts(
-00007180: 292e 696c 6f63 5b3a 3130 5d0a 2020 2020  ).iloc[:10].    
-00007190: 6466 203d 2064 665b 6466 5b27 635f 3027  df = df[df['c_0'
-000071a0: 5d2e 6973 696e 2876 632e 696e 6465 7829  ].isin(vc.index)
-000071b0: 5d0a 0a20 2020 2023 20e9 9a94 e5a3 810a  ]..    # .......
-000071c0: 2020 2020 736e 732e 636f 756e 7470 6c6f      sns.countplo
-000071d0: 7428 783d 2763 5f30 272c 2068 7565 3d27  t(x='c_0', hue='
-000071e0: 6c61 6265 6c27 2c20 6461 7461 203d 2064  label', data = d
-000071f0: 6629 0a0a 2020 2020 2320 e987 8de5 8fa0  f)..    # ......
-00007200: 0a20 2020 2073 6e73 2e46 6163 6574 4772  .    sns.FacetGr
-00007210: 6964 2864 662c 2068 7565 3d27 6c61 6265  id(df, hue='labe
-00007220: 6c27 2c20 7369 7a65 3d34 2920 2020 2020  l', size=4)     
-00007230: 2e6d 6170 2873 6e73 2e63 6f75 6e74 706c  .map(sns.countpl
-00007240: 6f74 2c20 2763 5f30 272c 2061 6c70 6861  ot, 'c_0', alpha
-00007250: 3d30 2e37 2920 2020 2020 2e61 6464 5f6c  =0.7)     .add_l
-00007260: 6567 656e 6428 290a 2020 2020 706c 742e  egend().    plt.
-00007270: 7368 6f77 2829 0a20 2020 2072 0100 0000  show().    r....
-00007280: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-00007290: 0200 0000 da08 706c 6f74 5f68 7565 0003  ......plot_hue..
-000072a0: 0000 7302 0000 0000 0172 1d00 0000 6300  ..s......r....c.
-000072b0: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-000072c0: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
-000072d0: 2902 4e61 b803 0000 0a20 2020 2073 203d  ).Na.....    s =
-000072e0: 2064 665f 7072 6564 5b27 795f 7072 6564   df_pred['y_pred
-000072f0: 275d 5b3a 6b5d 2e63 6f70 7928 290a 2020  '][:k].copy().  
-00007300: 2020 7320 2f3d 2073 2e73 756d 2829 0a20    s /= s.sum(). 
-00007310: 2020 2070 6c74 2e66 6967 7572 6528 6669     plt.figure(fi
-00007320: 6773 697a 653d 2832 302c 3329 290a 2020  gsize=(20,3)).  
-00007330: 2020 2873 2e63 756d 7375 6d28 2920 2f20    (s.cumsum() / 
-00007340: 732e 7375 6d28 2929 2e70 6c6f 7428 290a  s.sum()).plot().
-00007350: 2020 2020 706c 742e 6d69 6e6f 7274 6963      plt.minortic
-00007360: 6b73 5f6f 6e28 290a 2020 2020 706c 742e  ks_on().    plt.
-00007370: 6772 6964 2854 7275 652c 2077 6869 6368  grid(True, which
-00007380: 3d27 626f 7468 2729 0a20 2020 2070 6c74  ='both').    plt
-00007390: 2e73 686f 7728 290a 0a20 2020 2070 6c74  .show()..    plt
-000073a0: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-000073b0: 2832 302c 3329 290a 2020 2020 706c 742e  (20,3)).    plt.
-000073c0: 6261 7228 6e70 2e61 7261 6e67 6528 6c65  bar(np.arange(le
-000073d0: 6e28 7329 292c 2073 290a 2020 2020 706c  n(s)), s).    pl
-000073e0: 742e 6d69 6e6f 7274 6963 6b73 5f6f 6e28  t.minorticks_on(
-000073f0: 290a 2020 2020 706c 742e 6772 6964 2854  ).    plt.grid(T
-00007400: 7275 652c 2077 6869 6368 3d27 626f 7468  rue, which='both
-00007410: 2729 0a20 2020 2070 6c74 2e78 7469 636b  ').    plt.xtick
-00007420: 7328 7469 636b 7320 3d20 6e70 2e61 7261  s(ticks = np.ara
-00007430: 6e67 6528 6b29 2c20 6c61 6265 6c73 203d  nge(k), labels =
-00007440: 2063 6f64 6573 2c20 726f 7461 7469 6f6e   codes, rotation
-00007450: 3d27 7665 7274 6963 616c 2729 0a20 2020  ='vertical').   
-00007460: 2070 6c74 2e73 686f 7728 290a 0a20 2020   plt.show()..   
-00007470: 2064 6566 2064 665f 6261 7270 6c6f 7428   def df_barplot(
-00007480: 6466 293a 0a20 2020 2020 2020 2023 2064  df):.        # d
-00007490: 662e 706c 6f74 286b 696e 6420 3d20 2762  f.plot(kind = 'b
-000074a0: 6172 272c 2066 6967 7369 7a65 3d28 3230  ar', figsize=(20
-000074b0: 2c34 2929 3b0a 2020 2020 2020 2020 6466  ,4));.        df
-000074c0: 5f70 6c6f 7420 3d20 7064 2e44 6174 6146  _plot = pd.DataF
-000074d0: 7261 6d65 287b 2778 273a 206c 6973 7428  rame({'x': list(
-000074e0: 6466 2e69 6e64 6578 2920 2a20 6466 2e73  df.index) * df.s
-000074f0: 6861 7065 5b31 5d2c 200a 2020 2020 2020  hape[1], .      
-00007500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007510: 2020 2020 2020 2020 2020 2768 7565 273a            'hue':
-00007520: 206e 702e 7261 7665 6c28 5b5b 695d 202a   np.ravel([[i] *
-00007530: 2064 662e 7368 6170 655b 305d 2066 6f72   df.shape[0] for
-00007540: 2069 2069 6e20 7261 6e67 6528 6466 2e73   i in range(df.s
-00007550: 6861 7065 5b31 5d29 5d29 2c0a 2020 2020  hape[1])]),.    
-00007560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007570: 2020 2020 2020 2020 2020 2020 2779 273a              'y':
-00007580: 2064 662e 542e 7661 6c75 6573 2e72 6176   df.T.values.rav
-00007590: 656c 2829 7d29 0a20 2020 2020 2020 2070  el()}).        p
-000075a0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
-000075b0: 653d 2832 302c 2033 2929 0a20 2020 2020  e=(20, 3)).     
-000075c0: 2020 2073 6e73 2e62 6172 706c 6f74 2878     sns.barplot(x
-000075d0: 203d 2027 7827 2c20 7920 3d20 2779 272c   = 'x', y = 'y',
-000075e0: 2068 7565 203d 2027 6875 6527 2c20 6461   hue = 'hue', da
-000075f0: 7461 203d 2064 665f 706c 6f74 2c20 616c  ta = df_plot, al
-00007600: 7068 6120 3d20 302e 3829 0a20 2020 2020  pha = 0.8).     
-00007610: 2020 2070 6c74 2e6c 6567 656e 6428 2727     plt.legend(''
-00007620: 2c20 6672 616d 656f 6e20 3d20 4661 6c73  , frameon = Fals
-00007630: 6529 0a20 2020 2020 2020 2023 2070 6c74  e).        # plt
-00007640: 2e6d 696e 6f72 7469 636b 735f 6f6e 2829  .minorticks_on()
-00007650: 0a20 2020 2020 2020 2070 6c74 2e67 7269  .        plt.gri
-00007660: 6428 5472 7565 2c20 7768 6963 6820 3d20  d(True, which = 
-00007670: 2762 6f74 6827 290a 2020 2020 2020 2020  'both').        
-00007680: 706c 742e 7368 6f77 2829 3b0a 2020 2020  plt.show();.    
-00007690: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-000076a0: 0100 0000 7202 0000 00da 0870 6c6f 745f  ....r......plot_
-000076b0: 6261 7215 0300 0073 0200 0000 0001 721e  bar....s......r.
-000076c0: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
-000076d0: 0000 0000 0100 0000 4300 0000 7304 0000  ........C...s...
-000076e0: 0064 0153 0029 024e 61da 0500 000a 2020  .d.S.).Na.....  
-000076f0: 2020 6465 6620 626f 7870 6c6f 7428 6466    def boxplot(df
-00007700: 5f69 642c 2063 6f6c 203d 2027 795f 7472  _id, col = 'y_tr
-00007710: 7565 2729 3a0a 2020 2020 2020 2020 706c  ue'):.        pl
-00007720: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
-00007730: 3d28 3230 2c20 3229 290a 2020 2020 2020  =(20, 2)).      
-00007740: 2020 706c 742e 7469 746c 6528 6627 5b2b    plt.title(f'[+
-00007750: 5d20 7b63 6f6c 7d20 626f 7870 6c6f 7427  ] {col} boxplot'
-00007760: 290a 2020 2020 2020 2020 706c 742e 626f  ).        plt.bo
-00007770: 7870 6c6f 7428 6466 5f69 645b 636f 6c5d  xplot(df_id[col]
-00007780: 2c20 7665 7274 203d 2046 616c 7365 290a  , vert = False).
-00007790: 2020 2020 2020 2020 706c 742e 6d69 6e6f          plt.mino
-000077a0: 7274 6963 6b73 5f6f 6e28 290a 2020 2020  rticks_on().    
-000077b0: 2020 2020 706c 742e 6772 6964 2854 7275      plt.grid(Tru
-000077c0: 652c 2077 6869 6368 3d27 626f 7468 2729  e, which='both')
-000077d0: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
-000077e0: 7728 290a 2020 2020 2020 2020 0a20 2020  w().        .   
-000077f0: 2064 6566 2070 6c6f 7428 6466 2c20 636f   def plot(df, co
-00007800: 6c20 3d20 2772 6574 2729 3a0a 2020 2020  l = 'ret'):.    
-00007810: 2020 2020 6466 203d 2064 662e 636f 7079      df = df.copy
-00007820: 2829 0a20 2020 2020 2020 2064 662e 696e  ().        df.in
-00007830: 6465 7820 3d20 6466 2e69 6e64 6578 2e61  dex = df.index.a
-00007840: 7374 7970 6528 7374 7229 0a0a 2020 2020  stype(str)..    
-00007850: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
-00007860: 6967 7369 7a65 3d28 3230 2c20 3329 290a  igsize=(20, 3)).
-00007870: 2020 2020 2020 2020 6466 5b63 6f6c 5d2e          df[col].
-00007880: 706c 6f74 2829 0a20 2020 2020 2020 2078  plot().        x
-00007890: 5f74 6963 6b73 203d 206c 6973 7428 7261  _ticks = list(ra
-000078a0: 6e67 6528 6c65 6e28 6466 2929 290a 2020  nge(len(df))).  
-000078b0: 2020 2020 2020 785f 6c61 6265 6c73 203d        x_labels =
-000078c0: 206c 6973 7428 6466 2e69 6e64 6578 290a   list(df.index).
-000078d0: 2020 2020 2020 2020 6b20 3d20 350a 2020          k = 5.  
-000078e0: 2020 2020 2020 785f 7469 636b 7320 3d20        x_ticks = 
-000078f0: 5b78 5f74 6963 6b73 5b69 5d20 666f 7220  [x_ticks[i] for 
-00007900: 6920 696e 2072 616e 6765 286c 656e 2878  i in range(len(x
-00007910: 5f74 6963 6b73 2929 2069 6620 6920 2520  _ticks)) if i % 
-00007920: 6b20 3d3d 2030 5d0a 2020 2020 2020 2020  k == 0].        
-00007930: 785f 6c61 6265 6c73 203d 205b 785f 6c61  x_labels = [x_la
-00007940: 6265 6c73 5b69 5d20 666f 7220 6920 696e  bels[i] for i in
-00007950: 2072 616e 6765 286c 656e 2878 5f6c 6162   range(len(x_lab
-00007960: 656c 7329 2920 6966 2069 2025 206b 203d  els)) if i % k =
-00007970: 3d20 305d 0a20 2020 2020 2020 2070 6c74  = 0].        plt
-00007980: 2e78 7469 636b 7328 7469 636b 7320 3d20  .xticks(ticks = 
-00007990: 785f 7469 636b 732c 206c 6162 656c 7320  x_ticks, labels 
-000079a0: 3d20 785f 6c61 6265 6c73 2c20 726f 7461  = x_labels, rota
-000079b0: 7469 6f6e 203d 2027 7665 7274 6963 616c  tion = 'vertical
-000079c0: 272c 2066 6f6e 7473 697a 653d 3829 0a0a  ', fontsize=8)..
-000079d0: 2020 2020 2020 2020 706c 742e 6d69 6e6f          plt.mino
-000079e0: 7274 6963 6b73 5f6f 6e28 290a 2020 2020  rticks_on().    
-000079f0: 2020 2020 2320 706c 742e 6772 6964 2854      # plt.grid(T
-00007a00: 7275 652c 2077 6869 6368 3d27 626f 7468  rue, which='both
-00007a10: 2729 0a20 2020 2020 2020 2070 6c74 2e67  ').        plt.g
-00007a20: 7269 6428 5472 7565 290a 2020 2020 2020  rid(True).      
-00007a30: 2020 706c 742e 7368 6f77 2829 0a0a 2020    plt.show()..  
-00007a40: 2020 6465 6620 706c 6f74 5f6e 756d 2878    def plot_num(x
-00007a50: 2c20 706c 6f74 5f6f 7574 6c69 6572 203d  , plot_outlier =
-00007a60: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
-00007a70: 7072 696e 7428 273d 3d3d 3d3d 3d3d 3d3d  print('=========
-00007a80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007a90: 3d3d 3d3d 3d20 706c 6f74 5f6e 756d 203d  ===== plot_num =
-00007aa0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00007ab0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d27 290a  =============').
-00007ac0: 2020 2020 2020 2020 7072 696e 7428 276e          print('n
-00007ad0: 203d 207b 7d2c 206e 756c 6c20 3d20 7b7d   = {}, null = {}
-00007ae0: 272e 666f 726d 6174 286c 656e 2878 292c  '.format(len(x),
-00007af0: 2070 642e 6973 6e75 6c6c 2878 292e 7375   pd.isnull(x).su
-00007b00: 6d28 2929 290a 2020 2020 2020 2020 6465  m())).        de
-00007b10: 7320 3d20 782e 6465 7363 7269 6265 2829  s = x.describe()
-00007b20: 0a20 2020 2020 2020 2064 6573 5b27 6e75  .        des['nu
-00007b30: 6e69 7175 6527 5d20 3d20 782e 6e75 6e69  nique'] = x.nuni
-00007b40: 7175 6528 290a 2020 2020 2020 2020 7072  que().        pr
-00007b50: 696e 7428 6465 7329 0a20 2020 2020 2020  int(des).       
-00007b60: 200a 2020 2020 2020 2020 2320 6469 7374   .        # dist
-00007b70: 0a20 2020 2020 2020 2073 6e73 2e64 6973  .        sns.dis
-00007b80: 7470 6c6f 7428 7829 3b0a 2020 2020 2020  tplot(x);.      
-00007b90: 2020 706c 742e 7368 6f77 2829 3b0a 0a20    plt.show();.. 
-00007ba0: 2020 2020 2020 2023 2062 6f78 0a20 2020         # box.   
-00007bb0: 2020 2020 2061 203d 2070 6c74 2e62 6f78       a = plt.box
-00007bc0: 706c 6f74 2878 2c20 7379 6d3d 272b 2729  plot(x, sym='+')
-00007bd0: 3b0a 2020 2020 2020 2020 706c 742e 7368  ;.        plt.sh
-00007be0: 6f77 2829 3b0a 2020 2020 2020 2020 0a20  ow();.        . 
-00007bf0: 2020 2020 2020 2070 7269 6e74 2827 3d3d         print('==
-00007c00: 3d3d 3d3d 3d3d 3d3d 206f 7574 6c69 6572  ======== outlier
-00007c10: 203d 3d3d 3d3d 3d3d 3d3d 3d27 290a 2020   ==========').  
-00007c20: 2020 2020 2020 785f 6f75 746c 6965 7220        x_outlier 
-00007c30: 3d20 7064 2e53 6572 6965 7328 2861 5b27  = pd.Series((a['
-00007c40: 666c 6965 7273 275d 5b30 5d2e 6765 745f  fliers'][0].get_
-00007c50: 6461 7461 2829 5b31 5d29 290a 2020 2020  data()[1])).    
-00007c60: 2020 2020 6966 206c 656e 2878 5f6f 7574      if len(x_out
-00007c70: 6c69 6572 2920 213d 2030 2061 6e64 2070  lier) != 0 and p
-00007c80: 6c6f 745f 6f75 746c 6965 723a 0a20 2020  lot_outlier:.   
-00007c90: 2020 2020 2020 2020 2070 6c6f 745f 6e75           plot_nu
-00007ca0: 6d28 785f 6f75 746c 6965 722c 2070 6c6f  m(x_outlier, plo
-00007cb0: 745f 6f75 746c 6965 7220 3d20 4661 6c73  t_outlier = Fals
-00007cc0: 6529 0a20 2020 2072 0100 0000 7201 0000  e).    r....r...
-00007cd0: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-00007ce0: da0c 706c 6f74 5f62 6f78 706c 6f74 3303  ..plot_boxplot3.
-00007cf0: 0000 7302 0000 0000 0172 1f00 0000 6300  ..s......r....c.
-00007d00: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-00007d10: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
-00007d20: 2902 4e61 7a06 0000 0a20 2020 2064 6566  ).Naz....    def
-00007d30: 2070 6c6f 745f 695f 6928 6369 2c20 636a   plot_i_i(ci, cj
-00007d40: 2c20 6b20 3d20 3230 293a 0a20 2020 2020  , k = 20):.     
-00007d50: 2020 2066 6f72 2069 2c20 636f 6c20 696e     for i, col in
-00007d60: 2065 6e75 6d65 7261 7465 2863 6f6c 735b   enumerate(cols[
-00007d70: 6369 3a20 636a 5d29 3a0a 2020 2020 2020  ci: cj]):.      
-00007d80: 2020 2020 2020 7331 2c20 7332 203d 2064        s1, s2 = d
-00007d90: 6631 5b63 6f6c 5d2c 2064 6632 5b63 6f6c  f1[col], df2[col
-00007da0: 5d0a 2020 2020 2020 2020 2020 2020 7331  ].            s1
-00007db0: 2e6e 616d 6520 3d20 7332 2e6e 616d 6520  .name = s2.name 
-00007dc0: 3d20 690a 2020 2020 2020 2020 2020 2020  = i.            
-00007dd0: 6966 2069 2025 206b 203d 3d20 303a 2070  if i % k == 0: p
-00007de0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
-00007df0: 653d 2834 302c 2032 2929 0a20 2020 2020  e=(40, 2)).     
-00007e00: 2020 2020 2020 2070 6c74 2e73 7562 706c         plt.subpl
-00007e10: 6f74 2831 2c20 6b2c 2028 6920 2520 6b20  ot(1, k, (i % k 
-00007e20: 2b20 3129 290a 2020 2020 2020 2020 2020  + 1)).          
-00007e30: 2020 736e 732e 6469 7374 706c 6f74 2873    sns.distplot(s
-00007e40: 312c 206c 6162 656c 203d 2027 3127 290a  1, label = '1').
-00007e50: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00007e60: 6469 7374 706c 6f74 2873 322c 206c 6162  distplot(s2, lab
-00007e70: 656c 203d 2027 3227 293b 0a20 2020 2020  el = '2');.     
-00007e80: 2020 2020 2020 2070 6c74 2e6c 6567 656e         plt.legen
-00007e90: 6428 290a 2020 2020 2020 2020 2020 2020  d().            
-00007ea0: 6966 2028 6920 2b20 3129 2025 206b 203d  if (i + 1) % k =
-00007eb0: 3d20 303a 2070 6c74 2e73 686f 7728 290a  = 0: plt.show().
-00007ec0: 0a20 2020 2064 6566 2073 7562 706c 6f74  .    def subplot
-00007ed0: 5f6b 6465 5f68 7565 2874 7261 696e 2c20  _kde_hue(train, 
-00007ee0: 7472 6169 6e5f 6c61 6265 6c2c 2063 6f6c  train_label, col
-00007ef0: 5f66 6561 2c20 6e20 3d20 3230 293a 0a20  _fea, n = 20):. 
-00007f00: 2020 2020 2020 206e 5f63 6f6c 203d 2034         n_col = 4
-00007f10: 0a20 2020 2020 2020 206e 5f72 6f77 203d  .        n_row =
-00007f20: 2069 6e74 286e 702e 6365 696c 2831 2e30   int(np.ceil(1.0
-00007f30: 202a 206e 202f 206e 5f63 6f6c 2929 0a0a   * n / n_col))..
-00007f40: 2020 2020 2020 2020 6669 672c 2061 7865          fig, axe
-00007f50: 7320 3d20 706c 742e 7375 6270 6c6f 7473  s = plt.subplots
-00007f60: 286e 5f72 6f77 2c20 6e5f 636f 6c2c 2066  (n_row, n_col, f
-00007f70: 6967 7369 7a65 3d28 3136 2c20 3829 2c20  igsize=(16, 8), 
-00007f80: 7368 6172 6578 203d 2054 7275 6529 0a20  sharex = True). 
-00007f90: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00007fa0: 7261 6e67 6528 6e29 3a0a 2020 2020 2020  range(n):.      
-00007fb0: 2020 2020 2020 636f 6c20 3d20 636f 6c5f        col = col_
-00007fc0: 6665 615b 695d 0a20 2020 2020 2020 2020  fea[i].         
-00007fd0: 2020 2069 5f72 6f77 2c20 695f 636f 6c20     i_row, i_col 
-00007fe0: 3d20 696e 7428 6920 2f20 6e5f 636f 6c29  = int(i / n_col)
-00007ff0: 2c20 6920 2520 6e5f 636f 6c0a 2020 2020  , i % n_col.    
-00008000: 2020 2020 2020 2020 6178 5f69 203d 2061          ax_i = a
-00008010: 7865 735b 695f 726f 772c 2069 5f63 6f6c  xes[i_row, i_col
-00008020: 5d0a 2020 2020 2020 2020 2020 2020 736e  ].            sn
-00008030: 732e 6b64 6570 6c6f 7428 7472 6169 6e5b  s.kdeplot(train[
-00008040: 7472 6169 6e5f 6c61 6265 6c20 3d3d 2031  train_label == 1
-00008050: 5d5b 636f 6c5d 2c20 6178 3d61 785f 6929  ][col], ax=ax_i)
-00008060: 0a20 2020 2020 2020 2020 2020 2073 6e73  .            sns
-00008070: 2e6b 6465 706c 6f74 2874 7261 696e 5b74  .kdeplot(train[t
-00008080: 7261 696e 5f6c 6162 656c 203d 3d20 305d  rain_label == 0]
-00008090: 5b63 6f6c 5d2c 2061 783d 6178 5f69 290a  [col], ax=ax_i).
-000080a0: 2020 2020 2020 2020 2020 2020 6178 5f69              ax_i
-000080b0: 2e6c 6567 656e 6428 5b27 3127 2c27 3027  .legend(['1','0'
-000080c0: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
-000080d0: 785f 692e 7365 745f 7469 746c 6528 636f  x_i.set_title(co
-000080e0: 6c29 0a20 2020 2020 2020 2020 2020 2061  l).            a
-000080f0: 785f 692e 6772 6964 2829 0a0a 2020 2020  x_i.grid()..    
-00008100: 2020 2020 706c 742e 7368 6f77 2829 0a20      plt.show(). 
-00008110: 2020 2073 7562 706c 6f74 5f6b 6465 5f68     subplot_kde_h
-00008120: 7565 2874 7261 696e 322c 2074 7261 696e  ue(train2, train
-00008130: 5f6c 6162 656c 2c20 6466 5f69 6d70 5f64  _label, df_imp_d
-00008140: 6973 745b 3a32 305d 5b27 6665 6127 5d29  ist[:20]['fea'])
-00008150: 0a0a 2020 2020 6465 6620 7375 6270 6c6f  ..    def subplo
-00008160: 745f 706c 6f74 5f76 6328 7472 6169 6e2c  t_plot_vc(train,
-00008170: 2074 6573 742c 2063 6f6c 5f66 6561 2c20   test, col_fea, 
-00008180: 6e20 3d20 3230 293a 0a20 2020 2020 2020  n = 20):.       
-00008190: 206e 5f63 6f6c 203d 2034 0a20 2020 2020   n_col = 4.     
-000081a0: 2020 206e 5f72 6f77 203d 2069 6e74 286e     n_row = int(n
-000081b0: 702e 6365 696c 2831 2e30 202a 206e 202f  p.ceil(1.0 * n /
-000081c0: 206e 5f63 6f6c 2929 0a0a 2020 2020 2020   n_col))..      
-000081d0: 2020 6669 672c 2061 7865 7320 3d20 706c    fig, axes = pl
-000081e0: 742e 7375 6270 6c6f 7473 286e 5f72 6f77  t.subplots(n_row
-000081f0: 2c20 6e5f 636f 6c2c 2066 6967 7369 7a65  , n_col, figsize
-00008200: 3d28 3136 2c20 3829 2c20 7368 6172 6578  =(16, 8), sharex
-00008210: 203d 2054 7275 6529 0a20 2020 2020 2020   = True).       
-00008220: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00008230: 6e29 3a0a 2020 2020 2020 2020 2020 2020  n):.            
-00008240: 636f 6c20 3d20 636f 6c5f 6665 615b 695d  col = col_fea[i]
-00008250: 0a20 2020 2020 2020 2020 2020 2069 5f72  .            i_r
-00008260: 6f77 2c20 695f 636f 6c20 3d20 696e 7428  ow, i_col = int(
-00008270: 6920 2f20 6e5f 636f 6c29 2c20 6920 2520  i / n_col), i % 
-00008280: 6e5f 636f 6c0a 2020 2020 2020 2020 2020  n_col.          
-00008290: 2020 6178 5f69 203d 2061 7865 735b 695f    ax_i = axes[i_
-000082a0: 726f 772c 2069 5f63 6f6c 5d0a 2020 2020  row, i_col].    
-000082b0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000082c0: 2020 2020 2061 785f 692e 706c 6f74 2874       ax_i.plot(t
-000082d0: 7261 696e 5b63 6f6c 5d2e 7661 6c75 655f  rain[col].value_
-000082e0: 636f 756e 7473 2829 2e76 616c 7565 7329  counts().values)
-000082f0: 0a20 2020 2020 2020 2020 2020 2061 785f  .            ax_
-00008300: 692e 706c 6f74 2874 6573 745b 636f 6c5d  i.plot(test[col]
-00008310: 2e76 616c 7565 5f63 6f75 6e74 7328 292e  .value_counts().
-00008320: 7661 6c75 6573 290a 2020 2020 2020 2020  values).        
-00008330: 2020 2020 6178 5f69 2e6c 6567 656e 6428      ax_i.legend(
-00008340: 5b27 7472 6169 6e27 2c27 7465 7374 275d  ['train','test']
-00008350: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-00008360: 5f69 2e73 6574 5f74 6974 6c65 2863 6f6c  _i.set_title(col
-00008370: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-00008380: 5f69 2e67 7269 6428 290a 2020 2020 2020  _i.grid().      
-00008390: 2020 706c 742e 7368 6f77 2829 3b0a 2020    plt.show();.  
-000083a0: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
-000083b0: 0072 0100 0000 7202 0000 00da 0c70 6c6f  .r....r......plo
-000083c0: 745f 7375 6270 6c6f 7464 0300 0073 0200  t_subplotd...s..
-000083d0: 0000 0001 7220 0000 0063 0000 0000 0000  ....r ...c......
-000083e0: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
-000083f0: 0000 7304 0000 0064 0153 0029 024e 61ab  ..s....d.S.).Na.
-00008400: 0200 000a 2020 2020 6465 6620 706c 6f74  ....    def plot
-00008410: 5f72 6567 2864 662c 2063 6f6c 2c20 636f  _reg(df, col, co
-00008420: 6c5f 6c61 6265 6c29 3a0a 2020 2020 2020  l_label):.      
-00008430: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
-00008440: 7375 6270 6c6f 7473 2831 2c20 312c 2066  subplots(1, 1, f
-00008450: 6967 7369 7a65 3d28 3230 2c20 3229 290a  igsize=(20, 2)).
-00008460: 2020 2020 2020 2020 736e 732e 7265 6770          sns.regp
-00008470: 6c6f 7428 0a20 2020 2020 2020 2020 2020  lot(.           
-00008480: 2078 203d 2063 6f6c 2c0a 2020 2020 2020   x = col,.      
-00008490: 2020 2020 2020 7920 3d20 636f 6c5f 6c61        y = col_la
-000084a0: 6265 6c2c 0a20 2020 2020 2020 2020 2020  bel,.           
-000084b0: 2064 6174 6120 3d20 6466 2c0a 2020 2020   data = df,.    
-000084c0: 2020 2020 2020 2020 2320 6c6f 6769 7374          # logist
-000084d0: 6963 203d 2054 7275 6520 6966 2064 665b  ic = True if df[
-000084e0: 636f 6c5f 6c61 6265 6c5d 2e6e 756e 6971  col_label].nuniq
-000084f0: 7565 2829 203d 3d20 3220 656c 7365 2046  ue() == 2 else F
-00008500: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00008510: 2020 6c6f 6769 7374 6963 203d 2046 616c    logistic = Fal
-00008520: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00008530: 6e5f 626f 6f74 203d 2031 3030 2c0a 2020  n_boot = 100,.  
-00008540: 2020 2020 2020 2020 2020 795f 6a69 7474            y_jitt
-00008550: 6572 203d 202e 312c 0a20 2020 2020 2020  er = .1,.       
-00008560: 2020 2020 2073 6361 7474 6572 5f6b 7773       scatter_kws
-00008570: 203d 207b 2761 6c70 6861 273a 302e 312c   = {'alpha':0.1,
-00008580: 2027 6564 6765 636f 6c6f 7227 3a27 6e6f   'edgecolor':'no
-00008590: 6e65 277d 2c0a 2020 2020 2020 2020 2020  ne'},.          
-000085a0: 2020 6178 203d 2061 780a 2020 2020 2020    ax = ax.      
-000085b0: 2020 290a 2020 2020 2020 2020 706c 742e    ).        plt.
-000085c0: 7368 6f77 2829 0a20 2020 2020 2020 200a  show().        .
-000085d0: 2020 2020 2020 2020 6966 2064 665b 636f          if df[co
-000085e0: 6c5f 6c61 6265 6c5d 2e6e 756e 6971 7565  l_label].nunique
-000085f0: 2829 203d 3d20 323a 0a20 2020 2020 2020  () == 2:.       
-00008600: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
-00008610: 6669 6773 697a 653d 2832 302c 2032 2929  figsize=(20, 2))
-00008620: 0a20 2020 2020 2020 2020 2020 2073 6e73  .            sns
-00008630: 2e6b 6465 706c 6f74 2864 662e 6c6f 635b  .kdeplot(df.loc[
-00008640: 6466 5b63 6f6c 5f6c 6162 656c 5d20 3d3d  df[col_label] ==
-00008650: 2030 2c20 636f 6c5d 290a 2020 2020 2020   0, col]).      
-00008660: 2020 2020 2020 736e 732e 6b64 6570 6c6f        sns.kdeplo
-00008670: 7428 6466 2e6c 6f63 5b64 665b 636f 6c5f  t(df.loc[df[col_
-00008680: 6c61 6265 6c5d 203d 3d20 312c 2063 6f6c  label] == 1, col
-00008690: 5d29 0a20 2020 2020 2020 2020 2020 2070  ]).            p
-000086a0: 6c74 2e73 686f 7728 290a 2020 2020 7201  lt.show().    r.
-000086b0: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
-000086c0: 0000 7202 0000 00da 0870 6c6f 745f 7265  ..r......plot_re
-000086d0: 6795 0300 0073 0200 0000 0001 7221 0000  g....s......r!..
-000086e0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
-000086f0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
-00008700: 0153 0029 024e 61ac 0500 000a 2020 2020  .S.).Na.....    
-00008710: 6465 6620 706c 6f74 5f63 6f72 7228 6466  def plot_corr(df
-00008720: 2c20 636f 6c73 5f73 656c 203d 204e 6f6e  , cols_sel = Non
-00008730: 6529 3a0a 2020 2020 2020 2020 636f 6c73  e):.        cols
-00008740: 5f73 656c 203d 2063 6f6c 735f 7365 6c20  _sel = cols_sel 
-00008750: 6966 2063 6f6c 735f 7365 6c20 6973 206e  if cols_sel is n
-00008760: 6f74 204e 6f6e 6520 656c 7365 2064 662e  ot None else df.
-00008770: 636f 6c75 6d6e 732e 746f 6c69 7374 2829  columns.tolist()
-00008780: 0a20 2020 2020 2020 2063 6f6c 735f 7365  .        cols_se
-00008790: 6c20 3d20 5b63 6f6c 2066 6f72 2063 6f6c  l = [col for col
-000087a0: 2069 6e20 6466 2069 6620 6466 5b63 6f6c   in df if df[col
-000087b0: 5d2e 6474 7970 6573 2021 3d20 276f 626a  ].dtypes != 'obj
-000087c0: 6563 7427 5d0a 2020 2020 2020 2020 696d  ect'].        im
-000087d0: 706f 7274 2073 6369 7079 0a20 2020 2020  port scipy.     
-000087e0: 2020 206e 5f63 6f6c 203d 206c 656e 2863     n_col = len(c
-000087f0: 6f6c 735f 7365 6c29 0a20 2020 2020 2020  ols_sel).       
-00008800: 2064 665f 636f 7272 5f70 203d 206e 702e   df_corr_p = np.
-00008810: 7a65 726f 7328 286e 5f63 6f6c 2c20 6e5f  zeros((n_col, n_
-00008820: 636f 6c29 290a 2020 2020 2020 2020 6466  col)).        df
-00008830: 5f63 6f72 725f 7370 203d 206e 702e 7a65  _corr_sp = np.ze
-00008840: 726f 7328 286e 5f63 6f6c 2c20 6e5f 636f  ros((n_col, n_co
-00008850: 6c29 290a 2020 2020 2020 2020 666f 7220  l)).        for 
-00008860: 6920 696e 2072 616e 6765 286e 5f63 6f6c  i in range(n_col
-00008870: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-00008880: 6f72 206a 2069 6e20 7261 6e67 6528 692c  or j in range(i,
-00008890: 206e 5f63 6f6c 293a 0a20 2020 2020 2020   n_col):.       
-000088a0: 2020 2020 2020 2020 2063 312c 2063 3220           c1, c2 
-000088b0: 3d20 6466 5b63 6f6c 735f 7365 6c5b 695d  = df[cols_sel[i]
-000088c0: 5d2c 2064 665b 636f 6c73 5f73 656c 5b6a  ], df[cols_sel[j
-000088d0: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
-000088e0: 2020 2064 665f 636f 7272 5f70 5b69 2c20     df_corr_p[i, 
-000088f0: 6a5d 203d 206e 702e 636f 7272 636f 6566  j] = np.corrcoef
-00008900: 2863 312c 2063 3229 5b30 5d5b 315d 0a20  (c1, c2)[0][1]. 
-00008910: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00008920: 665f 636f 7272 5f70 5b6a 2c20 695d 203d  f_corr_p[j, i] =
-00008930: 2064 665f 636f 7272 5f70 5b69 2c20 6a5d   df_corr_p[i, j]
-00008940: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008950: 2020 6466 5f63 6f72 725f 7370 5b69 2c20    df_corr_sp[i, 
-00008960: 6a5d 203d 2073 6369 7079 2e73 7461 7473  j] = scipy.stats
-00008970: 2e73 7065 6172 6d61 6e72 2863 312c 2063  .spearmanr(c1, c
-00008980: 3229 5b30 5d0a 2020 2020 2020 2020 2020  2)[0].          
-00008990: 2020 2020 2020 6466 5f63 6f72 725f 7370        df_corr_sp
-000089a0: 5b6a 2c20 695d 203d 2064 665f 636f 7272  [j, i] = df_corr
-000089b0: 5f73 705b 692c 206a 5d0a 2020 2020 2020  _sp[i, j].      
-000089c0: 2020 0a20 2020 2020 2020 2064 665f 636f    .        df_co
-000089d0: 7272 5f70 203d 2070 642e 4461 7461 4672  rr_p = pd.DataFr
-000089e0: 616d 6528 6466 5f63 6f72 725f 702c 2069  ame(df_corr_p, i
-000089f0: 6e64 6578 203d 2063 6f6c 735f 7365 6c2c  ndex = cols_sel,
-00008a00: 2063 6f6c 756d 6e73 203d 2063 6f6c 735f   columns = cols_
-00008a10: 7365 6c29 2020 2020 2020 0a20 2020 2020  sel)      .     
-00008a20: 2020 2064 665f 636f 7272 5f73 7020 3d20     df_corr_sp = 
-00008a30: 7064 2e44 6174 6146 7261 6d65 2864 665f  pd.DataFrame(df_
-00008a40: 636f 7272 5f73 702c 2069 6e64 6578 203d  corr_sp, index =
-00008a50: 2063 6f6c 735f 7365 6c2c 2063 6f6c 756d   cols_sel, colum
-00008a60: 6e73 203d 2063 6f6c 735f 7365 6c29 2020  ns = cols_sel)  
-00008a70: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00008a80: 200a 2020 2020 2020 2020 2320 706c 6f74   .        # plot
-00008a90: 2020 2020 0a20 2020 2020 2020 2070 6c74      .        plt
-00008aa0: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-00008ab0: 2832 302c 2037 2929 0a20 2020 2020 2020  (20, 7)).       
-00008ac0: 2070 6c74 2e73 7562 706c 6f74 2831 2c20   plt.subplot(1, 
-00008ad0: 322c 2031 290a 2020 2020 2020 2020 736e  2, 1).        sn
-00008ae0: 732e 6865 6174 6d61 7028 6466 5f63 6f72  s.heatmap(df_cor
-00008af0: 725f 702c 206c 696e 6577 6964 7468 7320  r_p, linewidths 
-00008b00: 3d20 302e 352c 2073 7175 6172 653d 5472  = 0.5, square=Tr
-00008b10: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00008b20: 2020 2020 2020 2020 616e 6e6f 743d 5472          annot=Tr
-00008b30: 7565 2c20 666d 743d 272e 3266 272c 2061  ue, fmt='.2f', a
-00008b40: 6e6e 6f74 5f6b 7773 3d7b 2773 697a 6527  nnot_kws={'size'
-00008b50: 3a31 307d 293b 0a20 2020 2020 2020 2070  :10});.        p
-00008b60: 6c74 2e74 6974 6c65 2827 636f 7272 636f  lt.title('corrco
-00008b70: 6566 2729 0a20 2020 2020 2020 200a 2020  ef').        .  
-00008b80: 2020 2020 2020 706c 742e 7375 6270 6c6f        plt.subplo
-00008b90: 7428 312c 2032 2c20 3229 0a20 2020 2020  t(1, 2, 2).     
-00008ba0: 2020 2073 6e73 2e68 6561 746d 6170 2864     sns.heatmap(d
-00008bb0: 665f 636f 7272 5f73 702c 206c 696e 6577  f_corr_sp, linew
-00008bc0: 6964 7468 7320 3d20 302e 352c 2073 7175  idths = 0.5, squ
-00008bd0: 6172 653d 5472 7565 2c0a 2020 2020 2020  are=True,.      
-00008be0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00008bf0: 6e6f 743d 5472 7565 2c20 666d 743d 272e  not=True, fmt='.
-00008c00: 3266 272c 2061 6e6e 6f74 5f6b 7773 3d7b  2f', annot_kws={
-00008c10: 2773 697a 6527 3a31 307d 293b 0a20 2020  'size':10});.   
-00008c20: 2020 2020 2070 6c74 2e74 6974 6c65 2827       plt.title('
-00008c30: 7370 6561 726d 616e 7227 290a 2020 2020  spearmanr').    
-00008c40: 2020 2020 706c 742e 7368 6f77 2829 2020      plt.show()  
-00008c50: 2020 2020 2020 0a20 2020 2020 2020 200a        .        .
-00008c60: 2020 2020 2320 706c 6f74 5f63 6f72 7228      # plot_corr(
-00008c70: 7472 6169 6e2c 2063 6f6c 735f 7365 6c20  train, cols_sel 
-00008c80: 3d20 636f 6c73 5f63 6174 202b 2063 6f6c  = cols_cat + col
-00008c90: 735f 6e75 6d29 0a20 2020 2023 2070 6c6f  s_num).    # plo
-00008ca0: 745f 636f 7272 2862 6173 6963 5f69 6e66  t_corr(basic_inf
-00008cb0: 6f29 0a20 2020 2072 0100 0000 7201 0000  o).    r....r...
-00008cc0: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-00008cd0: da09 706c 6f74 5f63 6f72 72ad 0300 0073  ..plot_corr....s
-00008ce0: 0200 0000 0001 7222 0000 0063 0000 0000  ......r"...c....
-00008cf0: 0000 0000 0000 0000 0000 0000 0100 0000  ................
-00008d00: 4300 0000 7304 0000 0064 0153 0029 024e  C...s....d.S.).N
-00008d10: 7542 0700 000a 2020 2020 6465 6620 706c  uB....    def pl
-00008d20: 6f74 5f6f 6e74 2863 312c 2063 3229 3a0a  ot_ont(c1, c2):.
-00008d30: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
-00008d40: 7265 2866 6967 7369 7a65 3d28 372c 2037  re(figsize=(7, 7
-00008d50: 2929 0a20 2020 2020 2020 2064 665f 6920  )).        df_i 
-00008d60: 3d20 6466 5b64 665b 2772 6567 696f 6e27  = df[df['region'
-00008d70: 5d2e 6973 696e 285b 315d 295d 0a20 2020  ].isin([1])].   
-00008d80: 2020 2020 2073 6e73 2e72 6567 706c 6f74       sns.regplot
-00008d90: 2864 665f 695b 6331 5d2c 2064 665f 695b  (df_i[c1], df_i[
-00008da0: 6332 5d2c 0a20 2020 2020 2020 2020 2020  c2],.           
-00008db0: 2020 2020 2020 2020 206d 6172 6b65 723d           marker=
-00008dc0: 2778 272c 200a 2020 2020 2020 2020 2020  'x', .          
-00008dd0: 2020 2020 2020 2020 2020 7363 6174 7465            scatte
-00008de0: 725f 6b77 733d 7b27 616c 7068 6127 3a30  r_kws={'alpha':0
-00008df0: 2e37 357d 2c0a 2020 2020 2020 2020 2020  .75},.          
-00008e00: 2020 2020 2020 2020 2020 6c69 6e65 5f6b            line_k
-00008e10: 7773 3d7b 2761 6c70 6861 273a 302e 3735  ws={'alpha':0.75
-00008e20: 7d29 0a0a 2020 2020 2020 2020 6466 5f69  })..        df_i
-00008e30: 203d 2064 665b 6466 5b27 7265 6769 6f6e   = df[df['region
-00008e40: 275d 2e69 7369 6e28 5b32 2c33 5d29 5d0a  '].isin([2,3])].
-00008e50: 2020 2020 2020 2020 736e 732e 7265 6770          sns.regp
-00008e60: 6c6f 7428 6466 5f69 5b63 315d 2c20 6466  lot(df_i[c1], df
-00008e70: 5f69 5b63 325d 2c20 0a20 2020 2020 2020  _i[c2], .       
-00008e80: 2020 2020 2020 2020 2020 2020 206d 6172               mar
-00008e90: 6b65 723d 276f 272c 200a 2020 2020 2020  ker='o', .      
-00008ea0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-00008eb0: 6174 7465 725f 6b77 733d 7b27 616c 7068  atter_kws={'alph
-00008ec0: 6127 3a30 2e36 7d2c 200a 2020 2020 2020  a':0.6}, .      
-00008ed0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00008ee0: 6e65 5f6b 7773 3d7b 2761 6c70 6861 273a  ne_kws={'alpha':
-00008ef0: 302e 362c 2027 6c69 6e65 7374 796c 6527  0.6, 'linestyle'
-00008f00: 3a27 6461 7368 6564 277d 290a 2020 2020  :'dashed'}).    
-00008f10: 2020 2020 706c 742e 786c 6162 656c 2863      plt.xlabel(c
-00008f20: 312c 2073 697a 6520 3d20 3230 290a 2020  1, size = 20).  
-00008f30: 2020 2020 2020 706c 742e 796c 6162 656c        plt.ylabel
-00008f40: 2863 325b 3a2d 315d 2c20 7369 7a65 203d  (c2[:-1], size =
-00008f50: 2032 3029 0a20 2020 2020 2020 2070 6c74   20).        plt
-00008f60: 2e6c 6567 656e 6428 5b27 e4b8 9ce9 83a8  .legend(['......
-00008f70: 272c 2027 e4b8 ade8 a5bf e983 a827 5d29  ', '.........'])
-00008f80: 0a20 2020 2020 2020 2070 6c74 2e73 6176  .        plt.sav
-00008f90: 6566 6967 2866 272e 2f66 6f72 5f6d 7a79  efig(f'./for_mzy
-00008fa0: 2f7b 6331 7d5f 7b63 325b 3a2d 315d 7d2e  /{c1}_{c2[:-1]}.
-00008fb0: 6a70 6567 272c 2064 7069 203d 2032 3030  jpeg', dpi = 200
-00008fc0: 290a 2020 2020 2020 2020 706c 742e 7368  ).        plt.sh
-00008fd0: 6f77 2829 0a0a 2020 2020 4b20 3d20 350a  ow()..    K = 5.
-00008fe0: 2020 2020 666f 7220 692c 2063 6f6c 5f78      for i, col_x
-00008ff0: 2069 6e20 656e 756d 6572 6174 6528 636f   in enumerate(co
-00009000: 6c73 5f78 293a 0a20 2020 2020 2020 2069  ls_x):.        i
-00009010: 6620 6920 2520 4b20 3d3d 2030 3a0a 2020  f i % K == 0:.  
-00009020: 2020 2020 2020 2020 2020 706c 742e 6669            plt.fi
-00009030: 6775 7265 2866 6967 7369 7a65 203d 2028  gure(figsize = (
-00009040: 3230 2c20 3529 290a 2020 2020 2020 2020  20, 5)).        
-00009050: 706c 742e 7375 6270 6c6f 7428 312c 204b  plt.subplot(1, K
-00009060: 2c20 2069 2025 204b 202b 2031 290a 2020  ,  i % K + 1).  
-00009070: 2020 2020 2020 782c 2079 203d 2074 6573        x, y = tes
-00009080: 745f 7465 6d70 5b63 6f6c 5f78 5d2c 2074  t_temp[col_x], t
-00009090: 6573 745f 7465 6d70 5b63 6f6c 5f79 5d0a  est_temp[col_y].
-000090a0: 2020 2020 2020 2020 2320 706c 742e 7363          # plt.sc
-000090b0: 6174 7465 7228 7820 3d20 782c 2079 203d  atter(x = x, y =
-000090c0: 2079 2c20 7320 3d20 312c 206d 6172 6b65   y, s = 1, marke
-000090d0: 7220 3d20 276f 272c 2061 6c70 6861 203d  r = 'o', alpha =
-000090e0: 2030 2e35 290a 2020 2020 2020 2020 736e   0.5).        sn
-000090f0: 732e 7363 6174 7465 7270 6c6f 7428 7820  s.scatterplot(x 
-00009100: 3d20 782c 2079 203d 2079 2c20 616c 7068  = x, y = y, alph
-00009110: 6120 3d20 302e 3735 2923 2c20 7320 3d20  a = 0.75)#, s = 
-00009120: 312c 206d 6172 6b65 7220 3d20 276f 272c  1, marker = 'o',
-00009130: 2061 6c70 6861 203d 2030 2e35 290a 2020   alpha = 0.5).  
-00009140: 2020 2020 2020 706c 742e 6772 6964 2829        plt.grid()
-00009150: 0a20 2020 2020 2020 2069 6620 6920 2520  .        if i % 
-00009160: 4b20 3d3d 204b 202d 2031 3a0a 2020 2020  K == K - 1:.    
-00009170: 2020 2020 2020 2020 706c 742e 7368 6f77          plt.show
-00009180: 2829 0a0a 2020 2020 696d 706f 7274 206d  ()..    import m
-00009190: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
-000091a0: 2061 7320 706c 740a 2020 2020 696d 706f   as plt.    impo
-000091b0: 7274 2073 6561 626f 726e 2061 7320 736e  rt seaborn as sn
-000091c0: 730a 2020 2020 6465 6620 7363 6174 7465  s.    def scatte
-000091d0: 725f 636f 6c6f 725f 7369 7a65 2864 662c  r_color_size(df,
-000091e0: 2078 2c20 792c 2063 2c20 7329 3a0a 2020   x, y, c, s):.  
-000091f0: 2020 2020 2020 636f 6c6f 7273 203d 2073        colors = s
-00009200: 6e73 2e63 6f6c 6f72 5f70 616c 6574 7465  ns.color_palette
-00009210: 2827 7669 7269 6469 7327 2c20 6466 5b63  ('viridis', df[c
-00009220: 5d2e 6e75 6e69 7175 6528 2929 0a20 2020  ].nunique()).   
-00009230: 2020 2020 2073 6e73 2e72 656c 706c 6f74       sns.relplot
-00009240: 2878 203d 2078 2c20 7920 3d20 792c 2068  (x = x, y = y, h
-00009250: 7565 203d 2063 2c20 7369 7a65 203d 2073  ue = c, size = s
-00009260: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-00009270: 2020 2020 2020 2061 6c70 6861 203d 2030         alpha = 0
-00009280: 2e36 2c20 7369 7a65 7320 3d20 2835 2c20  .6, sizes = (5, 
-00009290: 3330 3029 2c20 2320 e782 b9e7 9a84 e980  300), # ........
-000092a0: 8fe6 988e e59b bee5 928c e782 b9e7 9a84  ................
-000092b0: e5a4 a7e5 b08f e88c 83e5 9bb4 0a20 2020  .............   
-000092c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092d0: 2064 6174 6120 3d20 6466 2c20 7061 6c65   data = df, pale
-000092e0: 7474 6520 3d20 636f 6c6f 7273 2c20 6c65  tte = colors, le
-000092f0: 6765 6e64 203d 2046 616c 7365 290a 2020  gend = False).  
-00009300: 2020 2020 2020 706c 742e 706c 6f74 2864        plt.plot(d
-00009310: 665b 785d 2c20 6466 5b79 5d2c 206c 696e  f[x], df[y], lin
-00009320: 6577 6964 7468 203d 2031 290a 2020 2020  ewidth = 1).    
-00009330: 2020 2020 706c 742e 7469 746c 6528 2774      plt.title('t
-00009340: 6974 6c65 2729 0a20 2020 2020 2020 2070  itle').        p
-00009350: 6c74 2e73 686f 7728 290a 2020 2020 2020  lt.show().      
-00009360: 2020 0a20 2020 2064 6620 3d20 7472 6169    .    df = trai
-00009370: 6e5b 7472 6169 6e5b 2769 6427 5d20 3d3d  n[train['id'] ==
-00009380: 2030 5d0a 2020 2020 782c 2079 203d 2027   0].    x, y = '
-00009390: 7827 2c20 2779 270a 2020 2020 6320 3d20  x', 'y'.    c = 
-000093a0: 2779 2720 2320 e6a0 b9e6 8dae 63e5 8886  'y' # ......c...
-000093b0: e7bb 84ef bc8c e6af 8fe4 b8aa e7bb 8431  ...............1
-000093c0: e7a7 8de9 a29c e889 b2ef bc8c 2023 20e5  ............ # .
-000093d0: 8faa e69c 89e4 b880 e7a7 8de9 a29c e889  ................
-000093e0: b2e7 9a84 e794 bbef bc8c 6466 5b63 5d20  ..........df[c] 
-000093f0: 3d20 31e5 b8b8 e695 b0e5 b0b1 e8a1 8c0a  = 1.............
-00009400: 2020 2020 7320 3d20 2776 2720 2320 e586      s = 'v' # ..
-00009410: b3e5 ae9a e782 b9e7 9a84 e5a4 a7e5 b08f  ................
-00009420: 0a20 2020 2073 6361 7474 6572 5f63 6f6c  .    scatter_col
-00009430: 6f72 5f73 697a 6528 6466 2c20 782c 2079  or_size(df, x, y
-00009440: 2c20 632c 2073 2920 2020 2020 2020 2020  , c, s)         
-00009450: 2020 0a20 2020 2072 0100 0000 7201 0000    .    r....r...
-00009460: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-00009470: da0c 706c 6f74 5f73 6361 7474 6572 d303  ..plot_scatter..
-00009480: 0000 7302 0000 0000 0172 2300 0000 6300  ..s......r#...c.
-00009490: 0000 0000 0000 0000 0000 0000 0000 0001  ................
-000094a0: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
-000094b0: 2902 4e61 640b 0000 0a20 2020 2069 6d70  ).Nad....    imp
-000094c0: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
-000094d0: 2020 2020 696d 706f 7274 2070 616e 6461      import panda
-000094e0: 7320 6173 2070 640a 2020 2020 696d 706f  s as pd.    impo
-000094f0: 7274 2077 6172 6e69 6e67 7320 0a20 2020  rt warnings .   
-00009500: 2077 6172 6e69 6e67 732e 6669 6c74 6572   warnings.filter
-00009510: 7761 726e 696e 6773 2822 6967 6e6f 7265  warnings("ignore
-00009520: 2229 0a20 2020 2069 6d70 6f72 7420 6d61  ").    import ma
-00009530: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
-00009540: 6173 2070 6c74 0a20 2020 2069 6d70 6f72  as plt.    impor
-00009550: 7420 7365 6162 6f72 6e20 6173 2073 6e73  t seaborn as sns
-00009560: 0a20 2020 2073 6e73 2e73 6574 2873 7479  .    sns.set(sty
-00009570: 6c65 3d22 7768 6974 6522 2c20 636f 6c6f  le="white", colo
-00009580: 725f 636f 6465 733d 5472 7565 290a 0a20  r_codes=True).. 
-00009590: 2020 2064 6566 2070 6c6f 745f 6e75 6d28     def plot_num(
-000095a0: 782c 2064 6565 7020 3d20 302c 2070 6c6f  x, deep = 0, plo
-000095b0: 745f 6f75 746c 6965 7220 3d20 4661 6c73  t_outlier = Fals
-000095c0: 652c 2070 7269 6e74 5f69 6e66 6f20 3d20  e, print_info = 
-000095d0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-000095e0: 6966 2064 6565 7020 3d3d 2030 2061 6e64  if deep == 0 and
-000095f0: 2070 7269 6e74 5f69 6e66 6f3a 0a20 2020   print_info:.   
-00009600: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00009610: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009620: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009630: 3d3d 3d3d 3d3d 3d3d 2070 6c6f 745f 6e75  ======== plot_nu
-00009640: 6d20 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  m ==============
-00009650: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009660: 3d3d 3d3d 3d3d 3d3d 3d3d 2729 0a20 2020  ==========').   
-00009670: 2020 2020 2070 7269 6e74 2827 6e20 3d20       print('n = 
-00009680: 7b7d 2c20 6e75 6c6c 203d 207b 7d27 2e66  {}, null = {}'.f
-00009690: 6f72 6d61 7428 6c65 6e28 7829 2c20 7064  ormat(len(x), pd
-000096a0: 2e69 736e 756c 6c28 7829 2e73 756d 2829  .isnull(x).sum()
-000096b0: 2929 0a20 2020 2020 2020 2064 6573 203d  )).        des =
-000096c0: 2078 2e64 6573 6372 6962 6528 290a 2020   x.describe().  
-000096d0: 2020 2020 2020 6465 735b 276e 756e 6971        des['nuniq
-000096e0: 7565 275d 203d 2078 2e6e 756e 6971 7565  ue'] = x.nunique
-000096f0: 2829 0a20 2020 2020 2020 2069 6620 7072  ().        if pr
-00009700: 696e 745f 696e 666f 3a0a 2020 2020 2020  int_info:.      
-00009710: 2020 2020 2020 7072 696e 7428 6465 7329        print(des)
-00009720: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00009730: 2020 706c 742e 6669 6775 7265 2866 6967    plt.figure(fig
-00009740: 7369 7a65 203d 2028 3230 2c20 3229 290a  size = (20, 2)).
-00009750: 2020 2020 2020 2020 706c 742e 7375 6270          plt.subp
-00009760: 6c6f 7428 312c 2033 2c20 3129 0a20 2020  lot(1, 3, 1).   
-00009770: 2020 2020 2070 6c74 2e70 6c6f 7428 6e70       plt.plot(np
-00009780: 2e61 7261 6e67 6528 6c65 6e28 7829 292c  .arange(len(x)),
-00009790: 206e 702e 736f 7274 2878 2929 0a20 2020   np.sort(x)).   
-000097a0: 2020 2020 200a 2020 2020 2020 2020 706c       .        pl
-000097b0: 742e 7375 6270 6c6f 7428 312c 2033 2c20  t.subplot(1, 3, 
-000097c0: 3229 0a20 2020 2020 2020 2073 6e73 2e64  2).        sns.d
-000097d0: 6973 7470 6c6f 7428 7829 3b0a 0a20 2020  istplot(x);..   
-000097e0: 2020 2020 2070 6c74 2e73 7562 706c 6f74       plt.subplot
-000097f0: 2831 2c20 332c 2033 290a 2020 2020 2020  (1, 3, 3).      
-00009800: 2020 6120 3d20 706c 742e 626f 7870 6c6f    a = plt.boxplo
-00009810: 7428 782c 2073 796d 203d 2027 2b27 2c20  t(x, sym = '+', 
-00009820: 7665 7274 203d 2046 616c 7365 293b 0a20  vert = False);. 
-00009830: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
-00009840: 293b 0a20 2020 2020 2020 200a 2020 2020  );.        .    
-00009850: 2020 2020 785f 6f75 746c 6965 7220 3d20      x_outlier = 
-00009860: 7064 2e53 6572 6965 7328 2861 5b27 666c  pd.Series((a['fl
-00009870: 6965 7273 275d 5b30 5d2e 6765 745f 6461  iers'][0].get_da
-00009880: 7461 2829 5b31 5d29 290a 2020 2020 2020  ta()[1])).      
-00009890: 2020 6966 2070 6c6f 745f 6f75 746c 6965    if plot_outlie
-000098a0: 7220 616e 6420 6c65 6e28 785f 6f75 746c  r and len(x_outl
-000098b0: 6965 7229 2021 3d20 3020 616e 6420 6465  ier) != 0 and de
-000098c0: 6570 203d 3d20 303a 0a20 2020 2020 2020  ep == 0:.       
-000098d0: 2020 2020 2069 6620 7072 696e 745f 696e       if print_in
-000098e0: 666f 3a0a 2020 2020 2020 2020 2020 2020  fo:.            
-000098f0: 2020 2020 7072 696e 7428 273d 3d3d 3d3d      print('=====
-00009900: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-00009910: 6f75 746c 6965 7220 3d3d 3d3d 3d3d 3d3d  outlier ========
-00009920: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009930: 3d3d 3d3d 3d3d 2729 0a20 2020 2020 2020  ======').       
-00009940: 2020 2020 2070 6c6f 745f 6e75 6d28 785f       plot_num(x_
-00009950: 6f75 746c 6965 722c 2064 6565 7020 2b20  outlier, deep + 
-00009960: 3129 0a20 2020 2020 2020 2020 2020 200a  1).            .
-00009970: 2020 2020 6465 6620 706c 6f74 5f63 6174      def plot_cat
-00009980: 2878 2c20 6b20 3d20 3130 302c 2070 7269  (x, k = 100, pri
-00009990: 6e74 5f69 6e66 6f20 3d20 4661 6c73 6529  nt_info = False)
-000099a0: 3a0a 2020 2020 2020 2020 7663 203d 2078  :.        vc = x
-000099b0: 2e76 616c 7565 5f63 6f75 6e74 7328 295b  .value_counts()[
-000099c0: 3a6b 5d0a 2020 2020 2020 2020 6966 2070  :k].        if p
-000099d0: 7269 6e74 5f69 6e66 6f3a 0a20 2020 2020  rint_info:.     
-000099e0: 2020 2020 2020 2070 7269 6e74 2827 3d3d         print('==
-000099f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009a00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009a10: 3d3d 3d3d 3d3d 2070 6c6f 745f 6361 7420  ====== plot_cat 
-00009a20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009a30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00009a40: 3d3d 3d3d 3d3d 3d3d 2729 0a20 2020 2020  ========').     
-00009a50: 2020 2020 2020 2070 7269 6e74 2827 6474         print('dt
-00009a60: 7970 6573 2e76 616c 7565 5f63 6f75 6e74  ypes.value_count
-00009a70: 7328 2920 3d20 0a7b 7d27 2e66 6f72 6d61  s() = .{}'.forma
-00009a80: 7428 7663 2e68 6561 6428 3130 2929 290a  t(vc.head(10))).
-00009a90: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00009aa0: 2023 203d 3d3d 3d3d 3d3d 3d3d 3d20 6375   # ========== cu
-00009ab0: 6d73 756d 203d 3d3d 3d3d 3d3d 3d3d 3d0a  msum ==========.
-00009ac0: 2020 2020 2020 2020 7663 203d 2076 632e          vc = vc.
-00009ad0: 736f 7274 5f69 6e64 6578 2829 0a20 2020  sort_index().   
-00009ae0: 2020 2020 2023 2070 7269 6e74 2827 736f       # print('so
-00009af0: 7274 2062 7920 696e 6465 7827 290a 2020  rt by index').  
-00009b00: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
-00009b10: 2866 6967 7369 7a65 3d28 3230 2c20 3229  (figsize=(20, 2)
-00009b20: 290a 2020 2020 2020 2020 706c 742e 7375  ).        plt.su
-00009b30: 6270 6c6f 7428 312c 2033 2c20 3129 0a20  bplot(1, 3, 1). 
-00009b40: 2020 2020 2020 2073 6e73 2e62 6172 706c         sns.barpl
-00009b50: 6f74 286e 702e 6172 616e 6765 286c 656e  ot(np.arange(len
-00009b60: 2876 6329 292c 2076 632e 7661 6c75 6573  (vc)), vc.values
-00009b70: 293b 0a20 2020 2020 2020 2070 6c74 2e70  );.        plt.p
-00009b80: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
-00009b90: 6e28 7663 2929 2c20 7663 2e76 616c 7565  n(vc)), vc.value
-00009ba0: 732c 2027 622d 2729 3b0a 2020 2020 2020  s, 'b-');.      
-00009bb0: 2020 706c 742e 706c 6f74 286e 702e 6172    plt.plot(np.ar
-00009bc0: 616e 6765 286c 656e 2876 6329 292c 2076  ange(len(vc)), v
-00009bd0: 632e 7661 6c75 6573 2c20 2772 7827 293b  c.values, 'rx');
-00009be0: 0a20 2020 2020 2020 2070 6c74 2e78 7469  .        plt.xti
-00009bf0: 636b 7328 6e70 2e61 7261 6e67 6528 6c65  cks(np.arange(le
-00009c00: 6e28 7663 2929 2c20 7663 2e69 6e64 6578  n(vc)), vc.index
-00009c10: 290a 2020 2020 2020 2020 706c 742e 7469  ).        plt.ti
-00009c20: 746c 6528 2773 6f72 7420 6279 2069 6e64  tle('sort by ind
-00009c30: 6578 2729 0a20 2020 2020 2020 2023 706c  ex').        #pl
-00009c40: 742e 7368 6f77 2829 3b0a 0a20 2020 2020  t.show();..     
-00009c50: 2020 2023 2070 7269 6e74 2827 736f 7274     # print('sort
-00009c60: 2062 7920 7661 6c75 6573 2729 0a20 2020   by values').   
-00009c70: 2020 2020 2070 6c74 2e73 7562 706c 6f74       plt.subplot
-00009c80: 2831 2c20 332c 2032 290a 2020 2020 2020  (1, 3, 2).      
-00009c90: 2020 7663 203d 2076 632e 736f 7274 5f76    vc = vc.sort_v
-00009ca0: 616c 7565 7328 6173 6365 6e64 696e 6720  alues(ascending 
-00009cb0: 3d20 4661 6c73 6529 0a20 2020 2020 2020  = False).       
-00009cc0: 2073 6e73 2e62 6172 706c 6f74 286e 702e   sns.barplot(np.
-00009cd0: 6172 616e 6765 286c 656e 2876 6329 292c  arange(len(vc)),
-00009ce0: 2076 632e 7661 6c75 6573 293b 0a20 2020   vc.values);.   
-00009cf0: 2020 2020 2070 6c74 2e70 6c6f 7428 6e70       plt.plot(np
-00009d00: 2e61 7261 6e67 6528 6c65 6e28 7663 2929  .arange(len(vc))
-00009d10: 2c20 7663 2e76 616c 7565 732c 2027 622d  , vc.values, 'b-
-00009d20: 2729 3b0a 2020 2020 2020 2020 706c 742e  ');.        plt.
-00009d30: 706c 6f74 286e 702e 6172 616e 6765 286c  plot(np.arange(l
-00009d40: 656e 2876 6329 292c 2076 632e 7661 6c75  en(vc)), vc.valu
-00009d50: 6573 2c20 2772 7827 293b 0a20 2020 2020  es, 'rx');.     
-00009d60: 2020 2070 6c74 2e78 7469 636b 7328 6e70     plt.xticks(np
-00009d70: 2e61 7261 6e67 6528 6c65 6e28 7663 2929  .arange(len(vc))
-00009d80: 2c20 7663 2e69 6e64 6578 290a 2020 2020  , vc.index).    
-00009d90: 2020 2020 706c 742e 7469 746c 6528 2773      plt.title('s
-00009da0: 6f72 7420 6279 2076 616c 7565 7327 290a  ort by values').
-00009db0: 2020 2020 2020 2020 2370 6c74 2e73 686f          #plt.sho
-00009dc0: 7728 293b 0a0a 2020 2020 2020 2020 2320  w();..        # 
-00009dd0: 3d3d 3d3d 3d3d 3d3d 3d3d 2063 756d 7375  ========== cumsu
-00009de0: 6d20 3d3d 3d3d 3d3d 3d3d 3d3d 0a20 2020  m ==========.   
-00009df0: 2020 2020 2023 2070 7269 6e74 2827 6375       # print('cu
-00009e00: 6d73 756d 2729 0a20 2020 2020 2020 2070  msum').        p
-00009e10: 6c74 2e73 7562 706c 6f74 2831 2c20 332c  lt.subplot(1, 3,
-00009e20: 2033 290a 2020 2020 2020 2020 7663 203d   3).        vc =
-00009e30: 2078 2e76 616c 7565 5f63 6f75 6e74 7328   x.value_counts(
-00009e40: 290a 2020 2020 2020 2020 7663 5f63 756d  ).        vc_cum
-00009e50: 7375 6d20 3d20 7663 2e63 756d 7375 6d28  sum = vc.cumsum(
-00009e60: 292e 7265 7365 745f 696e 6465 7828 6472  ).reset_index(dr
-00009e70: 6f70 203d 2054 7275 6529 0a20 2020 2020  op = True).     
-00009e80: 2020 2076 635f 6375 6d73 756d 202f 3d20     vc_cumsum /= 
-00009e90: 7663 5f63 756d 7375 6d2e 6d61 7828 290a  vc_cumsum.max().
-00009ea0: 2020 2020 2020 2020 706c 742e 706c 6f74          plt.plot
-00009eb0: 2876 635f 6375 6d73 756d 2c20 2762 2d27  (vc_cumsum, 'b-'
-00009ec0: 290a 2020 2020 2020 2020 706c 742e 706c  ).        plt.pl
-00009ed0: 6f74 2876 635f 6375 6d73 756d 2c20 2772  ot(vc_cumsum, 'r
-00009ee0: 7827 290a 2020 2020 2020 2020 7879 5f30  x').        xy_0
-00009ef0: 3920 3d20 7663 5f63 756d 7375 6d5b 7663  9 = vc_cumsum[vc
-00009f00: 5f63 756d 7375 6d20 3e3d 2030 2e39 5d5b  _cumsum >= 0.9][
-00009f10: 3a31 5d0a 2020 2020 2020 2020 785f 3039  :1].        x_09
-00009f20: 2c20 795f 3039 203d 2078 795f 3039 2e69  , y_09 = xy_09.i
-00009f30: 6e64 6578 2e76 616c 7565 735b 305d 2c20  ndex.values[0], 
-00009f40: 7879 5f30 392e 7661 6c75 6573 5b30 5d0a  xy_09.values[0].
-00009f50: 2020 2020 2020 2020 706c 742e 6178 686c          plt.axhl
-00009f60: 696e 6528 795f 3039 2c20 636f 6c6f 7220  ine(y_09, color 
-00009f70: 3d20 2772 2729 0a20 2020 2020 2020 2070  = 'r').        p
-00009f80: 6c74 2e61 7876 6c69 6e65 2878 5f30 392c  lt.axvline(x_09,
-00009f90: 2063 6f6c 6f72 203d 2027 7227 290a 2020   color = 'r').  
-00009fa0: 2020 2020 2020 706c 742e 7469 746c 6528        plt.title(
-00009fb0: 2778 5f30 3920 3d20 7b7d 2c20 785f 2520  'x_09 = {}, x_% 
-00009fc0: 3d20 7b3a 2e34 667d 2c20 795f 3039 203d  = {:.4f}, y_09 =
-00009fd0: 207b 3a2e 3466 7d27 2e66 6f72 6d61 7428   {:.4f}'.format(
-00009fe0: 785f 3039 2c20 785f 3039 202f 206c 656e  x_09, x_09 / len
-00009ff0: 2876 635f 6375 6d73 756d 292c 2079 5f30  (vc_cumsum), y_0
-0000a000: 3929 290a 2020 2020 2020 2020 706c 742e  9)).        plt.
-0000a010: 7368 6f77 2829 3b0a 2020 2020 7201 0000  show();.    r...
-0000a020: 0072 0100 0000 7201 0000 0072 0100 0000  .r....r....r....
-0000a030: 7202 0000 00da 0b70 6c6f 745f 636f 6c73  r......plot_cols
-0000a040: 5f31 0604 0000 7302 0000 0000 0172 2400  _1....s......r$.
-0000a050: 0000 6300 0000 0000 0000 0000 0000 0000  ..c.............
-0000a060: 0000 0001 0000 0043 0000 0073 0400 0000  .......C...s....
-0000a070: 6401 5300 2902 4e61 af0e 0000 0a20 2020  d.S.).Na.....   
-0000a080: 2064 6566 2070 6c6f 745f 6b65 795f 636f   def plot_key_co
-0000a090: 6c28 6466 2c20 6b65 792c 2063 6f6c 2c20  l(df, key, col, 
-0000a0a0: 6b20 3d20 3130 293a 0a20 2020 2020 2020  k = 10):.       
-0000a0b0: 2076 6320 3d20 6466 5b6b 6579 5d2e 7661   vc = df[key].va
-0000a0c0: 6c75 655f 636f 756e 7473 2829 2e69 6c6f  lue_counts().ilo
-0000a0d0: 635b 3a6b 5d0a 2020 2020 2020 2020 2320  c[:k].        # 
-0000a0e0: 7072 696e 7428 7663 290a 2020 2020 2020  print(vc).      
-0000a0f0: 2020 6466 203d 2064 665b 6466 5b6b 6579    df = df[df[key
-0000a100: 5d2e 6973 696e 2876 632e 696e 6465 7829  ].isin(vc.index)
-0000a110: 5d2e 7265 7365 745f 696e 6465 7828 6472  ].reset_index(dr
-0000a120: 6f70 203d 2054 7275 6529 0a20 2020 2020  op = True).     
-0000a130: 2020 2070 6c74 2e66 6967 7572 6528 6669     plt.figure(fi
-0000a140: 6773 697a 6520 3d20 2832 302c 2033 2929  gsize = (20, 3))
-0000a150: 0a20 2020 2020 2020 2073 6e73 2e62 6f78  .        sns.box
-0000a160: 706c 6f74 2878 3d6b 6579 2c20 793d 636f  plot(x=key, y=co
-0000a170: 6c2c 2064 6174 6120 3d20 6466 5b5b 6b65  l, data = df[[ke
-0000a180: 792c 2063 6f6c 5d5d 290a 2020 2020 2020  y, col]]).      
-0000a190: 2020 706c 742e 6c65 6765 6e64 285b 277b    plt.legend(['{
-0000a1a0: 7d20 3d20 7b7d 272e 666f 726d 6174 2869  } = {}'.format(i
-0000a1b0: 2c20 7663 2e6c 6f63 5b69 5d29 2066 6f72  , vc.loc[i]) for
-0000a1c0: 2069 2069 6e20 7663 2e69 6e64 6578 5d29   i in vc.index])
-0000a1d0: 0a20 2020 2020 2020 2070 6c74 2e74 6974  .        plt.tit
-0000a1e0: 6c65 2827 706c 6f74 5f6b 6579 5f63 6f6c  le('plot_key_col
-0000a1f0: 2729 0a20 2020 2020 2020 2070 6c74 2e73  ').        plt.s
-0000a200: 686f 7728 293b 0a0a 2020 2020 6465 6620  how();..    def 
-0000a210: 706c 6f74 5f63 6174 5f6e 756d 2864 662c  plot_cat_num(df,
-0000a220: 206b 6579 2c20 636f 6c2c 206b 203d 2031   key, col, k = 1
-0000a230: 3029 3a0a 2020 2020 2020 2020 2320 6b65  0):.        # ke
-0000a240: 795f 636f 6c0a 2020 2020 2020 2020 706c  y_col.        pl
-0000a250: 6f74 5f6b 6579 5f63 6f6c 2864 662c 206b  ot_key_col(df, k
-0000a260: 6579 2c20 636f 6c2c 206b 203d 206b 290a  ey, col, k = k).
-0000a270: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0000a280: 2023 2076 616c 7565 5f63 6f75 6e74 730a   # value_counts.
-0000a290: 2020 2020 2020 2020 7663 203d 2064 665b          vc = df[
-0000a2a0: 6b65 795d 2e76 616c 7565 5f63 6f75 6e74  key].value_count
-0000a2b0: 7328 292e 696c 6f63 5b3a 6b5d 0a20 2020  s().iloc[:k].   
-0000a2c0: 2020 2020 2076 6320 3d20 7663 2e73 6f72       vc = vc.sor
-0000a2d0: 745f 696e 6465 7828 290a 2020 2020 2020  t_index().      
-0000a2e0: 2020 706c 742e 6669 6775 7265 2866 6967    plt.figure(fig
-0000a2f0: 7369 7a65 203d 2028 3230 2c20 3329 290a  size = (20, 3)).
-0000a300: 2020 2020 2020 2020 706c 742e 7375 6270          plt.subp
-0000a310: 6c6f 7428 312c 2033 2c20 3129 0a20 2020  lot(1, 3, 1).   
-0000a320: 2020 2020 2073 6e73 2e62 6172 706c 6f74       sns.barplot
-0000a330: 286e 702e 6172 616e 6765 286c 656e 2876  (np.arange(len(v
-0000a340: 6329 292c 2076 632e 7661 6c75 6573 293b  c)), vc.values);
-0000a350: 0a20 2020 2020 2020 2070 6c74 2e70 6c6f  .        plt.plo
-0000a360: 7428 6e70 2e61 7261 6e67 6528 6c65 6e28  t(np.arange(len(
-0000a370: 7663 2929 2c20 7663 2e76 616c 7565 732c  vc)), vc.values,
-0000a380: 2027 622d 2729 3b0a 2020 2020 2020 2020   'b-');.        
-0000a390: 706c 742e 706c 6f74 286e 702e 6172 616e  plt.plot(np.aran
-0000a3a0: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
-0000a3b0: 7661 6c75 6573 2c20 2772 2b27 293b 0a20  values, 'r+');. 
-0000a3c0: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
-0000a3d0: 7328 6e70 2e61 7261 6e67 6528 6c65 6e28  s(np.arange(len(
-0000a3e0: 7663 2929 2c20 7663 2e69 6e64 6578 290a  vc)), vc.index).
-0000a3f0: 2020 2020 2020 2020 706c 742e 7469 746c          plt.titl
-0000a400: 6528 2776 616c 7565 5f63 6f75 6e74 7327  e('value_counts'
-0000a410: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-0000a420: 2020 2023 2074 7265 6e64 0a20 2020 2020     # trend.     
-0000a430: 2020 2070 6c74 2e73 7562 706c 6f74 2831     plt.subplot(1
-0000a440: 2c20 332c 2032 290a 2020 2020 2020 2020  , 3, 2).        
-0000a450: 666f 7220 7669 2069 6e20 7663 2e69 6e64  for vi in vc.ind
-0000a460: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
-0000a470: 7820 3d20 6466 2e6c 6f63 5b64 665b 6b65  x = df.loc[df[ke
-0000a480: 795d 203d 3d20 7669 2c20 636f 6c5d 0a20  y] == vi, col]. 
-0000a490: 2020 2020 2020 2020 2020 2070 6c74 2e70             plt.p
-0000a4a0: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
-0000a4b0: 6e28 7829 292c 206e 702e 736f 7274 2878  n(x)), np.sort(x
-0000a4c0: 2929 0a20 2020 2020 2020 2070 6c74 2e6c  )).        plt.l
-0000a4d0: 6567 656e 6428 6c69 7374 2876 632e 696e  egend(list(vc.in
-0000a4e0: 6465 7829 290a 2020 2020 2020 2020 706c  dex)).        pl
-0000a4f0: 742e 7469 746c 6528 2774 7265 6e64 2729  t.title('trend')
-0000a500: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-0000a510: 2020 2020 2020 2320 6469 7374 706c 6f74        # distplot
-0000a520: 2020 2020 0a20 2020 2020 2020 2070 6c74      .        plt
-0000a530: 2e73 7562 706c 6f74 2831 2c20 332c 2033  .subplot(1, 3, 3
-0000a540: 290a 2020 2020 2020 2020 666f 7220 7669  ).        for vi
-0000a550: 2069 6e20 7663 2e69 6e64 6578 3a0a 2020   in vc.index:.  
-0000a560: 2020 2020 2020 2020 2020 7820 3d20 6466            x = df
-0000a570: 2e6c 6f63 5b64 665b 6b65 795d 203d 3d20  .loc[df[key] == 
-0000a580: 7669 2c20 636f 6c5d 0a20 2020 2020 2020  vi, col].       
-0000a590: 2020 2020 2073 6e73 2e64 6973 7470 6c6f       sns.distplo
-0000a5a0: 7428 782c 2062 696e 7320 3d20 3130 290a  t(x, bins = 10).
-0000a5b0: 2020 2020 2020 2020 706c 742e 6c65 6765          plt.lege
-0000a5c0: 6e64 286c 6973 7428 7663 2e69 6e64 6578  nd(list(vc.index
-0000a5d0: 2929 0a20 2020 2020 2020 2070 6c74 2e74  )).        plt.t
-0000a5e0: 6974 6c65 2827 6469 7374 706c 6f74 2729  itle('distplot')
-0000a5f0: 0a20 2020 2020 2020 2070 6c74 2e78 6c61  .        plt.xla
-0000a600: 6265 6c28 2727 290a 2020 2020 2020 2020  bel('').        
-0000a610: 706c 742e 7368 6f77 2829 0a20 2020 2020  plt.show().     
-0000a620: 2020 200a 2020 2020 2020 2020 0a20 2020     .        .   
-0000a630: 2064 6566 2070 6c6f 745f 6361 745f 6361   def plot_cat_ca
-0000a640: 7428 6466 2c20 6b65 792c 2063 6f6c 2c20  t(df, key, col, 
-0000a650: 6b31 203d 2031 302c 206b 3220 3d20 3130  k1 = 10, k2 = 10
-0000a660: 3029 3a0a 2020 2020 2020 2020 706c 742e  0):.        plt.
-0000a670: 6669 6775 7265 2866 6967 7369 7a65 3d28  figure(figsize=(
-0000a680: 3230 2c20 3329 290a 2020 2020 2020 2020  20, 3)).        
-0000a690: 785f 6c69 7374 203d 205b 5d0a 2020 2020  x_list = [].    
-0000a6a0: 2020 2020 666f 7220 7669 2069 6e20 6c69      for vi in li
-0000a6b0: 7374 2864 665b 6b65 795d 2e76 616c 7565  st(df[key].value
-0000a6c0: 5f63 6f75 6e74 7328 292e 696e 6465 7829  _counts().index)
-0000a6d0: 5b3a 6b31 5d3a 0a20 2020 2020 2020 2020  [:k1]:.         
-0000a6e0: 2020 2078 203d 2064 662e 6c6f 635b 6466     x = df.loc[df
-0000a6f0: 5b6b 6579 5d20 3d3d 2076 692c 2063 6f6c  [key] == vi, col
-0000a700: 5d0a 2020 2020 2020 2020 2020 2020 7663  ].            vc
-0000a710: 203d 2078 2e76 616c 7565 5f63 6f75 6e74   = x.value_count
-0000a720: 7328 292e 696c 6f63 5b3a 6b5d 0a20 2020  s().iloc[:k].   
-0000a730: 2020 2020 2020 2020 2023 203d 3d3d 3d3d           # =====
-0000a740: 3d3d 3d3d 3d20 7661 6c75 655f 636f 756e  ===== value_coun
-0000a750: 7473 203d 3d3d 3d3d 3d3d 3d3d 3d0a 2020  ts ==========.  
-0000a760: 2020 2020 2020 2020 2020 706c 742e 7375            plt.su
-0000a770: 6270 6c6f 7428 312c 2033 2c20 3129 0a20  bplot(1, 3, 1). 
-0000a780: 2020 2020 2020 2020 2020 2076 6320 3d20             vc = 
-0000a790: 7663 2e73 6f72 745f 696e 6465 7828 290a  vc.sort_index().
-0000a7a0: 2020 2020 2020 2020 2020 2020 2320 736e              # sn
-0000a7b0: 732e 6261 7270 6c6f 7428 6e70 2e61 7261  s.barplot(np.ara
-0000a7c0: 6e67 6528 6c65 6e28 7663 2929 2c20 7663  nge(len(vc)), vc
-0000a7d0: 2e76 616c 7565 7329 3b0a 2020 2020 2020  .values);.      
-0000a7e0: 2020 2020 2020 706c 742e 706c 6f74 286e        plt.plot(n
-0000a7f0: 702e 6172 616e 6765 286c 656e 2876 6329  p.arange(len(vc)
-0000a800: 292c 2076 632e 7661 6c75 6573 2c20 272d  ), vc.values, '-
-0000a810: 2729 3b0a 2020 2020 2020 2020 2020 2020  ');.            
-0000a820: 706c 742e 706c 6f74 286e 702e 6172 616e  plt.plot(np.aran
-0000a830: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
-0000a840: 7661 6c75 6573 2c20 272b 2729 3b0a 2020  values, '+');.  
-0000a850: 2020 2020 2020 2020 2020 706c 742e 7874            plt.xt
-0000a860: 6963 6b73 286e 702e 6172 616e 6765 286c  icks(np.arange(l
-0000a870: 656e 2876 6329 292c 2076 632e 696e 6465  en(vc)), vc.inde
-0000a880: 7829 0a20 2020 2020 2020 2020 2020 2070  x).            p
-0000a890: 6c74 2e74 6974 6c65 2827 736f 7274 2062  lt.title('sort b
-0000a8a0: 7920 696e 6465 7827 290a 0a20 2020 2020  y index')..     
-0000a8b0: 2020 2020 2020 2070 6c74 2e73 7562 706c         plt.subpl
-0000a8c0: 6f74 2831 2c20 332c 2032 290a 2020 2020  ot(1, 3, 2).    
-0000a8d0: 2020 2020 2020 2020 7663 203d 2076 632e          vc = vc.
-0000a8e0: 736f 7274 5f76 616c 7565 7328 6173 6365  sort_values(asce
-0000a8f0: 6e64 696e 6720 3d20 4661 6c73 6529 0a20  nding = False). 
-0000a900: 2020 2020 2020 2020 2020 2023 2073 6e73             # sns
-0000a910: 2e62 6172 706c 6f74 286e 702e 6172 616e  .barplot(np.aran
-0000a920: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
-0000a930: 7661 6c75 6573 293b 0a20 2020 2020 2020  values);.       
-0000a940: 2020 2020 2070 6c74 2e70 6c6f 7428 6e70       plt.plot(np
-0000a950: 2e61 7261 6e67 6528 6c65 6e28 7663 2929  .arange(len(vc))
-0000a960: 2c20 7663 2e76 616c 7565 732c 2027 2d27  , vc.values, '-'
-0000a970: 293b 0a20 2020 2020 2020 2020 2020 2070  );.            p
-0000a980: 6c74 2e70 6c6f 7428 6e70 2e61 7261 6e67  lt.plot(np.arang
-0000a990: 6528 6c65 6e28 7663 2929 2c20 7663 2e76  e(len(vc)), vc.v
-0000a9a0: 616c 7565 732c 2027 2b27 293b 0a20 2020  alues, '+');.   
-0000a9b0: 2020 2020 2020 2020 2070 6c74 2e78 7469           plt.xti
-0000a9c0: 636b 7328 6e70 2e61 7261 6e67 6528 6c65  cks(np.arange(le
-0000a9d0: 6e28 7663 2929 2c20 7663 2e69 6e64 6578  n(vc)), vc.index
-0000a9e0: 290a 2020 2020 2020 2020 2020 2020 706c  ).            pl
-0000a9f0: 742e 7469 746c 6528 2773 6f72 7420 6279  t.title('sort by
-0000aa00: 2076 616c 7565 7327 290a 0a20 2020 2020   values')..     
-0000aa10: 2020 2020 2020 2023 203d 3d3d 3d3d 3d3d         # =======
-0000aa20: 3d3d 3d20 6375 6d73 756d 203d 3d3d 3d3d  === cumsum =====
-0000aa30: 3d3d 3d3d 3d0a 2020 2020 2020 2020 2020  =====.          
-0000aa40: 2020 706c 742e 7375 6270 6c6f 7428 312c    plt.subplot(1,
-0000aa50: 2033 2c20 3329 0a20 2020 2020 2020 2020   3, 3).         
-0000aa60: 2020 2076 6320 3d20 782e 7661 6c75 655f     vc = x.value_
-0000aa70: 636f 756e 7473 2829 0a20 2020 2020 2020  counts().       
-0000aa80: 2020 2020 2076 635f 6375 6d73 756d 203d       vc_cumsum =
-0000aa90: 2076 632e 6375 6d73 756d 2829 2e72 6573   vc.cumsum().res
-0000aaa0: 6574 5f69 6e64 6578 2864 726f 7020 3d20  et_index(drop = 
-0000aab0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-0000aac0: 2020 7663 5f63 756d 7375 6d20 2f3d 2076    vc_cumsum /= v
-0000aad0: 635f 6375 6d73 756d 2e6d 6178 2829 0a20  c_cumsum.max(). 
-0000aae0: 2020 2020 2020 2020 2020 2070 6c74 2e70             plt.p
-0000aaf0: 6c6f 7428 7663 5f63 756d 7375 6d2c 2027  lot(vc_cumsum, '
-0000ab00: 2d27 290a 2020 2020 2020 2020 2020 2020  -').            
-0000ab10: 706c 742e 706c 6f74 2876 635f 6375 6d73  plt.plot(vc_cums
-0000ab20: 756d 2c20 272b 2729 0a20 2020 2020 2020  um, '+').       
-0000ab30: 2020 2020 2078 795f 3039 203d 2076 635f       xy_09 = vc_
-0000ab40: 6375 6d73 756d 5b76 635f 6375 6d73 756d  cumsum[vc_cumsum
-0000ab50: 203e 3d20 302e 395d 5b3a 315d 0a20 2020   >= 0.9][:1].   
-0000ab60: 2020 2020 2020 2020 2078 5f30 392c 2079           x_09, y
-0000ab70: 5f30 3920 3d20 7879 5f30 392e 696e 6465  _09 = xy_09.inde
-0000ab80: 782e 7661 6c75 6573 5b30 5d2c 2078 795f  x.values[0], xy_
-0000ab90: 3039 2e76 616c 7565 735b 305d 0a20 2020  09.values[0].   
-0000aba0: 2020 2020 2020 2020 2023 2070 6c74 2e61           # plt.a
-0000abb0: 7868 6c69 6e65 2879 5f30 392c 2063 6f6c  xhline(y_09, col
-0000abc0: 6f72 203d 2027 7227 290a 2020 2020 2020  or = 'r').      
-0000abd0: 2020 2020 2020 706c 742e 6178 766c 696e        plt.axvlin
-0000abe0: 6528 785f 3039 2c20 636f 6c6f 7220 3d20  e(x_09, color = 
-0000abf0: 2772 2729 0a20 2020 2020 2020 2020 2020  'r').           
-0000ac00: 2078 5f6c 6973 742e 6170 7065 6e64 2878   x_list.append(x
-0000ac10: 5f30 3920 2f20 6c65 6e28 7663 5f63 756d  _09 / len(vc_cum
-0000ac20: 7375 6d29 290a 2020 2020 2020 2020 706c  sum)).        pl
-0000ac30: 742e 7469 746c 6528 2778 203d 207b 7d27  t.title('x = {}'
-0000ac40: 2e66 6f72 6d61 7428 5b27 7b3a 2e30 667d  .format(['{:.0f}
-0000ac50: 272e 666f 726d 6174 2869 2920 666f 7220  '.format(i) for 
-0000ac60: 6920 696e 2078 5f6c 6973 745d 2929 0a20  i in x_list])). 
-0000ac70: 2020 2020 2020 2070 7269 6e74 2829 0a20         print(). 
-0000ac80: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
-0000ac90: 2920 2020 200a 2020 2020 2020 2020 0a20  )    .        . 
-0000aca0: 2020 2064 6566 2070 6c6f 745f 7061 6972     def plot_pair
-0000acb0: 2864 662c 2063 6f6c 735f 7365 6c2c 206b  (df, cols_sel, k
-0000acc0: 203d 2031 302c 2063 6f6c 5f6c 6162 656c   = 10, col_label
-0000acd0: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
-0000ace0: 2020 636f 6c73 5f73 656c 203d 2063 6f6c    cols_sel = col
-0000acf0: 735f 7365 6c5b 3a6b 5d0a 2020 2020 2020  s_sel[:k].      
-0000ad00: 2020 636f 6c73 5f73 656c 202b 3d20 5b63    cols_sel += [c
-0000ad10: 6f6c 5f6c 6162 656c 5d20 6966 2063 6f6c  ol_label] if col
-0000ad20: 5f6c 6162 656c 2069 7320 6e6f 7420 4e6f  _label is not No
-0000ad30: 6e65 2065 6c73 6520 5b5d 0a20 2020 2020  ne else [].     
-0000ad40: 2020 2069 6620 636f 6c5f 6c61 6265 6c20     if col_label 
-0000ad50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000ad60: 2020 2020 2073 6e73 2e70 6169 7270 6c6f       sns.pairplo
-0000ad70: 7428 6466 5b63 6f6c 735f 7365 6c5d 2c20  t(df[cols_sel], 
-0000ad80: 6875 6520 3d20 636f 6c5f 6c61 6265 6c2c  hue = col_label,
-0000ad90: 2073 697a 653d 322c 206b 696e 643d 2773   size=2, kind='s
-0000ada0: 6361 7474 6572 272c 6469 6167 5f6b 696e  catter',diag_kin
-0000adb0: 643d 2268 6973 7422 290a 2020 2020 2020  d="hist").      
-0000adc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000add0: 2020 2020 736e 732e 7061 6972 706c 6f74      sns.pairplot
-0000ade0: 2864 665b 636f 6c73 5f73 656c 5d2c 2068  (df[cols_sel], h
-0000adf0: 7565 203d 2063 6f6c 5f6c 6162 656c 2c20  ue = col_label, 
-0000ae00: 7369 7a65 3d32 2c20 6b69 6e64 3d27 7363  size=2, kind='sc
-0000ae10: 6174 7465 7227 2c64 6961 675f 6b69 6e64  atter',diag_kind
-0000ae20: 3d22 6869 7374 2229 0a20 2020 2020 2020  ="hist").       
-0000ae30: 2070 6c74 2e73 686f 7728 293b 0a20 2020   plt.show();.   
-0000ae40: 2070 6c6f 745f 6b65 795f 636f 6c28 7472   plot_key_col(tr
-0000ae50: 6169 6e2c 2027 6c61 6265 6c27 2c20 2763  ain, 'label', 'c
-0000ae60: 5f30 272c 206b 203d 2031 3029 0a20 2020  _0', k = 10).   
-0000ae70: 2070 6c6f 745f 6361 745f 6e75 6d28 7472   plot_cat_num(tr
-0000ae80: 6169 6e2c 2027 6c61 6265 6c27 2c20 2763  ain, 'label', 'c
-0000ae90: 5f30 272c 206b 203d 2031 3029 0a20 2020  _0', k = 10).   
-0000aea0: 2070 6c6f 745f 6361 745f 6361 7428 7472   plot_cat_cat(tr
-0000aeb0: 6169 6e2c 2027 6c61 6265 6c27 2c20 2763  ain, 'label', 'c
-0000aec0: 5f30 272c 206b 3120 3d20 3130 2c20 6b32  _0', k1 = 10, k2
-0000aed0: 203d 2031 3030 290a 2020 2020 706c 6f74   = 100).    plot
-0000aee0: 5f70 6169 7228 7472 6169 6e2c 2063 6f6c  _pair(train, col
-0000aef0: 735f 6361 745b 3a35 5d20 2b20 636f 6c73  s_cat[:5] + cols
-0000af00: 5f6e 756d 5b3a 355d 2c20 6b20 3d20 3130  _num[:5], k = 10
-0000af10: 2c20 636f 6c5f 6c61 6265 6c20 3d20 276c  , col_label = 'l
-0000af20: 6162 656c 2729 0a20 2020 2072 0100 0000  abel').    r....
-0000af30: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-0000af40: 0200 0000 da0b 706c 6f74 5f63 6f6c 735f  ......plot_cols_
-0000af50: 3256 0400 0073 0200 0000 0001 7225 0000  2V...s......r%..
-0000af60: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
-0000af70: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
-0000af80: 0153 0029 024e 61f0 0100 000a 2020 2020  .S.).Na.....    
-0000af90: 6465 6620 706c 6f74 5f64 665f 696d 7028  def plot_df_imp(
-0000afa0: 6466 5f69 6d70 2c20 636f 6c20 3d20 2763  df_imp, col = 'c
-0000afb0: 6f6c 272c 2069 6d70 203d 2027 696d 7027  ol', imp = 'imp'
-0000afc0: 2c20 6b20 3d20 3230 293a 0a20 2020 2020  , k = 20):.     
-0000afd0: 2020 2069 6d70 6f72 7420 6d61 7470 6c6f     import matplo
-0000afe0: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
-0000aff0: 6c74 0a20 2020 2020 2020 2069 6d70 6f72  lt.        impor
-0000b000: 7420 7365 6162 6f72 6e20 6173 2073 6e73  t seaborn as sns
-0000b010: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
-0000b020: 7572 6528 6669 6773 697a 653d 2832 302c  ure(figsize=(20,
-0000b030: 206d 6178 2831 302c 206b 202f 2f20 3229   max(10, k // 2)
-0000b040: 2929 0a20 2020 2020 2020 2064 665f 696d  )).        df_im
-0000b050: 705f 736f 7274 203d 2064 665f 696d 702e  p_sort = df_imp.
-0000b060: 736f 7274 5f76 616c 7565 7328 6279 203d  sort_values(by =
-0000b070: 2069 6d70 2c20 6173 6365 6e64 696e 6720   imp, ascending 
-0000b080: 3d20 4661 6c73 6529 2e72 6573 6574 5f69  = False).reset_i
-0000b090: 6e64 6578 2864 726f 7020 3d20 5472 7565  ndex(drop = True
-0000b0a0: 290a 2020 2020 2020 2020 736e 732e 6261  ).        sns.ba
-0000b0b0: 7270 6c6f 7428 783d 696d 702c 2079 3d63  rplot(x=imp, y=c
-0000b0c0: 6f6c 2c20 6461 7461 3d64 665f 696d 705f  ol, data=df_imp_
-0000b0d0: 736f 7274 5b3a 6b5d 290a 2020 2020 2020  sort[:k]).      
-0000b0e0: 2020 706c 742e 7469 746c 6528 2764 665f    plt.title('df_
-0000b0f0: 696d 7027 2c20 666f 6e74 7369 7a65 203d  imp', fontsize =
-0000b100: 2032 3529 0a20 2020 2020 2020 2070 6c74   25).        plt
-0000b110: 2e74 6967 6874 5f6c 6179 6f75 7428 290a  .tight_layout().
-0000b120: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
-0000b130: 6b73 2866 6f6e 7473 697a 6520 3d20 3235  ks(fontsize = 25
-0000b140: 290a 2020 2020 2020 2020 706c 742e 7974  ).        plt.yt
-0000b150: 6963 6b73 2866 6f6e 7473 697a 6520 3d20  icks(fontsize = 
-0000b160: 3235 290a 2020 2020 2020 2020 706c 742e  25).        plt.
-0000b170: 7368 6f77 2829 0a20 2020 2072 0100 0000  show().    r....
-0000b180: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
-0000b190: 0200 0000 da0b 706c 6f74 5f64 665f 696d  ......plot_df_im
-0000b1a0: 70b9 0400 0073 0200 0000 0001 7226 0000  p....s......r&..
-0000b1b0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
-0000b1c0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
-0000b1d0: 0153 0029 024e 618f 0200 000a 2020 2020  .S.).Na.....    
-0000b1e0: 696d 706f 7274 2070 6c6f 746c 792e 6772  import plotly.gr
-0000b1f0: 6170 685f 6f62 6a65 6374 7320 6173 2067  aph_objects as g
-0000b200: 6f0a 2020 2020 6672 6f6d 2070 6c6f 746c  o.    from plotl
-0000b210: 792e 6f66 666c 696e 6520 696d 706f 7274  y.offline import
-0000b220: 2069 706c 6f74 0a20 2020 2064 6566 2070   iplot.    def p
-0000b230: 6c6f 745f 6375 6d73 756d 2864 665f 6963  lot_cumsum(df_ic
-0000b240: 5f6c 6973 742c 206d 6f64 656c 5f6c 6973  _list, model_lis
-0000b250: 742c 2063 6f6c 5f64 6174 652c 2063 6f6c  t, col_date, col
-0000b260: 203d 2027 6963 2729 3a0a 2020 2020 2020   = 'ic'):.      
-0000b270: 2020 6669 675f 6c69 7374 203d 205b 5d0a    fig_list = [].
-0000b280: 2020 2020 2020 2020 666f 7220 6466 5f69          for df_i
-0000b290: 632c 206e 616d 6520 696e 207a 6970 2864  c, name in zip(d
-0000b2a0: 665f 6963 5f6c 6973 742c 206d 6f64 656c  f_ic_list, model
-0000b2b0: 5f6c 6973 7429 3a0a 2020 2020 2020 2020  _list):.        
-0000b2c0: 2020 2020 6669 6720 3d20 676f 2e53 6361      fig = go.Sca
-0000b2d0: 7474 6572 2878 203d 2064 665f 6963 5b63  tter(x = df_ic[c
-0000b2e0: 6f6c 5f64 6174 655d 2e61 7374 7970 6528  ol_date].astype(
-0000b2f0: 7374 7229 2c20 0a20 2020 2020 2020 2020  str), .         
-0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b310: 2020 2079 203d 2064 665f 6963 5b63 6f6c     y = df_ic[col
-0000b320: 5d2e 6375 6d73 756d 2829 202f 206c 656e  ].cumsum() / len
-0000b330: 2864 665f 6963 292c 0a20 2020 2020 2020  (df_ic),.       
-0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b350: 2020 2020 206d 6f64 6520 3d20 276c 696e       mode = 'lin
-0000b360: 6573 272c 0a20 2020 2020 2020 2020 2020  es',.           
-0000b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b380: 206e 616d 6520 3d20 6e61 6d65 290a 2020   name = name).  
-0000b390: 2020 2020 2020 2020 2020 6669 675f 6c69            fig_li
-0000b3a0: 7374 2e61 7070 656e 6428 6669 6729 0a20  st.append(fig). 
-0000b3b0: 2020 2020 2020 206c 6179 6f75 7420 3d20         layout = 
-0000b3c0: 6469 6374 2874 6974 6c65 203d 2063 6f6c  dict(title = col
-0000b3d0: 2c20 7961 7869 7320 3d20 6469 6374 2874  , yaxis = dict(t
-0000b3e0: 6963 6b30 203d 2030 2c20 6474 6963 6b3d  ick0 = 0, dtick=
-0000b3f0: 302e 3031 2929 0a20 2020 2020 2020 2069  0.01)).        i
-0000b400: 706c 6f74 2864 6963 7428 6461 7461 203d  plot(dict(data =
-0000b410: 2066 6967 5f6c 6973 742c 206c 6179 6f75   fig_list, layou
-0000b420: 7420 3d20 6c61 796f 7574 2929 0a20 2020  t = layout)).   
-0000b430: 2020 706c 6f74 5f63 756d 7375 6d28 5b64    plot_cumsum([d
-0000b440: 665f 6963 5d2c 205b 276c 6762 275d 2c20  f_ic], ['lgb'], 
-0000b450: 636f 6c5f 6461 7465 2c20 636f 6c20 3d20  col_date, col = 
-0000b460: 2769 6327 290a 2020 2020 7201 0000 0072  'ic').    r....r
-0000b470: 0100 0000 7201 0000 0072 0100 0000 7202  ....r....r....r.
-0000b480: 0000 00da 0b70 6c6f 745f 6375 6d73 756d  .....plot_cumsum
-0000b490: c804 0000 7302 0000 0000 0172 2700 0000  ....s......r'...
-0000b4a0: 4e29 2572 0300 0000 7204 0000 0072 0500  N)%r....r....r..
-0000b4b0: 0000 7206 0000 0072 0700 0000 7208 0000  ..r....r....r...
-0000b4c0: 0072 0900 0000 720a 0000 0072 0b00 0000  .r....r....r....
-0000b4d0: 720c 0000 0072 0d00 0000 720e 0000 0072  r....r....r....r
-0000b4e0: 0f00 0000 7210 0000 0072 1100 0000 7212  ....r....r....r.
-0000b4f0: 0000 0072 1300 0000 7214 0000 0072 1500  ...r....r....r..
-0000b500: 0000 7216 0000 0072 1700 0000 7218 0000  ..r....r....r...
-0000b510: 0072 1900 0000 721a 0000 0072 1b00 0000  .r....r....r....
-0000b520: 721c 0000 0072 1d00 0000 721e 0000 0072  r....r....r....r
-0000b530: 1f00 0000 7220 0000 0072 2100 0000 7222  ....r ...r!...r"
-0000b540: 0000 0072 2300 0000 7224 0000 0072 2500  ...r#...r$...r%.
-0000b550: 0000 7226 0000 0072 2700 0000 7201 0000  ..r&...r'...r...
-0000b560: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
-0000b570: da08 3c6d 6f64 756c 653e 0300 0000 7348  ..<module>....sH
-0000b580: 0000 0008 3908 0508 1508 1308 0708 0508  ....9...........
-0000b590: 1808 1c08 1c08 3f08 4408 2108 2208 1a08  ......?.D.!."...
-0000b5a0: 1908 7c08 0608 1208 1408 0708 0808 0608  ..|.............
-0000b5b0: 0c08 0808 4108 3008 1508 1e08 3108 3108  ....A.0.....1.1.
-0000b5c0: 1808 2608 3308 5008 6308 0f              ..&.3.P.c..
+00002150: 2d2d 2d2d 2d2d 2d2d 2d2d 2027 290a 2020  ---------- ').  
+00002160: 2020 6964 785f 7472 6169 6e20 3d20 727a    idx_train = rz
+00002170: 2e75 7469 6c2e 6e70 792e 6d61 736b 5f32  .util.npy.mask_2
+00002180: 5f69 6478 286d 6173 6b29 5b74 7261 696e  _idx(mask)[train
+00002190: 5f70 3170 325b 305d 3a20 7472 6169 6e5f  _p1p2[0]: train_
+000021a0: 7031 7032 5b31 5d5d 5b6d 6173 6b5f 7472  p1p2[1]][mask_tr
+000021b0: 6169 6e20 3d3d 2031 5d0a 2020 2020 585f  ain == 1].    X_
+000021c0: 7472 6169 6e20 3d20 727a 2e75 7469 6c2e  train = rz.util.
+000021d0: 6e70 792e 6c6f 6164 5f6e 7079 5f69 6478  npy.load_npy_idx
+000021e0: 2870 6174 685f 6461 7461 2c20 6964 785f  (path_data, idx_
+000021f0: 7472 6169 6e2e 7261 7665 6c28 292c 2063  train.ravel(), c
+00002200: 6f6c 7320 3d20 4e6f 6e65 2c20 7665 7262  ols = None, verb
+00002210: 6f73 6520 3d20 5472 7565 290a 2020 2020  ose = True).    
+00002220: 795f 7472 6169 6e20 3d20 727a 2e75 7469  y_train = rz.uti
+00002230: 6c2e 6e70 792e 6c6f 6164 5f6e 7079 5f69  l.npy.load_npy_i
+00002240: 6478 2870 6174 685f 6461 7461 2c20 6964  dx(path_data, id
+00002250: 785f 7472 6169 6e2e 7261 7665 6c28 292c  x_train.ravel(),
+00002260: 2063 6f6c 7320 3d20 5b79 5f69 6478 5d2c   cols = [y_idx],
+00002270: 2076 6572 626f 7365 203d 2046 616c 7365   verbose = False
+00002280: 290a 2020 2020 6964 785f 7465 7374 203d  ).    idx_test =
+00002290: 2072 7a2e 7574 696c 2e6e 7079 2e6d 6173   rz.util.npy.mas
+000022a0: 6b5f 325f 6964 7828 6d61 736b 295b 7465  k_2_idx(mask)[te
+000022b0: 7374 5f70 3170 325b 305d 3a20 7465 7374  st_p1p2[0]: test
+000022c0: 5f70 3170 325b 315d 5d5b 6d61 736b 5f74  _p1p2[1]][mask_t
+000022d0: 6573 7420 3d3d 2031 5d0a 2020 2020 585f  est == 1].    X_
+000022e0: 7465 7374 203d 2072 7a2e 7574 696c 2e6e  test = rz.util.n
+000022f0: 7079 2e6c 6f61 645f 6e70 795f 6964 7828  py.load_npy_idx(
+00002300: 7061 7468 5f64 6174 612c 2069 6478 5f74  path_data, idx_t
+00002310: 6573 742e 7261 7665 6c28 292c 2063 6f6c  est.ravel(), col
+00002320: 7320 3d20 4e6f 6e65 2c20 7665 7262 6f73  s = None, verbos
+00002330: 6520 3d20 4661 6c73 6529 0a20 2020 2079  e = False).    y
+00002340: 5f74 6573 7420 3d20 727a 2e75 7469 6c2e  _test = rz.util.
+00002350: 6e70 792e 6c6f 6164 5f6e 7079 5f69 6478  npy.load_npy_idx
+00002360: 2870 6174 685f 6461 7461 2c20 6964 785f  (path_data, idx_
+00002370: 7465 7374 2e72 6176 656c 2829 2c20 636f  test.ravel(), co
+00002380: 6c73 203d 205b 795f 6964 785d 2c20 7665  ls = [y_idx], ve
+00002390: 7262 6f73 6520 3d20 4661 6c73 6529 0a20  rbose = False). 
+000023a0: 2020 2070 7269 6e74 2866 275b 2b5d 2058     print(f'[+] X
+000023b0: 5f74 7261 696e 203d 207b 585f 7472 6169  _train = {X_trai
+000023c0: 6e2e 7368 6170 657d 2c20 6d65 6d20 3d20  n.shape}, mem = 
+000023d0: 7b6e 702e 7072 6f64 2858 5f74 7261 696e  {np.prod(X_train
+000023e0: 2e73 6861 7065 2920 2a20 343a 2c2e 3066  .shape) * 4:,.0f
+000023f0: 7d27 290a 2020 2020 7072 696e 7428 6627  }').    print(f'
+00002400: 5b2b 5d20 585f 7465 7374 2020 3d20 7b58  [+] X_test  = {X
+00002410: 5f74 6573 742e 7368 6170 657d 2c20 6d65  _test.shape}, me
+00002420: 6d20 3d20 7b6e 702e 7072 6f64 2858 5f74  m = {np.prod(X_t
+00002430: 6573 742e 7368 6170 6529 202a 2034 3a2c  est.shape) * 4:,
+00002440: 2e30 667d 2729 0a20 2020 2072 7a2e 6765  .0f}').    rz.ge
+00002450: 745f 6d65 6d5f 6375 7228 292c 2072 7a2e  t_mem_cur(), rz.
+00002460: 6765 745f 6d65 6d5f 6d61 7828 293b 0a20  get_mem_max();. 
+00002470: 2020 2072 0100 0000 7201 0000 0072 0100     r....r....r..
+00002480: 0000 7201 0000 0072 0200 0000 da09 7265  ..r....r......re
+00002490: 6164 5f64 6174 61c5 0000 0073 0200 0000  ad_data....s....
+000024a0: 0001 720c 0000 0063 0000 0000 0000 0000  ..r....c........
+000024b0: 0000 0000 0000 0000 0100 0000 4300 0000  ............C...
+000024c0: 7304 0000 0064 0153 0029 024e 6174 0b00  s....d.S.).Nat..
+000024d0: 000a 2020 2020 636c 6173 7320 4261 7365  ..    class Base
+000024e0: 4461 7461 2829 3a0a 2020 2020 2020 2020  Data():.        
+000024f0: 6465 6620 6765 745f 6466 2873 656c 662c  def get_df(self,
+00002500: 2070 6174 685f 696e 7075 742c 2064 6174   path_input, dat
+00002510: 655f 6265 6769 6e2c 2064 6174 655f 656e  e_begin, date_en
+00002520: 642c 206e 5f6a 6f62 7329 3a0a 2020 2020  d, n_jobs):.    
+00002530: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00002540: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00002550: 7228 2779 6f75 206e 6565 6420 746f 2069  r('you need to i
+00002560: 6d70 6c65 6d65 6e74 2067 6574 5f64 6628  mplement get_df(
+00002570: 2927 290a 0a20 2020 2020 2020 2064 6566  )')..        def
+00002580: 206c 6f61 6428 7365 6c66 2c20 6e5f 6a6f   load(self, n_jo
+00002590: 6273 203d 2034 2c20 2a2a 6b77 6172 6773  bs = 4, **kwargs
+000025a0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+000025b0: 2069 6e70 7574 0a20 2020 2020 2020 2020   input.         
+000025c0: 2020 2070 6174 685f 696e 7075 7420 3d20     path_input = 
+000025d0: 6b77 6172 6773 5b27 7061 7468 5f69 6e70  kwargs['path_inp
+000025e0: 7574 275d 0a20 2020 2020 2020 2020 2020  ut'].           
+000025f0: 2064 6174 655f 6469 6374 203d 206b 7761   date_dict = kwa
+00002600: 7267 735b 2764 6174 655f 6469 6374 275d  rgs['date_dict']
+00002610: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00002620: 735f 6469 6374 203d 206b 7761 7267 735b  s_dict = kwargs[
+00002630: 2763 6f6c 735f 6469 6374 275d 0a20 2020  'cols_dict'].   
+00002640: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00002650: 2020 2020 2020 636f 6c5f 6964 203d 2063        col_id = c
+00002660: 6f6c 735f 6469 6374 5b27 636f 6c5f 6964  ols_dict['col_id
+00002670: 275d 0a20 2020 2020 2020 2020 2020 2063  '].            c
+00002680: 6f6c 5f6c 6162 656c 203d 2063 6f6c 735f  ol_label = cols_
+00002690: 6469 6374 5b27 636f 6c5f 6c61 6265 6c27  dict['col_label'
+000026a0: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
+000026b0: 6c73 5f74 6964 203d 2063 6f6c 735f 6469  ls_tid = cols_di
+000026c0: 6374 5b27 636f 6c73 5f74 6964 275d 0a20  ct['cols_tid']. 
+000026d0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000026e0: 6e28 636f 6c73 5f74 6964 2920 3d3d 2031  n(cols_tid) == 1
+000026f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002700: 2020 636f 6c5f 7469 6420 3d20 636f 6c73    col_tid = cols
+00002710: 5f74 6964 5b30 5d0a 2020 2020 2020 2020  _tid[0].        
+00002720: 2020 2020 656c 7365 3a20 2020 0a20 2020      else:   .   
+00002730: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00002740: 5f74 6964 203d 2066 2278 287b 272c 2027  _tid = f"x({', '
+00002750: 2e6a 6f69 6e28 636f 6c73 5f74 6964 297d  .join(cols_tid)}
+00002760: 2922 0a0a 2020 2020 2020 2020 2020 2020  )"..            
+00002770: 2320 646d 0a20 2020 2020 2020 2020 2020  # dm.           
+00002780: 2064 6620 3d20 7365 6c66 2e67 6574 5f64   df = self.get_d
+00002790: 6628 7061 7468 5f69 6e70 7574 2c20 2a64  f(path_input, *d
+000027a0: 6174 655f 6469 6374 5b27 616c 6c27 5d2c  ate_dict['all'],
+000027b0: 206e 5f6a 6f62 7329 0a20 2020 2020 2020   n_jobs).       
+000027c0: 2020 2020 2064 6d20 3d20 4461 7461 4d61       dm = DataMa
+000027d0: 7374 6572 2864 662c 2076 6572 626f 7365  ster(df, verbose
+000027e0: 203d 2046 616c 7365 2c20 6b65 6570 5f73   = False, keep_s
+000027f0: 7061 6365 203d 2054 7275 6529 0a20 2020  pace = True).   
+00002800: 2020 2020 2020 2020 2064 6d2e 736f 7274           dm.sort
+00002810: 5f76 616c 7565 7328 636f 6c73 5f74 6964  _values(cols_tid
+00002820: 202b 205b 636f 6c5f 6964 5d29 0a20 2020   + [col_id]).   
+00002830: 2020 2020 2020 2020 2064 6d2e 6665 5f67           dm.fe_g
+00002840: 6f28 5b63 6f6c 5f74 6964 5d2c 2076 6572  o([col_tid], ver
+00002850: 626f 7365 203d 2046 616c 7365 290a 2020  bose = False).  
+00002860: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00002870: 2020 2020 2020 2023 206c 6162 656c 0a20         # label. 
+00002880: 2020 2020 2020 2020 2020 206e 616d 655f             name_
+00002890: 6c69 7374 203d 205b 0a20 2020 2020 2020  list = [.       
+000028a0: 2020 2020 2020 2020 2066 2776 7761 7020           f'vwap 
+000028b0: 3d20 6469 7628 616d 6f75 6e74 2c20 766f  = div(amount, vo
+000028c0: 6c29 272c 0a20 2020 2020 2020 2020 2020  l)',.           
+000028d0: 2020 2020 2066 2770 7265 5f76 7761 7020       f'pre_vwap 
+000028e0: 3d20 726f 6c6c 2873 6869 6674 2c20 7b63  = roll(shift, {c
+000028f0: 6f6c 5f69 647d 2c20 7677 6170 2c20 7b63  ol_id}, vwap, {c
+00002900: 6f6c 5f74 6964 7d2c 2031 2927 2c0a 2020  ol_tid}, 1)',.  
+00002910: 2020 2020 2020 2020 2020 2020 2020 6627                f'
+00002920: 7677 6170 5f72 6574 203d 2072 6574 2870  vwap_ret = ret(p
+00002930: 7265 5f76 7761 702c 2076 7761 7029 272c  re_vwap, vwap)',
+00002940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002950: 2066 277b 636f 6c5f 6c61 6265 6c7d 203d   f'{col_label} =
+00002960: 2072 6f6c 6c28 7368 6966 742c 207b 636f   roll(shift, {co
+00002970: 6c5f 6964 7d2c 2076 7761 705f 7265 742c  l_id}, vwap_ret,
+00002980: 207b 636f 6c5f 7469 647d 2c20 2d31 2927   {col_tid}, -1)'
+00002990: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000029a0: 2020 2320 276c 6162 656c 5f72 6177 203d    # 'label_raw =
+000029b0: 206f 286c 6162 656c 2927 2c0a 2020 2020   o(label)',.    
+000029c0: 2020 2020 2020 2020 2020 2020 6627 7b63              f'{c
+000029d0: 6f6c 5f6c 6162 656c 7d20 3d20 6167 6728  ol_label} = agg(
+000029e0: 7a73 636f 7265 2c20 7b63 6f6c 5f74 6964  zscore, {col_tid
+000029f0: 7d2c 207b 636f 6c5f 6c61 6265 6c7d 2927  }, {col_label})'
+00002a00: 2023 206d 6173 6b0a 2020 2020 2020 2020   # mask.        
+00002a10: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00002a20: 2020 646d 2e66 655f 676f 286e 616d 655f    dm.fe_go(name_
+00002a30: 6c69 7374 2c20 7665 7262 6f73 6520 3d20  list, verbose = 
+00002a40: 4661 6c73 6529 0a0a 2020 2020 2020 2020  False)..        
+00002a50: 2020 2020 2320 6d61 736b 0a20 2020 2020      # mask.     
+00002a60: 2020 2020 2020 206d 6173 6b5f 7a64 7420         mask_zdt 
+00002a70: 3d20 646d 2e64 665f 6469 6374 5b27 5430  = dm.df_dict['T0
+00002a80: 275d 5b27 7063 745f 6368 6727 5d2e 746f  ']['pct_chg'].to
+00002a90: 5f70 616e 6461 7328 292e 6162 7328 2920  _pandas().abs() 
+00002aa0: 3c20 392e 3835 0a20 2020 2020 2020 2020  < 9.85.         
+00002ab0: 2020 2064 6d2e 7365 745f 6d61 736b 286d     dm.set_mask(m
+00002ac0: 6173 6b5f 7a64 742c 2027 7a64 7427 290a  ask_zdt, 'zdt').
+00002ad0: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
+00002ae0: 5f61 6c6c 203d 2028 7e6e 702e 6973 6e61  _all = (~np.isna
+00002af0: 6e28 646d 2e64 665f 6469 6374 5b27 5430  n(dm.df_dict['T0
+00002b00: 275d 5b63 6f6c 5f6c 6162 656c 5d2e 746f  '][col_label].to
+00002b10: 5f6e 756d 7079 2829 2929 2e61 7374 7970  _numpy())).astyp
+00002b20: 6528 6e70 2e69 6e74 3332 290a 2020 2020  e(np.int32).    
+00002b30: 2020 2020 2020 2020 646d 2e73 6574 5f6d          dm.set_m
+00002b40: 6173 6b28 6d61 736b 5f61 6c6c 2c20 2761  ask(mask_all, 'a
+00002b50: 6c6c 2729 0a20 2020 2020 2020 2020 2020  ll').           
+00002b60: 2070 7269 6e74 2866 275b 2b5d 207a 6474   print(f'[+] zdt
+00002b70: 203d 207b 6d61 736b 5f7a 6474 2e73 756d   = {mask_zdt.sum
+00002b80: 2829 7d20 2f20 7b6c 656e 286d 6173 6b5f  ()} / {len(mask_
+00002b90: 7a64 7429 7d2c 207a 6474 5f72 6174 696f  zdt)}, zdt_ratio
+00002ba0: 203d 207b 6d61 736b 5f7a 6474 2e73 756d   = {mask_zdt.sum
+00002bb0: 2829 202f 206c 656e 286d 6173 6b5f 7a64  () / len(mask_zd
+00002bc0: 7429 7d27 290a 2020 2020 2020 2020 2020  t)}').          
+00002bd0: 2020 7072 696e 7428 6627 5b2b 5d20 616c    print(f'[+] al
+00002be0: 6c20 3d20 7b6d 6173 6b5f 616c 6c2e 7375  l = {mask_all.su
+00002bf0: 6d28 297d 202f 207b 6c65 6e28 6d61 736b  m()} / {len(mask
+00002c00: 5f61 6c6c 297d 2c20 616c 6c5f 7261 7469  _all)}, all_rati
+00002c10: 6f20 3d20 7b6d 6173 6b5f 616c 6c2e 7375  o = {mask_all.su
+00002c20: 6d28 2920 2f20 6c65 6e28 6d61 736b 5f61  m() / len(mask_a
+00002c30: 6c6c 297d 2729 0a20 2020 2020 2020 2020  ll)}').         
+00002c40: 2020 2078 203d 2064 6d2e 6466 5f64 6963     x = dm.df_dic
+00002c50: 745b 2754 3027 5d5b 636f 6c5f 7469 645d  t['T0'][col_tid]
+00002c60: 2e74 6f5f 6e75 6d70 7928 290a 2020 2020  .to_numpy().    
+00002c70: 2020 2020 2020 2020 666f 7220 6b65 7920          for key 
+00002c80: 696e 2073 6f72 7465 6428 6461 7465 5f64  in sorted(date_d
+00002c90: 6963 742e 6b65 7973 2829 293a 0a20 2020  ict.keys()):.   
+00002ca0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00002cb0: 655f 6265 6769 6e2c 2064 6174 655f 656e  e_begin, date_en
+00002cc0: 6420 3d20 6461 7465 5f64 6963 745b 6b65  d = date_dict[ke
+00002cd0: 795d 0a20 2020 2020 2020 2020 2020 2020  y].             
+00002ce0: 2020 2069 6620 6b65 7920 3d3d 2027 7472     if key == 'tr
+00002cf0: 6169 6e27 3a0a 2020 2020 2020 2020 2020  ain':.          
+00002d00: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
+00002d10: 2020 2878 203e 3d20 6461 7465 5f62 6567    (x >= date_beg
+00002d20: 696e 2920 2620 2878 203c 2064 6174 655f  in) & (x < date_
+00002d30: 656e 6429 2023 2064 726f 7020 3120 6461  end) # drop 1 da
+00002d40: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00002d50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002d60: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
+00002d70: 203d 2020 2878 203e 3d20 6461 7465 5f62   =  (x >= date_b
+00002d80: 6567 696e 2920 2620 2878 203c 3d20 6461  egin) & (x <= da
+00002d90: 7465 5f65 6e64 290a 0a20 2020 2020 2020  te_end)..       
+00002da0: 2020 2020 2020 2020 2069 6620 6b65 7920           if key 
+00002db0: 213d 2027 7465 7374 273a 0a20 2020 2020  != 'test':.     
+00002dc0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00002dd0: 6173 6b20 263d 206d 6173 6b5f 616c 6c2e  ask &= mask_all.
+00002de0: 6173 7479 7065 2862 6f6f 6c29 0a20 2020  astype(bool).   
+00002df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002e00: 206d 6173 6b20 263d 206d 6173 6b5f 7a64   mask &= mask_zd
+00002e10: 742e 6173 7479 7065 2862 6f6f 6c29 0a20  t.astype(bool). 
+00002e20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00002e30: 6d2e 7365 745f 6d61 736b 286d 6173 6b2c  m.set_mask(mask,
+00002e40: 206d 6173 6b5f 6e61 6d65 203d 206b 6579   mask_name = key
+00002e50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00002e60: 2020 6966 206c 656e 2878 5b6d 6173 6b5d    if len(x[mask]
+00002e70: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+00002e80: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00002e90: 2866 275b 2b5d 206d 6173 6b5f 6e61 6d65  (f'[+] mask_name
+00002ea0: 203d 207b 6b65 793a 3c31 317d 7c20 7b78   = {key:<11}| {x
+00002eb0: 5b6d 6173 6b5d 2e6d 696e 2829 7d20 2d3e  [mask].min()} ->
+00002ec0: 207b 785b 6d61 736b 5d2e 6d61 7828 297d   {x[mask].max()}
+00002ed0: 203d 207b 6d61 736b 2e73 756d 2829 7d27   = {mask.sum()}'
+00002ee0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00002ef0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002f00: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00002f10: 7428 6627 5b2b 5d20 6d61 736b 5f6e 616d  t(f'[+] mask_nam
+00002f20: 6520 3d20 7b6b 6579 3a3c 3131 7d7c 206c  e = {key:<11}| l
+00002f30: 656e 203d 2030 2729 0a0a 2020 2020 2020  en = 0')..      
+00002f40: 2020 2020 2020 2320 7368 6966 745f 310a        # shift_1.
+00002f50: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00002f60: 5f73 6869 6674 5f31 203d 205b 636f 6c20  _shift_1 = [col 
+00002f70: 666f 7220 636f 6c20 696e 2064 6d2e 6865  for col in dm.he
+00002f80: 6164 2829 2e63 6f6c 756d 6e73 2069 6620  ad().columns if 
+00002f90: 636f 6c20 6e6f 7420 696e 205b 636f 6c5f  col not in [col_
+00002fa0: 6964 2c20 636f 6c5f 7469 642c 2063 6f6c  id, col_tid, col
+00002fb0: 5f6c 6162 656c 5d20 2b20 636f 6c73 5f74  _label] + cols_t
+00002fc0: 6964 5d0a 2020 2020 2020 2020 2020 2020  id].            
+00002fd0: 646d 2e66 655f 676f 285b 6627 7b63 6f6c  dm.fe_go([f'{col
+00002fe0: 7d20 3d20 726f 6c6c 2873 6869 6674 2c20  } = roll(shift, 
+00002ff0: 7473 5f63 6f64 652c 207b 636f 6c7d 2c20  ts_code, {col}, 
+00003000: 7472 6164 655f 6461 7465 2c20 3129 2720  trade_date, 1)' 
+00003010: 666f 7220 636f 6c20 696e 2063 6f6c 735f  for col in cols_
+00003020: 7368 6966 745f 315d 290a 0a20 2020 2020  shift_1])..     
+00003030: 2020 2020 2020 2072 6574 7572 6e20 646d         return dm
+00003040: 0a20 2020 2072 0100 0000 7201 0000 0072  .    r....r....r
+00003050: 0100 0000 7201 0000 0072 0200 0000 da0d  ....r....r......
+00003060: 7072 6570 726f 6365 7373 696e 6704 0100  preprocessing...
+00003070: 0073 0200 0000 0001 720d 0000 0063 0000  .s......r....c..
+00003080: 0000 0000 0000 0000 0000 0000 0000 0100  ................
+00003090: 0000 4300 0000 7304 0000 0064 0153 0029  ..C...s....d.S.)
+000030a0: 024e 61d6 0400 000a 6465 6620 6765 745f  .Na.....def get_
+000030b0: 6466 5f6c 6162 656c 5f66 696e 616c 2864  df_label_final(d
+000030c0: 662c 2063 6f6c 5f74 6964 2c20 636f 6c5f  f, col_tid, col_
+000030d0: 6964 2c20 636f 6c73 5f70 7269 6365 2c20  id, cols_price, 
+000030e0: 6932 6a5f 6c69 7374 293a 0a20 2020 2063  i2j_list):.    c
+000030f0: 6f6c 735f 6964 203d 205b 636f 6c5f 7469  ols_id = [col_ti
+00003100: 642c 2063 6f6c 5f69 645d 0a20 2020 2069  d, col_id].    i
+00003110: 645f 6c69 7374 203d 205b 6e70 2e73 6f72  d_list = [np.sor
+00003120: 7428 6466 5b63 6f6c 5d2e 756e 6971 7565  t(df[col].unique
+00003130: 2829 2920 666f 7220 636f 6c20 696e 2063  ()) for col in c
+00003140: 6f6c 735f 6964 5d0a 2020 2020 7368 6170  ols_id].    shap
+00003150: 6520 3d20 5b6c 656e 2878 2920 666f 7220  e = [len(x) for 
+00003160: 7820 696e 2069 645f 6c69 7374 5d0a 2020  x in id_list].  
+00003170: 2020 6466 5f69 645f 616c 6c20 3d20 6765    df_id_all = ge
+00003180: 745f 6466 5f69 645f 616c 6c28 6964 5f6c  t_df_id_all(id_l
+00003190: 6973 742c 2063 6f6c 735f 6964 203d 2063  ist, cols_id = c
+000031a0: 6f6c 735f 6964 290a 2020 2020 6466 5f69  ols_id).    df_i
+000031b0: 645f 616c 6c20 3d20 6466 5f69 645f 616c  d_all = df_id_al
+000031c0: 6c2e 6173 7479 7065 2864 665b 636f 6c73  l.astype(df[cols
+000031d0: 5f69 645d 2e64 7479 7065 732e 746f 5f64  _id].dtypes.to_d
+000031e0: 6963 7428 2929 0a0a 2020 2020 5f64 665f  ict())..    _df_
+000031f0: 4c20 3d20 706c 2e66 726f 6d5f 7061 6e64  L = pl.from_pand
+00003200: 6173 2864 665f 6964 5f61 6c6c 290a 2020  as(df_id_all).  
+00003210: 2020 5f64 665f 5220 3d20 706c 2e66 726f    _df_R = pl.fro
+00003220: 6d5f 7061 6e64 6173 2864 665b 636f 6c73  m_pandas(df[cols
+00003230: 5f69 6420 2b20 636f 6c73 5f70 7269 6365  _id + cols_price
+00003240: 5d29 0a20 2020 2064 665f 4c5f 5220 3d20  ]).    df_L_R = 
+00003250: 5f64 665f 4c2e 6a6f 696e 285f 6466 5f52  _df_L.join(_df_R
+00003260: 2c20 6f6e 203d 2063 6f6c 735f 6964 2c20  , on = cols_id, 
+00003270: 686f 7720 3d20 276c 6566 7427 290a 0a20  how = 'left').. 
+00003280: 2020 205f 6466 5f4c 3220 3d20 5f64 665f     _df_L2 = _df_
+00003290: 4c5b 636f 6c73 5f69 645d 0a20 2020 2066  L[cols_id].    f
+000032a0: 6f72 2063 6f6c 2069 6e20 636f 6c73 5f70  or col in cols_p
+000032b0: 7269 6365 3a0a 2020 2020 2020 2020 6120  rice:.        a 
+000032c0: 3d20 6e70 2e61 7363 6f6e 7469 6775 6f75  = np.ascontiguou
+000032d0: 7361 7272 6179 2864 665f 4c5f 525b 636f  sarray(df_L_R[co
+000032e0: 6c5d 2e74 6f5f 6e75 6d70 7928 292e 7265  l].to_numpy().re
+000032f0: 7368 6170 6528 7368 6170 6529 290a 2020  shape(shape)).  
+00003300: 2020 2020 2020 666f 7220 2869 2c20 6a29        for (i, j)
+00003310: 2069 6e20 6932 6a5f 6c69 7374 3a0a 2020   in i2j_list:.  
+00003320: 2020 2020 2020 2020 2020 615f 6920 3d20            a_i = 
+00003330: 6765 745f 615f 7368 6966 7428 612c 202d  get_a_shift(a, -
+00003340: 3120 2a20 6929 0a20 2020 2020 2020 2020  1 * i).         
+00003350: 2020 2061 5f6a 203d 2067 6574 5f61 5f73     a_j = get_a_s
+00003360: 6869 6674 2861 2c20 2d31 202a 206a 290a  hift(a, -1 * j).
+00003370: 2020 2020 2020 2020 2020 2020 615f 6932              a_i2
+00003380: 6a20 3d20 615f 6a20 2f20 615f 6920 2d20  j = a_j / a_i - 
+00003390: 310a 2020 2020 2020 2020 2020 2020 615f  1.            a_
+000033a0: 6932 6a5b 7e6e 702e 6973 6669 6e69 7465  i2j[~np.isfinite
+000033b0: 2861 5f69 326a 295d 203d 206e 702e 6e61  (a_i2j)] = np.na
+000033c0: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
+000033d0: 6e61 6d65 203d 2066 274c 4142 454c 5f7b  name = f'LABEL_{
+000033e0: 636f 6c5b 305d 2e75 7070 6572 2829 7d7b  col[0].upper()}{
+000033f0: 697d 5f7b 636f 6c5b 305d 2e75 7070 6572  i}_{col[0].upper
+00003400: 2829 7d7b 6a7d 270a 2020 2020 2020 2020  ()}{j}'.        
+00003410: 2020 2020 6e61 6d65 203d 2066 274c 4142      name = f'LAB
+00003420: 454c 5f7b 636f 6c7d 5f7b 697d 5f7b 6a7d  EL_{col}_{i}_{j}
+00003430: 270a 2020 2020 2020 2020 2020 2020 5f64  '.            _d
+00003440: 665f 4c32 203d 205f 6466 5f4c 322e 7769  f_L2 = _df_L2.wi
+00003450: 7468 5f63 6f6c 756d 6e73 2870 6c2e 5365  th_columns(pl.Se
+00003460: 7269 6573 286e 616d 652c 2061 5f69 326a  ries(name, a_i2j
+00003470: 2e72 6176 656c 2829 2e61 7374 7970 6528  .ravel().astype(
+00003480: 6e70 2e66 6c6f 6174 3332 2929 290a 0a20  np.float32))).. 
+00003490: 2020 205f 6466 5f52 3220 3d20 5f64 665f     _df_R2 = _df_
+000034a0: 525b 636f 6c73 5f69 645d 0a20 2020 205f  R[cols_id].    _
+000034b0: 6466 5f52 325f 4c32 203d 205f 6466 5f52  df_R2_L2 = _df_R
+000034c0: 322e 6a6f 696e 285f 6466 5f4c 322c 206f  2.join(_df_L2, o
+000034d0: 6e20 3d20 636f 6c73 5f69 642c 2068 6f77  n = cols_id, how
+000034e0: 203d 2027 6c65 6674 2729 0a20 2020 2063   = 'left').    c
+000034f0: 6f6c 735f 6c61 6265 6c20 3d20 5b63 6f6c  ols_label = [col
+00003500: 2066 6f72 2063 6f6c 2069 6e20 5f64 665f   for col in _df_
+00003510: 5232 5f4c 322e 636f 6c75 6d6e 7320 6966  R2_L2.columns if
+00003520: 2063 6f6c 206e 6f74 2069 6e20 636f 6c73   col not in cols
+00003530: 5f69 645d 2020 0a20 2020 2064 665f 6c61  _id]  .    df_la
+00003540: 6265 6c5f 6669 6e61 6c20 3d20 5f64 665f  bel_final = _df_
+00003550: 5232 5f4c 320a 2020 2020 7265 7475 726e  R2_L2.    return
+00003560: 2064 665f 6c61 6265 6c5f 6669 6e61 6c2c   df_label_final,
+00003570: 2063 6f6c 735f 6c61 6265 6c0a 0a72 0100   cols_label..r..
+00003580: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00003590: 0072 0200 0000 da09 7072 655f 6c61 6265  .r......pre_labe
+000035a0: 6c48 0100 0073 0200 0000 0001 720e 0000  lH...s......r...
+000035b0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+000035c0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+000035d0: 0153 0029 024e 6122 0500 000a 2020 2020  .S.).Na"....    
+000035e0: 2320 727a 2e6c 6762 0a20 2020 2069 6d70  # rz.lgb.    imp
+000035f0: 6f72 7420 6c69 6768 7467 626d 2061 7320  ort lightgbm as 
+00003600: 6c67 623b 2070 7269 6e74 286c 6762 2e5f  lgb; print(lgb._
+00003610: 5f76 6572 7369 6f6e 5f5f 2c20 6c67 622e  _version__, lgb.
+00003620: 5f5f 6669 6c65 5f5f 290a 2020 2020 6672  __file__).    fr
+00003630: 6f6d 2072 756e 6e69 6e67 7a2e 6d6f 6465  om runningz.mode
+00003640: 6c2e 7465 7374 5f6d 6f64 656c 5f61 6c6c  l.test_model_all
+00003650: 2069 6d70 6f72 7420 6765 745f 7265 6772   import get_regr
+00003660: 6573 7369 6f6e 5f64 6174 610a 2020 2020  ession_data.    
+00003670: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
+00003680: 2c20 585f 7661 6c69 642c 2079 5f76 616c  , X_valid, y_val
+00003690: 6964 203d 2067 6574 5f72 6567 7265 7373  id = get_regress
+000036a0: 696f 6e5f 6461 7461 286e 203d 2031 6534  ion_data(n = 1e4
+000036b0: 2c20 6d20 3d20 3130 302c 2073 6565 6420  , m = 100, seed 
+000036c0: 3d20 3432 2c20 6e5f 7661 6c69 6420 3d20  = 42, n_valid = 
+000036d0: 3130 3029 0a0a 2020 2020 6d6f 6465 6c20  100)..    model 
+000036e0: 3d20 727a 2e6d 6f64 656c 2e74 7265 652e  = rz.model.tree.
+000036f0: 4c47 424d 6f64 656c 2829 0a20 2020 2070  LGBModel().    p
+00003700: 6172 616d 7320 3d20 727a 2e6f 7074 2e6f  arams = rz.opt.o
+00003710: 7074 5f72 616e 646f 6d2e 6765 745f 7061  pt_random.get_pa
+00003720: 7261 6d73 5f6c 6762 2829 0a20 2020 2023  rams_lgb().    #
+00003730: 2070 6172 616d 7320 3d20 4c47 424d 6f64   params = LGBMod
+00003740: 656c 2e67 6574 5f70 6172 616d 7328 2770  el.get_params('p
+00003750: 6172 616d 735f 3127 290a 2020 2020 5879  arams_1').    Xy
+00003760: 5f64 6963 7420 3d20 7b27 585f 7472 6169  _dict = {'X_trai
+00003770: 6e27 3a20 585f 7472 6169 6e2c 2027 795f  n': X_train, 'y_
+00003780: 7472 6169 6e27 3a20 795f 7472 6169 6e7d  train': y_train}
+00003790: 0a20 2020 2023 2064 656c 2058 5f74 7261  .    # del X_tra
+000037a0: 696e 2c20 795f 7472 6169 6e3b 2067 632e  in, y_train; gc.
+000037b0: 636f 6c6c 6563 7428 290a 2020 2020 6d6f  collect().    mo
+000037c0: 6465 6c2e 7472 6169 6e28 7b27 585f 7472  del.train({'X_tr
+000037d0: 6169 6e27 3a20 585f 7472 6169 6e2c 2027  ain': X_train, '
+000037e0: 795f 7472 6169 6e27 3a20 795f 7472 6169  y_train': y_trai
+000037f0: 6e7d 2c20 7061 7261 6d73 203d 2070 6172  n}, params = par
+00003800: 616d 732c 206b 7761 7267 733d 7b27 6672  ams, kwargs={'fr
+00003810: 6565 5879 273a 2046 616c 7365 2c20 2776  eeXy': False, 'v
+00003820: 6572 626f 7365 273a 2035 307d 290a 2020  erbose': 50}).  
+00003830: 2020 6d6f 6465 6c2e 6475 6d70 2866 277b    model.dump(f'{
+00003840: 7061 7468 5f6f 7574 7075 747d 2f6d 6f64  path_output}/mod
+00003850: 656c 2e62 696e 2729 0a20 2020 206d 6f64  el.bin').    mod
+00003860: 656c 203d 2072 7a2e 6d6f 6465 6c2e 7472  el = rz.model.tr
+00003870: 6565 2e4c 4742 4d6f 6465 6c28 292e 6c6f  ee.LGBModel().lo
+00003880: 6164 2866 277b 7061 7468 5f6f 7574 7075  ad(f'{path_outpu
+00003890: 747d 2f6d 6f64 656c 2e62 696e 2729 0a20  t}/model.bin'). 
+000038a0: 2020 2079 5f70 7265 6420 3d20 6d6f 6465     y_pred = mode
+000038b0: 6c2e 7072 6564 6963 7428 5829 0a0a 2020  l.predict(X)..  
+000038c0: 2020 2320 6c67 620a 2020 2020 2320 696e    # lgb.    # in
+000038d0: 6974 5f73 636f 7265 0a20 2020 2064 7472  it_score.    dtr
+000038e0: 6169 6e20 3d20 6c67 622e 4461 7461 7365  ain = lgb.Datase
+000038f0: 7428 585f 7472 6169 6e2c 2079 5f74 7261  t(X_train, y_tra
+00003900: 696e 2c20 7765 6967 6874 203d 204e 6f6e  in, weight = Non
+00003910: 652c 2069 6e69 745f 7363 6f72 6520 3d20  e, init_score = 
+00003920: 4e6f 6e65 290a 2020 2020 2320 6465 6c20  None).    # del 
+00003930: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
+00003940: 3b20 6763 2e63 6f6c 6c65 6374 2829 0a20  ; gc.collect(). 
+00003950: 2020 2023 2076 6572 626f 7365 203d 2035     # verbose = 5
+00003960: 300a 2020 2020 6d6f 6465 6c20 3d20 6c67  0.    model = lg
+00003970: 622e 7472 6169 6e28 0a20 2020 2020 2020  b.train(.       
+00003980: 2020 2020 2020 2020 2070 6172 616d 732c           params,
+00003990: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+000039a0: 2020 6474 7261 696e 2c20 0a20 2020 2020    dtrain, .     
+000039b0: 2020 2020 2020 2020 2020 2023 2076 616c             # val
+000039c0: 6964 5f73 6574 7320 3d20 5b64 7661 6c69  id_sets = [dvali
+000039d0: 645d 2c20 0a20 2020 2020 2020 2020 2020  d], .           
+000039e0: 2020 2020 2023 2063 616c 6c62 6163 6b73       # callbacks
+000039f0: 203d 205b 6c67 622e 6c6f 675f 6576 616c   = [lgb.log_eval
+00003a00: 7561 7469 6f6e 2876 6572 626f 7365 2c20  uation(verbose, 
+00003a10: 5472 7565 2069 6620 7665 7262 6f73 6520  True if verbose 
+00003a20: 3e20 3020 656c 7365 2046 616c 7365 295d  > 0 else False)]
+00003a30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003a40: 2020 2320 696e 6974 5f6d 6f64 656c 203d    # init_model =
+00003a50: 206d 6f64 656c 5f62 6173 652c 0a20 2020   model_base,.   
+00003a60: 2020 2020 2020 2020 2029 0a20 2020 206d           ).    m
+00003a70: 6f64 656c 2e73 6176 655f 6d6f 6465 6c28  odel.save_model(
+00003a80: 6627 7b70 6174 685f 6f75 7470 7574 7d2f  f'{path_output}/
+00003a90: 6d6f 6465 6c2e 6269 6e27 290a 2020 2020  model.bin').    
+00003aa0: 6d6f 6465 6c20 3d20 6c67 622e 426f 6f73  model = lgb.Boos
+00003ab0: 7465 7228 6d6f 6465 6c5f 6669 6c65 3d66  ter(model_file=f
+00003ac0: 277b 7061 7468 5f6f 7574 7075 747d 2f6d  '{path_output}/m
+00003ad0: 6f64 656c 2e62 696e 2729 0a20 2020 2079  odel.bin').    y
+00003ae0: 5f70 7265 6420 3d20 6d6f 6465 6c2e 7072  _pred = model.pr
+00003af0: 6564 6963 7428 5829 0a20 2020 2072 0100  edict(X).    r..
+00003b00: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00003b10: 0072 0200 0000 da0b 7472 6169 6e5f 6d6f  .r......train_mo
+00003b20: 6465 6c69 0100 0073 0200 0000 0001 720f  deli...s......r.
+00003b30: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
+00003b40: 0000 0000 0100 0000 4300 0000 7304 0000  ........C...s...
+00003b50: 0064 0153 0029 024e 6194 0900 000a 696d  .d.S.).Na.....im
+00003b60: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+00003b70: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
+00003b80: 7320 7064 0a69 6d70 6f72 7420 746f 7263  s pd.import torc
+00003b90: 680a 696d 706f 7274 206c 6967 6874 6762  h.import lightgb
+00003ba0: 6d20 6173 206c 6762 3b20 7072 696e 7428  m as lgb; print(
+00003bb0: 6c67 622e 5f5f 7665 7273 696f 6e5f 5f2c  lgb.__version__,
+00003bc0: 206c 6762 2e5f 5f66 696c 655f 5f29 0a69   lgb.__file__).i
+00003bd0: 6d70 6f72 7420 7867 626f 6f73 7420 2061  mport xgboost  a
+00003be0: 7320 7867 623b 2070 7269 6e74 2878 6762  s xgb; print(xgb
+00003bf0: 2e5f 5f76 6572 7369 6f6e 5f5f 2c20 7867  .__version__, xg
+00003c00: 622e 5f5f 6669 6c65 5f5f 290a 696d 706f  b.__file__).impo
+00003c10: 7274 2063 6174 626f 6f73 7420 6173 2063  rt catboost as c
+00003c20: 6174 3b20 7072 696e 7428 6361 742e 5f5f  at; print(cat.__
+00003c30: 7665 7273 696f 6e5f 5f2c 2063 6174 2e5f  version__, cat._
+00003c40: 5f66 696c 655f 5f29 0a0a 585f 7472 6169  _file__)..X_trai
+00003c50: 6e20 3d20 727a 2e75 7469 6c2e 6e70 795f  n = rz.util.npy_
+00003c60: 6e75 6d62 612e 6e70 5f72 616e 646f 6d5f  numba.np_random_
+00003c70: 7261 6e64 6e28 3130 3030 302c 2031 3030  randn(10000, 100
+00003c80: 290a 795f 7472 6169 6e20 3d20 727a 2e75  ).y_train = rz.u
+00003c90: 7469 6c2e 6e70 795f 6e75 6d62 612e 6e70  til.npy_numba.np
+00003ca0: 5f72 616e 646f 6d5f 7261 6e64 6e28 3130  _random_randn(10
+00003cb0: 3030 3029 0a58 795f 6469 6374 203d 207b  000).Xy_dict = {
+00003cc0: 2758 5f74 7261 696e 273a 2058 5f74 7261  'X_train': X_tra
+00003cd0: 696e 2c20 2779 5f74 7261 696e 273a 2079  in, 'y_train': y
+00003ce0: 5f74 7261 696e 7d0a 0a23 202d 2d2d 2d2d  _train}..# -----
+00003cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d3e  --------------->
+00003d50: 204c 4742 0a66 726f 6d20 7275 6e6e 696e   LGB.from runnin
+00003d60: 677a 2e6d 6f64 656c 2069 6d70 6f72 7420  gz.model import 
+00003d70: 4c47 424d 6f64 656c 2061 7320 4d6f 6465  LGBModel as Mode
+00003d80: 6c0a 6d6f 6465 6c20 3d20 4d6f 6465 6c28  l.model = Model(
+00003d90: 665f 6c61 6265 6c20 3d20 4e6f 6e65 290a  f_label = None).
+00003da0: 2320 6d6f 6465 6c20 3d20 4d6f 6465 6c28  # model = Model(
+00003db0: 665f 6c61 6265 6c20 3d20 276c 6f67 3170  f_label = 'log1p
+00003dc0: 272c 2063 6c69 7020 3d20 3529 0a70 6172  ', clip = 5).par
+00003dd0: 616d 7320 3d20 4d6f 6465 6c2e 6765 745f  ams = Model.get_
+00003de0: 7061 7261 6d73 2827 7061 7261 6d73 5f31  params('params_1
+00003df0: 2729 0a70 6172 616d 735b 2764 6576 6963  ').params['devic
+00003e00: 6527 5d20 3d20 2767 7075 2720 6966 2074  e'] = 'gpu' if t
+00003e10: 6f72 6368 2e63 7564 612e 6973 5f61 7661  orch.cuda.is_ava
+00003e20: 696c 6162 6c65 2829 2065 6c73 6520 2763  ilable() else 'c
+00003e30: 7075 270a 7061 7261 6d73 5b27 6e5f 6573  pu'.params['n_es
+00003e40: 7469 6d61 746f 7273 275d 203d 2031 3030  timators'] = 100
+00003e50: 0a6d 6f64 656c 203d 206d 6f64 656c 2e74  .model = model.t
+00003e60: 7261 696e 2858 795f 6469 6374 2c20 7061  rain(Xy_dict, pa
+00003e70: 7261 6d73 203d 2070 6172 616d 732c 206b  rams = params, k
+00003e80: 7761 7267 733d 7b27 6672 6565 5f58 7927  wargs={'free_Xy'
+00003e90: 3a20 4661 6c73 652c 2027 7665 7262 6f73  : False, 'verbos
+00003ea0: 6527 3a20 3530 7d29 0a0a 7931 203d 206d  e': 50})..y1 = m
+00003eb0: 6f64 656c 2e6d 6f64 656c 2e70 7265 6469  odel.model.predi
+00003ec0: 6374 2858 5f74 7261 696e 2c20 6e75 6d5f  ct(X_train, num_
+00003ed0: 6974 6572 6174 696f 6e20 3d20 3530 290a  iteration = 50).
+00003ee0: 2320 7931 203d 206e 702e 6578 706d 3128  # y1 = np.expm1(
+00003ef0: 6e70 2e65 7870 6d31 2879 3129 2920 2d20  np.expm1(y1)) - 
+00003f00: 350a 7932 203d 206d 6f64 656c 2e70 7265  5.y2 = model.pre
+00003f10: 6469 6374 2858 5f74 7261 696e 2c20 6b77  dict(X_train, kw
+00003f20: 6172 6773 3d7b 276e 5f62 6f6f 7374 273a  args={'n_boost':
+00003f30: 2035 307d 290a 7072 696e 7428 6e70 2e61   50}).print(np.a
+00003f40: 6273 2879 3120 2d20 7932 292e 7375 6d28  bs(y1 - y2).sum(
+00003f50: 2929 0a0a 2320 2d2d 2d2d 2d2d 2d2d 2d2d  ))..# ----------
+00003f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003f90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 3e20 4341 540a  ----------> CAT.
+00003fc0: 6672 6f6d 2072 756e 6e69 6e67 7a2e 6d6f  from runningz.mo
+00003fd0: 6465 6c20 696d 706f 7274 2043 4154 4d6f  del import CATMo
+00003fe0: 6465 6c20 6173 204d 6f64 656c 0a6d 6f64  del as Model.mod
+00003ff0: 656c 203d 204d 6f64 656c 2866 5f6c 6162  el = Model(f_lab
+00004000: 656c 203d 204e 6f6e 6529 0a23 206d 6f64  el = None).# mod
+00004010: 656c 203d 204d 6f64 656c 2866 5f6c 6162  el = Model(f_lab
+00004020: 656c 203d 2027 6c6f 6731 7027 2c20 636c  el = 'log1p', cl
+00004030: 6970 203d 2035 290a 7061 7261 6d73 203d  ip = 5).params =
+00004040: 204d 6f64 656c 2e67 6574 5f70 6172 616d   Model.get_param
+00004050: 7328 2770 6172 616d 735f 3127 290a 7061  s('params_1').pa
+00004060: 7261 6d73 5b27 7461 736b 5f74 7970 6527  rams['task_type'
+00004070: 5d20 3d20 2747 5055 2720 6966 2074 6f72  ] = 'GPU' if tor
+00004080: 6368 2e63 7564 612e 6973 5f61 7661 696c  ch.cuda.is_avail
+00004090: 6162 6c65 2829 2065 6c73 6520 2743 5055  able() else 'CPU
+000040a0: 270a 7061 7261 6d73 5b27 6e5f 6573 7469  '.params['n_esti
+000040b0: 6d61 746f 7273 275d 203d 2031 3030 0a6d  mators'] = 100.m
+000040c0: 6f64 656c 203d 206d 6f64 656c 2e74 7261  odel = model.tra
+000040d0: 696e 2858 795f 6469 6374 2c20 7061 7261  in(Xy_dict, para
+000040e0: 6d73 203d 2070 6172 616d 732c 206b 7761  ms = params, kwa
+000040f0: 7267 733d 7b27 6672 6565 5f58 7927 3a20  rgs={'free_Xy': 
+00004100: 4661 6c73 652c 2027 7665 7262 6f73 6527  False, 'verbose'
+00004110: 3a20 3530 7d29 0a0a 7931 203d 206d 6f64  : 50})..y1 = mod
+00004120: 656c 2e6d 6f64 656c 2e70 7265 6469 6374  el.model.predict
+00004130: 2858 5f74 7261 696e 2c20 6e74 7265 655f  (X_train, ntree_
+00004140: 656e 6420 3d20 3530 290a 2320 7931 203d  end = 50).# y1 =
+00004150: 206e 702e 6578 706d 3128 6e70 2e65 7870   np.expm1(np.exp
+00004160: 6d31 2879 3129 2920 2d20 350a 7932 203d  m1(y1)) - 5.y2 =
+00004170: 206d 6f64 656c 2e70 7265 6469 6374 2858   model.predict(X
+00004180: 5f74 7261 696e 2c20 6b77 6172 6773 3d7b  _train, kwargs={
+00004190: 276e 5f62 6f6f 7374 273a 2035 307d 290a  'n_boost': 50}).
+000041a0: 7072 696e 7428 6e70 2e61 6273 2879 3120  print(np.abs(y1 
+000041b0: 2d20 7932 292e 7375 6d28 2929 0a0a 2320  - y2).sum())..# 
+000041c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000041d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000041e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000041f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004220: 2d2d 2d2d 3e20 4c52 0a66 726f 6d20 7275  ----> LR.from ru
+00004230: 6e6e 696e 677a 2e6d 6f64 656c 2069 6d70  nningz.model imp
+00004240: 6f72 7420 4c52 4d6f 6465 6c20 6173 204d  ort LRModel as M
+00004250: 6f64 656c 0a6d 6f64 656c 203d 204d 6f64  odel.model = Mod
+00004260: 656c 2829 0a70 6172 616d 7320 3d20 4d6f  el().params = Mo
+00004270: 6465 6c2e 6765 745f 7061 7261 6d73 2827  del.get_params('
+00004280: 7061 7261 6d73 5f31 2729 0a70 6172 616d  params_1').param
+00004290: 735b 276e 5f65 7374 696d 6174 6f72 7327  s['n_estimators'
+000042a0: 5d20 3d20 3130 0a6d 6f64 656c 203d 206d  ] = 10.model = m
+000042b0: 6f64 656c 2e74 7261 696e 2858 795f 6469  odel.train(Xy_di
+000042c0: 6374 2c20 7061 7261 6d73 203d 2070 6172  ct, params = par
+000042d0: 616d 732c 206b 7761 7267 733d 7b27 6672  ams, kwargs={'fr
+000042e0: 6565 5f58 7927 3a20 4661 6c73 652c 2027  ee_Xy': False, '
+000042f0: 7665 7262 6f73 6527 3a20 317d 290a 0a23  verbose': 1})..#
+00004300: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00004310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004360: 2d2d 2d2d 2d3e 204d 4c50 0a66 726f 6d20  -----> MLP.from 
+00004370: 7275 6e6e 696e 677a 2e6d 6f64 656c 2069  runningz.model i
+00004380: 6d70 6f72 7420 4d4c 504d 6f64 656c 2061  mport MLPModel a
+00004390: 7320 4d6f 6465 6c0a 6d6f 6465 6c20 3d20  s Model.model = 
+000043a0: 4d6f 6465 6c28 290a 7061 7261 6d73 203d  Model().params =
+000043b0: 204d 6f64 656c 2e67 6574 5f70 6172 616d   Model.get_param
+000043c0: 7328 2770 6172 616d 735f 3127 290a 7061  s('params_1').pa
+000043d0: 7261 6d73 5b27 6e5f 6573 7469 6d61 746f  rams['n_estimato
+000043e0: 7273 275d 203d 2035 0a69 6620 746f 7263  rs'] = 5.if torc
+000043f0: 682e 6375 6461 2e69 735f 6176 6169 6c61  h.cuda.is_availa
+00004400: 626c 6528 293a 0a20 2020 2070 6172 616d  ble():.    param
+00004410: 735b 2764 6576 6963 6527 5d20 3d20 2763  s['device'] = 'c
+00004420: 7564 6127 0a20 2020 2070 6172 616d 735b  uda'.    params[
+00004430: 276e 756d 5f77 6f72 6b65 7273 275d 203d  'num_workers'] =
+00004440: 2038 0a20 2020 2070 6172 616d 735b 276e   8.    params['n
+00004450: 5f6a 6f62 7327 5d20 3d20 310a 656c 7365  _jobs'] = 1.else
+00004460: 3a0a 2020 2020 7061 7261 6d73 5b27 6e75  :.    params['nu
+00004470: 6d5f 776f 726b 6572 7327 5d20 3d20 340a  m_workers'] = 4.
+00004480: 2020 2020 7061 7261 6d73 5b27 6e5f 6a6f      params['n_jo
+00004490: 6273 275d 203d 2032 300a 6d6f 6465 6c20  bs'] = 20.model 
+000044a0: 3d20 6d6f 6465 6c2e 7472 6169 6e28 5879  = model.train(Xy
+000044b0: 5f64 6963 742c 2070 6172 616d 7320 3d20  _dict, params = 
+000044c0: 7061 7261 6d73 2c20 6b77 6172 6773 3d7b  params, kwargs={
+000044d0: 2766 7265 655f 5879 273a 2046 616c 7365  'free_Xy': False
+000044e0: 2c20 2776 6572 626f 7365 273a 2031 7d29  , 'verbose': 1})
+000044f0: 0a72 0100 0000 7201 0000 0072 0100 0000  .r....r....r....
+00004500: 7201 0000 0072 0200 0000 da0a 7465 7374  r....r......test
+00004510: 5f6d 6f64 656c 8b01 0000 7302 0000 0000  _model....s.....
+00004520: 0172 1000 0000 6300 0000 0000 0000 0000  .r....c.........
+00004530: 0000 0000 0000 0001 0000 0043 0000 0073  ...........C...s
+00004540: 0400 0000 6401 5300 2902 4e61 7603 0000  ....d.S.).Nav...
+00004550: 0a20 2020 2064 6566 2066 5f6d 6167 6963  .    def f_magic
+00004560: 5f6c 6162 656c 2879 2c20 6d61 6769 635f  _label(y, magic_
+00004570: 6c61 6265 6c2c 2076 6572 626f 7365 203d  label, verbose =
+00004580: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00004590: 2069 6620 6d61 6769 635f 6c61 6265 6c20   if magic_label 
+000045a0: 696e 205b 4e6f 6e65 2c20 274e 6f6e 6527  in [None, 'None'
+000045b0: 5d3a 2072 6574 7572 6e20 790a 2020 2020  ]: return y.    
+000045c0: 2020 2020 6d65 7468 6f64 2c20 7720 3d20      method, w = 
+000045d0: 6d61 6769 635f 6c61 6265 6c2e 7370 6c69  magic_label.spli
+000045e0: 7428 272c 2729 0a20 2020 2020 2020 2077  t(',').        w
+000045f0: 203d 2066 6c6f 6174 2877 290a 2020 2020   = float(w).    
+00004600: 2020 2020 6966 206d 6574 686f 6420 696e      if method in
+00004610: 205b 276c 6f67 272c 2027 6578 7027 5d3a   ['log', 'exp']:
+00004620: 0a20 2020 2020 2020 2020 2020 2079 5f72  .            y_r
+00004630: 6177 203d 2079 2e63 6f70 7928 290a 2020  aw = y.copy().  
+00004640: 2020 2020 2020 2020 2020 7369 676e 203d            sign =
+00004650: 206e 702e 7768 6572 6528 7920 3e3d 2030   np.where(y >= 0
+00004660: 2c20 312c 202d 3129 0a20 2020 2020 2020  , 1, -1).       
+00004670: 2020 2020 2069 6478 203d 2079 203e 2030       idx = y > 0
+00004680: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004690: 6d65 7468 6f64 203d 3d20 276c 6f67 273a  method == 'log':
+000046a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000046b0: 2079 5b69 6478 5d20 3d20 7369 676e 5b69   y[idx] = sign[i
+000046c0: 6478 5d20 2a20 6e70 2e6c 6f67 3130 2831  dx] * np.log10(1
+000046d0: 202b 206e 702e 6162 7328 795b 6964 785d   + np.abs(y[idx]
+000046e0: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+000046f0: 6c69 6620 6d65 7468 6f64 203d 3d20 2765  lif method == 'e
+00004700: 7870 273a 0a20 2020 2020 2020 2020 2020  xp':.           
+00004710: 2020 2020 2079 5b69 6478 5d20 3d20 7369       y[idx] = si
+00004720: 676e 5b69 6478 5d20 2a20 6e70 2e65 7870  gn[idx] * np.exp
+00004730: 2830 2e30 3120 2a20 6e70 2e61 6273 2879  (0.01 * np.abs(y
+00004740: 5b69 6478 5d29 290a 2020 2020 2020 2020  [idx])).        
+00004750: 2020 2020 7920 3d20 7720 2a20 795f 7261      y = w * y_ra
+00004760: 7720 2b20 2831 202d 2077 2920 2a20 790a  w + (1 - w) * y.
+00004770: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00004780: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
+00004790: 2020 2020 2020 2020 7072 696e 7428 6627          print(f'
+000047a0: 5b2b 5d20 6d61 6769 635f 6c61 6265 6c20  [+] magic_label 
+000047b0: 3d20 7b6d 6167 6963 5f6c 6162 656c 7d27  = {magic_label}'
+000047c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000047d0: 2079 0a0a 2020 2020 6465 6620 7275 6e5f   y..    def run_
+000047e0: 6d61 6769 635f 6c61 6265 6c28 792c 206d  magic_label(y, m
+000047f0: 6167 6963 5f6c 6162 656c 203d 204e 6f6e  agic_label = Non
+00004800: 6529 3a0a 2020 2020 2020 2020 6966 206d  e):.        if m
+00004810: 6167 6963 5f6c 6162 656c 2069 6e20 5b4e  agic_label in [N
+00004820: 6f6e 652c 2027 4e6f 6e65 275d 3a20 7265  one, 'None']: re
+00004830: 7475 726e 2079 0a20 2020 2020 2020 2066  turn y.        f
+00004840: 6f72 206d 6167 6963 5f6c 6162 656c 5f69  or magic_label_i
+00004850: 2069 6e20 6d61 6769 635f 6c61 6265 6c2e   in magic_label.
+00004860: 7370 6c69 7428 273a 2729 5b31 3a5d 3a0a  split(':')[1:]:.
+00004870: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+00004880: 665f 6d61 6769 635f 6c61 6265 6c28 792c  f_magic_label(y,
+00004890: 206d 6167 6963 5f6c 6162 656c 5f69 2c20   magic_label_i, 
+000048a0: 7665 7262 6f73 6520 3d20 4661 6c73 6529  verbose = False)
+000048b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000048c0: 790a 2020 2020 7201 0000 0072 0100 0000  y.    r....r....
+000048d0: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
+000048e0: 0e70 6f73 7470 726f 6365 7373 696e 67ca  .postprocessing.
+000048f0: 0100 0073 0200 0000 0001 7211 0000 0063  ...s......r....c
+00004900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004910: 0100 0000 4300 0000 7304 0000 0064 0153  ....C...s....d.S
+00004920: 0029 024e 6165 0300 000a 2020 2020 6465  .).Nae....    de
+00004930: 6620 6765 745f 6466 5f69 6328 646d 2c20  f get_df_ic(dm, 
+00004940: 795f 7072 6564 2c20 6e61 6d65 5f6c 6973  y_pred, name_lis
+00004950: 7420 3d20 4e6f 6e65 293a 0a20 2020 2020  t = None):.     
+00004960: 2020 2064 6d2e 7365 745f 6279 5f63 6f6c     dm.set_by_col
+00004970: 2827 7072 6564 272c 2079 5f70 7265 642e  ('pred', y_pred.
+00004980: 7265 7368 6170 6528 2d31 2929 0a20 2020  reshape(-1)).   
+00004990: 2020 2020 2069 6620 6e61 6d65 5f6c 6973       if name_lis
+000049a0: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+000049b0: 2020 2020 2020 206e 616d 655f 6c69 7374         name_list
+000049c0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000049d0: 2020 2020 2027 6963 203d 2067 7028 6963       'ic = gp(ic
+000049e0: 2c20 7469 642c 206c 6162 656c 2c20 7072  , tid, label, pr
+000049f0: 6564 2c20 6d61 736b 3d6d 6173 6b29 272c  ed, mask=mask)',
+00004a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004a10: 2027 6963 706d 203d 2067 7028 6963 706d   'icpm = gp(icpm
+00004a20: 2c20 7469 642c 206c 6162 656c 2c20 7072  , tid, label, pr
+00004a30: 6564 2c20 6d61 736b 3d6d 6173 6b29 272c  ed, mask=mask)',
+00004a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004a50: 2027 6963 706d 6720 3d20 6770 2869 6370   'icpmg = gp(icp
+00004a60: 6d67 2c20 7469 642c 206c 6162 656c 2c20  mg, tid, label, 
+00004a70: 7072 6564 2c20 6d61 736b 3d6d 6173 6b29  pred, mask=mask)
+00004a80: 272c 0a20 2020 2020 2020 2020 2020 205d  ',.            ]
+00004a90: 0a20 2020 2020 2020 2064 6d2e 6665 5f67  .        dm.fe_g
+00004aa0: 6f28 6e61 6d65 5f6c 6973 742c 2076 6572  o(name_list, ver
+00004ab0: 626f 7365 203d 2046 616c 7365 290a 2020  bose = False).  
+00004ac0: 2020 2020 2020 636f 6c73 203d 2064 6d2e        cols = dm.
+00004ad0: 6e61 6d65 5f6c 6973 745f 325f 636f 6c73  name_list_2_cols
+00004ae0: 286e 616d 655f 6c69 7374 290a 2020 2020  (name_list).    
+00004af0: 2020 2020 6466 5f69 6320 3d20 646d 2e67      df_ic = dm.g
+00004b00: 6574 5f63 6f6c 735f 7061 6e64 6173 2863  et_cols_pandas(c
+00004b10: 6f6c 732c 2064 665f 6e61 6d65 203d 2027  ols, df_name = '
+00004b20: 5430 2e74 6964 2729 0a20 2020 2020 2020  T0.tid').       
+00004b30: 2064 6d2e 6472 6f70 286e 616d 655f 6c69   dm.drop(name_li
+00004b40: 7374 2c20 7665 7262 6f73 6520 3d20 4661  st, verbose = Fa
+00004b50: 6c73 6529 0a20 2020 2020 2020 2072 6574  lse).        ret
+00004b60: 7572 6e20 6466 5f69 630a 0a20 2020 2064  urn df_ic..    d
+00004b70: 665f 6964 203d 2072 7a2e 7574 696c 2e6e  f_id = rz.util.n
+00004b80: 7079 2e67 6574 5f64 665f 6964 5f61 6c6c  py.get_df_id_all
+00004b90: 285b 7261 6e67 6528 7829 2066 6f72 2078  ([range(x) for x
+00004ba0: 2069 6e20 6d61 736b 5f74 6573 745f 7261   in mask_test_ra
+00004bb0: 772e 7368 6170 655d 2c20 636f 6c73 5f69  w.shape], cols_i
+00004bc0: 6420 3d20 5b27 7469 6427 2c20 2769 6427  d = ['tid', 'id'
+00004bd0: 5d29 0a20 2020 2064 6d20 3d20 727a 2e44  ]).    dm = rz.D
+00004be0: 6174 614d 6173 7465 7228 6466 5f69 6429  ataMaster(df_id)
+00004bf0: 0a20 2020 2064 6d2e 7365 745f 6d61 736b  .    dm.set_mask
+00004c00: 286d 6173 6b5f 7465 7374 5f72 6177 2e72  (mask_test_raw.r
+00004c10: 6573 6861 7065 282d 3129 2c20 276d 6173  eshape(-1), 'mas
+00004c20: 6b27 290a 2020 2020 646d 2e73 6574 5f62  k').    dm.set_b
+00004c30: 795f 636f 6c28 276c 6162 656c 272c 2079  y_col('label', y
+00004c40: 5f74 6573 745f 7261 772e 7265 7368 6170  _test_raw.reshap
+00004c50: 6528 2d31 2929 0a0a 2020 2020 6466 5f69  e(-1))..    df_i
+00004c60: 6320 3d20 6765 745f 6466 5f69 6328 646d  c = get_df_ic(dm
+00004c70: 2c20 795f 7072 6564 2923 2e6d 6561 6e28  , y_pred)#.mean(
+00004c80: 6178 6973 203d 2030 290a 2020 2020 7201  axis = 0).    r.
+00004c90: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
+00004ca0: 0000 7202 0000 00da 0763 616c 635f 6963  ..r......calc_ic
+00004cb0: e401 0000 7302 0000 0000 0172 1200 0000  ....s......r....
+00004cc0: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
+00004cd0: 0001 0000 0043 0000 0073 0400 0000 6401  .....C...s....d.
+00004ce0: 5300 2902 4e75 4f14 0000 0a69 6d70 6f72  S.).NuO....impor
+00004cf0: 7420 6f73 0a6f 732e 6368 6469 7228 272e  t os.os.chdir('.
+00004d00: 2e2f 2e2e 2f27 290a 7072 696e 7428 6627  ./../').print(f'
+00004d10: 5b2b 5d20 6377 6420 3d20 7b6f 732e 6765  [+] cwd = {os.ge
+00004d20: 7463 7764 2829 7d2c 205f 5f66 696c 655f  tcwd()}, __file_
+00004d30: 5f20 3d20 7b5f 5f66 696c 655f 5f20 6966  _ = {__file__ if
+00004d40: 2022 5f5f 6669 6c65 5f5f 2220 696e 2076   "__file__" in v
+00004d50: 6172 7328 2920 656c 7365 204e 6f6e 657d  ars() else None}
+00004d60: 2729 0a0a 696d 706f 7274 2073 7973 0a73  ')..import sys.s
+00004d70: 7973 2e70 6174 682e 696e 7365 7274 2830  ys.path.insert(0
+00004d80: 2c20 6f73 2e70 6174 682e 6162 7370 6174  , os.path.abspat
+00004d90: 6828 272e 2f27 2929 0a69 6d70 6f72 7420  h('./')).import 
+00004da0: 6c69 6768 7467 626d 2061 7320 6c67 623b  lightgbm as lgb;
+00004db0: 2070 7269 6e74 286c 6762 2e5f 5f76 6572   print(lgb.__ver
+00004dc0: 7369 6f6e 5f5f 2c20 6c67 622e 5f5f 6669  sion__, lgb.__fi
+00004dd0: 6c65 5f5f 290a 2320 7379 732e 7061 7468  le__).# sys.path
+00004de0: 2e69 6e73 6572 7428 302c 2027 2f55 7365  .insert(0, '/Use
+00004df0: 7273 2f72 756e 6e69 6e67 7a2f 7072 6f6a  rs/runningz/proj
+00004e00: 6563 742f 7275 6e6e 696e 677a 2f27 290a  ect/runningz/').
+00004e10: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+00004e20: 6e70 0a69 6d70 6f72 7420 7061 6e64 6173  np.import pandas
+00004e30: 2061 7320 7064 0a69 6d70 6f72 7420 7275   as pd.import ru
+00004e40: 6e6e 696e 677a 2061 7320 727a 0a66 726f  nningz as rz.fro
+00004e50: 6d20 7275 6e6e 696e 677a 2e75 7469 6c2e  m runningz.util.
+00004e60: 636c 7373 2069 6d70 6f72 7420 6765 745f  clss import get_
+00004e70: 7375 6263 6c61 7373 5f62 795f 6e61 6d65  subclass_by_name
+00004e80: 0a66 726f 6d20 7275 6e6e 696e 677a 2e66  .from runningz.f
+00004e90: 652e 7072 6570 6172 655f 6461 7461 2e62  e.prepare_data.b
+00004ea0: 6173 6963 5f64 6174 6120 696d 706f 7274  asic_data import
+00004eb0: 202a 0a66 726f 6d20 7275 6e6e 696e 677a   *.from runningz
+00004ec0: 2e66 652e 7574 696c 2e75 7469 6c20 696d  .fe.util.util im
+00004ed0: 706f 7274 2073 7562 7361 6d70 6c65 2c20  port subsample, 
+00004ee0: 6765 745f 7472 6169 6e5f 7661 6c69 642c  get_train_valid,
+00004ef0: 2067 6574 5f64 665f 6963 0a66 726f 6d20   get_df_ic.from 
+00004f00: 7275 6e6e 696e 677a 2e6d 6f64 656c 2e74  runningz.model.t
+00004f10: 7265 6520 696d 706f 7274 204c 4742 4d6f  ree import LGBMo
+00004f20: 6465 6c20 6173 204d 6f64 656c 0a66 726f  del as Model.fro
+00004f30: 6d20 7275 6e6e 696e 677a 2e75 7469 6c2e  m runningz.util.
+00004f40: 7574 696c 2069 6d70 6f72 7420 6d79 5f70  util import my_p
+00004f50: 7269 6e74 2061 7320 7072 696e 740a 6672  rint as print.fr
+00004f60: 6f6d 2072 756e 6e69 6e67 7a2e 7574 696c  om runningz.util
+00004f70: 2e75 7469 6c20 696d 706f 7274 2064 6963  .util import dic
+00004f80: 745f 325f 7374 720a 434f 4e53 542e 4d59  t_2_str.CONST.MY
+00004f90: 5f50 5249 4e54 203d 2046 616c 7365 0a72  _PRINT = False.r
+00004fa0: 7a2e 5449 4d45 5228 290a 0a23 2070 6174  z.TIMER()..# pat
+00004fb0: 685f 6469 6374 203d 2027 2f55 7365 7273  h_dict = '/Users
+00004fc0: 2f72 756e 6e69 6e67 7a2f 7072 6f6a 6563  /runningz/projec
+00004fd0: 742f 7275 6e6e 696e 677a 2f72 756e 6e69  t/runningz/runni
+00004fe0: 6e67 7a2f 6665 2f5f 6361 6368 655f 2f32  ngz/fe/_cache_/2
+00004ff0: 3032 3330 3732 392f 4445 4255 475f 3230  0230729/DEBUG_20
+00005000: 3233 3037 3239 5f31 3630 3033 325f 302e  230729_160032_0.
+00005010: 3233 3331 5f31 3531 2e64 6963 7427 0a23  2331_151.dict'.#
+00005020: 2070 6174 685f 6461 7461 203d 2027 2f55   path_data = '/U
+00005030: 7365 7273 2f72 756e 6e69 6e67 7a2f 7072  sers/runningz/pr
+00005040: 6f6a 6563 742f 7275 6e6e 696e 677a 2f72  oject/runningz/r
+00005050: 756e 6e69 6e67 7a2f 6665 2f5f 6361 6368  unningz/fe/_cach
+00005060: 655f 2f32 3032 3330 3732 392f 4445 4255  e_/20230729/DEBU
+00005070: 472e 6461 7461 5f63 6f6e 6669 6727 0a0a  G.data_config'..
+00005080: 7061 7468 5f64 6963 7420 3d20 272f 686f  path_dict = '/ho
+00005090: 6d65 2f72 782f 7072 6f6a 6563 742f 7275  me/rx/project/ru
+000050a0: 6e6e 696e 677a 2f66 652f 5f63 6163 6865  nningz/fe/_cache
+000050b0: 5f2f 3230 3233 3037 3239 2f44 4542 5547  _/20230729/DEBUG
+000050c0: 5f32 3032 3330 3733 305f 3039 3437 3435  _20230730_094745
+000050d0: 5f30 2e32 3635 335f 3433 372e 6469 6374  _0.2653_437.dict
+000050e0: 270a 7061 7468 5f64 6174 6120 3d20 272f  '.path_data = '/
+000050f0: 686f 6d65 2f72 782f 7072 6f6a 6563 742f  home/rx/project/
+00005100: 7275 6e6e 696e 677a 2f66 652f 5f63 6163  runningz/fe/_cac
+00005110: 6865 5f2f 3230 3233 3037 3239 2f44 4542  he_/20230729/DEB
+00005120: 5547 2e64 6174 615f 636f 6e66 6967 270a  UG.data_config'.
+00005130: 7061 7468 5f64 6963 745f 6f74 6865 7220  path_dict_other 
+00005140: 3d20 5b0a 2020 2020 272f 686f 6d65 2f72  = [.    '/home/r
+00005150: 782f 7072 6f6a 6563 742f 7275 6e6e 696e  x/project/runnin
+00005160: 677a 2f66 652f 5f63 6163 6865 5f2f 3230  gz/fe/_cache_/20
+00005170: 3233 3037 3330 2f6f 7065 6e5f 305f 315f  230730/open_0_1_
+00005180: 3230 3233 3037 3330 5f31 3532 3730 375f  20230730_152707_
+00005190: 302e 3330 3836 5f33 3038 2e64 6963 7427  0.3086_308.dict'
+000051a0: 2c0a 2020 2020 272f 686f 6d65 2f72 782f  ,.    '/home/rx/
+000051b0: 7072 6f6a 6563 742f 7275 6e6e 696e 677a  project/runningz
+000051c0: 2f66 652f 5f63 6163 6865 5f2f 3230 3233  /fe/_cache_/2023
+000051d0: 3037 3330 2f63 6c6f 7365 5f30 5f31 5f32  0730/close_0_1_2
+000051e0: 3032 3330 3733 305f 3231 3235 3033 5f30  0230730_212503_0
+000051f0: 2e30 3838 395f 3233 352e 6469 6374 272c  .0889_235.dict',
+00005200: 0a5d 0a66 6f72 2070 2069 6e20 7061 7468  .].for p in path
+00005210: 5f64 6963 745f 6f74 6865 723a 0a20 2020  _dict_other:.   
+00005220: 2072 7a2e 6c6f 6164 5f6a 736f 6e28 7029   rz.load_json(p)
+00005230: 0a0a 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ..# ------------
+00005240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005290: 2d2d 2d2d 2d2d 2d2d 0a63 6f6c 735f 6469  --------.cols_di
+000052a0: 6374 5f69 6e69 7420 3d20 727a 2e6c 6f61  ct_init = rz.loa
+000052b0: 645f 6a73 6f6e 2870 6174 685f 6469 6374  d_json(path_dict
+000052c0: 290a 6461 7461 5f63 6f6e 6669 6720 3d20  ).data_config = 
+000052d0: 727a 2e44 4943 5428 727a 2e6c 6f61 645f  rz.DICT(rz.load_
+000052e0: 6a73 6f6e 2870 6174 685f 6461 7461 2929  json(path_data))
+000052f0: 0a0a 2320 6461 7461 5f63 6f6e 6669 675b  ..# data_config[
+00005300: 2764 6174 655f 6469 6374 275d 5b27 616c  'date_dict']['al
+00005310: 6c27 5d5b 305d 2020 203d 2032 3031 3030  l'][0]   = 20100
+00005320: 3130 310a 2320 6461 7461 5f63 6f6e 6669  101.# data_confi
+00005330: 675b 2764 6174 655f 6469 6374 275d 5b27  g['date_dict']['
+00005340: 7472 6169 6e27 5d5b 305d 203d 2032 3031  train'][0] = 201
+00005350: 3030 3130 310a 2320 6461 7461 5f63 6f6e  00101.# data_con
+00005360: 6669 675b 2764 6174 655f 6469 6374 275d  fig['date_dict']
+00005370: 5b27 6869 7374 275d 5b30 5d20 3d20 3230  ['hist'][0] = 20
+00005380: 3130 3031 3031 0a64 6174 655f 6469 6374  100101.date_dict
+00005390: 203d 207b 0a20 2020 2027 616c 6c27 3a20   = {.    'all': 
+000053a0: 2020 2020 5b32 3031 3730 3130 312c 2032      [20170101, 2
+000053b0: 3031 3931 3233 315d 2c0a 2020 2020 2768  0191231],.    'h
+000053c0: 6973 7427 3a20 2020 205b 3230 3137 3031  ist':    [201701
+000053d0: 3031 2c20 3230 3138 3132 3331 5d2c 0a20  01, 20181231],. 
+000053e0: 2020 2027 7472 6169 6e27 3a20 2020 5b32     'train':   [2
+000053f0: 3031 3730 3130 312c 2032 3031 3831 3233  0170101, 2018123
+00005400: 315d 2c0a 2020 2020 2774 6573 7427 3a20  1],.    'test': 
+00005410: 2020 205b 3230 3139 3031 3031 2c20 3230     [20190101, 20
+00005420: 3139 3132 3331 5d2c 2023 20e4 bf9d e795  191231], # .....
+00005430: 99e6 b6a8 e8b7 8ce5 819c e592 8c6e 616e  .............nan
+00005440: e79a 840a 2020 2020 2776 616c 6964 273a  ....    'valid':
+00005450: 2020 205b 3230 3139 3031 3031 2c20 3230     [20190101, 20
+00005460: 3139 3132 3331 5d2c 2023 2076 616c 6964  191231], # valid
+00005470: e698 afe5 8ebb e68e 89e6 b6a8 e8b7 8ce5  ................
+00005480: 819c e592 8c6e 616e e79a 840a 2020 2020  .....nan....    
+00005490: 2776 616c 6964 5f31 273a 205b 3230 3139  'valid_1': [2019
+000054a0: 3031 3031 2c20 3230 3139 3036 3331 5d2c  0101, 20190631],
+000054b0: 2023 2076 616c 6964 e698 afe5 8ebb e68e   # valid........
+000054c0: 89e6 b6a8 e8b7 8ce5 819c e592 8c6e 616e  .............nan
+000054d0: e79a 840a 2020 2020 2776 616c 6964 5f32  ....    'valid_2
+000054e0: 273a 205b 3230 3139 3037 3031 2c20 3230  ': [20190701, 20
+000054f0: 3139 3132 3331 5d2c 2023 2076 616c 6964  191231], # valid
+00005500: e698 afe5 8ebb e68e 89e6 b6a8 e8b7 8ce5  ................
+00005510: 819c e592 8c6e 616e e79a 840a 7d0a 666f  .....nan....}.fo
+00005520: 7220 6b65 7920 696e 2064 6174 655f 6469  r key in date_di
+00005530: 6374 3a0a 2020 2020 6461 7465 5f64 6963  ct:.    date_dic
+00005540: 745b 6b65 795d 203d 205b 696e 7428 7829  t[key] = [int(x)
+00005550: 2066 6f72 2078 2069 6e20 286e 702e 6172   for x in (np.ar
+00005560: 7261 7928 6461 7465 5f64 6963 745b 6b65  ray(date_dict[ke
+00005570: 795d 2920 2b20 3030 3030 3029 5d0a 6461  y]) + 00000)].da
+00005580: 7461 5f63 6f6e 6669 675b 2764 6174 655f  ta_config['date_
+00005590: 6469 6374 275d 203d 2064 6174 655f 6469  dict'] = date_di
+000055a0: 6374 0a70 7269 6e74 2864 6963 745f 325f  ct.print(dict_2_
+000055b0: 7374 7228 6461 7461 5f63 6f6e 6669 6729  str(data_config)
+000055c0: 290a 0a0a 636f 6c5f 6964 203d 2063 6f6c  )...col_id = col
+000055d0: 735f 6469 6374 5f69 6e69 745b 2763 6f6c  s_dict_init['col
+000055e0: 5f69 6427 5d0a 636f 6c5f 6c61 6265 6c20  _id'].col_label 
+000055f0: 3d20 636f 6c73 5f64 6963 745f 696e 6974  = cols_dict_init
+00005600: 5b27 636f 6c5f 6c61 6265 6c27 5d0a 636f  ['col_label'].co
+00005610: 6c5f 7469 6420 3d20 636f 6c73 5f64 6963  l_tid = cols_dic
+00005620: 745f 696e 6974 5b27 636f 6c5f 7469 6427  t_init['col_tid'
+00005630: 5d0a 636f 6c73 5f74 6964 203d 2063 6f6c  ].cols_tid = col
+00005640: 735f 6469 6374 5f69 6e69 745b 2763 6f6c  s_dict_init['col
+00005650: 735f 7469 6427 5d0a 636f 6c73 5f66 6561  s_tid'].cols_fea
+00005660: 203d 2063 6f6c 735f 6469 6374 5f69 6e69   = cols_dict_ini
+00005670: 745b 2763 6f6c 735f 6665 6127 5d0a 636f  t['cols_fea'].co
+00005680: 6c73 5f6e 6f74 203d 2020 636f 6c73 5f64  ls_not =  cols_d
+00005690: 6963 745f 696e 6974 5b27 636f 6c73 5f6e  ict_init['cols_n
+000056a0: 6f74 275d 202b 2063 6f6c 735f 6469 6374  ot'] + cols_dict
+000056b0: 5f69 6e69 745b 2763 6f6c 735f 6c61 6265  _init['cols_labe
+000056c0: 6c27 5d20 2b20 5b63 6f6c 5f74 6964 2c20  l'] + [col_tid, 
+000056d0: 636f 6c5f 6c61 6265 6c5d 202b 2063 6f6c  col_label] + col
+000056e0: 735f 7469 640a 7072 696e 7428 636f 6c5f  s_tid.print(col_
+000056f0: 6964 2c20 636f 6c5f 6c61 6265 6c2c 2063  id, col_label, c
+00005700: 6f6c 5f74 6964 2c20 636f 6c73 5f74 6964  ol_tid, cols_tid
+00005710: 290a 0a70 7269 6e74 2827 5b69 6e69 745d  )..print('[init]
+00005720: 203c 2d2d 2d2d 2d2d 2d2d 2d2d 2072 6561   <---------- rea
+00005730: 645f 6461 7461 2020 2d2d 2d2d 2d2d 2d2d  d_data  --------
+00005740: 2d3e 2027 290a 646d 203d 2067 6574 5f73  -> ').dm = get_s
+00005750: 7562 636c 6173 735f 6279 5f6e 616d 6528  ubclass_by_name(
+00005760: 4261 7365 4461 7461 2c20 6461 7461 5f63  BaseData, data_c
+00005770: 6f6e 6669 672e 6461 7461 5f72 6561 6465  onfig.data_reade
+00005780: 7229 2829 2e6c 6f61 6428 6461 7461 5f63  r)().load(data_c
+00005790: 6f6e 6669 6729 0a70 7269 6e74 2866 275b  onfig).print(f'[
+000057a0: 2b5d 2064 6d2e 7368 6170 6528 2920 3d20  +] dm.shape() = 
+000057b0: 7b64 6d2e 7368 6170 6528 297d 2729 0a69  {dm.shape()}').i
+000057c0: 6620 4661 6c73 653a 0a20 2020 2070 7269  f False:.    pri
+000057d0: 6e74 2827 5b69 6e69 745d 203c 2d2d 2d2d  nt('[init] <----
+000057e0: 2d2d 2d2d 2d2d 2073 7562 7361 6d70 6c65  ------ subsample
+000057f0: 2020 2d2d 2d2d 2d2d 2d2d 2d3e 2027 290a    ---------> ').
+00005800: 2020 2020 7375 6273 616d 706c 6528 646d      subsample(dm
+00005810: 2c20 7063 7420 3d20 302e 3129 0a20 2020  , pct = 0.1).   
+00005820: 2070 7269 6e74 2866 275b 2b5d 2064 6d2e   print(f'[+] dm.
+00005830: 7368 6170 6528 2920 3d20 7b64 6d2e 7368  shape() = {dm.sh
+00005840: 6170 6528 297d 2729 0a20 2020 200a 7072  ape()}').    .pr
+00005850: 696e 7428 275b 696e 6974 5d20 3c2d 2d2d  int('[init] <---
+00005860: 2d2d 2d2d 2d2d 2d20 6665 5f67 6f20 2d2d  ------- fe_go --
+00005870: 2d2d 2d2d 2d2d 2d2d 3e27 290a 646d 2e66  -------->').dm.f
+00005880: 655f 676f 2863 6f6c 735f 6469 6374 5f69  e_go(cols_dict_i
+00005890: 6e69 745b 276e 616d 655f 6c69 7374 5f62  nit['name_list_b
+000058a0: 6173 6963 275d 2920 0a64 6d2e 6665 5f67  asic']) .dm.fe_g
+000058b0: 6f28 636f 6c73 5f64 6963 745f 696e 6974  o(cols_dict_init
+000058c0: 5b27 636f 6c73 5f66 6561 275d 290a 0a66  ['cols_fea'])..f
+000058d0: 6f72 2070 692c 2070 6174 6820 696e 2065  or pi, path in e
+000058e0: 6e75 6d65 7261 7465 2870 6174 685f 6469  numerate(path_di
+000058f0: 6374 5f6f 7468 6572 293a 0a20 2020 2070  ct_other):.    p
+00005900: 7269 6e74 2866 275b 696e 6974 5d20 3c2d  rint(f'[init] <-
+00005910: 2d2d 2d2d 2d2d 2d2d 2d20 6665 5f67 6f5f  --------- fe_go_
+00005920: 7b70 697d 202d 2d2d 2d2d 2d2d 2d2d 2d2d  {pi} -----------
+00005930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005940: 2d2d 2d3e 2729 0a20 2020 2064 6963 745f  --->').    dict_
+00005950: 6f74 6865 7220 3d20 727a 2e6c 6f61 645f  other = rz.load_
+00005960: 6a73 6f6e 2870 6174 6829 0a20 2020 2063  json(path).    c
+00005970: 6f6c 735f 6e6f 7420 2b3d 2020 6469 6374  ols_not +=  dict
+00005980: 5f6f 7468 6572 5b27 636f 6c73 5f6e 6f74  _other['cols_not
+00005990: 275d 202b 2064 6963 745f 6f74 6865 725b  '] + dict_other[
+000059a0: 2763 6f6c 735f 6c61 6265 6c27 5d0a 2020  'cols_label'].  
+000059b0: 2020 646d 2e66 655f 676f 2864 6963 745f    dm.fe_go(dict_
+000059c0: 6f74 6865 725b 276e 616d 655f 6c69 7374  other['name_list
+000059d0: 5f62 6173 6963 275d 2920 0a20 2020 2064  _basic']) .    d
+000059e0: 6d2e 6665 5f67 6f28 6469 6374 5f6f 7468  m.fe_go(dict_oth
+000059f0: 6572 5b27 636f 6c73 5f66 6561 275d 290a  er['cols_fea']).
+00005a00: 0a23 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .# -------------
+00005a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a60: 2d2d 2d2d 2d2d 2d0a 7072 696e 7428 275b  -------.print('[
+00005a70: 696e 6974 5d20 3c2d 2d2d 2d2d 2d2d 2d2d  init] <---------
+00005a80: 2d20 6765 745f 6461 7461 2020 2d2d 2d2d  - get_data  ----
+00005a90: 2d2d 2d2d 2d2d 3e27 290a 636f 6c73 203d  ------>').cols =
+00005aa0: 205b 7820 666f 7220 7820 696e 2064 6d2e   [x for x in dm.
+00005ab0: 6865 6164 2829 2e63 6f6c 756d 6e73 2069  head().columns i
+00005ac0: 6620 7820 6e6f 7420 696e 2063 6f6c 735f  f x not in cols_
+00005ad0: 6e6f 745d 0a63 6f6c 735f 6665 6120 3d20  not].cols_fea = 
+00005ae0: 646d 2e63 6f6c 735f 6973 5f6e 756d 6265  dm.cols_is_numbe
+00005af0: 7228 636f 6c73 290a 636f 6c73 5f66 6561  r(cols).cols_fea
+00005b00: 203d 205b 7820 666f 7220 7820 696e 2063   = [x for x in c
+00005b10: 6f6c 735f 6665 6120 6966 2072 7a2e 4461  ols_fea if rz.Da
+00005b20: 7461 4d61 7374 6572 2829 2e6e 616d 6572  taMaster().namer
+00005b30: 2e67 6574 5f64 6565 7028 7829 203c 3d20  .get_deep(x) <= 
+00005b40: 375d 0a63 6f6c 735f 6665 6120 3d20 5b78  7].cols_fea = [x
+00005b50: 2066 6f72 2078 2069 6e20 636f 6c73 5f66   for x in cols_f
+00005b60: 6561 2069 6620 727a 2e44 6174 614d 6173  ea if rz.DataMas
+00005b70: 7465 7228 292e 6e61 6d65 722e 6765 745f  ter().namer.get_
+00005b80: 7769 6e64 6f77 2878 2920 3c3d 2031 3530  window(x) <= 150
+00005b90: 5d0a 636f 6c73 5f66 6561 5f64 6565 7020  ].cols_fea_deep 
+00005ba0: 3d20 5b72 7a2e 4461 7461 4d61 7374 6572  = [rz.DataMaster
+00005bb0: 2829 2e6e 616d 6572 2e67 6574 5f64 6565  ().namer.get_dee
+00005bc0: 7028 7829 2066 6f72 2078 2069 6e20 636f  p(x) for x in co
+00005bd0: 6c73 5f66 6561 5d0a 7072 696e 7428 6627  ls_fea].print(f'
+00005be0: 5b2b 5d20 6465 6570 5f76 6320 3d20 0a7b  [+] deep_vc = .{
+00005bf0: 7064 2e53 6572 6965 7328 636f 6c73 5f66  pd.Series(cols_f
+00005c00: 6561 5f64 6565 7029 2e76 616c 7565 5f63  ea_deep).value_c
+00005c10: 6f75 6e74 7328 292e 736f 7274 5f69 6e64  ounts().sort_ind
+00005c20: 6578 2829 2e74 6f5f 7374 7269 6e67 2829  ex().to_string()
+00005c30: 7d27 290a 636f 6c73 5f66 6561 5f77 696e  }').cols_fea_win
+00005c40: 646f 7720 3d20 5b72 7a2e 4461 7461 4d61  dow = [rz.DataMa
+00005c50: 7374 6572 2829 2e6e 616d 6572 2e67 6574  ster().namer.get
+00005c60: 5f77 696e 646f 7728 7829 2066 6f72 2078  _window(x) for x
+00005c70: 2069 6e20 636f 6c73 5f66 6561 5d0a 7072   in cols_fea].pr
+00005c80: 696e 7428 6627 5b2b 5d20 7769 6e64 6f77  int(f'[+] window
+00005c90: 5f76 6320 3d20 0a7b 7064 2e53 6572 6965  _vc = .{pd.Serie
+00005ca0: 7328 636f 6c73 5f66 6561 5f77 696e 646f  s(cols_fea_windo
+00005cb0: 7729 2e76 616c 7565 5f63 6f75 6e74 7328  w).value_counts(
+00005cc0: 292e 736f 7274 5f69 6e64 6578 2829 2e74  ).sort_index().t
+00005cd0: 6f5f 7374 7269 6e67 2829 7d27 290a 585f  o_string()}').X_
+00005ce0: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
+00005cf0: 585f 7661 6c69 642c 2079 5f76 616c 6964  X_valid, y_valid
+00005d00: 203d 2067 6574 5f74 7261 696e 5f76 616c   = get_train_val
+00005d10: 6964 2864 6d2c 2063 6f6c 735f 6665 612c  id(dm, cols_fea,
+00005d20: 2063 6f6c 5f6c 6162 656c 2c20 6e5f 6a6f   col_label, n_jo
+00005d30: 6273 203d 2034 290a 0a70 7269 6e74 2827  bs = 4)..print('
+00005d40: 5b69 6e69 745d 203c 2d2d 2d2d 2d2d 2d2d  [init] <--------
+00005d50: 2d2d 206d 6f64 656c 202d 2d2d 2d2d 2d2d  -- model -------
+00005d60: 2d2d 2d3e 2729 0a70 6172 616d 7320 3d20  --->').params = 
+00005d70: 4d6f 6465 6c2e 6765 745f 7061 7261 6d73  Model.get_params
+00005d80: 2827 7061 7261 6d73 5f32 2729 0a70 6172  ('params_2').par
+00005d90: 616d 735b 276e 5f65 7374 696d 6174 6f72  ams['n_estimator
+00005da0: 7327 5d20 3d20 3135 3030 0a70 7269 6e74  s'] = 1500.print
+00005db0: 2866 275b 2b5d 2070 6172 616d 7320 3d20  (f'[+] params = 
+00005dc0: 7b70 6172 616d 737d 2729 0a6d 6f64 656c  {params}').model
+00005dd0: 203d 204d 6f64 656c 2829 0a72 7a2e 5449   = Model().rz.TI
+00005de0: 4d45 5228 290a 6d6f 6465 6c2e 7472 6169  MER().model.trai
+00005df0: 6e28 7b27 585f 7472 6169 6e27 3a20 585f  n({'X_train': X_
+00005e00: 7472 6169 6e2c 2027 795f 7472 6169 6e27  train, 'y_train'
+00005e10: 3a20 795f 7472 6169 6e2c 200a 2020 2020  : y_train, .    
+00005e20: 2020 2020 2020 2020 2027 585f 7661 6c69           'X_vali
+00005e30: 6427 3a20 585f 7661 6c69 642c 2027 795f  d': X_valid, 'y_
+00005e40: 7661 6c69 6427 3a20 795f 7661 6c69 647d  valid': y_valid}
+00005e50: 2c20 0a20 2020 2020 2020 2020 2020 2070  , .            p
+00005e60: 6172 616d 7320 3d20 7b2a 2a70 6172 616d  arams = {**param
+00005e70: 737d 2c20 6b77 6172 6773 203d 207b 2776  s}, kwargs = {'v
+00005e80: 6572 626f 7365 273a 2035 307d 290a 727a  erbose': 50}).rz
+00005e90: 2e54 494d 4552 2829 0a64 665f 696d 7020  .TIMER().df_imp 
+00005ea0: 3d20 6d6f 6465 6c2e 6765 745f 6466 5f69  = model.get_df_i
+00005eb0: 6d70 2863 6f6c 735f 6665 612c 2070 6c6f  mp(cols_fea, plo
+00005ec0: 7420 3d20 5472 7565 2c20 6b20 3d20 3330  t = True, k = 30
+00005ed0: 290a 0a70 7269 6e74 2827 5b69 6e69 745d  )..print('[init]
+00005ee0: 203c 2d2d 2d2d 2d2d 2d2d 2d2d 2073 636f   <---------- sco
+00005ef0: 7265 202d 2d2d 2d2d 2d2d 2d2d 2d3e 2729  re ---------->')
+00005f00: 0a6d 6173 6b5f 6e61 6d65 203d 2027 7661  .mask_name = 'va
+00005f10: 6c69 6427 0a6d 6173 6b20 3d20 646d 2e6d  lid'.mask = dm.m
+00005f20: 6173 6b65 722e 6d61 736b 5f44 4943 545b  asker.mask_DICT[
+00005f30: 6d61 736b 5f6e 616d 655d 5b64 6d2e 6d61  mask_name][dm.ma
+00005f40: 736b 6572 2e69 6478 5f44 4943 545b 6d61  sker.idx_DICT[ma
+00005f50: 736b 5f6e 616d 655d 5d0a 646d 5f69 203d  sk_name]].dm_i =
+00005f60: 2072 7a2e 4461 7461 4d61 7374 6572 2864   rz.DataMaster(d
+00005f70: 6d2e 6765 745f 636f 6c73 5f70 616e 6461  m.get_cols_panda
+00005f80: 7328 5b63 6f6c 5f74 6964 2c20 636f 6c5f  s([col_tid, col_
+00005f90: 6c61 6265 6c5d 2c20 6d61 736b 5f6e 616d  label], mask_nam
+00005fa0: 6520 3d20 6d61 736b 5f6e 616d 6529 290a  e = mask_name)).
+00005fb0: 646d 5f69 2e73 6574 5f6d 6173 6b28 6d61  dm_i.set_mask(ma
+00005fc0: 736b 2c20 6d61 736b 5f6e 616d 6529 0a0a  sk, mask_name)..
+00005fd0: 795f 7072 6564 5f6c 6973 7420 3d20 4d6f  y_pred_list = Mo
+00005fe0: 6465 6c2e 6d6f 6465 6c5f 7072 6564 6963  del.model_predic
+00005ff0: 7428 6d6f 6465 6c2c 2058 5f76 616c 6964  t(model, X_valid
+00006000: 2c20 6b20 3d20 3130 3029 0a66 6f72 2069  , k = 100).for i
+00006010: 2c20 795f 7072 6564 2069 6e20 7a69 7028  , y_pred in zip(
+00006020: 2a79 5f70 7265 645f 6c69 7374 293a 0a20  *y_pred_list):. 
+00006030: 2020 2064 665f 6963 203d 2067 6574 5f64     df_ic = get_d
+00006040: 665f 6963 2864 6d5f 692c 2079 5f70 7265  f_ic(dm_i, y_pre
+00006050: 642c 2063 6f6c 5f74 6964 203d 2063 6f6c  d, col_tid = col
+00006060: 5f74 6964 2c20 6d61 736b 5f6e 616d 6520  _tid, mask_name 
+00006070: 3d20 6d61 736b 5f6e 616d 6529 0a20 2020  = mask_name).   
+00006080: 2073 5f69 6320 3d20 6466 5f69 632e 6d65   s_ic = df_ic.me
+00006090: 616e 2861 7869 7320 3d20 3029 0a20 2020  an(axis = 0).   
+000060a0: 2073 7472 5f73 636f 7265 203d 2027 2c20   str_score = ', 
+000060b0: 272e 6a6f 696e 2866 277b 6b7d 3d7b 763a  '.join(f'{k}={v:
+000060c0: 2e36 667d 2720 666f 7220 6b2c 2076 2069  .6f}' for k, v i
+000060d0: 6e20 735f 6963 2e74 6f5f 6469 6374 2829  n s_ic.to_dict()
+000060e0: 2e69 7465 6d73 2829 290a 2020 2020 7072  .items()).    pr
+000060f0: 696e 7428 6627 5b69 3d7b 693a 3033 647d  int(f'[i={i:03d}
+00006100: 5d20 7b73 7472 5f73 636f 7265 7d27 290a  ] {str_score}').
+00006110: 727a 2e54 494d 4552 2829 0a64 665f 6963  rz.TIMER().df_ic
+00006120: 2e74 6f5f 6373 7628 2764 665f 6963 2e63  .to_csv('df_ic.c
+00006130: 7376 2729 0a20 2020 2072 0100 0000 7201  sv').    r....r.
+00006140: 0000 0072 0100 0000 7201 0000 0072 0200  ...r....r....r..
+00006150: 0000 da0d 6d61 696e 5f70 6970 656c 696e  ....main_pipelin
+00006160: 65fd 0100 0073 0200 0000 0001 7213 0000  e....s......r...
+00006170: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+00006180: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+00006190: 0153 0029 024e 7a98 0a64 665f 6665 5f72  .S.).Nz..df_fe_r
+000061a0: 6570 6f72 7420 3d20 727a 2e63 6f72 652e  eport = rz.core.
+000061b0: 6572 2e6e 616d 6572 2e4e 616d 6572 2829  er.namer.Namer()
+000061c0: 2e67 6574 5f64 665f 6665 5f72 6570 6f72  .get_df_fe_repor
+000061d0: 7428 6e61 6d65 5f6c 6973 7429 0a76 635f  t(name_list).vc_
+000061e0: 6469 6374 203d 2072 7a2e 636f 7265 2e65  dict = rz.core.e
+000061f0: 722e 6e61 6d65 722e 4e61 6d65 7228 292e  r.namer.Namer().
+00006200: 7368 6f77 5f64 665f 6665 5f72 6570 6f72  show_df_fe_repor
+00006210: 7428 6466 5f66 655f 7265 706f 7274 2c20  t(df_fe_report, 
+00006220: 6b20 3d20 3130 2920 2020 200a 2020 2020  k = 10)    .    
+00006230: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
+00006240: 0100 0000 7202 0000 00da 0c64 665f 6665  ....r......df_fe
+00006250: 5f72 6570 6f72 7479 0200 0073 0200 0000  _reporty...s....
+00006260: 0001 7214 0000 0063 0000 0000 0000 0000  ..r....c........
+00006270: 0000 0000 0000 0000 0100 0000 4300 0000  ............C...
+00006280: 7304 0000 0064 0153 0029 024e 618e 0200  s....d.S.).Na...
+00006290: 000a 646d 3120 3d20 727a 2e6c 6f61 645f  ..dm1 = rz.load_
+000062a0: 646d 2827 2f68 6f6d 652f 7075 626c 6963  dm('/home/public
+000062b0: 2f64 6174 612f 6f75 7470 7574 2f32 3032  /data/output/202
+000062c0: 3430 3131 315f 7632 5f32 3839 5f6d 6c70  40111_v2_289_mlp
+000062d0: 2f46 452f 646d 2e72 7a27 290a 646d 3220  /FE/dm.rz').dm2 
+000062e0: 3d20 727a 2e6c 6f61 645f 646d 2827 2f68  = rz.load_dm('/h
+000062f0: 6f6d 652f 7075 626c 6963 2f64 6174 612f  ome/public/data/
+00006300: 6f75 7470 7574 2f32 3032 3430 3131 315f  output/20240111_
+00006310: 7632 5f32 3839 5f6d 6c70 5f64 6562 7567  v2_289_mlp_debug
+00006320: 2f46 452f 646d 2e72 7a27 290a 0a64 6174  /FE/dm.rz')..dat
+00006330: 655f 6465 6275 6720 3d20 3230 3234 3031  e_debug = 202401
+00006340: 3131 0a64 6d31 2e73 6574 5f6d 6173 6b28  11.dm1.set_mask(
+00006350: 646d 312e 6765 745f 636f 6c5f 6e75 6d70  dm1.get_col_nump
+00006360: 7928 2774 7261 6465 5f64 6174 6527 2920  y('trade_date') 
+00006370: 3d3d 2064 6174 655f 6465 6275 672c 2027  == date_debug, '
+00006380: 434d 5027 290a 646d 322e 7365 745f 6d61  CMP').dm2.set_ma
+00006390: 736b 2864 6d32 2e67 6574 5f63 6f6c 5f6e  sk(dm2.get_col_n
+000063a0: 756d 7079 2827 7472 6164 655f 6461 7465  umpy('trade_date
+000063b0: 2729 203d 3d20 6461 7465 5f64 6562 7567  ') == date_debug
+000063c0: 2c20 2743 4d50 2729 0a0a 666f 7220 6369  , 'CMP')..for ci
+000063d0: 2c20 636f 6c20 696e 2065 6e75 6d65 7261  , col in enumera
+000063e0: 7465 2874 7164 6d28 646d 312e 6865 6164  te(tqdm(dm1.head
+000063f0: 2829 2e63 6f6c 756d 6e73 2929 3a0a 2020  ().columns)):.  
+00006400: 2020 7331 203d 2064 6d31 2e67 6574 5f63    s1 = dm1.get_c
+00006410: 6f6c 5f70 616e 6461 7328 636f 6c2c 206d  ol_pandas(col, m
+00006420: 6173 6b5f 6e61 6d65 3d27 434d 5027 290a  ask_name='CMP').
+00006430: 2020 2020 7332 203d 2064 6d32 2e67 6574      s2 = dm2.get
+00006440: 5f63 6f6c 5f70 616e 6461 7328 636f 6c2c  _col_pandas(col,
+00006450: 206d 6173 6b5f 6e61 6d65 3d27 434d 5027   mask_name='CMP'
+00006460: 290a 2020 2020 636f 7272 2c20 6469 6666  ).    corr, diff
+00006470: 5f61 6273 2c20 6469 6666 5f63 6e74 203d  _abs, diff_cnt =
+00006480: 2063 6d70 5f32 7328 7331 2c20 7332 290a   cmp_2s(s1, s2).
+00006490: 2020 2020 6966 2064 6966 665f 6162 7320      if diff_abs 
+000064a0: 3e20 3165 2d36 3a0a 2020 2020 2020 2020  > 1e-6:.        
+000064b0: 7072 696e 7428 6627 5b7b 6369 3a30 3464  print(f'[{ci:04d
+000064c0: 7d5d 2063 6f72 7220 3d20 7b63 6f72 723a  }] corr = {corr:
+000064d0: 2e36 667d 2c20 6469 6666 5f61 6273 203d  .6f}, diff_abs =
+000064e0: 207b 6469 6666 5f61 6273 3a2e 3666 7d2c   {diff_abs:.6f},
+000064f0: 2064 6966 665f 636e 7420 3d20 7b64 6966   diff_cnt = {dif
+00006500: 665f 636e 747d 207c 207b 6474 7970 653a  f_cnt} | {dtype:
+00006510: 3c36 7d20 7c20 7b63 6f6c 7d27 290a 0a72  <6} | {col}')..r
+00006520: 0100 0000 7201 0000 0072 0100 0000 7201  ....r....r....r.
+00006530: 0000 0072 0200 0000 da06 6665 5f63 6d70  ...r......fe_cmp
+00006540: 7f02 0000 7302 0000 0000 0172 1500 0000  ....s......r....
+00006550: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
+00006560: 0001 0000 0043 0000 0073 0400 0000 6401  .....C...s....d.
+00006570: 5300 2902 4e61 3a02 0000 0a69 6d70 6f72  S.).Na:....impor
+00006580: 7420 7275 6e6e 696e 677a 2061 7320 727a  t runningz as rz
+00006590: 0a0a 4e2c 204d 203d 2031 3030 3030 2c20  ..N, M = 10000, 
+000065a0: 3130 0a23 204e 2c20 4d20 3d20 3130 3030  10.# N, M = 1000
+000065b0: 3030 3030 2c20 3130 3020 2320 3673 2066  0000, 100 # 6s f
+000065c0: 6f72 2066 6974 202b 2070 7265 6469 6374  or fit + predict
+000065d0: 0a58 203d 2072 7a2e 7574 696c 2e6e 7079  .X = rz.util.npy
+000065e0: 5f6e 756d 6261 2e6e 705f 7261 6e64 6f6d  _numba.np_random
+000065f0: 5f72 616e 646f 6d28 284e 2c20 4d29 290a  _random((N, M)).
+00006600: 7920 3d20 727a 2e75 7469 6c2e 6e70 795f  y = rz.util.npy_
+00006610: 6e75 6d62 612e 6e70 5f72 616e 646f 6d5f  numba.np_random_
+00006620: 7261 6e64 6f6d 284e 290a 0a23 2058 5b58  random(N)..# X[X
+00006630: 203c 2030 2e35 5d20 3d20 6e70 2e6e 616e   < 0.5] = np.nan
+00006640: 0a58 203d 2072 7a2e 7574 696c 2e6e 7079  .X = rz.util.npy
+00006650: 5f6e 756d 6261 2e6e 705f 7a73 636f 7265  _numba.np_zscore
+00006660: 2858 290a 5820 3d20 727a 2e75 7469 6c2e  (X).X = rz.util.
+00006670: 6e70 795f 6e75 6d62 612e 6e70 5f66 696c  npy_numba.np_fil
+00006680: 6c5f 765f 696e 706c 6163 6528 582c 2030  l_v_inplace(X, 0
+00006690: 290a 5820 3d20 727a 2e75 7469 6c2e 6e70  ).X = rz.util.np
+000066a0: 795f 6e75 6d62 612e 6e70 5f73 6574 5f6f  y_numba.np_set_o
+000066b0: 7264 6572 2858 290a 0a66 726f 6d20 736b  rder(X)..from sk
+000066c0: 6c65 6172 6e2e 6c69 6e65 6172 5f6d 6f64  learn.linear_mod
+000066d0: 656c 2069 6d70 6f72 7420 4c69 6e65 6172  el import Linear
+000066e0: 5265 6772 6573 7369 6f6e 0a72 6567 203d  Regression.reg =
+000066f0: 204c 696e 6561 7252 6567 7265 7373 696f   LinearRegressio
+00006700: 6e28 636f 7079 5f58 203d 2046 616c 7365  n(copy_X = False
+00006710: 2c20 6669 745f 696e 7465 7263 6570 7420  , fit_intercept 
+00006720: 3d20 4661 6c73 652c 206e 5f6a 6f62 7320  = False, n_jobs 
+00006730: 3d20 2d31 292e 6669 7428 582c 2079 2920  = -1).fit(X, y) 
+00006740: 0a79 5f70 7265 6420 3d20 7265 672e 7072  .y_pred = reg.pr
+00006750: 6564 6963 7428 5829 0a23 2070 7269 6e74  edict(X).# print
+00006760: 286e 702e 6172 7261 7928 5b6e 702e 636f  (np.array([np.co
+00006770: 7272 636f 6566 2879 202d 2079 5f70 7265  rrcoef(y - y_pre
+00006780: 642c 2058 5b3a 2c20 695d 295b 302c 2031  d, X[:, i])[0, 1
+00006790: 5d20 666f 7220 6920 696e 2072 616e 6765  ] for i in range
+000067a0: 2858 2e73 6861 7065 5b31 5d29 5d29 290a  (X.shape[1])])).
+000067b0: 2020 2020 7201 0000 0072 0100 0000 7201      r....r....r.
+000067c0: 0000 0072 0100 0000 7202 0000 00da 026c  ...r....r......l
+000067d0: 7291 0200 0073 0200 0000 0001 7216 0000  r....s......r...
+000067e0: 0063 0000 0000 0000 0000 0000 0000 0000  .c..............
+000067f0: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
+00006800: 0153 0029 024e 7a0b 0a20 2020 200a 0a20  .S.).Nz..    .. 
+00006810: 2020 2072 0100 0000 7201 0000 0072 0100     r....r....r..
+00006820: 0000 7201 0000 0072 0200 0000 da04 6c61  ..r....r......la
+00006830: 7273 a502 0000 7302 0000 0000 0172 1700  rs....s......r..
+00006840: 0000 6300 0000 0000 0000 0000 0000 0000  ..c.............
+00006850: 0000 0001 0000 0043 0000 0073 0400 0000  .......C...s....
+00006860: 6401 5300 2902 4e7a f40a 6672 6f6d 2073  d.S.).Nz..from s
+00006870: 6b6c 6561 726e 2e64 6174 6173 6574 7320  klearn.datasets 
+00006880: 696d 706f 7274 206d 616b 655f 7265 6772  import make_regr
+00006890: 6573 7369 6f6e 0a58 2c20 7920 3d20 6d61  ession.X, y = ma
+000068a0: 6b65 5f72 6567 7265 7373 696f 6e28 6e5f  ke_regression(n_
+000068b0: 7361 6d70 6c65 7320 3d20 3130 3030 302c  samples = 10000,
+000068c0: 206e 5f66 6561 7475 7265 7320 3d20 3130   n_features = 10
+000068d0: 302c 2072 616e 646f 6d5f 7374 6174 6520  0, random_state 
+000068e0: 3d20 3432 2c20 6e5f 696e 666f 726d 6174  = 42, n_informat
+000068f0: 6976 6520 3d20 3830 2c20 6e6f 6973 6520  ive = 80, noise 
+00006900: 3d20 3130 290a 5820 3d20 2858 202d 206e  = 10).X = (X - n
+00006910: 702e 6d65 616e 2858 2c20 6178 6973 203d  p.mean(X, axis =
+00006920: 2031 2c20 6b65 6570 6469 6d73 203d 2054   1, keepdims = T
+00006930: 7275 6529 2920 2f20 6e70 2e73 7464 2858  rue)) / np.std(X
+00006940: 2c20 6178 6973 203d 2031 2c20 6b65 6570  , axis = 1, keep
+00006950: 6469 6d73 203d 2054 7275 6529 0a72 0100  dims = True).r..
+00006960: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00006970: 0072 0200 0000 da0d 6765 745f 7465 7374  .r......get_test
+00006980: 5f64 6174 61ac 0200 0073 0200 0000 0001  _data....s......
+00006990: 7218 0000 0063 0000 0000 0000 0000 0000  r....c..........
+000069a0: 0000 0000 0000 0100 0000 4300 0000 7304  ..........C...s.
+000069b0: 0000 0064 0153 0029 024e 7a3e 0a20 2020  ...d.S.).Nz>.   
+000069c0: 2070 6c74 2e6d 696e 6f72 7469 636b 735f   plt.minorticks_
+000069d0: 6f6e 2829 0a20 2020 2070 6c74 2e67 7269  on().    plt.gri
+000069e0: 6428 5472 7565 2c20 7768 6963 683d 2762  d(True, which='b
+000069f0: 6f74 6827 290a 2020 2020 7201 0000 0072  oth').    r....r
+00006a00: 0100 0000 7201 0000 0072 0100 0000 7202  ....r....r....r.
+00006a10: 0000 00da 0470 6c6f 74b4 0200 0073 0200  .....plot....s..
+00006a20: 0000 0001 7219 0000 0063 0000 0000 0000  ....r....c......
+00006a30: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
+00006a40: 0000 7304 0000 0064 0153 0029 024e 611d  ..s....d.S.).Na.
+00006a50: 0100 000a 2020 2020 2320 2170 6970 2069  ....    # !pip i
+00006a60: 6e73 7461 6c6c 206d 6973 7369 6e67 6e6f  nstall missingno
+00006a70: 0a20 2020 2069 6d70 6f72 7420 6d69 7373  .    import miss
+00006a80: 696e 676e 6f20 6173 206d 736e 6f0a 2020  ingno as msno.  
+00006a90: 2020 2320 6d73 6e6f 2e6d 6174 7269 7828    # msno.matrix(
+00006aa0: 7472 6169 6e2e 7361 6d70 6c65 2831 3030  train.sample(100
+00006ab0: 3030 2929 0a20 2020 2023 206d 736e 6f2e  00)).    # msno.
+00006ac0: 6d61 7472 6978 2874 6573 742e 7361 6d70  matrix(test.samp
+00006ad0: 6c65 2831 3030 3030 2929 0a20 2020 2023  le(10000)).    #
+00006ae0: 206d 736e 6f2e 6261 7228 7472 6169 6e2e   msno.bar(train.
+00006af0: 7361 6d70 6c65 2831 3030 3030 2929 0a20  sample(10000)). 
+00006b00: 2020 2023 206d 736e 6f2e 6261 7228 7465     # msno.bar(te
+00006b10: 7374 2e73 616d 706c 6528 3130 3030 3029  st.sample(10000)
+00006b20: 290a 2020 2020 2320 6d73 6e6f 2e68 6561  ).    # msno.hea
+00006b30: 746d 6170 2874 7261 696e 2e73 616d 706c  tmap(train.sampl
+00006b40: 6528 3130 3030 3029 290a 2020 2020 2320  e(10000)).    # 
+00006b50: 6d73 6e6f 2e64 656e 6472 6f67 7261 6d28  msno.dendrogram(
+00006b60: 636f 6c6c 6973 696f 6e73 290a 2020 2020  collisions).    
+00006b70: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
+00006b80: 0100 0000 7202 0000 00da 0870 6c6f 745f  ....r......plot_
+00006b90: 6e61 6eba 0200 0073 0200 0000 0001 721a  nan....s......r.
+00006ba0: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
+00006bb0: 0000 0000 0100 0000 4300 0000 7304 0000  ........C...s...
+00006bc0: 0064 0153 0029 024e 7aa3 0a20 2020 2023  .d.S.).Nz..    #
+00006bd0: 2021 7069 7020 696e 7374 616c 6c20 7061   !pip install pa
+00006be0: 6e64 6173 5f70 726f 6669 6c69 6e67 0a20  ndas_profiling. 
+00006bf0: 2020 2069 6d70 6f72 7420 7061 6e64 6173     import pandas
+00006c00: 5f70 726f 6669 6c69 6e67 0a20 2020 2070  _profiling.    p
+00006c10: 6672 203d 2070 616e 6461 735f 7072 6f66  fr = pandas_prof
+00006c20: 696c 696e 672e 5072 6f66 696c 6552 6570  iling.ProfileRep
+00006c30: 6f72 7428 7472 6169 6e29 0a20 2020 2070  ort(train).    p
+00006c40: 726f 662e 746f 5f66 696c 6528 6f75 7470  rof.to_file(outp
+00006c50: 7574 5f66 696c 653d 2761 7574 6f5f 4544  ut_file='auto_ED
+00006c60: 412e 6874 6d6c 2729 0a20 2020 2072 0100  A.html').    r..
+00006c70: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00006c80: 0072 0200 0000 da08 706c 6f74 5f65 6461  .r......plot_eda
+00006c90: c602 0000 7302 0000 0000 0172 1b00 0000  ....s......r....
+00006ca0: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
+00006cb0: 0001 0000 0043 0000 0073 0400 0000 6401  .....C...s....d.
+00006cc0: 5300 2902 4e61 8207 0000 0a20 2020 2023  S.).Na.....    #
+00006cd0: 2066 756c 6c20 7363 7265 656e 2077 6964   full screen wid
+00006ce0: 7468 206f 6620 4a75 7079 7465 7220 6e6f  th of Jupyter no
+00006cf0: 7465 626f 6f6b 0a20 2020 2066 726f 6d20  tebook.    from 
+00006d00: 4950 7974 686f 6e2e 636f 7265 2e64 6973  IPython.core.dis
+00006d10: 706c 6179 2069 6d70 6f72 7420 6469 7370  play import disp
+00006d20: 6c61 792c 2048 544d 4c0a 2020 2020 6469  lay, HTML.    di
+00006d30: 7370 6c61 7928 4854 4d4c 2822 3c73 7479  splay(HTML("<sty
+00006d40: 6c65 3e2e 636f 6e74 6169 6e65 7220 7b20  le>.container { 
+00006d50: 7769 6474 683a 3130 3025 2021 696d 706f  width:100% !impo
+00006d60: 7274 616e 743b 207d 3c2f 7374 796c 653e  rtant; }</style>
+00006d70: 2229 2920 0a0a 2020 2020 696d 706f 7274  ")) ..    import
+00006d80: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
+00006d90: 6f74 2061 7320 706c 740a 2020 2020 696d  ot as plt.    im
+00006da0: 706f 7274 2073 6561 626f 726e 2061 7320  port seaborn as 
+00006db0: 736e 730a 2020 2020 696d 706f 7274 206e  sns.    import n
+00006dc0: 756d 7079 2061 7320 6e70 0a20 2020 2069  umpy as np.    i
+00006dd0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+00006de0: 7064 0a20 2020 206e 702e 7365 745f 7072  pd.    np.set_pr
+00006df0: 696e 746f 7074 696f 6e73 2873 7570 7072  intoptions(suppr
+00006e00: 6573 733d 5472 7565 290a 0a20 2020 2064  ess=True)..    d
+00006e10: 6566 2067 6574 5f65 7870 6563 745f 7363  ef get_expect_sc
+00006e20: 6f72 6528 782c 2061 203d 2031 2c20 6220  ore(x, a = 1, b 
+00006e30: 3d20 312c 2063 203d 2030 293a 0a20 2020  = 1, c = 0):.   
+00006e40: 2020 2020 2072 6574 7572 6e20 6120 2f20       return a / 
+00006e50: 2831 202b 2031 3020 2a2a 2028 2d31 202a  (1 + 10 ** (-1 *
+00006e60: 2020 7820 2f20 6229 2920 2b63 0a0a 2020    x / b)) +c..  
+00006e70: 2020 2320 6761 7020 746f 2077 696e 200a    # gap to win .
+00006e80: 2020 2020 7820 3d20 6e70 2e6c 696e 7370      x = np.linsp
+00006e90: 6163 6528 2d31 3230 302c 2031 3230 302c  ace(-1200, 1200,
+00006ea0: 2031 3031 290a 2020 2020 7920 3d20 6765   101).    y = ge
+00006eb0: 745f 6578 7065 6374 5f73 636f 7265 2878  t_expect_score(x
+00006ec0: 2c20 6220 3d20 3430 3029 0a20 2020 2070  , b = 400).    p
+00006ed0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+00006ee0: 653d 2831 302c 2035 2929 0a20 2020 2070  e=(10, 5)).    p
+00006ef0: 6c74 2e70 6c6f 7428 782c 2079 290a 2020  lt.plot(x, y).  
+00006f00: 2020 706c 742e 6d69 6e6f 7274 6963 6b73    plt.minorticks
+00006f10: 5f6f 6e28 290a 2020 2020 706c 742e 6772  _on().    plt.gr
+00006f20: 6964 2854 7275 652c 2077 6869 6368 203d  id(True, which =
+00006f30: 2027 626f 7468 2729 0a20 2020 2070 6c74   'both').    plt
+00006f40: 2e79 6c61 6265 6c28 2765 7870 6563 7420  .ylabel('expect 
+00006f50: 7363 6f72 6520 2527 2c20 2066 6f6e 7473  score %',  fonts
+00006f60: 697a 6520 3d20 3135 290a 2020 2020 706c  ize = 15).    pl
+00006f70: 742e 786c 6162 656c 2827 6761 7027 2c20  t.xlabel('gap', 
+00006f80: 666f 6e74 7369 7a65 203d 2031 3529 0a20  fontsize = 15). 
+00006f90: 2020 2070 6c74 2e73 686f 7728 290a 0a20     plt.show().. 
+00006fa0: 2020 2023 2077 5f73 636f 7265 0a20 2020     # w_score.   
+00006fb0: 2078 203d 206e 702e 6c69 6e73 7061 6365   x = np.linspace
+00006fc0: 2838 3030 2c20 3230 3030 2c20 3130 3129  (800, 2000, 101)
+00006fd0: 0a20 2020 2079 203d 2067 6574 5f65 7870  .    y = get_exp
+00006fe0: 6563 745f 7363 6f72 6528 2d28 7820 2d20  ect_score(-(x - 
+00006ff0: 3132 3030 292c 2061 203d 2033 322c 2062  1200), a = 32, b
+00007000: 203d 2034 3030 2c20 6320 3d20 3136 290a   = 400, c = 16).
+00007010: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+00007020: 6967 7369 7a65 3d28 3130 2c20 3529 290a  igsize=(10, 5)).
+00007030: 2020 2020 706c 742e 706c 6f74 2878 2c20      plt.plot(x, 
+00007040: 7929 0a20 2020 2070 6c74 2e6d 696e 6f72  y).    plt.minor
+00007050: 7469 636b 735f 6f6e 2829 0a20 2020 2070  ticks_on().    p
+00007060: 6c74 2e67 7269 6428 5472 7565 2c20 7768  lt.grid(True, wh
+00007070: 6963 6820 3d20 2762 6f74 6827 290a 2020  ich = 'both').  
+00007080: 2020 706c 742e 796c 6162 656c 2827 6b27    plt.ylabel('k'
+00007090: 2c20 2066 6f6e 7473 697a 6520 3d20 3135  ,  fontsize = 15
+000070a0: 290a 2020 2020 706c 742e 786c 6162 656c  ).    plt.xlabel
+000070b0: 2827 7363 6f72 6527 2c20 666f 6e74 7369  ('score', fontsi
+000070c0: 7a65 203d 2031 3529 0a20 2020 2070 6c74  ze = 15).    plt
+000070d0: 2e73 686f 7728 290a 0a20 2020 2023 2077  .show()..    # w
+000070e0: 5f67 6170 0a20 2020 2078 203d 206e 702e  _gap.    x = np.
+000070f0: 6c69 6e73 7061 6365 282d 3132 3030 2c20  linspace(-1200, 
+00007100: 3132 3030 2c20 3235 290a 2020 2020 7920  1200, 25).    y 
+00007110: 3d20 2831 3020 2a2a 2028 7820 2f20 3136  = (10 ** (x / 16
+00007120: 3030 2929 0a20 2020 2070 6c74 2e66 6967  00)).    plt.fig
+00007130: 7572 6528 6669 6773 697a 653d 2831 302c  ure(figsize=(10,
+00007140: 2035 2929 0a20 2020 2070 6c74 2e70 6c6f   5)).    plt.plo
+00007150: 7428 782c 2079 290a 2020 2020 706c 742e  t(x, y).    plt.
+00007160: 6d69 6e6f 7274 6963 6b73 5f6f 6e28 290a  minorticks_on().
+00007170: 2020 2020 706c 742e 6772 6964 2854 7275      plt.grid(Tru
+00007180: 652c 2077 6869 6368 203d 2027 626f 7468  e, which = 'both
+00007190: 2729 0a20 2020 2070 6c74 2e79 6c61 6265  ').    plt.ylabe
+000071a0: 6c28 276b 5f67 6170 272c 2020 666f 6e74  l('k_gap',  font
+000071b0: 7369 7a65 203d 2031 3529 0a20 2020 2070  size = 15).    p
+000071c0: 6c74 2e78 6c61 6265 6c28 2767 6170 272c  lt.xlabel('gap',
+000071d0: 2066 6f6e 7473 697a 6520 3d20 3135 290a   fontsize = 15).
+000071e0: 2020 2020 706c 742e 7368 6f77 2829 0a0a      plt.show()..
+000071f0: 2020 2020 2320 770a 2020 2020 7820 3d20      # w.    x = 
+00007200: 6e70 2e6c 696e 7370 6163 6528 3830 302c  np.linspace(800,
+00007210: 2032 3030 302c 2032 3529 0a20 2020 2079   2000, 25).    y
+00007220: 203d 206e 702e 6c69 6e73 7061 6365 2838   = np.linspace(8
+00007230: 3030 2c20 3230 3030 2c20 3235 295b 3a3a  00, 2000, 25)[::
+00007240: 2d31 5d0a 2020 2020 582c 2059 203d 206e  -1].    X, Y = n
+00007250: 702e 6d65 7368 6772 6964 2878 2c20 7929  p.meshgrid(x, y)
+00007260: 0a20 2020 2077 696a 203d 2031 3020 2a2a  .    wij = 10 **
+00007270: 2028 2859 202d 2058 2920 2f20 3132 3030   ((Y - X) / 1200
+00007280: 290a 2020 2020 7769 203d 2067 6574 5f65  ).    wi = get_e
+00007290: 7870 6563 745f 7363 6f72 6528 2d28 5820  xpect_score(-(X 
+000072a0: 2d20 3132 3030 292c 2061 203d 2033 322c  - 1200), a = 32,
+000072b0: 2062 203d 2034 3030 2c20 6320 3d20 3136   b = 400, c = 16
+000072c0: 290a 2020 2020 5a20 3d20 7769 6a20 2a20  ).    Z = wij * 
+000072d0: 7769 0a0a 2020 2020 662c 2061 7820 3d20  wi..    f, ax = 
+000072e0: 706c 742e 7375 6270 6c6f 7473 2866 6967  plt.subplots(fig
+000072f0: 7369 7a65 3d28 3330 2c20 3132 2929 0a20  size=(30, 12)). 
+00007300: 2020 2073 6e73 2e68 6561 746d 6170 285a     sns.heatmap(Z
+00007310: 2c20 6c69 6e65 7769 6474 6873 203d 2030  , linewidths = 0
+00007320: 2e35 2c20 6178 203d 2061 782c 2061 6e6e  .5, ax = ax, ann
+00007330: 6f74 203d 2054 7275 652c 2066 6d74 3d22  ot = True, fmt="
+00007340: 2e30 6622 293b 0a20 2020 2070 6c74 2e78  .0f");.    plt.x
+00007350: 7469 636b 7328 7469 636b 7320 3d20 6e70  ticks(ticks = np
+00007360: 2e61 7261 6e67 6528 6c65 6e28 7829 292c  .arange(len(x)),
+00007370: 206c 6162 656c 7320 3d20 6c69 7374 2878   labels = list(x
+00007380: 292c 2072 6f74 6174 696f 6e3d 2776 6572  ), rotation='ver
+00007390: 7469 6361 6c27 290a 2020 2020 706c 742e  tical').    plt.
+000073a0: 7974 6963 6b73 2874 6963 6b73 203d 206e  yticks(ticks = n
+000073b0: 702e 6172 616e 6765 286c 656e 2879 2929  p.arange(len(y))
+000073c0: 2c20 6c61 6265 6c73 203d 206c 6973 7428  , labels = list(
+000073d0: 7929 2c20 726f 7461 7469 6f6e 3d27 686f  y), rotation='ho
+000073e0: 7269 7a6f 6e74 616c 2729 0a20 2020 2070  rizontal').    p
+000073f0: 6c74 2e79 6c61 6265 6c28 276f 7468 6572  lt.ylabel('other
+00007400: 272c 2020 666f 6e74 7369 7a65 203d 2031  ',  fontsize = 1
+00007410: 3529 0a20 2020 2070 6c74 2e78 6c61 6265  5).    plt.xlabe
+00007420: 6c28 2773 656c 6627 2c20 666f 6e74 7369  l('self', fontsi
+00007430: 7a65 203d 2031 3529 0a20 2020 2070 6c74  ze = 15).    plt
+00007440: 2e73 686f 7728 290a 2020 2020 7201 0000  .show().    r...
+00007450: 0072 0100 0000 7201 0000 0072 0100 0000  .r....r....r....
+00007460: 7202 0000 00da 0770 6c6f 745f 706b ce02  r......plot_pk..
+00007470: 0000 7302 0000 0000 0172 1c00 0000 6300  ..s......r....c.
+00007480: 0000 0000 0000 0000 0000 0000 0000 0001  ................
+00007490: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
+000074a0: 2902 4e75 8a05 0000 0a20 2020 2069 6d70  ).Nu.....    imp
+000074b0: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+000074c0: 7970 6c6f 7420 6173 2070 6c74 0a20 2020  yplot as plt.   
+000074d0: 2069 6d70 6f72 7420 7365 6162 6f72 6e20   import seaborn 
+000074e0: 6173 2073 6e73 0a20 2020 2069 6d70 6f72  as sns.    impor
+000074f0: 7420 6e75 6d70 7920 6173 206e 700a 2020  t numpy as np.  
+00007500: 2020 696d 706f 7274 2070 616e 6461 7320    import pandas 
+00007510: 6173 2070 640a 0a20 2020 2078 203d 206e  as pd..    x = n
+00007520: 702e 6c69 6e73 7061 6365 2830 2c20 312c  p.linspace(0, 1,
+00007530: 2031 3031 290a 2020 2020 7920 3d20 5b31   101).    y = [1
+00007540: 202f 2028 302e 3520 2b20 302e 3520 2a20   / (0.5 + 0.5 * 
+00007550: 7869 2920 2a2a 2030 2e35 202d 2031 2066  xi) ** 0.5 - 1 f
+00007560: 6f72 2078 6920 696e 2078 5d0a 2020 2020  or xi in x].    
+00007570: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+00007580: 7a65 3d28 3130 2c20 3529 290a 2020 2020  ze=(10, 5)).    
+00007590: 706c 742e 706c 6f74 2878 2c20 7929 0a20  plt.plot(x, y). 
+000075a0: 2020 2070 6c74 2e6d 696e 6f72 7469 636b     plt.minortick
+000075b0: 735f 6f6e 2829 0a20 2020 2070 6c74 2e67  s_on().    plt.g
+000075c0: 7269 6428 5472 7565 2c20 7768 6963 6820  rid(True, which 
+000075d0: 3d20 2762 6f74 6827 290a 2020 2020 706c  = 'both').    pl
+000075e0: 742e 796c 6162 656c 2827 696d 7072 6f76  t.ylabel('improv
+000075f0: 656d 656e 7420 2527 2c20 2066 6f6e 7473  ement %',  fonts
+00007600: 697a 6520 3d20 3135 290a 2020 2020 706c  ize = 15).    pl
+00007610: 742e 786c 6162 656c 2827 636f 7272 272c  t.xlabel('corr',
+00007620: 2066 6f6e 7473 697a 6520 3d20 3135 290a   fontsize = 15).
+00007630: 2020 2020 706c 742e 7368 6f77 2829 0a0a      plt.show()..
+00007640: 0a20 2020 2069 6d70 6f72 7420 6d61 7470  .    import matp
+00007650: 6c6f 746c 6962 2e70 7970 6c6f 7420 6173  lotlib.pyplot as
+00007660: 2070 6c74 0a20 2020 2069 6d70 6f72 7420   plt.    import 
+00007670: 7365 6162 6f72 6e20 6173 2073 6e73 0a20  seaborn as sns. 
+00007680: 2020 2069 6d70 6f72 7420 6e75 6d70 7920     import numpy 
+00007690: 6173 206e 700a 2020 2020 696d 706f 7274  as np.    import
+000076a0: 2070 616e 6461 7320 6173 2070 640a 0a20   pandas as pd.. 
+000076b0: 2020 2023 20e7 9bb8 e585 b3e6 80a7 2c20     # ........., 
+000076c0: 307e 31e5 b8a6 e69d a5e7 9a84 e68f 90e5  0~1.............
+000076d0: 8d87 0a20 2020 2078 203d 206e 702e 6c69  ...    x = np.li
+000076e0: 6e73 7061 6365 2830 2c20 312c 2032 3129  nspace(0, 1, 21)
+000076f0: 0a20 2020 2069 6d70 726f 7665 6d65 6e74  .    improvement
+00007700: 203d 206e 702e 6172 7261 7928 5b31 202f   = np.array([1 /
+00007710: 2028 302e 3520 2b20 302e 3520 2a20 7869   (0.5 + 0.5 * xi
+00007720: 2920 2a2a 2030 2e35 202d 2031 2066 6f72  ) ** 0.5 - 1 for
+00007730: 2078 6920 696e 2078 5d29 0a0a 2020 2020   xi in x])..    
+00007740: 2320 e89e 8de5 9088 e5af b9e8 b1a1 e79a  # ..............
+00007750: 8449 430a 2020 2020 6963 203d 2030 2e30  .IC.    ic = 0.0
+00007760: 370a 2020 2020 6963 5f6c 6973 7420 3d20  7.    ic_list = 
+00007770: 6963 202b 206e 702e 6c69 6e73 7061 6365  ic + np.linspace
+00007780: 2830 2c20 3230 2c20 3231 2920 2f20 3165  (0, 20, 21) / 1e
+00007790: 3320 2d20 3165 2d32 0a20 2020 2069 635f  3 - 1e-2.    ic_
+000077a0: 6c69 7374 203d 2069 635f 6c69 7374 5b3a  list = ic_list[:
+000077b0: 3a2d 315d 0a0a 2020 2020 2320 e592 8ce6  :-1]..    # ....
+000077c0: af8f e4b8 80e4 b8aa 4943 e89e 8de5 9088  ........IC......
+000077d0: 2c20 e4b8 8de5 908c e79b b8e5 85b3 e680  , ..............
+000077e0: a72c 20e5 be97 e588 b0e8 9e8d e590 88e5  ., .............
+000077f0: 908e e79a 8449 430a 2020 2020 656e 5f6c  .....IC.    en_l
+00007800: 6973 7420 3d20 5b5d 0a20 2020 2066 6f72  ist = [].    for
+00007810: 2069 635f 6920 696e 2069 635f 6c69 7374   ic_i in ic_list
+00007820: 3a0a 2020 2020 2020 2020 656e 5f69 203d  :.        en_i =
+00007830: 2028 6963 202b 2069 635f 6929 202f 2032   (ic + ic_i) / 2
+00007840: 202a 2028 3120 2b20 696d 7072 6f76 656d   * (1 + improvem
+00007850: 656e 7429 0a20 2020 2020 2020 2065 6e5f  ent).        en_
+00007860: 6c69 7374 2e61 7070 656e 6428 656e 5f69  list.append(en_i
+00007870: 290a 2020 2020 615f 656e 203d 206e 702e  ).    a_en = np.
+00007880: 7673 7461 636b 2865 6e5f 6c69 7374 2920  vstack(en_list) 
+00007890: 2020 200a 0a20 2020 2066 2c20 6178 203d     ..    f, ax =
+000078a0: 2070 6c74 2e73 7562 706c 6f74 7328 6669   plt.subplots(fi
+000078b0: 6773 697a 653d 2832 302c 2031 3229 290a  gsize=(20, 12)).
+000078c0: 2020 2020 736e 732e 6865 6174 6d61 7028      sns.heatmap(
+000078d0: 615f 656e 2c20 6c69 6e65 7769 6474 6873  a_en, linewidths
+000078e0: 203d 2030 2e35 2c20 6178 203d 2061 782c   = 0.5, ax = ax,
+000078f0: 2061 6e6e 6f74 203d 2054 7275 652c 2066   annot = True, f
+00007900: 6d74 3d22 2e34 6622 293b 0a20 2020 2070  mt=".4f");.    p
+00007910: 6c74 2e78 7469 636b 7328 7469 636b 7320  lt.xticks(ticks 
+00007920: 3d20 6e70 2e61 7261 6e67 6528 3231 292c  = np.arange(21),
+00007930: 206c 6162 656c 7320 3d20 5b66 277b 693a   labels = [f'{i:
+00007940: 2e32 667d 2766 6f72 2069 2069 6e20 785d  .2f}'for i in x]
+00007950: 2c20 726f 7461 7469 6f6e 3d27 7665 7274  , rotation='vert
+00007960: 6963 616c 2729 0a20 2020 2070 6c74 2e79  ical').    plt.y
+00007970: 7469 636b 7328 7469 636b 7320 3d20 6e70  ticks(ticks = np
+00007980: 2e61 7261 6e67 6528 3231 292c 206c 6162  .arange(21), lab
+00007990: 656c 7320 3d20 5b66 277b 693a 2e34 667d  els = [f'{i:.4f}
+000079a0: 2766 6f72 2069 2069 6e20 6963 5f6c 6973  'for i in ic_lis
+000079b0: 745d 2c20 726f 7461 7469 6f6e 3d27 686f  t], rotation='ho
+000079c0: 7269 7a6f 6e74 616c 2729 0a20 2020 2070  rizontal').    p
+000079d0: 6c74 2e79 6c61 6265 6c28 276f 7468 6572  lt.ylabel('other
+000079e0: 2049 4320 3d20 272c 2020 666f 6e74 7369   IC = ',  fontsi
+000079f0: 7a65 203d 2031 3529 0a20 2020 2070 6c74  ze = 15).    plt
+00007a00: 2e78 6c61 6265 6c28 2763 6f72 7227 2c20  .xlabel('corr', 
+00007a10: 666f 6e74 7369 7a65 203d 2031 3529 0a20  fontsize = 15). 
+00007a20: 2020 2070 6c74 2e73 686f 7728 290a 2020     plt.show().  
+00007a30: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
+00007a40: 0072 0100 0000 7202 0000 00da 0d70 6c6f  .r....r......plo
+00007a50: 745f 656e 7365 6d62 6c65 0f03 0000 7302  t_ensemble....s.
+00007a60: 0000 0000 0172 1d00 0000 6300 0000 0000  .....r....c.....
+00007a70: 0000 0000 0000 0000 0000 0001 0000 0043  ...............C
+00007a80: 0000 0073 0400 0000 6401 5300 2902 4e75  ...s....d.S.).Nu
+00007a90: e201 0000 0a20 2020 2073 6e73 2e46 6163  .....    sns.Fac
+00007aa0: 6574 4772 6964 2874 7261 696e 2c20 6875  etGrid(train, hu
+00007ab0: 653d 2254 4152 4745 5422 2c20 7369 7a65  e="TARGET", size
+00007ac0: 3d36 2920 2020 2020 2020 2020 2e6d 6170  =6)         .map
+00007ad0: 2873 6e73 2e6b 6465 706c 6f74 2c20 2276  (sns.kdeplot, "v
+00007ae0: 6172 3336 2229 2020 2020 2020 2020 202e  ar36")         .
+00007af0: 6164 645f 6c65 6765 6e64 2829 0a20 2020  add_legend().   
+00007b00: 2020 2020 2070 6c74 2e74 6974 6c65 2827       plt.title('
+00007b10: 4966 2076 6172 3336 2069 7320 302c 312c  If var36 is 0,1,
+00007b20: 3220 6f72 2033 203d 3e20 6c65 7373 2075  2 or 3 => less u
+00007b30: 6e68 6170 7079 2063 7573 746f 6d65 7273  nhappy customers
+00007b40: 2729 3b0a 0a20 2020 2064 6620 3d20 7472  ');..    df = tr
+00007b50: 6169 6e2e 636f 7079 2829 0a20 2020 2076  ain.copy().    v
+00007b60: 6320 3d20 6466 5b27 635f 3027 5d2e 7661  c = df['c_0'].va
+00007b70: 6c75 655f 636f 756e 7473 2829 2e69 6c6f  lue_counts().ilo
+00007b80: 635b 3a31 305d 0a20 2020 2064 6620 3d20  c[:10].    df = 
+00007b90: 6466 5b64 665b 2763 5f30 275d 2e69 7369  df[df['c_0'].isi
+00007ba0: 6e28 7663 2e69 6e64 6578 295d 0a0a 2020  n(vc.index)]..  
+00007bb0: 2020 2320 e99a 94e5 a381 0a20 2020 2073    # .......    s
+00007bc0: 6e73 2e63 6f75 6e74 706c 6f74 2878 3d27  ns.countplot(x='
+00007bd0: 635f 3027 2c20 6875 653d 276c 6162 656c  c_0', hue='label
+00007be0: 272c 2064 6174 6120 3d20 6466 290a 0a20  ', data = df).. 
+00007bf0: 2020 2023 20e9 878d e58f a00a 2020 2020     # .......    
+00007c00: 736e 732e 4661 6365 7447 7269 6428 6466  sns.FacetGrid(df
+00007c10: 2c20 6875 653d 276c 6162 656c 272c 2073  , hue='label', s
+00007c20: 697a 653d 3429 2020 2020 202e 6d61 7028  ize=4)     .map(
+00007c30: 736e 732e 636f 756e 7470 6c6f 742c 2027  sns.countplot, '
+00007c40: 635f 3027 2c20 616c 7068 613d 302e 3729  c_0', alpha=0.7)
+00007c50: 2020 2020 202e 6164 645f 6c65 6765 6e64       .add_legend
+00007c60: 2829 0a20 2020 2070 6c74 2e73 686f 7728  ().    plt.show(
+00007c70: 290a 2020 2020 7201 0000 0072 0100 0000  ).    r....r....
+00007c80: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
+00007c90: 0870 6c6f 745f 6875 653f 0300 0073 0200  .plot_hue?...s..
+00007ca0: 0000 0001 721e 0000 0063 0000 0000 0000  ....r....c......
+00007cb0: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
+00007cc0: 0000 7304 0000 0064 0153 0029 024e 61b8  ..s....d.S.).Na.
+00007cd0: 0300 000a 2020 2020 7320 3d20 6466 5f70  ....    s = df_p
+00007ce0: 7265 645b 2779 5f70 7265 6427 5d5b 3a6b  red['y_pred'][:k
+00007cf0: 5d2e 636f 7079 2829 0a20 2020 2073 202f  ].copy().    s /
+00007d00: 3d20 732e 7375 6d28 290a 2020 2020 706c  = s.sum().    pl
+00007d10: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
+00007d20: 3d28 3230 2c33 2929 0a20 2020 2028 732e  =(20,3)).    (s.
+00007d30: 6375 6d73 756d 2829 202f 2073 2e73 756d  cumsum() / s.sum
+00007d40: 2829 292e 706c 6f74 2829 0a20 2020 2070  ()).plot().    p
+00007d50: 6c74 2e6d 696e 6f72 7469 636b 735f 6f6e  lt.minorticks_on
+00007d60: 2829 0a20 2020 2070 6c74 2e67 7269 6428  ().    plt.grid(
+00007d70: 5472 7565 2c20 7768 6963 683d 2762 6f74  True, which='bot
+00007d80: 6827 290a 2020 2020 706c 742e 7368 6f77  h').    plt.show
+00007d90: 2829 0a0a 2020 2020 706c 742e 6669 6775  ()..    plt.figu
+00007da0: 7265 2866 6967 7369 7a65 3d28 3230 2c33  re(figsize=(20,3
+00007db0: 2929 0a20 2020 2070 6c74 2e62 6172 286e  )).    plt.bar(n
+00007dc0: 702e 6172 616e 6765 286c 656e 2873 2929  p.arange(len(s))
+00007dd0: 2c20 7329 0a20 2020 2070 6c74 2e6d 696e  , s).    plt.min
+00007de0: 6f72 7469 636b 735f 6f6e 2829 0a20 2020  orticks_on().   
+00007df0: 2070 6c74 2e67 7269 6428 5472 7565 2c20   plt.grid(True, 
+00007e00: 7768 6963 683d 2762 6f74 6827 290a 2020  which='both').  
+00007e10: 2020 706c 742e 7874 6963 6b73 2874 6963    plt.xticks(tic
+00007e20: 6b73 203d 206e 702e 6172 616e 6765 286b  ks = np.arange(k
+00007e30: 292c 206c 6162 656c 7320 3d20 636f 6465  ), labels = code
+00007e40: 732c 2072 6f74 6174 696f 6e3d 2776 6572  s, rotation='ver
+00007e50: 7469 6361 6c27 290a 2020 2020 706c 742e  tical').    plt.
+00007e60: 7368 6f77 2829 0a0a 2020 2020 6465 6620  show()..    def 
+00007e70: 6466 5f62 6172 706c 6f74 2864 6629 3a0a  df_barplot(df):.
+00007e80: 2020 2020 2020 2020 2320 6466 2e70 6c6f          # df.plo
+00007e90: 7428 6b69 6e64 203d 2027 6261 7227 2c20  t(kind = 'bar', 
+00007ea0: 6669 6773 697a 653d 2832 302c 3429 293b  figsize=(20,4));
+00007eb0: 0a20 2020 2020 2020 2064 665f 706c 6f74  .        df_plot
+00007ec0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+00007ed0: 7b27 7827 3a20 6c69 7374 2864 662e 696e  {'x': list(df.in
+00007ee0: 6465 7829 202a 2064 662e 7368 6170 655b  dex) * df.shape[
+00007ef0: 315d 2c20 0a20 2020 2020 2020 2020 2020  1], .           
+00007f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f10: 2020 2020 2027 6875 6527 3a20 6e70 2e72       'hue': np.r
+00007f20: 6176 656c 285b 5b69 5d20 2a20 6466 2e73  avel([[i] * df.s
+00007f30: 6861 7065 5b30 5d20 666f 7220 6920 696e  hape[0] for i in
+00007f40: 2072 616e 6765 2864 662e 7368 6170 655b   range(df.shape[
+00007f50: 315d 295d 292c 0a20 2020 2020 2020 2020  1])]),.         
+00007f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f70: 2020 2020 2020 2027 7927 3a20 6466 2e54         'y': df.T
+00007f80: 2e76 616c 7565 732e 7261 7665 6c28 297d  .values.ravel()}
+00007f90: 290a 2020 2020 2020 2020 706c 742e 6669  ).        plt.fi
+00007fa0: 6775 7265 2866 6967 7369 7a65 3d28 3230  gure(figsize=(20
+00007fb0: 2c20 3329 290a 2020 2020 2020 2020 736e  , 3)).        sn
+00007fc0: 732e 6261 7270 6c6f 7428 7820 3d20 2778  s.barplot(x = 'x
+00007fd0: 272c 2079 203d 2027 7927 2c20 6875 6520  ', y = 'y', hue 
+00007fe0: 3d20 2768 7565 272c 2064 6174 6120 3d20  = 'hue', data = 
+00007ff0: 6466 5f70 6c6f 742c 2061 6c70 6861 203d  df_plot, alpha =
+00008000: 2030 2e38 290a 2020 2020 2020 2020 706c   0.8).        pl
+00008010: 742e 6c65 6765 6e64 2827 272c 2066 7261  t.legend('', fra
+00008020: 6d65 6f6e 203d 2046 616c 7365 290a 2020  meon = False).  
+00008030: 2020 2020 2020 2320 706c 742e 6d69 6e6f        # plt.mino
+00008040: 7274 6963 6b73 5f6f 6e28 290a 2020 2020  rticks_on().    
+00008050: 2020 2020 706c 742e 6772 6964 2854 7275      plt.grid(Tru
+00008060: 652c 2077 6869 6368 203d 2027 626f 7468  e, which = 'both
+00008070: 2729 0a20 2020 2020 2020 2070 6c74 2e73  ').        plt.s
+00008080: 686f 7728 293b 0a20 2020 2072 0100 0000  how();.    r....
+00008090: 7201 0000 0072 0100 0000 7201 0000 0072  r....r....r....r
+000080a0: 0200 0000 da08 706c 6f74 5f62 6172 5403  ......plot_barT.
+000080b0: 0000 7302 0000 0000 0172 1f00 0000 6300  ..s......r....c.
+000080c0: 0000 0000 0000 0000 0000 0000 0000 0001  ................
+000080d0: 0000 0043 0000 0073 0400 0000 6401 5300  ...C...s....d.S.
+000080e0: 2902 4e61 da05 0000 0a20 2020 2064 6566  ).Na.....    def
+000080f0: 2062 6f78 706c 6f74 2864 665f 6964 2c20   boxplot(df_id, 
+00008100: 636f 6c20 3d20 2779 5f74 7275 6527 293a  col = 'y_true'):
+00008110: 0a20 2020 2020 2020 2070 6c74 2e66 6967  .        plt.fig
+00008120: 7572 6528 6669 6773 697a 653d 2832 302c  ure(figsize=(20,
+00008130: 2032 2929 0a20 2020 2020 2020 2070 6c74   2)).        plt
+00008140: 2e74 6974 6c65 2866 275b 2b5d 207b 636f  .title(f'[+] {co
+00008150: 6c7d 2062 6f78 706c 6f74 2729 0a20 2020  l} boxplot').   
+00008160: 2020 2020 2070 6c74 2e62 6f78 706c 6f74       plt.boxplot
+00008170: 2864 665f 6964 5b63 6f6c 5d2c 2076 6572  (df_id[col], ver
+00008180: 7420 3d20 4661 6c73 6529 0a20 2020 2020  t = False).     
+00008190: 2020 2070 6c74 2e6d 696e 6f72 7469 636b     plt.minortick
+000081a0: 735f 6f6e 2829 0a20 2020 2020 2020 2070  s_on().        p
+000081b0: 6c74 2e67 7269 6428 5472 7565 2c20 7768  lt.grid(True, wh
+000081c0: 6963 683d 2762 6f74 6827 290a 2020 2020  ich='both').    
+000081d0: 2020 2020 706c 742e 7368 6f77 2829 0a20      plt.show(). 
+000081e0: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
+000081f0: 706c 6f74 2864 662c 2063 6f6c 203d 2027  plot(df, col = '
+00008200: 7265 7427 293a 0a20 2020 2020 2020 2064  ret'):.        d
+00008210: 6620 3d20 6466 2e63 6f70 7928 290a 2020  f = df.copy().  
+00008220: 2020 2020 2020 6466 2e69 6e64 6578 203d        df.index =
+00008230: 2064 662e 696e 6465 782e 6173 7479 7065   df.index.astype
+00008240: 2873 7472 290a 0a20 2020 2020 2020 2070  (str)..        p
+00008250: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+00008260: 653d 2832 302c 2033 2929 0a20 2020 2020  e=(20, 3)).     
+00008270: 2020 2064 665b 636f 6c5d 2e70 6c6f 7428     df[col].plot(
+00008280: 290a 2020 2020 2020 2020 785f 7469 636b  ).        x_tick
+00008290: 7320 3d20 6c69 7374 2872 616e 6765 286c  s = list(range(l
+000082a0: 656e 2864 6629 2929 0a20 2020 2020 2020  en(df))).       
+000082b0: 2078 5f6c 6162 656c 7320 3d20 6c69 7374   x_labels = list
+000082c0: 2864 662e 696e 6465 7829 0a20 2020 2020  (df.index).     
+000082d0: 2020 206b 203d 2035 0a20 2020 2020 2020     k = 5.       
+000082e0: 2078 5f74 6963 6b73 203d 205b 785f 7469   x_ticks = [x_ti
+000082f0: 636b 735b 695d 2066 6f72 2069 2069 6e20  cks[i] for i in 
+00008300: 7261 6e67 6528 6c65 6e28 785f 7469 636b  range(len(x_tick
+00008310: 7329 2920 6966 2069 2025 206b 203d 3d20  s)) if i % k == 
+00008320: 305d 0a20 2020 2020 2020 2078 5f6c 6162  0].        x_lab
+00008330: 656c 7320 3d20 5b78 5f6c 6162 656c 735b  els = [x_labels[
+00008340: 695d 2066 6f72 2069 2069 6e20 7261 6e67  i] for i in rang
+00008350: 6528 6c65 6e28 785f 6c61 6265 6c73 2929  e(len(x_labels))
+00008360: 2069 6620 6920 2520 6b20 3d3d 2030 5d0a   if i % k == 0].
+00008370: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
+00008380: 6b73 2874 6963 6b73 203d 2078 5f74 6963  ks(ticks = x_tic
+00008390: 6b73 2c20 6c61 6265 6c73 203d 2078 5f6c  ks, labels = x_l
+000083a0: 6162 656c 732c 2072 6f74 6174 696f 6e20  abels, rotation 
+000083b0: 3d20 2776 6572 7469 6361 6c27 2c20 666f  = 'vertical', fo
+000083c0: 6e74 7369 7a65 3d38 290a 0a20 2020 2020  ntsize=8)..     
+000083d0: 2020 2070 6c74 2e6d 696e 6f72 7469 636b     plt.minortick
+000083e0: 735f 6f6e 2829 0a20 2020 2020 2020 2023  s_on().        #
+000083f0: 2070 6c74 2e67 7269 6428 5472 7565 2c20   plt.grid(True, 
+00008400: 7768 6963 683d 2762 6f74 6827 290a 2020  which='both').  
+00008410: 2020 2020 2020 706c 742e 6772 6964 2854        plt.grid(T
+00008420: 7275 6529 0a20 2020 2020 2020 2070 6c74  rue).        plt
+00008430: 2e73 686f 7728 290a 0a20 2020 2064 6566  .show()..    def
+00008440: 2070 6c6f 745f 6e75 6d28 782c 2070 6c6f   plot_num(x, plo
+00008450: 745f 6f75 746c 6965 7220 3d20 5472 7565  t_outlier = True
+00008460: 293a 0a20 2020 2020 2020 2070 7269 6e74  ):.        print
+00008470: 2827 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ('==============
+00008480: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00008490: 2070 6c6f 745f 6e75 6d20 3d3d 3d3d 3d3d   plot_num ======
+000084a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000084b0: 3d3d 3d3d 3d3d 3d3d 2729 0a20 2020 2020  ========').     
+000084c0: 2020 2070 7269 6e74 2827 6e20 3d20 7b7d     print('n = {}
+000084d0: 2c20 6e75 6c6c 203d 207b 7d27 2e66 6f72  , null = {}'.for
+000084e0: 6d61 7428 6c65 6e28 7829 2c20 7064 2e69  mat(len(x), pd.i
+000084f0: 736e 756c 6c28 7829 2e73 756d 2829 2929  snull(x).sum()))
+00008500: 0a20 2020 2020 2020 2064 6573 203d 2078  .        des = x
+00008510: 2e64 6573 6372 6962 6528 290a 2020 2020  .describe().    
+00008520: 2020 2020 6465 735b 276e 756e 6971 7565      des['nunique
+00008530: 275d 203d 2078 2e6e 756e 6971 7565 2829  '] = x.nunique()
+00008540: 0a20 2020 2020 2020 2070 7269 6e74 2864  .        print(d
+00008550: 6573 290a 2020 2020 2020 2020 0a20 2020  es).        .   
+00008560: 2020 2020 2023 2064 6973 740a 2020 2020       # dist.    
+00008570: 2020 2020 736e 732e 6469 7374 706c 6f74      sns.distplot
+00008580: 2878 293b 0a20 2020 2020 2020 2070 6c74  (x);.        plt
+00008590: 2e73 686f 7728 293b 0a0a 2020 2020 2020  .show();..      
+000085a0: 2020 2320 626f 780a 2020 2020 2020 2020    # box.        
+000085b0: 6120 3d20 706c 742e 626f 7870 6c6f 7428  a = plt.boxplot(
+000085c0: 782c 2073 796d 3d27 2b27 293b 0a20 2020  x, sym='+');.   
+000085d0: 2020 2020 2070 6c74 2e73 686f 7728 293b       plt.show();
+000085e0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+000085f0: 2020 7072 696e 7428 273d 3d3d 3d3d 3d3d    print('=======
+00008600: 3d3d 3d20 6f75 746c 6965 7220 3d3d 3d3d  === outlier ====
+00008610: 3d3d 3d3d 3d3d 2729 0a20 2020 2020 2020  ======').       
+00008620: 2078 5f6f 7574 6c69 6572 203d 2070 642e   x_outlier = pd.
+00008630: 5365 7269 6573 2828 615b 2766 6c69 6572  Series((a['flier
+00008640: 7327 5d5b 305d 2e67 6574 5f64 6174 6128  s'][0].get_data(
+00008650: 295b 315d 2929 0a20 2020 2020 2020 2069  )[1])).        i
+00008660: 6620 6c65 6e28 785f 6f75 746c 6965 7229  f len(x_outlier)
+00008670: 2021 3d20 3020 616e 6420 706c 6f74 5f6f   != 0 and plot_o
+00008680: 7574 6c69 6572 3a0a 2020 2020 2020 2020  utlier:.        
+00008690: 2020 2020 706c 6f74 5f6e 756d 2878 5f6f      plot_num(x_o
+000086a0: 7574 6c69 6572 2c20 706c 6f74 5f6f 7574  utlier, plot_out
+000086b0: 6c69 6572 203d 2046 616c 7365 290a 2020  lier = False).  
+000086c0: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
+000086d0: 0072 0100 0000 7202 0000 00da 0c70 6c6f  .r....r......plo
+000086e0: 745f 626f 7870 6c6f 7472 0300 0073 0200  t_boxplotr...s..
+000086f0: 0000 0001 7220 0000 0063 0000 0000 0000  ....r ...c......
+00008700: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
+00008710: 0000 7304 0000 0064 0153 0029 024e 617a  ..s....d.S.).Naz
+00008720: 0600 000a 2020 2020 6465 6620 706c 6f74  ....    def plot
+00008730: 5f69 5f69 2863 692c 2063 6a2c 206b 203d  _i_i(ci, cj, k =
+00008740: 2032 3029 3a0a 2020 2020 2020 2020 666f   20):.        fo
+00008750: 7220 692c 2063 6f6c 2069 6e20 656e 756d  r i, col in enum
+00008760: 6572 6174 6528 636f 6c73 5b63 693a 2063  erate(cols[ci: c
+00008770: 6a5d 293a 0a20 2020 2020 2020 2020 2020  j]):.           
+00008780: 2073 312c 2073 3220 3d20 6466 315b 636f   s1, s2 = df1[co
+00008790: 6c5d 2c20 6466 325b 636f 6c5d 0a20 2020  l], df2[col].   
+000087a0: 2020 2020 2020 2020 2073 312e 6e61 6d65           s1.name
+000087b0: 203d 2073 322e 6e61 6d65 203d 2069 0a20   = s2.name = i. 
+000087c0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+000087d0: 2520 6b20 3d3d 2030 3a20 706c 742e 6669  % k == 0: plt.fi
+000087e0: 6775 7265 2866 6967 7369 7a65 3d28 3430  gure(figsize=(40
+000087f0: 2c20 3229 290a 2020 2020 2020 2020 2020  , 2)).          
+00008800: 2020 706c 742e 7375 6270 6c6f 7428 312c    plt.subplot(1,
+00008810: 206b 2c20 2869 2025 206b 202b 2031 2929   k, (i % k + 1))
+00008820: 0a20 2020 2020 2020 2020 2020 2073 6e73  .            sns
+00008830: 2e64 6973 7470 6c6f 7428 7331 2c20 6c61  .distplot(s1, la
+00008840: 6265 6c20 3d20 2731 2729 0a20 2020 2020  bel = '1').     
+00008850: 2020 2020 2020 2073 6e73 2e64 6973 7470         sns.distp
+00008860: 6c6f 7428 7332 2c20 6c61 6265 6c20 3d20  lot(s2, label = 
+00008870: 2732 2729 3b0a 2020 2020 2020 2020 2020  '2');.          
+00008880: 2020 706c 742e 6c65 6765 6e64 2829 0a20    plt.legend(). 
+00008890: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
+000088a0: 202b 2031 2920 2520 6b20 3d3d 2030 3a20   + 1) % k == 0: 
+000088b0: 706c 742e 7368 6f77 2829 0a0a 2020 2020  plt.show()..    
+000088c0: 6465 6620 7375 6270 6c6f 745f 6b64 655f  def subplot_kde_
+000088d0: 6875 6528 7472 6169 6e2c 2074 7261 696e  hue(train, train
+000088e0: 5f6c 6162 656c 2c20 636f 6c5f 6665 612c  _label, col_fea,
+000088f0: 206e 203d 2032 3029 3a0a 2020 2020 2020   n = 20):.      
+00008900: 2020 6e5f 636f 6c20 3d20 340a 2020 2020    n_col = 4.    
+00008910: 2020 2020 6e5f 726f 7720 3d20 696e 7428      n_row = int(
+00008920: 6e70 2e63 6569 6c28 312e 3020 2a20 6e20  np.ceil(1.0 * n 
+00008930: 2f20 6e5f 636f 6c29 290a 0a20 2020 2020  / n_col))..     
+00008940: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
+00008950: 6c74 2e73 7562 706c 6f74 7328 6e5f 726f  lt.subplots(n_ro
+00008960: 772c 206e 5f63 6f6c 2c20 6669 6773 697a  w, n_col, figsiz
+00008970: 653d 2831 362c 2038 292c 2073 6861 7265  e=(16, 8), share
+00008980: 7820 3d20 5472 7565 290a 2020 2020 2020  x = True).      
+00008990: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000089a0: 286e 293a 0a20 2020 2020 2020 2020 2020  (n):.           
+000089b0: 2063 6f6c 203d 2063 6f6c 5f66 6561 5b69   col = col_fea[i
+000089c0: 5d0a 2020 2020 2020 2020 2020 2020 695f  ].            i_
+000089d0: 726f 772c 2069 5f63 6f6c 203d 2069 6e74  row, i_col = int
+000089e0: 2869 202f 206e 5f63 6f6c 292c 2069 2025  (i / n_col), i %
+000089f0: 206e 5f63 6f6c 0a20 2020 2020 2020 2020   n_col.         
+00008a00: 2020 2061 785f 6920 3d20 6178 6573 5b69     ax_i = axes[i
+00008a10: 5f72 6f77 2c20 695f 636f 6c5d 0a20 2020  _row, i_col].   
+00008a20: 2020 2020 2020 2020 2073 6e73 2e6b 6465           sns.kde
+00008a30: 706c 6f74 2874 7261 696e 5b74 7261 696e  plot(train[train
+00008a40: 5f6c 6162 656c 203d 3d20 315d 5b63 6f6c  _label == 1][col
+00008a50: 5d2c 2061 783d 6178 5f69 290a 2020 2020  ], ax=ax_i).    
+00008a60: 2020 2020 2020 2020 736e 732e 6b64 6570          sns.kdep
+00008a70: 6c6f 7428 7472 6169 6e5b 7472 6169 6e5f  lot(train[train_
+00008a80: 6c61 6265 6c20 3d3d 2030 5d5b 636f 6c5d  label == 0][col]
+00008a90: 2c20 6178 3d61 785f 6929 0a20 2020 2020  , ax=ax_i).     
+00008aa0: 2020 2020 2020 2061 785f 692e 6c65 6765         ax_i.lege
+00008ab0: 6e64 285b 2731 272c 2730 275d 290a 2020  nd(['1','0']).  
+00008ac0: 2020 2020 2020 2020 2020 6178 5f69 2e73            ax_i.s
+00008ad0: 6574 5f74 6974 6c65 2863 6f6c 290a 2020  et_title(col).  
+00008ae0: 2020 2020 2020 2020 2020 6178 5f69 2e67            ax_i.g
+00008af0: 7269 6428 290a 0a20 2020 2020 2020 2070  rid()..        p
+00008b00: 6c74 2e73 686f 7728 290a 2020 2020 7375  lt.show().    su
+00008b10: 6270 6c6f 745f 6b64 655f 6875 6528 7472  bplot_kde_hue(tr
+00008b20: 6169 6e32 2c20 7472 6169 6e5f 6c61 6265  ain2, train_labe
+00008b30: 6c2c 2064 665f 696d 705f 6469 7374 5b3a  l, df_imp_dist[:
+00008b40: 3230 5d5b 2766 6561 275d 290a 0a20 2020  20]['fea'])..   
+00008b50: 2064 6566 2073 7562 706c 6f74 5f70 6c6f   def subplot_plo
+00008b60: 745f 7663 2874 7261 696e 2c20 7465 7374  t_vc(train, test
+00008b70: 2c20 636f 6c5f 6665 612c 206e 203d 2032  , col_fea, n = 2
+00008b80: 3029 3a0a 2020 2020 2020 2020 6e5f 636f  0):.        n_co
+00008b90: 6c20 3d20 340a 2020 2020 2020 2020 6e5f  l = 4.        n_
+00008ba0: 726f 7720 3d20 696e 7428 6e70 2e63 6569  row = int(np.cei
+00008bb0: 6c28 312e 3020 2a20 6e20 2f20 6e5f 636f  l(1.0 * n / n_co
+00008bc0: 6c29 290a 0a20 2020 2020 2020 2066 6967  l))..        fig
+00008bd0: 2c20 6178 6573 203d 2070 6c74 2e73 7562  , axes = plt.sub
+00008be0: 706c 6f74 7328 6e5f 726f 772c 206e 5f63  plots(n_row, n_c
+00008bf0: 6f6c 2c20 6669 6773 697a 653d 2831 362c  ol, figsize=(16,
+00008c00: 2038 292c 2073 6861 7265 7820 3d20 5472   8), sharex = Tr
+00008c10: 7565 290a 2020 2020 2020 2020 666f 7220  ue).        for 
+00008c20: 6920 696e 2072 616e 6765 286e 293a 0a20  i in range(n):. 
+00008c30: 2020 2020 2020 2020 2020 2063 6f6c 203d             col =
+00008c40: 2063 6f6c 5f66 6561 5b69 5d0a 2020 2020   col_fea[i].    
+00008c50: 2020 2020 2020 2020 695f 726f 772c 2069          i_row, i
+00008c60: 5f63 6f6c 203d 2069 6e74 2869 202f 206e  _col = int(i / n
+00008c70: 5f63 6f6c 292c 2069 2025 206e 5f63 6f6c  _col), i % n_col
+00008c80: 0a20 2020 2020 2020 2020 2020 2061 785f  .            ax_
+00008c90: 6920 3d20 6178 6573 5b69 5f72 6f77 2c20  i = axes[i_row, 
+00008ca0: 695f 636f 6c5d 0a20 2020 2020 2020 2020  i_col].         
+00008cb0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00008cc0: 6178 5f69 2e70 6c6f 7428 7472 6169 6e5b  ax_i.plot(train[
+00008cd0: 636f 6c5d 2e76 616c 7565 5f63 6f75 6e74  col].value_count
+00008ce0: 7328 292e 7661 6c75 6573 290a 2020 2020  s().values).    
+00008cf0: 2020 2020 2020 2020 6178 5f69 2e70 6c6f          ax_i.plo
+00008d00: 7428 7465 7374 5b63 6f6c 5d2e 7661 6c75  t(test[col].valu
+00008d10: 655f 636f 756e 7473 2829 2e76 616c 7565  e_counts().value
+00008d20: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
+00008d30: 785f 692e 6c65 6765 6e64 285b 2774 7261  x_i.legend(['tra
+00008d40: 696e 272c 2774 6573 7427 5d29 0a20 2020  in','test']).   
+00008d50: 2020 2020 2020 2020 2061 785f 692e 7365           ax_i.se
+00008d60: 745f 7469 746c 6528 636f 6c29 0a20 2020  t_title(col).   
+00008d70: 2020 2020 2020 2020 2061 785f 692e 6772           ax_i.gr
+00008d80: 6964 2829 0a20 2020 2020 2020 2070 6c74  id().        plt
+00008d90: 2e73 686f 7728 293b 0a20 2020 2072 0100  .show();.    r..
+00008da0: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00008db0: 0072 0200 0000 da0c 706c 6f74 5f73 7562  .r......plot_sub
+00008dc0: 706c 6f74 a303 0000 7302 0000 0000 0172  plot....s......r
+00008dd0: 2100 0000 6300 0000 0000 0000 0000 0000  !...c...........
+00008de0: 0000 0000 0001 0000 0043 0000 0073 0400  .........C...s..
+00008df0: 0000 6401 5300 2902 4e61 ab02 0000 0a20  ..d.S.).Na..... 
+00008e00: 2020 2064 6566 2070 6c6f 745f 7265 6728     def plot_reg(
+00008e10: 6466 2c20 636f 6c2c 2063 6f6c 5f6c 6162  df, col, col_lab
+00008e20: 656c 293a 0a20 2020 2020 2020 2066 6967  el):.        fig
+00008e30: 2c20 6178 203d 2070 6c74 2e73 7562 706c  , ax = plt.subpl
+00008e40: 6f74 7328 312c 2031 2c20 6669 6773 697a  ots(1, 1, figsiz
+00008e50: 653d 2832 302c 2032 2929 0a20 2020 2020  e=(20, 2)).     
+00008e60: 2020 2073 6e73 2e72 6567 706c 6f74 280a     sns.regplot(.
+00008e70: 2020 2020 2020 2020 2020 2020 7820 3d20              x = 
+00008e80: 636f 6c2c 0a20 2020 2020 2020 2020 2020  col,.           
+00008e90: 2079 203d 2063 6f6c 5f6c 6162 656c 2c0a   y = col_label,.
+00008ea0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00008eb0: 203d 2064 662c 0a20 2020 2020 2020 2020   = df,.         
+00008ec0: 2020 2023 206c 6f67 6973 7469 6320 3d20     # logistic = 
+00008ed0: 5472 7565 2069 6620 6466 5b63 6f6c 5f6c  True if df[col_l
+00008ee0: 6162 656c 5d2e 6e75 6e69 7175 6528 2920  abel].nunique() 
+00008ef0: 3d3d 2032 2065 6c73 6520 4661 6c73 652c  == 2 else False,
+00008f00: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+00008f10: 6973 7469 6320 3d20 4661 6c73 652c 0a20  istic = False,. 
+00008f20: 2020 2020 2020 2020 2020 206e 5f62 6f6f             n_boo
+00008f30: 7420 3d20 3130 302c 0a20 2020 2020 2020  t = 100,.       
+00008f40: 2020 2020 2079 5f6a 6974 7465 7220 3d20       y_jitter = 
+00008f50: 2e31 2c0a 2020 2020 2020 2020 2020 2020  .1,.            
+00008f60: 7363 6174 7465 725f 6b77 7320 3d20 7b27  scatter_kws = {'
+00008f70: 616c 7068 6127 3a30 2e31 2c20 2765 6467  alpha':0.1, 'edg
+00008f80: 6563 6f6c 6f72 273a 276e 6f6e 6527 7d2c  ecolor':'none'},
+00008f90: 0a20 2020 2020 2020 2020 2020 2061 7820  .            ax 
+00008fa0: 3d20 6178 0a20 2020 2020 2020 2029 0a20  = ax.        ). 
+00008fb0: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+00008fc0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+00008fd0: 2020 2069 6620 6466 5b63 6f6c 5f6c 6162     if df[col_lab
+00008fe0: 656c 5d2e 6e75 6e69 7175 6528 2920 3d3d  el].nunique() ==
+00008ff0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+00009000: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
+00009010: 7a65 3d28 3230 2c20 3229 290a 2020 2020  ze=(20, 2)).    
+00009020: 2020 2020 2020 2020 736e 732e 6b64 6570          sns.kdep
+00009030: 6c6f 7428 6466 2e6c 6f63 5b64 665b 636f  lot(df.loc[df[co
+00009040: 6c5f 6c61 6265 6c5d 203d 3d20 302c 2063  l_label] == 0, c
+00009050: 6f6c 5d29 0a20 2020 2020 2020 2020 2020  ol]).           
+00009060: 2073 6e73 2e6b 6465 706c 6f74 2864 662e   sns.kdeplot(df.
+00009070: 6c6f 635b 6466 5b63 6f6c 5f6c 6162 656c  loc[df[col_label
+00009080: 5d20 3d3d 2031 2c20 636f 6c5d 290a 2020  ] == 1, col]).  
+00009090: 2020 2020 2020 2020 2020 706c 742e 7368            plt.sh
+000090a0: 6f77 2829 0a20 2020 2072 0100 0000 7201  ow().    r....r.
+000090b0: 0000 0072 0100 0000 7201 0000 0072 0200  ...r....r....r..
+000090c0: 0000 da08 706c 6f74 5f72 6567 d403 0000  ....plot_reg....
+000090d0: 7302 0000 0000 0172 2200 0000 6300 0000  s......r"...c...
+000090e0: 0000 0000 0000 0000 0000 0000 0001 0000  ................
+000090f0: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
+00009100: 4e61 ac05 0000 0a20 2020 2064 6566 2070  Na.....    def p
+00009110: 6c6f 745f 636f 7272 2864 662c 2063 6f6c  lot_corr(df, col
+00009120: 735f 7365 6c20 3d20 4e6f 6e65 293a 0a20  s_sel = None):. 
+00009130: 2020 2020 2020 2063 6f6c 735f 7365 6c20         cols_sel 
+00009140: 3d20 636f 6c73 5f73 656c 2069 6620 636f  = cols_sel if co
+00009150: 6c73 5f73 656c 2069 7320 6e6f 7420 4e6f  ls_sel is not No
+00009160: 6e65 2065 6c73 6520 6466 2e63 6f6c 756d  ne else df.colum
+00009170: 6e73 2e74 6f6c 6973 7428 290a 2020 2020  ns.tolist().    
+00009180: 2020 2020 636f 6c73 5f73 656c 203d 205b      cols_sel = [
+00009190: 636f 6c20 666f 7220 636f 6c20 696e 2064  col for col in d
+000091a0: 6620 6966 2064 665b 636f 6c5d 2e64 7479  f if df[col].dty
+000091b0: 7065 7320 213d 2027 6f62 6a65 6374 275d  pes != 'object']
+000091c0: 0a20 2020 2020 2020 2069 6d70 6f72 7420  .        import 
+000091d0: 7363 6970 790a 2020 2020 2020 2020 6e5f  scipy.        n_
+000091e0: 636f 6c20 3d20 6c65 6e28 636f 6c73 5f73  col = len(cols_s
+000091f0: 656c 290a 2020 2020 2020 2020 6466 5f63  el).        df_c
+00009200: 6f72 725f 7020 3d20 6e70 2e7a 6572 6f73  orr_p = np.zeros
+00009210: 2828 6e5f 636f 6c2c 206e 5f63 6f6c 2929  ((n_col, n_col))
+00009220: 0a20 2020 2020 2020 2064 665f 636f 7272  .        df_corr
+00009230: 5f73 7020 3d20 6e70 2e7a 6572 6f73 2828  _sp = np.zeros((
+00009240: 6e5f 636f 6c2c 206e 5f63 6f6c 2929 0a20  n_col, n_col)). 
+00009250: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00009260: 7261 6e67 6528 6e5f 636f 6c29 3a0a 2020  range(n_col):.  
+00009270: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+00009280: 696e 2072 616e 6765 2869 2c20 6e5f 636f  in range(i, n_co
+00009290: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+000092a0: 2020 2020 6331 2c20 6332 203d 2064 665b      c1, c2 = df[
+000092b0: 636f 6c73 5f73 656c 5b69 5d5d 2c20 6466  cols_sel[i]], df
+000092c0: 5b63 6f6c 735f 7365 6c5b 6a5d 5d0a 2020  [cols_sel[j]].  
+000092d0: 2020 2020 2020 2020 2020 2020 2020 6466                df
+000092e0: 5f63 6f72 725f 705b 692c 206a 5d20 3d20  _corr_p[i, j] = 
+000092f0: 6e70 2e63 6f72 7263 6f65 6628 6331 2c20  np.corrcoef(c1, 
+00009300: 6332 295b 305d 5b31 5d0a 2020 2020 2020  c2)[0][1].      
+00009310: 2020 2020 2020 2020 2020 6466 5f63 6f72            df_cor
+00009320: 725f 705b 6a2c 2069 5d20 3d20 6466 5f63  r_p[j, i] = df_c
+00009330: 6f72 725f 705b 692c 206a 5d0a 0a20 2020  orr_p[i, j]..   
+00009340: 2020 2020 2020 2020 2020 2020 2064 665f               df_
+00009350: 636f 7272 5f73 705b 692c 206a 5d20 3d20  corr_sp[i, j] = 
+00009360: 7363 6970 792e 7374 6174 732e 7370 6561  scipy.stats.spea
+00009370: 726d 616e 7228 6331 2c20 6332 295b 305d  rmanr(c1, c2)[0]
+00009380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009390: 2064 665f 636f 7272 5f73 705b 6a2c 2069   df_corr_sp[j, i
+000093a0: 5d20 3d20 6466 5f63 6f72 725f 7370 5b69  ] = df_corr_sp[i
+000093b0: 2c20 6a5d 0a20 2020 2020 2020 200a 2020  , j].        .  
+000093c0: 2020 2020 2020 6466 5f63 6f72 725f 7020        df_corr_p 
+000093d0: 3d20 7064 2e44 6174 6146 7261 6d65 2864  = pd.DataFrame(d
+000093e0: 665f 636f 7272 5f70 2c20 696e 6465 7820  f_corr_p, index 
+000093f0: 3d20 636f 6c73 5f73 656c 2c20 636f 6c75  = cols_sel, colu
+00009400: 6d6e 7320 3d20 636f 6c73 5f73 656c 2920  mns = cols_sel) 
+00009410: 2020 2020 200a 2020 2020 2020 2020 6466       .        df
+00009420: 5f63 6f72 725f 7370 203d 2070 642e 4461  _corr_sp = pd.Da
+00009430: 7461 4672 616d 6528 6466 5f63 6f72 725f  taFrame(df_corr_
+00009440: 7370 2c20 696e 6465 7820 3d20 636f 6c73  sp, index = cols
+00009450: 5f73 656c 2c20 636f 6c75 6d6e 7320 3d20  _sel, columns = 
+00009460: 636f 6c73 5f73 656c 2920 2020 2020 200a  cols_sel)      .
+00009470: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00009480: 2020 2020 2023 2070 6c6f 7420 2020 200a       # plot    .
+00009490: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
+000094a0: 7265 2866 6967 7369 7a65 3d28 3230 2c20  re(figsize=(20, 
+000094b0: 3729 290a 2020 2020 2020 2020 706c 742e  7)).        plt.
+000094c0: 7375 6270 6c6f 7428 312c 2032 2c20 3129  subplot(1, 2, 1)
+000094d0: 0a20 2020 2020 2020 2073 6e73 2e68 6561  .        sns.hea
+000094e0: 746d 6170 2864 665f 636f 7272 5f70 2c20  tmap(df_corr_p, 
+000094f0: 6c69 6e65 7769 6474 6873 203d 2030 2e35  linewidths = 0.5
+00009500: 2c20 7371 7561 7265 3d54 7275 652c 0a20  , square=True,. 
+00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009520: 2020 2061 6e6e 6f74 3d54 7275 652c 2066     annot=True, f
+00009530: 6d74 3d27 2e32 6627 2c20 616e 6e6f 745f  mt='.2f', annot_
+00009540: 6b77 733d 7b27 7369 7a65 273a 3130 7d29  kws={'size':10})
+00009550: 3b0a 2020 2020 2020 2020 706c 742e 7469  ;.        plt.ti
+00009560: 746c 6528 2763 6f72 7263 6f65 6627 290a  tle('corrcoef').
+00009570: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00009580: 2070 6c74 2e73 7562 706c 6f74 2831 2c20   plt.subplot(1, 
+00009590: 322c 2032 290a 2020 2020 2020 2020 736e  2, 2).        sn
+000095a0: 732e 6865 6174 6d61 7028 6466 5f63 6f72  s.heatmap(df_cor
+000095b0: 725f 7370 2c20 6c69 6e65 7769 6474 6873  r_sp, linewidths
+000095c0: 203d 2030 2e35 2c20 7371 7561 7265 3d54   = 0.5, square=T
+000095d0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+000095e0: 2020 2020 2020 2020 2061 6e6e 6f74 3d54           annot=T
+000095f0: 7275 652c 2066 6d74 3d27 2e32 6627 2c20  rue, fmt='.2f', 
+00009600: 616e 6e6f 745f 6b77 733d 7b27 7369 7a65  annot_kws={'size
+00009610: 273a 3130 7d29 3b0a 2020 2020 2020 2020  ':10});.        
+00009620: 706c 742e 7469 746c 6528 2773 7065 6172  plt.title('spear
+00009630: 6d61 6e72 2729 0a20 2020 2020 2020 2070  manr').        p
+00009640: 6c74 2e73 686f 7728 2920 2020 2020 2020  lt.show()       
+00009650: 200a 2020 2020 2020 2020 0a20 2020 2023   .        .    #
+00009660: 2070 6c6f 745f 636f 7272 2874 7261 696e   plot_corr(train
+00009670: 2c20 636f 6c73 5f73 656c 203d 2063 6f6c  , cols_sel = col
+00009680: 735f 6361 7420 2b20 636f 6c73 5f6e 756d  s_cat + cols_num
+00009690: 290a 2020 2020 2320 706c 6f74 5f63 6f72  ).    # plot_cor
+000096a0: 7228 6261 7369 635f 696e 666f 290a 2020  r(basic_info).  
+000096b0: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
+000096c0: 0072 0100 0000 7202 0000 00da 0970 6c6f  .r....r......plo
+000096d0: 745f 636f 7272 ec03 0000 7302 0000 0000  t_corr....s.....
+000096e0: 0172 2300 0000 6300 0000 0000 0000 0000  .r#...c.........
+000096f0: 0000 0000 0000 0001 0000 0043 0000 0073  ...........C...s
+00009700: 0400 0000 6401 5300 2902 4e75 4207 0000  ....d.S.).NuB...
+00009710: 0a20 2020 2064 6566 2070 6c6f 745f 6f6e  .    def plot_on
+00009720: 7428 6331 2c20 6332 293a 0a20 2020 2020  t(c1, c2):.     
+00009730: 2020 2070 6c74 2e66 6967 7572 6528 6669     plt.figure(fi
+00009740: 6773 697a 653d 2837 2c20 3729 290a 2020  gsize=(7, 7)).  
+00009750: 2020 2020 2020 6466 5f69 203d 2064 665b        df_i = df[
+00009760: 6466 5b27 7265 6769 6f6e 275d 2e69 7369  df['region'].isi
+00009770: 6e28 5b31 5d29 5d0a 2020 2020 2020 2020  n([1])].        
+00009780: 736e 732e 7265 6770 6c6f 7428 6466 5f69  sns.regplot(df_i
+00009790: 5b63 315d 2c20 6466 5f69 5b63 325d 2c0a  [c1], df_i[c2],.
+000097a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097b0: 2020 2020 6d61 726b 6572 3d27 7827 2c20      marker='x', 
+000097c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000097d0: 2020 2020 2073 6361 7474 6572 5f6b 7773       scatter_kws
+000097e0: 3d7b 2761 6c70 6861 273a 302e 3735 7d2c  ={'alpha':0.75},
+000097f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009800: 2020 2020 206c 696e 655f 6b77 733d 7b27       line_kws={'
+00009810: 616c 7068 6127 3a30 2e37 357d 290a 0a20  alpha':0.75}).. 
+00009820: 2020 2020 2020 2064 665f 6920 3d20 6466         df_i = df
+00009830: 5b64 665b 2772 6567 696f 6e27 5d2e 6973  [df['region'].is
+00009840: 696e 285b 322c 335d 295d 0a20 2020 2020  in([2,3])].     
+00009850: 2020 2073 6e73 2e72 6567 706c 6f74 2864     sns.regplot(d
+00009860: 665f 695b 6331 5d2c 2064 665f 695b 6332  f_i[c1], df_i[c2
+00009870: 5d2c 200a 2020 2020 2020 2020 2020 2020  ], .            
+00009880: 2020 2020 2020 2020 6d61 726b 6572 3d27          marker='
+00009890: 6f27 2c20 0a20 2020 2020 2020 2020 2020  o', .           
+000098a0: 2020 2020 2020 2020 2073 6361 7474 6572           scatter
+000098b0: 5f6b 7773 3d7b 2761 6c70 6861 273a 302e  _kws={'alpha':0.
+000098c0: 367d 2c20 0a20 2020 2020 2020 2020 2020  6}, .           
+000098d0: 2020 2020 2020 2020 206c 696e 655f 6b77           line_kw
+000098e0: 733d 7b27 616c 7068 6127 3a30 2e36 2c20  s={'alpha':0.6, 
+000098f0: 276c 696e 6573 7479 6c65 273a 2764 6173  'linestyle':'das
+00009900: 6865 6427 7d29 0a20 2020 2020 2020 2070  hed'}).        p
+00009910: 6c74 2e78 6c61 6265 6c28 6331 2c20 7369  lt.xlabel(c1, si
+00009920: 7a65 203d 2032 3029 0a20 2020 2020 2020  ze = 20).       
+00009930: 2070 6c74 2e79 6c61 6265 6c28 6332 5b3a   plt.ylabel(c2[:
+00009940: 2d31 5d2c 2073 697a 6520 3d20 3230 290a  -1], size = 20).
+00009950: 2020 2020 2020 2020 706c 742e 6c65 6765          plt.lege
+00009960: 6e64 285b 27e4 b89c e983 a827 2c20 27e4  nd(['......', '.
+00009970: b8ad e8a5 bfe9 83a8 275d 290a 2020 2020  ........']).    
+00009980: 2020 2020 706c 742e 7361 7665 6669 6728      plt.savefig(
+00009990: 6627 2e2f 666f 725f 6d7a 792f 7b63 317d  f'./for_mzy/{c1}
+000099a0: 5f7b 6332 5b3a 2d31 5d7d 2e6a 7065 6727  _{c2[:-1]}.jpeg'
+000099b0: 2c20 6470 6920 3d20 3230 3029 0a20 2020  , dpi = 200).   
+000099c0: 2020 2020 2070 6c74 2e73 686f 7728 290a       plt.show().
+000099d0: 0a20 2020 204b 203d 2035 0a20 2020 2066  .    K = 5.    f
+000099e0: 6f72 2069 2c20 636f 6c5f 7820 696e 2065  or i, col_x in e
+000099f0: 6e75 6d65 7261 7465 2863 6f6c 735f 7829  numerate(cols_x)
+00009a00: 3a0a 2020 2020 2020 2020 6966 2069 2025  :.        if i %
+00009a10: 204b 203d 3d20 303a 0a20 2020 2020 2020   K == 0:.       
+00009a20: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
+00009a30: 6669 6773 697a 6520 3d20 2832 302c 2035  figsize = (20, 5
+00009a40: 2929 0a20 2020 2020 2020 2070 6c74 2e73  )).        plt.s
+00009a50: 7562 706c 6f74 2831 2c20 4b2c 2020 6920  ubplot(1, K,  i 
+00009a60: 2520 4b20 2b20 3129 0a20 2020 2020 2020  % K + 1).       
+00009a70: 2078 2c20 7920 3d20 7465 7374 5f74 656d   x, y = test_tem
+00009a80: 705b 636f 6c5f 785d 2c20 7465 7374 5f74  p[col_x], test_t
+00009a90: 656d 705b 636f 6c5f 795d 0a20 2020 2020  emp[col_y].     
+00009aa0: 2020 2023 2070 6c74 2e73 6361 7474 6572     # plt.scatter
+00009ab0: 2878 203d 2078 2c20 7920 3d20 792c 2073  (x = x, y = y, s
+00009ac0: 203d 2031 2c20 6d61 726b 6572 203d 2027   = 1, marker = '
+00009ad0: 6f27 2c20 616c 7068 6120 3d20 302e 3529  o', alpha = 0.5)
+00009ae0: 0a20 2020 2020 2020 2073 6e73 2e73 6361  .        sns.sca
+00009af0: 7474 6572 706c 6f74 2878 203d 2078 2c20  tterplot(x = x, 
+00009b00: 7920 3d20 792c 2061 6c70 6861 203d 2030  y = y, alpha = 0
+00009b10: 2e37 3529 232c 2073 203d 2031 2c20 6d61  .75)#, s = 1, ma
+00009b20: 726b 6572 203d 2027 6f27 2c20 616c 7068  rker = 'o', alph
+00009b30: 6120 3d20 302e 3529 0a20 2020 2020 2020  a = 0.5).       
+00009b40: 2070 6c74 2e67 7269 6428 290a 2020 2020   plt.grid().    
+00009b50: 2020 2020 6966 2069 2025 204b 203d 3d20      if i % K == 
+00009b60: 4b20 2d20 313a 0a20 2020 2020 2020 2020  K - 1:.         
+00009b70: 2020 2070 6c74 2e73 686f 7728 290a 0a20     plt.show().. 
+00009b80: 2020 2069 6d70 6f72 7420 6d61 7470 6c6f     import matplo
+00009b90: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
+00009ba0: 6c74 0a20 2020 2069 6d70 6f72 7420 7365  lt.    import se
+00009bb0: 6162 6f72 6e20 6173 2073 6e73 0a20 2020  aborn as sns.   
+00009bc0: 2064 6566 2073 6361 7474 6572 5f63 6f6c   def scatter_col
+00009bd0: 6f72 5f73 697a 6528 6466 2c20 782c 2079  or_size(df, x, y
+00009be0: 2c20 632c 2073 293a 0a20 2020 2020 2020  , c, s):.       
+00009bf0: 2063 6f6c 6f72 7320 3d20 736e 732e 636f   colors = sns.co
+00009c00: 6c6f 725f 7061 6c65 7474 6528 2776 6972  lor_palette('vir
+00009c10: 6964 6973 272c 2064 665b 635d 2e6e 756e  idis', df[c].nun
+00009c20: 6971 7565 2829 290a 2020 2020 2020 2020  ique()).        
+00009c30: 736e 732e 7265 6c70 6c6f 7428 7820 3d20  sns.relplot(x = 
+00009c40: 782c 2079 203d 2079 2c20 6875 6520 3d20  x, y = y, hue = 
+00009c50: 632c 2073 697a 6520 3d20 732c 200a 2020  c, size = s, .  
+00009c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c70: 2020 616c 7068 6120 3d20 302e 362c 2073    alpha = 0.6, s
+00009c80: 697a 6573 203d 2028 352c 2033 3030 292c  izes = (5, 300),
+00009c90: 2023 20e7 82b9 e79a 84e9 808f e698 8ee5   # .............
+00009ca0: 9bbe e592 8ce7 82b9 e79a 84e5 a4a7 e5b0  ................
+00009cb0: 8fe8 8c83 e59b b40a 2020 2020 2020 2020  ........        
+00009cc0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00009cd0: 203d 2064 662c 2070 616c 6574 7465 203d   = df, palette =
+00009ce0: 2063 6f6c 6f72 732c 206c 6567 656e 6420   colors, legend 
+00009cf0: 3d20 4661 6c73 6529 0a20 2020 2020 2020  = False).       
+00009d00: 2070 6c74 2e70 6c6f 7428 6466 5b78 5d2c   plt.plot(df[x],
+00009d10: 2064 665b 795d 2c20 6c69 6e65 7769 6474   df[y], linewidt
+00009d20: 6820 3d20 3129 0a20 2020 2020 2020 2070  h = 1).        p
+00009d30: 6c74 2e74 6974 6c65 2827 7469 746c 6527  lt.title('title'
+00009d40: 290a 2020 2020 2020 2020 706c 742e 7368  ).        plt.sh
+00009d50: 6f77 2829 0a20 2020 2020 2020 200a 2020  ow().        .  
+00009d60: 2020 6466 203d 2074 7261 696e 5b74 7261    df = train[tra
+00009d70: 696e 5b27 6964 275d 203d 3d20 305d 0a20  in['id'] == 0]. 
+00009d80: 2020 2078 2c20 7920 3d20 2778 272c 2027     x, y = 'x', '
+00009d90: 7927 0a20 2020 2063 203d 2027 7927 2023  y'.    c = 'y' #
+00009da0: 20e6 a0b9 e68d ae63 e588 86e7 bb84 efbc   ......c........
+00009db0: 8ce6 af8f e4b8 aae7 bb84 31e7 a78d e9a2  ..........1.....
+00009dc0: 9ce8 89b2 efbc 8c20 2320 e58f aae6 9c89  ....... # ......
+00009dd0: e4b8 80e7 a78d e9a2 9ce8 89b2 e79a 84e7  ................
+00009de0: 94bb efbc 8c64 665b 635d 203d 2031 e5b8  .....df[c] = 1..
+00009df0: b8e6 95b0 e5b0 b1e8 a18c 0a20 2020 2073  ...........    s
+00009e00: 203d 2027 7627 2023 20e5 86b3 e5ae 9ae7   = 'v' # .......
+00009e10: 82b9 e79a 84e5 a4a7 e5b0 8f0a 2020 2020  ............    
+00009e20: 7363 6174 7465 725f 636f 6c6f 725f 7369  scatter_color_si
+00009e30: 7a65 2864 662c 2078 2c20 792c 2063 2c20  ze(df, x, y, c, 
+00009e40: 7329 2020 2020 2020 2020 2020 200a 2020  s)           .  
+00009e50: 2020 7201 0000 0072 0100 0000 7201 0000    r....r....r...
+00009e60: 0072 0100 0000 7202 0000 00da 0c70 6c6f  .r....r......plo
+00009e70: 745f 7363 6174 7465 7212 0400 0073 0200  t_scatter....s..
+00009e80: 0000 0001 7224 0000 0063 0000 0000 0000  ....r$...c......
+00009e90: 0000 0000 0000 0000 0000 0100 0000 4300  ..............C.
+00009ea0: 0000 7304 0000 0064 0153 0029 024e 6164  ..s....d.S.).Nad
+00009eb0: 0b00 000a 2020 2020 696d 706f 7274 206e  ....    import n
+00009ec0: 756d 7079 2061 7320 6e70 0a20 2020 2069  umpy as np.    i
+00009ed0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+00009ee0: 7064 0a20 2020 2069 6d70 6f72 7420 7761  pd.    import wa
+00009ef0: 726e 696e 6773 200a 2020 2020 7761 726e  rnings .    warn
+00009f00: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+00009f10: 6e67 7328 2269 676e 6f72 6522 290a 2020  ngs("ignore").  
+00009f20: 2020 696d 706f 7274 206d 6174 706c 6f74    import matplot
+00009f30: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
+00009f40: 740a 2020 2020 696d 706f 7274 2073 6561  t.    import sea
+00009f50: 626f 726e 2061 7320 736e 730a 2020 2020  born as sns.    
+00009f60: 736e 732e 7365 7428 7374 796c 653d 2277  sns.set(style="w
+00009f70: 6869 7465 222c 2063 6f6c 6f72 5f63 6f64  hite", color_cod
+00009f80: 6573 3d54 7275 6529 0a0a 2020 2020 6465  es=True)..    de
+00009f90: 6620 706c 6f74 5f6e 756d 2878 2c20 6465  f plot_num(x, de
+00009fa0: 6570 203d 2030 2c20 706c 6f74 5f6f 7574  ep = 0, plot_out
+00009fb0: 6c69 6572 203d 2046 616c 7365 2c20 7072  lier = False, pr
+00009fc0: 696e 745f 696e 666f 203d 2046 616c 7365  int_info = False
+00009fd0: 293a 0a20 2020 2020 2020 2069 6620 6465  ):.        if de
+00009fe0: 6570 203d 3d20 3020 616e 6420 7072 696e  ep == 0 and prin
+00009ff0: 745f 696e 666f 3a0a 2020 2020 2020 2020  t_info:.        
+0000a000: 2020 2020 7072 696e 7428 273d 3d3d 3d3d      print('=====
+0000a010: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a030: 3d3d 3d20 706c 6f74 5f6e 756d 203d 3d3d  === plot_num ===
+0000a040: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a060: 3d3d 3d3d 3d27 290a 2020 2020 2020 2020  =====').        
+0000a070: 7072 696e 7428 276e 203d 207b 7d2c 206e  print('n = {}, n
+0000a080: 756c 6c20 3d20 7b7d 272e 666f 726d 6174  ull = {}'.format
+0000a090: 286c 656e 2878 292c 2070 642e 6973 6e75  (len(x), pd.isnu
+0000a0a0: 6c6c 2878 292e 7375 6d28 2929 290a 2020  ll(x).sum())).  
+0000a0b0: 2020 2020 2020 6465 7320 3d20 782e 6465        des = x.de
+0000a0c0: 7363 7269 6265 2829 0a20 2020 2020 2020  scribe().       
+0000a0d0: 2064 6573 5b27 6e75 6e69 7175 6527 5d20   des['nunique'] 
+0000a0e0: 3d20 782e 6e75 6e69 7175 6528 290a 2020  = x.nunique().  
+0000a0f0: 2020 2020 2020 6966 2070 7269 6e74 5f69        if print_i
+0000a100: 6e66 6f3a 0a20 2020 2020 2020 2020 2020  nfo:.           
+0000a110: 2070 7269 6e74 2864 6573 290a 2020 2020   print(des).    
+0000a120: 2020 2020 0a20 2020 2020 2020 2070 6c74      .        plt
+0000a130: 2e66 6967 7572 6528 6669 6773 697a 6520  .figure(figsize 
+0000a140: 3d20 2832 302c 2032 2929 0a20 2020 2020  = (20, 2)).     
+0000a150: 2020 2070 6c74 2e73 7562 706c 6f74 2831     plt.subplot(1
+0000a160: 2c20 332c 2031 290a 2020 2020 2020 2020  , 3, 1).        
+0000a170: 706c 742e 706c 6f74 286e 702e 6172 616e  plt.plot(np.aran
+0000a180: 6765 286c 656e 2878 2929 2c20 6e70 2e73  ge(len(x)), np.s
+0000a190: 6f72 7428 7829 290a 2020 2020 2020 2020  ort(x)).        
+0000a1a0: 0a20 2020 2020 2020 2070 6c74 2e73 7562  .        plt.sub
+0000a1b0: 706c 6f74 2831 2c20 332c 2032 290a 2020  plot(1, 3, 2).  
+0000a1c0: 2020 2020 2020 736e 732e 6469 7374 706c        sns.distpl
+0000a1d0: 6f74 2878 293b 0a0a 2020 2020 2020 2020  ot(x);..        
+0000a1e0: 706c 742e 7375 6270 6c6f 7428 312c 2033  plt.subplot(1, 3
+0000a1f0: 2c20 3329 0a20 2020 2020 2020 2061 203d  , 3).        a =
+0000a200: 2070 6c74 2e62 6f78 706c 6f74 2878 2c20   plt.boxplot(x, 
+0000a210: 7379 6d20 3d20 272b 272c 2076 6572 7420  sym = '+', vert 
+0000a220: 3d20 4661 6c73 6529 3b0a 2020 2020 2020  = False);.      
+0000a230: 2020 706c 742e 7368 6f77 2829 3b0a 2020    plt.show();.  
+0000a240: 2020 2020 2020 0a20 2020 2020 2020 2078        .        x
+0000a250: 5f6f 7574 6c69 6572 203d 2070 642e 5365  _outlier = pd.Se
+0000a260: 7269 6573 2828 615b 2766 6c69 6572 7327  ries((a['fliers'
+0000a270: 5d5b 305d 2e67 6574 5f64 6174 6128 295b  ][0].get_data()[
+0000a280: 315d 2929 0a20 2020 2020 2020 2069 6620  1])).        if 
+0000a290: 706c 6f74 5f6f 7574 6c69 6572 2061 6e64  plot_outlier and
+0000a2a0: 206c 656e 2878 5f6f 7574 6c69 6572 2920   len(x_outlier) 
+0000a2b0: 213d 2030 2061 6e64 2064 6565 7020 3d3d  != 0 and deep ==
+0000a2c0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0000a2d0: 6966 2070 7269 6e74 5f69 6e66 6f3a 0a20  if print_info:. 
+0000a2e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000a2f0: 7269 6e74 2827 3d3d 3d3d 3d3d 3d3d 3d3d  rint('==========
+0000a300: 3d3d 3d3d 3d3d 3d3d 3d3d 206f 7574 6c69  ========== outli
+0000a310: 6572 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  er =============
+0000a320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a330: 3d27 290a 2020 2020 2020 2020 2020 2020  =').            
+0000a340: 706c 6f74 5f6e 756d 2878 5f6f 7574 6c69  plot_num(x_outli
+0000a350: 6572 2c20 6465 6570 202b 2031 290a 2020  er, deep + 1).  
+0000a360: 2020 2020 2020 2020 2020 0a20 2020 2064            .    d
+0000a370: 6566 2070 6c6f 745f 6361 7428 782c 206b  ef plot_cat(x, k
+0000a380: 203d 2031 3030 2c20 7072 696e 745f 696e   = 100, print_in
+0000a390: 666f 203d 2046 616c 7365 293a 0a20 2020  fo = False):.   
+0000a3a0: 2020 2020 2076 6320 3d20 782e 7661 6c75       vc = x.valu
+0000a3b0: 655f 636f 756e 7473 2829 5b3a 6b5d 0a20  e_counts()[:k]. 
+0000a3c0: 2020 2020 2020 2069 6620 7072 696e 745f         if print_
+0000a3d0: 696e 666f 3a0a 2020 2020 2020 2020 2020  info:.          
+0000a3e0: 2020 7072 696e 7428 273d 3d3d 3d3d 3d3d    print('=======
+0000a3f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a400: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a410: 3d20 706c 6f74 5f63 6174 203d 3d3d 3d3d  = plot_cat =====
+0000a420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a430: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000a440: 3d3d 3d27 290a 2020 2020 2020 2020 2020  ===').          
+0000a450: 2020 7072 696e 7428 2764 7479 7065 732e    print('dtypes.
+0000a460: 7661 6c75 655f 636f 756e 7473 2829 203d  value_counts() =
+0000a470: 200a 7b7d 272e 666f 726d 6174 2876 632e   .{}'.format(vc.
+0000a480: 6865 6164 2831 3029 2929 0a20 2020 2020  head(10))).     
+0000a490: 2020 200a 2020 2020 2020 2020 2320 3d3d     .        # ==
+0000a4a0: 3d3d 3d3d 3d3d 3d3d 2063 756d 7375 6d20  ======== cumsum 
+0000a4b0: 3d3d 3d3d 3d3d 3d3d 3d3d 0a20 2020 2020  ==========.     
+0000a4c0: 2020 2076 6320 3d20 7663 2e73 6f72 745f     vc = vc.sort_
+0000a4d0: 696e 6465 7828 290a 2020 2020 2020 2020  index().        
+0000a4e0: 2320 7072 696e 7428 2773 6f72 7420 6279  # print('sort by
+0000a4f0: 2069 6e64 6578 2729 0a20 2020 2020 2020   index').       
+0000a500: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+0000a510: 697a 653d 2832 302c 2032 2929 0a20 2020  ize=(20, 2)).   
+0000a520: 2020 2020 2070 6c74 2e73 7562 706c 6f74       plt.subplot
+0000a530: 2831 2c20 332c 2031 290a 2020 2020 2020  (1, 3, 1).      
+0000a540: 2020 736e 732e 6261 7270 6c6f 7428 6e70    sns.barplot(np
+0000a550: 2e61 7261 6e67 6528 6c65 6e28 7663 2929  .arange(len(vc))
+0000a560: 2c20 7663 2e76 616c 7565 7329 3b0a 2020  , vc.values);.  
+0000a570: 2020 2020 2020 706c 742e 706c 6f74 286e        plt.plot(n
+0000a580: 702e 6172 616e 6765 286c 656e 2876 6329  p.arange(len(vc)
+0000a590: 292c 2076 632e 7661 6c75 6573 2c20 2762  ), vc.values, 'b
+0000a5a0: 2d27 293b 0a20 2020 2020 2020 2070 6c74  -');.        plt
+0000a5b0: 2e70 6c6f 7428 6e70 2e61 7261 6e67 6528  .plot(np.arange(
+0000a5c0: 6c65 6e28 7663 2929 2c20 7663 2e76 616c  len(vc)), vc.val
+0000a5d0: 7565 732c 2027 7278 2729 3b0a 2020 2020  ues, 'rx');.    
+0000a5e0: 2020 2020 706c 742e 7874 6963 6b73 286e      plt.xticks(n
+0000a5f0: 702e 6172 616e 6765 286c 656e 2876 6329  p.arange(len(vc)
+0000a600: 292c 2076 632e 696e 6465 7829 0a20 2020  ), vc.index).   
+0000a610: 2020 2020 2070 6c74 2e74 6974 6c65 2827       plt.title('
+0000a620: 736f 7274 2062 7920 696e 6465 7827 290a  sort by index').
+0000a630: 2020 2020 2020 2020 2370 6c74 2e73 686f          #plt.sho
+0000a640: 7728 293b 0a0a 2020 2020 2020 2020 2320  w();..        # 
+0000a650: 7072 696e 7428 2773 6f72 7420 6279 2076  print('sort by v
+0000a660: 616c 7565 7327 290a 2020 2020 2020 2020  alues').        
+0000a670: 706c 742e 7375 6270 6c6f 7428 312c 2033  plt.subplot(1, 3
+0000a680: 2c20 3229 0a20 2020 2020 2020 2076 6320  , 2).        vc 
+0000a690: 3d20 7663 2e73 6f72 745f 7661 6c75 6573  = vc.sort_values
+0000a6a0: 2861 7363 656e 6469 6e67 203d 2046 616c  (ascending = Fal
+0000a6b0: 7365 290a 2020 2020 2020 2020 736e 732e  se).        sns.
+0000a6c0: 6261 7270 6c6f 7428 6e70 2e61 7261 6e67  barplot(np.arang
+0000a6d0: 6528 6c65 6e28 7663 2929 2c20 7663 2e76  e(len(vc)), vc.v
+0000a6e0: 616c 7565 7329 3b0a 2020 2020 2020 2020  alues);.        
+0000a6f0: 706c 742e 706c 6f74 286e 702e 6172 616e  plt.plot(np.aran
+0000a700: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
+0000a710: 7661 6c75 6573 2c20 2762 2d27 293b 0a20  values, 'b-');. 
+0000a720: 2020 2020 2020 2070 6c74 2e70 6c6f 7428         plt.plot(
+0000a730: 6e70 2e61 7261 6e67 6528 6c65 6e28 7663  np.arange(len(vc
+0000a740: 2929 2c20 7663 2e76 616c 7565 732c 2027  )), vc.values, '
+0000a750: 7278 2729 3b0a 2020 2020 2020 2020 706c  rx');.        pl
+0000a760: 742e 7874 6963 6b73 286e 702e 6172 616e  t.xticks(np.aran
+0000a770: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
+0000a780: 696e 6465 7829 0a20 2020 2020 2020 2070  index).        p
+0000a790: 6c74 2e74 6974 6c65 2827 736f 7274 2062  lt.title('sort b
+0000a7a0: 7920 7661 6c75 6573 2729 0a20 2020 2020  y values').     
+0000a7b0: 2020 2023 706c 742e 7368 6f77 2829 3b0a     #plt.show();.
+0000a7c0: 0a20 2020 2020 2020 2023 203d 3d3d 3d3d  .        # =====
+0000a7d0: 3d3d 3d3d 3d20 6375 6d73 756d 203d 3d3d  ===== cumsum ===
+0000a7e0: 3d3d 3d3d 3d3d 3d0a 2020 2020 2020 2020  =======.        
+0000a7f0: 2320 7072 696e 7428 2763 756d 7375 6d27  # print('cumsum'
+0000a800: 290a 2020 2020 2020 2020 706c 742e 7375  ).        plt.su
+0000a810: 6270 6c6f 7428 312c 2033 2c20 3329 0a20  bplot(1, 3, 3). 
+0000a820: 2020 2020 2020 2076 6320 3d20 782e 7661         vc = x.va
+0000a830: 6c75 655f 636f 756e 7473 2829 0a20 2020  lue_counts().   
+0000a840: 2020 2020 2076 635f 6375 6d73 756d 203d       vc_cumsum =
+0000a850: 2076 632e 6375 6d73 756d 2829 2e72 6573   vc.cumsum().res
+0000a860: 6574 5f69 6e64 6578 2864 726f 7020 3d20  et_index(drop = 
+0000a870: 5472 7565 290a 2020 2020 2020 2020 7663  True).        vc
+0000a880: 5f63 756d 7375 6d20 2f3d 2076 635f 6375  _cumsum /= vc_cu
+0000a890: 6d73 756d 2e6d 6178 2829 0a20 2020 2020  msum.max().     
+0000a8a0: 2020 2070 6c74 2e70 6c6f 7428 7663 5f63     plt.plot(vc_c
+0000a8b0: 756d 7375 6d2c 2027 622d 2729 0a20 2020  umsum, 'b-').   
+0000a8c0: 2020 2020 2070 6c74 2e70 6c6f 7428 7663       plt.plot(vc
+0000a8d0: 5f63 756d 7375 6d2c 2027 7278 2729 0a20  _cumsum, 'rx'). 
+0000a8e0: 2020 2020 2020 2078 795f 3039 203d 2076         xy_09 = v
+0000a8f0: 635f 6375 6d73 756d 5b76 635f 6375 6d73  c_cumsum[vc_cums
+0000a900: 756d 203e 3d20 302e 395d 5b3a 315d 0a20  um >= 0.9][:1]. 
+0000a910: 2020 2020 2020 2078 5f30 392c 2079 5f30         x_09, y_0
+0000a920: 3920 3d20 7879 5f30 392e 696e 6465 782e  9 = xy_09.index.
+0000a930: 7661 6c75 6573 5b30 5d2c 2078 795f 3039  values[0], xy_09
+0000a940: 2e76 616c 7565 735b 305d 0a20 2020 2020  .values[0].     
+0000a950: 2020 2070 6c74 2e61 7868 6c69 6e65 2879     plt.axhline(y
+0000a960: 5f30 392c 2063 6f6c 6f72 203d 2027 7227  _09, color = 'r'
+0000a970: 290a 2020 2020 2020 2020 706c 742e 6178  ).        plt.ax
+0000a980: 766c 696e 6528 785f 3039 2c20 636f 6c6f  vline(x_09, colo
+0000a990: 7220 3d20 2772 2729 0a20 2020 2020 2020  r = 'r').       
+0000a9a0: 2070 6c74 2e74 6974 6c65 2827 785f 3039   plt.title('x_09
+0000a9b0: 203d 207b 7d2c 2078 5f25 203d 207b 3a2e   = {}, x_% = {:.
+0000a9c0: 3466 7d2c 2079 5f30 3920 3d20 7b3a 2e34  4f}, y_09 = {:.4
+0000a9d0: 667d 272e 666f 726d 6174 2878 5f30 392c  f}'.format(x_09,
+0000a9e0: 2078 5f30 3920 2f20 6c65 6e28 7663 5f63   x_09 / len(vc_c
+0000a9f0: 756d 7375 6d29 2c20 795f 3039 2929 0a20  umsum), y_09)). 
+0000aa00: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+0000aa10: 293b 0a20 2020 2072 0100 0000 7201 0000  );.    r....r...
+0000aa20: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
+0000aa30: da0b 706c 6f74 5f63 6f6c 735f 3145 0400  ..plot_cols_1E..
+0000aa40: 0073 0200 0000 0001 7225 0000 0063 0000  .s......r%...c..
+0000aa50: 0000 0000 0000 0000 0000 0000 0000 0100  ................
+0000aa60: 0000 4300 0000 7304 0000 0064 0153 0029  ..C...s....d.S.)
+0000aa70: 024e 61af 0e00 000a 2020 2020 6465 6620  .Na.....    def 
+0000aa80: 706c 6f74 5f6b 6579 5f63 6f6c 2864 662c  plot_key_col(df,
+0000aa90: 206b 6579 2c20 636f 6c2c 206b 203d 2031   key, col, k = 1
+0000aaa0: 3029 3a0a 2020 2020 2020 2020 7663 203d  0):.        vc =
+0000aab0: 2064 665b 6b65 795d 2e76 616c 7565 5f63   df[key].value_c
+0000aac0: 6f75 6e74 7328 292e 696c 6f63 5b3a 6b5d  ounts().iloc[:k]
+0000aad0: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
+0000aae0: 2876 6329 0a20 2020 2020 2020 2064 6620  (vc).        df 
+0000aaf0: 3d20 6466 5b64 665b 6b65 795d 2e69 7369  = df[df[key].isi
+0000ab00: 6e28 7663 2e69 6e64 6578 295d 2e72 6573  n(vc.index)].res
+0000ab10: 6574 5f69 6e64 6578 2864 726f 7020 3d20  et_index(drop = 
+0000ab20: 5472 7565 290a 2020 2020 2020 2020 706c  True).        pl
+0000ab30: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
+0000ab40: 203d 2028 3230 2c20 3329 290a 2020 2020   = (20, 3)).    
+0000ab50: 2020 2020 736e 732e 626f 7870 6c6f 7428      sns.boxplot(
+0000ab60: 783d 6b65 792c 2079 3d63 6f6c 2c20 6461  x=key, y=col, da
+0000ab70: 7461 203d 2064 665b 5b6b 6579 2c20 636f  ta = df[[key, co
+0000ab80: 6c5d 5d29 0a20 2020 2020 2020 2070 6c74  l]]).        plt
+0000ab90: 2e6c 6567 656e 6428 5b27 7b7d 203d 207b  .legend(['{} = {
+0000aba0: 7d27 2e66 6f72 6d61 7428 692c 2076 632e  }'.format(i, vc.
+0000abb0: 6c6f 635b 695d 2920 666f 7220 6920 696e  loc[i]) for i in
+0000abc0: 2076 632e 696e 6465 785d 290a 2020 2020   vc.index]).    
+0000abd0: 2020 2020 706c 742e 7469 746c 6528 2770      plt.title('p
+0000abe0: 6c6f 745f 6b65 795f 636f 6c27 290a 2020  lot_key_col').  
+0000abf0: 2020 2020 2020 706c 742e 7368 6f77 2829        plt.show()
+0000ac00: 3b0a 0a20 2020 2064 6566 2070 6c6f 745f  ;..    def plot_
+0000ac10: 6361 745f 6e75 6d28 6466 2c20 6b65 792c  cat_num(df, key,
+0000ac20: 2063 6f6c 2c20 6b20 3d20 3130 293a 0a20   col, k = 10):. 
+0000ac30: 2020 2020 2020 2023 206b 6579 5f63 6f6c         # key_col
+0000ac40: 0a20 2020 2020 2020 2070 6c6f 745f 6b65  .        plot_ke
+0000ac50: 795f 636f 6c28 6466 2c20 6b65 792c 2063  y_col(df, key, c
+0000ac60: 6f6c 2c20 6b20 3d20 6b29 0a20 2020 2020  ol, k = k).     
+0000ac70: 2020 200a 2020 2020 2020 2020 2320 7661     .        # va
+0000ac80: 6c75 655f 636f 756e 7473 0a20 2020 2020  lue_counts.     
+0000ac90: 2020 2076 6320 3d20 6466 5b6b 6579 5d2e     vc = df[key].
+0000aca0: 7661 6c75 655f 636f 756e 7473 2829 2e69  value_counts().i
+0000acb0: 6c6f 635b 3a6b 5d0a 2020 2020 2020 2020  loc[:k].        
+0000acc0: 7663 203d 2076 632e 736f 7274 5f69 6e64  vc = vc.sort_ind
+0000acd0: 6578 2829 0a20 2020 2020 2020 2070 6c74  ex().        plt
+0000ace0: 2e66 6967 7572 6528 6669 6773 697a 6520  .figure(figsize 
+0000acf0: 3d20 2832 302c 2033 2929 0a20 2020 2020  = (20, 3)).     
+0000ad00: 2020 2070 6c74 2e73 7562 706c 6f74 2831     plt.subplot(1
+0000ad10: 2c20 332c 2031 290a 2020 2020 2020 2020  , 3, 1).        
+0000ad20: 736e 732e 6261 7270 6c6f 7428 6e70 2e61  sns.barplot(np.a
+0000ad30: 7261 6e67 6528 6c65 6e28 7663 2929 2c20  range(len(vc)), 
+0000ad40: 7663 2e76 616c 7565 7329 3b0a 2020 2020  vc.values);.    
+0000ad50: 2020 2020 706c 742e 706c 6f74 286e 702e      plt.plot(np.
+0000ad60: 6172 616e 6765 286c 656e 2876 6329 292c  arange(len(vc)),
+0000ad70: 2076 632e 7661 6c75 6573 2c20 2762 2d27   vc.values, 'b-'
+0000ad80: 293b 0a20 2020 2020 2020 2070 6c74 2e70  );.        plt.p
+0000ad90: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
+0000ada0: 6e28 7663 2929 2c20 7663 2e76 616c 7565  n(vc)), vc.value
+0000adb0: 732c 2027 722b 2729 3b0a 2020 2020 2020  s, 'r+');.      
+0000adc0: 2020 706c 742e 7874 6963 6b73 286e 702e    plt.xticks(np.
+0000add0: 6172 616e 6765 286c 656e 2876 6329 292c  arange(len(vc)),
+0000ade0: 2076 632e 696e 6465 7829 0a20 2020 2020   vc.index).     
+0000adf0: 2020 2070 6c74 2e74 6974 6c65 2827 7661     plt.title('va
+0000ae00: 6c75 655f 636f 756e 7473 2729 0a20 2020  lue_counts').   
+0000ae10: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
+0000ae20: 7472 656e 640a 2020 2020 2020 2020 706c  trend.        pl
+0000ae30: 742e 7375 6270 6c6f 7428 312c 2033 2c20  t.subplot(1, 3, 
+0000ae40: 3229 0a20 2020 2020 2020 2066 6f72 2076  2).        for v
+0000ae50: 6920 696e 2076 632e 696e 6465 783a 0a20  i in vc.index:. 
+0000ae60: 2020 2020 2020 2020 2020 2078 203d 2064             x = d
+0000ae70: 662e 6c6f 635b 6466 5b6b 6579 5d20 3d3d  f.loc[df[key] ==
+0000ae80: 2076 692c 2063 6f6c 5d0a 2020 2020 2020   vi, col].      
+0000ae90: 2020 2020 2020 706c 742e 706c 6f74 286e        plt.plot(n
+0000aea0: 702e 6172 616e 6765 286c 656e 2878 2929  p.arange(len(x))
+0000aeb0: 2c20 6e70 2e73 6f72 7428 7829 290a 2020  , np.sort(x)).  
+0000aec0: 2020 2020 2020 706c 742e 6c65 6765 6e64        plt.legend
+0000aed0: 286c 6973 7428 7663 2e69 6e64 6578 2929  (list(vc.index))
+0000aee0: 0a20 2020 2020 2020 2070 6c74 2e74 6974  .        plt.tit
+0000aef0: 6c65 2827 7472 656e 6427 290a 2020 2020  le('trend').    
+0000af00: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000af10: 2023 2064 6973 7470 6c6f 7420 2020 200a   # distplot    .
+0000af20: 2020 2020 2020 2020 706c 742e 7375 6270          plt.subp
+0000af30: 6c6f 7428 312c 2033 2c20 3329 0a20 2020  lot(1, 3, 3).   
+0000af40: 2020 2020 2066 6f72 2076 6920 696e 2076       for vi in v
+0000af50: 632e 696e 6465 783a 0a20 2020 2020 2020  c.index:.       
+0000af60: 2020 2020 2078 203d 2064 662e 6c6f 635b       x = df.loc[
+0000af70: 6466 5b6b 6579 5d20 3d3d 2076 692c 2063  df[key] == vi, c
+0000af80: 6f6c 5d0a 2020 2020 2020 2020 2020 2020  ol].            
+0000af90: 736e 732e 6469 7374 706c 6f74 2878 2c20  sns.distplot(x, 
+0000afa0: 6269 6e73 203d 2031 3029 0a20 2020 2020  bins = 10).     
+0000afb0: 2020 2070 6c74 2e6c 6567 656e 6428 6c69     plt.legend(li
+0000afc0: 7374 2876 632e 696e 6465 7829 290a 2020  st(vc.index)).  
+0000afd0: 2020 2020 2020 706c 742e 7469 746c 6528        plt.title(
+0000afe0: 2764 6973 7470 6c6f 7427 290a 2020 2020  'distplot').    
+0000aff0: 2020 2020 706c 742e 786c 6162 656c 2827      plt.xlabel('
+0000b000: 2729 0a20 2020 2020 2020 2070 6c74 2e73  ').        plt.s
+0000b010: 686f 7728 290a 2020 2020 2020 2020 0a20  how().        . 
+0000b020: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
+0000b030: 706c 6f74 5f63 6174 5f63 6174 2864 662c  plot_cat_cat(df,
+0000b040: 206b 6579 2c20 636f 6c2c 206b 3120 3d20   key, col, k1 = 
+0000b050: 3130 2c20 6b32 203d 2031 3030 293a 0a20  10, k2 = 100):. 
+0000b060: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+0000b070: 6528 6669 6773 697a 653d 2832 302c 2033  e(figsize=(20, 3
+0000b080: 2929 0a20 2020 2020 2020 2078 5f6c 6973  )).        x_lis
+0000b090: 7420 3d20 5b5d 0a20 2020 2020 2020 2066  t = [].        f
+0000b0a0: 6f72 2076 6920 696e 206c 6973 7428 6466  or vi in list(df
+0000b0b0: 5b6b 6579 5d2e 7661 6c75 655f 636f 756e  [key].value_coun
+0000b0c0: 7473 2829 2e69 6e64 6578 295b 3a6b 315d  ts().index)[:k1]
+0000b0d0: 3a0a 2020 2020 2020 2020 2020 2020 7820  :.            x 
+0000b0e0: 3d20 6466 2e6c 6f63 5b64 665b 6b65 795d  = df.loc[df[key]
+0000b0f0: 203d 3d20 7669 2c20 636f 6c5d 0a20 2020   == vi, col].   
+0000b100: 2020 2020 2020 2020 2076 6320 3d20 782e           vc = x.
+0000b110: 7661 6c75 655f 636f 756e 7473 2829 2e69  value_counts().i
+0000b120: 6c6f 635b 3a6b 5d0a 2020 2020 2020 2020  loc[:k].        
+0000b130: 2020 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d      # ==========
+0000b140: 2076 616c 7565 5f63 6f75 6e74 7320 3d3d   value_counts ==
+0000b150: 3d3d 3d3d 3d3d 3d3d 0a20 2020 2020 2020  ========.       
+0000b160: 2020 2020 2070 6c74 2e73 7562 706c 6f74       plt.subplot
+0000b170: 2831 2c20 332c 2031 290a 2020 2020 2020  (1, 3, 1).      
+0000b180: 2020 2020 2020 7663 203d 2076 632e 736f        vc = vc.so
+0000b190: 7274 5f69 6e64 6578 2829 0a20 2020 2020  rt_index().     
+0000b1a0: 2020 2020 2020 2023 2073 6e73 2e62 6172         # sns.bar
+0000b1b0: 706c 6f74 286e 702e 6172 616e 6765 286c  plot(np.arange(l
+0000b1c0: 656e 2876 6329 292c 2076 632e 7661 6c75  en(vc)), vc.valu
+0000b1d0: 6573 293b 0a20 2020 2020 2020 2020 2020  es);.           
+0000b1e0: 2070 6c74 2e70 6c6f 7428 6e70 2e61 7261   plt.plot(np.ara
+0000b1f0: 6e67 6528 6c65 6e28 7663 2929 2c20 7663  nge(len(vc)), vc
+0000b200: 2e76 616c 7565 732c 2027 2d27 293b 0a20  .values, '-');. 
+0000b210: 2020 2020 2020 2020 2020 2070 6c74 2e70             plt.p
+0000b220: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
+0000b230: 6e28 7663 2929 2c20 7663 2e76 616c 7565  n(vc)), vc.value
+0000b240: 732c 2027 2b27 293b 0a20 2020 2020 2020  s, '+');.       
+0000b250: 2020 2020 2070 6c74 2e78 7469 636b 7328       plt.xticks(
+0000b260: 6e70 2e61 7261 6e67 6528 6c65 6e28 7663  np.arange(len(vc
+0000b270: 2929 2c20 7663 2e69 6e64 6578 290a 2020  )), vc.index).  
+0000b280: 2020 2020 2020 2020 2020 706c 742e 7469            plt.ti
+0000b290: 746c 6528 2773 6f72 7420 6279 2069 6e64  tle('sort by ind
+0000b2a0: 6578 2729 0a0a 2020 2020 2020 2020 2020  ex')..          
+0000b2b0: 2020 706c 742e 7375 6270 6c6f 7428 312c    plt.subplot(1,
+0000b2c0: 2033 2c20 3229 0a20 2020 2020 2020 2020   3, 2).         
+0000b2d0: 2020 2076 6320 3d20 7663 2e73 6f72 745f     vc = vc.sort_
+0000b2e0: 7661 6c75 6573 2861 7363 656e 6469 6e67  values(ascending
+0000b2f0: 203d 2046 616c 7365 290a 2020 2020 2020   = False).      
+0000b300: 2020 2020 2020 2320 736e 732e 6261 7270        # sns.barp
+0000b310: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
+0000b320: 6e28 7663 2929 2c20 7663 2e76 616c 7565  n(vc)), vc.value
+0000b330: 7329 3b0a 2020 2020 2020 2020 2020 2020  s);.            
+0000b340: 706c 742e 706c 6f74 286e 702e 6172 616e  plt.plot(np.aran
+0000b350: 6765 286c 656e 2876 6329 292c 2076 632e  ge(len(vc)), vc.
+0000b360: 7661 6c75 6573 2c20 272d 2729 3b0a 2020  values, '-');.  
+0000b370: 2020 2020 2020 2020 2020 706c 742e 706c            plt.pl
+0000b380: 6f74 286e 702e 6172 616e 6765 286c 656e  ot(np.arange(len
+0000b390: 2876 6329 292c 2076 632e 7661 6c75 6573  (vc)), vc.values
+0000b3a0: 2c20 272b 2729 3b0a 2020 2020 2020 2020  , '+');.        
+0000b3b0: 2020 2020 706c 742e 7874 6963 6b73 286e      plt.xticks(n
+0000b3c0: 702e 6172 616e 6765 286c 656e 2876 6329  p.arange(len(vc)
+0000b3d0: 292c 2076 632e 696e 6465 7829 0a20 2020  ), vc.index).   
+0000b3e0: 2020 2020 2020 2020 2070 6c74 2e74 6974           plt.tit
+0000b3f0: 6c65 2827 736f 7274 2062 7920 7661 6c75  le('sort by valu
+0000b400: 6573 2729 0a0a 2020 2020 2020 2020 2020  es')..          
+0000b410: 2020 2320 3d3d 3d3d 3d3d 3d3d 3d3d 2063    # ========== c
+0000b420: 756d 7375 6d20 3d3d 3d3d 3d3d 3d3d 3d3d  umsum ==========
+0000b430: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
+0000b440: 2e73 7562 706c 6f74 2831 2c20 332c 2033  .subplot(1, 3, 3
+0000b450: 290a 2020 2020 2020 2020 2020 2020 7663  ).            vc
+0000b460: 203d 2078 2e76 616c 7565 5f63 6f75 6e74   = x.value_count
+0000b470: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0000b480: 7663 5f63 756d 7375 6d20 3d20 7663 2e63  vc_cumsum = vc.c
+0000b490: 756d 7375 6d28 292e 7265 7365 745f 696e  umsum().reset_in
+0000b4a0: 6465 7828 6472 6f70 203d 2054 7275 6529  dex(drop = True)
+0000b4b0: 0a20 2020 2020 2020 2020 2020 2076 635f  .            vc_
+0000b4c0: 6375 6d73 756d 202f 3d20 7663 5f63 756d  cumsum /= vc_cum
+0000b4d0: 7375 6d2e 6d61 7828 290a 2020 2020 2020  sum.max().      
+0000b4e0: 2020 2020 2020 706c 742e 706c 6f74 2876        plt.plot(v
+0000b4f0: 635f 6375 6d73 756d 2c20 272d 2729 0a20  c_cumsum, '-'). 
+0000b500: 2020 2020 2020 2020 2020 2070 6c74 2e70             plt.p
+0000b510: 6c6f 7428 7663 5f63 756d 7375 6d2c 2027  lot(vc_cumsum, '
+0000b520: 2b27 290a 2020 2020 2020 2020 2020 2020  +').            
+0000b530: 7879 5f30 3920 3d20 7663 5f63 756d 7375  xy_09 = vc_cumsu
+0000b540: 6d5b 7663 5f63 756d 7375 6d20 3e3d 2030  m[vc_cumsum >= 0
+0000b550: 2e39 5d5b 3a31 5d0a 2020 2020 2020 2020  .9][:1].        
+0000b560: 2020 2020 785f 3039 2c20 795f 3039 203d      x_09, y_09 =
+0000b570: 2078 795f 3039 2e69 6e64 6578 2e76 616c   xy_09.index.val
+0000b580: 7565 735b 305d 2c20 7879 5f30 392e 7661  ues[0], xy_09.va
+0000b590: 6c75 6573 5b30 5d0a 2020 2020 2020 2020  lues[0].        
+0000b5a0: 2020 2020 2320 706c 742e 6178 686c 696e      # plt.axhlin
+0000b5b0: 6528 795f 3039 2c20 636f 6c6f 7220 3d20  e(y_09, color = 
+0000b5c0: 2772 2729 0a20 2020 2020 2020 2020 2020  'r').           
+0000b5d0: 2070 6c74 2e61 7876 6c69 6e65 2878 5f30   plt.axvline(x_0
+0000b5e0: 392c 2063 6f6c 6f72 203d 2027 7227 290a  9, color = 'r').
+0000b5f0: 2020 2020 2020 2020 2020 2020 785f 6c69              x_li
+0000b600: 7374 2e61 7070 656e 6428 785f 3039 202f  st.append(x_09 /
+0000b610: 206c 656e 2876 635f 6375 6d73 756d 2929   len(vc_cumsum))
+0000b620: 0a20 2020 2020 2020 2070 6c74 2e74 6974  .        plt.tit
+0000b630: 6c65 2827 7820 3d20 7b7d 272e 666f 726d  le('x = {}'.form
+0000b640: 6174 285b 277b 3a2e 3066 7d27 2e66 6f72  at(['{:.0f}'.for
+0000b650: 6d61 7428 6929 2066 6f72 2069 2069 6e20  mat(i) for i in 
+0000b660: 785f 6c69 7374 5d29 290a 2020 2020 2020  x_list])).      
+0000b670: 2020 7072 696e 7428 290a 2020 2020 2020    print().      
+0000b680: 2020 706c 742e 7368 6f77 2829 2020 2020    plt.show()    
+0000b690: 0a20 2020 2020 2020 200a 2020 2020 6465  .        .    de
+0000b6a0: 6620 706c 6f74 5f70 6169 7228 6466 2c20  f plot_pair(df, 
+0000b6b0: 636f 6c73 5f73 656c 2c20 6b20 3d20 3130  cols_sel, k = 10
+0000b6c0: 2c20 636f 6c5f 6c61 6265 6c20 3d20 4e6f  , col_label = No
+0000b6d0: 6e65 293a 0a20 2020 2020 2020 2063 6f6c  ne):.        col
+0000b6e0: 735f 7365 6c20 3d20 636f 6c73 5f73 656c  s_sel = cols_sel
+0000b6f0: 5b3a 6b5d 0a20 2020 2020 2020 2063 6f6c  [:k].        col
+0000b700: 735f 7365 6c20 2b3d 205b 636f 6c5f 6c61  s_sel += [col_la
+0000b710: 6265 6c5d 2069 6620 636f 6c5f 6c61 6265  bel] if col_labe
+0000b720: 6c20 6973 206e 6f74 204e 6f6e 6520 656c  l is not None el
+0000b730: 7365 205b 5d0a 2020 2020 2020 2020 6966  se [].        if
+0000b740: 2063 6f6c 5f6c 6162 656c 2069 7320 4e6f   col_label is No
+0000b750: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000b760: 736e 732e 7061 6972 706c 6f74 2864 665b  sns.pairplot(df[
+0000b770: 636f 6c73 5f73 656c 5d2c 2068 7565 203d  cols_sel], hue =
+0000b780: 2063 6f6c 5f6c 6162 656c 2c20 7369 7a65   col_label, size
+0000b790: 3d32 2c20 6b69 6e64 3d27 7363 6174 7465  =2, kind='scatte
+0000b7a0: 7227 2c64 6961 675f 6b69 6e64 3d22 6869  r',diag_kind="hi
+0000b7b0: 7374 2229 0a20 2020 2020 2020 2065 6c73  st").        els
+0000b7c0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0000b7d0: 6e73 2e70 6169 7270 6c6f 7428 6466 5b63  ns.pairplot(df[c
+0000b7e0: 6f6c 735f 7365 6c5d 2c20 6875 6520 3d20  ols_sel], hue = 
+0000b7f0: 636f 6c5f 6c61 6265 6c2c 2073 697a 653d  col_label, size=
+0000b800: 322c 206b 696e 643d 2773 6361 7474 6572  2, kind='scatter
+0000b810: 272c 6469 6167 5f6b 696e 643d 2268 6973  ',diag_kind="his
+0000b820: 7422 290a 2020 2020 2020 2020 706c 742e  t").        plt.
+0000b830: 7368 6f77 2829 3b0a 2020 2020 706c 6f74  show();.    plot
+0000b840: 5f6b 6579 5f63 6f6c 2874 7261 696e 2c20  _key_col(train, 
+0000b850: 276c 6162 656c 272c 2027 635f 3027 2c20  'label', 'c_0', 
+0000b860: 6b20 3d20 3130 290a 2020 2020 706c 6f74  k = 10).    plot
+0000b870: 5f63 6174 5f6e 756d 2874 7261 696e 2c20  _cat_num(train, 
+0000b880: 276c 6162 656c 272c 2027 635f 3027 2c20  'label', 'c_0', 
+0000b890: 6b20 3d20 3130 290a 2020 2020 706c 6f74  k = 10).    plot
+0000b8a0: 5f63 6174 5f63 6174 2874 7261 696e 2c20  _cat_cat(train, 
+0000b8b0: 276c 6162 656c 272c 2027 635f 3027 2c20  'label', 'c_0', 
+0000b8c0: 6b31 203d 2031 302c 206b 3220 3d20 3130  k1 = 10, k2 = 10
+0000b8d0: 3029 0a20 2020 2070 6c6f 745f 7061 6972  0).    plot_pair
+0000b8e0: 2874 7261 696e 2c20 636f 6c73 5f63 6174  (train, cols_cat
+0000b8f0: 5b3a 355d 202b 2063 6f6c 735f 6e75 6d5b  [:5] + cols_num[
+0000b900: 3a35 5d2c 206b 203d 2031 302c 2063 6f6c  :5], k = 10, col
+0000b910: 5f6c 6162 656c 203d 2027 6c61 6265 6c27  _label = 'label'
+0000b920: 290a 2020 2020 7201 0000 0072 0100 0000  ).    r....r....
+0000b930: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
+0000b940: 0b70 6c6f 745f 636f 6c73 5f32 9504 0000  .plot_cols_2....
+0000b950: 7302 0000 0000 0172 2600 0000 6300 0000  s......r&...c...
+0000b960: 0000 0000 0000 0000 0000 0000 0001 0000  ................
+0000b970: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
+0000b980: 4e61 f001 0000 0a20 2020 2064 6566 2070  Na.....    def p
+0000b990: 6c6f 745f 6466 5f69 6d70 2864 665f 696d  lot_df_imp(df_im
+0000b9a0: 702c 2063 6f6c 203d 2027 636f 6c27 2c20  p, col = 'col', 
+0000b9b0: 696d 7020 3d20 2769 6d70 272c 206b 203d  imp = 'imp', k =
+0000b9c0: 2032 3029 3a0a 2020 2020 2020 2020 696d   20):.        im
+0000b9d0: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0000b9e0: 7079 706c 6f74 2061 7320 706c 740a 2020  pyplot as plt.  
+0000b9f0: 2020 2020 2020 696d 706f 7274 2073 6561        import sea
+0000ba00: 626f 726e 2061 7320 736e 730a 2020 2020  born as sns.    
+0000ba10: 2020 2020 706c 742e 6669 6775 7265 2866      plt.figure(f
+0000ba20: 6967 7369 7a65 3d28 3230 2c20 6d61 7828  igsize=(20, max(
+0000ba30: 3130 2c20 6b20 2f2f 2032 2929 290a 2020  10, k // 2))).  
+0000ba40: 2020 2020 2020 6466 5f69 6d70 5f73 6f72        df_imp_sor
+0000ba50: 7420 3d20 6466 5f69 6d70 2e73 6f72 745f  t = df_imp.sort_
+0000ba60: 7661 6c75 6573 2862 7920 3d20 696d 702c  values(by = imp,
+0000ba70: 2061 7363 656e 6469 6e67 203d 2046 616c   ascending = Fal
+0000ba80: 7365 292e 7265 7365 745f 696e 6465 7828  se).reset_index(
+0000ba90: 6472 6f70 203d 2054 7275 6529 0a20 2020  drop = True).   
+0000baa0: 2020 2020 2073 6e73 2e62 6172 706c 6f74       sns.barplot
+0000bab0: 2878 3d69 6d70 2c20 793d 636f 6c2c 2064  (x=imp, y=col, d
+0000bac0: 6174 613d 6466 5f69 6d70 5f73 6f72 745b  ata=df_imp_sort[
+0000bad0: 3a6b 5d29 0a20 2020 2020 2020 2070 6c74  :k]).        plt
+0000bae0: 2e74 6974 6c65 2827 6466 5f69 6d70 272c  .title('df_imp',
+0000baf0: 2066 6f6e 7473 697a 6520 3d20 3235 290a   fontsize = 25).
+0000bb00: 2020 2020 2020 2020 706c 742e 7469 6768          plt.tigh
+0000bb10: 745f 6c61 796f 7574 2829 0a20 2020 2020  t_layout().     
+0000bb20: 2020 2070 6c74 2e78 7469 636b 7328 666f     plt.xticks(fo
+0000bb30: 6e74 7369 7a65 203d 2032 3529 0a20 2020  ntsize = 25).   
+0000bb40: 2020 2020 2070 6c74 2e79 7469 636b 7328       plt.yticks(
+0000bb50: 666f 6e74 7369 7a65 203d 2032 3529 0a20  fontsize = 25). 
+0000bb60: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+0000bb70: 290a 2020 2020 7201 0000 0072 0100 0000  ).    r....r....
+0000bb80: 7201 0000 0072 0100 0000 7202 0000 00da  r....r....r.....
+0000bb90: 0b70 6c6f 745f 6466 5f69 6d70 f804 0000  .plot_df_imp....
+0000bba0: 7302 0000 0000 0172 2700 0000 6300 0000  s......r'...c...
+0000bbb0: 0000 0000 0000 0000 0000 0000 0001 0000  ................
+0000bbc0: 0043 0000 0073 0400 0000 6401 5300 2902  .C...s....d.S.).
+0000bbd0: 4e61 8f02 0000 0a20 2020 2069 6d70 6f72  Na.....    impor
+0000bbe0: 7420 706c 6f74 6c79 2e67 7261 7068 5f6f  t plotly.graph_o
+0000bbf0: 626a 6563 7473 2061 7320 676f 0a20 2020  bjects as go.   
+0000bc00: 2066 726f 6d20 706c 6f74 6c79 2e6f 6666   from plotly.off
+0000bc10: 6c69 6e65 2069 6d70 6f72 7420 6970 6c6f  line import iplo
+0000bc20: 740a 2020 2020 6465 6620 706c 6f74 5f63  t.    def plot_c
+0000bc30: 756d 7375 6d28 6466 5f69 635f 6c69 7374  umsum(df_ic_list
+0000bc40: 2c20 6d6f 6465 6c5f 6c69 7374 2c20 636f  , model_list, co
+0000bc50: 6c5f 6461 7465 2c20 636f 6c20 3d20 2769  l_date, col = 'i
+0000bc60: 6327 293a 0a20 2020 2020 2020 2066 6967  c'):.        fig
+0000bc70: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
+0000bc80: 2020 2066 6f72 2064 665f 6963 2c20 6e61     for df_ic, na
+0000bc90: 6d65 2069 6e20 7a69 7028 6466 5f69 635f  me in zip(df_ic_
+0000bca0: 6c69 7374 2c20 6d6f 6465 6c5f 6c69 7374  list, model_list
+0000bcb0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+0000bcc0: 6967 203d 2067 6f2e 5363 6174 7465 7228  ig = go.Scatter(
+0000bcd0: 7820 3d20 6466 5f69 635b 636f 6c5f 6461  x = df_ic[col_da
+0000bce0: 7465 5d2e 6173 7479 7065 2873 7472 292c  te].astype(str),
+0000bcf0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+0000bd00: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+0000bd10: 3d20 6466 5f69 635b 636f 6c5d 2e63 756d  = df_ic[col].cum
+0000bd20: 7375 6d28 2920 2f20 6c65 6e28 6466 5f69  sum() / len(df_i
+0000bd30: 6329 2c0a 2020 2020 2020 2020 2020 2020  c),.            
+0000bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd50: 6d6f 6465 203d 2027 6c69 6e65 7327 2c0a  mode = 'lines',.
+0000bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd70: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0000bd80: 203d 206e 616d 6529 0a20 2020 2020 2020   = name).       
+0000bd90: 2020 2020 2066 6967 5f6c 6973 742e 6170       fig_list.ap
+0000bda0: 7065 6e64 2866 6967 290a 2020 2020 2020  pend(fig).      
+0000bdb0: 2020 6c61 796f 7574 203d 2064 6963 7428    layout = dict(
+0000bdc0: 7469 746c 6520 3d20 636f 6c2c 2079 6178  title = col, yax
+0000bdd0: 6973 203d 2064 6963 7428 7469 636b 3020  is = dict(tick0 
+0000bde0: 3d20 302c 2064 7469 636b 3d30 2e30 3129  = 0, dtick=0.01)
+0000bdf0: 290a 2020 2020 2020 2020 6970 6c6f 7428  ).        iplot(
+0000be00: 6469 6374 2864 6174 6120 3d20 6669 675f  dict(data = fig_
+0000be10: 6c69 7374 2c20 6c61 796f 7574 203d 206c  list, layout = l
+0000be20: 6179 6f75 7429 290a 2020 2020 2070 6c6f  ayout)).     plo
+0000be30: 745f 6375 6d73 756d 285b 6466 5f69 635d  t_cumsum([df_ic]
+0000be40: 2c20 5b27 6c67 6227 5d2c 2063 6f6c 5f64  , ['lgb'], col_d
+0000be50: 6174 652c 2063 6f6c 203d 2027 6963 2729  ate, col = 'ic')
+0000be60: 0a20 2020 2072 0100 0000 7201 0000 0072  .    r....r....r
+0000be70: 0100 0000 7201 0000 0072 0200 0000 da0b  ....r....r......
+0000be80: 706c 6f74 5f63 756d 7375 6d07 0500 0073  plot_cumsum....s
+0000be90: 0200 0000 0001 7228 0000 004e 2926 7203  ......r(...N)&r.
+0000bea0: 0000 0072 0400 0000 7205 0000 0072 0600  ...r....r....r..
+0000beb0: 0000 7207 0000 0072 0800 0000 7209 0000  ..r....r....r...
+0000bec0: 0072 0a00 0000 720b 0000 0072 0c00 0000  .r....r....r....
+0000bed0: 720d 0000 0072 0e00 0000 720f 0000 0072  r....r....r....r
+0000bee0: 1000 0000 7211 0000 0072 1200 0000 7213  ....r....r....r.
+0000bef0: 0000 0072 1400 0000 7215 0000 0072 1600  ...r....r....r..
+0000bf00: 0000 7217 0000 0072 1800 0000 7219 0000  ..r....r....r...
+0000bf10: 0072 1a00 0000 721b 0000 0072 1c00 0000  .r....r....r....
+0000bf20: 721d 0000 0072 1e00 0000 721f 0000 0072  r....r....r....r
+0000bf30: 2000 0000 7221 0000 0072 2200 0000 7223   ...r!...r"...r#
+0000bf40: 0000 0072 2400 0000 7225 0000 0072 2600  ...r$...r%...r&.
+0000bf50: 0000 7227 0000 0072 2800 0000 7201 0000  ..r'...r(...r...
+0000bf60: 0072 0100 0000 7201 0000 0072 0200 0000  .r....r....r....
+0000bf70: da08 3c6d 6f64 756c 653e 0300 0000 734a  ..<module>....sJ
+0000bf80: 0000 0008 3908 0508 1508 1308 0708 0508  ....9...........
+0000bf90: 1808 1c08 1c08 3f08 4408 2108 2208 3f08  ......?.D.!.".?.
+0000bfa0: 1a08 1908 7c08 0608 1208 1408 0708 0808  ....|...........
+0000bfb0: 0608 0c08 0808 4108 3008 1508 1e08 3108  ......A.0.....1.
+0000bfc0: 3108 1808 2608 3308 5008 6308 0f         1...&.3.P.c..
```

## runningz/util/const.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:44:08 2024 UTC, .py size: 3706 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 38e2 5966 7a0e 0000  a.......8.Yfz...
+00000000: 610d 0d0a 0000 0000 259a 5c66 7a0e 0000  a.......%.\fz...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 4600 0000 6400  .....@...sF...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c02 5a02 6400 6401 6c03 5a03 4700  d.l.Z.d.d.l.Z.G.
 00000050: 6402 6403 8400 6403 8302 5a04 4700 6404  d.d...d...Z.G.d.
 00000060: 6405 8400 6405 8302 5a05 6505 8300 5a06  d...d...Z.e...Z.
 00000070: 6401 5300 2906 e900 0000 004e 6300 0000  d.S.)......Nc...
@@ -20,18 +20,18 @@
 00000130: 494e 5a03 4d41 435a 054c 494e 5558 5a0e  INZ.MACZ.LINUXZ.
 00000140: 4a50 595f 5041 5245 4e54 5f50 4944 4e7a  JPY_PARENT_PIDNz
 00000150: 1f2f 686f 6d65 2f70 7562 6c69 632f 6461  ./home/public/da
 00000160: 7461 2f74 7573 6861 7265 2f64 6169 6c79  ta/tushare/daily
 00000170: 7a2c 2f55 7365 7273 2f72 756e 6e69 6e67  z,/Users/running
 00000180: 7a2f 776f 726b 7370 6163 652f 6461 7461  z/workspace/data
 00000190: 2f74 7573 6861 7265 2f64 6169 6c79 5a38  /tushare/dailyZ8
-000001a0: 6436 3839 6362 3363 3164 3863 3861 3631  d689cb3c1d8c8a61
-000001b0: 3865 3439 6361 3062 6236 3466 3464 3664  8e49ca0bb64f4d6d
-000001c0: 6532 6637 3065 3238 6162 3566 3736 6138  e2f70e28ab5f76a8
-000001d0: 3637 6233 3161 6337 7a14 3433 2e31 3433  67b31ac7z.43.143
+000001a0: 6539 6133 3532 6462 3165 3362 6335 3737  e9a352db1e3bc577
+000001b0: 3334 6464 3532 3332 6330 3538 6239 6533  34dd5232c058b9e3
+000001c0: 3665 3462 3635 3566 3064 3036 3631 6561  6e4b655f0d0661ea
+000001d0: 3365 6362 3162 3864 7a14 3433 2e31 3433  3ecb1b8dz.43.143
 000001e0: 2e32 3033 2e32 3333 3a31 3637 3030 292a  .203.233:16700)*
 000001f0: 7a1f 7275 6e6e 696e 677a 2f66 652f 636f  z.runningz/fe/co
 00000200: 6e66 6967 2f66 6d5f 636f 6e66 6967 2e70  nfig/fm_config.p
 00000210: 797a 2372 756e 6e69 6e67 7a2f 6665 2f63  yz#runningz/fe/c
 00000220: 6f6e 6669 672f 666d 5f63 6f6e 6669 675f  onfig/fm_config_
 00000230: 746f 702e 7079 7a23 7275 6e6e 696e 677a  top.pyz#runningz
 00000240: 2f66 652f 636f 6e66 6967 2f66 6d5f 636f  /fe/config/fm_co
```

## runningz/util/const_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 4127 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 1f10 0000  a.........Yf....
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 1f10 0000  a.........\f....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -46,19 +46,19 @@
 000002d0: 6d65 2f70 7562 6c69 632f 6461 7461 2f74  me/public/data/t
 000002e0: 7573 6861 7265 2f64 6169 6c79 2720 2069  ushare/daily'  i
 000002f0: 6620 4d41 4348 494e 4520 3d3d 2027 4c49  f MACHINE == 'LI
 00000300: 4e55 5827 2065 6c73 6520 272f 5573 6572  NUX' else '/User
 00000310: 732f 7275 6e6e 696e 677a 2f77 6f72 6b73  s/runningz/works
 00000320: 7061 6365 2f64 6174 612f 7475 7368 6172  pace/data/tushar
 00000330: 652f 6461 696c 7927 0a20 2020 2054 5553  e/daily'.    TUS
-00000340: 4841 5245 5f54 4f4b 454e 203d 2027 6436  HARE_TOKEN = 'd6
-00000350: 3839 6362 3363 3164 3863 3861 3631 3865  89cb3c1d8c8a618e
-00000360: 3439 6361 3062 6236 3466 3464 3664 6532  49ca0bb64f4d6de2
-00000370: 6637 3065 3238 6162 3566 3736 6138 3637  f70e28ab5f76a867
-00000380: 6233 3161 6337 270a 2020 2020 4950 5f50  b31ac7'.    IP_P
+00000340: 4841 5245 5f54 4f4b 454e 203d 2027 6539  HARE_TOKEN = 'e9
+00000350: 6133 3532 6462 3165 3362 6335 3737 3334  a352db1e3bc57734
+00000360: 6464 3532 3332 6330 3538 6239 6533 3665  dd5232c058b9e36e
+00000370: 3462 3635 3566 3064 3036 3631 6561 3365  4b655f0d0661ea3e
+00000380: 6362 3162 3864 270a 2020 2020 4950 5f50  cb1b8d'.    IP_P
 00000390: 4f52 5420 3d20 2734 332e 3134 332e 3230  ORT = '43.143.20
 000003a0: 332e 3233 333a 3136 3730 3027 200a 0a20  3.233:16700' .. 
 000003b0: 2020 2050 595f 4c49 5354 203d 205b 0a20     PY_LIST = [. 
 000003c0: 2020 2020 2020 2027 7275 6e6e 696e 677a         'runningz
 000003d0: 2f66 652f 636f 6e66 6967 2f66 6d5f 636f  /fe/config/fm_co
 000003e0: 6e66 6967 2e70 7927 2c0a 2020 2020 2020  nfig.py',.      
 000003f0: 2020 2772 756e 6e69 6e67 7a2f 6665 2f63    'runningz/fe/c
```

## runningz/util/npy.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:42:15 2024 UTC, .py size: 24941 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 c7e1 5966 6d61 0000  a.........Yfma..
+00000000: 610d 0d0a 0000 0000 8c87 5a66 0762 0000  a.........Zf.b..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0008 0000 0040 0000 0073 1001 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a04 6400 6401 6c05 5a06 6400  d.l.Z.d.d.l.Z.d.
 00000050: 6402 6c07 6d07 5a07 0100 6400 6401 6c08  d.l.m.Z...d.d.l.
 00000060: 5a08 6403 6404 6c09 6d0a 5a0a 6d0b 5a0b  Z.d.d.l.m.Z.m.Z.
 00000070: 0100 6403 6405 6c0c 6d0d 5a0d 6d0e 5a0e  ..d.d.l.m.Z.m.Z.
@@ -380,874 +380,880 @@
 000017b0: 0000 7219 0000 0072 4e00 0000 7236 0000  ..r....rN...r6..
 000017c0: 0072 2800 0000 723d 0000 0029 04da 046d  .r(...r=...)...m
 000017d0: 6173 6b72 3e00 0000 723f 0000 00da 0369  askr>...r?.....i
 000017e0: 6478 720f 0000 0072 0f00 0000 7215 0000  dxr....r....r...
 000017f0: 00da 0a6d 6173 6b5f 325f 6964 78a0 0000  ...mask_2_idx...
 00001800: 0073 1200 0000 0001 0801 0401 0801 0802  .s..............
 00001810: 0c01 0c01 1002 1a01 7278 0000 0072 2e00  ........rx...r..
-00001820: 0000 6308 0000 0000 0000 0000 0000 0019  ..c.............
-00001830: 0000 0008 0000 0043 0000 0073 7602 0000  .......C...sv...
+00001820: 0000 6308 0000 0000 0000 0000 0000 001b  ..c.............
+00001830: 0000 0008 0000 0043 0000 0073 b002 0000  .......C...s....
 00001840: 7c05 720e 7400 a001 7c01 a101 6e02 7c01  |.r.t...|...n.|.
 00001850: 7d01 7400 a002 7400 a003 7c01 a101 a004  }.t...t...|.....
 00001860: a100 a101 0100 7405 7c00 8301 6401 1900  ......t.|...d...
 00001870: 7d08 7405 7c00 8301 7d09 7406 7c09 6402  }.t.|...}.t.|.d.
 00001880: 1900 8301 7d0a 7c08 6401 1900 7d0b 7407  ....}.|.d...}.t.
 00001890: 7c01 8301 7d0c 7c02 6403 7500 7266 7c08  |...}.|.d.u.rf|.
 000018a0: 6402 1900 6e06 7407 7c02 8301 7d0d 7400  d...n.t.|...}.t.
 000018b0: 6a08 7c0c 7c0d 6602 7400 6a09 6404 8d02  j.|.|.f.t.j.d...
 000018c0: 7d0e 7c04 6403 7500 7392 7c04 6402 6b02  }.|.d.u.s.|.d.k.
 000018d0: 7298 6405 7d04 6e0c 7c04 6406 1400 6406  r.d.}.n.|.d...d.
-000018e0: 1400 7d04 7c03 6403 7500 73b4 7c03 6402  ..}.|.d.u.s.|.d.
-000018f0: 6b02 72e2 7400 a00a 7c08 6407 6403 8502  k.r.t...|.d.d...
-00001900: 1900 a101 6408 7c0a 7600 72d0 6409 6e02  ....d.|.v.r.d.n.
-00001910: 640a 1400 7d0f 740b 7c04 7c0f 1b00 8301  d...}.t.|.|.....
-00001920: 7d03 7c06 9001 724c 740c 640b 7c08 9b00  }.|...rLt.d.|...
-00001930: 640c 7400 a00a 7c08 a101 640a 1400 640d  d.t...|...d...d.
-00001940: 9b04 9d04 8301 0100 740c 640e 7c0e 6a0d  ........t.d.|.j.
-00001950: 9b00 640c 7400 a00a 7c0e 6a0d a101 640a  ..d.t...|.j...d.
-00001960: 1400 640d 9b04 9d04 8301 0100 740c 640f  ..d.........t.d.
-00001970: 7c04 640d 9b04 6410 7c03 640d 9b04 6411  |.d...d.|.d...d.
-00001980: 7c0f 6412 9b04 9d06 8301 0100 7c06 9001  |.d.........|...
-00001990: 726c 740e 740f 6401 7c0b 7c03 8303 6413  rlt.t.d.|.|...d.
-000019a0: 6414 6415 6416 8d04 7d10 6e0c 740f 6401  d.d.d...}.n.t.d.
-000019b0: 7c0b 7c03 8303 7d10 7c10 4400 5dec 7d11  |.|...}.|.D.].}.
-000019c0: 7c11 7410 7c0b 7c11 7c03 1700 8302 0200  |.t.|.|.|.......
-000019d0: 7d12 7d13 740b 7c12 7400 a00a 7c08 6407  }.}.t.|.t...|.d.
-000019e0: 6402 8502 1900 a101 1400 8301 7d14 740b  d...........}.t.
-000019f0: 7c13 7400 a00a 7c08 6407 6402 8502 1900  |.t...|.d.d.....
-00001a00: a101 1400 8301 7d15 7400 a011 7c14 7c01  ......}.t...|.|.
-00001a10: 6b01 7c01 7c15 6b00 4000 a101 6401 1900  k.|.|.k.@...d...
-00001a20: 7d16 7407 7c16 8301 6401 6b02 9001 72f4  }.t.|...d.k...r.
-00001a30: 9001 717c 7412 7c00 7c12 7c13 7c02 7c07  ..q|t.|.|.|.|.|.
-00001a40: 6417 8d05 a013 6402 7c0d a102 7d17 7c01  d.....d.|...}.|.
-00001a50: 7c16 1900 7c14 1800 7d18 7c07 9002 7236  |...|...}.|...r6
-00001a60: 7414 7c0e 7c16 7c17 7c18 1900 6401 6418  t.|.|.|.|...d.d.
-00001a70: 8d04 0100 6e30 7c05 9002 725a 7c17 7c18  ....n0|...rZ|.|.
-00001a80: 1900 7c0e 7c16 6401 1900 7c16 6402 1900  ..|.|.d...|.d...
-00001a90: 6407 1700 8502 3c00 6e0c 7c17 7c18 1900  d.....<.n.|.|...
-00001aa0: 7c0e 7c16 3c00 9001 717c 7415 a016 a100  |.|.<...q|t.....
-00001ab0: 0100 7c0e 5300 2919 7aeb 0a20 2020 2072  ..|.S.).z..    r
-00001ac0: 7a2e 6765 745f 6d65 6d5f 6375 7228 292c  z.get_mem_cur(),
-00001ad0: 2072 7a2e 6765 745f 6d65 6d5f 6d61 7828   rz.get_mem_max(
-00001ae0: 293b 0a20 2020 2064 6174 6120 3d20 6c6f  );.    data = lo
-00001af0: 6164 5f6e 7079 5f69 6478 2827 612e 6e70  ad_npy_idx('a.np
-00001b00: 7927 2c20 6d61 736b 5f69 6478 2c20 636f  y', mask_idx, co
-00001b10: 6c73 2c20 626c 6f63 6b5f 7369 7a65 203d  ls, block_size =
-00001b20: 2032 3030 2c20 7665 7262 6f73 6520 3d20   200, verbose = 
-00001b30: 5472 7565 290a 2020 2020 7072 696e 7428  True).    print(
-00001b40: 6461 7461 2e73 6861 7065 290a 2020 2020  data.shape).    
-00001b50: 7072 696e 7428 6627 7b34 202a 206e 702e  print(f'{4 * np.
-00001b60: 7072 6f64 2864 6174 612e 7368 6170 6529  prod(data.shape)
-00001b70: 3a2c 2e30 667d 2729 0a20 2020 2072 7a2e  :,.0f}').    rz.
-00001b80: 6765 745f 6d65 6d5f 6375 7228 292c 2072  get_mem_cur(), r
-00001b90: 7a2e 6765 745f 6d65 6d5f 6d61 7828 293b  z.get_mem_max();
-00001ba0: 0a20 2020 2072 0100 0000 722e 0000 004e  .    r....r....N
-00001bb0: 723c 0000 00e9 0000 800c 6900 0400 0072  r<........i....r
-00001bc0: 0300 0000 da02 3634 7273 0000 00e9 0400  ......64rs......
-00001bd0: 0000 7a12 5b2b 5d20 6461 7461 5f61 6c6c  ..z.[+] data_all
-00001be0: 2020 2020 3d20 fa08 2c20 6d65 6d20 3d20      = .., mem = 
-00001bf0: fa04 2c2e 3066 7a12 2020 2020 6461 7461  ..,.0fz.    data
-00001c00: 5f73 656c 2020 2020 3d20 fa12 2020 2020  _sel    = ..    
-00001c10: 626c 6f63 6b5f 7369 7a65 2020 3d20 fa03  block_size  = ..
-00001c20: 203d 20fa 0320 2a20 fa03 2e30 667a 0e6c   = .. * ...0fz.l
-00001c30: 6f61 645f 6e70 795f 6964 7828 2972 4500  oad_npy_idx()rE.
-00001c40: 0000 54a9 03da 0464 6573 6372 4700 0000  ..T....descrG...
-00001c50: 7248 0000 00a9 0472 3e00 0000 723f 0000  rH.....r>...r?..
-00001c60: 0072 5000 0000 7252 0000 0072 4900 0000  .rP...rR...rI...
-00001c70: 2917 7219 0000 00da 0473 6f72 74da 1161  ).r......sort..a
-00001c80: 7363 6f6e 7469 6775 6f75 7361 7272 6179  scontiguousarray
-00001c90: 724a 0000 005a 0572 6176 656c 7224 0000  rJ...Z.ravelr$..
-00001ca0: 0072 1100 0000 724c 0000 0072 4b00 0000  .r....rL...rK...
-00001cb0: 725e 0000 0072 3600 0000 da03 696e 74da  r^...r6.....int.
-00001cc0: 0570 7269 6e74 7228 0000 0072 0200 0000  .printr(...r....
-00001cd0: 7230 0000 00da 036d 696e da05 7768 6572  r0.....min..wher
-00001ce0: 6572 6500 0000 723d 0000 0072 0700 0000  ere...r=...r....
-00001cf0: 7229 0000 0072 2a00 0000 2919 721f 0000  r)...r*...).r...
-00001d00: 0072 7700 0000 7250 0000 00da 0a62 6174  .rw...rP.....bat
-00001d10: 6368 5f73 697a 65da 0a62 6c6f 636b 5f73  ch_size..block_s
-00001d20: 697a 65da 0a73 6f72 745f 696e 6465 7872  ize..sort_indexr
-00001d30: 5100 0000 7252 0000 0072 2800 0000 7253  Q...rR...r(...rS
-00001d40: 0000 0072 2700 0000 da06 6e5f 726f 7773  ...r'.....n_rows
-00001d50: da0a 6e5f 726f 7773 5f73 656c da0a 6e5f  ..n_rows_sel..n_
-00001d60: 636f 6c73 5f73 656c 7242 0000 00da 0c73  cols_selrB.....s
-00001d70: 697a 655f 6f6e 655f 726f 7772 5600 0000  ize_one_rowrV...
-00001d80: 7257 0000 0072 5800 0000 7259 0000 00da  rW...rX...rY....
-00001d90: 035f 7031 da03 5f70 32da 0769 6478 5f73  ._p1.._p2..idx_s
-00001da0: 656c 7240 0000 00da 0569 6478 5f61 720f  elr@.....idx_ar.
-00001db0: 0000 0072 0f00 0000 7215 0000 00da 0c6c  ...r....r......l
-00001dc0: 6f61 645f 6e70 795f 6964 78ae 0000 0073  oad_npy_idx....s
-00001dd0: 4a00 0000 000a 1201 1402 0c01 0801 0c01  J...............
-00001de0: 0801 0801 1801 1401 1001 0602 0c03 1001  ................
-00001df0: 2201 0c02 0601 2001 2401 2003 0601 1a02  "..... .$. .....
-00001e00: 0c01 0801 1401 1a01 1a01 1a01 1202 1a01  ................
-00001e10: 0c02 0601 1602 0601 1e02 1001 0801 7296  ..............r.
-00001e20: 0000 0063 0a00 0000 0000 0000 0000 0000  ...c............
-00001e30: 0d00 0000 0700 0000 0300 0000 738e 0000  ............s...
-00001e40: 0074 0088 0583 017d 0a88 0364 0175 0072  .t.....}...d.u.r
-00001e50: 3274 016a 0274 0388 0483 017c 0a64 0219  2t.j.t.....|.d..
-00001e60: 0064 0319 0066 0274 016a 0464 048d 0289  .d...f.t.j.d....
-00001e70: 006e 1c74 016a 0274 0388 0483 0174 0388  .n.t.j.t.....t..
-00001e80: 0383 0166 0274 016a 0464 048d 0289 0087  ...f.t.j.d......
-00001e90: 0087 0187 0287 0387 0487 0587 0666 0764  .............f.d
-00001ea0: 0564 0684 087d 0b74 0574 0388 0083 017c  .d...}.t.t.....|
-00001eb0: 087c 0914 0083 027d 0c74 067c 0b7c 0c7c  .|.....}.t.|.|.|
-00001ec0: 0864 077c 0664 088d 0501 0088 0053 0029  .d.|.d.......S.)
-00001ed0: 0975 9500 0000 0a20 2020 2072 7ae5 bc80  .u.....    rz...
-00001ee0: e5a4 b4e7 9a84 e587 bde6 95b0 2c20 6b74  ............, kt
-00001ef0: 696d 6573 203d 2031 e698 afe5 85b3 e994  imes = 1........
-00001f00: ae20 2a2a 2a2a 2a2a 2072 7a5f 6c6f 6164  . ****** rz_load
-00001f10: 5f6e 7079 5f69 6478 202a 2a2a 2a2a 2a0a  _npy_idx ******.
-00001f20: 2020 2020 6e5f 6a6f 6273 203d 2038 2c20      n_jobs = 8, 
-00001f30: 6b74 696d 6573 203d 2031 2c20 3420 7469  ktimes = 1, 4 ti
-00001f40: 6d65 7320 6661 7374 6572 2074 6861 6e20  mes faster than 
-00001f50: 6c6f 6164 5f6e 7079 5f69 6478 0a20 2020  load_npy_idx.   
-00001f60: 2037 4742 2f73 0a20 2020 204e 7201 0000   7GB/s.    Nr...
-00001f70: 0072 2e00 0000 723c 0000 0063 0200 0000  .r....r<...c....
-00001f80: 0000 0000 0000 0000 0200 0000 0a00 0000  ................
-00001f90: 1300 0000 7338 0000 007c 007c 016b 0572  ....s8...|.|.k.r
-00001fa0: 0c64 0053 0074 0088 0588 047c 007c 0185  .d.S.t.....|.|..
-00001fb0: 0219 0088 0388 0188 0288 0664 0164 0164  ...........d.d.d
-00001fc0: 028d 0888 007c 007c 0185 023c 0064 0053  .....|.|...<.d.S
-00001fd0: 0029 034e 4672 6100 0000 2901 7296 0000  .).NFra...).r...
-00001fe0: 0072 6a00 0000 a907 7240 0000 0072 8b00  .rj.....r@...r..
-00001ff0: 0000 728c 0000 0072 5000 0000 7277 0000  ..r....rP...rw..
-00002000: 0072 1f00 0000 728d 0000 0072 0f00 0000  .r....r....r....
-00002010: 7215 0000 0072 6c00 0000 f400 0000 7304  r....rl.......s.
-00002020: 0000 0000 010c 017a 1f72 7a5f 6c6f 6164  .......z.rz_load
-00002030: 5f6e 7079 5f69 6478 2e3c 6c6f 6361 6c73  _npy_idx.<locals
-00002040: 3e2e 727a 5f72 756e 726d 0000 0072 6e00  >.rz_runrm...rn.
-00002050: 0000 2907 7224 0000 0072 1900 0000 724b  ..).r$...r....rK
-00002060: 0000 0072 4c00 0000 725e 0000 0072 0a00  ...rL...r^...r..
-00002070: 0000 720b 0000 0029 0d72 1f00 0000 7277  ..r....).r....rw
-00002080: 0000 0072 5000 0000 728b 0000 0072 8c00  ...rP...r....r..
-00002090: 0000 728d 0000 0072 5100 0000 7252 0000  ..r....rQ...rR..
-000020a0: 0072 6f00 0000 7270 0000 0072 5300 0000  .ro...rp...rS...
-000020b0: 726c 0000 0072 7100 0000 720f 0000 0072  rl...rq...r....r
-000020c0: 9700 0000 7215 0000 00da 0f72 7a5f 6c6f  ....r......rz_lo
-000020d0: 6164 5f6e 7079 5f69 6478 eb00 0000 730e  ad_npy_idx....s.
-000020e0: 0000 0000 0608 012a 011c 0118 0312 0112  .......*........
-000020f0: 0172 9800 0000 6307 0000 0000 0000 0000  .r....c.........
-00002100: 0000 0021 0000 000a 0000 0003 0000 0073  ...!...........s
-00002110: b203 0000 7400 8800 8301 7401 7501 7226  ....t.....t.u.r&
-00002120: 8700 6601 6401 6402 8408 7402 7403 7c00  ..f.d.d...t.t.|.
-00002130: 8301 8301 4400 8301 8900 7c02 6403 7500  ....D.....|.d.u.
-00002140: 7244 6404 6402 8400 7402 7403 7c00 8301  rDd.d...t.t.|...
-00002150: 8301 4400 8301 7d02 6405 6402 8400 7c00  ..D...}.d.d...|.
-00002160: 4400 8301 8901 6406 6402 8400 7c00 4400  D.....d.d...|.D.
-00002170: 8301 7d07 6407 6402 8400 8801 4400 8301  ..}.d.d.....D...
-00002180: 7d08 6408 6402 8400 8800 4400 8301 7d09  }.d.d.....D...}.
-00002190: 7403 7c00 8301 7403 8800 8301 6b02 729c  t.|...t.....k.r.
-000021a0: 7403 7c00 8301 7403 7c02 8301 6b02 73c2  t.|...t.|...k.s.
-000021b0: 4a00 6409 7403 7c00 8301 9b00 640a 7403  J.d.t.|.....d.t.
-000021c0: 8800 8301 9b00 640b 7403 7c02 8301 9b00  ......d.t.|.....
-000021d0: 9d06 8301 8201 7403 7404 7c09 8301 8301  ......t.t.|.....
-000021e0: 640c 6b02 73e0 4a00 640d 7c09 9b00 9d02  d.k.s.J.d.|.....
-000021f0: 8301 8201 8701 6601 640e 6402 8408 7405  ......f.d.d...t.
-00002200: 7c02 8301 4400 8301 7d0a 7406 a007 8800  |...D...}.t.....
-00002210: 640f 1900 a101 640c 6b01 9001 7212 7408  d.....d.k...r.t.
-00002220: 6410 8301 0100 7406 6a09 7c09 640f 1900  d.....t.j.|.d...
-00002230: 7406 a00a 7c0a a101 6602 7406 6a0b 6411  t...|...f.t.j.d.
-00002240: 8d02 7d0b 7c04 6403 7500 9001 7344 7c04  ..}.|.d.u...sD|.
-00002250: 6412 6b02 9001 724a 6413 7d04 6e08 7c04  d.k...rJd.}.n.|.
-00002260: 6414 3900 7d04 7c05 9001 727c 7408 6415  d.9.}.|...r|t.d.
-00002270: 7c0b 6a0c 9b00 6416 7406 a00d 7c0b 6a0c  |.j...d.t...|.j.
-00002280: a101 6417 1400 6418 9b04 9d04 8301 0100  ..d...d.........
-00002290: 7402 7403 7c00 8301 8301 4400 9002 5d22  t.t.|.....D...]"
-000022a0: 7d0c 7c00 7c0c 1900 7d0d 7c07 7c0c 1900  }.|.|...}.|.|...
-000022b0: 7d0e 8800 7c0c 1900 7d0f 7c02 7c0c 1900  }...|...}.|.|...
-000022c0: 7d10 8801 7c0c 1900 7d11 7c08 7c0c 1900  }...|...}.|.|...
-000022d0: 7d12 7c09 7c0c 1900 7d13 7c0a 7c0c 1900  }.|.|...}.|.|...
-000022e0: 7d14 7c03 6403 7500 9001 73e2 7c03 6412  }.|.d.u...s.|.d.
-000022f0: 6b02 9002 7212 7406 a00d 7c11 640c 6403  k...r.t...|.d.d.
-00002300: 8502 1900 a101 6419 7c0e 7600 9002 7200  ......d.|.v...r.
-00002310: 641a 6e02 6417 1400 7d15 740e 7c04 7c15  d.n.d...}.t.|.|.
-00002320: 1b00 8301 7d03 7c05 9002 728a 7408 641b  ....}.|...r.t.d.
-00002330: 7c0c 641c 9b04 641d 7c11 9b00 6416 7406  |.d...d.|...d.t.
-00002340: a00d 7c11 a101 6417 1400 6418 9b04 9d06  ..|...d...d.....
-00002350: 8301 0100 7408 641e 7c0c 641c 9b04 641d  ....t.d.|.d...d.
-00002360: 7c13 7c14 6602 9b00 6416 7c13 7c14 1400  |.|.f...d.|.|...
-00002370: 6417 1400 6418 9b04 9d06 8301 0100 7408  d...d.........t.
-00002380: 641f 7c04 6418 9b04 641d 7c03 6418 9b04  d.|.d...d.|.d...
-00002390: 6420 7c15 6421 9b04 9d06 8301 0100 7c05  d |.d!........|.
-000023a0: 9002 72aa 740f 7402 640f 7c12 7c03 8303  ..r.t.t.d.|.|...
-000023b0: 6422 6423 6424 6425 8d04 7d16 6e0c 7402  d"d#d$d%..}.n.t.
-000023c0: 640f 7c12 7c03 8303 7d16 7c16 4400 5de6  d.|.|...}.|.D.].
-000023d0: 7d17 7c17 7410 7c12 7c17 7c03 1700 8302  }.|.t.|.|.|.....
-000023e0: 0200 7d18 7d19 7c18 740e 7406 a00d 7c11  ..}.}.|.t.t...|.
-000023f0: 640c 6412 8502 1900 a101 8301 1400 7d1a  d.d...........}.
-00002400: 7c19 740e 7406 a00d 7c11 640c 6412 8502  |.t.t...|.d.d...
-00002410: 1900 a101 8301 1400 7d1b 7406 a011 7c1a  ........}.t...|.
-00002420: 7c0f 6b01 7c0f 7c1b 6b00 4000 a101 640f  |.k.|.|.k.@...d.
-00002430: 1900 7d1c 7403 7c1c 8301 640f 6b02 9003  ..}.t.|...d.k...
-00002440: 7232 9002 71ba 7412 7c0d 7c18 7c19 7c10  r2..q.t.|.|.|.|.
-00002450: 7c06 6426 8d05 a013 6412 7c14 a102 7d1d  |.d&....d.|...}.
-00002460: 7c0f 7c1c 1900 7c1a 1800 7d1e 740e 7406  |.|...|...}.t.t.
-00002470: a00a 7c0a 6403 7c0c 8502 1900 a101 8301  ..|.d.|.........
-00002480: 740e 7406 a00a 7c0a 6403 7c0c 640c 1700  t.t...|.d.|.d...
-00002490: 8502 1900 a101 8301 0200 7d1f 7d20 7c1d  ..........}.} |.
-000024a0: 7c1e 1900 7c0b 7c1c 7c1f 7c20 8502 6602  |...|.|.|.| ..f.
-000024b0: 3c00 9002 71ba 7414 a015 a100 0100 9001  <...q.t.........
-000024c0: 7188 7c0b 5300 2927 6141 0200 000a 2020  q.|.S.)'aA....  
-000024d0: 2020 6964 7820 3d20 6e70 2e73 6f72 7428    idx = np.sort(
-000024e0: 6e70 2e72 616e 646f 6d2e 7065 726d 7574  np.random.permut
-000024f0: 6174 696f 6e28 3230 3030 3030 3029 5b3a  ation(2000000)[:
-00002500: 3139 3030 3030 305d 290a 2020 2020 636f  1900000]).    co
-00002510: 6c73 203d 206e 702e 7261 6e64 6f6d 2e70  ls = np.random.p
-00002520: 6572 6d75 7461 7469 6f6e 2831 3030 3029  ermutation(1000)
-00002530: 5b3a 3930 305d 0a20 2020 2064 6174 6120  [:900].    data 
-00002540: 3d20 727a 2e75 7469 6c2e 6e70 792e 6c6f  = rz.util.npy.lo
-00002550: 6164 5f6e 7079 5f69 6478 5f6d 756c 7469  ad_npy_idx_multi
-00002560: 285b 2761 2e6e 7079 272c 2027 612e 6e70  (['a.npy', 'a.np
-00002570: 7927 5d2c 2069 6478 2c20 636f 6c73 5f6c  y'], idx, cols_l
-00002580: 6973 7420 3d20 5b63 6f6c 732c 2063 6f6c  ist = [cols, col
-00002590: 735d 2c20 0a20 2020 2020 2020 2020 2020  s], .           
-000025a0: 2020 2020 2020 2020 2020 2020 2062 6c6f               blo
-000025b0: 636b 5f73 697a 6520 3d20 3230 302c 2076  ck_size = 200, v
-000025c0: 6572 626f 7365 203d 2054 7275 652c 2075  erbose = True, u
-000025d0: 7365 5f6e 756d 6261 203d 2046 616c 7365  se_numba = False
-000025e0: 290a 0a20 2020 2072 7a2e 6765 745f 6d65  )..    rz.get_me
-000025f0: 6d5f 6375 7228 292c 2072 7a2e 6765 745f  m_cur(), rz.get_
-00002600: 6d65 6d5f 6d61 7828 293b 0a20 2020 2064  mem_max();.    d
-00002610: 6174 6120 3d20 6c6f 6164 5f6e 7079 5f69  ata = load_npy_i
-00002620: 6478 5f6d 756c 7469 285b 2761 2e6e 7079  dx_multi(['a.npy
-00002630: 272c 2027 622e 6e70 7927 5d2c 206d 6173  ', 'b.npy'], mas
-00002640: 6b5f 6964 782c 2063 6f6c 735f 6c69 7374  k_idx, cols_list
-00002650: 203d 205b 636f 6c73 2c20 636f 6c73 5d2c   = [cols, cols],
-00002660: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-00002670: 2020 2020 2020 2020 2020 2020 2062 6c6f               blo
-00002680: 636b 5f73 697a 6520 3d20 3230 302c 2076  ck_size = 200, v
-00002690: 6572 626f 7365 203d 2054 7275 6529 0a20  erbose = True). 
-000026a0: 2020 2070 7269 6e74 2864 6174 612e 7368     print(data.sh
-000026b0: 6170 6529 0a20 2020 2070 7269 6e74 2866  ape).    print(f
-000026c0: 277b 3420 2a20 6e70 2e70 726f 6428 6461  '{4 * np.prod(da
-000026d0: 7461 2e73 6861 7065 293a 2c2e 3066 7d27  ta.shape):,.0f}'
-000026e0: 290a 2020 2020 727a 2e67 6574 5f6d 656d  ).    rz.get_mem
-000026f0: 5f63 7572 2829 2c20 727a 2e67 6574 5f6d  _cur(), rz.get_m
-00002700: 656d 5f6d 6178 2829 3b0a 2020 2020 6301  em_max();.    c.
-00002710: 0000 0000 0000 0000 0000 0002 0000 0003  ................
-00002720: 0000 0013 0000 0073 1000 0000 6700 7c00  .......s....g.|.
-00002730: 5d08 7d01 8800 9102 7104 5300 720f 0000  ].}.....q.S.r...
-00002740: 0072 0f00 0000 a902 7213 0000 0072 0e00  .r......r....r..
-00002750: 0000 a901 7255 0000 0072 0f00 0000 7215  ....rU...r....r.
-00002760: 0000 0072 1600 0000 0e01 0000 7217 0000  ...r........r...
-00002770: 007a 266c 6f61 645f 6e70 795f 6964 785f  .z&load_npy_idx_
-00002780: 6d75 6c74 692e 3c6c 6f63 616c 733e 2e3c  multi.<locals>.<
-00002790: 6c69 7374 636f 6d70 3e4e 6301 0000 0000  listcomp>Nc.....
-000027a0: 0000 0000 0000 0002 0000 0003 0000 0053  ...............S
-000027b0: 0000 0073 1000 0000 6700 7c00 5d08 7d01  ...s....g.|.].}.
-000027c0: 6400 9102 7104 5300 a901 4e72 0f00 0000  d...q.S...Nr....
-000027d0: 7299 0000 0072 0f00 0000 720f 0000 0072  r....r....r....r
-000027e0: 1500 0000 7216 0000 0010 0100 0072 1700  ....r........r..
-000027f0: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
-00002800: 0000 0004 0000 0053 0000 0073 1800 0000  .......S...s....
-00002810: 6700 7c00 5d10 7d01 7400 7c01 8301 6400  g.|.].}.t.|...d.
-00002820: 1900 9102 7104 5300 a901 7201 0000 00a9  ....q.S...r.....
-00002830: 0172 2400 0000 a902 7213 0000 0072 1f00  .r$.....r....r..
-00002840: 0000 720f 0000 0072 0f00 0000 7215 0000  ..r....r....r...
-00002850: 0072 1600 0000 1101 0000 7217 0000 0063  .r........r....c
-00002860: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002870: 0500 0000 5300 0000 731c 0000 0067 007c  ....S...s....g.|
-00002880: 005d 147d 0174 0074 017c 0183 0164 0019  .].}.t.t.|...d..
-00002890: 0083 0191 0271 0453 00a9 0172 2e00 0000  .....q.S...r....
-000028a0: a902 7211 0000 0072 2400 0000 729e 0000  ..r....r$...r...
-000028b0: 0072 0f00 0000 720f 0000 0072 1500 0000  .r....r....r....
-000028c0: 7216 0000 0012 0100 0072 1700 0000 6301  r........r....c.
-000028d0: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-000028e0: 0000 0053 0000 0073 1400 0000 6700 7c00  ...S...s....g.|.
-000028f0: 5d0c 7d01 7c01 6400 1900 9102 7104 5300  ].}.|.d.....q.S.
-00002900: 729c 0000 0072 0f00 0000 a902 7213 0000  r....r......r...
-00002910: 0072 2800 0000 720f 0000 0072 0f00 0000  .r(...r....r....
-00002920: 7215 0000 0072 1600 0000 1301 0000 7217  r....r........r.
-00002930: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00002940: 0200 0000 0400 0000 5300 0000 7314 0000  ........S...s...
-00002950: 0067 007c 005d 0c7d 0174 007c 0183 0191  .g.|.].}.t.|....
-00002960: 0271 0453 0072 0f00 0000 a901 724c 0000  .q.S.r......rL..
-00002970: 00a9 0272 1300 0000 7277 0000 0072 0f00  ...r....rw...r..
-00002980: 0000 720f 0000 0072 1500 0000 7216 0000  ..r....r....r...
-00002990: 0014 0100 0072 1700 0000 fa0c 7061 7468  .....r......path
-000029a0: 5f6c 6973 7420 3d20 fa0d 2c20 6964 785f  _list = .., idx_
-000029b0: 6c69 7374 203d 20fa 0e2c 2063 6f6c 735f  list = .., cols_
-000029c0: 6c69 7374 203d 2072 0300 0000 fa12 6e5f  list = r......n_
-000029d0: 726f 7773 5f73 656c 5f6c 6973 7420 3d20  rows_sel_list = 
-000029e0: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
-000029f0: 0004 0000 0013 0000 0073 2c00 0000 6700  .........s,...g.
-00002a00: 7c00 5d24 5c02 7d01 7d02 7c02 6400 7500  |.]$\.}.}.|.d.u.
-00002a10: 7220 8800 7c01 1900 6401 1900 6e06 7400  r ..|...d...n.t.
-00002a20: 7c02 8301 9102 7104 5300 a902 4e72 2e00  |.....q.S...Nr..
-00002a30: 0000 72a2 0000 00a9 0372 1300 0000 7257  ..r......r....rW
-00002a40: 0000 0072 5000 0000 a901 da0a 7368 6170  ...rP.......shap
-00002a50: 655f 6c69 7374 720f 0000 0072 1500 0000  e_listr....r....
-00002a60: 7216 0000 0019 0100 0073 0400 0000 0601  r........s......
-00002a70: 06ff 7201 0000 007a 4d0a 2a2a 2a2a 2a2a  ..r....zM.******
-00002a80: 2a2a 2a2a 2049 4458 203c 3d20 312c 2059  **** IDX <= 1, Y
-00002a90: 4f55 204d 4159 2055 5345 206d 6173 6b20  OU MAY USE mask 
-00002aa0: 6173 206d 6173 6b5f 6964 782c 2050 4c45  as mask_idx, PLE
-00002ab0: 4153 4520 4348 4543 4b21 202a 2a2a 2a2a  ASE CHECK! *****
-00002ac0: 2a2a 2a2a 2a0a 723c 0000 0072 2e00 0000  *****.r<...r....
-00002ad0: 7279 0000 00e9 0000 1000 fa12 5b2b 5d20  ry..........[+] 
-00002ae0: 6461 7461 2e73 6861 7065 2020 3d20 727c  data.shape  = r|
-00002af0: 0000 0072 7b00 0000 727d 0000 0072 7a00  ...r{...r}...rz.
-00002b00: 0000 7273 0000 00fa 0d5b 2b5d 2064 6174  ..rs.....[+] dat
-00002b10: 615f 616c 6c5f da03 3032 6472 7f00 0000  a_all_..02dr....
-00002b20: fa0d 2020 2020 6461 7461 5f73 656c 5f72  ..    data_sel_r
-00002b30: 7e00 0000 7280 0000 0072 8100 0000 7a14  ~...r....r....z.
-00002b40: 6c6f 6164 5f6e 7079 5f69 6478 5f6d 756c  load_npy_idx_mul
-00002b50: 7469 2829 7245 0000 0054 7282 0000 0072  ti()rE...Tr....r
-00002b60: 8400 0000 2916 da04 7479 7065 724d 0000  ....)...typerM..
-00002b70: 0072 3000 0000 724c 0000 00da 0373 6574  .r0...rL.....set
-00002b80: da09 656e 756d 6572 6174 6572 1900 0000  ..enumerater....
-00002b90: 724f 0000 0072 8800 0000 da05 7a65 726f  rO...r......zero
-00002ba0: 73da 0373 756d 725e 0000 0072 2800 0000  s..sumr^...r(...
-00002bb0: 7236 0000 0072 8700 0000 7202 0000 0072  r6...r....r....r
-00002bc0: 8900 0000 728a 0000 0072 6500 0000 723d  ....r....re...r=
-00002bd0: 0000 0072 2900 0000 722a 0000 0029 21da  ...r)...r*...)!.
-00002be0: 0970 6174 685f 6c69 7374 7255 0000 00da  .path_listrU....
-00002bf0: 0963 6f6c 735f 6c69 7374 728b 0000 0072  .cols_listr....r
-00002c00: 8c00 0000 7251 0000 0072 5200 0000 da0a  ....rQ...rR.....
-00002c10: 6474 7970 655f 6c69 7374 da0b 6e5f 726f  dtype_list..n_ro
-00002c20: 7773 5f6c 6973 74da 0f6e 5f72 6f77 735f  ws_list..n_rows_
-00002c30: 7365 6c5f 6c69 7374 da0f 6e5f 636f 6c73  sel_list..n_cols
-00002c40: 5f73 656c 5f6c 6973 7472 4200 0000 da02  _sel_listrB.....
-00002c50: 7069 721f 0000 0072 2700 0000 7277 0000  pir....r'...rw..
-00002c60: 0072 5000 0000 7228 0000 0072 8e00 0000  .rP...r(...r....
-00002c70: 728f 0000 0072 9000 0000 7291 0000 0072  r....r....r....r
-00002c80: 5600 0000 7257 0000 0072 5800 0000 7259  V...rW...rX...rY
-00002c90: 0000 0072 9200 0000 7293 0000 0072 9400  ...r....r....r..
-00002ca0: 0000 7240 0000 0072 9500 0000 da02 6331  ..r@...r......c1
-00002cb0: da02 6332 720f 0000 00a9 0272 5500 0000  ..c2r......rU...
-00002cc0: 72ab 0000 0072 1500 0000 da12 6c6f 6164  r....r......load
-00002cd0: 5f6e 7079 5f69 6478 5f6d 756c 7469 fc00  _npy_idx_multi..
-00002ce0: 0000 736e 0000 0000 110c 011a 0108 0116  ..sn............
-00002cf0: 010e 010e 010e 010e 0122 0120 ff04 0212  .........". ....
-00002d00: 0108 ff04 020a 0106 ff06 0314 0108 031e  ................
-00002d10: 0114 0106 0208 012a 0312 0108 0108 0108  .......*........
-00002d20: 0108 0108 0108 0108 0108 0314 0124 010c  .............$..
-00002d30: 0206 0128 012a 0120 0306 011a 020c 0108  ...(.*. ........
-00002d40: 0114 011a 011a 011a 0112 021a 010c 0232  ...............2
-00002d50: 0118 010c 0172 c000 0000 e9a0 0f00 0063  .....r.........c
-00002d60: 0900 0000 0000 0000 0000 0000 2400 0000  ............$...
-00002d70: 0b00 0000 0300 0000 7382 0400 0088 0064  ........s......d
-00002d80: 0175 0072 1e64 0264 0384 0074 0074 017c  .u.r.d.d...t.t.|
-00002d90: 0083 0183 0144 0083 0189 0074 0288 0083  .....D.....t....
-00002da0: 0174 0375 0172 4487 0066 0164 0464 0384  .t.u.rD..f.d.d..
-00002db0: 0874 0074 017c 0083 0183 0144 0083 0189  .t.t.|.....D....
-00002dc0: 007c 0264 0175 0072 6264 0564 0384 0074  .|.d.u.rbd.d...t
-00002dd0: 0074 017c 0083 0183 0144 0083 017d 0264  .t.|.....D...}.d
-00002de0: 0664 0384 007c 0044 0083 017d 0964 0764  .d...|.D...}.d.d
-00002df0: 0384 007c 0044 0083 0189 0164 0864 0384  ...|.D.....d.d..
-00002e00: 007c 0044 0083 017d 0a64 0964 0384 0088  .|.D...}.d.d....
-00002e10: 0144 0083 017d 0b74 04a0 0564 0a64 0384  .D...}.t...d.d..
-00002e20: 0088 0044 0083 01a1 0172 be64 0b64 0384  ...D.....r.d.d..
-00002e30: 007c 0944 0083 017d 0c6e 0e64 0c64 0384  .|.D...}.n.d.d..
-00002e40: 0088 0044 0083 017d 0c74 017c 0083 0174  ...D...}.t.|...t
-00002e50: 0188 0083 016b 0272 ee74 017c 0083 0174  .....k.r.t.|...t
-00002e60: 017c 0283 016b 0290 0173 144a 0064 0d74  .|...k...s.J.d.t
-00002e70: 017c 0083 019b 0064 0e74 0188 0083 019b  .|.....d.t......
-00002e80: 0064 0f74 017c 0283 019b 009d 0683 0182  .d.t.|..........
-00002e90: 0174 0174 067c 0c83 0183 0164 106b 0290  .t.t.|.....d.k..
-00002ea0: 0173 344a 0064 117c 0c9b 009d 0283 0182  .s4J.d.|........
-00002eb0: 0187 0166 0164 1264 0384 0874 077c 0283  ...f.d.d...t.|..
-00002ec0: 0144 0083 017d 0d74 046a 087c 0c64 1319  .D...}.t.j.|.d..
-00002ed0: 0074 04a0 097c 0da1 0166 0274 046a 0a64  .t...|...f.t.j.d
-00002ee0: 148d 027d 0e7c 0464 0175 0090 0173 7c7c  ...}.|.d.u...s||
-00002ef0: 0464 156b 0290 0172 8264 167d 046e 087c  .d.k...r.d.}.n.|
-00002f00: 0464 1739 007d 047c 0564 186b 0590 0172  .d.9.}.|.d.k...r
-00002f10: b874 0b64 197c 0e6a 0c9b 0064 1a74 04a0  .t.d.|.j...d.t..
-00002f20: 0d7c 0e6a 0ca1 0164 1b14 0064 1c9b 049d  .|.j...d...d....
-00002f30: 0483 0101 0074 0074 017c 0083 0183 0144  .....t.t.|.....D
-00002f40: 0090 025d b67d 0f7c 007c 0f19 007d 107c  ...].}.|.|...}.|
-00002f50: 0a7c 0f19 007d 1188 007c 0f19 007d 127c  .|...}...|...}.|
-00002f60: 027c 0f19 007d 1388 017c 0f19 007d 147c  .|...}...|...}.|
-00002f70: 0b7c 0f19 007d 157c 0c7c 0f19 007d 167c  .|...}.|.|...}.|
-00002f80: 0d7c 0f19 007d 177c 0364 0175 0090 0273  .|...}.|.d.u...s
-00002f90: 1e7c 0364 156b 0290 0272 4e74 04a0 0d7c  .|.d.k...rNt...|
-00002fa0: 1464 1064 0185 0219 00a1 0164 1d7c 1176  .d.d.......d.|.v
-00002fb0: 0090 0272 3c64 1e6e 0264 1b14 007d 1874  ...r<d.n.d...}.t
-00002fc0: 0e7c 047c 181b 0083 017d 037c 0564 186b  .|.|.....}.|.d.k
-00002fd0: 0590 0272 ca74 0b64 1f7c 0f64 209b 0464  ...r.t.d.|.d ..d
-00002fe0: 217c 149b 0064 1a74 04a0 0d7c 14a1 0164  !|...d.t...|...d
-00002ff0: 1b14 0064 1c9b 049d 0683 0101 0074 0b64  ...d.........t.d
-00003000: 227c 0f64 209b 0464 217c 167c 1766 029b  "|.d ..d!|.|.f..
-00003010: 0064 1a7c 167c 1714 0064 1b14 0064 1c9b  .d.|.|...d...d..
-00003020: 049d 0683 0101 0074 0b64 237c 0464 1c9b  .......t.d#|.d..
-00003030: 0464 217c 0364 1c9b 0464 247c 1864 259b  .d!|.d...d$|.d%.
-00003040: 049d 0683 0101 007c 0564 106b 0590 0272  .......|.d.k...r
-00003050: ee74 0f74 0064 137c 157c 0383 0364 2664  .t.t.d.|.|...d&d
-00003060: 2764 2864 298d 047d 196e 0c74 0064 137c  'd(d)..}.n.t.d.|
-00003070: 157c 0383 037d 197c 1944 0090 015d 707d  .|...}.|.D...]p}
-00003080: 1a7c 1a74 107c 157c 1a7c 0317 0083 0202  .|.t.|.|.|......
-00003090: 007d 1b7d 1c7c 1b74 0e74 04a0 0d7c 1464  .}.}.|.t.t...|.d
-000030a0: 1064 1585 0219 00a1 0183 0114 007d 1d7c  .d...........}.|
-000030b0: 1c74 0e74 04a0 0d7c 1464 1064 1585 0219  .t.t...|.d.d....
-000030c0: 00a1 0183 0114 007d 1e7c 1264 0175 0190  .......}.|.d.u..
-000030d0: 0472 0074 04a0 117c 1d7c 126b 017c 127c  .r.t...|.|.k.|.|
-000030e0: 1e6b 0040 00a1 0164 1319 007d 1f74 017c  .k.@...d...}.t.|
-000030f0: 1f83 0164 136b 0290 0372 8290 0271 fe74  ...d.k...r...q.t
-00003100: 127c 107c 1b7c 1c7c 137c 067c 077c 0864  .|.|.|.|.|.|.|.d
-00003110: 2a8d 07a0 1364 157c 17a1 027d 207c 127c  *....d.|...} |.|
-00003120: 1f19 007c 1d18 007d 2174 0e74 04a0 097c  ...|...}!t.t...|
-00003130: 0d64 017c 0f85 0219 00a1 0183 0174 0e74  .d.|.........t.t
-00003140: 04a0 097c 0d64 017c 0f64 1017 0085 0219  ...|.d.|.d......
-00003150: 00a1 0183 0102 007d 227d 2374 147c 0e7c  .......}"}#t.|.|
-00003160: 1f74 04a0 157c 227c 23a1 0274 167c 207c  .t...|"|#..t.| |
-00003170: 2164 1364 2b8d 0383 0401 006e 6e74 127c  !d.d+......nnt.|
-00003180: 107c 1b7c 1c7c 137c 067c 077c 0864 2a8d  .|.|.|.|.|.|.d*.
-00003190: 07a0 1364 157c 17a1 027d 2074 0e74 04a0  ...d.|...} t.t..
-000031a0: 097c 0d64 017c 0f85 0219 00a1 0183 0174  .|.d.|.........t
-000031b0: 0e74 04a0 097c 0d64 017c 0f64 1017 0085  .t...|.d.|.d....
-000031c0: 0219 00a1 0183 0102 007d 227d 2374 147c  .........}"}#t.|
-000031d0: 0e74 04a0 157c 1d7c 1ea1 0274 04a0 157c  .t...|.|...t...|
-000031e0: 227c 23a1 027c 2083 0401 0090 0271 fe74  "|#..| ......q.t
-000031f0: 17a0 18a1 0001 0090 0171 c47c 0e53 0029  .........q.|.S.)
-00003200: 2c7a b00a 2020 2020 6120 3d20 727a 5f6c  ,z..    a = rz_l
-00003210: 6f61 645f 6e70 795f 6964 785f 6d75 6c74  oad_npy_idx_mult
-00003220: 6928 5b70 6174 682c 2070 6174 685d 2c20  i([path, path], 
-00003230: 4e6f 6e65 2c20 636f 6c73 5f6c 6973 7420  None, cols_list 
-00003240: 3d20 5b6e 702e 6172 616e 6765 2830 2c20  = [np.arange(0, 
-00003250: 3130 3030 292c 206e 702e 6172 616e 6765  1000), np.arange
-00003260: 2831 3030 302c 2032 3030 3029 5d2c 2076  (1000, 2000)], v
-00003270: 6572 626f 7365 3d54 7275 652c 206e 5f6a  erbose=True, n_j
-00003280: 6f62 7320 3d31 362c 206b 7469 6d65 7320  obs =16, ktimes 
-00003290: 3d20 3130 2c20 626c 6f63 6b5f 7369 7a65  = 10, block_size
-000032a0: 203d 2034 3030 3029 2023 2032 3073 0a20   = 4000) # 20s. 
-000032b0: 2020 204e 6301 0000 0000 0000 0000 0000     Nc...........
-000032c0: 0002 0000 0003 0000 0053 0000 0073 1000  .........S...s..
-000032d0: 0000 6700 7c00 5d08 7d01 6400 9102 7104  ..g.|.].}.d...q.
-000032e0: 5300 729b 0000 0072 0f00 0000 7299 0000  S.r....r....r...
-000032f0: 0072 0f00 0000 720f 0000 0072 1500 0000  .r....r....r....
-00003300: 7216 0000 005a 0100 0072 1700 0000 7a29  r....Z...r....z)
-00003310: 727a 5f6c 6f61 645f 6e70 795f 6964 785f  rz_load_npy_idx_
-00003320: 6d75 6c74 692e 3c6c 6f63 616c 733e 2e3c  multi.<locals>.<
-00003330: 6c69 7374 636f 6d70 3e63 0100 0000 0000  listcomp>c......
-00003340: 0000 0000 0000 0200 0000 0300 0000 1300  ................
-00003350: 0000 7310 0000 0067 007c 005d 087d 0188  ..s....g.|.].}..
-00003360: 0091 0271 0453 0072 0f00 0000 720f 0000  ...q.S.r....r...
-00003370: 0072 9900 0000 729a 0000 0072 0f00 0000  .r....r....r....
-00003380: 7215 0000 0072 1600 0000 5c01 0000 7217  r....r....\...r.
-00003390: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-000033a0: 0200 0000 0300 0000 5300 0000 7310 0000  ........S...s...
-000033b0: 0067 007c 005d 087d 0164 0091 0271 0453  .g.|.].}.d...q.S
-000033c0: 0072 9b00 0000 720f 0000 0072 9900 0000  .r....r....r....
-000033d0: 720f 0000 0072 0f00 0000 7215 0000 0072  r....r....r....r
-000033e0: 1600 0000 5e01 0000 7217 0000 0063 0100  ....^...r....c..
-000033f0: 0000 0000 0000 0000 0000 0200 0000 0400  ................
-00003400: 0000 5300 0000 7314 0000 0067 007c 005d  ..S...s....g.|.]
-00003410: 0c7d 0174 007c 0183 0191 0271 0453 0072  .}.t.|.....q.S.r
-00003420: 0f00 0000 729d 0000 0072 9e00 0000 720f  ....r....r....r.
-00003430: 0000 0072 0f00 0000 7215 0000 0072 1600  ...r....r....r..
-00003440: 0000 6001 0000 7217 0000 0063 0100 0000  ..`...r....c....
-00003450: 0000 0000 0000 0000 0200 0000 0400 0000  ................
-00003460: 5300 0000 7318 0000 0067 007c 005d 107d  S...s....g.|.].}
-00003470: 0174 007c 0183 0164 0019 0091 0271 0453  .t.|...d.....q.S
-00003480: 0072 9c00 0000 729d 0000 0072 9e00 0000  .r....r....r....
-00003490: 720f 0000 0072 0f00 0000 7215 0000 0072  r....r....r....r
-000034a0: 1600 0000 6101 0000 7217 0000 0063 0100  ....a...r....c..
-000034b0: 0000 0000 0000 0000 0000 0200 0000 0500  ................
-000034c0: 0000 5300 0000 731c 0000 0067 007c 005d  ..S...s....g.|.]
-000034d0: 147d 0174 0074 017c 0183 0164 0019 0083  .}.t.t.|...d....
-000034e0: 0191 0271 0453 0072 9f00 0000 72a0 0000  ...q.S.r....r...
-000034f0: 0072 9e00 0000 720f 0000 0072 0f00 0000  .r....r....r....
-00003500: 7215 0000 0072 1600 0000 6201 0000 7217  r....r....b...r.
-00003510: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00003520: 0200 0000 0400 0000 5300 0000 7314 0000  ........S...s...
-00003530: 0067 007c 005d 0c7d 017c 0164 0019 0091  .g.|.].}.|.d....
-00003540: 0271 0453 0072 9c00 0000 720f 0000 0072  .q.S.r....r....r
-00003550: a100 0000 720f 0000 0072 0f00 0000 7215  ....r....r....r.
-00003560: 0000 0072 1600 0000 6301 0000 7217 0000  ...r....c...r...
-00003570: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
-00003580: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
-00003590: 007c 005d 0c7d 017c 0164 0075 0091 0271  .|.].}.|.d.u...q
-000035a0: 0453 0072 9b00 0000 720f 0000 0072 a300  .S.r....r....r..
-000035b0: 0000 720f 0000 0072 0f00 0000 7215 0000  ..r....r....r...
-000035c0: 0072 1600 0000 6401 0000 7217 0000 0063  .r....d...r....c
-000035d0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-000035e0: 0400 0000 5300 0000 7318 0000 0067 007c  ....S...s....g.|
-000035f0: 005d 107d 017c 0164 0019 0064 0019 0091  .].}.|.d...d....
-00003600: 0271 0453 0072 9c00 0000 720f 0000 0029  .q.S.r....r....)
-00003610: 0272 1300 0000 7253 0000 0072 0f00 0000  .r....rS...r....
-00003620: 720f 0000 0072 1500 0000 7216 0000 0065  r....r....r....e
-00003630: 0100 0072 1700 0000 6301 0000 0000 0000  ...r....c.......
-00003640: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
-00003650: 0073 1400 0000 6700 7c00 5d0c 7d01 7400  .s....g.|.].}.t.
-00003660: 7c01 8301 9102 7104 5300 720f 0000 0072  |.....q.S.r....r
-00003670: a200 0000 72a3 0000 0072 0f00 0000 720f  ....r....r....r.
-00003680: 0000 0072 1500 0000 7216 0000 0067 0100  ...r....r....g..
-00003690: 0072 1700 0000 72a4 0000 0072 a500 0000  .r....r....r....
-000036a0: 72a6 0000 0072 0300 0000 72a7 0000 0063  r....r....r....c
-000036b0: 0100 0000 0000 0000 0000 0000 0300 0000  ................
-000036c0: 0400 0000 1300 0000 732c 0000 0067 007c  ........s,...g.|
-000036d0: 005d 245c 027d 017d 027c 0264 0075 0072  .]$\.}.}.|.d.u.r
-000036e0: 2088 007c 0119 0064 0119 006e 0674 007c   ..|...d...n.t.|
-000036f0: 0283 0191 0271 0453 0072 a800 0000 72a2  .....q.S.r....r.
-00003700: 0000 0072 a900 0000 72aa 0000 0072 0f00  ...r....r....r..
-00003710: 0000 7215 0000 0072 1600 0000 6b01 0000  ..r....r....k...
-00003720: 7304 0000 0006 0106 ff72 0100 0000 723c  s........r....r<
-00003730: 0000 0072 2e00 0000 7279 0000 0072 ac00  ...r....ry...r..
-00003740: 0000 e902 0000 0072 ad00 0000 727c 0000  .......r....r|..
-00003750: 0072 7b00 0000 727d 0000 0072 7a00 0000  .r{...r}...rz...
-00003760: 7273 0000 0072 ae00 0000 72af 0000 0072  rs...r....r....r
-00003770: 7f00 0000 72b0 0000 0072 7e00 0000 7280  ....r....r~...r.
-00003780: 0000 0072 8100 0000 7a17 727a 5f6c 6f61  ...r....z.rz_loa
-00003790: 645f 6e70 795f 6964 785f 6d75 6c74 6928  d_npy_idx_multi(
-000037a0: 2972 4500 0000 5472 8200 0000 2906 723e  )rE...Tr....).r>
-000037b0: 0000 0072 3f00 0000 7250 0000 0072 5200  ...r?...rP...rR.
-000037c0: 0000 726f 0000 0072 7000 0000 7249 0000  ..ro...rp...rI..
-000037d0: 0029 1972 3000 0000 724c 0000 0072 b100  .).r0...rL...r..
-000037e0: 0000 724d 0000 0072 1900 0000 da03 616c  ..rM...r......al
-000037f0: 6c72 b200 0000 72b3 0000 0072 4b00 0000  lr....r....rK...
-00003800: 72b5 0000 0072 5e00 0000 7288 0000 0072  r....r^...r....r
-00003810: 2800 0000 7236 0000 0072 8700 0000 7202  (...r6...r....r.
-00003820: 0000 0072 8900 0000 728a 0000 0072 7200  ...r....r....rr.
-00003830: 0000 723d 0000 0072 0900 0000 724e 0000  ..r=...r....rN..
-00003840: 0072 0600 0000 7229 0000 0072 2a00 0000  .r....r)...r*...
-00003850: 2924 72b6 0000 0072 5500 0000 72b7 0000  )$r....rU...r...
-00003860: 0072 8b00 0000 728c 0000 0072 5100 0000  .r....r....rQ...
-00003870: 7252 0000 0072 6f00 0000 7270 0000 005a  rR...ro...rp...Z
-00003880: 0b68 6561 6465 725f 6c69 7374 72b8 0000  .header_listr...
-00003890: 0072 b900 0000 72ba 0000 0072 bb00 0000  .r....r....r....
-000038a0: 7242 0000 0072 bc00 0000 721f 0000 0072  rB...r....r....r
-000038b0: 2700 0000 7277 0000 0072 5000 0000 7228  '...rw...rP...r(
-000038c0: 0000 0072 8e00 0000 728f 0000 0072 9000  ...r....r....r..
-000038d0: 0000 7291 0000 0072 5600 0000 7257 0000  ..r....rV...rW..
-000038e0: 0072 5800 0000 7259 0000 0072 9200 0000  .rX...rY...r....
-000038f0: 7293 0000 0072 9400 0000 7240 0000 0072  r....r....r@...r
-00003900: 9500 0000 72bd 0000 0072 be00 0000 720f  ....r....r....r.
-00003910: 0000 0072 bf00 0000 7215 0000 00da 1572  ...r....r......r
-00003920: 7a5f 6c6f 6164 5f6e 7079 5f69 6478 5f6d  z_load_npy_idx_m
-00003930: 756c 7469 5101 0000 7376 0000 0000 0808  ultiQ...sv......
-00003940: 0116 010c 011a 0108 0116 020e 010e 010e  ................
-00003950: 010e 0114 0110 020e 0124 0120 ff04 0220  .........$. ... 
-00003960: 010a 0106 ff06 041e 0114 0106 0208 012e  ................
-00003970: 0312 0108 0108 0108 0108 0108 0108 0108  ................
-00003980: 0108 0314 0124 010c 020a 0128 012a 0120  .....$.....(.*. 
-00003990: 0324 010c 020a 0114 011a 011a 020a 011a  .$..............
-000039a0: 0112 021e 010c 0232 0122 021e 0132 0122  .......2."...2."
-000039b0: 010c 0172 c400 0000 7244 0000 0063 0400  ...r....rD...c..
-000039c0: 0000 0000 0000 0000 0000 0a00 0000 0600  ................
-000039d0: 0000 4300 0000 73c8 0000 0074 006a 0174  ..C...s....t.j.t
-000039e0: 027c 0083 0174 027c 0183 0166 0274 006a  .|...t.|...f.t.j
-000039f0: 0364 018d 027d 0474 0474 0564 0274 027c  .d...}.t.t.d.t.|
-00003a00: 0183 017c 0283 0383 017d 057c 057c 0564  ...|.....}.|.|.d
-00003a10: 0319 0074 027c 0183 016b 0372 4c74 027c  ...t.|...k.rLt.|
-00003a20: 0183 0167 016e 0267 0037 007d 057c 0372  ...g.n.g.7.}.|.r
-00003a30: 7074 0674 0574 027c 0583 0164 0418 0083  pt.t.t.|...d....
-00003a40: 0164 0564 0664 078d 036e 0e74 0574 027c  .d.d.d...n.t.t.|
-00003a50: 0583 0164 0418 0083 017d 067c 0644 005d  ...d.....}.|.D.]
-00003a60: 3e7d 077c 057c 0719 007c 057c 0764 0417  >}.|.|...|.|.d..
-00003a70: 0019 0002 007d 087d 097c 007c 017c 087c  .....}.}.|.|.|.|
-00003a80: 0985 0219 0019 00a0 07a1 007c 0464 0064  ...........|.d.d
-00003a90: 0085 027c 087c 0985 0266 023c 0071 847c  ...|.|...f.<.q.|
-00003aa0: 0453 0029 084e 723c 0000 0072 0100 0000  .S.).Nr<...r....
-00003ab0: 722e 0000 0072 0300 0000 7245 0000 0054  r....r....rE...T
-00003ac0: 7246 0000 0029 0872 1900 0000 72b4 0000  rF...).r....r...
-00003ad0: 0072 4c00 0000 725e 0000 0072 4d00 0000  .rL...r^...rM...
-00003ae0: 7230 0000 0072 0200 0000 5a08 746f 5f6e  r0...r....Z.to_n
-00003af0: 756d 7079 290a da02 6466 7250 0000 00da  umpy)...dfrP....
-00003b00: 016b 7251 0000 0072 4000 0000 5a03 6369  .krQ...r@...Z.ci
-00003b10: 6a72 5600 0000 7257 0000 00da 0263 695a  jrV...rW.....ciZ
-00003b20: 0263 6a72 0f00 0000 720f 0000 0072 1500  .cjr....r....r..
-00003b30: 0000 da09 5f74 6f5f 6e75 6d70 79a5 0100  ...._to_numpy...
-00003b40: 0073 1000 0000 0001 1c01 1401 2201 2e01  .s.........."...
-00003b50: 0801 1601 2601 72c8 0000 00da 0270 6463  ....&.r......pdc
-00003b60: 0300 0000 0000 0000 0000 0000 0800 0000  ................
-00003b70: 0900 0000 4300 0000 73ec 0000 007c 0164  ....C...s....|.d
-00003b80: 0175 0072 1a64 0264 0384 0074 007c 0083  .u.r.d.d...t.|..
-00003b90: 0144 0083 017d 017c 0264 046b 0272 4274  .D...}.|.d.k.rBt
-00003ba0: 016a 02a0 037c 00a1 01a0 04a1 006a 0564  .j...|.......j.d
-00003bb0: 0564 068d 017d 037c 017c 035f 066e a67c  .d...}.|.|._.n.|
-00003bc0: 0264 076b 0272 e864 0864 0384 007c 0044  .d.k.r.d.d...|.D
-00003bd0: 0083 017d 0474 07a0 08a1 007d 0374 0974  ...}.t.....}.t.t
-00003be0: 007c 0483 0183 0144 005d 7a7d 057c 007c  .|.....D.]z}.|.|
-00003bf0: 0519 007d 067c 0564 0917 0074 007c 0483  ...}.|.d...t.|..
-00003c00: 016b 0072 a674 0aa0 0b7c 0674 0aa0 0c7c  .k.r.t...|.t...|
-00003c10: 047c 0564 0917 0064 0185 0219 00a1 01a1  .|.d...d........
-00003c20: 027d 0674 097c 0564 0918 0064 0a64 0a83  .}.t.|.d...d.d..
-00003c30: 0344 005d 147d 0774 0aa0 0d7c 067c 047c  .D.].}.t...|.|.|
-00003c40: 0719 00a1 027d 0671 b67c 03a0 0e74 07a0  .....}.q.|...t..
-00003c50: 0f74 107c 017c 0519 0083 017c 06a1 02a1  .t.|.|.....|....
-00003c60: 017d 0371 6c7c 0353 0029 0b7a 7c0a 2020  .}.ql|.S.).z|.  
-00003c70: 2020 6466 5f69 6420 3d20 727a 2e75 7469    df_id = rz.uti
-00003c80: 6c2e 6e70 792e 6765 745f 6466 5f69 645f  l.npy.get_df_id_
-00003c90: 616c 6c28 5b6e 702e 6172 616e 6765 2878  all([np.arange(x
-00003ca0: 292e 6173 7479 7065 286e 702e 696e 7433  ).astype(np.int3
-00003cb0: 3229 2066 6f72 2078 2069 6e20 7368 6170  2) for x in shap
-00003cc0: 655d 2c20 636f 6c73 5f69 6420 3d20 5b27  e], cols_id = ['
-00003cd0: 6461 7465 272c 2027 7469 6427 2c20 2769  date', 'tid', 'i
-00003ce0: 6427 5d29 0a20 2020 204e 6301 0000 0000  d']).    Nc.....
-00003cf0: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
-00003d00: 0000 0073 1600 0000 6700 7c00 5d0e 7d01  ...s....g.|.].}.
-00003d10: 6400 7c01 9b00 9d02 9102 7104 5300 2901  d.|.......q.S.).
-00003d20: 7214 0000 0072 0f00 0000 2902 7213 0000  r....r....).r...
-00003d30: 0072 5700 0000 720f 0000 0072 0f00 0000  .rW...r....r....
-00003d40: 7215 0000 0072 1600 0000 b301 0000 7217  r....r........r.
-00003d50: 0000 007a 2167 6574 5f64 665f 6964 5f61  ...z!get_df_id_a
-00003d60: 6c6c 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  ll.<locals>.<lis
-00003d70: 7463 6f6d 703e 72c9 0000 0054 a901 5a04  tcomp>r....T..Z.
-00003d80: 6472 6f70 da02 706c 6301 0000 0000 0000  drop..plc.......
-00003d90: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
-00003da0: 0073 1400 0000 6700 7c00 5d0c 7d01 7400  .s....g.|.].}.t.
-00003db0: 7c01 8301 9102 7104 5300 720f 0000 0072  |.....q.S.r....r
-00003dc0: a200 0000 7212 0000 0072 0f00 0000 720f  ....r....r....r.
-00003dd0: 0000 0072 1500 0000 7216 0000 00b8 0100  ...r....r.......
-00003de0: 0072 1700 0000 7203 0000 0072 2e00 0000  .r....r....r....
-00003df0: 2911 724c 0000 0072 c900 0000 da0a 4d75  ).rL...r......Mu
-00003e00: 6c74 6949 6e64 6578 da0c 6672 6f6d 5f70  ltiIndex..from_p
-00003e10: 726f 6475 6374 da08 746f 5f66 7261 6d65  roduct..to_frame
-00003e20: da0b 7265 7365 745f 696e 6465 78da 0763  ..reset_index..c
-00003e30: 6f6c 756d 6e73 72cb 0000 00da 0944 6174  olumnsr......Dat
-00003e40: 6146 7261 6d65 7230 0000 0072 1900 0000  aFramer0...r....
-00003e50: da06 7265 7065 6174 7236 0000 005a 0474  ..repeatr6...Z.t
-00003e60: 696c 65da 0c77 6974 685f 636f 6c75 6d6e  ile..with_column
-00003e70: 735a 0653 6572 6965 7372 1100 0000 2908  sZ.Seriesr....).
-00003e80: da07 6964 5f6c 6973 74da 0763 6f6c 735f  ..id_list..cols_
-00003e90: 6964 7263 0000 00da 0964 665f 6964 5f61  idrc.....df_id_a
-00003ea0: 6c6c 7228 0000 0072 5700 0000 7214 0000  llr(...rW...r...
-00003eb0: 00da 016a 720f 0000 0072 0f00 0000 7215  ...jr....r....r.
-00003ec0: 0000 00da 0d67 6574 5f64 665f 6964 5f61  .....get_df_id_a
-00003ed0: 6c6c af01 0000 731a 0000 0000 041a 0108  ll....s.........
-00003ee0: 0118 0108 0108 010e 0108 0110 0108 012e  ................
-00003ef0: 0126 011c 0172 d800 0000 6306 0000 0000  .&...r....c.....
-00003f00: 0000 0000 0000 0010 0000 0007 0000 0043  ...............C
-00003f10: 0000 0073 0c02 0000 7c00 6401 1900 7d06  ...s....|.d...}.
-00003f20: 7c03 4400 5d26 7d07 7c06 a000 6402 7c07  |.D.]&}.|...d.|.
-00003f30: 9b00 9d02 7c06 6a01 6a02 7c07 1900 a003  ....|.j.j.|.....
-00003f40: 7404 6a05 a101 a102 0100 710c 6403 6404  t.j.......q.d.d.
-00003f50: 8400 7c03 4400 8301 7d03 7c06 a006 7c01  ..|.D...}.|...|.
-00003f60: a101 7d08 7c04 6405 7500 7278 6700 7d04  ..}.|.d.u.rxg.}.
-00003f70: 7c01 4400 5d1a 7d07 7c04 a007 7408 7c08  |.D.].}.|...t.|.
-00003f80: 7c07 1900 a009 a100 8301 a101 0100 715c  |.............q\
-00003f90: 6406 6404 8400 7c04 4400 8301 7d09 740a  d.d...|.D...}.t.
-00003fa0: 6a0b a00c 7c04 a101 a00d a100 6a0e 6407  j...|.......j.d.
-00003fb0: 6408 8d01 7d0a 7c01 7c0a 5f0f 7c0a a003  d...}.|.|._.|...
-00003fc0: 7c08 6a10 a011 a100 a101 7d0a 7412 a013  |.j.......}.t...
-00003fd0: 7c0a a101 7d0a 7c06 a014 7c01 7c02 1700  |...}.|...|.|...
-00003fe0: 7c03 1700 a101 7d0b 7e06 7415 a016 a100  |.....}.~.t.....
-00003ff0: 0100 7c05 72ec 7c00 6401 3d00 7415 a016  ..|.r.|.d.=.t...
-00004000: a100 0100 7c0a 6a17 7c0b 7c01 6409 640a  ....|.j.|.|.d.d.
-00004010: 8d03 7d0c 7c0b 6a0f 4400 5d10 7d07 7c0b  ..}.|.j.D.].}.|.
-00004020: a018 7c07 a101 0100 9001 7102 7e0b 7415  ..|.......q.~.t.
-00004030: a016 a100 0100 7e0a 7415 a016 a100 0100  ......~.t.......
-00004040: 7c02 7c03 1700 4400 5d44 7d07 7419 7c0c  |.|...D.]D}.t.|.
-00004050: 7c07 1900 6a1a 8301 a01b a100 7d0d 640b  |...j.......}.d.
-00004060: 7c0d 7601 9001 7230 640c 7c0d 7601 9001  |.v...r0d.|.v...
-00004070: 7230 7c0c a01c 7c0c 7c07 1900 a01d 7412  r0|...|.|.....t.
-00004080: 6a1e 6a1f a101 a101 7d0c 9001 7130 6405  j.j.....}...q0d.
-00004090: 7d0e 7420 7c03 8301 640d 6b04 9001 72b4  }.t |...d.k...r.
-000040a0: 7421 7c0c 7c03 8302 7d0e 7c0e a022 6700  t!|.|...}.|.."g.
-000040b0: 7c09 a201 7420 7c03 8301 9101 5200 a101  |...t |.....R...
-000040c0: 7d0e 7404 a023 7c0e a101 7d0e 7421 7c0c  }.t..#|...}.t!|.
-000040d0: 7c02 8302 7d0f 7c0c 6a0f 4400 5d10 7d07  |...}.|.j.D.].}.
-000040e0: 7c0c a018 7c07 a101 0100 9001 71c4 7e0c  |...|.......q.~.
-000040f0: 7415 a016 a100 0100 7c0f a022 6700 7c09  t.......|.."g.|.
-00004100: a201 7420 7c02 8301 9101 5200 a101 7d0f  ..t |.....R...}.
-00004110: 7404 a023 7c0f a101 7d0f 7c0f 7c0e 7c04  t..#|...}.|.|.|.
-00004120: 6603 5300 290e 61d0 0100 000a 2020 2020  f.S.).a.....    
-00004130: 646d 5f64 6963 7420 3d20 7b27 646d 273a  dm_dict = {'dm':
-00004140: 2064 6d7d 0a20 2020 2064 656c 2064 6d3b   dm}.    del dm;
-00004150: 2067 632e 636f 6c6c 6563 7428 290a 0a20   gc.collect().. 
-00004160: 2020 2063 6f6c 735f 6964 203d 205b 636f     cols_id = [co
-00004170: 6c5f 6461 7465 2c20 636f 6c5f 6964 5d0a  l_date, col_id].
-00004180: 2020 2020 636f 6c73 5f6d 6173 6b20 3d20      cols_mask = 
-00004190: 5b27 7472 6169 6e27 2c20 2774 6573 7427  ['train', 'test'
-000041a0: 2c20 2776 616c 6964 272c 2027 616c 6c27  , 'valid', 'all'
-000041b0: 2c20 277a 6474 275d 0a20 2020 2063 6f6c  , 'zdt'].    col
-000041c0: 735f 6461 7461 203d 205b 636f 6c5f 6c61  s_data = [col_la
-000041d0: 6265 6c5d 202b 2063 6f6c 735f 6665 610a  bel] + cols_fea.
-000041e0: 0a20 2020 2064 665f 6964 203d 2064 6d5f  .    df_id = dm_
-000041f0: 6469 6374 5b27 646d 275d 2e67 6574 5f63  dict['dm'].get_c
-00004200: 6f6c 735f 7061 6e64 6173 2863 6f6c 735f  ols_pandas(cols_
-00004210: 6964 290a 2020 2020 6964 5f6c 6973 7420  id).    id_list 
-00004220: 3d20 5b73 6f72 7465 6428 6466 5f69 645b  = [sorted(df_id[
-00004230: 636f 6c5d 2e75 6e69 7175 6528 2929 2066  col].unique()) f
-00004240: 6f72 2063 6f6c 2069 6e20 636f 6c73 5f69  or col in cols_i
-00004250: 645d 0a20 2020 2069 645f 6c69 7374 5b30  d].    id_list[0
-00004260: 5d20 3d20 6964 5f6c 6973 745b 305d 235b  ] = id_list[0]#[
-00004270: 3a35 3030 5d0a 0a20 2020 2061 5f64 6174  :500]..    a_dat
-00004280: 612c 2061 5f6d 6173 6b2c 2069 645f 6c69  a, a_mask, id_li
-00004290: 7374 5f72 6574 203d 2020 2020 2020 2020  st_ret =        
-000042a0: 2074 6f5f 6d64 6e70 7928 646d 5f64 6963   to_mdnpy(dm_dic
-000042b0: 742c 2063 6f6c 735f 6964 2c20 636f 6c73  t, cols_id, cols
-000042c0: 5f64 6174 612c 2063 6f6c 735f 6d61 736b  _data, cols_mask
-000042d0: 2c20 6964 5f6c 6973 7420 3d20 6964 5f6c  , id_list = id_l
-000042e0: 6973 742c 2066 7265 655f 7261 7720 3d20  ist, free_raw = 
-000042f0: 4661 6c73 6529 0a20 2020 20da 0264 6dda  False).    ..dm.
-00004300: 054d 4153 4b5f 6301 0000 0000 0000 0000  .MASK_c.........
-00004310: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
-00004320: 1600 0000 6700 7c00 5d0e 7d01 6400 7c01  ....g.|.].}.d.|.
-00004330: 9b00 9d02 9102 7104 5300 2901 72da 0000  ......q.S.).r...
-00004340: 0072 0f00 0000 2902 7213 0000 00da 0363  .r....).r......c
-00004350: 6f6c 720f 0000 0072 0f00 0000 7215 0000  olr....r....r...
-00004360: 0072 1600 0000 d501 0000 7217 0000 007a  .r........r....z
-00004370: 1c74 6f5f 6d64 6e70 792e 3c6c 6f63 616c  .to_mdnpy.<local
-00004380: 733e 2e3c 6c69 7374 636f 6d70 3e4e 6301  s>.<listcomp>Nc.
-00004390: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-000043a0: 0000 0053 0000 0073 1400 0000 6700 7c00  ...S...s....g.|.
-000043b0: 5d0c 7d01 7400 7c01 8301 9102 7104 5300  ].}.t.|.....q.S.
-000043c0: 720f 0000 0072 a200 0000 7212 0000 0072  r....r....r....r
-000043d0: 0f00 0000 720f 0000 0072 1500 0000 7216  ....r....r....r.
-000043e0: 0000 00dd 0100 0072 1700 0000 5472 ca00  .......r....Tr..
-000043f0: 0000 da04 6c65 6674 2902 da02 6f6e da03  ....left)...on..
-00004400: 686f 7772 5e00 0000 5a03 6633 3272 0100  howr^...Z.f32r..
-00004410: 0000 2924 5a0a 7365 745f 6279 5f63 6f6c  ..)$Z.set_by_col
-00004420: 5a06 6d61 736b 6572 5a09 6d61 736b 5f44  Z.maskerZ.mask_D
-00004430: 4943 545a 0661 7374 7970 6572 1900 0000  ICTZ.astyper....
-00004440: 5a05 696e 7433 325a 0f67 6574 5f63 6f6c  Z.int32Z.get_col
-00004450: 735f 7061 6e64 6173 da06 6170 7065 6e64  s_pandas..append
-00004460: da06 736f 7274 6564 da06 756e 6971 7565  ..sorted..unique
-00004470: 72c9 0000 0072 cc00 0000 72cd 0000 0072  r....r....r....r
-00004480: ce00 0000 72cf 0000 0072 d000 0000 5a06  ....r....r....Z.
-00004490: 6474 7970 6573 5a07 746f 5f64 6963 7472  dtypesZ.to_dictr
-000044a0: cb00 0000 72d1 0000 005a 0f67 6574 5f63  ....r....Z.get_c
-000044b0: 6f6c 735f 706f 6c61 7273 7229 0000 0072  ols_polarsr)...r
-000044c0: 2a00 0000 721d 0000 005a 0d64 726f 705f  *...r....Z.drop_
-000044d0: 696e 5f70 6c61 6365 7211 0000 0072 2700  in_placer....r'.
-000044e0: 0000 da05 6c6f 7765 7272 d300 0000 da04  ....lowerr......
-000044f0: 6361 7374 5a09 6461 7461 7479 7065 735a  castZ.datatypesZ
-00004500: 0746 6c6f 6174 3332 724c 0000 0072 c800  .Float32rL...r..
-00004510: 0000 723d 0000 0072 8600 0000 2910 da07  ..r=...r....)...
-00004520: 646d 5f64 6963 7472 d500 0000 da09 636f  dm_dictr......co
-00004530: 6c73 5f64 6174 61da 0963 6f6c 735f 6d61  ls_data..cols_ma
-00004540: 736b 72d4 0000 00da 0866 7265 655f 7261  skr......free_ra
-00004550: 7772 d900 0000 72db 0000 005a 0564 665f  wr....r....Z.df_
-00004560: 6964 7228 0000 0072 d600 0000 5a0b 6466  idr(...r....Z.df
-00004570: 5f76 5f6f 7269 6769 6e5a 0464 665f 765a  _v_originZ.df_vZ
-00004580: 0874 7970 655f 6f6c 64da 0661 5f6d 6173  .type_old..a_mas
-00004590: 6bda 0661 5f64 6174 6172 0f00 0000 720f  k..a_datar....r.
-000045a0: 0000 0072 1500 0000 da08 746f 5f6d 646e  ...r......to_mdn
-000045b0: 7079 c201 0000 734a 0000 0000 1008 0108  py....sJ........
-000045c0: 0124 010e 030a 0108 0104 0108 0118 010e  .$..............
-000045d0: 0118 0106 0110 010a 0512 010a 0104 010e  ................
-000045e0: 0110 0118 010a 030a 040c 0112 0114 011c  ................
-000045f0: 0704 010e 010a 0118 010a 020a 0118 010a  ................
-00004600: 0118 010a 0172 ea00 0000 fa02 2e2f 7245  .....r......./rE
-00004610: 0000 00fa 0864 6174 612e 6e70 7963 0900  .....data.npyc..
-00004620: 0000 0000 0000 0000 0000 1800 0000 0900  ................
-00004630: 0000 4300 0000 73dc 0100 0074 006a 017c  ..C...s....t.j.|
-00004640: 0564 0164 028d 0201 0074 006a 02a0 037c  .d.d.....t.j...|
-00004650: 059b 0064 037c 089b 009d 03a1 0172 3a74  ...d.|.......r:t
-00004660: 00a0 0464 047c 059b 0064 037c 089b 009d  ...d.|...d.|....
-00004670: 04a1 0101 0074 057c 0383 0144 005d 385c  .....t.|...D.]8\
-00004680: 027d 097d 0a74 006a 02a0 037c 059b 0064  .}.}.t.j...|...d
-00004690: 057c 0a9b 0064 069d 04a1 0172 4274 00a0  .|...d.....rBt..
-000046a0: 0464 047c 059b 0064 057c 0a9b 0064 069d  .d.|...d.|...d..
-000046b0: 05a1 0101 0071 4264 0764 0884 007c 0444  .....qBd.d...|.D
-000046c0: 0083 017d 0b67 007c 0ba2 0174 067c 0283  ...}.g.|...t.|..
-000046d0: 0191 0152 007d 0c74 077c 0b83 017d 0d7c  ...R.}.t.|...}.|
-000046e0: 0464 0919 00a0 08a1 007d 0e74 067c 0e83  .d.......}.t.|..
-000046f0: 017d 0f74 0974 0a64 097c 0f7c 0683 0383  .}.t.t.d.|.|....
-00004700: 017d 107c 107c 1064 0a19 007c 0f6b 0372  .}.|.|.d...|.k.r
-00004710: dc7c 0f67 016e 0267 0037 007d 107c 0790  .|.g.n.g.7.}.|..
-00004720: 0172 0274 0b74 0a74 067c 1083 0164 0b18  .r.t.t.t.|...d..
-00004730: 0083 0164 0c64 0164 0d8d 036e 0e74 0a74  ...d.d.d...n.t.t
-00004740: 067c 1083 0164 0b18 0083 017d 117c 1144  .|...d.....}.|.D
-00004750: 005d b87d 127c 107c 1219 007c 107c 1264  .].}.|.|...|.|.d
-00004760: 0b17 0019 0002 007d 137d 147c 0e7c 137c  .......}.}.|.|.|
-00004770: 1485 0219 007c 0464 093c 0074 0c7c 007c  .....|.d.<.t.|.|
-00004780: 017c 027c 037c 0464 0e64 0f8d 065c 037d  .|.|.|.d.d...\.}
-00004790: 157d 167d 1774 0d7c 157c 059b 0064 037c  .}.}.t.|.|...d.|
-000047a0: 089b 009d 037c 137c 147c 0c83 0501 0074  .....|.|.|.....t
-000047b0: 057c 0383 0144 005d 2e5c 027d 097d 0a74  .|...D.].\.}.}.t
-000047c0: 0d7c 1664 107c 0966 0219 007c 059b 0064  .|.d.|.f...|...d
-000047d0: 057c 0a9b 0064 069d 047c 137c 147c 0d83  .|...d...|.|.|..
-000047e0: 0501 0090 0171 7c7e 157e 167e 1774 0ea0  .....q|~.~.~.t..
-000047f0: 0fa1 0001 007c 0790 0172 1674 1083 0001  .....|...r.t....
-00004800: 0074 1183 0001 0090 0171 167c 0e7c 0464  .t.......q.|.|.d
-00004810: 093c 0064 1153 0029 1261 1502 0000 0a20  .<.d.S.).a..... 
-00004820: 2020 2064 6d5f 6469 6374 203d 207b 2764     dm_dict = {'d
-00004830: 6d27 3a20 646d 7d0a 2020 2020 6465 6c20  m': dm}.    del 
-00004840: 646d 3b20 6763 2e63 6f6c 6c65 6374 2829  dm; gc.collect()
-00004850: 0a0a 2020 2020 636f 6c73 5f69 6420 3d20  ..    cols_id = 
-00004860: 5b63 6f6c 5f64 6174 652c 2063 6f6c 5f69  [col_date, col_i
-00004870: 645d 0a20 2020 2063 6f6c 735f 6d61 736b  d].    cols_mask
-00004880: 203d 205b 2774 7261 696e 272c 2027 7465   = ['train', 'te
-00004890: 7374 272c 2027 7661 6c69 6427 2c20 2761  st', 'valid', 'a
-000048a0: 6c6c 272c 2027 7a64 7427 5d0a 2020 2020  ll', 'zdt'].    
-000048b0: 636f 6c73 5f64 6174 6120 3d20 5b63 6f6c  cols_data = [col
-000048c0: 5f6c 6162 656c 5d20 2b20 636f 6c73 5f66  _label] + cols_f
-000048d0: 6561 0a0a 2020 2020 6466 5f69 6420 3d20  ea..    df_id = 
-000048e0: 646d 5f64 6963 745b 2764 6d27 5d2e 6765  dm_dict['dm'].ge
-000048f0: 745f 636f 6c73 5f70 616e 6461 7328 636f  t_cols_pandas(co
-00004900: 6c73 5f69 6429 0a20 2020 2069 645f 6c69  ls_id).    id_li
-00004910: 7374 203d 205b 736f 7274 6564 2864 665f  st = [sorted(df_
-00004920: 6964 5b63 6f6c 5d2e 756e 6971 7565 2829  id[col].unique()
-00004930: 2920 666f 7220 636f 6c20 696e 2063 6f6c  ) for col in col
-00004940: 735f 6964 5d0a 2020 2020 6964 5f6c 6973  s_id].    id_lis
-00004950: 745b 305d 203d 2069 645f 6c69 7374 5b30  t[0] = id_list[0
-00004960: 5d23 5b3a 3530 305d 0a0a 2020 2020 746f  ]#[:500]..    to
-00004970: 5f6d 646e 7079 5f61 6e64 5f64 756d 7028  _mdnpy_and_dump(
-00004980: 646d 5f64 6963 742c 2063 6f6c 735f 6964  dm_dict, cols_id
-00004990: 2c20 636f 6c73 5f64 6174 612c 2063 6f6c  , cols_data, col
-000049a0: 735f 6d61 736b 2c20 6964 5f6c 6973 7420  s_mask, id_list 
-000049b0: 3d20 6964 5f6c 6973 742c 0a20 2020 2020  = id_list,.     
-000049c0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000049d0: 6572 626f 7365 203d 2054 7275 652c 2070  erbose = True, p
-000049e0: 6174 6820 3d20 272e 2f6d 646e 7079 2f27  ath = './mdnpy/'
-000049f0: 2c20 6261 7463 685f 7369 7a65 203d 2031  , batch_size = 1
-00004a00: 3030 290a 2020 2020 727a 2e67 6574 5f6d  00).    rz.get_m
-00004a10: 656d 5f63 7572 2829 3b20 727a 2e67 6574  em_cur(); rz.get
-00004a20: 5f6d 656d 5f6d 6178 2829 2020 2020 0a20  _mem_max()    . 
-00004a30: 2020 2054 2901 da08 6578 6973 745f 6f6b     T)...exist_ok
-00004a40: fa01 2f7a 0372 6d20 7a06 2f6d 6173 6b5f  ../z.rm z./mask_
-00004a50: 7a04 2e6e 7079 6301 0000 0000 0000 0000  z..npyc.........
-00004a60: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
-00004a70: 1400 0000 6700 7c00 5d0c 7d01 7400 7c01  ....g.|.].}.t.|.
-00004a80: 8301 9102 7104 5300 720f 0000 0072 a200  ....q.S.r....r..
-00004a90: 0000 7212 0000 0072 0f00 0000 720f 0000  ..r....r....r...
-00004aa0: 0072 1500 0000 7216 0000 0027 0200 0072  .r....r....'...r
-00004ab0: 1700 0000 7a25 746f 5f6d 646e 7079 5f61  ....z%to_mdnpy_a
-00004ac0: 6e64 5f64 756d 702e 3c6c 6f63 616c 733e  nd_dump.<locals>
-00004ad0: 2e3c 6c69 7374 636f 6d70 3e72 0100 0000  .<listcomp>r....
-00004ae0: 722e 0000 0072 0300 0000 7245 0000 0072  r....r....rE...r
-00004af0: 4600 0000 4629 0272 d400 0000 72e7 0000  F...F).r....r...
-00004b00: 002e 4e29 1272 6600 0000 da08 6d61 6b65  ..N).rf.....make
-00004b10: 6469 7273 721f 0000 0072 6700 0000 da06  dirsr....rg.....
-00004b20: 7379 7374 656d 72b3 0000 0072 4c00 0000  systemr....rL...
-00004b30: da05 7475 706c 65da 0463 6f70 7972 4d00  ..tuple..copyrM.
-00004b40: 0000 7230 0000 0072 0200 0000 72ea 0000  ..r0...r....r...
-00004b50: 0072 6800 0000 7229 0000 0072 2a00 0000  .rh...r)...r*...
-00004b60: 7204 0000 0072 0500 0000 2918 72e4 0000  r....r....).r...
-00004b70: 0072 d500 0000 72e5 0000 0072 e600 0000  .r....r....r....
-00004b80: 72d4 0000 0072 1f00 0000 728b 0000 0072  r....r....r....r
-00004b90: 5100 0000 5a09 6461 7461 5f6e 616d 65da  Q...Z.data_name.
-00004ba0: 026d 6972 db00 0000 7228 0000 005a 0a64  .mir....r(...Z.d
-00004bb0: 6174 615f 7368 6170 655a 0a6d 6173 6b5f  ata_shapeZ.mask_
-00004bc0: 7368 6170 655a 0969 645f 6c69 7374 5f30  shapeZ.id_list_0
-00004bd0: 7254 0000 005a 0370 696a 7256 0000 0072  rT...Z.pijrV...r
-00004be0: 5700 0000 72bc 0000 005a 0270 6a72 e900  W...r....Z.pjr..
-00004bf0: 0000 72e8 0000 005a 0b69 645f 6c69 7374  ..r....Z.id_list
-00004c00: 5f72 6574 720f 0000 0072 0f00 0000 7215  _retr....r....r.
-00004c10: 0000 00da 1174 6f5f 6d64 6e70 795f 616e  .....to_mdnpy_an
-00004c20: 645f 6475 6d70 0c02 0000 7332 0000 0000  d_dump....s2....
-00004c30: 130e 0116 0116 0110 0118 011a 030e 0112  ................
-00004c40: 0108 030c 0108 0110 011a 0130 0108 0116  ...........0....
-00004c50: 0110 0312 ff08 041a 0110 0128 010e 0116  ...........(....
-00004c60: 0372 f400 0000 2906 4e4e 4e72 5f00 0000  .r....).NNNr_...
-00004c70: 4654 2904 4e4e 4e72 5f00 0000 2908 4e4e  FT).NNNr_...).NN
-00004c80: 4e72 5f00 0000 4646 7269 0000 0072 2c00  Nr_...FFri...r,.
-00004c90: 0000 2907 4e4e 4e72 5f00 0000 4672 7300  ..).NNNr_...Frs.
-00004ca0: 0000 722c 0000 0029 024e 4e29 064e 722e  ..r,...).NN).Nr.
-00004cb0: 0000 004e 4646 5429 084e 722e 0000 004e  ...NFFT).Nr....N
-00004cc0: 4646 4672 7300 0000 7203 0000 0029 054e  FFFrs...r....).N
-00004cd0: 722e 0000 004e 4654 2907 4e72 2e00 0000  r....NFT).Nr....
-00004ce0: 72c1 0000 0072 0100 0000 4672 6900 0000  r....r....Fri...
-00004cf0: 722c 0000 0029 0272 4400 0000 4629 024e  r,...).rD...F).N
-00004d00: 72c9 0000 0029 024e 4629 054e 72eb 0000  r....).NF).Nr...
-00004d10: 0072 4500 0000 4672 ec00 0000 2924 7266  .rE...Fr....)$rf
-00004d20: 0000 00da 056e 756d 7079 7219 0000 00da  .....numpyr.....
-00004d30: 0670 616e 6461 7372 c900 0000 da06 706f  .pandasr......po
-00004d40: 6c61 7273 72cb 0000 0072 0200 0000 7229  larsr....r....r)
-00004d50: 0000 00da 0475 7469 6c72 0400 0000 7205  .....utilr....r.
-00004d60: 0000 005a 096e 7079 5f6e 756d 6261 7206  ...Z.npy_numbar.
-00004d70: 0000 0072 0700 0000 7208 0000 0072 0900  ...r....r....r..
-00004d80: 0000 da03 7275 6e72 0a00 0000 720b 0000  ....runr....r...
-00004d90: 00da 0665 6e61 626c 6572 2400 0000 7225  ...enabler$...r%
-00004da0: 0000 0072 6500 0000 7268 0000 0072 7200  ...re...rh...rr.
-00004db0: 0000 7275 0000 0072 7800 0000 7296 0000  ..ru...rx...r...
-00004dc0: 0072 9800 0000 72c0 0000 0072 c400 0000  .r....r....r....
-00004dd0: 72c8 0000 0072 d800 0000 72ea 0000 0072  r....r....r....r
-00004de0: f400 0000 720f 0000 0072 0f00 0000 720f  ....r....r....r.
-00004df0: 0000 0072 1500 0000 da08 3c6d 6f64 756c  ...r......<modul
-00004e00: 653e 0100 0000 7344 0000 0008 0108 0108  e>....sD........
-00004e10: 0108 010c 0108 0110 0118 0110 0108 0308  ................
-00004e20: 070e 4d0a 0b0a 110a 140a 0f0a 0e00 0100  ..M.............
-00004e30: ff0a 3d0a 1100 0100 ff0a 5500 0100 0100  ..=.......U.....
-00004e40: fe0a 540a 0a0a 130a 4a00 0100 ff0a 37    ..T.....J.....7
+000018e0: 1400 7d04 6402 7d0f 7c03 6403 7500 73b8  ..}.d.}.|.d.u.s.
+000018f0: 7c03 6402 6b02 72e6 7400 a00a 7c08 6407  |.d.k.r.t...|.d.
+00001900: 6403 8502 1900 a101 6408 7c0a 7600 72d4  d.......d.|.v.r.
+00001910: 6409 6e02 640a 1400 7d0f 740b 7c04 7c0f  d.n.d...}.t.|.|.
+00001920: 1b00 8301 7d03 7c06 9001 7250 740c 640b  ....}.|...rPt.d.
+00001930: 7c08 9b00 640c 7400 a00a 7c08 a101 640a  |...d.t...|...d.
+00001940: 1400 640d 9b04 9d04 8301 0100 740c 640e  ..d.........t.d.
+00001950: 7c0e 6a0d 9b00 640c 7400 a00a 7c0e 6a0d  |.j...d.t...|.j.
+00001960: a101 640a 1400 640d 9b04 9d04 8301 0100  ..d...d.........
+00001970: 740c 640f 7c04 640d 9b04 6410 7c03 640d  t.d.|.d...d.|.d.
+00001980: 9b04 6411 7c0f 6412 9b04 9d06 8301 0100  ..d.|.d.........
+00001990: 7c06 9001 7270 740e 740f 6401 7c0b 7c03  |...rpt.t.d.|.|.
+000019a0: 8303 6413 6414 6415 6416 8d04 7d10 6e0c  ..d.d.d.d...}.n.
+000019b0: 740f 6401 7c0b 7c03 8303 7d10 7400 a010  t.d.|.|...}.t...
+000019c0: 7c01 a101 7400 a011 7c01 a101 0200 7d11  |...t...|.....}.
+000019d0: 7d12 7c10 4400 9001 5d0a 7d13 7c13 7410  }.|.D...].}.|.t.
+000019e0: 7c0b 7c13 7c03 1700 8302 0200 7d14 7d15  |.|.|.......}.}.
+000019f0: 740b 7c14 7400 a00a 7c08 6407 6402 8502  t.|.t...|.d.d...
+00001a00: 1900 a101 1400 8301 7d16 740b 7c15 7400  ........}.t.|.t.
+00001a10: a00a 7c08 6407 6402 8502 1900 a101 1400  ..|.d.d.........
+00001a20: 8301 7d17 7c16 7c12 6b04 9001 72f4 0100  ..}.|.|.k...r...
+00001a30: 9002 71a4 7c17 7c11 6b01 9002 7202 9001  ..q.|.|.k...r...
+00001a40: 7196 7400 a012 7c16 7c01 6b01 7c01 7c17  q.t...|.|.k.|.|.
+00001a50: 6b00 4000 a101 6401 1900 7d18 7407 7c18  k.@...d...}.t.|.
+00001a60: 8301 6401 6b02 9002 722e 9001 7196 7413  ..d.k...r...q.t.
+00001a70: 7c00 7c14 7c15 7c02 7c07 6417 8d05 a014  |.|.|.|.|.d.....
+00001a80: 6402 7c0d a102 7d19 7c01 7c18 1900 7c16  d.|...}.|.|...|.
+00001a90: 1800 7d1a 7c07 9002 7270 7415 7c0e 7c18  ..}.|...rpt.|.|.
+00001aa0: 7c19 7c1a 1900 6401 6418 8d04 0100 6e30  |.|...d.d.....n0
+00001ab0: 7c05 9002 7294 7c19 7c1a 1900 7c0e 7c18  |...r.|.|...|.|.
+00001ac0: 6401 1900 7c18 6402 1900 6407 1700 8502  d...|.d...d.....
+00001ad0: 3c00 6e0c 7c19 7c1a 1900 7c0e 7c18 3c00  <.n.|.|...|.|.<.
+00001ae0: 9001 7196 7416 a017 a100 0100 7c0e 5300  ..q.t.......|.S.
+00001af0: 2919 7aeb 0a20 2020 2072 7a2e 6765 745f  ).z..    rz.get_
+00001b00: 6d65 6d5f 6375 7228 292c 2072 7a2e 6765  mem_cur(), rz.ge
+00001b10: 745f 6d65 6d5f 6d61 7828 293b 0a20 2020  t_mem_max();.   
+00001b20: 2064 6174 6120 3d20 6c6f 6164 5f6e 7079   data = load_npy
+00001b30: 5f69 6478 2827 612e 6e70 7927 2c20 6d61  _idx('a.npy', ma
+00001b40: 736b 5f69 6478 2c20 636f 6c73 2c20 626c  sk_idx, cols, bl
+00001b50: 6f63 6b5f 7369 7a65 203d 2032 3030 2c20  ock_size = 200, 
+00001b60: 7665 7262 6f73 6520 3d20 5472 7565 290a  verbose = True).
+00001b70: 2020 2020 7072 696e 7428 6461 7461 2e73      print(data.s
+00001b80: 6861 7065 290a 2020 2020 7072 696e 7428  hape).    print(
+00001b90: 6627 7b34 202a 206e 702e 7072 6f64 2864  f'{4 * np.prod(d
+00001ba0: 6174 612e 7368 6170 6529 3a2c 2e30 667d  ata.shape):,.0f}
+00001bb0: 2729 0a20 2020 2072 7a2e 6765 745f 6d65  ').    rz.get_me
+00001bc0: 6d5f 6375 7228 292c 2072 7a2e 6765 745f  m_cur(), rz.get_
+00001bd0: 6d65 6d5f 6d61 7828 293b 0a20 2020 2072  mem_max();.    r
+00001be0: 0100 0000 722e 0000 004e 723c 0000 00e9  ....r....Nr<....
+00001bf0: 0000 800c 6900 0400 0072 0300 0000 da02  ....i....r......
+00001c00: 3634 7273 0000 00e9 0400 0000 7a12 5b2b  64rs........z.[+
+00001c10: 5d20 6461 7461 5f61 6c6c 2020 2020 3d20  ] data_all    = 
+00001c20: fa08 2c20 6d65 6d20 3d20 fa04 2c2e 3066  .., mem = ..,.0f
+00001c30: 7a12 2020 2020 6461 7461 5f73 656c 2020  z.    data_sel  
+00001c40: 2020 3d20 fa12 2020 2020 626c 6f63 6b5f    = ..    block_
+00001c50: 7369 7a65 2020 3d20 fa03 203d 20fa 0320  size  = .. = .. 
+00001c60: 2a20 fa03 2e30 667a 0e6c 6f61 645f 6e70  * ...0fz.load_np
+00001c70: 795f 6964 7828 2972 4500 0000 54a9 03da  y_idx()rE...T...
+00001c80: 0464 6573 6372 4700 0000 7248 0000 00a9  .descrG...rH....
+00001c90: 0472 3e00 0000 723f 0000 0072 5000 0000  .r>...r?...rP...
+00001ca0: 7252 0000 0072 4900 0000 2918 7219 0000  rR...rI...).r...
+00001cb0: 00da 0473 6f72 74da 1161 7363 6f6e 7469  ...sort..asconti
+00001cc0: 6775 6f75 7361 7272 6179 724a 0000 005a  guousarrayrJ...Z
+00001cd0: 0572 6176 656c 7224 0000 0072 1100 0000  .ravelr$...r....
+00001ce0: 724c 0000 0072 4b00 0000 725e 0000 0072  rL...rK...r^...r
+00001cf0: 3600 0000 da03 696e 74da 0570 7269 6e74  6.....int..print
+00001d00: 7228 0000 0072 0200 0000 7230 0000 00da  r(...r....r0....
+00001d10: 036d 696e 724f 0000 00da 0577 6865 7265  .minrO.....where
+00001d20: 7265 0000 0072 3d00 0000 7207 0000 0072  re...r=...r....r
+00001d30: 2900 0000 722a 0000 0029 1b72 1f00 0000  )...r*...).r....
+00001d40: 7277 0000 0072 5000 0000 da0a 6261 7463  rw...rP.....batc
+00001d50: 685f 7369 7a65 da0a 626c 6f63 6b5f 7369  h_size..block_si
+00001d60: 7a65 da0a 736f 7274 5f69 6e64 6578 7251  ze..sort_indexrQ
+00001d70: 0000 0072 5200 0000 7228 0000 0072 5300  ...rR...r(...rS.
+00001d80: 0000 7227 0000 00da 066e 5f72 6f77 73da  ..r'.....n_rows.
+00001d90: 0a6e 5f72 6f77 735f 7365 6cda 0a6e 5f63  .n_rows_sel..n_c
+00001da0: 6f6c 735f 7365 6c72 4200 0000 da0c 7369  ols_selrB.....si
+00001db0: 7a65 5f6f 6e65 5f72 6f77 7256 0000 005a  ze_one_rowrV...Z
+00001dc0: 0769 6478 5f6d 696e 5a07 6964 785f 6d61  .idx_minZ.idx_ma
+00001dd0: 7872 5700 0000 7258 0000 0072 5900 0000  xrW...rX...rY...
+00001de0: da03 5f70 31da 035f 7032 da07 6964 785f  .._p1.._p2..idx_
+00001df0: 7365 6c72 4000 0000 da05 6964 785f 6172  selr@.....idx_ar
+00001e00: 0f00 0000 720f 0000 0072 1500 0000 da0c  ....r....r......
+00001e10: 6c6f 6164 5f6e 7079 5f69 6478 ae00 0000  load_npy_idx....
+00001e20: 7352 0000 0000 0a12 0114 020c 0108 010c  sR..............
+00001e30: 0108 0108 0118 0114 0110 0106 020c 0304  ................
+00001e40: 0110 0122 010c 0206 0120 0124 0120 0306  ..."..... .$. ..
+00001e50: 011a 020c 0216 010a 0114 011a 011a 0110  ................
+00001e60: 010e 011a 0112 021a 010c 0206 0116 0206  ................
+00001e70: 011e 0210 0108 0172 9600 0000 630a 0000  .......r....c...
+00001e80: 0000 0000 0000 0000 000d 0000 0007 0000  ................
+00001e90: 0003 0000 0073 8e00 0000 7400 8805 8301  .....s....t.....
+00001ea0: 7d0a 8803 6401 7500 7232 7401 6a02 7403  }...d.u.r2t.j.t.
+00001eb0: 8804 8301 7c0a 6402 1900 6403 1900 6602  ....|.d...d...f.
+00001ec0: 7401 6a04 6404 8d02 8900 6e1c 7401 6a02  t.j.d.....n.t.j.
+00001ed0: 7403 8804 8301 7403 8803 8301 6602 7401  t.....t.....f.t.
+00001ee0: 6a04 6404 8d02 8900 8700 8701 8702 8703  j.d.............
+00001ef0: 8704 8705 8706 6607 6405 6406 8408 7d0b  ......f.d.d...}.
+00001f00: 7405 7403 8800 8301 7c08 7c09 1400 8302  t.t.....|.|.....
+00001f10: 7d0c 7406 7c0b 7c0c 7c08 6407 7c06 6408  }.t.|.|.|.d.|.d.
+00001f20: 8d05 0100 8800 5300 2909 7595 0000 000a  ......S.).u.....
+00001f30: 2020 2020 727a e5bc 80e5 a4b4 e79a 84e5      rz..........
+00001f40: 87bd e695 b02c 206b 7469 6d65 7320 3d20  ....., ktimes = 
+00001f50: 31e6 98af e585 b3e9 94ae 202a 2a2a 2a2a  1......... *****
+00001f60: 2a20 727a 5f6c 6f61 645f 6e70 795f 6964  * rz_load_npy_id
+00001f70: 7820 2a2a 2a2a 2a2a 0a20 2020 206e 5f6a  x ******.    n_j
+00001f80: 6f62 7320 3d20 382c 206b 7469 6d65 7320  obs = 8, ktimes 
+00001f90: 3d20 312c 2034 2074 696d 6573 2066 6173  = 1, 4 times fas
+00001fa0: 7465 7220 7468 616e 206c 6f61 645f 6e70  ter than load_np
+00001fb0: 795f 6964 780a 2020 2020 3747 422f 730a  y_idx.    7GB/s.
+00001fc0: 2020 2020 4e72 0100 0000 722e 0000 0072      Nr....r....r
+00001fd0: 3c00 0000 6302 0000 0000 0000 0000 0000  <...c...........
+00001fe0: 0002 0000 000a 0000 0013 0000 0073 3800  .............s8.
+00001ff0: 0000 7c00 7c01 6b05 720c 6400 5300 7400  ..|.|.k.r.d.S.t.
+00002000: 8805 8804 7c00 7c01 8502 1900 8803 8801  ....|.|.........
+00002010: 8802 8806 6401 6401 6402 8d08 8800 7c00  ....d.d.d.....|.
+00002020: 7c01 8502 3c00 6400 5300 2903 4e46 7261  |...<.d.S.).NFra
+00002030: 0000 0029 0172 9600 0000 726a 0000 00a9  ...).r....rj....
+00002040: 0772 4000 0000 728b 0000 0072 8c00 0000  .r@...r....r....
+00002050: 7250 0000 0072 7700 0000 721f 0000 0072  rP...rw...r....r
+00002060: 8d00 0000 720f 0000 0072 1500 0000 726c  ....r....r....rl
+00002070: 0000 00f9 0000 0073 0400 0000 0001 0c01  .......s........
+00002080: 7a1f 727a 5f6c 6f61 645f 6e70 795f 6964  z.rz_load_npy_id
+00002090: 782e 3c6c 6f63 616c 733e 2e72 7a5f 7275  x.<locals>.rz_ru
+000020a0: 6e72 6d00 0000 726e 0000 0029 0772 2400  nrm...rn...).r$.
+000020b0: 0000 7219 0000 0072 4b00 0000 724c 0000  ..r....rK...rL..
+000020c0: 0072 5e00 0000 720a 0000 0072 0b00 0000  .r^...r....r....
+000020d0: 290d 721f 0000 0072 7700 0000 7250 0000  ).r....rw...rP..
+000020e0: 0072 8b00 0000 728c 0000 0072 8d00 0000  .r....r....r....
+000020f0: 7251 0000 0072 5200 0000 726f 0000 0072  rQ...rR...ro...r
+00002100: 7000 0000 7253 0000 0072 6c00 0000 7271  p...rS...rl...rq
+00002110: 0000 0072 0f00 0000 7297 0000 0072 1500  ...r....r....r..
+00002120: 0000 da0f 727a 5f6c 6f61 645f 6e70 795f  ....rz_load_npy_
+00002130: 6964 78f0 0000 0073 0e00 0000 0006 0801  idx....s........
+00002140: 2a01 1c01 1803 1201 1201 7298 0000 0063  *.........r....c
+00002150: 0700 0000 0000 0000 0000 0000 2100 0000  ............!...
+00002160: 0a00 0000 0300 0000 73b2 0300 0074 0088  ........s....t..
+00002170: 0083 0174 0175 0172 2687 0066 0164 0164  ...t.u.r&..f.d.d
+00002180: 0284 0874 0274 037c 0083 0183 0144 0083  ...t.t.|.....D..
+00002190: 0189 007c 0264 0375 0072 4464 0464 0284  ...|.d.u.rDd.d..
+000021a0: 0074 0274 037c 0083 0183 0144 0083 017d  .t.t.|.....D...}
+000021b0: 0264 0564 0284 007c 0044 0083 0189 0164  .d.d...|.D.....d
+000021c0: 0664 0284 007c 0044 0083 017d 0764 0764  .d...|.D...}.d.d
+000021d0: 0284 0088 0144 0083 017d 0864 0864 0284  .....D...}.d.d..
+000021e0: 0088 0044 0083 017d 0974 037c 0083 0174  ...D...}.t.|...t
+000021f0: 0388 0083 016b 0272 9c74 037c 0083 0174  .....k.r.t.|...t
+00002200: 037c 0283 016b 0273 c24a 0064 0974 037c  .|...k.s.J.d.t.|
+00002210: 0083 019b 0064 0a74 0388 0083 019b 0064  .....d.t.......d
+00002220: 0b74 037c 0283 019b 009d 0683 0182 0174  .t.|...........t
+00002230: 0374 047c 0983 0183 0164 0c6b 0273 e04a  .t.|.....d.k.s.J
+00002240: 0064 0d7c 099b 009d 0283 0182 0187 0166  .d.|...........f
+00002250: 0164 0e64 0284 0874 057c 0283 0144 0083  .d.d...t.|...D..
+00002260: 017d 0a74 06a0 0788 0064 0f19 00a1 0164  .}.t.....d.....d
+00002270: 0c6b 0190 0172 1274 0864 1083 0101 0074  .k...r.t.d.....t
+00002280: 066a 097c 0964 0f19 0074 06a0 0a7c 0aa1  .j.|.d...t...|..
+00002290: 0166 0274 066a 0b64 118d 027d 0b7c 0464  .f.t.j.d...}.|.d
+000022a0: 0375 0090 0173 447c 0464 126b 0290 0172  .u...sD|.d.k...r
+000022b0: 4a64 137d 046e 087c 0464 1439 007d 047c  Jd.}.n.|.d.9.}.|
+000022c0: 0590 0172 7c74 0864 157c 0b6a 0c9b 0064  ...r|t.d.|.j...d
+000022d0: 1674 06a0 0d7c 0b6a 0ca1 0164 1714 0064  .t...|.j...d...d
+000022e0: 189b 049d 0483 0101 0074 0274 037c 0083  .........t.t.|..
+000022f0: 0183 0144 0090 025d 227d 0c7c 007c 0c19  ...D...]"}.|.|..
+00002300: 007d 0d7c 077c 0c19 007d 0e88 007c 0c19  .}.|.|...}...|..
+00002310: 007d 0f7c 027c 0c19 007d 1088 017c 0c19  .}.|.|...}...|..
+00002320: 007d 117c 087c 0c19 007d 127c 097c 0c19  .}.|.|...}.|.|..
+00002330: 007d 137c 0a7c 0c19 007d 147c 0364 0375  .}.|.|...}.|.d.u
+00002340: 0090 0173 e27c 0364 126b 0290 0272 1274  ...s.|.d.k...r.t
+00002350: 06a0 0d7c 1164 0c64 0385 0219 00a1 0164  ...|.d.d.......d
+00002360: 197c 0e76 0090 0272 0064 1a6e 0264 1714  .|.v...r.d.n.d..
+00002370: 007d 1574 0e7c 047c 151b 0083 017d 037c  .}.t.|.|.....}.|
+00002380: 0590 0272 8a74 0864 1b7c 0c64 1c9b 0464  ...r.t.d.|.d...d
+00002390: 1d7c 119b 0064 1674 06a0 0d7c 11a1 0164  .|...d.t...|...d
+000023a0: 1714 0064 189b 049d 0683 0101 0074 0864  ...d.........t.d
+000023b0: 1e7c 0c64 1c9b 0464 1d7c 137c 1466 029b  .|.d...d.|.|.f..
+000023c0: 0064 167c 137c 1414 0064 1714 0064 189b  .d.|.|...d...d..
+000023d0: 049d 0683 0101 0074 0864 1f7c 0464 189b  .......t.d.|.d..
+000023e0: 0464 1d7c 0364 189b 0464 207c 1564 219b  .d.|.d...d |.d!.
+000023f0: 049d 0683 0101 007c 0590 0272 aa74 0f74  .......|...r.t.t
+00002400: 0264 0f7c 127c 0383 0364 2264 2364 2464  .d.|.|...d"d#d$d
+00002410: 258d 047d 166e 0c74 0264 0f7c 127c 0383  %..}.n.t.d.|.|..
+00002420: 037d 167c 1644 005d e67d 177c 1774 107c  .}.|.D.].}.|.t.|
+00002430: 127c 177c 0317 0083 0202 007d 187d 197c  .|.|.......}.}.|
+00002440: 1874 0e74 06a0 0d7c 1164 0c64 1285 0219  .t.t...|.d.d....
+00002450: 00a1 0183 0114 007d 1a7c 1974 0e74 06a0  .......}.|.t.t..
+00002460: 0d7c 1164 0c64 1285 0219 00a1 0183 0114  .|.d.d..........
+00002470: 007d 1b74 06a0 117c 1a7c 0f6b 017c 0f7c  .}.t...|.|.k.|.|
+00002480: 1b6b 0040 00a1 0164 0f19 007d 1c74 037c  .k.@...d...}.t.|
+00002490: 1c83 0164 0f6b 0290 0372 3290 0271 ba74  ...d.k...r2..q.t
+000024a0: 127c 0d7c 187c 197c 107c 0664 268d 05a0  .|.|.|.|.|.d&...
+000024b0: 1364 127c 14a1 027d 1d7c 0f7c 1c19 007c  .d.|...}.|.|...|
+000024c0: 1a18 007d 1e74 0e74 06a0 0a7c 0a64 037c  ...}.t.t...|.d.|
+000024d0: 0c85 0219 00a1 0183 0174 0e74 06a0 0a7c  .........t.t...|
+000024e0: 0a64 037c 0c64 0c17 0085 0219 00a1 0183  .d.|.d..........
+000024f0: 0102 007d 1f7d 207c 1d7c 1e19 007c 0b7c  ...}.} |.|...|.|
+00002500: 1c7c 1f7c 2085 0266 023c 0090 0271 ba74  .|.| ..f.<...q.t
+00002510: 14a0 15a1 0001 0090 0171 887c 0b53 0029  .........q.|.S.)
+00002520: 2761 4102 0000 0a20 2020 2069 6478 203d  'aA....    idx =
+00002530: 206e 702e 736f 7274 286e 702e 7261 6e64   np.sort(np.rand
+00002540: 6f6d 2e70 6572 6d75 7461 7469 6f6e 2832  om.permutation(2
+00002550: 3030 3030 3030 295b 3a31 3930 3030 3030  000000)[:1900000
+00002560: 5d29 0a20 2020 2063 6f6c 7320 3d20 6e70  ]).    cols = np
+00002570: 2e72 616e 646f 6d2e 7065 726d 7574 6174  .random.permutat
+00002580: 696f 6e28 3130 3030 295b 3a39 3030 5d0a  ion(1000)[:900].
+00002590: 2020 2020 6461 7461 203d 2072 7a2e 7574      data = rz.ut
+000025a0: 696c 2e6e 7079 2e6c 6f61 645f 6e70 795f  il.npy.load_npy_
+000025b0: 6964 785f 6d75 6c74 6928 5b27 612e 6e70  idx_multi(['a.np
+000025c0: 7927 2c20 2761 2e6e 7079 275d 2c20 6964  y', 'a.npy'], id
+000025d0: 782c 2063 6f6c 735f 6c69 7374 203d 205b  x, cols_list = [
+000025e0: 636f 6c73 2c20 636f 6c73 5d2c 200a 2020  cols, cols], .  
+000025f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002600: 2020 2020 2020 626c 6f63 6b5f 7369 7a65        block_size
+00002610: 203d 2032 3030 2c20 7665 7262 6f73 6520   = 200, verbose 
+00002620: 3d20 5472 7565 2c20 7573 655f 6e75 6d62  = True, use_numb
+00002630: 6120 3d20 4661 6c73 6529 0a0a 2020 2020  a = False)..    
+00002640: 727a 2e67 6574 5f6d 656d 5f63 7572 2829  rz.get_mem_cur()
+00002650: 2c20 727a 2e67 6574 5f6d 656d 5f6d 6178  , rz.get_mem_max
+00002660: 2829 3b0a 2020 2020 6461 7461 203d 206c  ();.    data = l
+00002670: 6f61 645f 6e70 795f 6964 785f 6d75 6c74  oad_npy_idx_mult
+00002680: 6928 5b27 612e 6e70 7927 2c20 2762 2e6e  i(['a.npy', 'b.n
+00002690: 7079 275d 2c20 6d61 736b 5f69 6478 2c20  py'], mask_idx, 
+000026a0: 636f 6c73 5f6c 6973 7420 3d20 5b63 6f6c  cols_list = [col
+000026b0: 732c 2063 6f6c 735d 2c20 0a20 2020 2020  s, cols], .     
+000026c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026d0: 2020 2020 2020 626c 6f63 6b5f 7369 7a65        block_size
+000026e0: 203d 2032 3030 2c20 7665 7262 6f73 6520   = 200, verbose 
+000026f0: 3d20 5472 7565 290a 2020 2020 7072 696e  = True).    prin
+00002700: 7428 6461 7461 2e73 6861 7065 290a 2020  t(data.shape).  
+00002710: 2020 7072 696e 7428 6627 7b34 202a 206e    print(f'{4 * n
+00002720: 702e 7072 6f64 2864 6174 612e 7368 6170  p.prod(data.shap
+00002730: 6529 3a2c 2e30 667d 2729 0a20 2020 2072  e):,.0f}').    r
+00002740: 7a2e 6765 745f 6d65 6d5f 6375 7228 292c  z.get_mem_cur(),
+00002750: 2072 7a2e 6765 745f 6d65 6d5f 6d61 7828   rz.get_mem_max(
+00002760: 293b 0a20 2020 2063 0100 0000 0000 0000  );.    c........
+00002770: 0000 0000 0200 0000 0300 0000 1300 0000  ................
+00002780: 7310 0000 0067 007c 005d 087d 0188 0091  s....g.|.].}....
+00002790: 0271 0453 0072 0f00 0000 720f 0000 00a9  .q.S.r....r.....
+000027a0: 0272 1300 0000 720e 0000 00a9 0172 5500  .r....r......rU.
+000027b0: 0000 720f 0000 0072 1500 0000 7216 0000  ..r....r....r...
+000027c0: 0013 0100 0072 1700 0000 7a26 6c6f 6164  .....r....z&load
+000027d0: 5f6e 7079 5f69 6478 5f6d 756c 7469 2e3c  _npy_idx_multi.<
+000027e0: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+000027f0: 703e 4e63 0100 0000 0000 0000 0000 0000  p>Nc............
+00002800: 0200 0000 0300 0000 5300 0000 7310 0000  ........S...s...
+00002810: 0067 007c 005d 087d 0164 0091 0271 0453  .g.|.].}.d...q.S
+00002820: 00a9 014e 720f 0000 0072 9900 0000 720f  ...Nr....r....r.
+00002830: 0000 0072 0f00 0000 7215 0000 0072 1600  ...r....r....r..
+00002840: 0000 1501 0000 7217 0000 0063 0100 0000  ......r....c....
+00002850: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+00002860: 5300 0000 7318 0000 0067 007c 005d 107d  S...s....g.|.].}
+00002870: 0174 007c 0183 0164 0019 0091 0271 0453  .t.|...d.....q.S
+00002880: 00a9 0172 0100 0000 a901 7224 0000 00a9  ...r......r$....
+00002890: 0272 1300 0000 721f 0000 0072 0f00 0000  .r....r....r....
+000028a0: 720f 0000 0072 1500 0000 7216 0000 0016  r....r....r.....
+000028b0: 0100 0072 1700 0000 6301 0000 0000 0000  ...r....c.......
+000028c0: 0000 0000 0002 0000 0005 0000 0053 0000  .............S..
+000028d0: 0073 1c00 0000 6700 7c00 5d14 7d01 7400  .s....g.|.].}.t.
+000028e0: 7401 7c01 8301 6400 1900 8301 9102 7104  t.|...d.......q.
+000028f0: 5300 a901 722e 0000 00a9 0272 1100 0000  S...r......r....
+00002900: 7224 0000 0072 9e00 0000 720f 0000 0072  r$...r....r....r
+00002910: 0f00 0000 7215 0000 0072 1600 0000 1701  ....r....r......
+00002920: 0000 7217 0000 0063 0100 0000 0000 0000  ..r....c........
+00002930: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+00002940: 7314 0000 0067 007c 005d 0c7d 017c 0164  s....g.|.].}.|.d
+00002950: 0019 0091 0271 0453 0072 9c00 0000 720f  .....q.S.r....r.
+00002960: 0000 00a9 0272 1300 0000 7228 0000 0072  .....r....r(...r
+00002970: 0f00 0000 720f 0000 0072 1500 0000 7216  ....r....r....r.
+00002980: 0000 0018 0100 0072 1700 0000 6301 0000  .......r....c...
+00002990: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+000029a0: 0053 0000 0073 1400 0000 6700 7c00 5d0c  .S...s....g.|.].
+000029b0: 7d01 7400 7c01 8301 9102 7104 5300 720f  }.t.|.....q.S.r.
+000029c0: 0000 00a9 0172 4c00 0000 a902 7213 0000  .....rL.....r...
+000029d0: 0072 7700 0000 720f 0000 0072 0f00 0000  .rw...r....r....
+000029e0: 7215 0000 0072 1600 0000 1901 0000 7217  r....r........r.
+000029f0: 0000 00fa 0c70 6174 685f 6c69 7374 203d  .....path_list =
+00002a00: 20fa 0d2c 2069 6478 5f6c 6973 7420 3d20   .., idx_list = 
+00002a10: fa0e 2c20 636f 6c73 5f6c 6973 7420 3d20  .., cols_list = 
+00002a20: 7203 0000 00fa 126e 5f72 6f77 735f 7365  r......n_rows_se
+00002a30: 6c5f 6c69 7374 203d 2063 0100 0000 0000  l_list = c......
+00002a40: 0000 0000 0000 0300 0000 0400 0000 1300  ................
+00002a50: 0000 732c 0000 0067 007c 005d 245c 027d  ..s,...g.|.]$\.}
+00002a60: 017d 027c 0264 0075 0072 2088 007c 0119  .}.|.d.u.r ..|..
+00002a70: 0064 0119 006e 0674 007c 0283 0191 0271  .d...n.t.|.....q
+00002a80: 0453 00a9 024e 722e 0000 0072 a200 0000  .S...Nr....r....
+00002a90: a903 7213 0000 0072 5700 0000 7250 0000  ..r....rW...rP..
+00002aa0: 00a9 01da 0a73 6861 7065 5f6c 6973 7472  .....shape_listr
+00002ab0: 0f00 0000 7215 0000 0072 1600 0000 1e01  ....r....r......
+00002ac0: 0000 7304 0000 0006 0106 ff72 0100 0000  ..s........r....
+00002ad0: 7a4d 0a2a 2a2a 2a2a 2a2a 2a2a 2a20 4944  zM.********** ID
+00002ae0: 5820 3c3d 2031 2c20 594f 5520 4d41 5920  X <= 1, YOU MAY 
+00002af0: 5553 4520 6d61 736b 2061 7320 6d61 736b  USE mask as mask
+00002b00: 5f69 6478 2c20 504c 4541 5345 2043 4845  _idx, PLEASE CHE
+00002b10: 434b 2120 2a2a 2a2a 2a2a 2a2a 2a2a 0a72  CK! **********.r
+00002b20: 3c00 0000 722e 0000 0072 7900 0000 e900  <...r....ry.....
+00002b30: 0010 00fa 125b 2b5d 2064 6174 612e 7368  .....[+] data.sh
+00002b40: 6170 6520 203d 2072 7c00 0000 727b 0000  ape  = r|...r{..
+00002b50: 0072 7d00 0000 727a 0000 0072 7300 0000  .r}...rz...rs...
+00002b60: fa0d 5b2b 5d20 6461 7461 5f61 6c6c 5fda  ..[+] data_all_.
+00002b70: 0330 3264 727f 0000 00fa 0d20 2020 2064  .02dr......    d
+00002b80: 6174 615f 7365 6c5f 727e 0000 0072 8000  ata_sel_r~...r..
+00002b90: 0000 7281 0000 007a 146c 6f61 645f 6e70  ..r....z.load_np
+00002ba0: 795f 6964 785f 6d75 6c74 6928 2972 4500  y_idx_multi()rE.
+00002bb0: 0000 5472 8200 0000 7284 0000 0029 16da  ..Tr....r....)..
+00002bc0: 0474 7970 6572 4d00 0000 7230 0000 0072  .typerM...r0...r
+00002bd0: 4c00 0000 da03 7365 74da 0965 6e75 6d65  L.....set..enume
+00002be0: 7261 7465 7219 0000 0072 4f00 0000 7288  rater....rO...r.
+00002bf0: 0000 00da 057a 6572 6f73 da03 7375 6d72  .....zeros..sumr
+00002c00: 5e00 0000 7228 0000 0072 3600 0000 7287  ^...r(...r6...r.
+00002c10: 0000 0072 0200 0000 7289 0000 0072 8a00  ...r....r....r..
+00002c20: 0000 7265 0000 0072 3d00 0000 7229 0000  ..re...r=...r)..
+00002c30: 0072 2a00 0000 2921 da09 7061 7468 5f6c  .r*...)!..path_l
+00002c40: 6973 7472 5500 0000 da09 636f 6c73 5f6c  istrU.....cols_l
+00002c50: 6973 7472 8b00 0000 728c 0000 0072 5100  istr....r....rQ.
+00002c60: 0000 7252 0000 00da 0a64 7479 7065 5f6c  ..rR.....dtype_l
+00002c70: 6973 74da 0b6e 5f72 6f77 735f 6c69 7374  ist..n_rows_list
+00002c80: da0f 6e5f 726f 7773 5f73 656c 5f6c 6973  ..n_rows_sel_lis
+00002c90: 74da 0f6e 5f63 6f6c 735f 7365 6c5f 6c69  t..n_cols_sel_li
+00002ca0: 7374 7242 0000 00da 0270 6972 1f00 0000  strB.....pir....
+00002cb0: 7227 0000 0072 7700 0000 7250 0000 0072  r'...rw...rP...r
+00002cc0: 2800 0000 728e 0000 0072 8f00 0000 7290  (...r....r....r.
+00002cd0: 0000 0072 9100 0000 7256 0000 0072 5700  ...r....rV...rW.
+00002ce0: 0000 7258 0000 0072 5900 0000 7292 0000  ..rX...rY...r...
+00002cf0: 0072 9300 0000 7294 0000 0072 4000 0000  .r....r....r@...
+00002d00: 7295 0000 00da 0263 31da 0263 3272 0f00  r......c1..c2r..
+00002d10: 0000 a902 7255 0000 0072 ab00 0000 7215  ....rU...r....r.
+00002d20: 0000 00da 126c 6f61 645f 6e70 795f 6964  .....load_npy_id
+00002d30: 785f 6d75 6c74 6901 0100 0073 6e00 0000  x_multi....sn...
+00002d40: 0011 0c01 1a01 0801 1601 0e01 0e01 0e01  ................
+00002d50: 0e01 2201 20ff 0402 1201 08ff 0402 0a01  ..". ...........
+00002d60: 06ff 0603 1401 0803 1e01 1401 0602 0801  ................
+00002d70: 2a03 1201 0801 0801 0801 0801 0801 0801  *...............
+00002d80: 0801 0803 1401 2401 0c02 0601 2801 2a01  ......$.....(.*.
+00002d90: 2003 0601 1a02 0c01 0801 1401 1a01 1a01   ...............
+00002da0: 1a01 1202 1a01 0c02 3201 1801 0c01 72c0  ........2.....r.
+00002db0: 0000 00e9 a00f 0000 6309 0000 0000 0000  ........c.......
+00002dc0: 0000 0000 0024 0000 000b 0000 0003 0000  .....$..........
+00002dd0: 0073 8204 0000 8800 6401 7500 721e 6402  .s......d.u.r.d.
+00002de0: 6403 8400 7400 7401 7c00 8301 8301 4400  d...t.t.|.....D.
+00002df0: 8301 8900 7402 8800 8301 7403 7501 7244  ....t.....t.u.rD
+00002e00: 8700 6601 6404 6403 8408 7400 7401 7c00  ..f.d.d...t.t.|.
+00002e10: 8301 8301 4400 8301 8900 7c02 6401 7500  ....D.....|.d.u.
+00002e20: 7262 6405 6403 8400 7400 7401 7c00 8301  rbd.d...t.t.|...
+00002e30: 8301 4400 8301 7d02 6406 6403 8400 7c00  ..D...}.d.d...|.
+00002e40: 4400 8301 7d09 6407 6403 8400 7c00 4400  D...}.d.d...|.D.
+00002e50: 8301 8901 6408 6403 8400 7c00 4400 8301  ....d.d...|.D...
+00002e60: 7d0a 6409 6403 8400 8801 4400 8301 7d0b  }.d.d.....D...}.
+00002e70: 7404 a005 640a 6403 8400 8800 4400 8301  t...d.d.....D...
+00002e80: a101 72be 640b 6403 8400 7c09 4400 8301  ..r.d.d...|.D...
+00002e90: 7d0c 6e0e 640c 6403 8400 8800 4400 8301  }.n.d.d.....D...
+00002ea0: 7d0c 7401 7c00 8301 7401 8800 8301 6b02  }.t.|...t.....k.
+00002eb0: 72ee 7401 7c00 8301 7401 7c02 8301 6b02  r.t.|...t.|...k.
+00002ec0: 9001 7314 4a00 640d 7401 7c00 8301 9b00  ..s.J.d.t.|.....
+00002ed0: 640e 7401 8800 8301 9b00 640f 7401 7c02  d.t.......d.t.|.
+00002ee0: 8301 9b00 9d06 8301 8201 7401 7406 7c0c  ..........t.t.|.
+00002ef0: 8301 8301 6410 6b02 9001 7334 4a00 6411  ....d.k...s4J.d.
+00002f00: 7c0c 9b00 9d02 8301 8201 8701 6601 6412  |...........f.d.
+00002f10: 6403 8408 7407 7c02 8301 4400 8301 7d0d  d...t.|...D...}.
+00002f20: 7404 6a08 7c0c 6413 1900 7404 a009 7c0d  t.j.|.d...t...|.
+00002f30: a101 6602 7404 6a0a 6414 8d02 7d0e 7c04  ..f.t.j.d...}.|.
+00002f40: 6401 7500 9001 737c 7c04 6415 6b02 9001  d.u...s||.d.k...
+00002f50: 7282 6416 7d04 6e08 7c04 6417 3900 7d04  r.d.}.n.|.d.9.}.
+00002f60: 7c05 6418 6b05 9001 72b8 740b 6419 7c0e  |.d.k...r.t.d.|.
+00002f70: 6a0c 9b00 641a 7404 a00d 7c0e 6a0c a101  j...d.t...|.j...
+00002f80: 641b 1400 641c 9b04 9d04 8301 0100 7400  d...d.........t.
+00002f90: 7401 7c00 8301 8301 4400 9002 5db6 7d0f  t.|.....D...].}.
+00002fa0: 7c00 7c0f 1900 7d10 7c0a 7c0f 1900 7d11  |.|...}.|.|...}.
+00002fb0: 8800 7c0f 1900 7d12 7c02 7c0f 1900 7d13  ..|...}.|.|...}.
+00002fc0: 8801 7c0f 1900 7d14 7c0b 7c0f 1900 7d15  ..|...}.|.|...}.
+00002fd0: 7c0c 7c0f 1900 7d16 7c0d 7c0f 1900 7d17  |.|...}.|.|...}.
+00002fe0: 7c03 6401 7500 9002 731e 7c03 6415 6b02  |.d.u...s.|.d.k.
+00002ff0: 9002 724e 7404 a00d 7c14 6410 6401 8502  ..rNt...|.d.d...
+00003000: 1900 a101 641d 7c11 7600 9002 723c 641e  ....d.|.v...r<d.
+00003010: 6e02 641b 1400 7d18 740e 7c04 7c18 1b00  n.d...}.t.|.|...
+00003020: 8301 7d03 7c05 6418 6b05 9002 72ca 740b  ..}.|.d.k...r.t.
+00003030: 641f 7c0f 6420 9b04 6421 7c14 9b00 641a  d.|.d ..d!|...d.
+00003040: 7404 a00d 7c14 a101 641b 1400 641c 9b04  t...|...d...d...
+00003050: 9d06 8301 0100 740b 6422 7c0f 6420 9b04  ......t.d"|.d ..
+00003060: 6421 7c16 7c17 6602 9b00 641a 7c16 7c17  d!|.|.f...d.|.|.
+00003070: 1400 641b 1400 641c 9b04 9d06 8301 0100  ..d...d.........
+00003080: 740b 6423 7c04 641c 9b04 6421 7c03 641c  t.d#|.d...d!|.d.
+00003090: 9b04 6424 7c18 6425 9b04 9d06 8301 0100  ..d$|.d%........
+000030a0: 7c05 6410 6b05 9002 72ee 740f 7400 6413  |.d.k...r.t.t.d.
+000030b0: 7c15 7c03 8303 6426 6427 6428 6429 8d04  |.|...d&d'd(d)..
+000030c0: 7d19 6e0c 7400 6413 7c15 7c03 8303 7d19  }.n.t.d.|.|...}.
+000030d0: 7c19 4400 9001 5d70 7d1a 7c1a 7410 7c15  |.D...]p}.|.t.|.
+000030e0: 7c1a 7c03 1700 8302 0200 7d1b 7d1c 7c1b  |.|.......}.}.|.
+000030f0: 740e 7404 a00d 7c14 6410 6415 8502 1900  t.t...|.d.d.....
+00003100: a101 8301 1400 7d1d 7c1c 740e 7404 a00d  ......}.|.t.t...
+00003110: 7c14 6410 6415 8502 1900 a101 8301 1400  |.d.d...........
+00003120: 7d1e 7c12 6401 7501 9004 7200 7404 a011  }.|.d.u...r.t...
+00003130: 7c1d 7c12 6b01 7c12 7c1e 6b00 4000 a101  |.|.k.|.|.k.@...
+00003140: 6413 1900 7d1f 7401 7c1f 8301 6413 6b02  d...}.t.|...d.k.
+00003150: 9003 7282 9002 71fe 7412 7c10 7c1b 7c1c  ..r...q.t.|.|.|.
+00003160: 7c13 7c06 7c07 7c08 642a 8d07 a013 6415  |.|.|.|.d*....d.
+00003170: 7c17 a102 7d20 7c12 7c1f 1900 7c1d 1800  |...} |.|...|...
+00003180: 7d21 740e 7404 a009 7c0d 6401 7c0f 8502  }!t.t...|.d.|...
+00003190: 1900 a101 8301 740e 7404 a009 7c0d 6401  ......t.t...|.d.
+000031a0: 7c0f 6410 1700 8502 1900 a101 8301 0200  |.d.............
+000031b0: 7d22 7d23 7414 7c0e 7c1f 7404 a015 7c22  }"}#t.|.|.t...|"
+000031c0: 7c23 a102 7416 7c20 7c21 6413 642b 8d03  |#..t.| |!d.d+..
+000031d0: 8304 0100 6e6e 7412 7c10 7c1b 7c1c 7c13  ....nnt.|.|.|.|.
+000031e0: 7c06 7c07 7c08 642a 8d07 a013 6415 7c17  |.|.|.d*....d.|.
+000031f0: a102 7d20 740e 7404 a009 7c0d 6401 7c0f  ..} t.t...|.d.|.
+00003200: 8502 1900 a101 8301 740e 7404 a009 7c0d  ........t.t...|.
+00003210: 6401 7c0f 6410 1700 8502 1900 a101 8301  d.|.d...........
+00003220: 0200 7d22 7d23 7414 7c0e 7404 a015 7c1d  ..}"}#t.|.t...|.
+00003230: 7c1e a102 7404 a015 7c22 7c23 a102 7c20  |...t...|"|#..| 
+00003240: 8304 0100 9002 71fe 7417 a018 a100 0100  ......q.t.......
+00003250: 9001 71c4 7c0e 5300 292c 7ab0 0a20 2020  ..q.|.S.),z..   
+00003260: 2061 203d 2072 7a5f 6c6f 6164 5f6e 7079   a = rz_load_npy
+00003270: 5f69 6478 5f6d 756c 7469 285b 7061 7468  _idx_multi([path
+00003280: 2c20 7061 7468 5d2c 204e 6f6e 652c 2063  , path], None, c
+00003290: 6f6c 735f 6c69 7374 203d 205b 6e70 2e61  ols_list = [np.a
+000032a0: 7261 6e67 6528 302c 2031 3030 3029 2c20  range(0, 1000), 
+000032b0: 6e70 2e61 7261 6e67 6528 3130 3030 2c20  np.arange(1000, 
+000032c0: 3230 3030 295d 2c20 7665 7262 6f73 653d  2000)], verbose=
+000032d0: 5472 7565 2c20 6e5f 6a6f 6273 203d 3136  True, n_jobs =16
+000032e0: 2c20 6b74 696d 6573 203d 2031 302c 2062  , ktimes = 10, b
+000032f0: 6c6f 636b 5f73 697a 6520 3d20 3430 3030  lock_size = 4000
+00003300: 2920 2320 3230 730a 2020 2020 4e63 0100  ) # 20s.    Nc..
+00003310: 0000 0000 0000 0000 0000 0200 0000 0300  ................
+00003320: 0000 5300 0000 7310 0000 0067 007c 005d  ..S...s....g.|.]
+00003330: 087d 0164 0091 0271 0453 0072 9b00 0000  .}.d...q.S.r....
+00003340: 720f 0000 0072 9900 0000 720f 0000 0072  r....r....r....r
+00003350: 0f00 0000 7215 0000 0072 1600 0000 5f01  ....r....r...._.
+00003360: 0000 7217 0000 007a 2972 7a5f 6c6f 6164  ..r....z)rz_load
+00003370: 5f6e 7079 5f69 6478 5f6d 756c 7469 2e3c  _npy_idx_multi.<
+00003380: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+00003390: 703e 6301 0000 0000 0000 0000 0000 0002  p>c.............
+000033a0: 0000 0003 0000 0013 0000 0073 1000 0000  ...........s....
+000033b0: 6700 7c00 5d08 7d01 8800 9102 7104 5300  g.|.].}.....q.S.
+000033c0: 720f 0000 0072 0f00 0000 7299 0000 0072  r....r....r....r
+000033d0: 9a00 0000 720f 0000 0072 1500 0000 7216  ....r....r....r.
+000033e0: 0000 0061 0100 0072 1700 0000 6301 0000  ...a...r....c...
+000033f0: 0000 0000 0000 0000 0002 0000 0003 0000  ................
+00003400: 0053 0000 0073 1000 0000 6700 7c00 5d08  .S...s....g.|.].
+00003410: 7d01 6400 9102 7104 5300 729b 0000 0072  }.d...q.S.r....r
+00003420: 0f00 0000 7299 0000 0072 0f00 0000 720f  ....r....r....r.
+00003430: 0000 0072 1500 0000 7216 0000 0063 0100  ...r....r....c..
+00003440: 0072 1700 0000 6301 0000 0000 0000 0000  .r....c.........
+00003450: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+00003460: 1400 0000 6700 7c00 5d0c 7d01 7400 7c01  ....g.|.].}.t.|.
+00003470: 8301 9102 7104 5300 720f 0000 0072 9d00  ....q.S.r....r..
+00003480: 0000 729e 0000 0072 0f00 0000 720f 0000  ..r....r....r...
+00003490: 0072 1500 0000 7216 0000 0065 0100 0072  .r....r....e...r
+000034a0: 1700 0000 6301 0000 0000 0000 0000 0000  ....c...........
+000034b0: 0002 0000 0004 0000 0053 0000 0073 1800  .........S...s..
+000034c0: 0000 6700 7c00 5d10 7d01 7400 7c01 8301  ..g.|.].}.t.|...
+000034d0: 6400 1900 9102 7104 5300 729c 0000 0072  d.....q.S.r....r
+000034e0: 9d00 0000 729e 0000 0072 0f00 0000 720f  ....r....r....r.
+000034f0: 0000 0072 1500 0000 7216 0000 0066 0100  ...r....r....f..
+00003500: 0072 1700 0000 6301 0000 0000 0000 0000  .r....c.........
+00003510: 0000 0002 0000 0005 0000 0053 0000 0073  ...........S...s
+00003520: 1c00 0000 6700 7c00 5d14 7d01 7400 7401  ....g.|.].}.t.t.
+00003530: 7c01 8301 6400 1900 8301 9102 7104 5300  |...d.......q.S.
+00003540: 729f 0000 0072 a000 0000 729e 0000 0072  r....r....r....r
+00003550: 0f00 0000 720f 0000 0072 1500 0000 7216  ....r....r....r.
+00003560: 0000 0067 0100 0072 1700 0000 6301 0000  ...g...r....c...
+00003570: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00003580: 0053 0000 0073 1400 0000 6700 7c00 5d0c  .S...s....g.|.].
+00003590: 7d01 7c01 6400 1900 9102 7104 5300 729c  }.|.d.....q.S.r.
+000035a0: 0000 0072 0f00 0000 72a1 0000 0072 0f00  ...r....r....r..
+000035b0: 0000 720f 0000 0072 1500 0000 7216 0000  ..r....r....r...
+000035c0: 0068 0100 0072 1700 0000 6301 0000 0000  .h...r....c.....
+000035d0: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
+000035e0: 0000 0073 1400 0000 6700 7c00 5d0c 7d01  ...s....g.|.].}.
+000035f0: 7c01 6400 7500 9102 7104 5300 729b 0000  |.d.u...q.S.r...
+00003600: 0072 0f00 0000 72a3 0000 0072 0f00 0000  .r....r....r....
+00003610: 720f 0000 0072 1500 0000 7216 0000 0069  r....r....r....i
+00003620: 0100 0072 1700 0000 6301 0000 0000 0000  ...r....c.......
+00003630: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
+00003640: 0073 1800 0000 6700 7c00 5d10 7d01 7c01  .s....g.|.].}.|.
+00003650: 6400 1900 6400 1900 9102 7104 5300 729c  d...d.....q.S.r.
+00003660: 0000 0072 0f00 0000 2902 7213 0000 0072  ...r....).r....r
+00003670: 5300 0000 720f 0000 0072 0f00 0000 7215  S...r....r....r.
+00003680: 0000 0072 1600 0000 6a01 0000 7217 0000  ...r....j...r...
+00003690: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+000036a0: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
+000036b0: 007c 005d 0c7d 0174 007c 0183 0191 0271  .|.].}.t.|.....q
+000036c0: 0453 0072 0f00 0000 72a2 0000 0072 a300  .S.r....r....r..
+000036d0: 0000 720f 0000 0072 0f00 0000 7215 0000  ..r....r....r...
+000036e0: 0072 1600 0000 6c01 0000 7217 0000 0072  .r....l...r....r
+000036f0: a400 0000 72a5 0000 0072 a600 0000 7203  ....r....r....r.
+00003700: 0000 0072 a700 0000 6301 0000 0000 0000  ...r....c.......
+00003710: 0000 0000 0003 0000 0004 0000 0013 0000  ................
+00003720: 0073 2c00 0000 6700 7c00 5d24 5c02 7d01  .s,...g.|.]$\.}.
+00003730: 7d02 7c02 6400 7500 7220 8800 7c01 1900  }.|.d.u.r ..|...
+00003740: 6401 1900 6e06 7400 7c02 8301 9102 7104  d...n.t.|.....q.
+00003750: 5300 72a8 0000 0072 a200 0000 72a9 0000  S.r....r....r...
+00003760: 0072 aa00 0000 720f 0000 0072 1500 0000  .r....r....r....
+00003770: 7216 0000 0070 0100 0073 0400 0000 0601  r....p...s......
+00003780: 06ff 7201 0000 0072 3c00 0000 722e 0000  ..r....r<...r...
+00003790: 0072 7900 0000 72ac 0000 00e9 0200 0000  .ry...r.........
+000037a0: 72ad 0000 0072 7c00 0000 727b 0000 0072  r....r|...r{...r
+000037b0: 7d00 0000 727a 0000 0072 7300 0000 72ae  }...rz...rs...r.
+000037c0: 0000 0072 af00 0000 727f 0000 0072 b000  ...r....r....r..
+000037d0: 0000 727e 0000 0072 8000 0000 7281 0000  ..r~...r....r...
+000037e0: 007a 1772 7a5f 6c6f 6164 5f6e 7079 5f69  .z.rz_load_npy_i
+000037f0: 6478 5f6d 756c 7469 2829 7245 0000 0054  dx_multi()rE...T
+00003800: 7282 0000 0029 0672 3e00 0000 723f 0000  r....).r>...r?..
+00003810: 0072 5000 0000 7252 0000 0072 6f00 0000  .rP...rR...ro...
+00003820: 7270 0000 0072 4900 0000 2919 7230 0000  rp...rI...).r0..
+00003830: 0072 4c00 0000 72b1 0000 0072 4d00 0000  .rL...r....rM...
+00003840: 7219 0000 00da 0361 6c6c 72b2 0000 0072  r......allr....r
+00003850: b300 0000 724b 0000 0072 b500 0000 725e  ....rK...r....r^
+00003860: 0000 0072 8800 0000 7228 0000 0072 3600  ...r....r(...r6.
+00003870: 0000 7287 0000 0072 0200 0000 7289 0000  ..r....r....r...
+00003880: 0072 8a00 0000 7272 0000 0072 3d00 0000  .r....rr...r=...
+00003890: 7209 0000 0072 4e00 0000 7206 0000 0072  r....rN...r....r
+000038a0: 2900 0000 722a 0000 0029 2472 b600 0000  )...r*...)$r....
+000038b0: 7255 0000 0072 b700 0000 728b 0000 0072  rU...r....r....r
+000038c0: 8c00 0000 7251 0000 0072 5200 0000 726f  ....rQ...rR...ro
+000038d0: 0000 0072 7000 0000 5a0b 6865 6164 6572  ...rp...Z.header
+000038e0: 5f6c 6973 7472 b800 0000 72b9 0000 0072  _listr....r....r
+000038f0: ba00 0000 72bb 0000 0072 4200 0000 72bc  ....r....rB...r.
+00003900: 0000 0072 1f00 0000 7227 0000 0072 7700  ...r....r'...rw.
+00003910: 0000 7250 0000 0072 2800 0000 728e 0000  ..rP...r(...r...
+00003920: 0072 8f00 0000 7290 0000 0072 9100 0000  .r....r....r....
+00003930: 7256 0000 0072 5700 0000 7258 0000 0072  rV...rW...rX...r
+00003940: 5900 0000 7292 0000 0072 9300 0000 7294  Y...r....r....r.
+00003950: 0000 0072 4000 0000 7295 0000 0072 bd00  ...r@...r....r..
+00003960: 0000 72be 0000 0072 0f00 0000 72bf 0000  ..r....r....r...
+00003970: 0072 1500 0000 da15 727a 5f6c 6f61 645f  .r......rz_load_
+00003980: 6e70 795f 6964 785f 6d75 6c74 6956 0100  npy_idx_multiV..
+00003990: 0073 7600 0000 0008 0801 1601 0c01 1a01  .sv.............
+000039a0: 0801 1602 0e01 0e01 0e01 0e01 1401 1002  ................
+000039b0: 0e01 2401 20ff 0402 2001 0a01 06ff 0604  ..$. ... .......
+000039c0: 1e01 1401 0602 0801 2e03 1201 0801 0801  ................
+000039d0: 0801 0801 0801 0801 0801 0803 1401 2401  ..............$.
+000039e0: 0c02 0a01 2801 2a01 2003 2401 0c02 0a01  ....(.*. .$.....
+000039f0: 1401 1a01 1a02 0a01 1a01 1202 1e01 0c02  ................
+00003a00: 3201 2202 1e01 3201 2201 0c01 72c4 0000  2."...2."...r...
+00003a10: 0072 4400 0000 6304 0000 0000 0000 0000  .rD...c.........
+00003a20: 0000 000a 0000 0006 0000 0043 0000 0073  ...........C...s
+00003a30: c800 0000 7400 6a01 7402 7c00 8301 7402  ....t.j.t.|...t.
+00003a40: 7c01 8301 6602 7400 6a03 6401 8d02 7d04  |...f.t.j.d...}.
+00003a50: 7404 7405 6402 7402 7c01 8301 7c02 8303  t.t.d.t.|...|...
+00003a60: 8301 7d05 7c05 7c05 6403 1900 7402 7c01  ..}.|.|.d...t.|.
+00003a70: 8301 6b03 724c 7402 7c01 8301 6701 6e02  ..k.rLt.|...g.n.
+00003a80: 6700 3700 7d05 7c03 7270 7406 7405 7402  g.7.}.|.rpt.t.t.
+00003a90: 7c05 8301 6404 1800 8301 6405 6406 6407  |...d.....d.d.d.
+00003aa0: 8d03 6e0e 7405 7402 7c05 8301 6404 1800  ..n.t.t.|...d...
+00003ab0: 8301 7d06 7c06 4400 5d3e 7d07 7c05 7c07  ..}.|.D.]>}.|.|.
+00003ac0: 1900 7c05 7c07 6404 1700 1900 0200 7d08  ..|.|.d.......}.
+00003ad0: 7d09 7c00 7c01 7c08 7c09 8502 1900 1900  }.|.|.|.|.......
+00003ae0: a007 a100 7c04 6400 6400 8502 7c08 7c09  ....|.d.d...|.|.
+00003af0: 8502 6602 3c00 7184 7c04 5300 2908 4e72  ..f.<.q.|.S.).Nr
+00003b00: 3c00 0000 7201 0000 0072 2e00 0000 7203  <...r....r....r.
+00003b10: 0000 0072 4500 0000 5472 4600 0000 2908  ...rE...TrF...).
+00003b20: 7219 0000 0072 b400 0000 724c 0000 0072  r....r....rL...r
+00003b30: 5e00 0000 724d 0000 0072 3000 0000 7202  ^...rM...r0...r.
+00003b40: 0000 005a 0874 6f5f 6e75 6d70 7929 0ada  ...Z.to_numpy)..
+00003b50: 0264 6672 5000 0000 da01 6b72 5100 0000  .dfrP.....krQ...
+00003b60: 7240 0000 005a 0363 696a 7256 0000 0072  r@...Z.cijrV...r
+00003b70: 5700 0000 da02 6369 5a02 636a 720f 0000  W.....ciZ.cjr...
+00003b80: 0072 0f00 0000 7215 0000 00da 095f 746f  .r....r......_to
+00003b90: 5f6e 756d 7079 aa01 0000 7310 0000 0000  _numpy....s.....
+00003ba0: 011c 0114 0122 012e 0108 0116 0126 0172  .....".......&.r
+00003bb0: c800 0000 da02 7064 6303 0000 0000 0000  ......pdc.......
+00003bc0: 0000 0000 0008 0000 0009 0000 0043 0000  .............C..
+00003bd0: 0073 ec00 0000 7c01 6401 7500 721a 6402  .s....|.d.u.r.d.
+00003be0: 6403 8400 7400 7c00 8301 4400 8301 7d01  d...t.|...D...}.
+00003bf0: 7c02 6404 6b02 7242 7401 6a02 a003 7c00  |.d.k.rBt.j...|.
+00003c00: a101 a004 a100 6a05 6405 6406 8d01 7d03  ......j.d.d...}.
+00003c10: 7c01 7c03 5f06 6ea6 7c02 6407 6b02 72e8  |.|._.n.|.d.k.r.
+00003c20: 6408 6403 8400 7c00 4400 8301 7d04 7407  d.d...|.D...}.t.
+00003c30: a008 a100 7d03 7409 7400 7c04 8301 8301  ....}.t.t.|.....
+00003c40: 4400 5d7a 7d05 7c00 7c05 1900 7d06 7c05  D.]z}.|.|...}.|.
+00003c50: 6409 1700 7400 7c04 8301 6b00 72a6 740a  d...t.|...k.r.t.
+00003c60: a00b 7c06 740a a00c 7c04 7c05 6409 1700  ..|.t...|.|.d...
+00003c70: 6401 8502 1900 a101 a102 7d06 7409 7c05  d.........}.t.|.
+00003c80: 6409 1800 640a 640a 8303 4400 5d14 7d07  d...d.d...D.].}.
+00003c90: 740a a00d 7c06 7c04 7c07 1900 a102 7d06  t...|.|.|.....}.
+00003ca0: 71b6 7c03 a00e 7407 a00f 7410 7c01 7c05  q.|...t...t.|.|.
+00003cb0: 1900 8301 7c06 a102 a101 7d03 716c 7c03  ....|.....}.ql|.
+00003cc0: 5300 290b 7a7c 0a20 2020 2064 665f 6964  S.).z|.    df_id
+00003cd0: 203d 2072 7a2e 7574 696c 2e6e 7079 2e67   = rz.util.npy.g
+00003ce0: 6574 5f64 665f 6964 5f61 6c6c 285b 6e70  et_df_id_all([np
+00003cf0: 2e61 7261 6e67 6528 7829 2e61 7374 7970  .arange(x).astyp
+00003d00: 6528 6e70 2e69 6e74 3332 2920 666f 7220  e(np.int32) for 
+00003d10: 7820 696e 2073 6861 7065 5d2c 2063 6f6c  x in shape], col
+00003d20: 735f 6964 203d 205b 2764 6174 6527 2c20  s_id = ['date', 
+00003d30: 2774 6964 272c 2027 6964 275d 290a 2020  'tid', 'id']).  
+00003d40: 2020 4e63 0100 0000 0000 0000 0000 0000    Nc............
+00003d50: 0200 0000 0400 0000 5300 0000 7316 0000  ........S...s...
+00003d60: 0067 007c 005d 0e7d 0164 007c 019b 009d  .g.|.].}.d.|....
+00003d70: 0291 0271 0453 0029 0172 1400 0000 720f  ...q.S.).r....r.
+00003d80: 0000 0029 0272 1300 0000 7257 0000 0072  ...).r....rW...r
+00003d90: 0f00 0000 720f 0000 0072 1500 0000 7216  ....r....r....r.
+00003da0: 0000 00b8 0100 0072 1700 0000 7a21 6765  .......r....z!ge
+00003db0: 745f 6466 5f69 645f 616c 6c2e 3c6c 6f63  t_df_id_all.<loc
+00003dc0: 616c 733e 2e3c 6c69 7374 636f 6d70 3e72  als>.<listcomp>r
+00003dd0: c900 0000 54a9 015a 0464 726f 70da 0270  ....T..Z.drop..p
+00003de0: 6c63 0100 0000 0000 0000 0000 0000 0200  lc..............
+00003df0: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
+00003e00: 007c 005d 0c7d 0174 007c 0183 0191 0271  .|.].}.t.|.....q
+00003e10: 0453 0072 0f00 0000 72a2 0000 0072 1200  .S.r....r....r..
+00003e20: 0000 720f 0000 0072 0f00 0000 7215 0000  ..r....r....r...
+00003e30: 0072 1600 0000 bd01 0000 7217 0000 0072  .r........r....r
+00003e40: 0300 0000 722e 0000 0029 1172 4c00 0000  ....r....).rL...
+00003e50: 72c9 0000 00da 0a4d 756c 7469 496e 6465  r......MultiInde
+00003e60: 78da 0c66 726f 6d5f 7072 6f64 7563 74da  x..from_product.
+00003e70: 0874 6f5f 6672 616d 65da 0b72 6573 6574  .to_frame..reset
+00003e80: 5f69 6e64 6578 da07 636f 6c75 6d6e 7372  _index..columnsr
+00003e90: cb00 0000 da09 4461 7461 4672 616d 6572  ......DataFramer
+00003ea0: 3000 0000 7219 0000 00da 0672 6570 6561  0...r......repea
+00003eb0: 7472 3600 0000 5a04 7469 6c65 da0c 7769  tr6...Z.tile..wi
+00003ec0: 7468 5f63 6f6c 756d 6e73 5a06 5365 7269  th_columnsZ.Seri
+00003ed0: 6573 7211 0000 0029 08da 0769 645f 6c69  esr....)...id_li
+00003ee0: 7374 da07 636f 6c73 5f69 6472 6300 0000  st..cols_idrc...
+00003ef0: da09 6466 5f69 645f 616c 6c72 2800 0000  ..df_id_allr(...
+00003f00: 7257 0000 0072 1400 0000 da01 6a72 0f00  rW...r......jr..
+00003f10: 0000 720f 0000 0072 1500 0000 da0d 6765  ..r....r......ge
+00003f20: 745f 6466 5f69 645f 616c 6cb4 0100 0073  t_df_id_all....s
+00003f30: 1a00 0000 0004 1a01 0801 1801 0801 0801  ................
+00003f40: 0e01 0801 1001 0801 2e01 2601 1c01 72d8  ..........&...r.
+00003f50: 0000 0063 0600 0000 0000 0000 0000 0000  ...c............
+00003f60: 1000 0000 0700 0000 4300 0000 730c 0200  ........C...s...
+00003f70: 007c 0064 0119 007d 067c 0344 005d 267d  .|.d...}.|.D.]&}
+00003f80: 077c 06a0 0064 027c 079b 009d 027c 066a  .|...d.|.....|.j
+00003f90: 016a 027c 0719 00a0 0374 046a 05a1 01a1  .j.|.....t.j....
+00003fa0: 0201 0071 0c64 0364 0484 007c 0344 0083  ...q.d.d...|.D..
+00003fb0: 017d 037c 06a0 067c 01a1 017d 087c 0464  .}.|...|...}.|.d
+00003fc0: 0575 0072 7867 007d 047c 0144 005d 1a7d  .u.rxg.}.|.D.].}
+00003fd0: 077c 04a0 0774 087c 087c 0719 00a0 09a1  .|...t.|.|......
+00003fe0: 0083 01a1 0101 0071 5c64 0664 0484 007c  .......q\d.d...|
+00003ff0: 0444 0083 017d 0974 0a6a 0ba0 0c7c 04a1  .D...}.t.j...|..
+00004000: 01a0 0da1 006a 0e64 0764 088d 017d 0a7c  .....j.d.d...}.|
+00004010: 017c 0a5f 0f7c 0aa0 037c 086a 10a0 11a1  .|._.|...|.j....
+00004020: 00a1 017d 0a74 12a0 137c 0aa1 017d 0a7c  ...}.t...|...}.|
+00004030: 06a0 147c 017c 0217 007c 0317 00a1 017d  ...|.|...|.....}
+00004040: 0b7e 0674 15a0 16a1 0001 007c 0572 ec7c  .~.t.......|.r.|
+00004050: 0064 013d 0074 15a0 16a1 0001 007c 0a6a  .d.=.t.......|.j
+00004060: 177c 0b7c 0164 0964 0a8d 037d 0c7c 0b6a  .|.|.d.d...}.|.j
+00004070: 0f44 005d 107d 077c 0ba0 187c 07a1 0101  .D.].}.|...|....
+00004080: 0090 0171 027e 0b74 15a0 16a1 0001 007e  ...q.~.t.......~
+00004090: 0a74 15a0 16a1 0001 007c 027c 0317 0044  .t.......|.|...D
+000040a0: 005d 447d 0774 197c 0c7c 0719 006a 1a83  .]D}.t.|.|...j..
+000040b0: 01a0 1ba1 007d 0d64 0b7c 0d76 0190 0172  .....}.d.|.v...r
+000040c0: 3064 0c7c 0d76 0190 0172 307c 0ca0 1c7c  0d.|.v...r0|...|
+000040d0: 0c7c 0719 00a0 1d74 126a 1e6a 1fa1 01a1  .|.....t.j.j....
+000040e0: 017d 0c90 0171 3064 057d 0e74 207c 0383  .}...q0d.}.t |..
+000040f0: 0164 0d6b 0490 0172 b474 217c 0c7c 0383  .d.k...r.t!|.|..
+00004100: 027d 0e7c 0ea0 2267 007c 09a2 0174 207c  .}.|.."g.|...t |
+00004110: 0383 0191 0152 00a1 017d 0e74 04a0 237c  .....R...}.t..#|
+00004120: 0ea1 017d 0e74 217c 0c7c 0283 027d 0f7c  ...}.t!|.|...}.|
+00004130: 0c6a 0f44 005d 107d 077c 0ca0 187c 07a1  .j.D.].}.|...|..
+00004140: 0101 0090 0171 c47e 0c74 15a0 16a1 0001  .....q.~.t......
+00004150: 007c 0fa0 2267 007c 09a2 0174 207c 0283  .|.."g.|...t |..
+00004160: 0191 0152 00a1 017d 0f74 04a0 237c 0fa1  ...R...}.t..#|..
+00004170: 017d 0f7c 0f7c 0e7c 0466 0353 0029 0e61  .}.|.|.|.f.S.).a
+00004180: d001 0000 0a20 2020 2064 6d5f 6469 6374  .....    dm_dict
+00004190: 203d 207b 2764 6d27 3a20 646d 7d0a 2020   = {'dm': dm}.  
+000041a0: 2020 6465 6c20 646d 3b20 6763 2e63 6f6c    del dm; gc.col
+000041b0: 6c65 6374 2829 0a0a 2020 2020 636f 6c73  lect()..    cols
+000041c0: 5f69 6420 3d20 5b63 6f6c 5f64 6174 652c  _id = [col_date,
+000041d0: 2063 6f6c 5f69 645d 0a20 2020 2063 6f6c   col_id].    col
+000041e0: 735f 6d61 736b 203d 205b 2774 7261 696e  s_mask = ['train
+000041f0: 272c 2027 7465 7374 272c 2027 7661 6c69  ', 'test', 'vali
+00004200: 6427 2c20 2761 6c6c 272c 2027 7a64 7427  d', 'all', 'zdt'
+00004210: 5d0a 2020 2020 636f 6c73 5f64 6174 6120  ].    cols_data 
+00004220: 3d20 5b63 6f6c 5f6c 6162 656c 5d20 2b20  = [col_label] + 
+00004230: 636f 6c73 5f66 6561 0a0a 2020 2020 6466  cols_fea..    df
+00004240: 5f69 6420 3d20 646d 5f64 6963 745b 2764  _id = dm_dict['d
+00004250: 6d27 5d2e 6765 745f 636f 6c73 5f70 616e  m'].get_cols_pan
+00004260: 6461 7328 636f 6c73 5f69 6429 0a20 2020  das(cols_id).   
+00004270: 2069 645f 6c69 7374 203d 205b 736f 7274   id_list = [sort
+00004280: 6564 2864 665f 6964 5b63 6f6c 5d2e 756e  ed(df_id[col].un
+00004290: 6971 7565 2829 2920 666f 7220 636f 6c20  ique()) for col 
+000042a0: 696e 2063 6f6c 735f 6964 5d0a 2020 2020  in cols_id].    
+000042b0: 6964 5f6c 6973 745b 305d 203d 2069 645f  id_list[0] = id_
+000042c0: 6c69 7374 5b30 5d23 5b3a 3530 305d 0a0a  list[0]#[:500]..
+000042d0: 2020 2020 615f 6461 7461 2c20 615f 6d61      a_data, a_ma
+000042e0: 736b 2c20 6964 5f6c 6973 745f 7265 7420  sk, id_list_ret 
+000042f0: 3d20 2020 2020 2020 2020 746f 5f6d 646e  =         to_mdn
+00004300: 7079 2864 6d5f 6469 6374 2c20 636f 6c73  py(dm_dict, cols
+00004310: 5f69 642c 2063 6f6c 735f 6461 7461 2c20  _id, cols_data, 
+00004320: 636f 6c73 5f6d 6173 6b2c 2069 645f 6c69  cols_mask, id_li
+00004330: 7374 203d 2069 645f 6c69 7374 2c20 6672  st = id_list, fr
+00004340: 6565 5f72 6177 203d 2046 616c 7365 290a  ee_raw = False).
+00004350: 2020 2020 da02 646d da05 4d41 534b 5f63      ..dm..MASK_c
+00004360: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00004370: 0400 0000 5300 0000 7316 0000 0067 007c  ....S...s....g.|
+00004380: 005d 0e7d 0164 007c 019b 009d 0291 0271  .].}.d.|.......q
+00004390: 0453 0029 0172 da00 0000 720f 0000 0029  .S.).r....r....)
+000043a0: 0272 1300 0000 da03 636f 6c72 0f00 0000  .r......colr....
+000043b0: 720f 0000 0072 1500 0000 7216 0000 00da  r....r....r.....
+000043c0: 0100 0072 1700 0000 7a1c 746f 5f6d 646e  ...r....z.to_mdn
+000043d0: 7079 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  py.<locals>.<lis
+000043e0: 7463 6f6d 703e 4e63 0100 0000 0000 0000  tcomp>Nc........
+000043f0: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+00004400: 7314 0000 0067 007c 005d 0c7d 0174 007c  s....g.|.].}.t.|
+00004410: 0183 0191 0271 0453 0072 0f00 0000 72a2  .....q.S.r....r.
+00004420: 0000 0072 1200 0000 720f 0000 0072 0f00  ...r....r....r..
+00004430: 0000 7215 0000 0072 1600 0000 e201 0000  ..r....r........
+00004440: 7217 0000 0054 72ca 0000 00da 046c 6566  r....Tr......lef
+00004450: 7429 02da 026f 6eda 0368 6f77 725e 0000  t)...on..howr^..
+00004460: 005a 0366 3332 7201 0000 0029 245a 0a73  .Z.f32r....)$Z.s
+00004470: 6574 5f62 795f 636f 6c5a 066d 6173 6b65  et_by_colZ.maske
+00004480: 725a 096d 6173 6b5f 4449 4354 5a06 6173  rZ.mask_DICTZ.as
+00004490: 7479 7065 7219 0000 005a 0569 6e74 3332  typer....Z.int32
+000044a0: 5a0f 6765 745f 636f 6c73 5f70 616e 6461  Z.get_cols_panda
+000044b0: 73da 0661 7070 656e 64da 0673 6f72 7465  s..append..sorte
+000044c0: 64da 0675 6e69 7175 6572 c900 0000 72cc  d..uniquer....r.
+000044d0: 0000 0072 cd00 0000 72ce 0000 0072 cf00  ...r....r....r..
+000044e0: 0000 72d0 0000 005a 0664 7479 7065 735a  ..r....Z.dtypesZ
+000044f0: 0774 6f5f 6469 6374 72cb 0000 0072 d100  .to_dictr....r..
+00004500: 0000 5a0f 6765 745f 636f 6c73 5f70 6f6c  ..Z.get_cols_pol
+00004510: 6172 7372 2900 0000 722a 0000 0072 1d00  arsr)...r*...r..
+00004520: 0000 5a0d 6472 6f70 5f69 6e5f 706c 6163  ..Z.drop_in_plac
+00004530: 6572 1100 0000 7227 0000 00da 056c 6f77  er....r'.....low
+00004540: 6572 72d3 0000 00da 0463 6173 745a 0964  err......castZ.d
+00004550: 6174 6174 7970 6573 5a07 466c 6f61 7433  atatypesZ.Float3
+00004560: 3272 4c00 0000 72c8 0000 0072 3d00 0000  2rL...r....r=...
+00004570: 7286 0000 0029 10da 0764 6d5f 6469 6374  r....)...dm_dict
+00004580: 72d5 0000 00da 0963 6f6c 735f 6461 7461  r......cols_data
+00004590: da09 636f 6c73 5f6d 6173 6b72 d400 0000  ..cols_maskr....
+000045a0: da08 6672 6565 5f72 6177 72d9 0000 0072  ..free_rawr....r
+000045b0: db00 0000 5a05 6466 5f69 6472 2800 0000  ....Z.df_idr(...
+000045c0: 72d6 0000 005a 0b64 665f 765f 6f72 6967  r....Z.df_v_orig
+000045d0: 696e 5a04 6466 5f76 5a08 7479 7065 5f6f  inZ.df_vZ.type_o
+000045e0: 6c64 da06 615f 6d61 736b da06 615f 6461  ld..a_mask..a_da
+000045f0: 7461 720f 0000 0072 0f00 0000 7215 0000  tar....r....r...
+00004600: 00da 0874 6f5f 6d64 6e70 79c7 0100 0073  ...to_mdnpy....s
+00004610: 4a00 0000 0010 0801 0801 2401 0e03 0a01  J.........$.....
+00004620: 0801 0401 0801 1801 0e01 1801 0601 1001  ................
+00004630: 0a05 1201 0a01 0401 0e01 1001 1801 0a03  ................
+00004640: 0a04 0c01 1201 1401 1c07 0401 0e01 0a01  ................
+00004650: 1801 0a02 0a01 1801 0a01 1801 0a01 72ea  ..............r.
+00004660: 0000 00fa 022e 2f72 4500 0000 fa08 6461  ....../rE.....da
+00004670: 7461 2e6e 7079 6309 0000 0000 0000 0000  ta.npyc.........
+00004680: 0000 0018 0000 0009 0000 0043 0000 0073  ...........C...s
+00004690: dc01 0000 7400 6a01 7c05 6401 6402 8d02  ....t.j.|.d.d...
+000046a0: 0100 7400 6a02 a003 7c05 9b00 6403 7c08  ..t.j...|...d.|.
+000046b0: 9b00 9d03 a101 723a 7400 a004 6404 7c05  ......r:t...d.|.
+000046c0: 9b00 6403 7c08 9b00 9d04 a101 0100 7405  ..d.|.........t.
+000046d0: 7c03 8301 4400 5d38 5c02 7d09 7d0a 7400  |...D.]8\.}.}.t.
+000046e0: 6a02 a003 7c05 9b00 6405 7c0a 9b00 6406  j...|...d.|...d.
+000046f0: 9d04 a101 7242 7400 a004 6404 7c05 9b00  ....rBt...d.|...
+00004700: 6405 7c0a 9b00 6406 9d05 a101 0100 7142  d.|...d.......qB
+00004710: 6407 6408 8400 7c04 4400 8301 7d0b 6700  d.d...|.D...}.g.
+00004720: 7c0b a201 7406 7c02 8301 9101 5200 7d0c  |...t.|.....R.}.
+00004730: 7407 7c0b 8301 7d0d 7c04 6409 1900 a008  t.|...}.|.d.....
+00004740: a100 7d0e 7406 7c0e 8301 7d0f 7409 740a  ..}.t.|...}.t.t.
+00004750: 6409 7c0f 7c06 8303 8301 7d10 7c10 7c10  d.|.|.....}.|.|.
+00004760: 640a 1900 7c0f 6b03 72dc 7c0f 6701 6e02  d...|.k.r.|.g.n.
+00004770: 6700 3700 7d10 7c07 9001 7202 740b 740a  g.7.}.|...r.t.t.
+00004780: 7406 7c10 8301 640b 1800 8301 640c 6401  t.|...d.....d.d.
+00004790: 640d 8d03 6e0e 740a 7406 7c10 8301 640b  d...n.t.t.|...d.
+000047a0: 1800 8301 7d11 7c11 4400 5db8 7d12 7c10  ....}.|.D.].}.|.
+000047b0: 7c12 1900 7c10 7c12 640b 1700 1900 0200  |...|.|.d.......
+000047c0: 7d13 7d14 7c0e 7c13 7c14 8502 1900 7c04  }.}.|.|.|.....|.
+000047d0: 6409 3c00 740c 7c00 7c01 7c02 7c03 7c04  d.<.t.|.|.|.|.|.
+000047e0: 640e 640f 8d06 5c03 7d15 7d16 7d17 740d  d.d...\.}.}.}.t.
+000047f0: 7c15 7c05 9b00 6403 7c08 9b00 9d03 7c13  |.|...d.|.....|.
+00004800: 7c14 7c0c 8305 0100 7405 7c03 8301 4400  |.|.....t.|...D.
+00004810: 5d2e 5c02 7d09 7d0a 740d 7c16 6410 7c09  ].\.}.}.t.|.d.|.
+00004820: 6602 1900 7c05 9b00 6405 7c0a 9b00 6406  f...|...d.|...d.
+00004830: 9d04 7c13 7c14 7c0d 8305 0100 9001 717c  ..|.|.|.......q|
+00004840: 7e15 7e16 7e17 740e a00f a100 0100 7c07  ~.~.~.t.......|.
+00004850: 9001 7216 7410 8300 0100 7411 8300 0100  ..r.t.....t.....
+00004860: 9001 7116 7c0e 7c04 6409 3c00 6411 5300  ..q.|.|.d.<.d.S.
+00004870: 2912 6115 0200 000a 2020 2020 646d 5f64  ).a.....    dm_d
+00004880: 6963 7420 3d20 7b27 646d 273a 2064 6d7d  ict = {'dm': dm}
+00004890: 0a20 2020 2064 656c 2064 6d3b 2067 632e  .    del dm; gc.
+000048a0: 636f 6c6c 6563 7428 290a 0a20 2020 2063  collect()..    c
+000048b0: 6f6c 735f 6964 203d 205b 636f 6c5f 6461  ols_id = [col_da
+000048c0: 7465 2c20 636f 6c5f 6964 5d0a 2020 2020  te, col_id].    
+000048d0: 636f 6c73 5f6d 6173 6b20 3d20 5b27 7472  cols_mask = ['tr
+000048e0: 6169 6e27 2c20 2774 6573 7427 2c20 2776  ain', 'test', 'v
+000048f0: 616c 6964 272c 2027 616c 6c27 2c20 277a  alid', 'all', 'z
+00004900: 6474 275d 0a20 2020 2063 6f6c 735f 6461  dt'].    cols_da
+00004910: 7461 203d 205b 636f 6c5f 6c61 6265 6c5d  ta = [col_label]
+00004920: 202b 2063 6f6c 735f 6665 610a 0a20 2020   + cols_fea..   
+00004930: 2064 665f 6964 203d 2064 6d5f 6469 6374   df_id = dm_dict
+00004940: 5b27 646d 275d 2e67 6574 5f63 6f6c 735f  ['dm'].get_cols_
+00004950: 7061 6e64 6173 2863 6f6c 735f 6964 290a  pandas(cols_id).
+00004960: 2020 2020 6964 5f6c 6973 7420 3d20 5b73      id_list = [s
+00004970: 6f72 7465 6428 6466 5f69 645b 636f 6c5d  orted(df_id[col]
+00004980: 2e75 6e69 7175 6528 2929 2066 6f72 2063  .unique()) for c
+00004990: 6f6c 2069 6e20 636f 6c73 5f69 645d 0a20  ol in cols_id]. 
+000049a0: 2020 2069 645f 6c69 7374 5b30 5d20 3d20     id_list[0] = 
+000049b0: 6964 5f6c 6973 745b 305d 235b 3a35 3030  id_list[0]#[:500
+000049c0: 5d0a 0a20 2020 2074 6f5f 6d64 6e70 795f  ]..    to_mdnpy_
+000049d0: 616e 645f 6475 6d70 2864 6d5f 6469 6374  and_dump(dm_dict
+000049e0: 2c20 636f 6c73 5f69 642c 2063 6f6c 735f  , cols_id, cols_
+000049f0: 6461 7461 2c20 636f 6c73 5f6d 6173 6b2c  data, cols_mask,
+00004a00: 2069 645f 6c69 7374 203d 2069 645f 6c69   id_list = id_li
+00004a10: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00004a20: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
+00004a30: 3d20 5472 7565 2c20 7061 7468 203d 2027  = True, path = '
+00004a40: 2e2f 6d64 6e70 792f 272c 2062 6174 6368  ./mdnpy/', batch
+00004a50: 5f73 697a 6520 3d20 3130 3029 0a20 2020  _size = 100).   
+00004a60: 2072 7a2e 6765 745f 6d65 6d5f 6375 7228   rz.get_mem_cur(
+00004a70: 293b 2072 7a2e 6765 745f 6d65 6d5f 6d61  ); rz.get_mem_ma
+00004a80: 7828 2920 2020 200a 2020 2020 5429 01da  x()    .    T)..
+00004a90: 0865 7869 7374 5f6f 6bfa 012f 7a03 726d  .exist_ok../z.rm
+00004aa0: 207a 062f 6d61 736b 5f7a 042e 6e70 7963   z./mask_z..npyc
+00004ab0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00004ac0: 0400 0000 5300 0000 7314 0000 0067 007c  ....S...s....g.|
+00004ad0: 005d 0c7d 0174 007c 0183 0191 0271 0453  .].}.t.|.....q.S
+00004ae0: 0072 0f00 0000 72a2 0000 0072 1200 0000  .r....r....r....
+00004af0: 720f 0000 0072 0f00 0000 7215 0000 0072  r....r....r....r
+00004b00: 1600 0000 2c02 0000 7217 0000 007a 2574  ....,...r....z%t
+00004b10: 6f5f 6d64 6e70 795f 616e 645f 6475 6d70  o_mdnpy_and_dump
+00004b20: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
+00004b30: 6f6d 703e 7201 0000 0072 2e00 0000 7203  omp>r....r....r.
+00004b40: 0000 0072 4500 0000 7246 0000 0046 2902  ...rE...rF...F).
+00004b50: 72d4 0000 0072 e700 0000 2e4e 2912 7266  r....r.....N).rf
+00004b60: 0000 00da 086d 616b 6564 6972 7372 1f00  .....makedirsr..
+00004b70: 0000 7267 0000 00da 0673 7973 7465 6d72  ..rg.....systemr
+00004b80: b300 0000 724c 0000 00da 0574 7570 6c65  ....rL.....tuple
+00004b90: da04 636f 7079 724d 0000 0072 3000 0000  ..copyrM...r0...
+00004ba0: 7202 0000 0072 ea00 0000 7268 0000 0072  r....r....rh...r
+00004bb0: 2900 0000 722a 0000 0072 0400 0000 7205  )...r*...r....r.
+00004bc0: 0000 0029 1872 e400 0000 72d5 0000 0072  ...).r....r....r
+00004bd0: e500 0000 72e6 0000 0072 d400 0000 721f  ....r....r....r.
+00004be0: 0000 0072 8b00 0000 7251 0000 005a 0964  ...r....rQ...Z.d
+00004bf0: 6174 615f 6e61 6d65 da02 6d69 72db 0000  ata_name..mir...
+00004c00: 0072 2800 0000 5a0a 6461 7461 5f73 6861  .r(...Z.data_sha
+00004c10: 7065 5a0a 6d61 736b 5f73 6861 7065 5a09  peZ.mask_shapeZ.
+00004c20: 6964 5f6c 6973 745f 3072 5400 0000 5a03  id_list_0rT...Z.
+00004c30: 7069 6a72 5600 0000 7257 0000 0072 bc00  pijrV...rW...r..
+00004c40: 0000 5a02 706a 72e9 0000 0072 e800 0000  ..Z.pjr....r....
+00004c50: 5a0b 6964 5f6c 6973 745f 7265 7472 0f00  Z.id_list_retr..
+00004c60: 0000 720f 0000 0072 1500 0000 da11 746f  ..r....r......to
+00004c70: 5f6d 646e 7079 5f61 6e64 5f64 756d 7011  _mdnpy_and_dump.
+00004c80: 0200 0073 3200 0000 0013 0e01 1601 1601  ...s2...........
+00004c90: 1001 1801 1a03 0e01 1201 0803 0c01 0801  ................
+00004ca0: 1001 1a01 3001 0801 1601 1003 12ff 0804  ....0...........
+00004cb0: 1a01 1001 2801 0e01 1603 72f4 0000 0029  ....(.....r....)
+00004cc0: 064e 4e4e 725f 0000 0046 5429 044e 4e4e  .NNNr_...FT).NNN
+00004cd0: 725f 0000 0029 084e 4e4e 725f 0000 0046  r_...).NNNr_...F
+00004ce0: 4672 6900 0000 722c 0000 0029 074e 4e4e  Fri...r,...).NNN
+00004cf0: 725f 0000 0046 7273 0000 0072 2c00 0000  r_...Frs...r,...
+00004d00: 2902 4e4e 2906 4e72 2e00 0000 4e46 4654  ).NN).Nr....NFFT
+00004d10: 2908 4e72 2e00 0000 4e46 4646 7273 0000  ).Nr....NFFFrs..
+00004d20: 0072 0300 0000 2905 4e72 2e00 0000 4e46  .r....).Nr....NF
+00004d30: 5429 074e 722e 0000 0072 c100 0000 7201  T).Nr....r....r.
+00004d40: 0000 0046 7269 0000 0072 2c00 0000 2902  ...Fri...r,...).
+00004d50: 7244 0000 0046 2902 4e72 c900 0000 2902  rD...F).Nr....).
+00004d60: 4e46 2905 4e72 eb00 0000 7245 0000 0046  NF).Nr....rE...F
+00004d70: 72ec 0000 0029 2472 6600 0000 da05 6e75  r....)$rf.....nu
+00004d80: 6d70 7972 1900 0000 da06 7061 6e64 6173  mpyr......pandas
+00004d90: 72c9 0000 00da 0670 6f6c 6172 7372 cb00  r......polarsr..
+00004da0: 0000 7202 0000 0072 2900 0000 da04 7574  ..r....r).....ut
+00004db0: 696c 7204 0000 0072 0500 0000 5a09 6e70  ilr....r....Z.np
+00004dc0: 795f 6e75 6d62 6172 0600 0000 7207 0000  y_numbar....r...
+00004dd0: 0072 0800 0000 7209 0000 00da 0372 756e  .r....r......run
+00004de0: 720a 0000 0072 0b00 0000 da06 656e 6162  r....r......enab
+00004df0: 6c65 7224 0000 0072 2500 0000 7265 0000  ler$...r%...re..
+00004e00: 0072 6800 0000 7272 0000 0072 7500 0000  .rh...rr...ru...
+00004e10: 7278 0000 0072 9600 0000 7298 0000 0072  rx...r....r....r
+00004e20: c000 0000 72c4 0000 0072 c800 0000 72d8  ....r....r....r.
+00004e30: 0000 0072 ea00 0000 72f4 0000 0072 0f00  ...r....r....r..
+00004e40: 0000 720f 0000 0072 0f00 0000 7215 0000  ..r....r....r...
+00004e50: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
+00004e60: 4400 0000 0801 0801 0801 0801 0c01 0801  D...............
+00004e70: 1001 1801 1001 0803 0807 0e4d 0a0b 0a11  ...........M....
+00004e80: 0a14 0a0f 0a0e 0001 00ff 0a42 0a11 0001  ...........B....
+00004e90: 00ff 0a55 0001 0001 00fe 0a54 0a0a 0a13  ...U.......T....
+00004ea0: 0a4a 0001 00ff 0a37                      .J.....7
```

## runningz/util/npy_numba_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 88032 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 e057 0100  a.........Yf.W..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 e057 0100  a.........\f.W..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## runningz/util/npy_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 25416 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 4863 0000  a.........YfHc..
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 e263 0000  a.........\f.c..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
@@ -10,15 +10,15 @@
 00000090: 0000 0000 0000 0000 0004 0000 0008 0000  ................
 000000a0: 0043 0000 0073 5c00 0000 7400 6a01 a002  .C...s\...t.j...
 000000b0: 7403 a101 6401 1700 7c00 1700 7d01 6402  t...d...|...}.d.
 000000c0: 7d02 7c02 a004 6403 6404 a102 7d02 7405  }.|...d.d...}.t.
 000000d0: 7c01 6405 8302 8f1a 7d03 7c03 a006 7c02  |.d.....}.|...|.
 000000e0: a101 0100 5700 6400 0400 0400 8303 0100  ....W.d.........
 000000f0: 6e10 3100 734e 3000 0100 0100 0100 5900  n.1.sN0.......Y.
-00000100: 0100 6400 5300 2906 4efa 012f 75a3 6100  ..d.S.).N../u.a.
+00000100: 0100 6400 5300 2906 4efa 012f 753d 6200  ..d.S.).N../u=b.
 00000110: 0069 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
 00000120: 7420 6e75 6d70 7920 6173 206e 700a 696d  t numpy as np.im
 00000130: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
 00000140: 640a 696d 706f 7274 2070 6f6c 6172 7320  d.import polars 
 00000150: 6173 2070 6c0a 6672 6f6d 2074 7164 6d20  as pl.from tqdm 
 00000160: 696d 706f 7274 2074 7164 6d0a 696d 706f  import tqdm.impo
 00000170: 7274 2067 630a 6672 6f6d 202e 7574 696c  rt gc.from .util
@@ -479,1127 +479,1137 @@
 00001de0: 6f63 6b5f 7369 7a65 203d 2032 3030 202a  ock_size = 200 *
 00001df0: 2031 3032 3420 2a20 3130 3234 2023 2032   1024 * 1024 # 2
 00001e00: 3030 4d0a 2020 2020 656c 7365 3a0a 2020  00M.    else:.  
 00001e10: 2020 2020 2020 626c 6f63 6b5f 7369 7a65        block_size
 00001e20: 203d 2062 6c6f 636b 5f73 697a 6520 2a20   = block_size * 
 00001e30: 3130 3234 202a 2031 3032 340a 0a20 2020  1024 * 1024..   
 00001e40: 2023 2062 6174 6368 5f73 697a 650a 2020   # batch_size.  
-00001e50: 2020 6966 2062 6174 6368 5f73 697a 6520    if batch_size 
-00001e60: 6973 204e 6f6e 6520 6f72 2062 6174 6368  is None or batch
-00001e70: 5f73 697a 6520 3d3d 202d 313a 0a20 2020  _size == -1:.   
-00001e80: 2020 2020 2073 697a 655f 6f6e 655f 726f       size_one_ro
-00001e90: 7720 3d20 286e 702e 7072 6f64 2873 6861  w = (np.prod(sha
-00001ea0: 7065 5b31 3a5d 2920 2a20 2838 2069 6620  pe[1:]) * (8 if 
-00001eb0: 2736 3427 2069 6e20 6474 7970 6520 656c  '64' in dtype el
-00001ec0: 7365 2034 2929 0a20 2020 2020 2020 2062  se 4)).        b
-00001ed0: 6174 6368 5f73 697a 6520 3d20 696e 7428  atch_size = int(
-00001ee0: 626c 6f63 6b5f 7369 7a65 202f 2073 697a  block_size / siz
-00001ef0: 655f 6f6e 655f 726f 7729 0a0a 2020 2020  e_one_row)..    
-00001f00: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
-00001f10: 2020 2020 7072 696e 7428 6627 5b2b 5d20      print(f'[+] 
-00001f20: 6461 7461 5f61 6c6c 2020 2020 3d20 7b73  data_all    = {s
-00001f30: 6861 7065 7d2c 206d 656d 203d 207b 6e70  hape}, mem = {np
-00001f40: 2e70 726f 6428 7368 6170 6529 202a 2034  .prod(shape) * 4
-00001f50: 3a2c 2e30 667d 2729 2020 2020 0a20 2020  :,.0f}')    .   
-00001f60: 2020 2020 2070 7269 6e74 2866 2720 2020       print(f'   
-00001f70: 2064 6174 615f 7365 6c20 2020 203d 207b   data_sel    = {
-00001f80: 6461 7461 2e73 6861 7065 7d2c 206d 656d  data.shape}, mem
-00001f90: 203d 207b 6e70 2e70 726f 6428 6461 7461   = {np.prod(data
-00001fa0: 2e73 6861 7065 2920 2a20 343a 2c2e 3066  .shape) * 4:,.0f
-00001fb0: 7d27 2920 2020 200a 2020 2020 2020 2020  }')    .        
-00001fc0: 7072 696e 7428 6627 2020 2020 626c 6f63  print(f'    bloc
-00001fd0: 6b5f 7369 7a65 2020 3d20 7b62 6c6f 636b  k_size  = {block
-00001fe0: 5f73 697a 653a 2c2e 3066 7d20 3d20 7b62  _size:,.0f} = {b
-00001ff0: 6174 6368 5f73 697a 653a 2c2e 3066 7d20  atch_size:,.0f} 
-00002000: 2a20 7b73 697a 655f 6f6e 655f 726f 773a  * {size_one_row:
-00002010: 2e30 667d 2729 0a0a 2020 2020 2320 6c6f  .0f}')..    # lo
-00002020: 6164 0a20 2020 2069 6620 7665 7262 6f73  ad.    if verbos
-00002030: 653a 0a20 2020 2020 2020 2072 6720 3d20  e:.        rg = 
-00002040: 7471 646d 2872 616e 6765 2830 2c20 6e5f  tqdm(range(0, n_
-00002050: 726f 7773 2c20 6261 7463 685f 7369 7a65  rows, batch_size
-00002060: 292c 2064 6573 633d 6627 6c6f 6164 5f6e  ), desc=f'load_n
-00002070: 7079 5f69 6478 2829 272c 206e 636f 6c73  py_idx()', ncols
-00002080: 3d31 3030 2c20 6173 6369 693d 5472 7565  =100, ascii=True
-00002090: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-000020a0: 2020 2020 7267 203d 2072 616e 6765 2830      rg = range(0
-000020b0: 2c20 6e5f 726f 7773 2c20 6261 7463 685f  , n_rows, batch_
-000020c0: 7369 7a65 290a 2020 2020 666f 7220 6920  size).    for i 
-000020d0: 696e 2072 673a 0a20 2020 2020 2020 2070  in rg:.        p
-000020e0: 312c 2070 3220 3d20 692c 206d 696e 286e  1, p2 = i, min(n
-000020f0: 5f72 6f77 732c 2069 202b 2062 6174 6368  _rows, i + batch
-00002100: 5f73 697a 6529 0a20 2020 2020 2020 205f  _size).        _
-00002110: 7031 203d 2069 6e74 2870 3120 2a20 6e70  p1 = int(p1 * np
-00002120: 2e70 726f 6428 7368 6170 655b 313a 2d31  .prod(shape[1:-1
-00002130: 5d29 290a 2020 2020 2020 2020 5f70 3220  ])).        _p2 
-00002140: 3d20 696e 7428 7032 202a 206e 702e 7072  = int(p2 * np.pr
-00002150: 6f64 2873 6861 7065 5b31 3a2d 315d 2929  od(shape[1:-1]))
-00002160: 0a20 2020 2020 2020 2069 6478 5f73 656c  .        idx_sel
-00002170: 203d 206e 702e 7768 6572 6528 285f 7031   = np.where((_p1
-00002180: 203c 3d20 6964 7829 2026 2028 6964 7820   <= idx) & (idx 
-00002190: 3c20 5f70 3229 295b 305d 0a20 2020 2020  < _p2))[0].     
-000021a0: 2020 2069 6620 6c65 6e28 6964 785f 7365     if len(idx_se
-000021b0: 6c29 203d 3d20 303a 2063 6f6e 7469 6e75  l) == 0: continu
-000021c0: 650a 0a20 2020 2020 2020 2061 203d 206c  e..        a = l
-000021d0: 6f61 645f 6e70 7928 7061 7468 2c20 7374  oad_npy(path, st
-000021e0: 6172 7420 3d20 7031 2c20 656e 6420 3d20  art = p1, end = 
-000021f0: 7032 2c20 636f 6c73 203d 2063 6f6c 732c  p2, cols = cols,
-00002200: 2075 7365 5f6e 756d 6261 203d 2075 7365   use_numba = use
-00002210: 5f6e 756d 6261 292e 7265 7368 6170 6528  _numba).reshape(
-00002220: 2d31 2c20 6e5f 636f 6c73 5f73 656c 290a  -1, n_cols_sel).
-00002230: 2020 2020 2020 2020 6964 785f 6120 3d20          idx_a = 
-00002240: 6964 785b 6964 785f 7365 6c5d 202d 205f  idx[idx_sel] - _
-00002250: 7031 0a0a 2020 2020 2020 2020 6966 2075  p1..        if u
-00002260: 7365 5f6e 756d 6261 3a0a 2020 2020 2020  se_numba:.      
-00002270: 2020 2020 2020 6e70 5f73 6574 2864 6174        np_set(dat
-00002280: 612c 2069 6478 5f73 656c 2c20 615b 6964  a, idx_sel, a[id
-00002290: 785f 615d 2c20 6178 6973 203d 2030 290a  x_a], axis = 0).
-000022a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000022b0: 2020 2020 2020 2020 2020 6966 2073 6f72            if sor
-000022c0: 745f 696e 6465 783a 0a20 2020 2020 2020  t_index:.       
-000022d0: 2020 2020 2020 2020 2064 6174 615b 6964           data[id
-000022e0: 785f 7365 6c5b 305d 3a20 6964 785f 7365  x_sel[0]: idx_se
-000022f0: 6c5b 2d31 5d20 2b20 315d 203d 2061 5b69  l[-1] + 1] = a[i
-00002300: 6478 5f61 5d0a 2020 2020 2020 2020 2020  dx_a].          
-00002310: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00002320: 2020 2020 2020 2020 6461 7461 5b69 6478          data[idx
-00002330: 5f73 656c 5d20 3d20 615b 6964 785f 615d  _sel] = a[idx_a]
-00002340: 0a20 2020 2067 632e 636f 6c6c 6563 7428  .    gc.collect(
-00002350: 290a 2020 2020 7265 7475 726e 2064 6174  ).    return dat
-00002360: 6120 200a 0a23 206c 6f61 645f 6e70 795f  a  ..# load_npy_
-00002370: 6964 780a 6465 6620 727a 5f6c 6f61 645f  idx.def rz_load_
-00002380: 6e70 795f 6964 7828 7061 7468 2c20 6964  npy_idx(path, id
-00002390: 782c 2063 6f6c 7320 3d20 4e6f 6e65 2c20  x, cols = None, 
-000023a0: 6261 7463 685f 7369 7a65 203d 202d 312c  batch_size = -1,
-000023b0: 2062 6c6f 636b 5f73 697a 6520 3d20 4e6f   block_size = No
-000023c0: 6e65 2c20 736f 7274 5f69 6e64 6578 203d  ne, sort_index =
-000023d0: 2046 616c 7365 2c20 7665 7262 6f73 6520   False, verbose 
-000023e0: 3d20 4661 6c73 652c 2075 7365 5f6e 756d  = False, use_num
-000023f0: 6261 203d 2046 616c 7365 2c20 6e5f 6a6f  ba = False, n_jo
-00002400: 6273 203d 2038 2c20 6b74 696d 6573 203d  bs = 8, ktimes =
-00002410: 2031 293a 0a20 2020 205c 275c 275c 270a   1):.    \'\'\'.
-00002420: 2020 2020 727a e5bc 80e5 a4b4 e79a 84e5      rz..........
-00002430: 87bd e695 b02c 206b 7469 6d65 7320 3d20  ....., ktimes = 
-00002440: 31e6 98af e585 b3e9 94ae 202a 2a2a 2a2a  1......... *****
-00002450: 2a20 727a 5f6c 6f61 645f 6e70 795f 6964  * rz_load_npy_id
-00002460: 7820 2a2a 2a2a 2a2a 0a20 2020 206e 5f6a  x ******.    n_j
-00002470: 6f62 7320 3d20 382c 206b 7469 6d65 7320  obs = 8, ktimes 
-00002480: 3d20 312c 2034 2074 696d 6573 2066 6173  = 1, 4 times fas
-00002490: 7465 7220 7468 616e 206c 6f61 645f 6e70  ter than load_np
-000024a0: 795f 6964 780a 2020 2020 3747 422f 730a  y_idx.    7GB/s.
-000024b0: 2020 2020 5c27 5c27 5c27 0a20 2020 2068      \'\'\'.    h
-000024c0: 6561 6465 7220 3d20 7265 6164 5f6e 7079  eader = read_npy
-000024d0: 5f68 6561 6465 7228 7061 7468 290a 2020  _header(path).  
-000024e0: 2020 6966 2063 6f6c 7320 6973 204e 6f6e    if cols is Non
-000024f0: 653a 2061 203d 206e 702e 656d 7074 7928  e: a = np.empty(
-00002500: 286c 656e 2869 6478 292c 2068 6561 6465  (len(idx), heade
-00002510: 725b 305d 5b2d 315d 292c 2064 7479 7065  r[0][-1]), dtype
-00002520: 203d 206e 702e 666c 6f61 7433 3229 0a20   = np.float32). 
-00002530: 2020 2065 6c73 653a 2061 203d 206e 702e     else: a = np.
-00002540: 656d 7074 7928 286c 656e 2869 6478 292c  empty((len(idx),
-00002550: 206c 656e 2863 6f6c 7329 292c 2064 7479   len(cols)), dty
-00002560: 7065 203d 206e 702e 666c 6f61 7433 3229  pe = np.float32)
-00002570: 0a20 2020 2064 6566 2072 7a5f 7275 6e28  .    def rz_run(
-00002580: 7031 2c20 7032 293a 0a20 2020 2020 2020  p1, p2):.       
-00002590: 2069 6620 7031 203e 3d20 7032 3a20 7265   if p1 >= p2: re
-000025a0: 7475 726e 0a20 2020 2020 2020 2061 5b70  turn.        a[p
-000025b0: 313a 2070 325d 203d 206c 6f61 645f 6e70  1: p2] = load_np
-000025c0: 795f 6964 7828 7061 7468 2c20 6964 785b  y_idx(path, idx[
-000025d0: 7031 3a20 7032 5d2c 2063 6f6c 732c 2062  p1: p2], cols, b
-000025e0: 6174 6368 5f73 697a 652c 2062 6c6f 636b  atch_size, block
-000025f0: 5f73 697a 652c 2073 6f72 745f 696e 6465  _size, sort_inde
-00002600: 782c 2076 6572 626f 7365 203d 2046 616c  x, verbose = Fal
-00002610: 7365 2c20 7573 655f 6e75 6d62 6120 3d20  se, use_numba = 
-00002620: 4661 6c73 6529 0a20 2020 2061 6b73 203d  False).    aks =
-00002630: 2067 6574 5f61 6b73 286c 656e 2861 292c   get_aks(len(a),
-00002640: 206e 5f6a 6f62 7320 2a20 6b74 696d 6573   n_jobs * ktimes
-00002650: 290a 2020 2020 7275 6e5f 6675 6e63 2872  ).    run_func(r
-00002660: 7a5f 7275 6e2c 2061 6b73 2c20 6e5f 6a6f  z_run, aks, n_jo
-00002670: 6273 203d 206e 5f6a 6f62 732c 206d 6f64  bs = n_jobs, mod
-00002680: 6520 3d20 2773 6d27 2c20 7665 7262 6f73  e = 'sm', verbos
-00002690: 6520 3d20 7665 7262 6f73 6529 0a20 2020  e = verbose).   
-000026a0: 2072 6574 7572 6e20 610a 0a23 206c 6f61   return a..# loa
-000026b0: 645f 6e70 795f 6964 785f 6d75 6c74 690a  d_npy_idx_multi.
-000026c0: 6465 6620 6c6f 6164 5f6e 7079 5f69 6478  def load_npy_idx
-000026d0: 5f6d 756c 7469 2870 6174 685f 6c69 7374  _multi(path_list
-000026e0: 2c20 6964 785f 6c69 7374 2c20 636f 6c73  , idx_list, cols
-000026f0: 5f6c 6973 7420 3d20 4e6f 6e65 2c20 0a20  _list = None, . 
-00002700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002710: 2020 2020 2020 6261 7463 685f 7369 7a65        batch_size
-00002720: 203d 202d 312c 2062 6c6f 636b 5f73 697a   = -1, block_siz
-00002730: 6520 3d20 4e6f 6e65 2c20 7665 7262 6f73  e = None, verbos
-00002740: 6520 3d20 4661 6c73 652c 2075 7365 5f6e  e = False, use_n
-00002750: 756d 6261 203d 2054 7275 6529 3a0a 2020  umba = True):.  
-00002760: 2020 5c27 5c27 5c27 0a20 2020 2069 6478    \'\'\'.    idx
-00002770: 203d 206e 702e 736f 7274 286e 702e 7261   = np.sort(np.ra
-00002780: 6e64 6f6d 2e70 6572 6d75 7461 7469 6f6e  ndom.permutation
-00002790: 2832 3030 3030 3030 295b 3a31 3930 3030  (2000000)[:19000
-000027a0: 3030 5d29 0a20 2020 2063 6f6c 7320 3d20  00]).    cols = 
-000027b0: 6e70 2e72 616e 646f 6d2e 7065 726d 7574  np.random.permut
-000027c0: 6174 696f 6e28 3130 3030 295b 3a39 3030  ation(1000)[:900
-000027d0: 5d0a 2020 2020 6461 7461 203d 2072 7a2e  ].    data = rz.
-000027e0: 7574 696c 2e6e 7079 2e6c 6f61 645f 6e70  util.npy.load_np
-000027f0: 795f 6964 785f 6d75 6c74 6928 5b27 612e  y_idx_multi(['a.
-00002800: 6e70 7927 2c20 2761 2e6e 7079 275d 2c20  npy', 'a.npy'], 
-00002810: 6964 782c 2063 6f6c 735f 6c69 7374 203d  idx, cols_list =
-00002820: 205b 636f 6c73 2c20 636f 6c73 5d2c 200a   [cols, cols], .
-00002830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002840: 2020 2020 2020 2020 626c 6f63 6b5f 7369          block_si
-00002850: 7a65 203d 2032 3030 2c20 7665 7262 6f73  ze = 200, verbos
-00002860: 6520 3d20 5472 7565 2c20 7573 655f 6e75  e = True, use_nu
-00002870: 6d62 6120 3d20 4661 6c73 6529 0a0a 2020  mba = False)..  
-00002880: 2020 727a 2e67 6574 5f6d 656d 5f63 7572    rz.get_mem_cur
-00002890: 2829 2c20 727a 2e67 6574 5f6d 656d 5f6d  (), rz.get_mem_m
-000028a0: 6178 2829 3b0a 2020 2020 6461 7461 203d  ax();.    data =
-000028b0: 206c 6f61 645f 6e70 795f 6964 785f 6d75   load_npy_idx_mu
-000028c0: 6c74 6928 5b27 612e 6e70 7927 2c20 2762  lti(['a.npy', 'b
-000028d0: 2e6e 7079 275d 2c20 6d61 736b 5f69 6478  .npy'], mask_idx
-000028e0: 2c20 636f 6c73 5f6c 6973 7420 3d20 5b63  , cols_list = [c
-000028f0: 6f6c 732c 2063 6f6c 735d 2c20 0a20 2020  ols, cols], .   
-00002900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002910: 2020 2020 2020 2020 626c 6f63 6b5f 7369          block_si
-00002920: 7a65 203d 2032 3030 2c20 7665 7262 6f73  ze = 200, verbos
-00002930: 6520 3d20 5472 7565 290a 2020 2020 7072  e = True).    pr
-00002940: 696e 7428 6461 7461 2e73 6861 7065 290a  int(data.shape).
-00002950: 2020 2020 7072 696e 7428 6627 7b34 202a      print(f'{4 *
-00002960: 206e 702e 7072 6f64 2864 6174 612e 7368   np.prod(data.sh
-00002970: 6170 6529 3a2c 2e30 667d 2729 0a20 2020  ape):,.0f}').   
-00002980: 2072 7a2e 6765 745f 6d65 6d5f 6375 7228   rz.get_mem_cur(
-00002990: 292c 2072 7a2e 6765 745f 6d65 6d5f 6d61  ), rz.get_mem_ma
-000029a0: 7828 293b 0a20 2020 205c 275c 275c 270a  x();.    \'\'\'.
-000029b0: 2020 2020 0a20 2020 2023 2069 6e70 7574      .    # input
-000029c0: 0a20 2020 2069 6620 7479 7065 2869 6478  .    if type(idx
-000029d0: 5f6c 6973 7429 2069 7320 6e6f 7420 6c69  _list) is not li
-000029e0: 7374 3a0a 2020 2020 2020 2020 6964 785f  st:.        idx_
-000029f0: 6c69 7374 203d 205b 6964 785f 6c69 7374  list = [idx_list
-00002a00: 2066 6f72 205f 2069 6e20 7261 6e67 6528   for _ in range(
-00002a10: 6c65 6e28 7061 7468 5f6c 6973 7429 295d  len(path_list))]
-00002a20: 0a20 2020 2069 6620 636f 6c73 5f6c 6973  .    if cols_lis
-00002a30: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00002a40: 2020 2063 6f6c 735f 6c69 7374 203d 205b     cols_list = [
-00002a50: 4e6f 6e65 2066 6f72 205f 2069 6e20 7261  None for _ in ra
-00002a60: 6e67 6528 6c65 6e28 7061 7468 5f6c 6973  nge(len(path_lis
-00002a70: 7429 295d 0a20 2020 2073 6861 7065 5f6c  t))].    shape_l
-00002a80: 6973 7420 3d20 5b72 6561 645f 6e70 795f  ist = [read_npy_
-00002a90: 6865 6164 6572 2870 6174 6829 5b30 5d20  header(path)[0] 
-00002aa0: 666f 7220 7061 7468 2069 6e20 7061 7468  for path in path
-00002ab0: 5f6c 6973 745d 0a20 2020 2064 7479 7065  _list].    dtype
-00002ac0: 5f6c 6973 7420 3d20 5b73 7472 2872 6561  _list = [str(rea
-00002ad0: 645f 6e70 795f 6865 6164 6572 2870 6174  d_npy_header(pat
-00002ae0: 6829 5b2d 315d 2920 666f 7220 7061 7468  h)[-1]) for path
-00002af0: 2069 6e20 7061 7468 5f6c 6973 745d 0a20   in path_list]. 
-00002b00: 2020 206e 5f72 6f77 735f 6c69 7374 203d     n_rows_list =
-00002b10: 205b 7368 6170 655b 305d 2066 6f72 2073   [shape[0] for s
-00002b20: 6861 7065 2069 6e20 7368 6170 655f 6c69  hape in shape_li
-00002b30: 7374 5d0a 2020 2020 6e5f 726f 7773 5f73  st].    n_rows_s
-00002b40: 656c 5f6c 6973 7420 3d20 5b6c 656e 2869  el_list = [len(i
-00002b50: 6478 2920 666f 7220 6964 7820 696e 2069  dx) for idx in i
-00002b60: 6478 5f6c 6973 745d 0a20 2020 2061 7373  dx_list].    ass
-00002b70: 6572 7420 6c65 6e28 7061 7468 5f6c 6973  ert len(path_lis
-00002b80: 7429 203d 3d20 6c65 6e28 6964 785f 6c69  t) == len(idx_li
-00002b90: 7374 2920 616e 6420 6c65 6e28 7061 7468  st) and len(path
-00002ba0: 5f6c 6973 7429 203d 3d20 6c65 6e28 636f  _list) == len(co
-00002bb0: 6c73 5f6c 6973 7429 2c5c 0a20 2020 2020  ls_list),\.     
-00002bc0: 2020 2066 2770 6174 685f 6c69 7374 203d     f'path_list =
-00002bd0: 207b 6c65 6e28 7061 7468 5f6c 6973 7429   {len(path_list)
-00002be0: 7d2c 2069 6478 5f6c 6973 7420 3d20 7b6c  }, idx_list = {l
-00002bf0: 656e 2869 6478 5f6c 6973 7429 7d2c 2063  en(idx_list)}, c
-00002c00: 6f6c 735f 6c69 7374 203d 207b 6c65 6e28  ols_list = {len(
-00002c10: 636f 6c73 5f6c 6973 7429 7d27 0a20 2020  cols_list)}'.   
-00002c20: 2061 7373 6572 7420 6c65 6e28 7365 7428   assert len(set(
-00002c30: 6e5f 726f 7773 5f73 656c 5f6c 6973 7429  n_rows_sel_list)
-00002c40: 2920 3d3d 2031 2c5c 0a20 2020 2020 2020  ) == 1,\.       
-00002c50: 2066 276e 5f72 6f77 735f 7365 6c5f 6c69   f'n_rows_sel_li
-00002c60: 7374 203d 207b 6e5f 726f 7773 5f73 656c  st = {n_rows_sel
-00002c70: 5f6c 6973 747d 270a 2020 2020 6e5f 636f  _list}'.    n_co
-00002c80: 6c73 5f73 656c 5f6c 6973 7420 3d20 5b73  ls_sel_list = [s
-00002c90: 6861 7065 5f6c 6973 745b 695d 5b2d 315d  hape_list[i][-1]
-00002ca0: 2069 6620 636f 6c73 2069 7320 4e6f 6e65   if cols is None
-00002cb0: 2065 6c73 6520 6c65 6e28 636f 6c73 290a   else len(cols).
-00002cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002cd0: 2020 2020 2020 2066 6f72 2028 692c 2063         for (i, c
-00002ce0: 6f6c 7329 2069 6e20 656e 756d 6572 6174  ols) in enumerat
-00002cf0: 6528 636f 6c73 5f6c 6973 7429 5d0a 2020  e(cols_list)].  
-00002d00: 2020 0a20 2020 2069 6620 6e70 2e6d 6178    .    if np.max
-00002d10: 2869 6478 5f6c 6973 745b 305d 2920 3c3d  (idx_list[0]) <=
-00002d20: 2031 3a0a 2020 2020 2020 2020 7072 696e   1:.        prin
-00002d30: 7428 275c 6e2a 2a2a 2a2a 2a2a 2a2a 2a20  t('\n********** 
-00002d40: 4944 5820 3c3d 2031 2c20 594f 5520 4d41  IDX <= 1, YOU MA
-00002d50: 5920 5553 4520 6d61 736b 2061 7320 6d61  Y USE mask as ma
-00002d60: 736b 5f69 6478 2c20 504c 4541 5345 2043  sk_idx, PLEASE C
-00002d70: 4845 434b 2120 2a2a 2a2a 2a2a 2a2a 2a2a  HECK! **********
-00002d80: 5c6e 2729 0a20 2020 200a 2020 2020 2320  \n').    .    # 
-00002d90: 6669 6e61 6c20 6461 7461 0a20 2020 2064  final data.    d
-00002da0: 6174 6120 3d20 6e70 2e7a 6572 6f73 2828  ata = np.zeros((
-00002db0: 6e5f 726f 7773 5f73 656c 5f6c 6973 745b  n_rows_sel_list[
-00002dc0: 305d 2c20 6e70 2e73 756d 286e 5f63 6f6c  0], np.sum(n_col
-00002dd0: 735f 7365 6c5f 6c69 7374 2929 2c20 6474  s_sel_list)), dt
-00002de0: 7970 6520 3d20 6e70 2e66 6c6f 6174 3332  ype = np.float32
-00002df0: 290a 2020 2020 6966 2062 6c6f 636b 5f73  ).    if block_s
-00002e00: 697a 6520 6973 204e 6f6e 6520 6f72 2062  ize is None or b
-00002e10: 6c6f 636b 5f73 697a 6520 3d3d 202d 313a  lock_size == -1:
-00002e20: 200a 2020 2020 2020 2020 626c 6f63 6b5f   .        block_
-00002e30: 7369 7a65 203d 2032 3030 202a 2031 3032  size = 200 * 102
-00002e40: 3420 2a20 3130 3234 2023 2032 3030 4d0a  4 * 1024 # 200M.
-00002e50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00002e60: 2020 626c 6f63 6b5f 7369 7a65 202a 3d20    block_size *= 
-00002e70: 3130 3234 202a 2031 3032 340a 2020 2020  1024 * 1024.    
-00002e80: 6966 2076 6572 626f 7365 3a20 7072 696e  if verbose: prin
-00002e90: 7428 6627 5b2b 5d20 6461 7461 2e73 6861  t(f'[+] data.sha
-00002ea0: 7065 2020 3d20 7b64 6174 612e 7368 6170  pe  = {data.shap
-00002eb0: 657d 2c20 6d65 6d20 3d20 7b6e 702e 7072  e}, mem = {np.pr
-00002ec0: 6f64 2864 6174 612e 7368 6170 6529 202a  od(data.shape) *
-00002ed0: 2034 3a2c 2e30 667d 2729 0a20 2020 200a   4:,.0f}').    .
-00002ee0: 2020 2020 2320 666f 7220 6561 6368 2070      # for each p
-00002ef0: 6174 680a 2020 2020 666f 7220 7069 2069  ath.    for pi i
-00002f00: 6e20 7261 6e67 6528 6c65 6e28 7061 7468  n range(len(path
-00002f10: 5f6c 6973 7429 293a 0a20 2020 2020 2020  _list)):.       
-00002f20: 2070 6174 6820 3d20 7061 7468 5f6c 6973   path = path_lis
-00002f30: 745b 7069 5d0a 2020 2020 2020 2020 6474  t[pi].        dt
-00002f40: 7970 6520 3d20 6474 7970 655f 6c69 7374  ype = dtype_list
-00002f50: 5b70 695d 0a20 2020 2020 2020 2069 6478  [pi].        idx
-00002f60: 203d 2069 6478 5f6c 6973 745b 7069 5d0a   = idx_list[pi].
-00002f70: 2020 2020 2020 2020 636f 6c73 203d 2063          cols = c
-00002f80: 6f6c 735f 6c69 7374 5b70 695d 0a20 2020  ols_list[pi].   
-00002f90: 2020 2020 2073 6861 7065 203d 2073 6861       shape = sha
-00002fa0: 7065 5f6c 6973 745b 7069 5d0a 2020 2020  pe_list[pi].    
-00002fb0: 2020 2020 6e5f 726f 7773 203d 206e 5f72      n_rows = n_r
-00002fc0: 6f77 735f 6c69 7374 5b70 695d 0a20 2020  ows_list[pi].   
-00002fd0: 2020 2020 206e 5f72 6f77 735f 7365 6c20       n_rows_sel 
-00002fe0: 3d20 6e5f 726f 7773 5f73 656c 5f6c 6973  = n_rows_sel_lis
-00002ff0: 745b 7069 5d0a 2020 2020 2020 2020 6e5f  t[pi].        n_
-00003000: 636f 6c73 5f73 656c 203d 206e 5f63 6f6c  cols_sel = n_col
-00003010: 735f 7365 6c5f 6c69 7374 5b70 695d 0a20  s_sel_list[pi]. 
-00003020: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00003030: 2320 6261 7463 685f 7369 7a65 0a20 2020  # batch_size.   
-00003040: 2020 2020 2069 6620 6261 7463 685f 7369       if batch_si
-00003050: 7a65 2069 7320 4e6f 6e65 206f 7220 6261  ze is None or ba
-00003060: 7463 685f 7369 7a65 203d 3d20 2d31 3a0a  tch_size == -1:.
-00003070: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00003080: 5f6f 6e65 5f72 6f77 203d 2028 6e70 2e70  _one_row = (np.p
-00003090: 726f 6428 7368 6170 655b 313a 5d29 202a  rod(shape[1:]) *
-000030a0: 2028 3820 6966 2027 3634 2720 696e 2064   (8 if '64' in d
-000030b0: 7479 7065 2065 6c73 6520 3429 290a 2020  type else 4)).  
-000030c0: 2020 2020 2020 2020 2020 6261 7463 685f            batch_
-000030d0: 7369 7a65 203d 2069 6e74 2862 6c6f 636b  size = int(block
-000030e0: 5f73 697a 6520 2f20 7369 7a65 5f6f 6e65  _size / size_one
-000030f0: 5f72 6f77 290a 0a20 2020 2020 2020 2069  _row)..        i
-00003100: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00003110: 2020 2020 2020 2070 7269 6e74 2866 275b         print(f'[
-00003120: 2b5d 2064 6174 615f 616c 6c5f 7b70 693a  +] data_all_{pi:
-00003130: 3032 647d 203d 207b 7368 6170 657d 2c20  02d} = {shape}, 
-00003140: 6d65 6d20 3d20 7b6e 702e 7072 6f64 2873  mem = {np.prod(s
-00003150: 6861 7065 2920 2a20 343a 2c2e 3066 7d27  hape) * 4:,.0f}'
-00003160: 2920 2020 200a 2020 2020 2020 2020 2020  )    .          
-00003170: 2020 7072 696e 7428 6627 2020 2020 6461    print(f'    da
-00003180: 7461 5f73 656c 5f7b 7069 3a30 3264 7d20  ta_sel_{pi:02d} 
-00003190: 3d20 7b28 6e5f 726f 7773 5f73 656c 2c20  = {(n_rows_sel, 
-000031a0: 6e5f 636f 6c73 5f73 656c 297d 2c20 6d65  n_cols_sel)}, me
-000031b0: 6d20 3d20 7b6e 5f72 6f77 735f 7365 6c20  m = {n_rows_sel 
-000031c0: 2a20 6e5f 636f 6c73 5f73 656c 202a 2034  * n_cols_sel * 4
-000031d0: 3a2c 2e30 667d 2729 2020 2020 0a20 2020  :,.0f}')    .   
-000031e0: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
-000031f0: 2720 2020 2062 6c6f 636b 5f73 697a 6520  '    block_size 
-00003200: 203d 207b 626c 6f63 6b5f 7369 7a65 3a2c   = {block_size:,
-00003210: 2e30 667d 203d 207b 6261 7463 685f 7369  .0f} = {batch_si
-00003220: 7a65 3a2c 2e30 667d 202a 207b 7369 7a65  ze:,.0f} * {size
-00003230: 5f6f 6e65 5f72 6f77 3a2e 3066 7d27 290a  _one_row:.0f}').
-00003240: 0a20 2020 2020 2020 2023 206c 6f61 640a  .        # load.
-00003250: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00003260: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00003270: 7267 203d 2074 7164 6d28 7261 6e67 6528  rg = tqdm(range(
-00003280: 302c 206e 5f72 6f77 732c 2062 6174 6368  0, n_rows, batch
-00003290: 5f73 697a 6529 2c20 6465 7363 3d66 276c  _size), desc=f'l
-000032a0: 6f61 645f 6e70 795f 6964 785f 6d75 6c74  oad_npy_idx_mult
-000032b0: 6928 2927 2c20 6e63 6f6c 733d 3130 302c  i()', ncols=100,
-000032c0: 2061 7363 6969 3d54 7275 6529 0a20 2020   ascii=True).   
-000032d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000032e0: 2020 2020 2020 2072 6720 3d20 7261 6e67         rg = rang
-000032f0: 6528 302c 206e 5f72 6f77 732c 2062 6174  e(0, n_rows, bat
-00003300: 6368 5f73 697a 6529 0a20 2020 2020 2020  ch_size).       
-00003310: 2066 6f72 2069 2069 6e20 7267 3a0a 2020   for i in rg:.  
-00003320: 2020 2020 2020 2020 2020 7031 2c20 7032            p1, p2
-00003330: 203d 2069 2c20 6d69 6e28 6e5f 726f 7773   = i, min(n_rows
-00003340: 2c20 6920 2b20 6261 7463 685f 7369 7a65  , i + batch_size
-00003350: 290a 2020 2020 2020 2020 2020 2020 5f70  ).            _p
-00003360: 3120 3d20 7031 202a 2069 6e74 286e 702e  1 = p1 * int(np.
-00003370: 7072 6f64 2873 6861 7065 5b31 3a2d 315d  prod(shape[1:-1]
-00003380: 2929 0a20 2020 2020 2020 2020 2020 205f  )).            _
-00003390: 7032 203d 2070 3220 2a20 696e 7428 6e70  p2 = p2 * int(np
-000033a0: 2e70 726f 6428 7368 6170 655b 313a 2d31  .prod(shape[1:-1
-000033b0: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-000033c0: 6964 785f 7365 6c20 3d20 6e70 2e77 6865  idx_sel = np.whe
-000033d0: 7265 2828 5f70 3120 3c3d 2069 6478 2920  re((_p1 <= idx) 
-000033e0: 2620 2869 6478 203c 205f 7032 2929 5b30  & (idx < _p2))[0
-000033f0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-00003400: 206c 656e 2869 6478 5f73 656c 2920 3d3d   len(idx_sel) ==
-00003410: 2030 3a20 636f 6e74 696e 7565 0a0a 2020   0: continue..  
-00003420: 2020 2020 2020 2020 2020 6120 3d20 6c6f            a = lo
-00003430: 6164 5f6e 7079 2870 6174 682c 2073 7461  ad_npy(path, sta
-00003440: 7274 203d 2070 312c 2065 6e64 203d 2070  rt = p1, end = p
-00003450: 322c 2063 6f6c 7320 3d20 636f 6c73 2c20  2, cols = cols, 
-00003460: 7573 655f 6e75 6d62 6120 3d20 7573 655f  use_numba = use_
-00003470: 6e75 6d62 6129 2e72 6573 6861 7065 282d  numba).reshape(-
-00003480: 312c 206e 5f63 6f6c 735f 7365 6c29 0a20  1, n_cols_sel). 
-00003490: 2020 2020 2020 2020 2020 2069 6478 5f61             idx_a
-000034a0: 203d 2069 6478 5b69 6478 5f73 656c 5d20   = idx[idx_sel] 
-000034b0: 2d20 5f70 310a 2020 2020 2020 2020 2020  - _p1.          
-000034c0: 2020 0a20 2020 2020 2020 2020 2020 2063    .            c
-000034d0: 312c 2063 3220 3d20 696e 7428 6e70 2e73  1, c2 = int(np.s
-000034e0: 756d 286e 5f63 6f6c 735f 7365 6c5f 6c69  um(n_cols_sel_li
-000034f0: 7374 5b3a 7069 5d29 292c 2069 6e74 286e  st[:pi])), int(n
-00003500: 702e 7375 6d28 6e5f 636f 6c73 5f73 656c  p.sum(n_cols_sel
-00003510: 5f6c 6973 745b 3a70 6920 2b20 315d 2929  _list[:pi + 1]))
-00003520: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00003530: 615b 6964 785f 7365 6c2c 2063 313a 2063  a[idx_sel, c1: c
-00003540: 325d 203d 2061 5b69 6478 5f61 5d0a 2020  2] = a[idx_a].  
-00003550: 2020 2020 2020 6763 2e63 6f6c 6c65 6374        gc.collect
-00003560: 2829 0a20 2020 2072 6574 7572 6e20 6461  ().    return da
-00003570: 7461 0a0a 2320 727a 5f6c 6f61 645f 6e70  ta..# rz_load_np
-00003580: 795f 6964 785f 6d75 6c74 690a 6465 6620  y_idx_multi.def 
-00003590: 727a 5f6c 6f61 645f 6e70 795f 6964 785f  rz_load_npy_idx_
-000035a0: 6d75 6c74 6928 7061 7468 5f6c 6973 742c  multi(path_list,
-000035b0: 2069 6478 5f6c 6973 742c 2063 6f6c 735f   idx_list, cols_
-000035c0: 6c69 7374 203d 204e 6f6e 652c 200a 2020  list = None, .  
-000035d0: 2020 6261 7463 685f 7369 7a65 203d 202d    batch_size = -
-000035e0: 312c 2062 6c6f 636b 5f73 697a 6520 3d20  1, block_size = 
-000035f0: 3430 3030 2c20 7665 7262 6f73 6520 3d20  4000, verbose = 
-00003600: 302c 2075 7365 5f6e 756d 6261 203d 2046  0, use_numba = F
-00003610: 616c 7365 2c20 0a20 2020 206e 5f6a 6f62  alse, .    n_job
-00003620: 7320 3d20 3136 2c20 6b74 696d 6573 203d  s = 16, ktimes =
-00003630: 2031 3029 3a0a 2020 2020 5c27 5c27 5c27   10):.    \'\'\'
-00003640: 0a20 2020 2061 203d 2072 7a5f 6c6f 6164  .    a = rz_load
-00003650: 5f6e 7079 5f69 6478 5f6d 756c 7469 285b  _npy_idx_multi([
-00003660: 7061 7468 2c20 7061 7468 5d2c 204e 6f6e  path, path], Non
-00003670: 652c 2063 6f6c 735f 6c69 7374 203d 205b  e, cols_list = [
-00003680: 6e70 2e61 7261 6e67 6528 302c 2031 3030  np.arange(0, 100
-00003690: 3029 2c20 6e70 2e61 7261 6e67 6528 3130  0), np.arange(10
-000036a0: 3030 2c20 3230 3030 295d 2c20 7665 7262  00, 2000)], verb
-000036b0: 6f73 653d 5472 7565 2c20 6e5f 6a6f 6273  ose=True, n_jobs
-000036c0: 203d 3136 2c20 6b74 696d 6573 203d 2031   =16, ktimes = 1
-000036d0: 302c 2062 6c6f 636b 5f73 697a 6520 3d20  0, block_size = 
-000036e0: 3430 3030 2920 2320 3230 730a 2020 2020  4000) # 20s.    
-000036f0: 5c27 5c27 5c27 0a0a 2020 2020 2320 696e  \'\'\'..    # in
-00003700: 7075 740a 2020 2020 6966 2069 6478 5f6c  put.    if idx_l
-00003710: 6973 7420 6973 204e 6f6e 653a 0a20 2020  ist is None:.   
-00003720: 2020 2020 2069 6478 5f6c 6973 7420 3d20       idx_list = 
-00003730: 5b4e 6f6e 6520 666f 7220 5f20 696e 2072  [None for _ in r
-00003740: 616e 6765 286c 656e 2870 6174 685f 6c69  ange(len(path_li
-00003750: 7374 2929 5d0a 2020 2020 6966 2074 7970  st))].    if typ
-00003760: 6528 6964 785f 6c69 7374 2920 6973 206e  e(idx_list) is n
-00003770: 6f74 206c 6973 743a 0a20 2020 2020 2020  ot list:.       
-00003780: 2069 6478 5f6c 6973 7420 3d20 5b69 6478   idx_list = [idx
-00003790: 5f6c 6973 7420 666f 7220 5f20 696e 2072  _list for _ in r
-000037a0: 616e 6765 286c 656e 2870 6174 685f 6c69  ange(len(path_li
-000037b0: 7374 2929 5d0a 2020 2020 6966 2063 6f6c  st))].    if col
-000037c0: 735f 6c69 7374 2069 7320 4e6f 6e65 3a0a  s_list is None:.
-000037d0: 2020 2020 2020 2020 636f 6c73 5f6c 6973          cols_lis
-000037e0: 7420 3d20 5b4e 6f6e 6520 666f 7220 5f20  t = [None for _ 
-000037f0: 696e 2072 616e 6765 286c 656e 2870 6174  in range(len(pat
-00003800: 685f 6c69 7374 2929 5d0a 0a20 2020 2068  h_list))]..    h
-00003810: 6561 6465 725f 6c69 7374 203d 205b 7265  eader_list = [re
-00003820: 6164 5f6e 7079 5f68 6561 6465 7228 7061  ad_npy_header(pa
-00003830: 7468 2920 666f 7220 7061 7468 2069 6e20  th) for path in 
-00003840: 7061 7468 5f6c 6973 745d 0a20 2020 2073  path_list].    s
-00003850: 6861 7065 5f6c 6973 7420 3d20 5b72 6561  hape_list = [rea
-00003860: 645f 6e70 795f 6865 6164 6572 2870 6174  d_npy_header(pat
-00003870: 6829 5b30 5d20 666f 7220 7061 7468 2069  h)[0] for path i
-00003880: 6e20 7061 7468 5f6c 6973 745d 0a20 2020  n path_list].   
-00003890: 2064 7479 7065 5f6c 6973 7420 3d20 5b73   dtype_list = [s
-000038a0: 7472 2872 6561 645f 6e70 795f 6865 6164  tr(read_npy_head
-000038b0: 6572 2870 6174 6829 5b2d 315d 2920 666f  er(path)[-1]) fo
-000038c0: 7220 7061 7468 2069 6e20 7061 7468 5f6c  r path in path_l
-000038d0: 6973 745d 0a20 2020 206e 5f72 6f77 735f  ist].    n_rows_
-000038e0: 6c69 7374 203d 205b 7368 6170 655b 305d  list = [shape[0]
-000038f0: 2066 6f72 2073 6861 7065 2069 6e20 7368   for shape in sh
-00003900: 6170 655f 6c69 7374 5d0a 2020 2020 6966  ape_list].    if
-00003910: 206e 702e 616c 6c28 5b69 6478 2069 7320   np.all([idx is 
-00003920: 4e6f 6e65 2066 6f72 2069 6478 2069 6e20  None for idx in 
-00003930: 6964 785f 6c69 7374 5d29 3a0a 2020 2020  idx_list]):.    
-00003940: 2020 2020 6e5f 726f 7773 5f73 656c 5f6c      n_rows_sel_l
-00003950: 6973 7420 3d20 5b68 6561 6465 725b 305d  ist = [header[0]
-00003960: 5b30 5d20 666f 7220 6865 6164 6572 2069  [0] for header i
-00003970: 6e20 6865 6164 6572 5f6c 6973 745d 0a20  n header_list]. 
-00003980: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00003990: 206e 5f72 6f77 735f 7365 6c5f 6c69 7374   n_rows_sel_list
-000039a0: 203d 205b 6c65 6e28 6964 7829 2066 6f72   = [len(idx) for
-000039b0: 2069 6478 2069 6e20 6964 785f 6c69 7374   idx in idx_list
-000039c0: 5d0a 2020 2020 6173 7365 7274 206c 656e  ].    assert len
-000039d0: 2870 6174 685f 6c69 7374 2920 3d3d 206c  (path_list) == l
-000039e0: 656e 2869 6478 5f6c 6973 7429 2061 6e64  en(idx_list) and
-000039f0: 206c 656e 2870 6174 685f 6c69 7374 2920   len(path_list) 
-00003a00: 3d3d 206c 656e 2863 6f6c 735f 6c69 7374  == len(cols_list
-00003a10: 292c 5c0a 2020 2020 2020 2020 6627 7061  ),\.        f'pa
-00003a20: 7468 5f6c 6973 7420 3d20 7b6c 656e 2870  th_list = {len(p
-00003a30: 6174 685f 6c69 7374 297d 2c20 6964 785f  ath_list)}, idx_
-00003a40: 6c69 7374 203d 207b 6c65 6e28 6964 785f  list = {len(idx_
-00003a50: 6c69 7374 297d 2c20 636f 6c73 5f6c 6973  list)}, cols_lis
-00003a60: 7420 3d20 7b6c 656e 2863 6f6c 735f 6c69  t = {len(cols_li
-00003a70: 7374 297d 270a 2020 2020 6173 7365 7274  st)}'.    assert
-00003a80: 206c 656e 2873 6574 286e 5f72 6f77 735f   len(set(n_rows_
-00003a90: 7365 6c5f 6c69 7374 2929 203d 3d20 312c  sel_list)) == 1,
-00003aa0: 2066 276e 5f72 6f77 735f 7365 6c5f 6c69   f'n_rows_sel_li
-00003ab0: 7374 203d 207b 6e5f 726f 7773 5f73 656c  st = {n_rows_sel
-00003ac0: 5f6c 6973 747d 270a 2020 2020 6e5f 636f  _list}'.    n_co
-00003ad0: 6c73 5f73 656c 5f6c 6973 7420 3d20 5b73  ls_sel_list = [s
-00003ae0: 6861 7065 5f6c 6973 745b 695d 5b2d 315d  hape_list[i][-1]
-00003af0: 2069 6620 636f 6c73 2069 7320 4e6f 6e65   if cols is None
-00003b00: 2065 6c73 6520 6c65 6e28 636f 6c73 290a   else len(cols).
-00003b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b20: 2020 2020 666f 7220 2869 2c20 636f 6c73      for (i, cols
-00003b30: 2920 696e 2065 6e75 6d65 7261 7465 2863  ) in enumerate(c
-00003b40: 6f6c 735f 6c69 7374 295d 0a0a 2020 2020  ols_list)]..    
-00003b50: 2320 6669 6e61 6c20 6461 7461 0a20 2020  # final data.   
-00003b60: 2064 6174 6120 3d20 6e70 2e65 6d70 7479   data = np.empty
-00003b70: 2828 6e5f 726f 7773 5f73 656c 5f6c 6973  ((n_rows_sel_lis
-00003b80: 745b 305d 2c20 6e70 2e73 756d 286e 5f63  t[0], np.sum(n_c
-00003b90: 6f6c 735f 7365 6c5f 6c69 7374 2929 2c20  ols_sel_list)), 
-00003ba0: 6474 7970 6520 3d20 6e70 2e66 6c6f 6174  dtype = np.float
-00003bb0: 3332 290a 2020 2020 6966 2062 6c6f 636b  32).    if block
-00003bc0: 5f73 697a 6520 6973 204e 6f6e 6520 6f72  _size is None or
-00003bd0: 2062 6c6f 636b 5f73 697a 6520 3d3d 202d   block_size == -
-00003be0: 313a 0a20 2020 2020 2020 2062 6c6f 636b  1:.        block
-00003bf0: 5f73 697a 6520 3d20 3230 3020 2a20 3130  _size = 200 * 10
-00003c00: 3234 202a 2031 3032 3420 2320 3230 304d  24 * 1024 # 200M
-00003c10: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00003c20: 2020 2062 6c6f 636b 5f73 697a 6520 2a3d     block_size *=
-00003c30: 2031 3032 3420 2a20 3130 3234 0a20 2020   1024 * 1024.   
-00003c40: 2069 6620 7665 7262 6f73 6520 3e3d 2032   if verbose >= 2
-00003c50: 3a20 7072 696e 7428 6627 5b2b 5d20 6461  : print(f'[+] da
-00003c60: 7461 2e73 6861 7065 2020 3d20 7b64 6174  ta.shape  = {dat
-00003c70: 612e 7368 6170 657d 2c20 6d65 6d20 3d20  a.shape}, mem = 
-00003c80: 7b6e 702e 7072 6f64 2864 6174 612e 7368  {np.prod(data.sh
-00003c90: 6170 6529 202a 2034 3a2c 2e30 667d 2729  ape) * 4:,.0f}')
-00003ca0: 0a0a 2020 2020 2320 666f 7220 6561 6368  ..    # for each
-00003cb0: 2070 6174 680a 2020 2020 666f 7220 7069   path.    for pi
-00003cc0: 2069 6e20 7261 6e67 6528 6c65 6e28 7061   in range(len(pa
-00003cd0: 7468 5f6c 6973 7429 293a 0a20 2020 2020  th_list)):.     
-00003ce0: 2020 2070 6174 6820 3d20 7061 7468 5f6c     path = path_l
-00003cf0: 6973 745b 7069 5d0a 2020 2020 2020 2020  ist[pi].        
-00003d00: 6474 7970 6520 3d20 6474 7970 655f 6c69  dtype = dtype_li
-00003d10: 7374 5b70 695d 0a20 2020 2020 2020 2069  st[pi].        i
-00003d20: 6478 203d 2069 6478 5f6c 6973 745b 7069  dx = idx_list[pi
-00003d30: 5d0a 2020 2020 2020 2020 636f 6c73 203d  ].        cols =
-00003d40: 2063 6f6c 735f 6c69 7374 5b70 695d 0a20   cols_list[pi]. 
-00003d50: 2020 2020 2020 2073 6861 7065 203d 2073         shape = s
-00003d60: 6861 7065 5f6c 6973 745b 7069 5d0a 2020  hape_list[pi].  
-00003d70: 2020 2020 2020 6e5f 726f 7773 203d 206e        n_rows = n
-00003d80: 5f72 6f77 735f 6c69 7374 5b70 695d 0a20  _rows_list[pi]. 
-00003d90: 2020 2020 2020 206e 5f72 6f77 735f 7365         n_rows_se
-00003da0: 6c20 3d20 6e5f 726f 7773 5f73 656c 5f6c  l = n_rows_sel_l
-00003db0: 6973 745b 7069 5d0a 2020 2020 2020 2020  ist[pi].        
-00003dc0: 6e5f 636f 6c73 5f73 656c 203d 206e 5f63  n_cols_sel = n_c
-00003dd0: 6f6c 735f 7365 6c5f 6c69 7374 5b70 695d  ols_sel_list[pi]
-00003de0: 0a0a 2020 2020 2020 2020 2320 6261 7463  ..        # batc
-00003df0: 685f 7369 7a65 0a20 2020 2020 2020 2069  h_size.        i
-00003e00: 6620 6261 7463 685f 7369 7a65 2069 7320  f batch_size is 
-00003e10: 4e6f 6e65 206f 7220 6261 7463 685f 7369  None or batch_si
-00003e20: 7a65 203d 3d20 2d31 3a0a 2020 2020 2020  ze == -1:.      
-00003e30: 2020 2020 2020 7369 7a65 5f6f 6e65 5f72        size_one_r
-00003e40: 6f77 203d 2028 6e70 2e70 726f 6428 7368  ow = (np.prod(sh
-00003e50: 6170 655b 313a 5d29 202a 2028 3820 6966  ape[1:]) * (8 if
-00003e60: 2027 3634 2720 696e 2064 7479 7065 2065   '64' in dtype e
-00003e70: 6c73 6520 3429 290a 2020 2020 2020 2020  lse 4)).        
-00003e80: 2020 2020 6261 7463 685f 7369 7a65 203d      batch_size =
-00003e90: 2069 6e74 2862 6c6f 636b 5f73 697a 6520   int(block_size 
-00003ea0: 2f20 7369 7a65 5f6f 6e65 5f72 6f77 290a  / size_one_row).
-00003eb0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-00003ec0: 6f73 6520 3e3d 2032 3a0a 2020 2020 2020  ose >= 2:.      
-00003ed0: 2020 2020 2020 7072 696e 7428 6627 5b2b        print(f'[+
-00003ee0: 5d20 6461 7461 5f61 6c6c 5f7b 7069 3a30  ] data_all_{pi:0
-00003ef0: 3264 7d20 3d20 7b73 6861 7065 7d2c 206d  2d} = {shape}, m
-00003f00: 656d 203d 207b 6e70 2e70 726f 6428 7368  em = {np.prod(sh
-00003f10: 6170 6529 202a 2034 3a2c 2e30 667d 2729  ape) * 4:,.0f}')
-00003f20: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00003f30: 6e74 2866 2720 2020 2064 6174 615f 7365  nt(f'    data_se
-00003f40: 6c5f 7b70 693a 3032 647d 203d 207b 286e  l_{pi:02d} = {(n
-00003f50: 5f72 6f77 735f 7365 6c2c 206e 5f63 6f6c  _rows_sel, n_col
-00003f60: 735f 7365 6c29 7d2c 206d 656d 203d 207b  s_sel)}, mem = {
-00003f70: 6e5f 726f 7773 5f73 656c 202a 206e 5f63  n_rows_sel * n_c
-00003f80: 6f6c 735f 7365 6c20 2a20 343a 2c2e 3066  ols_sel * 4:,.0f
-00003f90: 7d27 290a 2020 2020 2020 2020 2020 2020  }').            
-00003fa0: 7072 696e 7428 6627 2020 2020 626c 6f63  print(f'    bloc
-00003fb0: 6b5f 7369 7a65 2020 3d20 7b62 6c6f 636b  k_size  = {block
-00003fc0: 5f73 697a 653a 2c2e 3066 7d20 3d20 7b62  _size:,.0f} = {b
-00003fd0: 6174 6368 5f73 697a 653a 2c2e 3066 7d20  atch_size:,.0f} 
-00003fe0: 2a20 7b73 697a 655f 6f6e 655f 726f 773a  * {size_one_row:
-00003ff0: 2e30 667d 2729 0a0a 2020 2020 2020 2020  .0f}')..        
-00004000: 2320 6c6f 6164 0a20 2020 2020 2020 2069  # load.        i
-00004010: 6620 7665 7262 6f73 6520 3e3d 2031 3a20  f verbose >= 1: 
-00004020: 7267 203d 2074 7164 6d28 7261 6e67 6528  rg = tqdm(range(
-00004030: 302c 206e 5f72 6f77 732c 2062 6174 6368  0, n_rows, batch
-00004040: 5f73 697a 6529 2c20 6465 7363 3d66 2772  _size), desc=f'r
-00004050: 7a5f 6c6f 6164 5f6e 7079 5f69 6478 5f6d  z_load_npy_idx_m
-00004060: 756c 7469 2829 272c 206e 636f 6c73 3d31  ulti()', ncols=1
-00004070: 3030 2c20 6173 6369 693d 5472 7565 290a  00, ascii=True).
-00004080: 2020 2020 2020 2020 656c 7365 3a20 7267          else: rg
-00004090: 203d 2072 616e 6765 2830 2c20 6e5f 726f   = range(0, n_ro
-000040a0: 7773 2c20 6261 7463 685f 7369 7a65 290a  ws, batch_size).
-000040b0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-000040c0: 6e20 7267 3a0a 2020 2020 2020 2020 2020  n rg:.          
-000040d0: 2020 7031 2c20 7032 203d 2069 2c20 6d69    p1, p2 = i, mi
-000040e0: 6e28 6e5f 726f 7773 2c20 6920 2b20 6261  n(n_rows, i + ba
-000040f0: 7463 685f 7369 7a65 290a 2020 2020 2020  tch_size).      
-00004100: 2020 2020 2020 5f70 3120 3d20 7031 202a        _p1 = p1 *
-00004110: 2069 6e74 286e 702e 7072 6f64 2873 6861   int(np.prod(sha
-00004120: 7065 5b31 3a2d 315d 2929 0a20 2020 2020  pe[1:-1])).     
-00004130: 2020 2020 2020 205f 7032 203d 2070 3220         _p2 = p2 
-00004140: 2a20 696e 7428 6e70 2e70 726f 6428 7368  * int(np.prod(sh
-00004150: 6170 655b 313a 2d31 5d29 290a 0a20 2020  ape[1:-1]))..   
-00004160: 2020 2020 2020 2020 2069 6620 6964 7820           if idx 
-00004170: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00004180: 2020 2020 2020 2020 2020 2020 2069 6478               idx
-00004190: 5f73 656c 203d 206e 702e 7768 6572 6528  _sel = np.where(
-000041a0: 285f 7031 203c 3d20 6964 7829 2026 2028  (_p1 <= idx) & (
-000041b0: 6964 7820 3c20 5f70 3229 295b 305d 0a20  idx < _p2))[0]. 
-000041c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000041d0: 6620 6c65 6e28 6964 785f 7365 6c29 203d  f len(idx_sel) =
-000041e0: 3d20 303a 2063 6f6e 7469 6e75 650a 0a20  = 0: continue.. 
-000041f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00004200: 203d 2072 7a5f 6c6f 6164 5f6e 7079 2870   = rz_load_npy(p
-00004210: 6174 682c 2073 7461 7274 203d 2070 312c  ath, start = p1,
-00004220: 2065 6e64 203d 2070 322c 2063 6f6c 7320   end = p2, cols 
-00004230: 3d20 636f 6c73 2c20 7573 655f 6e75 6d62  = cols, use_numb
-00004240: 6120 3d20 7573 655f 6e75 6d62 612c 206e  a = use_numba, n
-00004250: 5f6a 6f62 7320 3d20 6e5f 6a6f 6273 2c20  _jobs = n_jobs, 
-00004260: 6b74 696d 6573 203d 206b 7469 6d65 7329  ktimes = ktimes)
-00004270: 2e72 6573 6861 7065 282d 312c 206e 5f63  .reshape(-1, n_c
-00004280: 6f6c 735f 7365 6c29 0a20 2020 2020 2020  ols_sel).       
-00004290: 2020 2020 2020 2020 2069 6478 5f61 203d           idx_a =
-000042a0: 2069 6478 5b69 6478 5f73 656c 5d20 2d20   idx[idx_sel] - 
-000042b0: 5f70 310a 0a20 2020 2020 2020 2020 2020  _p1..           
-000042c0: 2020 2020 2063 312c 2063 3220 3d20 696e       c1, c2 = in
-000042d0: 7428 6e70 2e73 756d 286e 5f63 6f6c 735f  t(np.sum(n_cols_
-000042e0: 7365 6c5f 6c69 7374 5b3a 7069 5d29 292c  sel_list[:pi])),
-000042f0: 2069 6e74 286e 702e 7375 6d28 6e5f 636f   int(np.sum(n_co
-00004300: 6c73 5f73 656c 5f6c 6973 745b 3a70 6920  ls_sel_list[:pi 
-00004310: 2b20 315d 2929 0a20 2020 2020 2020 2020  + 1])).         
-00004320: 2020 2020 2020 206e 705f 7365 745f 6964         np_set_id
-00004330: 785f 636f 6c73 2864 6174 612c 2069 6478  x_cols(data, idx
-00004340: 5f73 656c 2c20 6e70 2e61 7261 6e67 6528  _sel, np.arange(
-00004350: 6331 2c20 6332 292c 206e 705f 6765 7428  c1, c2), np_get(
-00004360: 612c 2069 6478 5f61 2c20 6178 6973 203d  a, idx_a, axis =
-00004370: 2030 2929 0a20 2020 2020 2020 2020 2020   0)).           
-00004380: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00004390: 2020 2020 2020 2061 203d 2072 7a5f 6c6f         a = rz_lo
-000043a0: 6164 5f6e 7079 2870 6174 682c 2073 7461  ad_npy(path, sta
-000043b0: 7274 203d 2070 312c 2065 6e64 203d 2070  rt = p1, end = p
-000043c0: 322c 2063 6f6c 7320 3d20 636f 6c73 2c20  2, cols = cols, 
-000043d0: 7573 655f 6e75 6d62 6120 3d20 7573 655f  use_numba = use_
-000043e0: 6e75 6d62 612c 206e 5f6a 6f62 7320 3d20  numba, n_jobs = 
-000043f0: 6e5f 6a6f 6273 2c20 6b74 696d 6573 203d  n_jobs, ktimes =
-00004400: 206b 7469 6d65 7329 2e72 6573 6861 7065   ktimes).reshape
-00004410: 282d 312c 206e 5f63 6f6c 735f 7365 6c29  (-1, n_cols_sel)
+00001e50: 2020 7369 7a65 5f6f 6e65 5f72 6f77 203d    size_one_row =
+00001e60: 202d 310a 2020 2020 6966 2062 6174 6368   -1.    if batch
+00001e70: 5f73 697a 6520 6973 204e 6f6e 6520 6f72  _size is None or
+00001e80: 2062 6174 6368 5f73 697a 6520 3d3d 202d   batch_size == -
+00001e90: 313a 0a20 2020 2020 2020 2073 697a 655f  1:.        size_
+00001ea0: 6f6e 655f 726f 7720 3d20 286e 702e 7072  one_row = (np.pr
+00001eb0: 6f64 2873 6861 7065 5b31 3a5d 2920 2a20  od(shape[1:]) * 
+00001ec0: 2838 2069 6620 2736 3427 2069 6e20 6474  (8 if '64' in dt
+00001ed0: 7970 6520 656c 7365 2034 2929 0a20 2020  ype else 4)).   
+00001ee0: 2020 2020 2062 6174 6368 5f73 697a 6520       batch_size 
+00001ef0: 3d20 696e 7428 626c 6f63 6b5f 7369 7a65  = int(block_size
+00001f00: 202f 2073 697a 655f 6f6e 655f 726f 7729   / size_one_row)
+00001f10: 0a0a 2020 2020 6966 2076 6572 626f 7365  ..    if verbose
+00001f20: 3a0a 2020 2020 2020 2020 7072 696e 7428  :.        print(
+00001f30: 6627 5b2b 5d20 6461 7461 5f61 6c6c 2020  f'[+] data_all  
+00001f40: 2020 3d20 7b73 6861 7065 7d2c 206d 656d    = {shape}, mem
+00001f50: 203d 207b 6e70 2e70 726f 6428 7368 6170   = {np.prod(shap
+00001f60: 6529 202a 2034 3a2c 2e30 667d 2729 2020  e) * 4:,.0f}')  
+00001f70: 2020 0a20 2020 2020 2020 2070 7269 6e74    .        print
+00001f80: 2866 2720 2020 2064 6174 615f 7365 6c20  (f'    data_sel 
+00001f90: 2020 203d 207b 6461 7461 2e73 6861 7065     = {data.shape
+00001fa0: 7d2c 206d 656d 203d 207b 6e70 2e70 726f  }, mem = {np.pro
+00001fb0: 6428 6461 7461 2e73 6861 7065 2920 2a20  d(data.shape) * 
+00001fc0: 343a 2c2e 3066 7d27 2920 2020 200a 2020  4:,.0f}')    .  
+00001fd0: 2020 2020 2020 7072 696e 7428 6627 2020        print(f'  
+00001fe0: 2020 626c 6f63 6b5f 7369 7a65 2020 3d20    block_size  = 
+00001ff0: 7b62 6c6f 636b 5f73 697a 653a 2c2e 3066  {block_size:,.0f
+00002000: 7d20 3d20 7b62 6174 6368 5f73 697a 653a  } = {batch_size:
+00002010: 2c2e 3066 7d20 2a20 7b73 697a 655f 6f6e  ,.0f} * {size_on
+00002020: 655f 726f 773a 2e30 667d 2729 0a0a 2020  e_row:.0f}')..  
+00002030: 2020 2320 6c6f 6164 0a20 2020 2069 6620    # load.    if 
+00002040: 7665 7262 6f73 653a 0a20 2020 2020 2020  verbose:.       
+00002050: 2072 6720 3d20 7471 646d 2872 616e 6765   rg = tqdm(range
+00002060: 2830 2c20 6e5f 726f 7773 2c20 6261 7463  (0, n_rows, batc
+00002070: 685f 7369 7a65 292c 2064 6573 633d 6627  h_size), desc=f'
+00002080: 6c6f 6164 5f6e 7079 5f69 6478 2829 272c  load_npy_idx()',
+00002090: 206e 636f 6c73 3d31 3030 2c20 6173 6369   ncols=100, asci
+000020a0: 693d 5472 7565 290a 2020 2020 656c 7365  i=True).    else
+000020b0: 3a0a 2020 2020 2020 2020 7267 203d 2072  :.        rg = r
+000020c0: 616e 6765 2830 2c20 6e5f 726f 7773 2c20  ange(0, n_rows, 
+000020d0: 6261 7463 685f 7369 7a65 290a 2020 2020  batch_size).    
+000020e0: 0a20 2020 2069 6478 5f6d 696e 2c20 6964  .    idx_min, id
+000020f0: 785f 6d61 7820 3d20 6e70 2e6d 696e 2869  x_max = np.min(i
+00002100: 6478 292c 206e 702e 6d61 7828 6964 7829  dx), np.max(idx)
+00002110: 0a20 2020 2066 6f72 2069 2069 6e20 7267  .    for i in rg
+00002120: 3a0a 2020 2020 2020 2020 7031 2c20 7032  :.        p1, p2
+00002130: 203d 2069 2c20 6d69 6e28 6e5f 726f 7773   = i, min(n_rows
+00002140: 2c20 6920 2b20 6261 7463 685f 7369 7a65  , i + batch_size
+00002150: 2920 2320 5b70 312c 2070 3229 0a20 2020  ) # [p1, p2).   
+00002160: 2020 2020 205f 7031 203d 2069 6e74 2870       _p1 = int(p
+00002170: 3120 2a20 6e70 2e70 726f 6428 7368 6170  1 * np.prod(shap
+00002180: 655b 313a 2d31 5d29 290a 2020 2020 2020  e[1:-1])).      
+00002190: 2020 5f70 3220 3d20 696e 7428 7032 202a    _p2 = int(p2 *
+000021a0: 206e 702e 7072 6f64 2873 6861 7065 5b31   np.prod(shape[1
+000021b0: 3a2d 315d 2929 0a20 2020 2020 2020 2069  :-1])).        i
+000021c0: 6620 5f70 3120 3e20 6964 785f 6d61 783a  f _p1 > idx_max:
+000021d0: 2062 7265 616b 0a20 2020 2020 2020 2069   break.        i
+000021e0: 6620 5f70 3220 3c3d 2069 6478 5f6d 696e  f _p2 <= idx_min
+000021f0: 3a20 636f 6e74 696e 7565 0a20 2020 2020  : continue.     
+00002200: 2020 2069 6478 5f73 656c 203d 206e 702e     idx_sel = np.
+00002210: 7768 6572 6528 285f 7031 203c 3d20 6964  where((_p1 <= id
+00002220: 7829 2026 2028 6964 7820 3c20 5f70 3229  x) & (idx < _p2)
+00002230: 295b 305d 0a20 2020 2020 2020 2069 6620  )[0].        if 
+00002240: 6c65 6e28 6964 785f 7365 6c29 203d 3d20  len(idx_sel) == 
+00002250: 303a 2063 6f6e 7469 6e75 650a 0a20 2020  0: continue..   
+00002260: 2020 2020 2061 203d 206c 6f61 645f 6e70       a = load_np
+00002270: 7928 7061 7468 2c20 7374 6172 7420 3d20  y(path, start = 
+00002280: 7031 2c20 656e 6420 3d20 7032 2c20 636f  p1, end = p2, co
+00002290: 6c73 203d 2063 6f6c 732c 2075 7365 5f6e  ls = cols, use_n
+000022a0: 756d 6261 203d 2075 7365 5f6e 756d 6261  umba = use_numba
+000022b0: 292e 7265 7368 6170 6528 2d31 2c20 6e5f  ).reshape(-1, n_
+000022c0: 636f 6c73 5f73 656c 290a 2020 2020 2020  cols_sel).      
+000022d0: 2020 6964 785f 6120 3d20 6964 785b 6964    idx_a = idx[id
+000022e0: 785f 7365 6c5d 202d 205f 7031 0a0a 2020  x_sel] - _p1..  
+000022f0: 2020 2020 2020 6966 2075 7365 5f6e 756d        if use_num
+00002300: 6261 3a0a 2020 2020 2020 2020 2020 2020  ba:.            
+00002310: 6e70 5f73 6574 2864 6174 612c 2069 6478  np_set(data, idx
+00002320: 5f73 656c 2c20 615b 6964 785f 615d 2c20  _sel, a[idx_a], 
+00002330: 6178 6973 203d 2030 290a 2020 2020 2020  axis = 0).      
+00002340: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002350: 2020 2020 6966 2073 6f72 745f 696e 6465      if sort_inde
+00002360: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
+00002370: 2020 2064 6174 615b 6964 785f 7365 6c5b     data[idx_sel[
+00002380: 305d 3a20 6964 785f 7365 6c5b 2d31 5d20  0]: idx_sel[-1] 
+00002390: 2b20 315d 203d 2061 5b69 6478 5f61 5d0a  + 1] = a[idx_a].
+000023a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000023b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000023c0: 2020 6461 7461 5b69 6478 5f73 656c 5d20    data[idx_sel] 
+000023d0: 3d20 615b 6964 785f 615d 0a20 2020 2067  = a[idx_a].    g
+000023e0: 632e 636f 6c6c 6563 7428 290a 2020 2020  c.collect().    
+000023f0: 7265 7475 726e 2064 6174 6120 200a 0a23  return data  ..#
+00002400: 206c 6f61 645f 6e70 795f 6964 780a 6465   load_npy_idx.de
+00002410: 6620 727a 5f6c 6f61 645f 6e70 795f 6964  f rz_load_npy_id
+00002420: 7828 7061 7468 2c20 6964 782c 2063 6f6c  x(path, idx, col
+00002430: 7320 3d20 4e6f 6e65 2c20 6261 7463 685f  s = None, batch_
+00002440: 7369 7a65 203d 202d 312c 2062 6c6f 636b  size = -1, block
+00002450: 5f73 697a 6520 3d20 4e6f 6e65 2c20 736f  _size = None, so
+00002460: 7274 5f69 6e64 6578 203d 2046 616c 7365  rt_index = False
+00002470: 2c20 7665 7262 6f73 6520 3d20 4661 6c73  , verbose = Fals
+00002480: 652c 2075 7365 5f6e 756d 6261 203d 2046  e, use_numba = F
+00002490: 616c 7365 2c20 6e5f 6a6f 6273 203d 2038  alse, n_jobs = 8
+000024a0: 2c20 6b74 696d 6573 203d 2031 293a 0a20  , ktimes = 1):. 
+000024b0: 2020 205c 275c 275c 270a 2020 2020 727a     \'\'\'.    rz
+000024c0: e5bc 80e5 a4b4 e79a 84e5 87bd e695 b02c  ...............,
+000024d0: 206b 7469 6d65 7320 3d20 31e6 98af e585   ktimes = 1.....
+000024e0: b3e9 94ae 202a 2a2a 2a2a 2a20 727a 5f6c  .... ****** rz_l
+000024f0: 6f61 645f 6e70 795f 6964 7820 2a2a 2a2a  oad_npy_idx ****
+00002500: 2a2a 0a20 2020 206e 5f6a 6f62 7320 3d20  **.    n_jobs = 
+00002510: 382c 206b 7469 6d65 7320 3d20 312c 2034  8, ktimes = 1, 4
+00002520: 2074 696d 6573 2066 6173 7465 7220 7468   times faster th
+00002530: 616e 206c 6f61 645f 6e70 795f 6964 780a  an load_npy_idx.
+00002540: 2020 2020 3747 422f 730a 2020 2020 5c27      7GB/s.    \'
+00002550: 5c27 5c27 0a20 2020 2068 6561 6465 7220  \'\'.    header 
+00002560: 3d20 7265 6164 5f6e 7079 5f68 6561 6465  = read_npy_heade
+00002570: 7228 7061 7468 290a 2020 2020 6966 2063  r(path).    if c
+00002580: 6f6c 7320 6973 204e 6f6e 653a 2061 203d  ols is None: a =
+00002590: 206e 702e 656d 7074 7928 286c 656e 2869   np.empty((len(i
+000025a0: 6478 292c 2068 6561 6465 725b 305d 5b2d  dx), header[0][-
+000025b0: 315d 292c 2064 7479 7065 203d 206e 702e  1]), dtype = np.
+000025c0: 666c 6f61 7433 3229 0a20 2020 2065 6c73  float32).    els
+000025d0: 653a 2061 203d 206e 702e 656d 7074 7928  e: a = np.empty(
+000025e0: 286c 656e 2869 6478 292c 206c 656e 2863  (len(idx), len(c
+000025f0: 6f6c 7329 292c 2064 7479 7065 203d 206e  ols)), dtype = n
+00002600: 702e 666c 6f61 7433 3229 0a20 2020 2064  p.float32).    d
+00002610: 6566 2072 7a5f 7275 6e28 7031 2c20 7032  ef rz_run(p1, p2
+00002620: 293a 0a20 2020 2020 2020 2069 6620 7031  ):.        if p1
+00002630: 203e 3d20 7032 3a20 7265 7475 726e 0a20   >= p2: return. 
+00002640: 2020 2020 2020 2061 5b70 313a 2070 325d         a[p1: p2]
+00002650: 203d 206c 6f61 645f 6e70 795f 6964 7828   = load_npy_idx(
+00002660: 7061 7468 2c20 6964 785b 7031 3a20 7032  path, idx[p1: p2
+00002670: 5d2c 2063 6f6c 732c 2062 6174 6368 5f73  ], cols, batch_s
+00002680: 697a 652c 2062 6c6f 636b 5f73 697a 652c  ize, block_size,
+00002690: 2073 6f72 745f 696e 6465 782c 2076 6572   sort_index, ver
+000026a0: 626f 7365 203d 2046 616c 7365 2c20 7573  bose = False, us
+000026b0: 655f 6e75 6d62 6120 3d20 4661 6c73 6529  e_numba = False)
+000026c0: 0a20 2020 2061 6b73 203d 2067 6574 5f61  .    aks = get_a
+000026d0: 6b73 286c 656e 2861 292c 206e 5f6a 6f62  ks(len(a), n_job
+000026e0: 7320 2a20 6b74 696d 6573 290a 2020 2020  s * ktimes).    
+000026f0: 7275 6e5f 6675 6e63 2872 7a5f 7275 6e2c  run_func(rz_run,
+00002700: 2061 6b73 2c20 6e5f 6a6f 6273 203d 206e   aks, n_jobs = n
+00002710: 5f6a 6f62 732c 206d 6f64 6520 3d20 2773  _jobs, mode = 's
+00002720: 6d27 2c20 7665 7262 6f73 6520 3d20 7665  m', verbose = ve
+00002730: 7262 6f73 6529 0a20 2020 2072 6574 7572  rbose).    retur
+00002740: 6e20 610a 0a23 206c 6f61 645f 6e70 795f  n a..# load_npy_
+00002750: 6964 785f 6d75 6c74 690a 6465 6620 6c6f  idx_multi.def lo
+00002760: 6164 5f6e 7079 5f69 6478 5f6d 756c 7469  ad_npy_idx_multi
+00002770: 2870 6174 685f 6c69 7374 2c20 6964 785f  (path_list, idx_
+00002780: 6c69 7374 2c20 636f 6c73 5f6c 6973 7420  list, cols_list 
+00002790: 3d20 4e6f 6e65 2c20 0a20 2020 2020 2020  = None, .       
+000027a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000027b0: 6261 7463 685f 7369 7a65 203d 202d 312c  batch_size = -1,
+000027c0: 2062 6c6f 636b 5f73 697a 6520 3d20 4e6f   block_size = No
+000027d0: 6e65 2c20 7665 7262 6f73 6520 3d20 4661  ne, verbose = Fa
+000027e0: 6c73 652c 2075 7365 5f6e 756d 6261 203d  lse, use_numba =
+000027f0: 2054 7275 6529 3a0a 2020 2020 5c27 5c27   True):.    \'\'
+00002800: 5c27 0a20 2020 2069 6478 203d 206e 702e  \'.    idx = np.
+00002810: 736f 7274 286e 702e 7261 6e64 6f6d 2e70  sort(np.random.p
+00002820: 6572 6d75 7461 7469 6f6e 2832 3030 3030  ermutation(20000
+00002830: 3030 295b 3a31 3930 3030 3030 5d29 0a20  00)[:1900000]). 
+00002840: 2020 2063 6f6c 7320 3d20 6e70 2e72 616e     cols = np.ran
+00002850: 646f 6d2e 7065 726d 7574 6174 696f 6e28  dom.permutation(
+00002860: 3130 3030 295b 3a39 3030 5d0a 2020 2020  1000)[:900].    
+00002870: 6461 7461 203d 2072 7a2e 7574 696c 2e6e  data = rz.util.n
+00002880: 7079 2e6c 6f61 645f 6e70 795f 6964 785f  py.load_npy_idx_
+00002890: 6d75 6c74 6928 5b27 612e 6e70 7927 2c20  multi(['a.npy', 
+000028a0: 2761 2e6e 7079 275d 2c20 6964 782c 2063  'a.npy'], idx, c
+000028b0: 6f6c 735f 6c69 7374 203d 205b 636f 6c73  ols_list = [cols
+000028c0: 2c20 636f 6c73 5d2c 200a 2020 2020 2020  , cols], .      
+000028d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000028e0: 2020 626c 6f63 6b5f 7369 7a65 203d 2032    block_size = 2
+000028f0: 3030 2c20 7665 7262 6f73 6520 3d20 5472  00, verbose = Tr
+00002900: 7565 2c20 7573 655f 6e75 6d62 6120 3d20  ue, use_numba = 
+00002910: 4661 6c73 6529 0a0a 2020 2020 727a 2e67  False)..    rz.g
+00002920: 6574 5f6d 656d 5f63 7572 2829 2c20 727a  et_mem_cur(), rz
+00002930: 2e67 6574 5f6d 656d 5f6d 6178 2829 3b0a  .get_mem_max();.
+00002940: 2020 2020 6461 7461 203d 206c 6f61 645f      data = load_
+00002950: 6e70 795f 6964 785f 6d75 6c74 6928 5b27  npy_idx_multi(['
+00002960: 612e 6e70 7927 2c20 2762 2e6e 7079 275d  a.npy', 'b.npy']
+00002970: 2c20 6d61 736b 5f69 6478 2c20 636f 6c73  , mask_idx, cols
+00002980: 5f6c 6973 7420 3d20 5b63 6f6c 732c 2063  _list = [cols, c
+00002990: 6f6c 735d 2c20 0a20 2020 2020 2020 2020  ols], .         
+000029a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029b0: 2020 626c 6f63 6b5f 7369 7a65 203d 2032    block_size = 2
+000029c0: 3030 2c20 7665 7262 6f73 6520 3d20 5472  00, verbose = Tr
+000029d0: 7565 290a 2020 2020 7072 696e 7428 6461  ue).    print(da
+000029e0: 7461 2e73 6861 7065 290a 2020 2020 7072  ta.shape).    pr
+000029f0: 696e 7428 6627 7b34 202a 206e 702e 7072  int(f'{4 * np.pr
+00002a00: 6f64 2864 6174 612e 7368 6170 6529 3a2c  od(data.shape):,
+00002a10: 2e30 667d 2729 0a20 2020 2072 7a2e 6765  .0f}').    rz.ge
+00002a20: 745f 6d65 6d5f 6375 7228 292c 2072 7a2e  t_mem_cur(), rz.
+00002a30: 6765 745f 6d65 6d5f 6d61 7828 293b 0a20  get_mem_max();. 
+00002a40: 2020 205c 275c 275c 270a 2020 2020 0a20     \'\'\'.    . 
+00002a50: 2020 2023 2069 6e70 7574 0a20 2020 2069     # input.    i
+00002a60: 6620 7479 7065 2869 6478 5f6c 6973 7429  f type(idx_list)
+00002a70: 2069 7320 6e6f 7420 6c69 7374 3a0a 2020   is not list:.  
+00002a80: 2020 2020 2020 6964 785f 6c69 7374 203d        idx_list =
+00002a90: 205b 6964 785f 6c69 7374 2066 6f72 205f   [idx_list for _
+00002aa0: 2069 6e20 7261 6e67 6528 6c65 6e28 7061   in range(len(pa
+00002ab0: 7468 5f6c 6973 7429 295d 0a20 2020 2069  th_list))].    i
+00002ac0: 6620 636f 6c73 5f6c 6973 7420 6973 204e  f cols_list is N
+00002ad0: 6f6e 653a 0a20 2020 2020 2020 2063 6f6c  one:.        col
+00002ae0: 735f 6c69 7374 203d 205b 4e6f 6e65 2066  s_list = [None f
+00002af0: 6f72 205f 2069 6e20 7261 6e67 6528 6c65  or _ in range(le
+00002b00: 6e28 7061 7468 5f6c 6973 7429 295d 0a20  n(path_list))]. 
+00002b10: 2020 2073 6861 7065 5f6c 6973 7420 3d20     shape_list = 
+00002b20: 5b72 6561 645f 6e70 795f 6865 6164 6572  [read_npy_header
+00002b30: 2870 6174 6829 5b30 5d20 666f 7220 7061  (path)[0] for pa
+00002b40: 7468 2069 6e20 7061 7468 5f6c 6973 745d  th in path_list]
+00002b50: 0a20 2020 2064 7479 7065 5f6c 6973 7420  .    dtype_list 
+00002b60: 3d20 5b73 7472 2872 6561 645f 6e70 795f  = [str(read_npy_
+00002b70: 6865 6164 6572 2870 6174 6829 5b2d 315d  header(path)[-1]
+00002b80: 2920 666f 7220 7061 7468 2069 6e20 7061  ) for path in pa
+00002b90: 7468 5f6c 6973 745d 0a20 2020 206e 5f72  th_list].    n_r
+00002ba0: 6f77 735f 6c69 7374 203d 205b 7368 6170  ows_list = [shap
+00002bb0: 655b 305d 2066 6f72 2073 6861 7065 2069  e[0] for shape i
+00002bc0: 6e20 7368 6170 655f 6c69 7374 5d0a 2020  n shape_list].  
+00002bd0: 2020 6e5f 726f 7773 5f73 656c 5f6c 6973    n_rows_sel_lis
+00002be0: 7420 3d20 5b6c 656e 2869 6478 2920 666f  t = [len(idx) fo
+00002bf0: 7220 6964 7820 696e 2069 6478 5f6c 6973  r idx in idx_lis
+00002c00: 745d 0a20 2020 2061 7373 6572 7420 6c65  t].    assert le
+00002c10: 6e28 7061 7468 5f6c 6973 7429 203d 3d20  n(path_list) == 
+00002c20: 6c65 6e28 6964 785f 6c69 7374 2920 616e  len(idx_list) an
+00002c30: 6420 6c65 6e28 7061 7468 5f6c 6973 7429  d len(path_list)
+00002c40: 203d 3d20 6c65 6e28 636f 6c73 5f6c 6973   == len(cols_lis
+00002c50: 7429 2c5c 0a20 2020 2020 2020 2066 2770  t),\.        f'p
+00002c60: 6174 685f 6c69 7374 203d 207b 6c65 6e28  ath_list = {len(
+00002c70: 7061 7468 5f6c 6973 7429 7d2c 2069 6478  path_list)}, idx
+00002c80: 5f6c 6973 7420 3d20 7b6c 656e 2869 6478  _list = {len(idx
+00002c90: 5f6c 6973 7429 7d2c 2063 6f6c 735f 6c69  _list)}, cols_li
+00002ca0: 7374 203d 207b 6c65 6e28 636f 6c73 5f6c  st = {len(cols_l
+00002cb0: 6973 7429 7d27 0a20 2020 2061 7373 6572  ist)}'.    asser
+00002cc0: 7420 6c65 6e28 7365 7428 6e5f 726f 7773  t len(set(n_rows
+00002cd0: 5f73 656c 5f6c 6973 7429 2920 3d3d 2031  _sel_list)) == 1
+00002ce0: 2c5c 0a20 2020 2020 2020 2066 276e 5f72  ,\.        f'n_r
+00002cf0: 6f77 735f 7365 6c5f 6c69 7374 203d 207b  ows_sel_list = {
+00002d00: 6e5f 726f 7773 5f73 656c 5f6c 6973 747d  n_rows_sel_list}
+00002d10: 270a 2020 2020 6e5f 636f 6c73 5f73 656c  '.    n_cols_sel
+00002d20: 5f6c 6973 7420 3d20 5b73 6861 7065 5f6c  _list = [shape_l
+00002d30: 6973 745b 695d 5b2d 315d 2069 6620 636f  ist[i][-1] if co
+00002d40: 6c73 2069 7320 4e6f 6e65 2065 6c73 6520  ls is None else 
+00002d50: 6c65 6e28 636f 6c73 290a 2020 2020 2020  len(cols).      
+00002d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d70: 2066 6f72 2028 692c 2063 6f6c 7329 2069   for (i, cols) i
+00002d80: 6e20 656e 756d 6572 6174 6528 636f 6c73  n enumerate(cols
+00002d90: 5f6c 6973 7429 5d0a 2020 2020 0a20 2020  _list)].    .   
+00002da0: 2069 6620 6e70 2e6d 6178 2869 6478 5f6c   if np.max(idx_l
+00002db0: 6973 745b 305d 2920 3c3d 2031 3a0a 2020  ist[0]) <= 1:.  
+00002dc0: 2020 2020 2020 7072 696e 7428 275c 6e2a        print('\n*
+00002dd0: 2a2a 2a2a 2a2a 2a2a 2a20 4944 5820 3c3d  ********* IDX <=
+00002de0: 2031 2c20 594f 5520 4d41 5920 5553 4520   1, YOU MAY USE 
+00002df0: 6d61 736b 2061 7320 6d61 736b 5f69 6478  mask as mask_idx
+00002e00: 2c20 504c 4541 5345 2043 4845 434b 2120  , PLEASE CHECK! 
+00002e10: 2a2a 2a2a 2a2a 2a2a 2a2a 5c6e 2729 0a20  **********\n'). 
+00002e20: 2020 200a 2020 2020 2320 6669 6e61 6c20     .    # final 
+00002e30: 6461 7461 0a20 2020 2064 6174 6120 3d20  data.    data = 
+00002e40: 6e70 2e7a 6572 6f73 2828 6e5f 726f 7773  np.zeros((n_rows
+00002e50: 5f73 656c 5f6c 6973 745b 305d 2c20 6e70  _sel_list[0], np
+00002e60: 2e73 756d 286e 5f63 6f6c 735f 7365 6c5f  .sum(n_cols_sel_
+00002e70: 6c69 7374 2929 2c20 6474 7970 6520 3d20  list)), dtype = 
+00002e80: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00002e90: 6966 2062 6c6f 636b 5f73 697a 6520 6973  if block_size is
+00002ea0: 204e 6f6e 6520 6f72 2062 6c6f 636b 5f73   None or block_s
+00002eb0: 697a 6520 3d3d 202d 313a 200a 2020 2020  ize == -1: .    
+00002ec0: 2020 2020 626c 6f63 6b5f 7369 7a65 203d      block_size =
+00002ed0: 2032 3030 202a 2031 3032 3420 2a20 3130   200 * 1024 * 10
+00002ee0: 3234 2023 2032 3030 4d0a 2020 2020 656c  24 # 200M.    el
+00002ef0: 7365 3a0a 2020 2020 2020 2020 626c 6f63  se:.        bloc
+00002f00: 6b5f 7369 7a65 202a 3d20 3130 3234 202a  k_size *= 1024 *
+00002f10: 2031 3032 340a 2020 2020 6966 2076 6572   1024.    if ver
+00002f20: 626f 7365 3a20 7072 696e 7428 6627 5b2b  bose: print(f'[+
+00002f30: 5d20 6461 7461 2e73 6861 7065 2020 3d20  ] data.shape  = 
+00002f40: 7b64 6174 612e 7368 6170 657d 2c20 6d65  {data.shape}, me
+00002f50: 6d20 3d20 7b6e 702e 7072 6f64 2864 6174  m = {np.prod(dat
+00002f60: 612e 7368 6170 6529 202a 2034 3a2c 2e30  a.shape) * 4:,.0
+00002f70: 667d 2729 0a20 2020 200a 2020 2020 2320  f}').    .    # 
+00002f80: 666f 7220 6561 6368 2070 6174 680a 2020  for each path.  
+00002f90: 2020 666f 7220 7069 2069 6e20 7261 6e67    for pi in rang
+00002fa0: 6528 6c65 6e28 7061 7468 5f6c 6973 7429  e(len(path_list)
+00002fb0: 293a 0a20 2020 2020 2020 2070 6174 6820  ):.        path 
+00002fc0: 3d20 7061 7468 5f6c 6973 745b 7069 5d0a  = path_list[pi].
+00002fd0: 2020 2020 2020 2020 6474 7970 6520 3d20          dtype = 
+00002fe0: 6474 7970 655f 6c69 7374 5b70 695d 0a20  dtype_list[pi]. 
+00002ff0: 2020 2020 2020 2069 6478 203d 2069 6478         idx = idx
+00003000: 5f6c 6973 745b 7069 5d0a 2020 2020 2020  _list[pi].      
+00003010: 2020 636f 6c73 203d 2063 6f6c 735f 6c69    cols = cols_li
+00003020: 7374 5b70 695d 0a20 2020 2020 2020 2073  st[pi].        s
+00003030: 6861 7065 203d 2073 6861 7065 5f6c 6973  hape = shape_lis
+00003040: 745b 7069 5d0a 2020 2020 2020 2020 6e5f  t[pi].        n_
+00003050: 726f 7773 203d 206e 5f72 6f77 735f 6c69  rows = n_rows_li
+00003060: 7374 5b70 695d 0a20 2020 2020 2020 206e  st[pi].        n
+00003070: 5f72 6f77 735f 7365 6c20 3d20 6e5f 726f  _rows_sel = n_ro
+00003080: 7773 5f73 656c 5f6c 6973 745b 7069 5d0a  ws_sel_list[pi].
+00003090: 2020 2020 2020 2020 6e5f 636f 6c73 5f73          n_cols_s
+000030a0: 656c 203d 206e 5f63 6f6c 735f 7365 6c5f  el = n_cols_sel_
+000030b0: 6c69 7374 5b70 695d 0a20 2020 2020 2020  list[pi].       
+000030c0: 200a 2020 2020 2020 2020 2320 6261 7463   .        # batc
+000030d0: 685f 7369 7a65 0a20 2020 2020 2020 2069  h_size.        i
+000030e0: 6620 6261 7463 685f 7369 7a65 2069 7320  f batch_size is 
+000030f0: 4e6f 6e65 206f 7220 6261 7463 685f 7369  None or batch_si
+00003100: 7a65 203d 3d20 2d31 3a0a 2020 2020 2020  ze == -1:.      
+00003110: 2020 2020 2020 7369 7a65 5f6f 6e65 5f72        size_one_r
+00003120: 6f77 203d 2028 6e70 2e70 726f 6428 7368  ow = (np.prod(sh
+00003130: 6170 655b 313a 5d29 202a 2028 3820 6966  ape[1:]) * (8 if
+00003140: 2027 3634 2720 696e 2064 7479 7065 2065   '64' in dtype e
+00003150: 6c73 6520 3429 290a 2020 2020 2020 2020  lse 4)).        
+00003160: 2020 2020 6261 7463 685f 7369 7a65 203d      batch_size =
+00003170: 2069 6e74 2862 6c6f 636b 5f73 697a 6520   int(block_size 
+00003180: 2f20 7369 7a65 5f6f 6e65 5f72 6f77 290a  / size_one_row).
+00003190: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+000031a0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+000031b0: 2070 7269 6e74 2866 275b 2b5d 2064 6174   print(f'[+] dat
+000031c0: 615f 616c 6c5f 7b70 693a 3032 647d 203d  a_all_{pi:02d} =
+000031d0: 207b 7368 6170 657d 2c20 6d65 6d20 3d20   {shape}, mem = 
+000031e0: 7b6e 702e 7072 6f64 2873 6861 7065 2920  {np.prod(shape) 
+000031f0: 2a20 343a 2c2e 3066 7d27 2920 2020 200a  * 4:,.0f}')    .
+00003200: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00003210: 7428 6627 2020 2020 6461 7461 5f73 656c  t(f'    data_sel
+00003220: 5f7b 7069 3a30 3264 7d20 3d20 7b28 6e5f  _{pi:02d} = {(n_
+00003230: 726f 7773 5f73 656c 2c20 6e5f 636f 6c73  rows_sel, n_cols
+00003240: 5f73 656c 297d 2c20 6d65 6d20 3d20 7b6e  _sel)}, mem = {n
+00003250: 5f72 6f77 735f 7365 6c20 2a20 6e5f 636f  _rows_sel * n_co
+00003260: 6c73 5f73 656c 202a 2034 3a2c 2e30 667d  ls_sel * 4:,.0f}
+00003270: 2729 2020 2020 0a20 2020 2020 2020 2020  ')    .         
+00003280: 2020 2070 7269 6e74 2866 2720 2020 2062     print(f'    b
+00003290: 6c6f 636b 5f73 697a 6520 203d 207b 626c  lock_size  = {bl
+000032a0: 6f63 6b5f 7369 7a65 3a2c 2e30 667d 203d  ock_size:,.0f} =
+000032b0: 207b 6261 7463 685f 7369 7a65 3a2c 2e30   {batch_size:,.0
+000032c0: 667d 202a 207b 7369 7a65 5f6f 6e65 5f72  f} * {size_one_r
+000032d0: 6f77 3a2e 3066 7d27 290a 0a20 2020 2020  ow:.0f}')..     
+000032e0: 2020 2023 206c 6f61 640a 2020 2020 2020     # load.      
+000032f0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+00003300: 2020 2020 2020 2020 2020 7267 203d 2074            rg = t
+00003310: 7164 6d28 7261 6e67 6528 302c 206e 5f72  qdm(range(0, n_r
+00003320: 6f77 732c 2062 6174 6368 5f73 697a 6529  ows, batch_size)
+00003330: 2c20 6465 7363 3d66 276c 6f61 645f 6e70  , desc=f'load_np
+00003340: 795f 6964 785f 6d75 6c74 6928 2927 2c20  y_idx_multi()', 
+00003350: 6e63 6f6c 733d 3130 302c 2061 7363 6969  ncols=100, ascii
+00003360: 3d54 7275 6529 0a20 2020 2020 2020 2065  =True).        e
+00003370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00003380: 2072 6720 3d20 7261 6e67 6528 302c 206e   rg = range(0, n
+00003390: 5f72 6f77 732c 2062 6174 6368 5f73 697a  _rows, batch_siz
+000033a0: 6529 0a20 2020 2020 2020 2066 6f72 2069  e).        for i
+000033b0: 2069 6e20 7267 3a0a 2020 2020 2020 2020   in rg:.        
+000033c0: 2020 2020 7031 2c20 7032 203d 2069 2c20      p1, p2 = i, 
+000033d0: 6d69 6e28 6e5f 726f 7773 2c20 6920 2b20  min(n_rows, i + 
+000033e0: 6261 7463 685f 7369 7a65 290a 2020 2020  batch_size).    
+000033f0: 2020 2020 2020 2020 5f70 3120 3d20 7031          _p1 = p1
+00003400: 202a 2069 6e74 286e 702e 7072 6f64 2873   * int(np.prod(s
+00003410: 6861 7065 5b31 3a2d 315d 2929 0a20 2020  hape[1:-1])).   
+00003420: 2020 2020 2020 2020 205f 7032 203d 2070           _p2 = p
+00003430: 3220 2a20 696e 7428 6e70 2e70 726f 6428  2 * int(np.prod(
+00003440: 7368 6170 655b 313a 2d31 5d29 290a 2020  shape[1:-1])).  
+00003450: 2020 2020 2020 2020 2020 6964 785f 7365            idx_se
+00003460: 6c20 3d20 6e70 2e77 6865 7265 2828 5f70  l = np.where((_p
+00003470: 3120 3c3d 2069 6478 2920 2620 2869 6478  1 <= idx) & (idx
+00003480: 203c 205f 7032 2929 5b30 5d0a 2020 2020   < _p2))[0].    
+00003490: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
+000034a0: 6478 5f73 656c 2920 3d3d 2030 3a20 636f  dx_sel) == 0: co
+000034b0: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+000034c0: 2020 2020 6120 3d20 6c6f 6164 5f6e 7079      a = load_npy
+000034d0: 2870 6174 682c 2073 7461 7274 203d 2070  (path, start = p
+000034e0: 312c 2065 6e64 203d 2070 322c 2063 6f6c  1, end = p2, col
+000034f0: 7320 3d20 636f 6c73 2c20 7573 655f 6e75  s = cols, use_nu
+00003500: 6d62 6120 3d20 7573 655f 6e75 6d62 6129  mba = use_numba)
+00003510: 2e72 6573 6861 7065 282d 312c 206e 5f63  .reshape(-1, n_c
+00003520: 6f6c 735f 7365 6c29 0a20 2020 2020 2020  ols_sel).       
+00003530: 2020 2020 2069 6478 5f61 203d 2069 6478       idx_a = idx
+00003540: 5b69 6478 5f73 656c 5d20 2d20 5f70 310a  [idx_sel] - _p1.
+00003550: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00003560: 2020 2020 2020 2020 2063 312c 2063 3220           c1, c2 
+00003570: 3d20 696e 7428 6e70 2e73 756d 286e 5f63  = int(np.sum(n_c
+00003580: 6f6c 735f 7365 6c5f 6c69 7374 5b3a 7069  ols_sel_list[:pi
+00003590: 5d29 292c 2069 6e74 286e 702e 7375 6d28  ])), int(np.sum(
+000035a0: 6e5f 636f 6c73 5f73 656c 5f6c 6973 745b  n_cols_sel_list[
+000035b0: 3a70 6920 2b20 315d 2929 0a20 2020 2020  :pi + 1])).     
+000035c0: 2020 2020 2020 2064 6174 615b 6964 785f         data[idx_
+000035d0: 7365 6c2c 2063 313a 2063 325d 203d 2061  sel, c1: c2] = a
+000035e0: 5b69 6478 5f61 5d0a 2020 2020 2020 2020  [idx_a].        
+000035f0: 6763 2e63 6f6c 6c65 6374 2829 0a20 2020  gc.collect().   
+00003600: 2072 6574 7572 6e20 6461 7461 0a0a 2320   return data..# 
+00003610: 727a 5f6c 6f61 645f 6e70 795f 6964 785f  rz_load_npy_idx_
+00003620: 6d75 6c74 690a 6465 6620 727a 5f6c 6f61  multi.def rz_loa
+00003630: 645f 6e70 795f 6964 785f 6d75 6c74 6928  d_npy_idx_multi(
+00003640: 7061 7468 5f6c 6973 742c 2069 6478 5f6c  path_list, idx_l
+00003650: 6973 742c 2063 6f6c 735f 6c69 7374 203d  ist, cols_list =
+00003660: 204e 6f6e 652c 200a 2020 2020 6261 7463   None, .    batc
+00003670: 685f 7369 7a65 203d 202d 312c 2062 6c6f  h_size = -1, blo
+00003680: 636b 5f73 697a 6520 3d20 3430 3030 2c20  ck_size = 4000, 
+00003690: 7665 7262 6f73 6520 3d20 302c 2075 7365  verbose = 0, use
+000036a0: 5f6e 756d 6261 203d 2046 616c 7365 2c20  _numba = False, 
+000036b0: 0a20 2020 206e 5f6a 6f62 7320 3d20 3136  .    n_jobs = 16
+000036c0: 2c20 6b74 696d 6573 203d 2031 3029 3a0a  , ktimes = 10):.
+000036d0: 2020 2020 5c27 5c27 5c27 0a20 2020 2061      \'\'\'.    a
+000036e0: 203d 2072 7a5f 6c6f 6164 5f6e 7079 5f69   = rz_load_npy_i
+000036f0: 6478 5f6d 756c 7469 285b 7061 7468 2c20  dx_multi([path, 
+00003700: 7061 7468 5d2c 204e 6f6e 652c 2063 6f6c  path], None, col
+00003710: 735f 6c69 7374 203d 205b 6e70 2e61 7261  s_list = [np.ara
+00003720: 6e67 6528 302c 2031 3030 3029 2c20 6e70  nge(0, 1000), np
+00003730: 2e61 7261 6e67 6528 3130 3030 2c20 3230  .arange(1000, 20
+00003740: 3030 295d 2c20 7665 7262 6f73 653d 5472  00)], verbose=Tr
+00003750: 7565 2c20 6e5f 6a6f 6273 203d 3136 2c20  ue, n_jobs =16, 
+00003760: 6b74 696d 6573 203d 2031 302c 2062 6c6f  ktimes = 10, blo
+00003770: 636b 5f73 697a 6520 3d20 3430 3030 2920  ck_size = 4000) 
+00003780: 2320 3230 730a 2020 2020 5c27 5c27 5c27  # 20s.    \'\'\'
+00003790: 0a0a 2020 2020 2320 696e 7075 740a 2020  ..    # input.  
+000037a0: 2020 6966 2069 6478 5f6c 6973 7420 6973    if idx_list is
+000037b0: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+000037c0: 6478 5f6c 6973 7420 3d20 5b4e 6f6e 6520  dx_list = [None 
+000037d0: 666f 7220 5f20 696e 2072 616e 6765 286c  for _ in range(l
+000037e0: 656e 2870 6174 685f 6c69 7374 2929 5d0a  en(path_list))].
+000037f0: 2020 2020 6966 2074 7970 6528 6964 785f      if type(idx_
+00003800: 6c69 7374 2920 6973 206e 6f74 206c 6973  list) is not lis
+00003810: 743a 0a20 2020 2020 2020 2069 6478 5f6c  t:.        idx_l
+00003820: 6973 7420 3d20 5b69 6478 5f6c 6973 7420  ist = [idx_list 
+00003830: 666f 7220 5f20 696e 2072 616e 6765 286c  for _ in range(l
+00003840: 656e 2870 6174 685f 6c69 7374 2929 5d0a  en(path_list))].
+00003850: 2020 2020 6966 2063 6f6c 735f 6c69 7374      if cols_list
+00003860: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00003870: 2020 636f 6c73 5f6c 6973 7420 3d20 5b4e    cols_list = [N
+00003880: 6f6e 6520 666f 7220 5f20 696e 2072 616e  one for _ in ran
+00003890: 6765 286c 656e 2870 6174 685f 6c69 7374  ge(len(path_list
+000038a0: 2929 5d0a 0a20 2020 2068 6561 6465 725f  ))]..    header_
+000038b0: 6c69 7374 203d 205b 7265 6164 5f6e 7079  list = [read_npy
+000038c0: 5f68 6561 6465 7228 7061 7468 2920 666f  _header(path) fo
+000038d0: 7220 7061 7468 2069 6e20 7061 7468 5f6c  r path in path_l
+000038e0: 6973 745d 0a20 2020 2073 6861 7065 5f6c  ist].    shape_l
+000038f0: 6973 7420 3d20 5b72 6561 645f 6e70 795f  ist = [read_npy_
+00003900: 6865 6164 6572 2870 6174 6829 5b30 5d20  header(path)[0] 
+00003910: 666f 7220 7061 7468 2069 6e20 7061 7468  for path in path
+00003920: 5f6c 6973 745d 0a20 2020 2064 7479 7065  _list].    dtype
+00003930: 5f6c 6973 7420 3d20 5b73 7472 2872 6561  _list = [str(rea
+00003940: 645f 6e70 795f 6865 6164 6572 2870 6174  d_npy_header(pat
+00003950: 6829 5b2d 315d 2920 666f 7220 7061 7468  h)[-1]) for path
+00003960: 2069 6e20 7061 7468 5f6c 6973 745d 0a20   in path_list]. 
+00003970: 2020 206e 5f72 6f77 735f 6c69 7374 203d     n_rows_list =
+00003980: 205b 7368 6170 655b 305d 2066 6f72 2073   [shape[0] for s
+00003990: 6861 7065 2069 6e20 7368 6170 655f 6c69  hape in shape_li
+000039a0: 7374 5d0a 2020 2020 6966 206e 702e 616c  st].    if np.al
+000039b0: 6c28 5b69 6478 2069 7320 4e6f 6e65 2066  l([idx is None f
+000039c0: 6f72 2069 6478 2069 6e20 6964 785f 6c69  or idx in idx_li
+000039d0: 7374 5d29 3a0a 2020 2020 2020 2020 6e5f  st]):.        n_
+000039e0: 726f 7773 5f73 656c 5f6c 6973 7420 3d20  rows_sel_list = 
+000039f0: 5b68 6561 6465 725b 305d 5b30 5d20 666f  [header[0][0] fo
+00003a00: 7220 6865 6164 6572 2069 6e20 6865 6164  r header in head
+00003a10: 6572 5f6c 6973 745d 0a20 2020 2065 6c73  er_list].    els
+00003a20: 653a 0a20 2020 2020 2020 206e 5f72 6f77  e:.        n_row
+00003a30: 735f 7365 6c5f 6c69 7374 203d 205b 6c65  s_sel_list = [le
+00003a40: 6e28 6964 7829 2066 6f72 2069 6478 2069  n(idx) for idx i
+00003a50: 6e20 6964 785f 6c69 7374 5d0a 2020 2020  n idx_list].    
+00003a60: 6173 7365 7274 206c 656e 2870 6174 685f  assert len(path_
+00003a70: 6c69 7374 2920 3d3d 206c 656e 2869 6478  list) == len(idx
+00003a80: 5f6c 6973 7429 2061 6e64 206c 656e 2870  _list) and len(p
+00003a90: 6174 685f 6c69 7374 2920 3d3d 206c 656e  ath_list) == len
+00003aa0: 2863 6f6c 735f 6c69 7374 292c 5c0a 2020  (cols_list),\.  
+00003ab0: 2020 2020 2020 6627 7061 7468 5f6c 6973        f'path_lis
+00003ac0: 7420 3d20 7b6c 656e 2870 6174 685f 6c69  t = {len(path_li
+00003ad0: 7374 297d 2c20 6964 785f 6c69 7374 203d  st)}, idx_list =
+00003ae0: 207b 6c65 6e28 6964 785f 6c69 7374 297d   {len(idx_list)}
+00003af0: 2c20 636f 6c73 5f6c 6973 7420 3d20 7b6c  , cols_list = {l
+00003b00: 656e 2863 6f6c 735f 6c69 7374 297d 270a  en(cols_list)}'.
+00003b10: 2020 2020 6173 7365 7274 206c 656e 2873      assert len(s
+00003b20: 6574 286e 5f72 6f77 735f 7365 6c5f 6c69  et(n_rows_sel_li
+00003b30: 7374 2929 203d 3d20 312c 2066 276e 5f72  st)) == 1, f'n_r
+00003b40: 6f77 735f 7365 6c5f 6c69 7374 203d 207b  ows_sel_list = {
+00003b50: 6e5f 726f 7773 5f73 656c 5f6c 6973 747d  n_rows_sel_list}
+00003b60: 270a 2020 2020 6e5f 636f 6c73 5f73 656c  '.    n_cols_sel
+00003b70: 5f6c 6973 7420 3d20 5b73 6861 7065 5f6c  _list = [shape_l
+00003b80: 6973 745b 695d 5b2d 315d 2069 6620 636f  ist[i][-1] if co
+00003b90: 6c73 2069 7320 4e6f 6e65 2065 6c73 6520  ls is None else 
+00003ba0: 6c65 6e28 636f 6c73 290a 2020 2020 2020  len(cols).      
+00003bb0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00003bc0: 7220 2869 2c20 636f 6c73 2920 696e 2065  r (i, cols) in e
+00003bd0: 6e75 6d65 7261 7465 2863 6f6c 735f 6c69  numerate(cols_li
+00003be0: 7374 295d 0a0a 2020 2020 2320 6669 6e61  st)]..    # fina
+00003bf0: 6c20 6461 7461 0a20 2020 2064 6174 6120  l data.    data 
+00003c00: 3d20 6e70 2e65 6d70 7479 2828 6e5f 726f  = np.empty((n_ro
+00003c10: 7773 5f73 656c 5f6c 6973 745b 305d 2c20  ws_sel_list[0], 
+00003c20: 6e70 2e73 756d 286e 5f63 6f6c 735f 7365  np.sum(n_cols_se
+00003c30: 6c5f 6c69 7374 2929 2c20 6474 7970 6520  l_list)), dtype 
+00003c40: 3d20 6e70 2e66 6c6f 6174 3332 290a 2020  = np.float32).  
+00003c50: 2020 6966 2062 6c6f 636b 5f73 697a 6520    if block_size 
+00003c60: 6973 204e 6f6e 6520 6f72 2062 6c6f 636b  is None or block
+00003c70: 5f73 697a 6520 3d3d 202d 313a 0a20 2020  _size == -1:.   
+00003c80: 2020 2020 2062 6c6f 636b 5f73 697a 6520       block_size 
+00003c90: 3d20 3230 3020 2a20 3130 3234 202a 2031  = 200 * 1024 * 1
+00003ca0: 3032 3420 2320 3230 304d 0a20 2020 2065  024 # 200M.    e
+00003cb0: 6c73 653a 0a20 2020 2020 2020 2062 6c6f  lse:.        blo
+00003cc0: 636b 5f73 697a 6520 2a3d 2031 3032 3420  ck_size *= 1024 
+00003cd0: 2a20 3130 3234 0a20 2020 2069 6620 7665  * 1024.    if ve
+00003ce0: 7262 6f73 6520 3e3d 2032 3a20 7072 696e  rbose >= 2: prin
+00003cf0: 7428 6627 5b2b 5d20 6461 7461 2e73 6861  t(f'[+] data.sha
+00003d00: 7065 2020 3d20 7b64 6174 612e 7368 6170  pe  = {data.shap
+00003d10: 657d 2c20 6d65 6d20 3d20 7b6e 702e 7072  e}, mem = {np.pr
+00003d20: 6f64 2864 6174 612e 7368 6170 6529 202a  od(data.shape) *
+00003d30: 2034 3a2c 2e30 667d 2729 0a0a 2020 2020   4:,.0f}')..    
+00003d40: 2320 666f 7220 6561 6368 2070 6174 680a  # for each path.
+00003d50: 2020 2020 666f 7220 7069 2069 6e20 7261      for pi in ra
+00003d60: 6e67 6528 6c65 6e28 7061 7468 5f6c 6973  nge(len(path_lis
+00003d70: 7429 293a 0a20 2020 2020 2020 2070 6174  t)):.        pat
+00003d80: 6820 3d20 7061 7468 5f6c 6973 745b 7069  h = path_list[pi
+00003d90: 5d0a 2020 2020 2020 2020 6474 7970 6520  ].        dtype 
+00003da0: 3d20 6474 7970 655f 6c69 7374 5b70 695d  = dtype_list[pi]
+00003db0: 0a20 2020 2020 2020 2069 6478 203d 2069  .        idx = i
+00003dc0: 6478 5f6c 6973 745b 7069 5d0a 2020 2020  dx_list[pi].    
+00003dd0: 2020 2020 636f 6c73 203d 2063 6f6c 735f      cols = cols_
+00003de0: 6c69 7374 5b70 695d 0a20 2020 2020 2020  list[pi].       
+00003df0: 2073 6861 7065 203d 2073 6861 7065 5f6c   shape = shape_l
+00003e00: 6973 745b 7069 5d0a 2020 2020 2020 2020  ist[pi].        
+00003e10: 6e5f 726f 7773 203d 206e 5f72 6f77 735f  n_rows = n_rows_
+00003e20: 6c69 7374 5b70 695d 0a20 2020 2020 2020  list[pi].       
+00003e30: 206e 5f72 6f77 735f 7365 6c20 3d20 6e5f   n_rows_sel = n_
+00003e40: 726f 7773 5f73 656c 5f6c 6973 745b 7069  rows_sel_list[pi
+00003e50: 5d0a 2020 2020 2020 2020 6e5f 636f 6c73  ].        n_cols
+00003e60: 5f73 656c 203d 206e 5f63 6f6c 735f 7365  _sel = n_cols_se
+00003e70: 6c5f 6c69 7374 5b70 695d 0a0a 2020 2020  l_list[pi]..    
+00003e80: 2020 2020 2320 6261 7463 685f 7369 7a65      # batch_size
+00003e90: 0a20 2020 2020 2020 2069 6620 6261 7463  .        if batc
+00003ea0: 685f 7369 7a65 2069 7320 4e6f 6e65 206f  h_size is None o
+00003eb0: 7220 6261 7463 685f 7369 7a65 203d 3d20  r batch_size == 
+00003ec0: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+00003ed0: 7369 7a65 5f6f 6e65 5f72 6f77 203d 2028  size_one_row = (
+00003ee0: 6e70 2e70 726f 6428 7368 6170 655b 313a  np.prod(shape[1:
+00003ef0: 5d29 202a 2028 3820 6966 2027 3634 2720  ]) * (8 if '64' 
+00003f00: 696e 2064 7479 7065 2065 6c73 6520 3429  in dtype else 4)
+00003f10: 290a 2020 2020 2020 2020 2020 2020 6261  ).            ba
+00003f20: 7463 685f 7369 7a65 203d 2069 6e74 2862  tch_size = int(b
+00003f30: 6c6f 636b 5f73 697a 6520 2f20 7369 7a65  lock_size / size
+00003f40: 5f6f 6e65 5f72 6f77 290a 0a20 2020 2020  _one_row)..     
+00003f50: 2020 2069 6620 7665 7262 6f73 6520 3e3d     if verbose >=
+00003f60: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+00003f70: 7072 696e 7428 6627 5b2b 5d20 6461 7461  print(f'[+] data
+00003f80: 5f61 6c6c 5f7b 7069 3a30 3264 7d20 3d20  _all_{pi:02d} = 
+00003f90: 7b73 6861 7065 7d2c 206d 656d 203d 207b  {shape}, mem = {
+00003fa0: 6e70 2e70 726f 6428 7368 6170 6529 202a  np.prod(shape) *
+00003fb0: 2034 3a2c 2e30 667d 2729 0a20 2020 2020   4:,.0f}').     
+00003fc0: 2020 2020 2020 2070 7269 6e74 2866 2720         print(f' 
+00003fd0: 2020 2064 6174 615f 7365 6c5f 7b70 693a     data_sel_{pi:
+00003fe0: 3032 647d 203d 207b 286e 5f72 6f77 735f  02d} = {(n_rows_
+00003ff0: 7365 6c2c 206e 5f63 6f6c 735f 7365 6c29  sel, n_cols_sel)
+00004000: 7d2c 206d 656d 203d 207b 6e5f 726f 7773  }, mem = {n_rows
+00004010: 5f73 656c 202a 206e 5f63 6f6c 735f 7365  _sel * n_cols_se
+00004020: 6c20 2a20 343a 2c2e 3066 7d27 290a 2020  l * 4:,.0f}').  
+00004030: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00004040: 6627 2020 2020 626c 6f63 6b5f 7369 7a65  f'    block_size
+00004050: 2020 3d20 7b62 6c6f 636b 5f73 697a 653a    = {block_size:
+00004060: 2c2e 3066 7d20 3d20 7b62 6174 6368 5f73  ,.0f} = {batch_s
+00004070: 697a 653a 2c2e 3066 7d20 2a20 7b73 697a  ize:,.0f} * {siz
+00004080: 655f 6f6e 655f 726f 773a 2e30 667d 2729  e_one_row:.0f}')
+00004090: 0a0a 2020 2020 2020 2020 2320 6c6f 6164  ..        # load
+000040a0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+000040b0: 6f73 6520 3e3d 2031 3a20 7267 203d 2074  ose >= 1: rg = t
+000040c0: 7164 6d28 7261 6e67 6528 302c 206e 5f72  qdm(range(0, n_r
+000040d0: 6f77 732c 2062 6174 6368 5f73 697a 6529  ows, batch_size)
+000040e0: 2c20 6465 7363 3d66 2772 7a5f 6c6f 6164  , desc=f'rz_load
+000040f0: 5f6e 7079 5f69 6478 5f6d 756c 7469 2829  _npy_idx_multi()
+00004100: 272c 206e 636f 6c73 3d31 3030 2c20 6173  ', ncols=100, as
+00004110: 6369 693d 5472 7565 290a 2020 2020 2020  cii=True).      
+00004120: 2020 656c 7365 3a20 7267 203d 2072 616e    else: rg = ran
+00004130: 6765 2830 2c20 6e5f 726f 7773 2c20 6261  ge(0, n_rows, ba
+00004140: 7463 685f 7369 7a65 290a 0a20 2020 2020  tch_size)..     
+00004150: 2020 2066 6f72 2069 2069 6e20 7267 3a0a     for i in rg:.
+00004160: 2020 2020 2020 2020 2020 2020 7031 2c20              p1, 
+00004170: 7032 203d 2069 2c20 6d69 6e28 6e5f 726f  p2 = i, min(n_ro
+00004180: 7773 2c20 6920 2b20 6261 7463 685f 7369  ws, i + batch_si
+00004190: 7a65 290a 2020 2020 2020 2020 2020 2020  ze).            
+000041a0: 5f70 3120 3d20 7031 202a 2069 6e74 286e  _p1 = p1 * int(n
+000041b0: 702e 7072 6f64 2873 6861 7065 5b31 3a2d  p.prod(shape[1:-
+000041c0: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
+000041d0: 205f 7032 203d 2070 3220 2a20 696e 7428   _p2 = p2 * int(
+000041e0: 6e70 2e70 726f 6428 7368 6170 655b 313a  np.prod(shape[1:
+000041f0: 2d31 5d29 290a 0a20 2020 2020 2020 2020  -1]))..         
+00004200: 2020 2069 6620 6964 7820 6973 206e 6f74     if idx is not
+00004210: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00004220: 2020 2020 2020 2069 6478 5f73 656c 203d         idx_sel =
+00004230: 206e 702e 7768 6572 6528 285f 7031 203c   np.where((_p1 <
+00004240: 3d20 6964 7829 2026 2028 6964 7820 3c20  = idx) & (idx < 
+00004250: 5f70 3229 295b 305d 0a20 2020 2020 2020  _p2))[0].       
+00004260: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00004270: 6964 785f 7365 6c29 203d 3d20 303a 2063  idx_sel) == 0: c
+00004280: 6f6e 7469 6e75 650a 0a20 2020 2020 2020  ontinue..       
+00004290: 2020 2020 2020 2020 2061 203d 2072 7a5f           a = rz_
+000042a0: 6c6f 6164 5f6e 7079 2870 6174 682c 2073  load_npy(path, s
+000042b0: 7461 7274 203d 2070 312c 2065 6e64 203d  tart = p1, end =
+000042c0: 2070 322c 2063 6f6c 7320 3d20 636f 6c73   p2, cols = cols
+000042d0: 2c20 7573 655f 6e75 6d62 6120 3d20 7573  , use_numba = us
+000042e0: 655f 6e75 6d62 612c 206e 5f6a 6f62 7320  e_numba, n_jobs 
+000042f0: 3d20 6e5f 6a6f 6273 2c20 6b74 696d 6573  = n_jobs, ktimes
+00004300: 203d 206b 7469 6d65 7329 2e72 6573 6861   = ktimes).resha
+00004310: 7065 282d 312c 206e 5f63 6f6c 735f 7365  pe(-1, n_cols_se
+00004320: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
+00004330: 2020 2069 6478 5f61 203d 2069 6478 5b69     idx_a = idx[i
+00004340: 6478 5f73 656c 5d20 2d20 5f70 310a 0a20  dx_sel] - _p1.. 
+00004350: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00004360: 312c 2063 3220 3d20 696e 7428 6e70 2e73  1, c2 = int(np.s
+00004370: 756d 286e 5f63 6f6c 735f 7365 6c5f 6c69  um(n_cols_sel_li
+00004380: 7374 5b3a 7069 5d29 292c 2069 6e74 286e  st[:pi])), int(n
+00004390: 702e 7375 6d28 6e5f 636f 6c73 5f73 656c  p.sum(n_cols_sel
+000043a0: 5f6c 6973 745b 3a70 6920 2b20 315d 2929  _list[:pi + 1]))
+000043b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000043c0: 206e 705f 7365 745f 6964 785f 636f 6c73   np_set_idx_cols
+000043d0: 2864 6174 612c 2069 6478 5f73 656c 2c20  (data, idx_sel, 
+000043e0: 6e70 2e61 7261 6e67 6528 6331 2c20 6332  np.arange(c1, c2
+000043f0: 292c 206e 705f 6765 7428 612c 2069 6478  ), np_get(a, idx
+00004400: 5f61 2c20 6178 6973 203d 2030 2929 0a20  _a, axis = 0)). 
+00004410: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
 00004420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004430: 2063 312c 2063 3220 3d20 696e 7428 6e70   c1, c2 = int(np
-00004440: 2e73 756d 286e 5f63 6f6c 735f 7365 6c5f  .sum(n_cols_sel_
-00004450: 6c69 7374 5b3a 7069 5d29 292c 2069 6e74  list[:pi])), int
-00004460: 286e 702e 7375 6d28 6e5f 636f 6c73 5f73  (np.sum(n_cols_s
-00004470: 656c 5f6c 6973 745b 3a70 6920 2b20 315d  el_list[:pi + 1]
-00004480: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00004490: 2020 206e 705f 7365 745f 6964 785f 636f     np_set_idx_co
-000044a0: 6c73 2864 6174 612c 206e 702e 6172 616e  ls(data, np.aran
-000044b0: 6765 285f 7031 2c20 5f70 3229 2c20 6e70  ge(_p1, _p2), np
-000044c0: 2e61 7261 6e67 6528 6331 2c20 6332 292c  .arange(c1, c2),
-000044d0: 2061 290a 2020 2020 2020 2020 6763 2e63   a).        gc.c
-000044e0: 6f6c 6c65 6374 2829 0a20 2020 2072 6574  ollect().    ret
-000044f0: 7572 6e20 6461 7461 0a0a 2320 3d3d 3d3d  urn data..# ====
-00004500: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00004510: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 646d 2074  ==========  dm t
-00004520: 6f20 6d64 6e70 7920 3d3d 3d3d 3d3d 3d3d  o mdnpy ========
-00004530: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00004540: 3d3d 3d3d 3d3d 0a64 6566 205f 746f 5f6e  ======.def _to_n
-00004550: 756d 7079 2864 662c 2063 6f6c 732c 206b  umpy(df, cols, k
-00004560: 203d 2032 302c 2076 6572 626f 7365 203d   = 20, verbose =
-00004570: 2046 616c 7365 293a 0a20 2020 2061 203d   False):.    a =
-00004580: 206e 702e 7a65 726f 7328 286c 656e 2864   np.zeros((len(d
-00004590: 6629 2c20 6c65 6e28 636f 6c73 2929 2c20  f), len(cols)), 
-000045a0: 6474 7970 6520 3d20 6e70 2e66 6c6f 6174  dtype = np.float
-000045b0: 3332 290a 2020 2020 6369 6a20 3d20 6c69  32).    cij = li
-000045c0: 7374 2872 616e 6765 2830 2c20 6c65 6e28  st(range(0, len(
-000045d0: 636f 6c73 292c 206b 2929 0a20 2020 2063  cols), k)).    c
-000045e0: 696a 202b 3d20 5b6c 656e 2863 6f6c 7329  ij += [len(cols)
-000045f0: 5d20 6966 2063 696a 5b2d 315d 2021 3d20  ] if cij[-1] != 
-00004600: 6c65 6e28 636f 6c73 2920 656c 7365 205b  len(cols) else [
-00004610: 5d0a 2020 2020 7267 203d 2074 7164 6d28  ].    rg = tqdm(
-00004620: 7261 6e67 6528 6c65 6e28 6369 6a29 202d  range(len(cij) -
-00004630: 2031 292c 206e 636f 6c73 3d31 3030 2c20   1), ncols=100, 
-00004640: 6173 6369 693d 5472 7565 2920 6966 2076  ascii=True) if v
-00004650: 6572 626f 7365 2065 6c73 6520 7261 6e67  erbose else rang
-00004660: 6528 6c65 6e28 6369 6a29 202d 2031 290a  e(len(cij) - 1).
-00004670: 2020 2020 666f 7220 6920 696e 2072 673a      for i in rg:
-00004680: 0a20 2020 2020 2020 2063 692c 2063 6a20  .        ci, cj 
-00004690: 3d20 6369 6a5b 695d 2c20 6369 6a5b 6920  = cij[i], cij[i 
-000046a0: 2b20 315d 0a20 2020 2020 2020 2061 5b3a  + 1].        a[:
-000046b0: 2c20 6369 3a20 636a 5d20 3d20 6466 5b63  , ci: cj] = df[c
-000046c0: 6f6c 735b 6369 3a20 636a 5d5d 2e74 6f5f  ols[ci: cj]].to_
-000046d0: 6e75 6d70 7928 290a 2020 2020 7265 7475  numpy().    retu
-000046e0: 726e 2061 2020 2020 200a 0a64 6566 2067  rn a     ..def g
-000046f0: 6574 5f64 665f 6964 5f61 6c6c 2869 645f  et_df_id_all(id_
-00004700: 6c69 7374 2c20 636f 6c73 5f69 6420 3d20  list, cols_id = 
-00004710: 4e6f 6e65 2c20 6d65 7468 6f64 203d 2027  None, method = '
-00004720: 7064 2729 3a0a 2020 2020 5c27 5c27 5c27  pd'):.    \'\'\'
-00004730: 0a20 2020 2064 665f 6964 203d 2072 7a2e  .    df_id = rz.
-00004740: 7574 696c 2e6e 7079 2e67 6574 5f64 665f  util.npy.get_df_
-00004750: 6964 5f61 6c6c 285b 6e70 2e61 7261 6e67  id_all([np.arang
-00004760: 6528 7829 2e61 7374 7970 6528 6e70 2e69  e(x).astype(np.i
-00004770: 6e74 3332 2920 666f 7220 7820 696e 2073  nt32) for x in s
-00004780: 6861 7065 5d2c 2063 6f6c 735f 6964 203d  hape], cols_id =
-00004790: 205b 2764 6174 6527 2c20 2774 6964 272c   ['date', 'tid',
-000047a0: 2027 6964 275d 290a 2020 2020 5c27 5c27   'id']).    \'\'
-000047b0: 5c27 0a20 2020 2069 6620 636f 6c73 5f69  \'.    if cols_i
-000047c0: 6420 6973 204e 6f6e 653a 2063 6f6c 735f  d is None: cols_
-000047d0: 6964 203d 205b 6627 787b 697d 2720 666f  id = [f'x{i}' fo
-000047e0: 7220 6920 696e 206c 656e 2869 645f 6c69  r i in len(id_li
-000047f0: 7374 295d 0a20 2020 2069 6620 6d65 7468  st)].    if meth
-00004800: 6f64 203d 3d20 2770 6427 3a0a 2020 2020  od == 'pd':.    
-00004810: 2020 2020 6466 5f69 645f 616c 6c20 3d20      df_id_all = 
-00004820: 7064 2e4d 756c 7469 496e 6465 782e 6672  pd.MultiIndex.fr
-00004830: 6f6d 5f70 726f 6475 6374 2869 645f 6c69  om_product(id_li
-00004840: 7374 292e 746f 5f66 7261 6d65 2829 2e72  st).to_frame().r
-00004850: 6573 6574 5f69 6e64 6578 2864 726f 7020  eset_index(drop 
-00004860: 3d20 5472 7565 290a 2020 2020 2020 2020  = True).        
-00004870: 6466 5f69 645f 616c 6c2e 636f 6c75 6d6e  df_id_all.column
-00004880: 7320 3d20 636f 6c73 5f69 640a 2020 2020  s = cols_id.    
-00004890: 656c 6966 206d 6574 686f 6420 3d3d 2027  elif method == '
-000048a0: 706c 273a 0a20 2020 2020 2020 2073 6861  pl':.        sha
-000048b0: 7065 203d 205b 6c65 6e28 7829 2066 6f72  pe = [len(x) for
-000048c0: 2078 2069 6e20 6964 5f6c 6973 745d 0a20   x in id_list]. 
-000048d0: 2020 2020 2020 2064 665f 6964 5f61 6c6c         df_id_all
-000048e0: 203d 2070 6c2e 4461 7461 4672 616d 6528   = pl.DataFrame(
-000048f0: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-00004900: 696e 2072 616e 6765 286c 656e 2873 6861  in range(len(sha
-00004910: 7065 2929 3a0a 2020 2020 2020 2020 2020  pe)):.          
-00004920: 2020 7820 3d20 6964 5f6c 6973 745b 695d    x = id_list[i]
-00004930: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00004940: 6920 2b20 3120 3c20 6c65 6e28 7368 6170  i + 1 < len(shap
-00004950: 6529 3a20 7820 3d20 6e70 2e72 6570 6561  e): x = np.repea
-00004960: 7428 782c 206e 702e 7072 6f64 2873 6861  t(x, np.prod(sha
-00004970: 7065 5b69 202b 2031 3a5d 2929 0a20 2020  pe[i + 1:])).   
-00004980: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-00004990: 6e20 7261 6e67 6528 6920 2d20 312c 202d  n range(i - 1, -
-000049a0: 312c 202d 3129 3a20 7820 3d20 6e70 2e74  1, -1): x = np.t
-000049b0: 696c 6528 782c 2073 6861 7065 5b6a 5d29  ile(x, shape[j])
-000049c0: 0a20 2020 2020 2020 2020 2020 2064 665f  .            df_
-000049d0: 6964 5f61 6c6c 203d 2064 665f 6964 5f61  id_all = df_id_a
-000049e0: 6c6c 2e77 6974 685f 636f 6c75 6d6e 7328  ll.with_columns(
-000049f0: 706c 2e53 6572 6965 7328 7374 7228 636f  pl.Series(str(co
-00004a00: 6c73 5f69 645b 695d 292c 2078 2929 0a20  ls_id[i]), x)). 
-00004a10: 2020 2072 6574 7572 6e20 6466 5f69 645f     return df_id_
-00004a20: 616c 6c0a 0a23 2040 7072 6f66 696c 6528  all..# @profile(
-00004a30: 2920 200a 6465 6620 746f 5f6d 646e 7079  )  .def to_mdnpy
-00004a40: 2864 6d5f 6469 6374 2c20 636f 6c73 5f69  (dm_dict, cols_i
-00004a50: 642c 2063 6f6c 735f 6461 7461 2c20 636f  d, cols_data, co
-00004a60: 6c73 5f6d 6173 6b2c 2069 645f 6c69 7374  ls_mask, id_list
-00004a70: 203d 204e 6f6e 652c 2066 7265 655f 7261   = None, free_ra
-00004a80: 7720 3d20 4661 6c73 6529 3a0a 2020 2020  w = False):.    
-00004a90: 5c27 5c27 5c27 0a20 2020 2064 6d5f 6469  \'\'\'.    dm_di
-00004aa0: 6374 203d 207b 2764 6d27 3a20 646d 7d0a  ct = {'dm': dm}.
-00004ab0: 2020 2020 6465 6c20 646d 3b20 6763 2e63      del dm; gc.c
-00004ac0: 6f6c 6c65 6374 2829 0a0a 2020 2020 636f  ollect()..    co
-00004ad0: 6c73 5f69 6420 3d20 5b63 6f6c 5f64 6174  ls_id = [col_dat
-00004ae0: 652c 2063 6f6c 5f69 645d 0a20 2020 2063  e, col_id].    c
-00004af0: 6f6c 735f 6d61 736b 203d 205b 2774 7261  ols_mask = ['tra
-00004b00: 696e 272c 2027 7465 7374 272c 2027 7661  in', 'test', 'va
-00004b10: 6c69 6427 2c20 2761 6c6c 272c 2027 7a64  lid', 'all', 'zd
-00004b20: 7427 5d0a 2020 2020 636f 6c73 5f64 6174  t'].    cols_dat
-00004b30: 6120 3d20 5b63 6f6c 5f6c 6162 656c 5d20  a = [col_label] 
-00004b40: 2b20 636f 6c73 5f66 6561 0a0a 2020 2020  + cols_fea..    
-00004b50: 6466 5f69 6420 3d20 646d 5f64 6963 745b  df_id = dm_dict[
-00004b60: 2764 6d27 5d2e 6765 745f 636f 6c73 5f70  'dm'].get_cols_p
-00004b70: 616e 6461 7328 636f 6c73 5f69 6429 0a20  andas(cols_id). 
-00004b80: 2020 2069 645f 6c69 7374 203d 205b 736f     id_list = [so
-00004b90: 7274 6564 2864 665f 6964 5b63 6f6c 5d2e  rted(df_id[col].
-00004ba0: 756e 6971 7565 2829 2920 666f 7220 636f  unique()) for co
-00004bb0: 6c20 696e 2063 6f6c 735f 6964 5d0a 2020  l in cols_id].  
-00004bc0: 2020 6964 5f6c 6973 745b 305d 203d 2069    id_list[0] = i
-00004bd0: 645f 6c69 7374 5b30 5d23 5b3a 3530 305d  d_list[0]#[:500]
-00004be0: 0a0a 2020 2020 615f 6461 7461 2c20 615f  ..    a_data, a_
-00004bf0: 6d61 736b 2c20 6964 5f6c 6973 745f 7265  mask, id_list_re
-00004c00: 7420 3d20 5c0a 2020 2020 2020 2020 746f  t = \.        to
-00004c10: 5f6d 646e 7079 2864 6d5f 6469 6374 2c20  _mdnpy(dm_dict, 
-00004c20: 636f 6c73 5f69 642c 2063 6f6c 735f 6461  cols_id, cols_da
-00004c30: 7461 2c20 636f 6c73 5f6d 6173 6b2c 2069  ta, cols_mask, i
-00004c40: 645f 6c69 7374 203d 2069 645f 6c69 7374  d_list = id_list
-00004c50: 2c20 6672 6565 5f72 6177 203d 2046 616c  , free_raw = Fal
-00004c60: 7365 290a 2020 2020 5c27 5c27 5c27 0a20  se).    \'\'\'. 
-00004c70: 2020 2064 6d20 3d20 646d 5f64 6963 745b     dm = dm_dict[
-00004c80: 2764 6d27 5d0a 2020 2020 666f 7220 636f  'dm'].    for co
-00004c90: 6c20 696e 2063 6f6c 735f 6d61 736b 3a0a  l in cols_mask:.
-00004ca0: 2020 2020 2020 2020 646d 2e73 6574 5f62          dm.set_b
-00004cb0: 795f 636f 6c28 6627 4d41 534b 5f7b 636f  y_col(f'MASK_{co
-00004cc0: 6c7d 272c 2064 6d2e 6d61 736b 6572 2e6d  l}', dm.masker.m
-00004cd0: 6173 6b5f 4449 4354 5b63 6f6c 5d2e 6173  ask_DICT[col].as
-00004ce0: 7479 7065 286e 702e 696e 7433 3229 290a  type(np.int32)).
-00004cf0: 2020 2020 636f 6c73 5f6d 6173 6b20 3d20      cols_mask = 
-00004d00: 5b66 274d 4153 4b5f 7b63 6f6c 7d27 2066  [f'MASK_{col}' f
-00004d10: 6f72 2063 6f6c 2069 6e20 636f 6c73 5f6d  or col in cols_m
-00004d20: 6173 6b5d 0a20 2020 200a 2020 2020 2320  ask].    .    # 
-00004d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2064 665f 6964  ---------- df_id
-00004d40: 5f61 6c6c 202d 2d2d 2d2d 2d2d 2d2d 2d0a  _all ----------.
-00004d50: 2020 2020 6466 5f69 6420 3d20 646d 2e67      df_id = dm.g
-00004d60: 6574 5f63 6f6c 735f 7061 6e64 6173 2863  et_cols_pandas(c
-00004d70: 6f6c 735f 6964 290a 2020 2020 6966 2069  ols_id).    if i
-00004d80: 645f 6c69 7374 2069 7320 4e6f 6e65 3a0a  d_list is None:.
-00004d90: 2020 2020 2020 2020 6964 5f6c 6973 7420          id_list 
-00004da0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-00004db0: 2063 6f6c 2069 6e20 636f 6c73 5f69 643a   col in cols_id:
-00004dc0: 0a20 2020 2020 2020 2020 2020 2069 645f  .            id_
-00004dd0: 6c69 7374 2e61 7070 656e 6428 736f 7274  list.append(sort
-00004de0: 6564 2864 665f 6964 5b63 6f6c 5d2e 756e  ed(df_id[col].un
-00004df0: 6971 7565 2829 2929 0a20 2020 2073 6861  ique())).    sha
-00004e00: 7065 203d 205b 6c65 6e28 7829 2066 6f72  pe = [len(x) for
-00004e10: 2078 2069 6e20 6964 5f6c 6973 745d 0a20   x in id_list]. 
-00004e20: 2020 2064 665f 6964 5f61 6c6c 203d 2070     df_id_all = p
-00004e30: 642e 4d75 6c74 6949 6e64 6578 2e66 726f  d.MultiIndex.fro
-00004e40: 6d5f 7072 6f64 7563 7428 6964 5f6c 6973  m_product(id_lis
-00004e50: 7429 2e74 6f5f 6672 616d 6528 292e 7265  t).to_frame().re
-00004e60: 7365 745f 696e 6465 7828 6472 6f70 203d  set_index(drop =
-00004e70: 2054 7275 6529 0a20 2020 2064 665f 6964   True).    df_id
-00004e80: 5f61 6c6c 2e63 6f6c 756d 6e73 203d 2063  _all.columns = c
-00004e90: 6f6c 735f 6964 0a20 2020 2064 665f 6964  ols_id.    df_id
-00004ea0: 5f61 6c6c 203d 2064 665f 6964 5f61 6c6c  _all = df_id_all
-00004eb0: 2e61 7374 7970 6528 6466 5f69 642e 6474  .astype(df_id.dt
-00004ec0: 7970 6573 2e74 6f5f 6469 6374 2829 290a  ypes.to_dict()).
-00004ed0: 2020 2020 6466 5f69 645f 616c 6c20 3d20      df_id_all = 
-00004ee0: 706c 2e44 6174 6146 7261 6d65 2864 665f  pl.DataFrame(df_
-00004ef0: 6964 5f61 6c6c 290a 2020 2020 2320 7072  id_all).    # pr
-00004f00: 696e 7428 275b 2b5d 2064 665f 6964 5f61  int('[+] df_id_a
-00004f10: 6c6c 2729 0a20 2020 2023 2067 6574 5f6d  ll').    # get_m
-00004f20: 656d 5f63 7572 2829 3b20 6765 745f 6d65  em_cur(); get_me
-00004f30: 6d5f 6d61 7828 290a 2020 2020 0a20 2020  m_max().    .   
-00004f40: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d20 6a6f   # ---------- jo
-00004f50: 696e 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  in ----------.  
-00004f60: 2020 6466 5f76 5f6f 7269 6769 6e20 3d20    df_v_origin = 
-00004f70: 646d 2e67 6574 5f63 6f6c 735f 706f 6c61  dm.get_cols_pola
-00004f80: 7273 2863 6f6c 735f 6964 202b 2063 6f6c  rs(cols_id + col
-00004f90: 735f 6461 7461 202b 2063 6f6c 735f 6d61  s_data + cols_ma
-00004fa0: 736b 290a 2020 2020 6465 6c20 646d 3b20  sk).    del dm; 
-00004fb0: 6763 2e63 6f6c 6c65 6374 2829 0a20 2020  gc.collect().   
-00004fc0: 2069 6620 6672 6565 5f72 6177 3a20 0a20   if free_raw: . 
-00004fd0: 2020 2020 2020 2064 656c 2064 6d5f 6469         del dm_di
-00004fe0: 6374 5b27 646d 275d 3b20 6763 2e63 6f6c  ct['dm']; gc.col
-00004ff0: 6c65 6374 2829 0a20 2020 2064 665f 7620  lect().    df_v 
-00005000: 3d20 6466 5f69 645f 616c 6c2e 6a6f 696e  = df_id_all.join
-00005010: 2864 665f 765f 6f72 6967 696e 2c20 6f6e  (df_v_origin, on
-00005020: 203d 2063 6f6c 735f 6964 2c20 686f 7720   = cols_id, how 
-00005030: 3d20 276c 6566 7427 290a 2020 2020 666f  = 'left').    fo
-00005040: 7220 636f 6c20 696e 2064 665f 765f 6f72  r col in df_v_or
-00005050: 6967 696e 2e63 6f6c 756d 6e73 3a20 6466  igin.columns: df
-00005060: 5f76 5f6f 7269 6769 6e2e 6472 6f70 5f69  _v_origin.drop_i
-00005070: 6e5f 706c 6163 6528 636f 6c29 0a20 2020  n_place(col).   
-00005080: 2064 656c 2064 665f 765f 6f72 6967 696e   del df_v_origin
-00005090: 3b20 6763 2e63 6f6c 6c65 6374 2829 0a20  ; gc.collect(). 
-000050a0: 2020 2023 2070 7269 6e74 2827 5b2b 5d20     # print('[+] 
-000050b0: 6a6f 696e 2729 0a20 2020 2023 2067 6574  join').    # get
-000050c0: 5f6d 656d 5f63 7572 2829 3b20 6765 745f  _mem_cur(); get_
-000050d0: 6d65 6d5f 6d61 7828 290a 2020 2020 6465  mem_max().    de
-000050e0: 6c20 6466 5f69 645f 616c 6c3b 2067 632e  l df_id_all; gc.
-000050f0: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
-00005100: 2020 0a20 2020 2023 202d 2d2d 2d2d 2d2d    .    # -------
-00005110: 2d2d 2d20 746f 5f66 6c6f 6174 3332 202d  --- to_float32 -
-00005120: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2320  ---------.    # 
-00005130: 666f 7220 636f 6c20 696e 2074 7164 6d28  for col in tqdm(
-00005140: 636f 6c73 5f64 6174 6120 2b20 636f 6c73  cols_data + cols
-00005150: 5f6d 6173 6b2c 2064 6573 6320 3d20 2774  _mask, desc = 't
-00005160: 6f5f 666c 6f61 7433 3227 293a 0a20 2020  o_float32'):.   
-00005170: 2066 6f72 2063 6f6c 2069 6e20 636f 6c73   for col in cols
-00005180: 5f64 6174 6120 2b20 636f 6c73 5f6d 6173  _data + cols_mas
-00005190: 6b3a 0a20 2020 2020 2020 2074 7970 655f  k:.        type_
-000051a0: 6f6c 6420 3d20 7374 7228 6466 5f76 5b63  old = str(df_v[c
-000051b0: 6f6c 5d2e 6474 7970 6529 2e6c 6f77 6572  ol].dtype).lower
-000051c0: 2829 0a20 2020 2020 2020 2069 6620 2766  ().        if 'f
-000051d0: 6c6f 6174 3332 2720 6e6f 7420 696e 2074  loat32' not in t
-000051e0: 7970 655f 6f6c 6420 616e 6420 2766 3332  ype_old and 'f32
-000051f0: 2720 6e6f 7420 696e 2074 7970 655f 6f6c  ' not in type_ol
-00005200: 643a 0a20 2020 2020 2020 2020 2020 2064  d:.            d
-00005210: 665f 7620 3d20 6466 5f76 2e77 6974 685f  f_v = df_v.with_
-00005220: 636f 6c75 6d6e 7328 6466 5f76 5b63 6f6c  columns(df_v[col
-00005230: 5d2e 6361 7374 2870 6c2e 6461 7461 7479  ].cast(pl.dataty
-00005240: 7065 732e 466c 6f61 7433 3229 290a 2020  pes.Float32)).  
-00005250: 2020 2320 7072 696e 7428 7064 2e53 6572    # print(pd.Ser
-00005260: 6965 7328 6466 5f76 5b63 6f6c 735f 6461  ies(df_v[cols_da
-00005270: 7461 5d2e 6474 7970 6573 292e 7661 6c75  ta].dtypes).valu
-00005280: 655f 636f 756e 7473 2829 2920 2020 2020  e_counts())     
-00005290: 2020 200a 2020 2020 2320 7072 696e 7428     .    # print(
-000052a0: 275b 2b5d 2074 6f5f 666c 6f61 7433 3227  '[+] to_float32'
-000052b0: 290a 2020 2020 2320 6765 745f 6d65 6d5f  ).    # get_mem_
-000052c0: 6375 7228 293b 2067 6574 5f6d 656d 5f6d  cur(); get_mem_m
-000052d0: 6178 2829 0a20 2020 200a 2020 2020 2320  ax().    .    # 
-000052e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2074 6f5f 6e75  ---------- to_nu
-000052f0: 6d70 7920 616e 6420 7265 7368 6170 6520  mpy and reshape 
-00005300: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2023  ----------.    #
-00005310: 200a 2020 2020 615f 6d61 736b 203d 204e   .    a_mask = N
-00005320: 6f6e 650a 2020 2020 6966 206c 656e 2863  one.    if len(c
-00005330: 6f6c 735f 6d61 736b 2920 3e20 303a 0a20  ols_mask) > 0:. 
-00005340: 2020 2020 2020 2061 5f6d 6173 6b20 3d20         a_mask = 
-00005350: 5f74 6f5f 6e75 6d70 7928 6466 5f76 2c20  _to_numpy(df_v, 
-00005360: 636f 6c73 5f6d 6173 6b29 0a20 2020 2020  cols_mask).     
-00005370: 2020 2061 5f6d 6173 6b20 3d20 615f 6d61     a_mask = a_ma
-00005380: 736b 2e72 6573 6861 7065 2828 2a73 6861  sk.reshape((*sha
-00005390: 7065 2c20 6c65 6e28 636f 6c73 5f6d 6173  pe, len(cols_mas
-000053a0: 6b29 2929 0a20 2020 2020 2020 2061 5f6d  k))).        a_m
-000053b0: 6173 6b20 3d20 6e70 2e61 7363 6f6e 7469  ask = np.asconti
-000053c0: 6775 6f75 7361 7272 6179 2861 5f6d 6173  guousarray(a_mas
-000053d0: 6b29 0a20 2020 2020 2020 200a 2020 2020  k).        .    
-000053e0: 615f 6461 7461 203d 205f 746f 5f6e 756d  a_data = _to_num
-000053f0: 7079 2864 665f 762c 2063 6f6c 735f 6461  py(df_v, cols_da
-00005400: 7461 290a 2020 2020 666f 7220 636f 6c20  ta).    for col 
-00005410: 696e 2064 665f 762e 636f 6c75 6d6e 733a  in df_v.columns:
-00005420: 2064 665f 762e 6472 6f70 5f69 6e5f 706c   df_v.drop_in_pl
-00005430: 6163 6528 636f 6c29 0a20 2020 2064 656c  ace(col).    del
-00005440: 2064 665f 763b 2067 632e 636f 6c6c 6563   df_v; gc.collec
-00005450: 7428 2920 200a 2020 2020 615f 6461 7461  t()  .    a_data
-00005460: 203d 2061 5f64 6174 612e 7265 7368 6170   = a_data.reshap
-00005470: 6528 282a 7368 6170 652c 206c 656e 2863  e((*shape, len(c
-00005480: 6f6c 735f 6461 7461 2929 290a 2020 2020  ols_data))).    
-00005490: 615f 6461 7461 203d 206e 702e 6173 636f  a_data = np.asco
-000054a0: 6e74 6967 756f 7573 6172 7261 7928 615f  ntiguousarray(a_
-000054b0: 6461 7461 2920 2020 200a 2020 2020 7265  data)    .    re
-000054c0: 7475 726e 2061 5f64 6174 612c 2061 5f6d  turn a_data, a_m
-000054d0: 6173 6b2c 2069 645f 6c69 7374 0a0a 0a23  ask, id_list...#
-000054e0: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d   ===============
-000054f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d20  =============== 
-00005500: 2074 6f5f 6d64 6e70 795f 616e 645f 6475   to_mdnpy_and_du
-00005510: 6d70 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  mp =============
-00005520: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00005530: 3d0a 6465 6620 746f 5f6d 646e 7079 5f61  =.def to_mdnpy_a
-00005540: 6e64 5f64 756d 7028 646d 5f64 6963 742c  nd_dump(dm_dict,
-00005550: 2063 6f6c 735f 6964 2c20 636f 6c73 5f64   cols_id, cols_d
-00005560: 6174 612c 2063 6f6c 735f 6d61 736b 2c20  ata, cols_mask, 
-00005570: 6964 5f6c 6973 7420 3d20 4e6f 6e65 2c0a  id_list = None,.
-00005580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005590: 2020 2020 2020 7061 7468 203d 2027 2e2f        path = './
-000055a0: 272c 2062 6174 6368 5f73 697a 6520 3d20  ', batch_size = 
-000055b0: 3130 302c 2076 6572 626f 7365 203d 2046  100, verbose = F
-000055c0: 616c 7365 2c20 6461 7461 5f6e 616d 6520  alse, data_name 
-000055d0: 3d20 2764 6174 612e 6e70 7927 293a 0a20  = 'data.npy'):. 
-000055e0: 2020 2022 2222 0a20 2020 2064 6d5f 6469     """.    dm_di
-000055f0: 6374 203d 207b 2764 6d27 3a20 646d 7d0a  ct = {'dm': dm}.
-00005600: 2020 2020 6465 6c20 646d 3b20 6763 2e63      del dm; gc.c
-00005610: 6f6c 6c65 6374 2829 0a0a 2020 2020 636f  ollect()..    co
-00005620: 6c73 5f69 6420 3d20 5b63 6f6c 5f64 6174  ls_id = [col_dat
-00005630: 652c 2063 6f6c 5f69 645d 0a20 2020 2063  e, col_id].    c
-00005640: 6f6c 735f 6d61 736b 203d 205b 2774 7261  ols_mask = ['tra
-00005650: 696e 272c 2027 7465 7374 272c 2027 7661  in', 'test', 'va
-00005660: 6c69 6427 2c20 2761 6c6c 272c 2027 7a64  lid', 'all', 'zd
-00005670: 7427 5d0a 2020 2020 636f 6c73 5f64 6174  t'].    cols_dat
-00005680: 6120 3d20 5b63 6f6c 5f6c 6162 656c 5d20  a = [col_label] 
-00005690: 2b20 636f 6c73 5f66 6561 0a0a 2020 2020  + cols_fea..    
-000056a0: 6466 5f69 6420 3d20 646d 5f64 6963 745b  df_id = dm_dict[
-000056b0: 2764 6d27 5d2e 6765 745f 636f 6c73 5f70  'dm'].get_cols_p
-000056c0: 616e 6461 7328 636f 6c73 5f69 6429 0a20  andas(cols_id). 
-000056d0: 2020 2069 645f 6c69 7374 203d 205b 736f     id_list = [so
-000056e0: 7274 6564 2864 665f 6964 5b63 6f6c 5d2e  rted(df_id[col].
-000056f0: 756e 6971 7565 2829 2920 666f 7220 636f  unique()) for co
-00005700: 6c20 696e 2063 6f6c 735f 6964 5d0a 2020  l in cols_id].  
-00005710: 2020 6964 5f6c 6973 745b 305d 203d 2069    id_list[0] = i
-00005720: 645f 6c69 7374 5b30 5d23 5b3a 3530 305d  d_list[0]#[:500]
-00005730: 0a0a 2020 2020 746f 5f6d 646e 7079 5f61  ..    to_mdnpy_a
-00005740: 6e64 5f64 756d 7028 646d 5f64 6963 742c  nd_dump(dm_dict,
-00005750: 2063 6f6c 735f 6964 2c20 636f 6c73 5f64   cols_id, cols_d
-00005760: 6174 612c 2063 6f6c 735f 6d61 736b 2c20  ata, cols_mask, 
-00005770: 6964 5f6c 6973 7420 3d20 6964 5f6c 6973  id_list = id_lis
-00005780: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00005790: 2020 2020 2020 2076 6572 626f 7365 203d         verbose =
-000057a0: 2054 7275 652c 2070 6174 6820 3d20 272e   True, path = '.
-000057b0: 2f6d 646e 7079 2f27 2c20 6261 7463 685f  /mdnpy/', batch_
-000057c0: 7369 7a65 203d 2031 3030 290a 2020 2020  size = 100).    
-000057d0: 727a 2e67 6574 5f6d 656d 5f63 7572 2829  rz.get_mem_cur()
-000057e0: 3b20 727a 2e67 6574 5f6d 656d 5f6d 6178  ; rz.get_mem_max
-000057f0: 2829 2020 2020 0a20 2020 2022 2222 2020  ()    .    """  
-00005800: 200a 2020 2020 2320 726d 0a20 2020 206f   .    # rm.    o
-00005810: 732e 6d61 6b65 6469 7273 2870 6174 682c  s.makedirs(path,
-00005820: 2065 7869 7374 5f6f 6b3d 5472 7565 290a   exist_ok=True).
-00005830: 2020 2020 6966 206f 732e 7061 7468 2e65      if os.path.e
-00005840: 7869 7374 7328 6627 7b70 6174 687d 2f7b  xists(f'{path}/{
-00005850: 6461 7461 5f6e 616d 657d 2729 3a0a 2020  data_name}'):.  
-00005860: 2020 2020 2020 6f73 2e73 7973 7465 6d28        os.system(
-00005870: 6627 726d 207b 7061 7468 7d2f 7b64 6174  f'rm {path}/{dat
-00005880: 615f 6e61 6d65 7d27 290a 2020 2020 666f  a_name}').    fo
-00005890: 7220 6d69 2c20 636f 6c20 696e 2065 6e75  r mi, col in enu
-000058a0: 6d65 7261 7465 2863 6f6c 735f 6d61 736b  merate(cols_mask
-000058b0: 293a 0a20 2020 2020 2020 2069 6620 6f73  ):.        if os
-000058c0: 2e70 6174 682e 6578 6973 7473 2866 277b  .path.exists(f'{
-000058d0: 7061 7468 7d2f 6d61 736b 5f7b 636f 6c7d  path}/mask_{col}
-000058e0: 2e6e 7079 2729 3a0a 2020 2020 2020 2020  .npy'):.        
-000058f0: 2020 2020 6f73 2e73 7973 7465 6d28 6627      os.system(f'
-00005900: 726d 207b 7061 7468 7d2f 6d61 736b 5f7b  rm {path}/mask_{
-00005910: 636f 6c7d 2e6e 7079 2729 0a20 2020 200a  col}.npy').    .
-00005920: 2020 2020 2320 7368 6170 650a 2020 2020      # shape.    
-00005930: 7368 6170 6520 3d20 5b6c 656e 2878 2920  shape = [len(x) 
-00005940: 666f 7220 7820 696e 2069 645f 6c69 7374  for x in id_list
-00005950: 5d0a 2020 2020 6461 7461 5f73 6861 7065  ].    data_shape
-00005960: 203d 2028 2a73 6861 7065 2c20 6c65 6e28   = (*shape, len(
-00005970: 636f 6c73 5f64 6174 6129 290a 2020 2020  cols_data)).    
-00005980: 6d61 736b 5f73 6861 7065 203d 2074 7570  mask_shape = tup
-00005990: 6c65 2873 6861 7065 290a 2020 2020 2020  le(shape).      
-000059a0: 2020 0a20 2020 2023 2066 6f72 2065 6163    .    # for eac
-000059b0: 6820 6261 7463 680a 2020 2020 6964 5f6c  h batch.    id_l
-000059c0: 6973 745f 3020 3d20 6964 5f6c 6973 745b  ist_0 = id_list[
-000059d0: 305d 2e63 6f70 7928 290a 2020 2020 6e20  0].copy().    n 
-000059e0: 3d20 6c65 6e28 6964 5f6c 6973 745f 3029  = len(id_list_0)
-000059f0: 0a20 2020 2070 696a 203d 206c 6973 7428  .    pij = list(
-00005a00: 7261 6e67 6528 302c 206e 2c20 6261 7463  range(0, n, batc
-00005a10: 685f 7369 7a65 2929 0a20 2020 2070 696a  h_size)).    pij
-00005a20: 202b 3d20 5b6e 5d20 6966 2070 696a 5b2d   += [n] if pij[-
-00005a30: 315d 2021 3d20 6e20 656c 7365 205b 5d0a  1] != n else [].
-00005a40: 2020 2020 7267 203d 2074 7164 6d28 7261      rg = tqdm(ra
-00005a50: 6e67 6528 6c65 6e28 7069 6a29 202d 2031  nge(len(pij) - 1
-00005a60: 292c 206e 636f 6c73 3d31 3030 2c20 6173  ), ncols=100, as
-00005a70: 6369 693d 5472 7565 2920 6966 2076 6572  cii=True) if ver
-00005a80: 626f 7365 2065 6c73 6520 7261 6e67 6528  bose else range(
-00005a90: 6c65 6e28 7069 6a29 202d 2031 290a 2020  len(pij) - 1).  
-00005aa0: 2020 666f 7220 6920 696e 2072 673a 0a20    for i in rg:. 
-00005ab0: 2020 2020 2020 2070 692c 2070 6a20 3d20         pi, pj = 
-00005ac0: 7069 6a5b 695d 2c20 7069 6a5b 6920 2b20  pij[i], pij[i + 
-00005ad0: 315d 0a20 2020 2020 2020 2069 645f 6c69  1].        id_li
-00005ae0: 7374 5b30 5d20 3d20 6964 5f6c 6973 745f  st[0] = id_list_
-00005af0: 305b 7069 3a20 706a 5d0a 2020 2020 2020  0[pi: pj].      
-00005b00: 2020 0a20 2020 2020 2020 2061 5f64 6174    .        a_dat
-00005b10: 612c 2061 5f6d 6173 6b2c 2069 645f 6c69  a, a_mask, id_li
-00005b20: 7374 5f72 6574 203d 205c 0a20 2020 2020  st_ret = \.     
-00005b30: 2020 2020 2020 2074 6f5f 6d64 6e70 7928         to_mdnpy(
-00005b40: 646d 5f64 6963 742c 2063 6f6c 735f 6964  dm_dict, cols_id
-00005b50: 2c20 636f 6c73 5f64 6174 612c 2063 6f6c  , cols_data, col
-00005b60: 735f 6d61 736b 2c20 6964 5f6c 6973 7420  s_mask, id_list 
-00005b70: 3d20 6964 5f6c 6973 742c 2066 7265 655f  = id_list, free_
-00005b80: 7261 7720 3d20 4661 6c73 6529 0a20 2020  raw = False).   
-00005b90: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
-00005ba0: 6475 6d70 0a20 2020 2020 2020 2064 756d  dump.        dum
-00005bb0: 705f 6e70 7928 615f 6461 7461 2c20 6627  p_npy(a_data, f'
-00005bc0: 7b70 6174 687d 2f7b 6461 7461 5f6e 616d  {path}/{data_nam
-00005bd0: 657d 272c 2070 692c 2070 6a2c 2064 6174  e}', pi, pj, dat
-00005be0: 615f 7368 6170 6529 0a20 2020 2020 2020  a_shape).       
-00005bf0: 2066 6f72 206d 692c 2063 6f6c 2069 6e20   for mi, col in 
-00005c00: 656e 756d 6572 6174 6528 636f 6c73 5f6d  enumerate(cols_m
-00005c10: 6173 6b29 3a0a 2020 2020 2020 2020 2020  ask):.          
-00005c20: 2020 6475 6d70 5f6e 7079 2861 5f6d 6173    dump_npy(a_mas
-00005c30: 6b5b 2e2e 2e2c 206d 695d 2c20 6627 7b70  k[..., mi], f'{p
-00005c40: 6174 687d 2f6d 6173 6b5f 7b63 6f6c 7d2e  ath}/mask_{col}.
-00005c50: 6e70 7927 2c20 7069 2c20 706a 2c20 6d61  npy', pi, pj, ma
-00005c60: 736b 5f73 6861 7065 290a 2020 2020 2020  sk_shape).      
-00005c70: 2020 6465 6c20 615f 6461 7461 2c20 615f    del a_data, a_
-00005c80: 6d61 736b 2c20 6964 5f6c 6973 745f 7265  mask, id_list_re
-00005c90: 743b 2067 632e 636f 6c6c 6563 7428 290a  t; gc.collect().
-00005ca0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00005cb0: 7365 3a20 6765 745f 6d65 6d5f 6375 7228  se: get_mem_cur(
-00005cc0: 293b 2067 6574 5f6d 656d 5f6d 6178 2829  ); get_mem_max()
-00005cd0: 0a20 2020 200a 2020 2020 2320 6475 6d70  .    .    # dump
-00005ce0: 2069 645f 6c69 7374 0a20 2020 2069 645f   id_list.    id_
-00005cf0: 6c69 7374 5b30 5d20 3d20 6964 5f6c 6973  list[0] = id_lis
-00005d00: 745f 3020 0a0a 2020 2020 0a5c 275c 275c  t_0 ..    .\'\'\
-00005d10: 270a 7368 6170 6520 3d20 2831 3020 2a20  '.shape = (10 * 
-00005d20: 3234 3020 2a20 3530 3030 2c20 3230 3030  240 * 5000, 2000
-00005d30: 290a 6120 3d20 727a 2e75 7469 6c2e 6e70  ).a = rz.util.np
-00005d40: 795f 6e75 6d62 612e 6e70 5f72 616e 646f  y_numba.np_rando
-00005d50: 6d5f 7261 6e64 6f6d 2873 6861 7065 290a  m_random(shape).
-00005d60: 727a 2e75 7469 6c2e 6e70 792e 727a 5f64  rz.util.npy.rz_d
-00005d70: 756d 705f 6e70 7928 612c 2027 2f68 6f6d  ump_npy(a, '/hom
-00005d80: 652f 7278 2f74 6573 745f 3035 3330 2f62  e/rx/test_0530/b
-00005d90: 2e6e 7079 272c 2076 6572 626f 7365 203d  .npy', verbose =
-00005da0: 2054 7275 652c 206e 5f6a 6f62 733d 3136   True, n_jobs=16
-00005db0: 2c20 6b74 696d 6573 3d31 3029 0a0a 2320  , ktimes=10)..# 
-00005dc0: 7368 6170 6520 3d20 2832 3430 302c 2035  shape = (2400, 5
-00005dd0: 3030 302c 2032 3030 3029 0a23 2061 203d  000, 2000).# a =
-00005de0: 206e 702e 6c6f 6164 2870 6174 6829 2023   np.load(path) #
-00005df0: 2031 3373 0a0a 2320 6120 3d20 727a 2e75   13s..# a = rz.u
-00005e00: 7469 6c2e 6e70 792e 6c6f 6164 5f6e 7079  til.npy.load_npy
-00005e10: 2870 6174 6829 2023 2031 3373 0a23 2061  (path) # 13s.# a
-00005e20: 203d 2072 7a2e 7574 696c 2e6e 7079 2e72   = rz.util.npy.r
-00005e30: 7a5f 6c6f 6164 5f6e 7079 2870 6174 682c  z_load_npy(path,
-00005e40: 2076 6572 626f 7365 203d 2054 7275 652c   verbose = True,
-00005e50: 206e 5f6a 6f62 7320 3d20 312c 206b 7469   n_jobs = 1, kti
-00005e60: 6d65 7320 3d20 3129 2023 2037 3373 2c20  mes = 1) # 73s, 
-00005e70: e5a4 9ae4 ba86 615b 7031 3a70 325d 203d  ......a[p1:p2] =
-00005e80: 2061 0a23 2061 203d 2072 7a2e 7574 696c   a.# a = rz.util
-00005e90: 2e6e 7079 2e72 7a5f 6c6f 6164 5f6e 7079  .npy.rz_load_npy
-00005ea0: 2870 6174 682c 2076 6572 626f 7365 203d  (path, verbose =
-00005eb0: 2054 7275 652c 206e 5f6a 6f62 7320 3d20   True, n_jobs = 
-00005ec0: 3136 2c20 6b74 696d 6573 203d 2031 3029  16, ktimes = 10)
-00005ed0: 2023 2034 2e36 730a 0a23 2061 203d 2072   # 4.6s..# a = r
-00005ee0: 7a2e 7574 696c 2e6e 7079 2e6c 6f61 645f  z.util.npy.load_
-00005ef0: 6e70 7928 7061 7468 2c20 636f 6c73 203d  npy(path, cols =
-00005f00: 206e 702e 6172 616e 6765 2832 3030 3029   np.arange(2000)
-00005f10: 2920 2320 3635 732c 2073 6c6f 770a 2320  ) # 65s, slow.# 
-00005f20: 6120 3d20 727a 2e75 7469 6c2e 6e70 792e  a = rz.util.npy.
-00005f30: 727a 5f6c 6f61 645f 6e70 7928 7061 7468  rz_load_npy(path
-00005f40: 2c20 636f 6c73 203d 206e 702e 6172 616e  , cols = np.aran
-00005f50: 6765 2832 3030 3029 2c20 7665 7262 6f73  ge(2000), verbos
-00005f60: 6520 3d20 5472 7565 2c20 6e5f 6a6f 6273  e = True, n_jobs
-00005f70: 203d 2031 362c 206b 7469 6d65 7320 3d20   = 16, ktimes = 
-00005f80: 3230 2920 2320 3130 730a 0a23 2072 6561  20) # 10s..# rea
-00005f90: 6420 3264 2c20 616c 6c20 726f 7773 2c20  d 2d, all rows, 
-00005fa0: 7061 7274 2063 6f6c 730a 2320 6120 3d20  part cols.# a = 
-00005fb0: 727a 5f6c 6f61 645f 6e70 795f 6964 785f  rz_load_npy_idx_
-00005fc0: 6d75 6c74 6928 5b70 6174 682c 2070 6174  multi([path, pat
-00005fd0: 685d 2c20 4e6f 6e65 2c20 636f 6c73 5f6c  h], None, cols_l
-00005fe0: 6973 7420 3d20 5b6e 702e 6172 616e 6765  ist = [np.arange
-00005ff0: 2830 2c20 3130 3030 292c 206e 702e 6172  (0, 1000), np.ar
-00006000: 616e 6765 2831 3030 302c 2032 3030 3029  ange(1000, 2000)
-00006010: 5d2c 2076 6572 626f 7365 3d54 7275 652c  ], verbose=True,
-00006020: 206e 5f6a 6f62 7320 3d31 362c 206b 7469   n_jobs =16, kti
-00006030: 6d65 7320 3d20 3130 2c20 626c 6f63 6b5f  mes = 10, block_
-00006040: 7369 7a65 203d 2034 3030 3029 2023 2032  size = 4000) # 2
-00006050: 3073 0a0a 7368 6170 6520 3d20 2832 3430  0s..shape = (240
-00006060: 302c 2035 3030 302c 2032 3030 3029 0a69  0, 5000, 2000).i
-00006070: 6478 203d 206e 702e 7261 6e64 6f6d 2e70  dx = np.random.p
-00006080: 6572 6d75 7461 7469 6f6e 286e 702e 7072  ermutation(np.pr
-00006090: 6f64 2873 6861 7065 5b3a 325d 2929 0a69  od(shape[:2])).i
-000060a0: 6478 203d 206e 702e 736f 7274 2869 6478  dx = np.sort(idx
-000060b0: 5b3a 6c65 6e28 6964 7829 202f 2f20 325d  [:len(idx) // 2]
-000060c0: 290a 6120 3d20 727a 2e75 7469 6c2e 6e70  ).a = rz.util.np
-000060d0: 792e 727a 5f6c 6f61 645f 6e70 795f 6964  y.rz_load_npy_id
-000060e0: 7828 7061 7468 2c20 6964 782c 2076 6572  x(path, idx, ver
-000060f0: 626f 7365 203d 2054 7275 652c 206e 5f6a  bose = True, n_j
-00006100: 6f62 7320 3d20 3136 2c20 6b74 696d 6573  obs = 16, ktimes
-00006110: 203d 2031 2c20 626c 6f63 6b5f 7369 7a65   = 1, block_size
-00006120: 203d 204e 6f6e 6529 2023 2031 3273 0a0a   = None) # 12s..
-00006130: 2320 e69c 80e4 bdb3 e5ae 9ee8 b7b5 0a31  # .............1
-00006140: 2920 727a 5f6c 6f61 645f 6e70 795f 6964  ) rz_load_npy_id
-00006150: 782c 2066 6f72 2069 6478 0a20 2020 2061  x, for idx.    a
-00006160: 203d 2072 7a2e 7574 696c 2e6e 7079 2e72   = rz.util.npy.r
-00006170: 7a5f 6c6f 6164 5f6e 7079 5f69 6478 2870  z_load_npy_idx(p
-00006180: 6174 682c 2069 6478 2c20 7665 7262 6f73  ath, idx, verbos
-00006190: 6520 3d20 5472 7565 2c20 6e5f 6a6f 6273  e = True, n_jobs
-000061a0: 203d 2031 362c 206b 7469 6d65 7320 3d20   = 16, ktimes = 
-000061b0: 312c 2062 6c6f 636b 5f73 697a 6520 3d20  1, block_size = 
-000061c0: 4e6f 6e65 2920 2320 3132 730a 2020 2020  None) # 12s.    
-000061d0: 6475 6d70 2032 6420 6d61 7472 6978 0a0a  dump 2d matrix..
-000061e0: 3229 2072 7a5f 6c6f 6164 5f6e 7079 5f69  2) rz_load_npy_i
-000061f0: 6478 5f6d 756c 7469 2c20 666f 7220 636f  dx_multi, for co
-00006200: 6c73 0a20 2020 2061 203d 2072 7a5f 6c6f  ls.    a = rz_lo
-00006210: 6164 5f6e 7079 5f69 6478 5f6d 756c 7469  ad_npy_idx_multi
-00006220: 285b 7061 7468 2c20 7061 7468 5d2c 204e  ([path, path], N
-00006230: 6f6e 652c 2063 6f6c 735f 6c69 7374 203d  one, cols_list =
-00006240: 205b 6e70 2e61 7261 6e67 6528 302c 2031   [np.arange(0, 1
-00006250: 3030 3029 2c20 6e70 2e61 7261 6e67 6528  000), np.arange(
-00006260: 3130 3030 2c20 3230 3030 295d 2c20 7665  1000, 2000)], ve
-00006270: 7262 6f73 653d 5472 7565 2c20 6e5f 6a6f  rbose=True, n_jo
-00006280: 6273 203d 3136 2c20 6b74 696d 6573 203d  bs =16, ktimes =
-00006290: 2031 302c 2062 6c6f 636b 5f73 697a 6520   10, block_size 
-000062a0: 3d20 3430 3030 2920 2320 3230 730a 5c27  = 4000) # 20s.\'
-000062b0: 5c27 5c27 7a06 5c27 5c27 5c27 7a03 2727  \'\'z.\'\'\'z.''
-000062c0: 27da 0177 2907 da02 6f73 da04 7061 7468  '..w)...os..path
-000062d0: da07 6469 726e 616d 65da 085f 5f66 696c  ..dirname..__fil
-000062e0: 655f 5fda 0772 6570 6c61 6365 da04 6f70  e__..replace..op
-000062f0: 656e da05 7772 6974 6529 04da 066f 7574  en..write)...out
-00006300: 7075 745a 0b70 6174 685f 6f75 7470 7574  putZ.path_output
-00006310: da01 73da 0166 a900 720e 0000 00fa 3a62  ..s..f..r.....:b
-00006320: 7569 6c64 2f62 6469 7374 2e6d 6163 6f73  uild/bdist.macos
-00006330: 782d 3130 2e39 2d78 3836 5f36 342f 6567  x-10.9-x86_64/eg
-00006340: 672f 7275 6e6e 696e 677a 2f75 7469 6c2f  g/runningz/util/
-00006350: 6e70 795f 7079 2e70 79da 0372 756e 0400  npy_py.py..run..
-00006360: 0000 7312 0000 0000 0114 0104 7f00 7f00  ..s.............
-00006370: 7f00 7f00 650c 010c 0172 1000 0000 da08  ....e....r......
-00006380: 5f5f 6d61 696e 5f5f 7a08 2d2d 6f75 7470  __main__z.--outp
-00006390: 7574 5429 02da 0474 7970 65da 0872 6571  utT)...type..req
-000063a0: 7569 7265 6429 0c72 0400 0000 da03 7379  uired).r......sy
-000063b0: 7372 1000 0000 da08 5f5f 6e61 6d65 5f5f  sr......__name__
-000063c0: da08 6172 6770 6172 7365 da0e 4172 6775  ..argparse..Argu
-000063d0: 6d65 6e74 5061 7273 6572 da06 7061 7273  mentParser..pars
-000063e0: 6572 da0c 6164 645f 6172 6775 6d65 6e74  er..add_argument
-000063f0: da03 7374 72da 0a70 6172 7365 5f61 7267  ..str..parse_arg
-00006400: 73da 0461 7267 7372 0b00 0000 720e 0000  s..argsr....r...
-00006410: 0072 0e00 0000 720e 0000 0072 0f00 0000  .r....r....r....
-00006420: da08 3c6d 6f64 756c 653e 0200 0000 7318  ..<module>....s.
-00006430: 0000 0008 0108 0108 7f00 7f00 7f00 7f00  ................
-00006440: 6b08 0108 0108 0110 0108 01              k..........
+00004430: 2061 203d 2072 7a5f 6c6f 6164 5f6e 7079   a = rz_load_npy
+00004440: 2870 6174 682c 2073 7461 7274 203d 2070  (path, start = p
+00004450: 312c 2065 6e64 203d 2070 322c 2063 6f6c  1, end = p2, col
+00004460: 7320 3d20 636f 6c73 2c20 7573 655f 6e75  s = cols, use_nu
+00004470: 6d62 6120 3d20 7573 655f 6e75 6d62 612c  mba = use_numba,
+00004480: 206e 5f6a 6f62 7320 3d20 6e5f 6a6f 6273   n_jobs = n_jobs
+00004490: 2c20 6b74 696d 6573 203d 206b 7469 6d65  , ktimes = ktime
+000044a0: 7329 2e72 6573 6861 7065 282d 312c 206e  s).reshape(-1, n
+000044b0: 5f63 6f6c 735f 7365 6c29 0a20 2020 2020  _cols_sel).     
+000044c0: 2020 2020 2020 2020 2020 2063 312c 2063             c1, c
+000044d0: 3220 3d20 696e 7428 6e70 2e73 756d 286e  2 = int(np.sum(n
+000044e0: 5f63 6f6c 735f 7365 6c5f 6c69 7374 5b3a  _cols_sel_list[:
+000044f0: 7069 5d29 292c 2069 6e74 286e 702e 7375  pi])), int(np.su
+00004500: 6d28 6e5f 636f 6c73 5f73 656c 5f6c 6973  m(n_cols_sel_lis
+00004510: 745b 3a70 6920 2b20 315d 2929 0a20 2020  t[:pi + 1])).   
+00004520: 2020 2020 2020 2020 2020 2020 206e 705f               np_
+00004530: 7365 745f 6964 785f 636f 6c73 2864 6174  set_idx_cols(dat
+00004540: 612c 206e 702e 6172 616e 6765 285f 7031  a, np.arange(_p1
+00004550: 2c20 5f70 3229 2c20 6e70 2e61 7261 6e67  , _p2), np.arang
+00004560: 6528 6331 2c20 6332 292c 2061 290a 2020  e(c1, c2), a).  
+00004570: 2020 2020 2020 6763 2e63 6f6c 6c65 6374        gc.collect
+00004580: 2829 0a20 2020 2072 6574 7572 6e20 6461  ().    return da
+00004590: 7461 0a0a 2320 3d3d 3d3d 3d3d 3d3d 3d3d  ta..# ==========
+000045a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000045b0: 3d3d 3d3d 2020 646d 2074 6f20 6d64 6e70  ====  dm to mdnp
+000045c0: 7920 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  y ==============
+000045d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000045e0: 0a64 6566 205f 746f 5f6e 756d 7079 2864  .def _to_numpy(d
+000045f0: 662c 2063 6f6c 732c 206b 203d 2032 302c  f, cols, k = 20,
+00004600: 2076 6572 626f 7365 203d 2046 616c 7365   verbose = False
+00004610: 293a 0a20 2020 2061 203d 206e 702e 7a65  ):.    a = np.ze
+00004620: 726f 7328 286c 656e 2864 6629 2c20 6c65  ros((len(df), le
+00004630: 6e28 636f 6c73 2929 2c20 6474 7970 6520  n(cols)), dtype 
+00004640: 3d20 6e70 2e66 6c6f 6174 3332 290a 2020  = np.float32).  
+00004650: 2020 6369 6a20 3d20 6c69 7374 2872 616e    cij = list(ran
+00004660: 6765 2830 2c20 6c65 6e28 636f 6c73 292c  ge(0, len(cols),
+00004670: 206b 2929 0a20 2020 2063 696a 202b 3d20   k)).    cij += 
+00004680: 5b6c 656e 2863 6f6c 7329 5d20 6966 2063  [len(cols)] if c
+00004690: 696a 5b2d 315d 2021 3d20 6c65 6e28 636f  ij[-1] != len(co
+000046a0: 6c73 2920 656c 7365 205b 5d0a 2020 2020  ls) else [].    
+000046b0: 7267 203d 2074 7164 6d28 7261 6e67 6528  rg = tqdm(range(
+000046c0: 6c65 6e28 6369 6a29 202d 2031 292c 206e  len(cij) - 1), n
+000046d0: 636f 6c73 3d31 3030 2c20 6173 6369 693d  cols=100, ascii=
+000046e0: 5472 7565 2920 6966 2076 6572 626f 7365  True) if verbose
+000046f0: 2065 6c73 6520 7261 6e67 6528 6c65 6e28   else range(len(
+00004700: 6369 6a29 202d 2031 290a 2020 2020 666f  cij) - 1).    fo
+00004710: 7220 6920 696e 2072 673a 0a20 2020 2020  r i in rg:.     
+00004720: 2020 2063 692c 2063 6a20 3d20 6369 6a5b     ci, cj = cij[
+00004730: 695d 2c20 6369 6a5b 6920 2b20 315d 0a20  i], cij[i + 1]. 
+00004740: 2020 2020 2020 2061 5b3a 2c20 6369 3a20         a[:, ci: 
+00004750: 636a 5d20 3d20 6466 5b63 6f6c 735b 6369  cj] = df[cols[ci
+00004760: 3a20 636a 5d5d 2e74 6f5f 6e75 6d70 7928  : cj]].to_numpy(
+00004770: 290a 2020 2020 7265 7475 726e 2061 2020  ).    return a  
+00004780: 2020 200a 0a64 6566 2067 6574 5f64 665f     ..def get_df_
+00004790: 6964 5f61 6c6c 2869 645f 6c69 7374 2c20  id_all(id_list, 
+000047a0: 636f 6c73 5f69 6420 3d20 4e6f 6e65 2c20  cols_id = None, 
+000047b0: 6d65 7468 6f64 203d 2027 7064 2729 3a0a  method = 'pd'):.
+000047c0: 2020 2020 5c27 5c27 5c27 0a20 2020 2064      \'\'\'.    d
+000047d0: 665f 6964 203d 2072 7a2e 7574 696c 2e6e  f_id = rz.util.n
+000047e0: 7079 2e67 6574 5f64 665f 6964 5f61 6c6c  py.get_df_id_all
+000047f0: 285b 6e70 2e61 7261 6e67 6528 7829 2e61  ([np.arange(x).a
+00004800: 7374 7970 6528 6e70 2e69 6e74 3332 2920  stype(np.int32) 
+00004810: 666f 7220 7820 696e 2073 6861 7065 5d2c  for x in shape],
+00004820: 2063 6f6c 735f 6964 203d 205b 2764 6174   cols_id = ['dat
+00004830: 6527 2c20 2774 6964 272c 2027 6964 275d  e', 'tid', 'id']
+00004840: 290a 2020 2020 5c27 5c27 5c27 0a20 2020  ).    \'\'\'.   
+00004850: 2069 6620 636f 6c73 5f69 6420 6973 204e   if cols_id is N
+00004860: 6f6e 653a 2063 6f6c 735f 6964 203d 205b  one: cols_id = [
+00004870: 6627 787b 697d 2720 666f 7220 6920 696e  f'x{i}' for i in
+00004880: 206c 656e 2869 645f 6c69 7374 295d 0a20   len(id_list)]. 
+00004890: 2020 2069 6620 6d65 7468 6f64 203d 3d20     if method == 
+000048a0: 2770 6427 3a0a 2020 2020 2020 2020 6466  'pd':.        df
+000048b0: 5f69 645f 616c 6c20 3d20 7064 2e4d 756c  _id_all = pd.Mul
+000048c0: 7469 496e 6465 782e 6672 6f6d 5f70 726f  tiIndex.from_pro
+000048d0: 6475 6374 2869 645f 6c69 7374 292e 746f  duct(id_list).to
+000048e0: 5f66 7261 6d65 2829 2e72 6573 6574 5f69  _frame().reset_i
+000048f0: 6e64 6578 2864 726f 7020 3d20 5472 7565  ndex(drop = True
+00004900: 290a 2020 2020 2020 2020 6466 5f69 645f  ).        df_id_
+00004910: 616c 6c2e 636f 6c75 6d6e 7320 3d20 636f  all.columns = co
+00004920: 6c73 5f69 640a 2020 2020 656c 6966 206d  ls_id.    elif m
+00004930: 6574 686f 6420 3d3d 2027 706c 273a 0a20  ethod == 'pl':. 
+00004940: 2020 2020 2020 2073 6861 7065 203d 205b         shape = [
+00004950: 6c65 6e28 7829 2066 6f72 2078 2069 6e20  len(x) for x in 
+00004960: 6964 5f6c 6973 745d 0a20 2020 2020 2020  id_list].       
+00004970: 2064 665f 6964 5f61 6c6c 203d 2070 6c2e   df_id_all = pl.
+00004980: 4461 7461 4672 616d 6528 290a 2020 2020  DataFrame().    
+00004990: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+000049a0: 6765 286c 656e 2873 6861 7065 2929 3a0a  ge(len(shape)):.
+000049b0: 2020 2020 2020 2020 2020 2020 7820 3d20              x = 
+000049c0: 6964 5f6c 6973 745b 695d 0a20 2020 2020  id_list[i].     
+000049d0: 2020 2020 2020 2069 6620 6920 2b20 3120         if i + 1 
+000049e0: 3c20 6c65 6e28 7368 6170 6529 3a20 7820  < len(shape): x 
+000049f0: 3d20 6e70 2e72 6570 6561 7428 782c 206e  = np.repeat(x, n
+00004a00: 702e 7072 6f64 2873 6861 7065 5b69 202b  p.prod(shape[i +
+00004a10: 2031 3a5d 2929 0a20 2020 2020 2020 2020   1:])).         
+00004a20: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+00004a30: 6528 6920 2d20 312c 202d 312c 202d 3129  e(i - 1, -1, -1)
+00004a40: 3a20 7820 3d20 6e70 2e74 696c 6528 782c  : x = np.tile(x,
+00004a50: 2073 6861 7065 5b6a 5d29 0a20 2020 2020   shape[j]).     
+00004a60: 2020 2020 2020 2064 665f 6964 5f61 6c6c         df_id_all
+00004a70: 203d 2064 665f 6964 5f61 6c6c 2e77 6974   = df_id_all.wit
+00004a80: 685f 636f 6c75 6d6e 7328 706c 2e53 6572  h_columns(pl.Ser
+00004a90: 6965 7328 7374 7228 636f 6c73 5f69 645b  ies(str(cols_id[
+00004aa0: 695d 292c 2078 2929 0a20 2020 2072 6574  i]), x)).    ret
+00004ab0: 7572 6e20 6466 5f69 645f 616c 6c0a 0a23  urn df_id_all..#
+00004ac0: 2040 7072 6f66 696c 6528 2920 200a 6465   @profile()  .de
+00004ad0: 6620 746f 5f6d 646e 7079 2864 6d5f 6469  f to_mdnpy(dm_di
+00004ae0: 6374 2c20 636f 6c73 5f69 642c 2063 6f6c  ct, cols_id, col
+00004af0: 735f 6461 7461 2c20 636f 6c73 5f6d 6173  s_data, cols_mas
+00004b00: 6b2c 2069 645f 6c69 7374 203d 204e 6f6e  k, id_list = Non
+00004b10: 652c 2066 7265 655f 7261 7720 3d20 4661  e, free_raw = Fa
+00004b20: 6c73 6529 3a0a 2020 2020 5c27 5c27 5c27  lse):.    \'\'\'
+00004b30: 0a20 2020 2064 6d5f 6469 6374 203d 207b  .    dm_dict = {
+00004b40: 2764 6d27 3a20 646d 7d0a 2020 2020 6465  'dm': dm}.    de
+00004b50: 6c20 646d 3b20 6763 2e63 6f6c 6c65 6374  l dm; gc.collect
+00004b60: 2829 0a0a 2020 2020 636f 6c73 5f69 6420  ()..    cols_id 
+00004b70: 3d20 5b63 6f6c 5f64 6174 652c 2063 6f6c  = [col_date, col
+00004b80: 5f69 645d 0a20 2020 2063 6f6c 735f 6d61  _id].    cols_ma
+00004b90: 736b 203d 205b 2774 7261 696e 272c 2027  sk = ['train', '
+00004ba0: 7465 7374 272c 2027 7661 6c69 6427 2c20  test', 'valid', 
+00004bb0: 2761 6c6c 272c 2027 7a64 7427 5d0a 2020  'all', 'zdt'].  
+00004bc0: 2020 636f 6c73 5f64 6174 6120 3d20 5b63    cols_data = [c
+00004bd0: 6f6c 5f6c 6162 656c 5d20 2b20 636f 6c73  ol_label] + cols
+00004be0: 5f66 6561 0a0a 2020 2020 6466 5f69 6420  _fea..    df_id 
+00004bf0: 3d20 646d 5f64 6963 745b 2764 6d27 5d2e  = dm_dict['dm'].
+00004c00: 6765 745f 636f 6c73 5f70 616e 6461 7328  get_cols_pandas(
+00004c10: 636f 6c73 5f69 6429 0a20 2020 2069 645f  cols_id).    id_
+00004c20: 6c69 7374 203d 205b 736f 7274 6564 2864  list = [sorted(d
+00004c30: 665f 6964 5b63 6f6c 5d2e 756e 6971 7565  f_id[col].unique
+00004c40: 2829 2920 666f 7220 636f 6c20 696e 2063  ()) for col in c
+00004c50: 6f6c 735f 6964 5d0a 2020 2020 6964 5f6c  ols_id].    id_l
+00004c60: 6973 745b 305d 203d 2069 645f 6c69 7374  ist[0] = id_list
+00004c70: 5b30 5d23 5b3a 3530 305d 0a0a 2020 2020  [0]#[:500]..    
+00004c80: 615f 6461 7461 2c20 615f 6d61 736b 2c20  a_data, a_mask, 
+00004c90: 6964 5f6c 6973 745f 7265 7420 3d20 5c0a  id_list_ret = \.
+00004ca0: 2020 2020 2020 2020 746f 5f6d 646e 7079          to_mdnpy
+00004cb0: 2864 6d5f 6469 6374 2c20 636f 6c73 5f69  (dm_dict, cols_i
+00004cc0: 642c 2063 6f6c 735f 6461 7461 2c20 636f  d, cols_data, co
+00004cd0: 6c73 5f6d 6173 6b2c 2069 645f 6c69 7374  ls_mask, id_list
+00004ce0: 203d 2069 645f 6c69 7374 2c20 6672 6565   = id_list, free
+00004cf0: 5f72 6177 203d 2046 616c 7365 290a 2020  _raw = False).  
+00004d00: 2020 5c27 5c27 5c27 0a20 2020 2064 6d20    \'\'\'.    dm 
+00004d10: 3d20 646d 5f64 6963 745b 2764 6d27 5d0a  = dm_dict['dm'].
+00004d20: 2020 2020 666f 7220 636f 6c20 696e 2063      for col in c
+00004d30: 6f6c 735f 6d61 736b 3a0a 2020 2020 2020  ols_mask:.      
+00004d40: 2020 646d 2e73 6574 5f62 795f 636f 6c28    dm.set_by_col(
+00004d50: 6627 4d41 534b 5f7b 636f 6c7d 272c 2064  f'MASK_{col}', d
+00004d60: 6d2e 6d61 736b 6572 2e6d 6173 6b5f 4449  m.masker.mask_DI
+00004d70: 4354 5b63 6f6c 5d2e 6173 7479 7065 286e  CT[col].astype(n
+00004d80: 702e 696e 7433 3229 290a 2020 2020 636f  p.int32)).    co
+00004d90: 6c73 5f6d 6173 6b20 3d20 5b66 274d 4153  ls_mask = [f'MAS
+00004da0: 4b5f 7b63 6f6c 7d27 2066 6f72 2063 6f6c  K_{col}' for col
+00004db0: 2069 6e20 636f 6c73 5f6d 6173 6b5d 0a20   in cols_mask]. 
+00004dc0: 2020 200a 2020 2020 2320 2d2d 2d2d 2d2d     .    # ------
+00004dd0: 2d2d 2d2d 2064 665f 6964 5f61 6c6c 202d  ---- df_id_all -
+00004de0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6466  ---------.    df
+00004df0: 5f69 6420 3d20 646d 2e67 6574 5f63 6f6c  _id = dm.get_col
+00004e00: 735f 7061 6e64 6173 2863 6f6c 735f 6964  s_pandas(cols_id
+00004e10: 290a 2020 2020 6966 2069 645f 6c69 7374  ).    if id_list
+00004e20: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00004e30: 2020 6964 5f6c 6973 7420 3d20 5b5d 0a20    id_list = []. 
+00004e40: 2020 2020 2020 2066 6f72 2063 6f6c 2069         for col i
+00004e50: 6e20 636f 6c73 5f69 643a 0a20 2020 2020  n cols_id:.     
+00004e60: 2020 2020 2020 2069 645f 6c69 7374 2e61         id_list.a
+00004e70: 7070 656e 6428 736f 7274 6564 2864 665f  ppend(sorted(df_
+00004e80: 6964 5b63 6f6c 5d2e 756e 6971 7565 2829  id[col].unique()
+00004e90: 2929 0a20 2020 2073 6861 7065 203d 205b  )).    shape = [
+00004ea0: 6c65 6e28 7829 2066 6f72 2078 2069 6e20  len(x) for x in 
+00004eb0: 6964 5f6c 6973 745d 0a20 2020 2064 665f  id_list].    df_
+00004ec0: 6964 5f61 6c6c 203d 2070 642e 4d75 6c74  id_all = pd.Mult
+00004ed0: 6949 6e64 6578 2e66 726f 6d5f 7072 6f64  iIndex.from_prod
+00004ee0: 7563 7428 6964 5f6c 6973 7429 2e74 6f5f  uct(id_list).to_
+00004ef0: 6672 616d 6528 292e 7265 7365 745f 696e  frame().reset_in
+00004f00: 6465 7828 6472 6f70 203d 2054 7275 6529  dex(drop = True)
+00004f10: 0a20 2020 2064 665f 6964 5f61 6c6c 2e63  .    df_id_all.c
+00004f20: 6f6c 756d 6e73 203d 2063 6f6c 735f 6964  olumns = cols_id
+00004f30: 0a20 2020 2064 665f 6964 5f61 6c6c 203d  .    df_id_all =
+00004f40: 2064 665f 6964 5f61 6c6c 2e61 7374 7970   df_id_all.astyp
+00004f50: 6528 6466 5f69 642e 6474 7970 6573 2e74  e(df_id.dtypes.t
+00004f60: 6f5f 6469 6374 2829 290a 2020 2020 6466  o_dict()).    df
+00004f70: 5f69 645f 616c 6c20 3d20 706c 2e44 6174  _id_all = pl.Dat
+00004f80: 6146 7261 6d65 2864 665f 6964 5f61 6c6c  aFrame(df_id_all
+00004f90: 290a 2020 2020 2320 7072 696e 7428 275b  ).    # print('[
+00004fa0: 2b5d 2064 665f 6964 5f61 6c6c 2729 0a20  +] df_id_all'). 
+00004fb0: 2020 2023 2067 6574 5f6d 656d 5f63 7572     # get_mem_cur
+00004fc0: 2829 3b20 6765 745f 6d65 6d5f 6d61 7828  (); get_mem_max(
+00004fd0: 290a 2020 2020 0a20 2020 2023 202d 2d2d  ).    .    # ---
+00004fe0: 2d2d 2d2d 2d2d 2d20 6a6f 696e 202d 2d2d  ------- join ---
+00004ff0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6466 5f76  -------.    df_v
+00005000: 5f6f 7269 6769 6e20 3d20 646d 2e67 6574  _origin = dm.get
+00005010: 5f63 6f6c 735f 706f 6c61 7273 2863 6f6c  _cols_polars(col
+00005020: 735f 6964 202b 2063 6f6c 735f 6461 7461  s_id + cols_data
+00005030: 202b 2063 6f6c 735f 6d61 736b 290a 2020   + cols_mask).  
+00005040: 2020 6465 6c20 646d 3b20 6763 2e63 6f6c    del dm; gc.col
+00005050: 6c65 6374 2829 0a20 2020 2069 6620 6672  lect().    if fr
+00005060: 6565 5f72 6177 3a20 0a20 2020 2020 2020  ee_raw: .       
+00005070: 2064 656c 2064 6d5f 6469 6374 5b27 646d   del dm_dict['dm
+00005080: 275d 3b20 6763 2e63 6f6c 6c65 6374 2829  ']; gc.collect()
+00005090: 0a20 2020 2064 665f 7620 3d20 6466 5f69  .    df_v = df_i
+000050a0: 645f 616c 6c2e 6a6f 696e 2864 665f 765f  d_all.join(df_v_
+000050b0: 6f72 6967 696e 2c20 6f6e 203d 2063 6f6c  origin, on = col
+000050c0: 735f 6964 2c20 686f 7720 3d20 276c 6566  s_id, how = 'lef
+000050d0: 7427 290a 2020 2020 666f 7220 636f 6c20  t').    for col 
+000050e0: 696e 2064 665f 765f 6f72 6967 696e 2e63  in df_v_origin.c
+000050f0: 6f6c 756d 6e73 3a20 6466 5f76 5f6f 7269  olumns: df_v_ori
+00005100: 6769 6e2e 6472 6f70 5f69 6e5f 706c 6163  gin.drop_in_plac
+00005110: 6528 636f 6c29 0a20 2020 2064 656c 2064  e(col).    del d
+00005120: 665f 765f 6f72 6967 696e 3b20 6763 2e63  f_v_origin; gc.c
+00005130: 6f6c 6c65 6374 2829 0a20 2020 2023 2070  ollect().    # p
+00005140: 7269 6e74 2827 5b2b 5d20 6a6f 696e 2729  rint('[+] join')
+00005150: 0a20 2020 2023 2067 6574 5f6d 656d 5f63  .    # get_mem_c
+00005160: 7572 2829 3b20 6765 745f 6d65 6d5f 6d61  ur(); get_mem_ma
+00005170: 7828 290a 2020 2020 6465 6c20 6466 5f69  x().    del df_i
+00005180: 645f 616c 6c3b 2067 632e 636f 6c6c 6563  d_all; gc.collec
+00005190: 7428 290a 2020 2020 2020 2020 0a20 2020  t().        .   
+000051a0: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d20 746f   # ---------- to
+000051b0: 5f66 6c6f 6174 3332 202d 2d2d 2d2d 2d2d  _float32 -------
+000051c0: 2d2d 2d0a 2020 2020 2320 666f 7220 636f  ---.    # for co
+000051d0: 6c20 696e 2074 7164 6d28 636f 6c73 5f64  l in tqdm(cols_d
+000051e0: 6174 6120 2b20 636f 6c73 5f6d 6173 6b2c  ata + cols_mask,
+000051f0: 2064 6573 6320 3d20 2774 6f5f 666c 6f61   desc = 'to_floa
+00005200: 7433 3227 293a 0a20 2020 2066 6f72 2063  t32'):.    for c
+00005210: 6f6c 2069 6e20 636f 6c73 5f64 6174 6120  ol in cols_data 
+00005220: 2b20 636f 6c73 5f6d 6173 6b3a 0a20 2020  + cols_mask:.   
+00005230: 2020 2020 2074 7970 655f 6f6c 6420 3d20       type_old = 
+00005240: 7374 7228 6466 5f76 5b63 6f6c 5d2e 6474  str(df_v[col].dt
+00005250: 7970 6529 2e6c 6f77 6572 2829 0a20 2020  ype).lower().   
+00005260: 2020 2020 2069 6620 2766 6c6f 6174 3332       if 'float32
+00005270: 2720 6e6f 7420 696e 2074 7970 655f 6f6c  ' not in type_ol
+00005280: 6420 616e 6420 2766 3332 2720 6e6f 7420  d and 'f32' not 
+00005290: 696e 2074 7970 655f 6f6c 643a 0a20 2020  in type_old:.   
+000052a0: 2020 2020 2020 2020 2064 665f 7620 3d20           df_v = 
+000052b0: 6466 5f76 2e77 6974 685f 636f 6c75 6d6e  df_v.with_column
+000052c0: 7328 6466 5f76 5b63 6f6c 5d2e 6361 7374  s(df_v[col].cast
+000052d0: 2870 6c2e 6461 7461 7479 7065 732e 466c  (pl.datatypes.Fl
+000052e0: 6f61 7433 3229 290a 2020 2020 2320 7072  oat32)).    # pr
+000052f0: 696e 7428 7064 2e53 6572 6965 7328 6466  int(pd.Series(df
+00005300: 5f76 5b63 6f6c 735f 6461 7461 5d2e 6474  _v[cols_data].dt
+00005310: 7970 6573 292e 7661 6c75 655f 636f 756e  ypes).value_coun
+00005320: 7473 2829 2920 2020 2020 2020 200a 2020  ts())        .  
+00005330: 2020 2320 7072 696e 7428 275b 2b5d 2074    # print('[+] t
+00005340: 6f5f 666c 6f61 7433 3227 290a 2020 2020  o_float32').    
+00005350: 2320 6765 745f 6d65 6d5f 6375 7228 293b  # get_mem_cur();
+00005360: 2067 6574 5f6d 656d 5f6d 6178 2829 0a20   get_mem_max(). 
+00005370: 2020 200a 2020 2020 2320 2d2d 2d2d 2d2d     .    # ------
+00005380: 2d2d 2d2d 2074 6f5f 6e75 6d70 7920 616e  ---- to_numpy an
+00005390: 6420 7265 7368 6170 6520 2d2d 2d2d 2d2d  d reshape ------
+000053a0: 2d2d 2d2d 0a20 2020 2023 200a 2020 2020  ----.    # .    
+000053b0: 615f 6d61 736b 203d 204e 6f6e 650a 2020  a_mask = None.  
+000053c0: 2020 6966 206c 656e 2863 6f6c 735f 6d61    if len(cols_ma
+000053d0: 736b 2920 3e20 303a 0a20 2020 2020 2020  sk) > 0:.       
+000053e0: 2061 5f6d 6173 6b20 3d20 5f74 6f5f 6e75   a_mask = _to_nu
+000053f0: 6d70 7928 6466 5f76 2c20 636f 6c73 5f6d  mpy(df_v, cols_m
+00005400: 6173 6b29 0a20 2020 2020 2020 2061 5f6d  ask).        a_m
+00005410: 6173 6b20 3d20 615f 6d61 736b 2e72 6573  ask = a_mask.res
+00005420: 6861 7065 2828 2a73 6861 7065 2c20 6c65  hape((*shape, le
+00005430: 6e28 636f 6c73 5f6d 6173 6b29 2929 0a20  n(cols_mask))). 
+00005440: 2020 2020 2020 2061 5f6d 6173 6b20 3d20         a_mask = 
+00005450: 6e70 2e61 7363 6f6e 7469 6775 6f75 7361  np.ascontiguousa
+00005460: 7272 6179 2861 5f6d 6173 6b29 0a20 2020  rray(a_mask).   
+00005470: 2020 2020 200a 2020 2020 615f 6461 7461       .    a_data
+00005480: 203d 205f 746f 5f6e 756d 7079 2864 665f   = _to_numpy(df_
+00005490: 762c 2063 6f6c 735f 6461 7461 290a 2020  v, cols_data).  
+000054a0: 2020 666f 7220 636f 6c20 696e 2064 665f    for col in df_
+000054b0: 762e 636f 6c75 6d6e 733a 2064 665f 762e  v.columns: df_v.
+000054c0: 6472 6f70 5f69 6e5f 706c 6163 6528 636f  drop_in_place(co
+000054d0: 6c29 0a20 2020 2064 656c 2064 665f 763b  l).    del df_v;
+000054e0: 2067 632e 636f 6c6c 6563 7428 2920 200a   gc.collect()  .
+000054f0: 2020 2020 615f 6461 7461 203d 2061 5f64      a_data = a_d
+00005500: 6174 612e 7265 7368 6170 6528 282a 7368  ata.reshape((*sh
+00005510: 6170 652c 206c 656e 2863 6f6c 735f 6461  ape, len(cols_da
+00005520: 7461 2929 290a 2020 2020 615f 6461 7461  ta))).    a_data
+00005530: 203d 206e 702e 6173 636f 6e74 6967 756f   = np.ascontiguo
+00005540: 7573 6172 7261 7928 615f 6461 7461 2920  usarray(a_data) 
+00005550: 2020 200a 2020 2020 7265 7475 726e 2061     .    return a
+00005560: 5f64 6174 612c 2061 5f6d 6173 6b2c 2069  _data, a_mask, i
+00005570: 645f 6c69 7374 0a0a 0a23 203d 3d3d 3d3d  d_list...# =====
+00005580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00005590: 3d3d 3d3d 3d3d 3d3d 3d20 2074 6f5f 6d64  =========  to_md
+000055a0: 6e70 795f 616e 645f 6475 6d70 203d 3d3d  npy_and_dump ===
+000055b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000055c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0a 6465 6620  ===========.def 
+000055d0: 746f 5f6d 646e 7079 5f61 6e64 5f64 756d  to_mdnpy_and_dum
+000055e0: 7028 646d 5f64 6963 742c 2063 6f6c 735f  p(dm_dict, cols_
+000055f0: 6964 2c20 636f 6c73 5f64 6174 612c 2063  id, cols_data, c
+00005600: 6f6c 735f 6d61 736b 2c20 6964 5f6c 6973  ols_mask, id_lis
+00005610: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2020  t = None,.      
+00005620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005630: 7061 7468 203d 2027 2e2f 272c 2062 6174  path = './', bat
+00005640: 6368 5f73 697a 6520 3d20 3130 302c 2076  ch_size = 100, v
+00005650: 6572 626f 7365 203d 2046 616c 7365 2c20  erbose = False, 
+00005660: 6461 7461 5f6e 616d 6520 3d20 2764 6174  data_name = 'dat
+00005670: 612e 6e70 7927 293a 0a20 2020 2022 2222  a.npy'):.    """
+00005680: 0a20 2020 2064 6d5f 6469 6374 203d 207b  .    dm_dict = {
+00005690: 2764 6d27 3a20 646d 7d0a 2020 2020 6465  'dm': dm}.    de
+000056a0: 6c20 646d 3b20 6763 2e63 6f6c 6c65 6374  l dm; gc.collect
+000056b0: 2829 0a0a 2020 2020 636f 6c73 5f69 6420  ()..    cols_id 
+000056c0: 3d20 5b63 6f6c 5f64 6174 652c 2063 6f6c  = [col_date, col
+000056d0: 5f69 645d 0a20 2020 2063 6f6c 735f 6d61  _id].    cols_ma
+000056e0: 736b 203d 205b 2774 7261 696e 272c 2027  sk = ['train', '
+000056f0: 7465 7374 272c 2027 7661 6c69 6427 2c20  test', 'valid', 
+00005700: 2761 6c6c 272c 2027 7a64 7427 5d0a 2020  'all', 'zdt'].  
+00005710: 2020 636f 6c73 5f64 6174 6120 3d20 5b63    cols_data = [c
+00005720: 6f6c 5f6c 6162 656c 5d20 2b20 636f 6c73  ol_label] + cols
+00005730: 5f66 6561 0a0a 2020 2020 6466 5f69 6420  _fea..    df_id 
+00005740: 3d20 646d 5f64 6963 745b 2764 6d27 5d2e  = dm_dict['dm'].
+00005750: 6765 745f 636f 6c73 5f70 616e 6461 7328  get_cols_pandas(
+00005760: 636f 6c73 5f69 6429 0a20 2020 2069 645f  cols_id).    id_
+00005770: 6c69 7374 203d 205b 736f 7274 6564 2864  list = [sorted(d
+00005780: 665f 6964 5b63 6f6c 5d2e 756e 6971 7565  f_id[col].unique
+00005790: 2829 2920 666f 7220 636f 6c20 696e 2063  ()) for col in c
+000057a0: 6f6c 735f 6964 5d0a 2020 2020 6964 5f6c  ols_id].    id_l
+000057b0: 6973 745b 305d 203d 2069 645f 6c69 7374  ist[0] = id_list
+000057c0: 5b30 5d23 5b3a 3530 305d 0a0a 2020 2020  [0]#[:500]..    
+000057d0: 746f 5f6d 646e 7079 5f61 6e64 5f64 756d  to_mdnpy_and_dum
+000057e0: 7028 646d 5f64 6963 742c 2063 6f6c 735f  p(dm_dict, cols_
+000057f0: 6964 2c20 636f 6c73 5f64 6174 612c 2063  id, cols_data, c
+00005800: 6f6c 735f 6d61 736b 2c20 6964 5f6c 6973  ols_mask, id_lis
+00005810: 7420 3d20 6964 5f6c 6973 742c 0a20 2020  t = id_list,.   
+00005820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005830: 2076 6572 626f 7365 203d 2054 7275 652c   verbose = True,
+00005840: 2070 6174 6820 3d20 272e 2f6d 646e 7079   path = './mdnpy
+00005850: 2f27 2c20 6261 7463 685f 7369 7a65 203d  /', batch_size =
+00005860: 2031 3030 290a 2020 2020 727a 2e67 6574   100).    rz.get
+00005870: 5f6d 656d 5f63 7572 2829 3b20 727a 2e67  _mem_cur(); rz.g
+00005880: 6574 5f6d 656d 5f6d 6178 2829 2020 2020  et_mem_max()    
+00005890: 0a20 2020 2022 2222 2020 200a 2020 2020  .    """   .    
+000058a0: 2320 726d 0a20 2020 206f 732e 6d61 6b65  # rm.    os.make
+000058b0: 6469 7273 2870 6174 682c 2065 7869 7374  dirs(path, exist
+000058c0: 5f6f 6b3d 5472 7565 290a 2020 2020 6966  _ok=True).    if
+000058d0: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
+000058e0: 6627 7b70 6174 687d 2f7b 6461 7461 5f6e  f'{path}/{data_n
+000058f0: 616d 657d 2729 3a0a 2020 2020 2020 2020  ame}'):.        
+00005900: 6f73 2e73 7973 7465 6d28 6627 726d 207b  os.system(f'rm {
+00005910: 7061 7468 7d2f 7b64 6174 615f 6e61 6d65  path}/{data_name
+00005920: 7d27 290a 2020 2020 666f 7220 6d69 2c20  }').    for mi, 
+00005930: 636f 6c20 696e 2065 6e75 6d65 7261 7465  col in enumerate
+00005940: 2863 6f6c 735f 6d61 736b 293a 0a20 2020  (cols_mask):.   
+00005950: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+00005960: 6578 6973 7473 2866 277b 7061 7468 7d2f  exists(f'{path}/
+00005970: 6d61 736b 5f7b 636f 6c7d 2e6e 7079 2729  mask_{col}.npy')
+00005980: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
+00005990: 2e73 7973 7465 6d28 6627 726d 207b 7061  .system(f'rm {pa
+000059a0: 7468 7d2f 6d61 736b 5f7b 636f 6c7d 2e6e  th}/mask_{col}.n
+000059b0: 7079 2729 0a20 2020 200a 2020 2020 2320  py').    .    # 
+000059c0: 7368 6170 650a 2020 2020 7368 6170 6520  shape.    shape 
+000059d0: 3d20 5b6c 656e 2878 2920 666f 7220 7820  = [len(x) for x 
+000059e0: 696e 2069 645f 6c69 7374 5d0a 2020 2020  in id_list].    
+000059f0: 6461 7461 5f73 6861 7065 203d 2028 2a73  data_shape = (*s
+00005a00: 6861 7065 2c20 6c65 6e28 636f 6c73 5f64  hape, len(cols_d
+00005a10: 6174 6129 290a 2020 2020 6d61 736b 5f73  ata)).    mask_s
+00005a20: 6861 7065 203d 2074 7570 6c65 2873 6861  hape = tuple(sha
+00005a30: 7065 290a 2020 2020 2020 2020 0a20 2020  pe).        .   
+00005a40: 2023 2066 6f72 2065 6163 6820 6261 7463   # for each batc
+00005a50: 680a 2020 2020 6964 5f6c 6973 745f 3020  h.    id_list_0 
+00005a60: 3d20 6964 5f6c 6973 745b 305d 2e63 6f70  = id_list[0].cop
+00005a70: 7928 290a 2020 2020 6e20 3d20 6c65 6e28  y().    n = len(
+00005a80: 6964 5f6c 6973 745f 3029 0a20 2020 2070  id_list_0).    p
+00005a90: 696a 203d 206c 6973 7428 7261 6e67 6528  ij = list(range(
+00005aa0: 302c 206e 2c20 6261 7463 685f 7369 7a65  0, n, batch_size
+00005ab0: 2929 0a20 2020 2070 696a 202b 3d20 5b6e  )).    pij += [n
+00005ac0: 5d20 6966 2070 696a 5b2d 315d 2021 3d20  ] if pij[-1] != 
+00005ad0: 6e20 656c 7365 205b 5d0a 2020 2020 7267  n else [].    rg
+00005ae0: 203d 2074 7164 6d28 7261 6e67 6528 6c65   = tqdm(range(le
+00005af0: 6e28 7069 6a29 202d 2031 292c 206e 636f  n(pij) - 1), nco
+00005b00: 6c73 3d31 3030 2c20 6173 6369 693d 5472  ls=100, ascii=Tr
+00005b10: 7565 2920 6966 2076 6572 626f 7365 2065  ue) if verbose e
+00005b20: 6c73 6520 7261 6e67 6528 6c65 6e28 7069  lse range(len(pi
+00005b30: 6a29 202d 2031 290a 2020 2020 666f 7220  j) - 1).    for 
+00005b40: 6920 696e 2072 673a 0a20 2020 2020 2020  i in rg:.       
+00005b50: 2070 692c 2070 6a20 3d20 7069 6a5b 695d   pi, pj = pij[i]
+00005b60: 2c20 7069 6a5b 6920 2b20 315d 0a20 2020  , pij[i + 1].   
+00005b70: 2020 2020 2069 645f 6c69 7374 5b30 5d20       id_list[0] 
+00005b80: 3d20 6964 5f6c 6973 745f 305b 7069 3a20  = id_list_0[pi: 
+00005b90: 706a 5d0a 2020 2020 2020 2020 0a20 2020  pj].        .   
+00005ba0: 2020 2020 2061 5f64 6174 612c 2061 5f6d       a_data, a_m
+00005bb0: 6173 6b2c 2069 645f 6c69 7374 5f72 6574  ask, id_list_ret
+00005bc0: 203d 205c 0a20 2020 2020 2020 2020 2020   = \.           
+00005bd0: 2074 6f5f 6d64 6e70 7928 646d 5f64 6963   to_mdnpy(dm_dic
+00005be0: 742c 2063 6f6c 735f 6964 2c20 636f 6c73  t, cols_id, cols
+00005bf0: 5f64 6174 612c 2063 6f6c 735f 6d61 736b  _data, cols_mask
+00005c00: 2c20 6964 5f6c 6973 7420 3d20 6964 5f6c  , id_list = id_l
+00005c10: 6973 742c 2066 7265 655f 7261 7720 3d20  ist, free_raw = 
+00005c20: 4661 6c73 6529 0a20 2020 2020 2020 200a  False).        .
+00005c30: 2020 2020 2020 2020 2320 6475 6d70 0a20          # dump. 
+00005c40: 2020 2020 2020 2064 756d 705f 6e70 7928         dump_npy(
+00005c50: 615f 6461 7461 2c20 6627 7b70 6174 687d  a_data, f'{path}
+00005c60: 2f7b 6461 7461 5f6e 616d 657d 272c 2070  /{data_name}', p
+00005c70: 692c 2070 6a2c 2064 6174 615f 7368 6170  i, pj, data_shap
+00005c80: 6529 0a20 2020 2020 2020 2066 6f72 206d  e).        for m
+00005c90: 692c 2063 6f6c 2069 6e20 656e 756d 6572  i, col in enumer
+00005ca0: 6174 6528 636f 6c73 5f6d 6173 6b29 3a0a  ate(cols_mask):.
+00005cb0: 2020 2020 2020 2020 2020 2020 6475 6d70              dump
+00005cc0: 5f6e 7079 2861 5f6d 6173 6b5b 2e2e 2e2c  _npy(a_mask[...,
+00005cd0: 206d 695d 2c20 6627 7b70 6174 687d 2f6d   mi], f'{path}/m
+00005ce0: 6173 6b5f 7b63 6f6c 7d2e 6e70 7927 2c20  ask_{col}.npy', 
+00005cf0: 7069 2c20 706a 2c20 6d61 736b 5f73 6861  pi, pj, mask_sha
+00005d00: 7065 290a 2020 2020 2020 2020 6465 6c20  pe).        del 
+00005d10: 615f 6461 7461 2c20 615f 6d61 736b 2c20  a_data, a_mask, 
+00005d20: 6964 5f6c 6973 745f 7265 743b 2067 632e  id_list_ret; gc.
+00005d30: 636f 6c6c 6563 7428 290a 2020 2020 2020  collect().      
+00005d40: 2020 6966 2076 6572 626f 7365 3a20 6765    if verbose: ge
+00005d50: 745f 6d65 6d5f 6375 7228 293b 2067 6574  t_mem_cur(); get
+00005d60: 5f6d 656d 5f6d 6178 2829 0a20 2020 200a  _mem_max().    .
+00005d70: 2020 2020 2320 6475 6d70 2069 645f 6c69      # dump id_li
+00005d80: 7374 0a20 2020 2069 645f 6c69 7374 5b30  st.    id_list[0
+00005d90: 5d20 3d20 6964 5f6c 6973 745f 3020 0a0a  ] = id_list_0 ..
+00005da0: 2020 2020 0a5c 275c 275c 270a 7368 6170      .\'\'\'.shap
+00005db0: 6520 3d20 2831 3020 2a20 3234 3020 2a20  e = (10 * 240 * 
+00005dc0: 3530 3030 2c20 3230 3030 290a 6120 3d20  5000, 2000).a = 
+00005dd0: 727a 2e75 7469 6c2e 6e70 795f 6e75 6d62  rz.util.npy_numb
+00005de0: 612e 6e70 5f72 616e 646f 6d5f 7261 6e64  a.np_random_rand
+00005df0: 6f6d 2873 6861 7065 290a 727a 2e75 7469  om(shape).rz.uti
+00005e00: 6c2e 6e70 792e 727a 5f64 756d 705f 6e70  l.npy.rz_dump_np
+00005e10: 7928 612c 2027 2f68 6f6d 652f 7278 2f74  y(a, '/home/rx/t
+00005e20: 6573 745f 3035 3330 2f62 2e6e 7079 272c  est_0530/b.npy',
+00005e30: 2076 6572 626f 7365 203d 2054 7275 652c   verbose = True,
+00005e40: 206e 5f6a 6f62 733d 3136 2c20 6b74 696d   n_jobs=16, ktim
+00005e50: 6573 3d31 3029 0a0a 2320 7368 6170 6520  es=10)..# shape 
+00005e60: 3d20 2832 3430 302c 2035 3030 302c 2032  = (2400, 5000, 2
+00005e70: 3030 3029 0a23 2061 203d 206e 702e 6c6f  000).# a = np.lo
+00005e80: 6164 2870 6174 6829 2023 2031 3373 0a0a  ad(path) # 13s..
+00005e90: 2320 6120 3d20 727a 2e75 7469 6c2e 6e70  # a = rz.util.np
+00005ea0: 792e 6c6f 6164 5f6e 7079 2870 6174 6829  y.load_npy(path)
+00005eb0: 2023 2031 3373 0a23 2061 203d 2072 7a2e   # 13s.# a = rz.
+00005ec0: 7574 696c 2e6e 7079 2e72 7a5f 6c6f 6164  util.npy.rz_load
+00005ed0: 5f6e 7079 2870 6174 682c 2076 6572 626f  _npy(path, verbo
+00005ee0: 7365 203d 2054 7275 652c 206e 5f6a 6f62  se = True, n_job
+00005ef0: 7320 3d20 312c 206b 7469 6d65 7320 3d20  s = 1, ktimes = 
+00005f00: 3129 2023 2037 3373 2c20 e5a4 9ae4 ba86  1) # 73s, ......
+00005f10: 615b 7031 3a70 325d 203d 2061 0a23 2061  a[p1:p2] = a.# a
+00005f20: 203d 2072 7a2e 7574 696c 2e6e 7079 2e72   = rz.util.npy.r
+00005f30: 7a5f 6c6f 6164 5f6e 7079 2870 6174 682c  z_load_npy(path,
+00005f40: 2076 6572 626f 7365 203d 2054 7275 652c   verbose = True,
+00005f50: 206e 5f6a 6f62 7320 3d20 3136 2c20 6b74   n_jobs = 16, kt
+00005f60: 696d 6573 203d 2031 3029 2023 2034 2e36  imes = 10) # 4.6
+00005f70: 730a 0a23 2061 203d 2072 7a2e 7574 696c  s..# a = rz.util
+00005f80: 2e6e 7079 2e6c 6f61 645f 6e70 7928 7061  .npy.load_npy(pa
+00005f90: 7468 2c20 636f 6c73 203d 206e 702e 6172  th, cols = np.ar
+00005fa0: 616e 6765 2832 3030 3029 2920 2320 3635  ange(2000)) # 65
+00005fb0: 732c 2073 6c6f 770a 2320 6120 3d20 727a  s, slow.# a = rz
+00005fc0: 2e75 7469 6c2e 6e70 792e 727a 5f6c 6f61  .util.npy.rz_loa
+00005fd0: 645f 6e70 7928 7061 7468 2c20 636f 6c73  d_npy(path, cols
+00005fe0: 203d 206e 702e 6172 616e 6765 2832 3030   = np.arange(200
+00005ff0: 3029 2c20 7665 7262 6f73 6520 3d20 5472  0), verbose = Tr
+00006000: 7565 2c20 6e5f 6a6f 6273 203d 2031 362c  ue, n_jobs = 16,
+00006010: 206b 7469 6d65 7320 3d20 3230 2920 2320   ktimes = 20) # 
+00006020: 3130 730a 0a23 2072 6561 6420 3264 2c20  10s..# read 2d, 
+00006030: 616c 6c20 726f 7773 2c20 7061 7274 2063  all rows, part c
+00006040: 6f6c 730a 2320 6120 3d20 727a 5f6c 6f61  ols.# a = rz_loa
+00006050: 645f 6e70 795f 6964 785f 6d75 6c74 6928  d_npy_idx_multi(
+00006060: 5b70 6174 682c 2070 6174 685d 2c20 4e6f  [path, path], No
+00006070: 6e65 2c20 636f 6c73 5f6c 6973 7420 3d20  ne, cols_list = 
+00006080: 5b6e 702e 6172 616e 6765 2830 2c20 3130  [np.arange(0, 10
+00006090: 3030 292c 206e 702e 6172 616e 6765 2831  00), np.arange(1
+000060a0: 3030 302c 2032 3030 3029 5d2c 2076 6572  000, 2000)], ver
+000060b0: 626f 7365 3d54 7275 652c 206e 5f6a 6f62  bose=True, n_job
+000060c0: 7320 3d31 362c 206b 7469 6d65 7320 3d20  s =16, ktimes = 
+000060d0: 3130 2c20 626c 6f63 6b5f 7369 7a65 203d  10, block_size =
+000060e0: 2034 3030 3029 2023 2032 3073 0a0a 7368   4000) # 20s..sh
+000060f0: 6170 6520 3d20 2832 3430 302c 2035 3030  ape = (2400, 500
+00006100: 302c 2032 3030 3029 0a69 6478 203d 206e  0, 2000).idx = n
+00006110: 702e 7261 6e64 6f6d 2e70 6572 6d75 7461  p.random.permuta
+00006120: 7469 6f6e 286e 702e 7072 6f64 2873 6861  tion(np.prod(sha
+00006130: 7065 5b3a 325d 2929 0a69 6478 203d 206e  pe[:2])).idx = n
+00006140: 702e 736f 7274 2869 6478 5b3a 6c65 6e28  p.sort(idx[:len(
+00006150: 6964 7829 202f 2f20 325d 290a 6120 3d20  idx) // 2]).a = 
+00006160: 727a 2e75 7469 6c2e 6e70 792e 727a 5f6c  rz.util.npy.rz_l
+00006170: 6f61 645f 6e70 795f 6964 7828 7061 7468  oad_npy_idx(path
+00006180: 2c20 6964 782c 2076 6572 626f 7365 203d  , idx, verbose =
+00006190: 2054 7275 652c 206e 5f6a 6f62 7320 3d20   True, n_jobs = 
+000061a0: 3136 2c20 6b74 696d 6573 203d 2031 2c20  16, ktimes = 1, 
+000061b0: 626c 6f63 6b5f 7369 7a65 203d 204e 6f6e  block_size = Non
+000061c0: 6529 2023 2031 3273 0a0a 2320 e69c 80e4  e) # 12s..# ....
+000061d0: bdb3 e5ae 9ee8 b7b5 0a31 2920 727a 5f6c  .........1) rz_l
+000061e0: 6f61 645f 6e70 795f 6964 782c 2066 6f72  oad_npy_idx, for
+000061f0: 2069 6478 0a20 2020 2061 203d 2072 7a2e   idx.    a = rz.
+00006200: 7574 696c 2e6e 7079 2e72 7a5f 6c6f 6164  util.npy.rz_load
+00006210: 5f6e 7079 5f69 6478 2870 6174 682c 2069  _npy_idx(path, i
+00006220: 6478 2c20 7665 7262 6f73 6520 3d20 5472  dx, verbose = Tr
+00006230: 7565 2c20 6e5f 6a6f 6273 203d 2031 362c  ue, n_jobs = 16,
+00006240: 206b 7469 6d65 7320 3d20 312c 2062 6c6f   ktimes = 1, blo
+00006250: 636b 5f73 697a 6520 3d20 4e6f 6e65 2920  ck_size = None) 
+00006260: 2320 3132 730a 2020 2020 6475 6d70 2032  # 12s.    dump 2
+00006270: 6420 6d61 7472 6978 0a0a 3229 2072 7a5f  d matrix..2) rz_
+00006280: 6c6f 6164 5f6e 7079 5f69 6478 5f6d 756c  load_npy_idx_mul
+00006290: 7469 2c20 666f 7220 636f 6c73 0a20 2020  ti, for cols.   
+000062a0: 2061 203d 2072 7a5f 6c6f 6164 5f6e 7079   a = rz_load_npy
+000062b0: 5f69 6478 5f6d 756c 7469 285b 7061 7468  _idx_multi([path
+000062c0: 2c20 7061 7468 5d2c 204e 6f6e 652c 2063  , path], None, c
+000062d0: 6f6c 735f 6c69 7374 203d 205b 6e70 2e61  ols_list = [np.a
+000062e0: 7261 6e67 6528 302c 2031 3030 3029 2c20  range(0, 1000), 
+000062f0: 6e70 2e61 7261 6e67 6528 3130 3030 2c20  np.arange(1000, 
+00006300: 3230 3030 295d 2c20 7665 7262 6f73 653d  2000)], verbose=
+00006310: 5472 7565 2c20 6e5f 6a6f 6273 203d 3136  True, n_jobs =16
+00006320: 2c20 6b74 696d 6573 203d 2031 302c 2062  , ktimes = 10, b
+00006330: 6c6f 636b 5f73 697a 6520 3d20 3430 3030  lock_size = 4000
+00006340: 2920 2320 3230 730a 5c27 5c27 5c27 7a06  ) # 20s.\'\'\'z.
+00006350: 5c27 5c27 5c27 7a03 2727 27da 0177 2907  \'\'\'z.'''..w).
+00006360: da02 6f73 da04 7061 7468 da07 6469 726e  ..os..path..dirn
+00006370: 616d 65da 085f 5f66 696c 655f 5fda 0772  ame..__file__..r
+00006380: 6570 6c61 6365 da04 6f70 656e da05 7772  eplace..open..wr
+00006390: 6974 6529 04da 066f 7574 7075 745a 0b70  ite)...outputZ.p
+000063a0: 6174 685f 6f75 7470 7574 da01 73da 0166  ath_output..s..f
+000063b0: a900 720e 0000 00fa 3a62 7569 6c64 2f62  ..r.....:build/b
+000063c0: 6469 7374 2e6d 6163 6f73 782d 3130 2e39  dist.macosx-10.9
+000063d0: 2d78 3836 5f36 342f 6567 672f 7275 6e6e  -x86_64/egg/runn
+000063e0: 696e 677a 2f75 7469 6c2f 6e70 795f 7079  ingz/util/npy_py
+000063f0: 2e70 79da 0372 756e 0400 0000 7312 0000  .py..run....s...
+00006400: 0000 0114 0104 7f00 7f00 7f00 7f00 6a0c  ..............j.
+00006410: 010c 0172 1000 0000 da08 5f5f 6d61 696e  ...r......__main
+00006420: 5f5f 7a08 2d2d 6f75 7470 7574 5429 02da  __z.--outputT)..
+00006430: 0474 7970 65da 0872 6571 7569 7265 6429  .type..required)
+00006440: 0c72 0400 0000 da03 7379 7372 1000 0000  .r......sysr....
+00006450: da08 5f5f 6e61 6d65 5f5f da08 6172 6770  ..__name__..argp
+00006460: 6172 7365 da0e 4172 6775 6d65 6e74 5061  arse..ArgumentPa
+00006470: 7273 6572 da06 7061 7273 6572 da0c 6164  rser..parser..ad
+00006480: 645f 6172 6775 6d65 6e74 da03 7374 72da  d_argument..str.
+00006490: 0a70 6172 7365 5f61 7267 73da 0461 7267  .parse_args..arg
+000064a0: 7372 0b00 0000 720e 0000 0072 0e00 0000  sr....r....r....
+000064b0: 720e 0000 0072 0f00 0000 da08 3c6d 6f64  r....r......<mod
+000064c0: 756c 653e 0200 0000 7318 0000 0008 0108  ule>....s.......
+000064d0: 0108 7f00 7f00 7f00 7f00 7008 0108 0108  ..........p.....
+000064e0: 0110 0108 01                             .....
```

## runningz/util/test_py.pyc

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Fri May 31 14:45:40 2024 UTC, .py size: 7255 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 94e2 5966 571c 0000  a.........YfW...
+00000000: 610d 0d0a 0000 0000 bc9c 5c66 571c 0000  a.........\fW...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 5600 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a00 6400 6401 6c01 5a01 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 8400 5a02 6503 6404 6b02 7252 6400  d...Z.e.d.k.rRd.
 00000050: 6401 6c04 5a04 6504 a005 a100 5a06 6506  d.l.Z.e.....Z.e.
 00000060: 6a07 6405 6508 6406 6407 8d03 0100 6506  j.d.e.d.d.....e.
 00000070: a009 a100 5a0a 6502 650a 6a0b 8301 0100  ....Z.e.e.j.....
```

## Comparing `runningz-0.16.4.dist-info/RECORD` & `runningz-0.16.5.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,23 +1,23 @@
 runningz/.gitignore,sha256=2PnT92rNjvJIdZJRlw65BllfDzmxlteLcGOxAPCDFpY,196
-runningz/__init__.pyc,sha256=Brhia07UKpw_Gz9JV1m0AZj4ySVRLkKnJ-gUiX1KoUg,1299
+runningz/__init__.pyc,sha256=pI1N5DEmHKv76vKYgK7NyoAPf7R2waFBmqTRQab6pks,1299
 runningz/api.pyc,sha256=RKrNXhZAbCuq7RJX1EcSVYzjVgAew4Eo3JhdLCYloyU,186
 runningz/core/DataMaster.pyc,sha256=S8UbdIPVfUiTRpVkfUX75a7g7WpwvWiRc8544L0R0-8,18311
 runningz/core/__init__.pyc,sha256=QCBebMNvhe3fWRkv8vWOA0yerZUrPPO6jwXFDmU3dKg,151
 runningz/core/api.pyc,sha256=aNJrgOHktign7G1_Hkdcgc8MwbY7F0Bn7ZijeXzwGmo,3856
 runningz/core/er/__init__.pyc,sha256=X_qSA5MvcnWpGi_boqjQZ6kSfAmGgjUXpvkqa-6kwuQ,154
 runningz/core/er/hasher.pyc,sha256=m5R_HNzBmjnhAZAAUXu8sYYhkMYiEPOBngv-rcZ_SX8,572
 runningz/core/er/idxer.pyc,sha256=UtRjQIG1gYD1zGwS4BeTAUUKumeztGIVex0ZPrspQYc,651
 runningz/core/er/masker.pyc,sha256=JkbKeuW68AtDP-4jW8CAx-NQUa2yvrPv2uDDf3b2Jyg,573
 runningz/core/er/namer.pyc,sha256=jbsrt_681kgVn83k7wyJjgaAkG_--KkEDKAZCsvys8E,9357
 runningz/core/er/scaler.pyc,sha256=z-77F9YAX5zJXYGJFkFsfTxVS0br2uAojZfTMmBs414,550
 runningz/core/op/OPMaster.pyc,sha256=5m6qOe0L3gsEi6l3T8H9LHVsF1iGqMc8sXxrvH-Uu4c,7484
-runningz/core/op/OPMaster_py.pyc,sha256=fyKBnN6_HZr22UYuM-RErHrNi0qYXQ0YSc5bV8IGU98,15662
+runningz/core/op/OPMaster_py.pyc,sha256=0q475F_6PCFXc25lcpbvpbkiPq1xzPAgl-OIoBhJvBc,15662
 runningz/core/op/__init__.pyc,sha256=HTwyx7showFNZVKRzFD4ZWDoa-Bf4ZG9OJY8mAu647w,6671
-runningz/core/op/__init___py.pyc,sha256=vEm7zUvghzMbKx-rU1h1foSUBi64jt7Ld5altYjpUGE,7346
+runningz/core/op/__init___py.pyc,sha256=WZNsUSj_jdEKbdIULM_Rfhfq55IXQ2m_9TAKtGbCGeA,7346
 runningz/core/op/_numba.pyc,sha256=RyrgcV17NuzdULgofkDrYy3G-RT3EAt_V0aAeBWVcDw,11402
 runningz/core/op/_numba_1.pyc,sha256=5pw7Bw1FkgcxgPjKfVZPDpvwLj2TUpI8SOAbGKVBdxU,24188
 runningz/core/op/_numba_2.pyc,sha256=nugIiRQeD64yvCr8J6qP1Ojbz6mx_4fxlbTflcRBXVo,27784
 runningz/core/op/_numba_2_2.pyc,sha256=jtBN10GA0bj7ci32xbqbJ46A8ETnGHi-j-5QN8COwv0,17533
 runningz/core/op/_numba_merge_roll.pyc,sha256=vlpr49CiPNy8aDrA0sG_hYWHT-S68OxEFI7eVYJT_AU,6742
 runningz/core/op/op_1.pyc,sha256=J9SjPBX7U_FRNBsQC2ZkXJF2saL2F7ARjykGObWxzw0,9392
 runningz/core/op/op_1_numba.pyc,sha256=OxKBVswDsHXHMnIYrLSyECWoF9DMWJ42TzPLlyU15Qo,13877
@@ -28,51 +28,51 @@
 runningz/core/op/op_3_numba.pyc,sha256=J-1zgpPKzo8omFBzeNs47oQSOwd5OJ6CMEdpvPwKBPg,7119
 runningz/core/op/op_groupby.pyc,sha256=JWVvhHh3NuEWPeEmWWijFcellUNT0keGURNQs66cLJY,3788
 runningz/core/op/op_m.pyc,sha256=uE3QFbpcnbDnMWizWaaKZjp23ewo4VhsC81MBWyLW5M,3575
 runningz/core/op/op_m_numba.pyc,sha256=860BOhBUsXIGm6E5wXu1zX4nw3FZ-0XRu1VtN2dpewg,5128
 runningz/core/op/op_other.pyc,sha256=XrxOFIGu1nELWw1A8W2Foa8g6LPzGfNw0uX6F3thPVI,8705
 runningz/fe/.gitignore,sha256=hHBi8ZlV4ltnxGsnVdQuzcBcUempQhukAdFcnnBqy2Q,15
 runningz/fe/FEMaster.pyc,sha256=5IVfLLMBmpd59_IQE9skO7wrw1MzA0THZ89KqobeVVI,14548
-runningz/fe/FEMaster_py.pyc,sha256=egszRwUWGsG6Gdp9TPn3SWsiosdOF2IRrTjLHW6BWBo,23960
+runningz/fe/FEMaster_py.pyc,sha256=2ZGyZeNyKjEg-M_TJInmIvQrPRGnrTgUU5LHYDEgqdo,23960
 runningz/fe/__init__.pyc,sha256=2_vUy08HEb1-PVEqHBG8_uAZIYrYdR_7J9wRhzJqwh8,178
 runningz/fe/fe_dump.pyc,sha256=NWwdT8-6xcrW3I0r2hY9Nd5mI5bnrG0ExRYXaO7XJ_w,2487
-runningz/fe/fe_dump_py.pyc,sha256=tkUJ2QJk0nfYttz68MMPPevXon6jHBHOHRptKjawq9I,3708
+runningz/fe/fe_dump_py.pyc,sha256=zMdSj740L6SV39IPb3vZOqTIgrICHOspsyzVcd99jq8,3708
 runningz/fe/fe_eval.pyc,sha256=_oVkksJREViY9kRoqZqliX0d3wxy5HZ_en6Cr3J2XDs,4481
-runningz/fe/fe_eval_py.pyc,sha256=13HpNPvJO8bVeOXReK04c1iS_D7SgqQYvWm8s_7Qglw,7299
+runningz/fe/fe_eval_py.pyc,sha256=wTCLDBcIxH-hKx--TMB5thREjuCHFf26YiKSzf5LQew,7299
 runningz/fe/fe_main.pyc,sha256=oCwvlN_E4ot8KWEgeJueh23ne2y2N7zr9E4ZbefbZiM,4850
-runningz/fe/fe_main_py.pyc,sha256=gUOZZ_dKyYqGXvl-1ElHtH-IU59s7RCLVXsLz1KaiBI,8473
+runningz/fe/fe_main_py.pyc,sha256=Wf9TFtU1q8ObRwM451NJLEwgVO_ySz4Bs9LgROfch5Y,8473
 runningz/fe/config/__init__.pyc,sha256=q7MDowHyfmiAZaxv-qXSh7ezQovtmTx3yW8VUeGC4vE,156
 runningz/fe/config/cols_dict.pyc,sha256=w1kpbbHYak-W5fLkA5SZbc5bnBmc3LTui_FBTclFwyk,11438
 runningz/fe/config/cols_fea.pyc,sha256=tQhxeuKgeJX_eH0xiT-mgP8Oz7OCS1RjuZRFYN5PFEM,74158
 runningz/fe/config/fm_config.pyc,sha256=2-er7s4G7PG6CZ7WfbXNYbA_GoPeXh6fwI3yEGZyAjc,1274
 runningz/fe/config/fm_config_opt.pyc,sha256=nFJGM0D5E7nocTABVPSyIRI8ikH5gFNlGV3-mmhNYPk,1919
-runningz/fe/config/fm_config_opt_py.pyc,sha256=u6bBAA8bikPR5-pK0xbNpVUU_0uK_JEh4vq-_8P5YP0,5184
-runningz/fe/config/fm_config_py.pyc,sha256=3H76xeuvWoC6hE1d4z-67U3B-kpDwspzq5lzgC59cEY,5988
+runningz/fe/config/fm_config_opt_py.pyc,sha256=d3Iw4ry6JfDSZdeJxFHUfxrceCfavBMvWto1oCjezkU,5184
+runningz/fe/config/fm_config_py.pyc,sha256=JYri3m53IN_fz4Gcy7nlA12NNOsg0NmpDZcf44SRLVs,5988
 runningz/fe/config/fm_config_top.pyc,sha256=CXDLrgGmWq2FKu7V4-FESNXH9qoA5l_LML51QrOwv5g,5793
-runningz/fe/config/fm_config_top_py.pyc,sha256=dtLAbyz9fyBCb0KBmK7HUOz-VqhAaKAfhGo7d_vVOfg,19957
+runningz/fe/config/fm_config_top_py.pyc,sha256=-FxHWnwYJ-TokmVCJ8ZfAL7I0v9Q-V8lFVUMjsx77X8,19957
 runningz/fe/er/__init__.pyc,sha256=uurZqbqGE1GDBJQJw1vkaJrLmnEqJiMMVqKV5WWDveQ,298
 runningz/fe/er/pather.pyc,sha256=6Y70GcIF7TerQ5G0Goa-t0cNaleD_WCiatN19HwdvRE,3039
 runningz/fe/er/pooler.pyc,sha256=xI_RhNirpSYgph7dGUPZkMC-4IDkEfKcLygw6IfESh0,17161
 runningz/fe/er/pooler_old.pyc,sha256=-6p1cSxjEtna3PjQQfaugtgqJ7pa-yyX860wvxubCVQ,17241
-runningz/fe/er/pooler_py.pyc,sha256=Tg46rl2fW-Q04zAkwW-OboUzx9RgbvokJ8OL8AFMrQE,38247
+runningz/fe/er/pooler_py.pyc,sha256=DE_Dybs5Vr1qN393ZoCK99f2vlodVRrh_u8k9HVegqU,38247
 runningz/fe/er/ranker.pyc,sha256=cj_A2vTxDUiV4jQIEoGenSNhR1cx59Rj1tgvxRuq56Q,8018
-runningz/fe/er/ranker_py.pyc,sha256=osDahJ5JjEepQZhD6MGS7uj84UkFdRKFt7BgFzPe6Jw,12370
+runningz/fe/er/ranker_py.pyc,sha256=cmWv7ndfqsBV1im_sFEmDn0x-1yUv-6V-u0G785BTyQ,12370
 runningz/fe/er/typer.pyc,sha256=hzB_PbW39UFWD5kIPKrImD8hrWmlw6NsUvnN7fc-SB0,5561
 runningz/fe/prepare_data/__init__.pyc,sha256=blGZQ6BoJMvuFphXVYdT21vyAjv4X1PhZ7QhJduDYjE,162
-runningz/fe/prepare_data/base_data.pyc,sha256=NkRafSTZ_2vd5XTix-PgNmV0mvHFwgUgrJ1Rn7tcpuM,13207
-runningz/fe/prepare_data/base_data_py.pyc,sha256=DWt8KG8qqux2kvLNXojCphWsdCHCCyshmQ3mCYh_EnM,20242
+runningz/fe/prepare_data/base_data.pyc,sha256=SHJ5tT_EJAZ2_m0ZwlFPn_Chx2KS6xacahPIlzc7_IY,13461
+runningz/fe/prepare_data/base_data_py.pyc,sha256=OLYOsCUQhodAUbTCa8fSwmX1eWcO5kLS3TuemywDzng,20477
 runningz/fe/prepare_data/basic_data.pyc,sha256=W90IiwttnWMD_ZIqOC7XkR_7NIA9hKHCHVGTj9_7ATY,1554
-runningz/fe/prepare_data/basic_data_py.pyc,sha256=1I4TEeZgVbKfw6D2aTtg0WV1LvWKUIMIYhyJUiT7j3w,2741
+runningz/fe/prepare_data/basic_data_py.pyc,sha256=NzepXMlrFuQLJg4U6Zz0AHrvFv0Zqeel6GpGezs2cGk,2741
 runningz/fe/prepare_data/factor_data.pyc,sha256=paCWWRC5oXRyMPg-6A90ucbBC-NEAnjhyitzjtrQMfs,8499
 runningz/fe/status/__init__.pyc,sha256=c6UCJqWddjdl6cy1fyu0WOBrYWirQejtL8OkuFxNgjQ,193
 runningz/fe/status/status.pyc,sha256=Osvp0TRjijnxTmxoLzIVl4ntUS7ZmkvjiuXg5ece6ew,10623
-runningz/fe/status/status_py.pyc,sha256=vmNSB26vj3OduKumvTZsWcwaMHnOlibcFpZyNkG0yds,16648
+runningz/fe/status/status_py.pyc,sha256=up7hRg66OPDqp5ENWPyBqfp8AVvluQE3BhuGaqKAYMk,16648
 runningz/fe/util/__init__.pyc,sha256=glKAXhLTfBtMxBnasGohn-b5wfUZhr2Myy11I6jNW78,154
 runningz/fe/util/util.pyc,sha256=koBO_xKIkuIKZ58aFlYBcA0gySyM78H7PsCPgk8Rjls,11846
-runningz/fe/util/util_py.pyc,sha256=aDfiWg32IGj2yM-SKa3JsiNtlsTGb-jxUjWKlkMa-BE,14775
+runningz/fe/util/util_py.pyc,sha256=MAZKqbp5YNrmEP8AMdoNSmEPhCCooH1F5hF4r-Ens08,14775
 runningz/metric/__init__.pyc,sha256=L2jH9L5nE6mhbRjHzSVbfIBBjnSyCLJCO0IATv7s_q4,294
 runningz/metric/get_score_metric.pyc,sha256=XJHVw77RTq-G-6E0MHvfe2oAiLA5C959TrSrhvcweTU,1818
 runningz/metric/ic.pyc,sha256=1iMvEajaLLuddxQggmZRV14mHtQZkwv3rzL7CXKVq7U,883
 runningz/metric/metrics.pyc,sha256=0cxQSgRQSkt26XEgylraMWeVbDiG66HefSXXCJAvcIo,3441
 runningz/metric/metrics_numba.pyc,sha256=bfWMGXMIGlkvzbSTx4bNr_d3HzVaRowvPaoBa0Dq6aY,3252
 runningz/model/__init__.pyc,sha256=WgDsn0BpUsR09JJ2DFupw7CbkjTvMIzdUCUwwoP-nik,277
 runningz/model/api.pyc,sha256=_HODf5U3wa-sZ2yIL9NQ-jvrPIkL_Kxx9rmhRh1pQ_A,147
@@ -91,81 +91,81 @@
 runningz/model/linear/model_l2.pyc,sha256=48ktPyxadg_EpSwImC_ucajFzI28LF5gi5gWlc9JQHs,3135
 runningz/model/linear/model_lr.pyc,sha256=0XUX35K-xmPsAQqOtXaswVqSNT4NY2_XZs63XrbIIc8,3931
 runningz/model/linear/model_sgd.pyc,sha256=nSChiqRTH3KY9DAu3QvAEB4Ej9NzOHS4NqLFPSjcOWg,3245
 runningz/model/nn/__init__.pyc,sha256=7NuqrrBMzqRrkM8QnoCvvOQRBheJKF4_1YmTa-IHJbc,197
 runningz/model/nn/model_cnn.pyc,sha256=HDTFBn6aUuDQy6ejt6VhJ9H_WVWrIxd9fpFdD4mbhj0,156
 runningz/model/nn/model_deep_wide.pyc,sha256=1aNS5uIw9dO9Zfhvo0g9E_WlCkAzKN-13c6-jT7XmZg,162
 runningz/model/nn/model_lstm.pyc,sha256=ijY-gN7DGnu_En9bc3ckRlfZAOqPD3EQtJPqkmzMiEI,157
-runningz/model/nn/model_mlp.pyc,sha256=UpO77RX1DNaDymEtNrfV9XjfAPyhCnYPZ79zVJ52yMg,6022
-runningz/model/nn/model_mlp_py.pyc,sha256=JSH2olouPN_h-QoeXWH70dCdnAjHwPw6ObiQZamqV_Q,11745
+runningz/model/nn/model_mlp.pyc,sha256=eer7sq8ILtBV2TDWi-5Snc0zOJGtcxsthVneX8jcLWY,6022
+runningz/model/nn/model_mlp_py.pyc,sha256=ULCaR0_na3qmM75fCty5-DExvPGj0KEDR1AmTiNPy4U,11745
 runningz/model/nn/model_moe.pyc,sha256=EtyRdfnefqcA-e1SqWtC5CN_ADjanrd4rp75UziBg7o,156
 runningz/model/nn/model_rxnet.pyc,sha256=pHFIxF_eZJ9hIdGGqIpsEZPAxJhc-pKioa_euTXVBG4,4888
 runningz/model/nn/model_tabnet.pyc,sha256=ZM9IBlnHETCEEErcxK6Y84NmoqzQO-cFuwv2gVyuW5I,159
 runningz/model/nn/nn_util.pyc,sha256=_10R8jL62E_LTd9RLcCBSpWTcVL5HzzVMaz4_MkBPDo,14568
-runningz/model/nn/nn_util_py.pyc,sha256=ap1X9laJOUfcfem_Wq-dHlFsOO1xjjInIjBYFF2mMNc,16916
+runningz/model/nn/nn_util_py.pyc,sha256=np9NRnZpqYpre5xLXn2VhJOqFFyrZ0UmRGbyobnIrOI,16916
 runningz/model/tree/__init__.pyc,sha256=xkzPRkgdncRr8BI0U0x8RYAj6h_iHwSjB7zS04-5sgM,365
-runningz/model/tree/model_cat.pyc,sha256=yOPRT2wRcM-5A5aASGynwdCg4GeCvk_lA_ExabHvVl4,4689
-runningz/model/tree/model_cat_py.pyc,sha256=QBBJsmePsstQ55bcNcjfF3oZROLpN1U-YVVPQTJGi3Y,8214
+runningz/model/tree/model_cat.pyc,sha256=TsqGaz4qMW17tfOfrRcISMhUS7nU52eZ-l8R20RRVC4,5239
+runningz/model/tree/model_cat_py.pyc,sha256=AGjI2AlBrNjGeyju4RsA5pvmcQHrcUGzm5j-lz6HpUQ,9150
 runningz/model/tree/model_erf.pyc,sha256=oKjlNUDUxrhvkkxHBBVn-KKz04ZhWUgu4MDTKlJNOO0,2815
-runningz/model/tree/model_lgb.pyc,sha256=O-ECs_IIPW7jwfoDkoLqS1NdtW5brAorSHQjLSBnfrU,8323
-runningz/model/tree/model_lgb_py.pyc,sha256=NPboFrrbE2vD02sMedM6_6cEHP-gEMOvqMstoxnd4hU,12185
+runningz/model/tree/model_lgb.pyc,sha256=ythhezBmiXoj6g9cHkeFydBHANlMPUM2Dq9Wd0rV3mk,8440
+runningz/model/tree/model_lgb_py.pyc,sha256=-T06dxW0GjmjTIoLtT_f-aEQDELkIWc4FvAmvUU0veE,12393
 runningz/model/tree/model_rf.pyc,sha256=AKvS311eWYtadhbElEw7gzsBMBywnTGKvaREwoShLCc,2829
 runningz/model/tree/model_xgb.pyc,sha256=WvC85WVDAIG43fY7E3PQ6-iWRKARVXvfskQCSch4vhM,3677
 runningz/opt/__init__.pyc,sha256=u2wdHAljgvyfwoazHDwCf0_34cQUCU4qQ4kqbJiWbrE,349
 runningz/opt/opt_convex.pyc,sha256=Tpt_lMeAMTfURZQ99nP_psn2LwAPueSgXI8AXtOIb78,152
 runningz/opt/opt_elo.pyc,sha256=h1b3-iYFWZvSrj3JuJn_z0vm9d4q5p2WNQRraFa4OHo,12130
 runningz/opt/opt_optuna.pyc,sha256=Qp_US7ez4-WbbPiofF9qaIY_TumZU979IiH6tv9fyLE,2320
 runningz/opt/opt_random.pyc,sha256=_C32uz2gxLVWLvwiPIDdb78Z8hQUBQQ5G1R96IUNB2A,6914
-runningz/opt/opt_random_py.pyc,sha256=WP4rCizwJEowKCOcdlLgNcQLMmuZDPpRTWGdIwaRjBE,9665
+runningz/opt/opt_random_py.pyc,sha256=6WfWT8ut4exrvgZEfM0iN_AQ43caNNMeFFOu_zKdrDE,9665
 runningz/opt/opt_scipy.pyc,sha256=_A-_nULPtl4IGaGHnGJlVRd0Ma4gzAwxCU93KO3NLMI,927
 runningz/opt/opt_sgd.pyc,sha256=vYxDt7l80n9yWELHN1_mLQqvfuvWLrzAIhe__v3auXc,3556
 runningz/res/__init__.pyc,sha256=q6ZWBqFGo4VmQ6wcPcELc7leWktE8aTCwAx5XWxnxLU,150
 runningz/res/res_dates.pyc,sha256=ziX-58AjirUURtm1p6XO8Xeb7-UAugKngoRZT-8CPRg,1180
-runningz/res/res_dates_py.pyc,sha256=tKzMhbtYJCSR-yf0d4UJLPNXoH4SwuQtPrLiDVDXJIs,1498
+runningz/res/res_dates_py.pyc,sha256=YTwbcRDPJxLzQj-zXRZj_4A6M6xTJTpUm-EdP1Uileo,1498
 runningz/res/res_labels.pyc,sha256=EsSNljN339bR8sQWn6EMi6OmWmZrIepIP1LhjUufTEw,1680
-runningz/res/res_labels_py.pyc,sha256=7mWrNDNTdQ18RYGH6S1XsvB814FejP0snSIC78RTwvc,3050
+runningz/res/res_labels_py.pyc,sha256=Krl7XIBogtezQmUZ85YO6NJY1jNkoUzHpG1uGXMvG10,3050
 runningz/res/res_main.pyc,sha256=8EixHuAI0rUlgr5W5gOmzfCBjPmTzgm2rr-PznbuBI0,11914
-runningz/res/res_main_py.pyc,sha256=jxdLFIoglcldLckDd66aNMsCUjjdUaFUktEPOVNfssE,21483
+runningz/res/res_main_py.pyc,sha256=t_WxJWxnAIqPXiJOJGEAKOgHAlr-a5oHQlwjIUJJujY,21483
 runningz/res/res_run.pyc,sha256=_aAueXnNT2YDZCa_gCOSqxRDrupyJsiLLNcP_oWteFs,301
-runningz/res/res_run_py.pyc,sha256=7cu_Nm5-OKOt3SJPE7QuK7AnaJ138T_fwj7fWfXP3-g,1993
+runningz/res/res_run_py.pyc,sha256=Zn_ODvgf8M3yNQti6BrA1sSiotuM0RKN92oPlVs1h18,1993
 runningz/res/res_seeds.pyc,sha256=LjWKMqCvMMg_fFxcaywNMtBgcnE9VssDx4d_Aqg7Q-o,971
-runningz/res/res_seeds_py.pyc,sha256=P_XU7Kkw6QUZ9U-nE5zQErtUJmMpHMGfKDMjURd_p7s,1183
+runningz/res/res_seeds_py.pyc,sha256=AM79e6b9A8ipklg8tLkFqMtjZI76xHkOyadkICNwbqc,1183
 runningz/res/config/__init__.pyc,sha256=JjG__a_vG2aVh24l9QvKtngGokxviRjfN0RTUMjemnU,157
 runningz/res/config/res_config.pyc,sha256=GY3_pIE-Iy13snkahK7YNulgcLR2X1XxdsUzQ26RWCM,1706
-runningz/res/config/res_config_py.pyc,sha256=0WM_5pNOt3nWslPideSq8lcDCL9h-3_MN5fWle0Km3I,3923
+runningz/res/config/res_config_py.pyc,sha256=ysiL4-yOYSURmNoM3fw37GXNimNgHT8DiKzcnGLEA1c,3923
 runningz/res/er/__init__.pyc,sha256=wK42RDd5Xe_W8dPlU-afOKqHqAgvK41i5sJtddX_tfE,153
 runningz/res/er/pooler.pyc,sha256=t6y05Iaa979-GEYELRwzsvhdz3k9qHzgEAookboltLs,9978
-runningz/res/er/pooler_py.pyc,sha256=mCXS-Z08pBZwUM3GkkEn-1FFR-rt84Mfumgp6umIT_U,23432
+runningz/res/er/pooler_py.pyc,sha256=lor92zSyW0h4tZDBw405-ek4oyzDnNk7sTkCgS1VR_I,23432
 runningz/res/util/__init__.pyc,sha256=Q_WC18b3dbhBj1QVFk8wi4FJ1N7wtA-dvzcgXIj8s4k,155
 runningz/res/util/util.pyc,sha256=YBLsb2b7Vz2_OU-272kmHIbEkqPulLTMKoeaRQ3caQY,2094
-runningz/res/util/util_py.pyc,sha256=gWPhQGG-85uUxc58AQqJrHBkpvQMvil5v1XCcS1_LuI,2564
+runningz/res/util/util_py.pyc,sha256=oPgDkrVCst2jddvto7An-p8lihPWr1Hj7D9_iZhzzxA,2564
 runningz/util/__init__.pyc,sha256=YtFcSjnc7TDswwLg7pUyD1Uw_9iOydpx3difGt79a0g,172
 runningz/util/api.pyc,sha256=fSTyQdCndjcXTwcp5FB9SHjvR5KDM6Vhaa-EK9KPDfM,1813
 runningz/util/clss.pyc,sha256=jsj_HHemzsF4PEM7HaUiiPmqA7mms7Tpf01t-5uDFAc,2062
-runningz/util/code.pyc,sha256=zFbPplaiZ53nYR3yTR7scMX0tn1PBMbkkMSw7t0bo0w,46539
-runningz/util/const.pyc,sha256=mdacXTaUm5dzGpW4riLCFMK6c6SrRSqv1X5dPGK32xY,3448
-runningz/util/const_py.pyc,sha256=FkmNe6r7P7-EcmVuZzwb3jguwNZEVMtqZ4OTpVgICWs,4372
+runningz/util/code.pyc,sha256=4mtj1b-vPN3GbczVbegr8H-6YyJsLQjS5IpguOorisY,49101
+runningz/util/const.pyc,sha256=3Z21L84JgYiphPcrscy3P5hUvCPrR7K1iC_UEVKMjaA,3448
+runningz/util/const_py.pyc,sha256=dGzLqa4XMk328LvVSIBzSSwQlxwjpgJ9R7OxiZ6qRJE,4372
 runningz/util/csv.pyc,sha256=lbnxhsyUjhK5hTo7qYLpFaOaGks99dp4xXq5XJFz8s4,1566
 runningz/util/db.pyc,sha256=nLjt-XbeyY94daxB0KEHRVTB4qANqaMe999B0qwcGYg,12208
 runningz/util/debug.pyc,sha256=VLnGcYxVQjXiFRmwAj6QMirUK1XjzSOU-Kg-Mb-kXLA,469
 runningz/util/dec.pyc,sha256=V-QlU_oQwqHpYYnrtEmKFWdZsBdG8JXiHB_3Dh3mGp4,2191
 runningz/util/dist.pyc,sha256=_GzIWmIEj5Ul586FmJdCVZXfI1nrKy68PNGtzHavvgM,9190
 runningz/util/env.pyc,sha256=wN6ExFgNPya7u1J_G2Wc7fRfzfOXLRhLKuV9quMgLzU,3599
 runningz/util/login.pyc,sha256=fRrfRaNynqmzcpvI_7QelPGan275aXhtVi0DqaIUKXM,2172
 runningz/util/mem.pyc,sha256=xPRK-N8YCaEmlLvbUhhTP00KPiAzwi-N4w89hydzrXg,4867
-runningz/util/npy.pyc,sha256=Z34jKtlFb81Yn8LdwEOasNUcxGpin3FMnf87K6RU7rA,20047
+runningz/util/npy.pyc,sha256=LpxI7Wu_v8j7rttqW7nzwsIOGCnE7iItlLWsSwqU1hs,20136
 runningz/util/npy_numba.pyc,sha256=qNYAuPdc8SSux4lJFka-di0TqnhLrWuPvYqWMkhEudg,68037
-runningz/util/npy_numba_py.pyc,sha256=Ozdo12lrgaJzaat3iSFlB5xiscQUKmy3WmyvAvXlDUY,88353
-runningz/util/npy_py.pyc,sha256=tAWBOhnTD4-QqGBqx1amzQCdAisAxigCdhsFxoZT9mQ,25675
+runningz/util/npy_numba_py.pyc,sha256=Y3anqFwIRJJSR0887AjKHVfxq4STPe_L7Z9bkC1Jguc,88353
+runningz/util/npy_py.pyc,sha256=c4IWIdiagjUgrssitTZ4HDiAT2G_FUJYbh5Dwhv3uMU,25829
 runningz/util/pool.pyc,sha256=GWzXucYKxIcUxvL35x4whdJYWa-D8X_MK13f9xol7-w,702066
 runningz/util/run.pyc,sha256=0JNGiFgdhefE_MOkyXvhT5296wMItGi994n4Wxa_R7E,9422
 runningz/util/split.pyc,sha256=eSRY1XmEoPyaguip2MBcp9TIm4bzfhhGE2MKEn9GlMA,3974
 runningz/util/test.pyc,sha256=4uw3IrAqzVoOC-RsoiLGtnXCat0XtujnASPX5tbWYv0,5670
-runningz/util/test_py.pyc,sha256=xkbY6ri97jlKTjs01vk5fUKebRFJ03laIgTLdY0NYls,7503
+runningz/util/test_py.pyc,sha256=fe6VChpiQsU7aPRHVTrt-yL2D60sxDaOZvxy80H1xf8,7503
 runningz/util/util.pyc,sha256=7tMZrilL_XjYjAPU0jLHMXAcr1Xe6RiZoI1tCTj-Xpk,18691
 runningz/util/temp/__init__.pyc,sha256=riZY9noDfq5zOxfSHKR_W2QIOhEaLafBvvessFfJ074,156
 runningz/util/temp/main.pyc,sha256=A5M2waDjLYpsf0KhEzOH5VcL2Hhl4JxfwbRYJfYTssY,1211
-runningz-0.16.4.dist-info/METADATA,sha256=paFH8FBs23siwrj7k_NfXjIQ7d_AMv7ezWz10XnmIBY,510
-runningz-0.16.4.dist-info/WHEEL,sha256=mzt24jmB6onkp8K8M-0bHGtbssTH2r_o1Dey-oJvff8,82
-runningz-0.16.4.dist-info/entry_points.txt,sha256=xRyDezAQfzQeE97t4wke38tl4qHJ613W1xSFGgezkzY,52
-runningz-0.16.4.dist-info/top_level.txt,sha256=qEVJqYeVqhub8a5GjohmAzV8iHDFesibNKxTpCqsOBQ,9
-runningz-0.16.4.dist-info/RECORD,,
+runningz-0.16.5.dist-info/METADATA,sha256=AWQ2rUmDoLGoK5Q7qc1__i8tks-2GtYkMSw9i9Mvglk,510
+runningz-0.16.5.dist-info/WHEEL,sha256=mzt24jmB6onkp8K8M-0bHGtbssTH2r_o1Dey-oJvff8,82
+runningz-0.16.5.dist-info/entry_points.txt,sha256=xRyDezAQfzQeE97t4wke38tl4qHJ613W1xSFGgezkzY,52
+runningz-0.16.5.dist-info/top_level.txt,sha256=qEVJqYeVqhub8a5GjohmAzV8iHDFesibNKxTpCqsOBQ,9
+runningz-0.16.5.dist-info/RECORD,,
```

